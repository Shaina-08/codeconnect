var Ur=Object.defineProperty;var Kr=(ct,nt,ot)=>nt in ct?Ur(ct,nt,{enumerable:!0,configurable:!0,writable:!0,value:ot}):ct[nt]=ot;var $n=(ct,nt,ot)=>(Kr(ct,typeof nt!="symbol"?nt+"":nt,ot),ot);(function(){const nt=document.createElement("link").relList;if(nt&&nt.supports&&nt.supports("modulepreload"))return;for(const ut of document.querySelectorAll('link[rel="modulepreload"]'))rt(ut);new MutationObserver(ut=>{for(const gt of ut)if(gt.type==="childList")for(const pt of gt.addedNodes)pt.tagName==="LINK"&&pt.rel==="modulepreload"&&rt(pt)}).observe(document,{childList:!0,subtree:!0});function ot(ut){const gt={};return ut.integrity&&(gt.integrity=ut.integrity),ut.referrerPolicy&&(gt.referrerPolicy=ut.referrerPolicy),ut.crossOrigin==="use-credentials"?gt.credentials="include":ut.crossOrigin==="anonymous"?gt.credentials="omit":gt.credentials="same-origin",gt}function rt(ut){if(ut.ep)return;ut.ep=!0;const gt=ot(ut);fetch(ut.href,gt)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(ct){return ct&&ct.__esModule&&Object.prototype.hasOwnProperty.call(ct,"default")?ct.default:ct}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$3=Symbol.for("react.element"),n$3=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t$1=Symbol.for("react.provider"),u$2=Symbol.for("react.context"),v$3=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$2(ct){return ct===null||typeof ct!="object"?null:(ct=z$1&&ct[z$1]||ct["@@iterator"],typeof ct=="function"?ct:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$2={};function E$1(ct,nt,ot){this.props=ct,this.context=nt,this.refs=D$2,this.updater=ot||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(ct,nt){if(typeof ct!="object"&&typeof ct!="function"&&ct!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ct,nt,"setState")};E$1.prototype.forceUpdate=function(ct){this.updater.enqueueForceUpdate(this,ct,"forceUpdate")};function F$1(){}F$1.prototype=E$1.prototype;function G$2(ct,nt,ot){this.props=ct,this.context=nt,this.refs=D$2,this.updater=ot||B$1}var H$2=G$2.prototype=new F$1;H$2.constructor=G$2;C$1(H$2,E$1.prototype);H$2.isPureReactComponent=!0;var I$2=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$2(ct,nt,ot){var rt,ut={},gt=null,pt=null;if(nt!=null)for(rt in nt.ref!==void 0&&(pt=nt.ref),nt.key!==void 0&&(gt=""+nt.key),nt)J$1.call(nt,rt)&&!L$1.hasOwnProperty(rt)&&(ut[rt]=nt[rt]);var mt=arguments.length-2;if(mt===1)ut.children=ot;else if(1<mt){for(var vt=Array(mt),St=0;St<mt;St++)vt[St]=arguments[St+2];ut.children=vt}if(ct&&ct.defaultProps)for(rt in mt=ct.defaultProps,mt)ut[rt]===void 0&&(ut[rt]=mt[rt]);return{$$typeof:l$3,type:ct,key:gt,ref:pt,props:ut,_owner:K$1.current}}function N$1(ct,nt){return{$$typeof:l$3,type:ct.type,key:nt,ref:ct.ref,props:ct.props,_owner:ct._owner}}function O$2(ct){return typeof ct=="object"&&ct!==null&&ct.$$typeof===l$3}function escape$2(ct){var nt={"=":"=0",":":"=2"};return"$"+ct.replace(/[=:]/g,function(ot){return nt[ot]})}var P$2=/\/+/g;function Q$2(ct,nt){return typeof ct=="object"&&ct!==null&&ct.key!=null?escape$2(""+ct.key):nt.toString(36)}function R$2(ct,nt,ot,rt,ut){var gt=typeof ct;(gt==="undefined"||gt==="boolean")&&(ct=null);var pt=!1;if(ct===null)pt=!0;else switch(gt){case"string":case"number":pt=!0;break;case"object":switch(ct.$$typeof){case l$3:case n$3:pt=!0}}if(pt)return pt=ct,ut=ut(pt),ct=rt===""?"."+Q$2(pt,0):rt,I$2(ut)?(ot="",ct!=null&&(ot=ct.replace(P$2,"$&/")+"/"),R$2(ut,nt,ot,"",function(St){return St})):ut!=null&&(O$2(ut)&&(ut=N$1(ut,ot+(!ut.key||pt&&pt.key===ut.key?"":(""+ut.key).replace(P$2,"$&/")+"/")+ct)),nt.push(ut)),1;if(pt=0,rt=rt===""?".":rt+":",I$2(ct))for(var mt=0;mt<ct.length;mt++){gt=ct[mt];var vt=rt+Q$2(gt,mt);pt+=R$2(gt,nt,ot,vt,ut)}else if(vt=A$2(ct),typeof vt=="function")for(ct=vt.call(ct),mt=0;!(gt=ct.next()).done;)gt=gt.value,vt=rt+Q$2(gt,mt++),pt+=R$2(gt,nt,ot,vt,ut);else if(gt==="object")throw nt=String(ct),Error("Objects are not valid as a React child (found: "+(nt==="[object Object]"?"object with keys {"+Object.keys(ct).join(", ")+"}":nt)+"). If you meant to render a collection of children, use an array instead.");return pt}function S$2(ct,nt,ot){if(ct==null)return ct;var rt=[],ut=0;return R$2(ct,rt,"","",function(gt){return nt.call(ot,gt,ut++)}),rt}function T$2(ct){if(ct._status===-1){var nt=ct._result;nt=nt(),nt.then(function(ot){(ct._status===0||ct._status===-1)&&(ct._status=1,ct._result=ot)},function(ot){(ct._status===0||ct._status===-1)&&(ct._status=2,ct._result=ot)}),ct._status===-1&&(ct._status=0,ct._result=nt)}if(ct._status===1)return ct._result.default;throw ct._result}var U$2={current:null},V$2={transition:null},W$2={ReactCurrentDispatcher:U$2,ReactCurrentBatchConfig:V$2,ReactCurrentOwner:K$1};react_production_min.Children={map:S$2,forEach:function(ct,nt,ot){S$2(ct,function(){nt.apply(this,arguments)},ot)},count:function(ct){var nt=0;return S$2(ct,function(){nt++}),nt},toArray:function(ct){return S$2(ct,function(nt){return nt})||[]},only:function(ct){if(!O$2(ct))throw Error("React.Children.only expected to receive a single React element child.");return ct}};react_production_min.Component=E$1;react_production_min.Fragment=p$3;react_production_min.Profiler=r;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$1;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.cloneElement=function(ct,nt,ot){if(ct==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ct+".");var rt=C$1({},ct.props),ut=ct.key,gt=ct.ref,pt=ct._owner;if(nt!=null){if(nt.ref!==void 0&&(gt=nt.ref,pt=K$1.current),nt.key!==void 0&&(ut=""+nt.key),ct.type&&ct.type.defaultProps)var mt=ct.type.defaultProps;for(vt in nt)J$1.call(nt,vt)&&!L$1.hasOwnProperty(vt)&&(rt[vt]=nt[vt]===void 0&&mt!==void 0?mt[vt]:nt[vt])}var vt=arguments.length-2;if(vt===1)rt.children=ot;else if(1<vt){mt=Array(vt);for(var St=0;St<vt;St++)mt[St]=arguments[St+2];rt.children=mt}return{$$typeof:l$3,type:ct.type,key:ut,ref:gt,props:rt,_owner:pt}};react_production_min.createContext=function(ct){return ct={$$typeof:u$2,_currentValue:ct,_currentValue2:ct,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ct.Provider={$$typeof:t$1,_context:ct},ct.Consumer=ct};react_production_min.createElement=M$2;react_production_min.createFactory=function(ct){var nt=M$2.bind(null,ct);return nt.type=ct,nt};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(ct){return{$$typeof:v$3,render:ct}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(ct){return{$$typeof:y,_payload:{_status:-1,_result:ct},_init:T$2}};react_production_min.memo=function(ct,nt){return{$$typeof:x,type:ct,compare:nt===void 0?null:nt}};react_production_min.startTransition=function(ct){var nt=V$2.transition;V$2.transition={};try{ct()}finally{V$2.transition=nt}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(ct,nt){return U$2.current.useCallback(ct,nt)};react_production_min.useContext=function(ct){return U$2.current.useContext(ct)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(ct){return U$2.current.useDeferredValue(ct)};react_production_min.useEffect=function(ct,nt){return U$2.current.useEffect(ct,nt)};react_production_min.useId=function(){return U$2.current.useId()};react_production_min.useImperativeHandle=function(ct,nt,ot){return U$2.current.useImperativeHandle(ct,nt,ot)};react_production_min.useInsertionEffect=function(ct,nt){return U$2.current.useInsertionEffect(ct,nt)};react_production_min.useLayoutEffect=function(ct,nt){return U$2.current.useLayoutEffect(ct,nt)};react_production_min.useMemo=function(ct,nt){return U$2.current.useMemo(ct,nt)};react_production_min.useReducer=function(ct,nt,ot){return U$2.current.useReducer(ct,nt,ot)};react_production_min.useRef=function(ct){return U$2.current.useRef(ct)};react_production_min.useState=function(ct){return U$2.current.useState(ct)};react_production_min.useSyncExternalStore=function(ct,nt,ot){return U$2.current.useSyncExternalStore(ct,nt,ot)};react_production_min.useTransition=function(){return U$2.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const Wt=getDefaultExportFromCjs(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k=Symbol.for("react.element"),l$2=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n$2=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q(ct,nt,ot){var rt,ut={},gt=null,pt=null;ot!==void 0&&(gt=""+ot),nt.key!==void 0&&(gt=""+nt.key),nt.ref!==void 0&&(pt=nt.ref);for(rt in nt)m$2.call(nt,rt)&&!p$2.hasOwnProperty(rt)&&(ut[rt]=nt[rt]);if(ct&&ct.defaultProps)for(rt in nt=ct.defaultProps,nt)ut[rt]===void 0&&(ut[rt]=nt[rt]);return{$$typeof:k,type:ct,key:gt,ref:pt,props:ut,_owner:n$2.current}}reactJsxRuntime_production_min.Fragment=l$2;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(ct){function nt(un,an){var Cn=un.length;un.push(an);e:for(;0<Cn;){var _n=Cn-1>>>1,hn=un[_n];if(0<ut(hn,an))un[_n]=an,un[Cn]=hn,Cn=_n;else break e}}function ot(un){return un.length===0?null:un[0]}function rt(un){if(un.length===0)return null;var an=un[0],Cn=un.pop();if(Cn!==an){un[0]=Cn;e:for(var _n=0,hn=un.length,pn=hn>>>1;_n<pn;){var yn=2*(_n+1)-1,Mn=un[yn],Nn=yn+1,Wn=un[Nn];if(0>ut(Mn,Cn))Nn<hn&&0>ut(Wn,Mn)?(un[_n]=Wn,un[Nn]=Cn,_n=Nn):(un[_n]=Mn,un[yn]=Cn,_n=yn);else if(Nn<hn&&0>ut(Wn,Cn))un[_n]=Wn,un[Nn]=Cn,_n=Nn;else break e}}return an}function ut(un,an){var Cn=un.sortIndex-an.sortIndex;return Cn!==0?Cn:un.id-an.id}if(typeof performance=="object"&&typeof performance.now=="function"){var gt=performance;ct.unstable_now=function(){return gt.now()}}else{var pt=Date,mt=pt.now();ct.unstable_now=function(){return pt.now()-mt}}var vt=[],St=[],yt=1,wt=null,Lt=3,xt=!1,It=!1,kt=!1,At=typeof setTimeout=="function"?setTimeout:null,Tt=typeof clearTimeout=="function"?clearTimeout:null,Rt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Nt(un){for(var an=ot(St);an!==null;){if(an.callback===null)rt(St);else if(an.startTime<=un)rt(St),an.sortIndex=an.expirationTime,nt(vt,an);else break;an=ot(St)}}function Pt(un){if(kt=!1,Nt(un),!It)if(ot(vt)!==null)It=!0,dn(Ft);else{var an=ot(St);an!==null&&bn(Pt,an.startTime-un)}}function Ft(un,an){It=!1,kt&&(kt=!1,Tt(Ut),Ut=-1),xt=!0;var Cn=Lt;try{for(Nt(an),wt=ot(vt);wt!==null&&(!(wt.expirationTime>an)||un&&!Zt());){var _n=wt.callback;if(typeof _n=="function"){wt.callback=null,Lt=wt.priorityLevel;var hn=_n(wt.expirationTime<=an);an=ct.unstable_now(),typeof hn=="function"?wt.callback=hn:wt===ot(vt)&&rt(vt),Nt(an)}else rt(vt);wt=ot(vt)}if(wt!==null)var pn=!0;else{var yn=ot(St);yn!==null&&bn(Pt,yn.startTime-an),pn=!1}return pn}finally{wt=null,Lt=Cn,xt=!1}}var Kt=!1,Bt=null,Ut=-1,qt=5,Yt=-1;function Zt(){return!(ct.unstable_now()-Yt<qt)}function Xt(){if(Bt!==null){var un=ct.unstable_now();Yt=un;var an=!0;try{an=Bt(!0,un)}finally{an?_i():(Kt=!1,Bt=null)}}else Kt=!1}var _i;if(typeof Rt=="function")_i=function(){Rt(Xt)};else if(typeof MessageChannel<"u"){var nn=new MessageChannel,rn=nn.port2;nn.port1.onmessage=Xt,_i=function(){rn.postMessage(null)}}else _i=function(){At(Xt,0)};function dn(un){Bt=un,Kt||(Kt=!0,_i())}function bn(un,an){Ut=At(function(){un(ct.unstable_now())},an)}ct.unstable_IdlePriority=5,ct.unstable_ImmediatePriority=1,ct.unstable_LowPriority=4,ct.unstable_NormalPriority=3,ct.unstable_Profiling=null,ct.unstable_UserBlockingPriority=2,ct.unstable_cancelCallback=function(un){un.callback=null},ct.unstable_continueExecution=function(){It||xt||(It=!0,dn(Ft))},ct.unstable_forceFrameRate=function(un){0>un||125<un?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):qt=0<un?Math.floor(1e3/un):5},ct.unstable_getCurrentPriorityLevel=function(){return Lt},ct.unstable_getFirstCallbackNode=function(){return ot(vt)},ct.unstable_next=function(un){switch(Lt){case 1:case 2:case 3:var an=3;break;default:an=Lt}var Cn=Lt;Lt=an;try{return un()}finally{Lt=Cn}},ct.unstable_pauseExecution=function(){},ct.unstable_requestPaint=function(){},ct.unstable_runWithPriority=function(un,an){switch(un){case 1:case 2:case 3:case 4:case 5:break;default:un=3}var Cn=Lt;Lt=un;try{return an()}finally{Lt=Cn}},ct.unstable_scheduleCallback=function(un,an,Cn){var _n=ct.unstable_now();switch(typeof Cn=="object"&&Cn!==null?(Cn=Cn.delay,Cn=typeof Cn=="number"&&0<Cn?_n+Cn:_n):Cn=_n,un){case 1:var hn=-1;break;case 2:hn=250;break;case 5:hn=1073741823;break;case 4:hn=1e4;break;default:hn=5e3}return hn=Cn+hn,un={id:yt++,callback:an,priorityLevel:un,startTime:Cn,expirationTime:hn,sortIndex:-1},Cn>_n?(un.sortIndex=Cn,nt(St,un),ot(vt)===null&&un===ot(St)&&(kt?(Tt(Ut),Ut=-1):kt=!0,bn(Pt,Cn-_n))):(un.sortIndex=hn,nt(vt,un),It||xt||(It=!0,dn(Ft))),un},ct.unstable_shouldYield=Zt,ct.unstable_wrapCallback=function(un){var an=Lt;return function(){var Cn=Lt;Lt=an;try{return un.apply(this,arguments)}finally{Lt=Cn}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$1(ct){for(var nt="https://reactjs.org/docs/error-decoder.html?invariant="+ct,ot=1;ot<arguments.length;ot++)nt+="&args[]="+encodeURIComponent(arguments[ot]);return"Minified React error #"+ct+"; visit "+nt+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(ct,nt){ha(ct,nt),ha(ct+"Capture",nt)}function ha(ct,nt){for(ea[ct]=nt,ct=0;ct<nt.length;ct++)da.add(nt[ct])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(ct){return ja.call(ma,ct)?!0:ja.call(la,ct)?!1:ka.test(ct)?ma[ct]=!0:(la[ct]=!0,!1)}function pa(ct,nt,ot,rt){if(ot!==null&&ot.type===0)return!1;switch(typeof nt){case"function":case"symbol":return!0;case"boolean":return rt?!1:ot!==null?!ot.acceptsBooleans:(ct=ct.toLowerCase().slice(0,5),ct!=="data-"&&ct!=="aria-");default:return!1}}function qa(ct,nt,ot,rt){if(nt===null||typeof nt>"u"||pa(ct,nt,ot,rt))return!0;if(rt)return!1;if(ot!==null)switch(ot.type){case 3:return!nt;case 4:return nt===!1;case 5:return isNaN(nt);case 6:return isNaN(nt)||1>nt}return!1}function v$2(ct,nt,ot,rt,ut,gt,pt){this.acceptsBooleans=nt===2||nt===3||nt===4,this.attributeName=rt,this.attributeNamespace=ut,this.mustUseProperty=ot,this.propertyName=ct,this.type=nt,this.sanitizeURL=gt,this.removeEmptyString=pt}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(ct){z[ct]=new v$2(ct,0,!1,ct,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(ct){var nt=ct[0];z[nt]=new v$2(nt,1,!1,ct[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(ct){z[ct]=new v$2(ct,2,!1,ct.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(ct){z[ct]=new v$2(ct,2,!1,ct,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(ct){z[ct]=new v$2(ct,3,!1,ct.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(ct){z[ct]=new v$2(ct,3,!0,ct,null,!1,!1)});["capture","download"].forEach(function(ct){z[ct]=new v$2(ct,4,!1,ct,null,!1,!1)});["cols","rows","size","span"].forEach(function(ct){z[ct]=new v$2(ct,6,!1,ct,null,!1,!1)});["rowSpan","start"].forEach(function(ct){z[ct]=new v$2(ct,5,!1,ct.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(ct){return ct[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(ct){var nt=ct.replace(ra,sa);z[nt]=new v$2(nt,1,!1,ct,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(ct){var nt=ct.replace(ra,sa);z[nt]=new v$2(nt,1,!1,ct,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(ct){var nt=ct.replace(ra,sa);z[nt]=new v$2(nt,1,!1,ct,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(ct){z[ct]=new v$2(ct,1,!1,ct.toLowerCase(),null,!1,!1)});z.xlinkHref=new v$2("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(ct){z[ct]=new v$2(ct,1,!1,ct.toLowerCase(),null,!0,!0)});function ta(ct,nt,ot,rt){var ut=z.hasOwnProperty(nt)?z[nt]:null;(ut!==null?ut.type!==0:rt||!(2<nt.length)||nt[0]!=="o"&&nt[0]!=="O"||nt[1]!=="n"&&nt[1]!=="N")&&(qa(nt,ot,ut,rt)&&(ot=null),rt||ut===null?oa(nt)&&(ot===null?ct.removeAttribute(nt):ct.setAttribute(nt,""+ot)):ut.mustUseProperty?ct[ut.propertyName]=ot===null?ut.type===3?!1:"":ot:(nt=ut.attributeName,rt=ut.attributeNamespace,ot===null?ct.removeAttribute(nt):(ut=ut.type,ot=ut===3||ut===4&&ot===!0?"":""+ot,rt?ct.setAttributeNS(rt,nt,ot):ct.setAttribute(nt,ot))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(ct){return ct===null||typeof ct!="object"?null:(ct=Ja&&ct[Ja]||ct["@@iterator"],typeof ct=="function"?ct:null)}var A$1=Object.assign,La;function Ma(ct){if(La===void 0)try{throw Error()}catch(ot){var nt=ot.stack.trim().match(/\n( *(at )?)/);La=nt&&nt[1]||""}return`
`+La+ct}var Na=!1;function Oa(ct,nt){if(!ct||Na)return"";Na=!0;var ot=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(nt)if(nt=function(){throw Error()},Object.defineProperty(nt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(nt,[])}catch(St){var rt=St}Reflect.construct(ct,[],nt)}else{try{nt.call()}catch(St){rt=St}ct.call(nt.prototype)}else{try{throw Error()}catch(St){rt=St}ct()}}catch(St){if(St&&rt&&typeof St.stack=="string"){for(var ut=St.stack.split(`
`),gt=rt.stack.split(`
`),pt=ut.length-1,mt=gt.length-1;1<=pt&&0<=mt&&ut[pt]!==gt[mt];)mt--;for(;1<=pt&&0<=mt;pt--,mt--)if(ut[pt]!==gt[mt]){if(pt!==1||mt!==1)do if(pt--,mt--,0>mt||ut[pt]!==gt[mt]){var vt=`
`+ut[pt].replace(" at new "," at ");return ct.displayName&&vt.includes("<anonymous>")&&(vt=vt.replace("<anonymous>",ct.displayName)),vt}while(1<=pt&&0<=mt);break}}}finally{Na=!1,Error.prepareStackTrace=ot}return(ct=ct?ct.displayName||ct.name:"")?Ma(ct):""}function Pa(ct){switch(ct.tag){case 5:return Ma(ct.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return ct=Oa(ct.type,!1),ct;case 11:return ct=Oa(ct.type.render,!1),ct;case 1:return ct=Oa(ct.type,!0),ct;default:return""}}function Qa(ct){if(ct==null)return null;if(typeof ct=="function")return ct.displayName||ct.name||null;if(typeof ct=="string")return ct;switch(ct){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof ct=="object")switch(ct.$$typeof){case Ca:return(ct.displayName||"Context")+".Consumer";case Ba:return(ct._context.displayName||"Context")+".Provider";case Da:var nt=ct.render;return ct=ct.displayName,ct||(ct=nt.displayName||nt.name||"",ct=ct!==""?"ForwardRef("+ct+")":"ForwardRef"),ct;case Ga:return nt=ct.displayName||null,nt!==null?nt:Qa(ct.type)||"Memo";case Ha:nt=ct._payload,ct=ct._init;try{return Qa(ct(nt))}catch{}}return null}function Ra(ct){var nt=ct.type;switch(ct.tag){case 24:return"Cache";case 9:return(nt.displayName||"Context")+".Consumer";case 10:return(nt._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return ct=nt.render,ct=ct.displayName||ct.name||"",nt.displayName||(ct!==""?"ForwardRef("+ct+")":"ForwardRef");case 7:return"Fragment";case 5:return nt;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(nt);case 8:return nt===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof nt=="function")return nt.displayName||nt.name||null;if(typeof nt=="string")return nt}return null}function Sa(ct){switch(typeof ct){case"boolean":case"number":case"string":case"undefined":return ct;case"object":return ct;default:return""}}function Ta(ct){var nt=ct.type;return(ct=ct.nodeName)&&ct.toLowerCase()==="input"&&(nt==="checkbox"||nt==="radio")}function Ua(ct){var nt=Ta(ct)?"checked":"value",ot=Object.getOwnPropertyDescriptor(ct.constructor.prototype,nt),rt=""+ct[nt];if(!ct.hasOwnProperty(nt)&&typeof ot<"u"&&typeof ot.get=="function"&&typeof ot.set=="function"){var ut=ot.get,gt=ot.set;return Object.defineProperty(ct,nt,{configurable:!0,get:function(){return ut.call(this)},set:function(pt){rt=""+pt,gt.call(this,pt)}}),Object.defineProperty(ct,nt,{enumerable:ot.enumerable}),{getValue:function(){return rt},setValue:function(pt){rt=""+pt},stopTracking:function(){ct._valueTracker=null,delete ct[nt]}}}}function Va(ct){ct._valueTracker||(ct._valueTracker=Ua(ct))}function Wa(ct){if(!ct)return!1;var nt=ct._valueTracker;if(!nt)return!0;var ot=nt.getValue(),rt="";return ct&&(rt=Ta(ct)?ct.checked?"true":"false":ct.value),ct=rt,ct!==ot?(nt.setValue(ct),!0):!1}function Xa(ct){if(ct=ct||(typeof document<"u"?document:void 0),typeof ct>"u")return null;try{return ct.activeElement||ct.body}catch{return ct.body}}function Ya(ct,nt){var ot=nt.checked;return A$1({},nt,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:ot??ct._wrapperState.initialChecked})}function Za(ct,nt){var ot=nt.defaultValue==null?"":nt.defaultValue,rt=nt.checked!=null?nt.checked:nt.defaultChecked;ot=Sa(nt.value!=null?nt.value:ot),ct._wrapperState={initialChecked:rt,initialValue:ot,controlled:nt.type==="checkbox"||nt.type==="radio"?nt.checked!=null:nt.value!=null}}function ab(ct,nt){nt=nt.checked,nt!=null&&ta(ct,"checked",nt,!1)}function bb(ct,nt){ab(ct,nt);var ot=Sa(nt.value),rt=nt.type;if(ot!=null)rt==="number"?(ot===0&&ct.value===""||ct.value!=ot)&&(ct.value=""+ot):ct.value!==""+ot&&(ct.value=""+ot);else if(rt==="submit"||rt==="reset"){ct.removeAttribute("value");return}nt.hasOwnProperty("value")?cb(ct,nt.type,ot):nt.hasOwnProperty("defaultValue")&&cb(ct,nt.type,Sa(nt.defaultValue)),nt.checked==null&&nt.defaultChecked!=null&&(ct.defaultChecked=!!nt.defaultChecked)}function db(ct,nt,ot){if(nt.hasOwnProperty("value")||nt.hasOwnProperty("defaultValue")){var rt=nt.type;if(!(rt!=="submit"&&rt!=="reset"||nt.value!==void 0&&nt.value!==null))return;nt=""+ct._wrapperState.initialValue,ot||nt===ct.value||(ct.value=nt),ct.defaultValue=nt}ot=ct.name,ot!==""&&(ct.name=""),ct.defaultChecked=!!ct._wrapperState.initialChecked,ot!==""&&(ct.name=ot)}function cb(ct,nt,ot){(nt!=="number"||Xa(ct.ownerDocument)!==ct)&&(ot==null?ct.defaultValue=""+ct._wrapperState.initialValue:ct.defaultValue!==""+ot&&(ct.defaultValue=""+ot))}var eb=Array.isArray;function fb(ct,nt,ot,rt){if(ct=ct.options,nt){nt={};for(var ut=0;ut<ot.length;ut++)nt["$"+ot[ut]]=!0;for(ot=0;ot<ct.length;ot++)ut=nt.hasOwnProperty("$"+ct[ot].value),ct[ot].selected!==ut&&(ct[ot].selected=ut),ut&&rt&&(ct[ot].defaultSelected=!0)}else{for(ot=""+Sa(ot),nt=null,ut=0;ut<ct.length;ut++){if(ct[ut].value===ot){ct[ut].selected=!0,rt&&(ct[ut].defaultSelected=!0);return}nt!==null||ct[ut].disabled||(nt=ct[ut])}nt!==null&&(nt.selected=!0)}}function gb(ct,nt){if(nt.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A$1({},nt,{value:void 0,defaultValue:void 0,children:""+ct._wrapperState.initialValue})}function hb(ct,nt){var ot=nt.value;if(ot==null){if(ot=nt.children,nt=nt.defaultValue,ot!=null){if(nt!=null)throw Error(p$1(92));if(eb(ot)){if(1<ot.length)throw Error(p$1(93));ot=ot[0]}nt=ot}nt==null&&(nt=""),ot=nt}ct._wrapperState={initialValue:Sa(ot)}}function ib(ct,nt){var ot=Sa(nt.value),rt=Sa(nt.defaultValue);ot!=null&&(ot=""+ot,ot!==ct.value&&(ct.value=ot),nt.defaultValue==null&&ct.defaultValue!==ot&&(ct.defaultValue=ot)),rt!=null&&(ct.defaultValue=""+rt)}function jb(ct){var nt=ct.textContent;nt===ct._wrapperState.initialValue&&nt!==""&&nt!==null&&(ct.value=nt)}function kb(ct){switch(ct){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(ct,nt){return ct==null||ct==="http://www.w3.org/1999/xhtml"?kb(nt):ct==="http://www.w3.org/2000/svg"&&nt==="foreignObject"?"http://www.w3.org/1999/xhtml":ct}var mb,nb=function(ct){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(nt,ot,rt,ut){MSApp.execUnsafeLocalFunction(function(){return ct(nt,ot,rt,ut)})}:ct}(function(ct,nt){if(ct.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in ct)ct.innerHTML=nt;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+nt.valueOf().toString()+"</svg>",nt=mb.firstChild;ct.firstChild;)ct.removeChild(ct.firstChild);for(;nt.firstChild;)ct.appendChild(nt.firstChild)}});function ob(ct,nt){if(nt){var ot=ct.firstChild;if(ot&&ot===ct.lastChild&&ot.nodeType===3){ot.nodeValue=nt;return}}ct.textContent=nt}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(ct){qb.forEach(function(nt){nt=nt+ct.charAt(0).toUpperCase()+ct.substring(1),pb[nt]=pb[ct]})});function rb(ct,nt,ot){return nt==null||typeof nt=="boolean"||nt===""?"":ot||typeof nt!="number"||nt===0||pb.hasOwnProperty(ct)&&pb[ct]?(""+nt).trim():nt+"px"}function sb(ct,nt){ct=ct.style;for(var ot in nt)if(nt.hasOwnProperty(ot)){var rt=ot.indexOf("--")===0,ut=rb(ot,nt[ot],rt);ot==="float"&&(ot="cssFloat"),rt?ct.setProperty(ot,ut):ct[ot]=ut}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(ct,nt){if(nt){if(tb[ct]&&(nt.children!=null||nt.dangerouslySetInnerHTML!=null))throw Error(p$1(137,ct));if(nt.dangerouslySetInnerHTML!=null){if(nt.children!=null)throw Error(p$1(60));if(typeof nt.dangerouslySetInnerHTML!="object"||!("__html"in nt.dangerouslySetInnerHTML))throw Error(p$1(61))}if(nt.style!=null&&typeof nt.style!="object")throw Error(p$1(62))}}function vb(ct,nt){if(ct.indexOf("-")===-1)return typeof nt.is=="string";switch(ct){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(ct){return ct=ct.target||ct.srcElement||window,ct.correspondingUseElement&&(ct=ct.correspondingUseElement),ct.nodeType===3?ct.parentNode:ct}var yb=null,zb=null,Ab=null;function Bb(ct){if(ct=Cb(ct)){if(typeof yb!="function")throw Error(p$1(280));var nt=ct.stateNode;nt&&(nt=Db(nt),yb(ct.stateNode,ct.type,nt))}}function Eb(ct){zb?Ab?Ab.push(ct):Ab=[ct]:zb=ct}function Fb(){if(zb){var ct=zb,nt=Ab;if(Ab=zb=null,Bb(ct),nt)for(ct=0;ct<nt.length;ct++)Bb(nt[ct])}}function Gb(ct,nt){return ct(nt)}function Hb(){}var Ib=!1;function Jb(ct,nt,ot){if(Ib)return ct(nt,ot);Ib=!0;try{return Gb(ct,nt,ot)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(ct,nt){var ot=ct.stateNode;if(ot===null)return null;var rt=Db(ot);if(rt===null)return null;ot=rt[nt];e:switch(nt){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(rt=!rt.disabled)||(ct=ct.type,rt=!(ct==="button"||ct==="input"||ct==="select"||ct==="textarea")),ct=!rt;break e;default:ct=!1}if(ct)return null;if(ot&&typeof ot!="function")throw Error(p$1(231,nt,typeof ot));return ot}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(ct,nt,ot,rt,ut,gt,pt,mt,vt){var St=Array.prototype.slice.call(arguments,3);try{nt.apply(ot,St)}catch(yt){this.onError(yt)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(ct){Ob=!0,Pb=ct}};function Tb(ct,nt,ot,rt,ut,gt,pt,mt,vt){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(ct,nt,ot,rt,ut,gt,pt,mt,vt){if(Tb.apply(this,arguments),Ob){if(Ob){var St=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=St)}}function Vb(ct){var nt=ct,ot=ct;if(ct.alternate)for(;nt.return;)nt=nt.return;else{ct=nt;do nt=ct,nt.flags&4098&&(ot=nt.return),ct=nt.return;while(ct)}return nt.tag===3?ot:null}function Wb(ct){if(ct.tag===13){var nt=ct.memoizedState;if(nt===null&&(ct=ct.alternate,ct!==null&&(nt=ct.memoizedState)),nt!==null)return nt.dehydrated}return null}function Xb(ct){if(Vb(ct)!==ct)throw Error(p$1(188))}function Yb(ct){var nt=ct.alternate;if(!nt){if(nt=Vb(ct),nt===null)throw Error(p$1(188));return nt!==ct?null:ct}for(var ot=ct,rt=nt;;){var ut=ot.return;if(ut===null)break;var gt=ut.alternate;if(gt===null){if(rt=ut.return,rt!==null){ot=rt;continue}break}if(ut.child===gt.child){for(gt=ut.child;gt;){if(gt===ot)return Xb(ut),ct;if(gt===rt)return Xb(ut),nt;gt=gt.sibling}throw Error(p$1(188))}if(ot.return!==rt.return)ot=ut,rt=gt;else{for(var pt=!1,mt=ut.child;mt;){if(mt===ot){pt=!0,ot=ut,rt=gt;break}if(mt===rt){pt=!0,rt=ut,ot=gt;break}mt=mt.sibling}if(!pt){for(mt=gt.child;mt;){if(mt===ot){pt=!0,ot=gt,rt=ut;break}if(mt===rt){pt=!0,rt=gt,ot=ut;break}mt=mt.sibling}if(!pt)throw Error(p$1(189))}}if(ot.alternate!==rt)throw Error(p$1(190))}if(ot.tag!==3)throw Error(p$1(188));return ot.stateNode.current===ot?ct:nt}function Zb(ct){return ct=Yb(ct),ct!==null?$b(ct):null}function $b(ct){if(ct.tag===5||ct.tag===6)return ct;for(ct=ct.child;ct!==null;){var nt=$b(ct);if(nt!==null)return nt;ct=ct.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(ct){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,ct,void 0,(ct.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(ct){return ct>>>=0,ct===0?32:31-(pc(ct)/qc|0)|0}var rc=64,sc=4194304;function tc(ct){switch(ct&-ct){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return ct&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return ct&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return ct}}function uc(ct,nt){var ot=ct.pendingLanes;if(ot===0)return 0;var rt=0,ut=ct.suspendedLanes,gt=ct.pingedLanes,pt=ot&268435455;if(pt!==0){var mt=pt&~ut;mt!==0?rt=tc(mt):(gt&=pt,gt!==0&&(rt=tc(gt)))}else pt=ot&~ut,pt!==0?rt=tc(pt):gt!==0&&(rt=tc(gt));if(rt===0)return 0;if(nt!==0&&nt!==rt&&!(nt&ut)&&(ut=rt&-rt,gt=nt&-nt,ut>=gt||ut===16&&(gt&4194240)!==0))return nt;if(rt&4&&(rt|=ot&16),nt=ct.entangledLanes,nt!==0)for(ct=ct.entanglements,nt&=rt;0<nt;)ot=31-oc(nt),ut=1<<ot,rt|=ct[ot],nt&=~ut;return rt}function vc(ct,nt){switch(ct){case 1:case 2:case 4:return nt+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return nt+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(ct,nt){for(var ot=ct.suspendedLanes,rt=ct.pingedLanes,ut=ct.expirationTimes,gt=ct.pendingLanes;0<gt;){var pt=31-oc(gt),mt=1<<pt,vt=ut[pt];vt===-1?(!(mt&ot)||mt&rt)&&(ut[pt]=vc(mt,nt)):vt<=nt&&(ct.expiredLanes|=mt),gt&=~mt}}function xc(ct){return ct=ct.pendingLanes&-1073741825,ct!==0?ct:ct&1073741824?1073741824:0}function yc(){var ct=rc;return rc<<=1,!(rc&4194240)&&(rc=64),ct}function zc(ct){for(var nt=[],ot=0;31>ot;ot++)nt.push(ct);return nt}function Ac(ct,nt,ot){ct.pendingLanes|=nt,nt!==536870912&&(ct.suspendedLanes=0,ct.pingedLanes=0),ct=ct.eventTimes,nt=31-oc(nt),ct[nt]=ot}function Bc(ct,nt){var ot=ct.pendingLanes&~nt;ct.pendingLanes=nt,ct.suspendedLanes=0,ct.pingedLanes=0,ct.expiredLanes&=nt,ct.mutableReadLanes&=nt,ct.entangledLanes&=nt,nt=ct.entanglements;var rt=ct.eventTimes;for(ct=ct.expirationTimes;0<ot;){var ut=31-oc(ot),gt=1<<ut;nt[ut]=0,rt[ut]=-1,ct[ut]=-1,ot&=~gt}}function Cc(ct,nt){var ot=ct.entangledLanes|=nt;for(ct=ct.entanglements;ot;){var rt=31-oc(ot),ut=1<<rt;ut&nt|ct[rt]&nt&&(ct[rt]|=nt),ot&=~ut}}var C=0;function Dc(ct){return ct&=-ct,1<ct?4<ct?ct&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(ct,nt){switch(ct){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(nt.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(nt.pointerId)}}function Tc(ct,nt,ot,rt,ut,gt){return ct===null||ct.nativeEvent!==gt?(ct={blockedOn:nt,domEventName:ot,eventSystemFlags:rt,nativeEvent:gt,targetContainers:[ut]},nt!==null&&(nt=Cb(nt),nt!==null&&Fc(nt)),ct):(ct.eventSystemFlags|=rt,nt=ct.targetContainers,ut!==null&&nt.indexOf(ut)===-1&&nt.push(ut),ct)}function Uc(ct,nt,ot,rt,ut){switch(nt){case"focusin":return Lc=Tc(Lc,ct,nt,ot,rt,ut),!0;case"dragenter":return Mc=Tc(Mc,ct,nt,ot,rt,ut),!0;case"mouseover":return Nc=Tc(Nc,ct,nt,ot,rt,ut),!0;case"pointerover":var gt=ut.pointerId;return Oc.set(gt,Tc(Oc.get(gt)||null,ct,nt,ot,rt,ut)),!0;case"gotpointercapture":return gt=ut.pointerId,Pc.set(gt,Tc(Pc.get(gt)||null,ct,nt,ot,rt,ut)),!0}return!1}function Vc(ct){var nt=Wc(ct.target);if(nt!==null){var ot=Vb(nt);if(ot!==null){if(nt=ot.tag,nt===13){if(nt=Wb(ot),nt!==null){ct.blockedOn=nt,Ic(ct.priority,function(){Gc(ot)});return}}else if(nt===3&&ot.stateNode.current.memoizedState.isDehydrated){ct.blockedOn=ot.tag===3?ot.stateNode.containerInfo:null;return}}}ct.blockedOn=null}function Xc(ct){if(ct.blockedOn!==null)return!1;for(var nt=ct.targetContainers;0<nt.length;){var ot=Yc(ct.domEventName,ct.eventSystemFlags,nt[0],ct.nativeEvent);if(ot===null){ot=ct.nativeEvent;var rt=new ot.constructor(ot.type,ot);wb=rt,ot.target.dispatchEvent(rt),wb=null}else return nt=Cb(ot),nt!==null&&Fc(nt),ct.blockedOn=ot,!1;nt.shift()}return!0}function Zc(ct,nt,ot){Xc(ct)&&ot.delete(nt)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(ct,nt){ct.blockedOn===nt&&(ct.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(ct){function nt(ut){return ad(ut,ct)}if(0<Kc.length){ad(Kc[0],ct);for(var ot=1;ot<Kc.length;ot++){var rt=Kc[ot];rt.blockedOn===ct&&(rt.blockedOn=null)}}for(Lc!==null&&ad(Lc,ct),Mc!==null&&ad(Mc,ct),Nc!==null&&ad(Nc,ct),Oc.forEach(nt),Pc.forEach(nt),ot=0;ot<Qc.length;ot++)rt=Qc[ot],rt.blockedOn===ct&&(rt.blockedOn=null);for(;0<Qc.length&&(ot=Qc[0],ot.blockedOn===null);)Vc(ot),ot.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(ct,nt,ot,rt){var ut=C,gt=cd.transition;cd.transition=null;try{C=1,fd(ct,nt,ot,rt)}finally{C=ut,cd.transition=gt}}function gd(ct,nt,ot,rt){var ut=C,gt=cd.transition;cd.transition=null;try{C=4,fd(ct,nt,ot,rt)}finally{C=ut,cd.transition=gt}}function fd(ct,nt,ot,rt){if(dd){var ut=Yc(ct,nt,ot,rt);if(ut===null)hd(ct,nt,rt,id$2,ot),Sc(ct,rt);else if(Uc(ut,ct,nt,ot,rt))rt.stopPropagation();else if(Sc(ct,rt),nt&4&&-1<Rc.indexOf(ct)){for(;ut!==null;){var gt=Cb(ut);if(gt!==null&&Ec(gt),gt=Yc(ct,nt,ot,rt),gt===null&&hd(ct,nt,rt,id$2,ot),gt===ut)break;ut=gt}ut!==null&&rt.stopPropagation()}else hd(ct,nt,rt,null,ot)}}var id$2=null;function Yc(ct,nt,ot,rt){if(id$2=null,ct=xb(rt),ct=Wc(ct),ct!==null)if(nt=Vb(ct),nt===null)ct=null;else if(ot=nt.tag,ot===13){if(ct=Wb(nt),ct!==null)return ct;ct=null}else if(ot===3){if(nt.stateNode.current.memoizedState.isDehydrated)return nt.tag===3?nt.stateNode.containerInfo:null;ct=null}else nt!==ct&&(ct=null);return id$2=ct,null}function jd(ct){switch(ct){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var ct,nt=ld,ot=nt.length,rt,ut="value"in kd?kd.value:kd.textContent,gt=ut.length;for(ct=0;ct<ot&&nt[ct]===ut[ct];ct++);var pt=ot-ct;for(rt=1;rt<=pt&&nt[ot-rt]===ut[gt-rt];rt++);return md=ut.slice(ct,1<rt?1-rt:void 0)}function od(ct){var nt=ct.keyCode;return"charCode"in ct?(ct=ct.charCode,ct===0&&nt===13&&(ct=13)):ct=nt,ct===10&&(ct=13),32<=ct||ct===13?ct:0}function pd(){return!0}function qd(){return!1}function rd(ct){function nt(ot,rt,ut,gt,pt){this._reactName=ot,this._targetInst=ut,this.type=rt,this.nativeEvent=gt,this.target=pt,this.currentTarget=null;for(var mt in ct)ct.hasOwnProperty(mt)&&(ot=ct[mt],this[mt]=ot?ot(gt):gt[mt]);return this.isDefaultPrevented=(gt.defaultPrevented!=null?gt.defaultPrevented:gt.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1(nt.prototype,{preventDefault:function(){this.defaultPrevented=!0;var ot=this.nativeEvent;ot&&(ot.preventDefault?ot.preventDefault():typeof ot.returnValue!="unknown"&&(ot.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var ot=this.nativeEvent;ot&&(ot.stopPropagation?ot.stopPropagation():typeof ot.cancelBubble!="unknown"&&(ot.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),nt}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(ct){return ct.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(ct){return ct.relatedTarget===void 0?ct.fromElement===ct.srcElement?ct.toElement:ct.fromElement:ct.relatedTarget},movementX:function(ct){return"movementX"in ct?ct.movementX:(ct!==yd&&(yd&&ct.type==="mousemove"?(wd=ct.screenX-yd.screenX,xd=ct.screenY-yd.screenY):xd=wd=0,yd=ct),wd)},movementY:function(ct){return"movementY"in ct?ct.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function(ct){return"clipboardData"in ct?ct.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(ct){var nt=this.nativeEvent;return nt.getModifierState?nt.getModifierState(ct):(ct=Od[ct])?!!nt[ct]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function(ct){if(ct.key){var nt=Md[ct.key]||ct.key;if(nt!=="Unidentified")return nt}return ct.type==="keypress"?(ct=od(ct),ct===13?"Enter":String.fromCharCode(ct)):ct.type==="keydown"||ct.type==="keyup"?Nd[ct.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(ct){return ct.type==="keypress"?od(ct):0},keyCode:function(ct){return ct.type==="keydown"||ct.type==="keyup"?ct.keyCode:0},which:function(ct){return ct.type==="keypress"?od(ct):ct.type==="keydown"||ct.type==="keyup"?ct.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function(ct){return"deltaX"in ct?ct.deltaX:"wheelDeltaX"in ct?-ct.wheelDeltaX:0},deltaY:function(ct){return"deltaY"in ct?ct.deltaY:"wheelDeltaY"in ct?-ct.wheelDeltaY:"wheelDelta"in ct?-ct.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be$1=null;ia&&"documentMode"in document&&(be$1=document.documentMode);var ce=ia&&"TextEvent"in window&&!be$1,de$1=ia&&(!ae||be$1&&8<be$1&&11>=be$1),ee$1=String.fromCharCode(32),fe$1=!1;function ge$1(ct,nt){switch(ct){case"keyup":return $d.indexOf(nt.keyCode)!==-1;case"keydown":return nt.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(ct){return ct=ct.detail,typeof ct=="object"&&"data"in ct?ct.data:null}var ie=!1;function je(ct,nt){switch(ct){case"compositionend":return he$1(nt);case"keypress":return nt.which!==32?null:(fe$1=!0,ee$1);case"textInput":return ct=nt.data,ct===ee$1&&fe$1?null:ct;default:return null}}function ke(ct,nt){if(ie)return ct==="compositionend"||!ae&&ge$1(ct,nt)?(ct=nd(),md=ld=kd=null,ie=!1,ct):null;switch(ct){case"paste":return null;case"keypress":if(!(nt.ctrlKey||nt.altKey||nt.metaKey)||nt.ctrlKey&&nt.altKey){if(nt.char&&1<nt.char.length)return nt.char;if(nt.which)return String.fromCharCode(nt.which)}return null;case"compositionend":return de$1&&nt.locale!=="ko"?null:nt.data;default:return null}}var le$1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(ct){var nt=ct&&ct.nodeName&&ct.nodeName.toLowerCase();return nt==="input"?!!le$1[ct.type]:nt==="textarea"}function ne$1(ct,nt,ot,rt){Eb(rt),nt=oe$1(nt,"onChange"),0<nt.length&&(ot=new td("onChange","change",null,ot,rt),ct.push({event:ot,listeners:nt}))}var pe$1=null,qe=null;function re$2(ct){se$1(ct,0)}function te(ct){var nt=ue$1(ct);if(Wa(nt))return ct}function ve$1(ct,nt){if(ct==="change")return nt}var we=!1;if(ia){var xe$1;if(ia){var ye$1="oninput"in document;if(!ye$1){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye$1=typeof ze.oninput=="function"}xe$1=ye$1}else xe$1=!1;we=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae$1(){pe$1&&(pe$1.detachEvent("onpropertychange",Be),qe=pe$1=null)}function Be(ct){if(ct.propertyName==="value"&&te(qe)){var nt=[];ne$1(nt,qe,ct,xb(ct)),Jb(re$2,nt)}}function Ce(ct,nt,ot){ct==="focusin"?(Ae$1(),pe$1=nt,qe=ot,pe$1.attachEvent("onpropertychange",Be)):ct==="focusout"&&Ae$1()}function De(ct){if(ct==="selectionchange"||ct==="keyup"||ct==="keydown")return te(qe)}function Ee$1(ct,nt){if(ct==="click")return te(nt)}function Fe$1(ct,nt){if(ct==="input"||ct==="change")return te(nt)}function Ge(ct,nt){return ct===nt&&(ct!==0||1/ct===1/nt)||ct!==ct&&nt!==nt}var He=typeof Object.is=="function"?Object.is:Ge;function Ie$1(ct,nt){if(He(ct,nt))return!0;if(typeof ct!="object"||ct===null||typeof nt!="object"||nt===null)return!1;var ot=Object.keys(ct),rt=Object.keys(nt);if(ot.length!==rt.length)return!1;for(rt=0;rt<ot.length;rt++){var ut=ot[rt];if(!ja.call(nt,ut)||!He(ct[ut],nt[ut]))return!1}return!0}function Je(ct){for(;ct&&ct.firstChild;)ct=ct.firstChild;return ct}function Ke(ct,nt){var ot=Je(ct);ct=0;for(var rt;ot;){if(ot.nodeType===3){if(rt=ct+ot.textContent.length,ct<=nt&&rt>=nt)return{node:ot,offset:nt-ct};ct=rt}e:{for(;ot;){if(ot.nextSibling){ot=ot.nextSibling;break e}ot=ot.parentNode}ot=void 0}ot=Je(ot)}}function Le(ct,nt){return ct&&nt?ct===nt?!0:ct&&ct.nodeType===3?!1:nt&&nt.nodeType===3?Le(ct,nt.parentNode):"contains"in ct?ct.contains(nt):ct.compareDocumentPosition?!!(ct.compareDocumentPosition(nt)&16):!1:!1}function Me(){for(var ct=window,nt=Xa();nt instanceof ct.HTMLIFrameElement;){try{var ot=typeof nt.contentWindow.location.href=="string"}catch{ot=!1}if(ot)ct=nt.contentWindow;else break;nt=Xa(ct.document)}return nt}function Ne(ct){var nt=ct&&ct.nodeName&&ct.nodeName.toLowerCase();return nt&&(nt==="input"&&(ct.type==="text"||ct.type==="search"||ct.type==="tel"||ct.type==="url"||ct.type==="password")||nt==="textarea"||ct.contentEditable==="true")}function Oe(ct){var nt=Me(),ot=ct.focusedElem,rt=ct.selectionRange;if(nt!==ot&&ot&&ot.ownerDocument&&Le(ot.ownerDocument.documentElement,ot)){if(rt!==null&&Ne(ot)){if(nt=rt.start,ct=rt.end,ct===void 0&&(ct=nt),"selectionStart"in ot)ot.selectionStart=nt,ot.selectionEnd=Math.min(ct,ot.value.length);else if(ct=(nt=ot.ownerDocument||document)&&nt.defaultView||window,ct.getSelection){ct=ct.getSelection();var ut=ot.textContent.length,gt=Math.min(rt.start,ut);rt=rt.end===void 0?gt:Math.min(rt.end,ut),!ct.extend&&gt>rt&&(ut=rt,rt=gt,gt=ut),ut=Ke(ot,gt);var pt=Ke(ot,rt);ut&&pt&&(ct.rangeCount!==1||ct.anchorNode!==ut.node||ct.anchorOffset!==ut.offset||ct.focusNode!==pt.node||ct.focusOffset!==pt.offset)&&(nt=nt.createRange(),nt.setStart(ut.node,ut.offset),ct.removeAllRanges(),gt>rt?(ct.addRange(nt),ct.extend(pt.node,pt.offset)):(nt.setEnd(pt.node,pt.offset),ct.addRange(nt)))}}for(nt=[],ct=ot;ct=ct.parentNode;)ct.nodeType===1&&nt.push({element:ct,left:ct.scrollLeft,top:ct.scrollTop});for(typeof ot.focus=="function"&&ot.focus(),ot=0;ot<nt.length;ot++)ct=nt[ot],ct.element.scrollLeft=ct.left,ct.element.scrollTop=ct.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re$1=null,Se$1=null,Te$1=!1;function Ue(ct,nt,ot){var rt=ot.window===ot?ot.document:ot.nodeType===9?ot:ot.ownerDocument;Te$1||Qe==null||Qe!==Xa(rt)||(rt=Qe,"selectionStart"in rt&&Ne(rt)?rt={start:rt.selectionStart,end:rt.selectionEnd}:(rt=(rt.ownerDocument&&rt.ownerDocument.defaultView||window).getSelection(),rt={anchorNode:rt.anchorNode,anchorOffset:rt.anchorOffset,focusNode:rt.focusNode,focusOffset:rt.focusOffset}),Se$1&&Ie$1(Se$1,rt)||(Se$1=rt,rt=oe$1(Re$1,"onSelect"),0<rt.length&&(nt=new td("onSelect","select",null,nt,ot),ct.push({event:nt,listeners:rt}),nt.target=Qe)))}function Ve(ct,nt){var ot={};return ot[ct.toLowerCase()]=nt.toLowerCase(),ot["Webkit"+ct]="webkit"+nt,ot["Moz"+ct]="moz"+nt,ot}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(ct){if(Xe[ct])return Xe[ct];if(!We[ct])return ct;var nt=We[ct],ot;for(ot in nt)if(nt.hasOwnProperty(ot)&&ot in Ye)return Xe[ct]=nt[ot];return ct}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(ct,nt){df.set(ct,nt),fa(nt,[ct])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(ct,nt,ot){var rt=ct.type||"unknown-event";ct.currentTarget=ot,Ub(rt,nt,void 0,ct),ct.currentTarget=null}function se$1(ct,nt){nt=(nt&4)!==0;for(var ot=0;ot<ct.length;ot++){var rt=ct[ot],ut=rt.event;rt=rt.listeners;e:{var gt=void 0;if(nt)for(var pt=rt.length-1;0<=pt;pt--){var mt=rt[pt],vt=mt.instance,St=mt.currentTarget;if(mt=mt.listener,vt!==gt&&ut.isPropagationStopped())break e;nf(ut,mt,St),gt=vt}else for(pt=0;pt<rt.length;pt++){if(mt=rt[pt],vt=mt.instance,St=mt.currentTarget,mt=mt.listener,vt!==gt&&ut.isPropagationStopped())break e;nf(ut,mt,St),gt=vt}}}if(Qb)throw ct=Rb,Qb=!1,Rb=null,ct}function D$1(ct,nt){var ot=nt[of];ot===void 0&&(ot=nt[of]=new Set);var rt=ct+"__bubble";ot.has(rt)||(pf(nt,ct,2,!1),ot.add(rt))}function qf(ct,nt,ot){var rt=0;nt&&(rt|=4),pf(ot,ct,rt,nt)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(ct){if(!ct[rf]){ct[rf]=!0,da.forEach(function(ot){ot!=="selectionchange"&&(mf.has(ot)||qf(ot,!1,ct),qf(ot,!0,ct))});var nt=ct.nodeType===9?ct:ct.ownerDocument;nt===null||nt[rf]||(nt[rf]=!0,qf("selectionchange",!1,nt))}}function pf(ct,nt,ot,rt){switch(jd(nt)){case 1:var ut=ed;break;case 4:ut=gd;break;default:ut=fd}ot=ut.bind(null,nt,ot,ct),ut=void 0,!Lb||nt!=="touchstart"&&nt!=="touchmove"&&nt!=="wheel"||(ut=!0),rt?ut!==void 0?ct.addEventListener(nt,ot,{capture:!0,passive:ut}):ct.addEventListener(nt,ot,!0):ut!==void 0?ct.addEventListener(nt,ot,{passive:ut}):ct.addEventListener(nt,ot,!1)}function hd(ct,nt,ot,rt,ut){var gt=rt;if(!(nt&1)&&!(nt&2)&&rt!==null)e:for(;;){if(rt===null)return;var pt=rt.tag;if(pt===3||pt===4){var mt=rt.stateNode.containerInfo;if(mt===ut||mt.nodeType===8&&mt.parentNode===ut)break;if(pt===4)for(pt=rt.return;pt!==null;){var vt=pt.tag;if((vt===3||vt===4)&&(vt=pt.stateNode.containerInfo,vt===ut||vt.nodeType===8&&vt.parentNode===ut))return;pt=pt.return}for(;mt!==null;){if(pt=Wc(mt),pt===null)return;if(vt=pt.tag,vt===5||vt===6){rt=gt=pt;continue e}mt=mt.parentNode}}rt=rt.return}Jb(function(){var St=gt,yt=xb(ot),wt=[];e:{var Lt=df.get(ct);if(Lt!==void 0){var xt=td,It=ct;switch(ct){case"keypress":if(od(ot)===0)break e;case"keydown":case"keyup":xt=Rd;break;case"focusin":It="focus",xt=Fd;break;case"focusout":It="blur",xt=Fd;break;case"beforeblur":case"afterblur":xt=Fd;break;case"click":if(ot.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xt=Vd;break;case $e:case af:case bf:xt=Hd;break;case cf:xt=Xd;break;case"scroll":xt=vd;break;case"wheel":xt=Zd;break;case"copy":case"cut":case"paste":xt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xt=Td}var kt=(nt&4)!==0,At=!kt&&ct==="scroll",Tt=kt?Lt!==null?Lt+"Capture":null:Lt;kt=[];for(var Rt=St,Nt;Rt!==null;){Nt=Rt;var Pt=Nt.stateNode;if(Nt.tag===5&&Pt!==null&&(Nt=Pt,Tt!==null&&(Pt=Kb(Rt,Tt),Pt!=null&&kt.push(tf(Rt,Pt,Nt)))),At)break;Rt=Rt.return}0<kt.length&&(Lt=new xt(Lt,It,null,ot,yt),wt.push({event:Lt,listeners:kt}))}}if(!(nt&7)){e:{if(Lt=ct==="mouseover"||ct==="pointerover",xt=ct==="mouseout"||ct==="pointerout",Lt&&ot!==wb&&(It=ot.relatedTarget||ot.fromElement)&&(Wc(It)||It[uf]))break e;if((xt||Lt)&&(Lt=yt.window===yt?yt:(Lt=yt.ownerDocument)?Lt.defaultView||Lt.parentWindow:window,xt?(It=ot.relatedTarget||ot.toElement,xt=St,It=It?Wc(It):null,It!==null&&(At=Vb(It),It!==At||It.tag!==5&&It.tag!==6)&&(It=null)):(xt=null,It=St),xt!==It)){if(kt=Bd,Pt="onMouseLeave",Tt="onMouseEnter",Rt="mouse",(ct==="pointerout"||ct==="pointerover")&&(kt=Td,Pt="onPointerLeave",Tt="onPointerEnter",Rt="pointer"),At=xt==null?Lt:ue$1(xt),Nt=It==null?Lt:ue$1(It),Lt=new kt(Pt,Rt+"leave",xt,ot,yt),Lt.target=At,Lt.relatedTarget=Nt,Pt=null,Wc(yt)===St&&(kt=new kt(Tt,Rt+"enter",It,ot,yt),kt.target=Nt,kt.relatedTarget=At,Pt=kt),At=Pt,xt&&It)t:{for(kt=xt,Tt=It,Rt=0,Nt=kt;Nt;Nt=vf(Nt))Rt++;for(Nt=0,Pt=Tt;Pt;Pt=vf(Pt))Nt++;for(;0<Rt-Nt;)kt=vf(kt),Rt--;for(;0<Nt-Rt;)Tt=vf(Tt),Nt--;for(;Rt--;){if(kt===Tt||Tt!==null&&kt===Tt.alternate)break t;kt=vf(kt),Tt=vf(Tt)}kt=null}else kt=null;xt!==null&&wf(wt,Lt,xt,kt,!1),It!==null&&At!==null&&wf(wt,At,It,kt,!0)}}e:{if(Lt=St?ue$1(St):window,xt=Lt.nodeName&&Lt.nodeName.toLowerCase(),xt==="select"||xt==="input"&&Lt.type==="file")var Ft=ve$1;else if(me(Lt))if(we)Ft=Fe$1;else{Ft=De;var Kt=Ce}else(xt=Lt.nodeName)&&xt.toLowerCase()==="input"&&(Lt.type==="checkbox"||Lt.type==="radio")&&(Ft=Ee$1);if(Ft&&(Ft=Ft(ct,St))){ne$1(wt,Ft,ot,yt);break e}Kt&&Kt(ct,Lt,St),ct==="focusout"&&(Kt=Lt._wrapperState)&&Kt.controlled&&Lt.type==="number"&&cb(Lt,"number",Lt.value)}switch(Kt=St?ue$1(St):window,ct){case"focusin":(me(Kt)||Kt.contentEditable==="true")&&(Qe=Kt,Re$1=St,Se$1=null);break;case"focusout":Se$1=Re$1=Qe=null;break;case"mousedown":Te$1=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$1=!1,Ue(wt,ot,yt);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(wt,ot,yt)}var Bt;if(ae)e:{switch(ct){case"compositionstart":var Ut="onCompositionStart";break e;case"compositionend":Ut="onCompositionEnd";break e;case"compositionupdate":Ut="onCompositionUpdate";break e}Ut=void 0}else ie?ge$1(ct,ot)&&(Ut="onCompositionEnd"):ct==="keydown"&&ot.keyCode===229&&(Ut="onCompositionStart");Ut&&(de$1&&ot.locale!=="ko"&&(ie||Ut!=="onCompositionStart"?Ut==="onCompositionEnd"&&ie&&(Bt=nd()):(kd=yt,ld="value"in kd?kd.value:kd.textContent,ie=!0)),Kt=oe$1(St,Ut),0<Kt.length&&(Ut=new Ld(Ut,ct,null,ot,yt),wt.push({event:Ut,listeners:Kt}),Bt?Ut.data=Bt:(Bt=he$1(ot),Bt!==null&&(Ut.data=Bt)))),(Bt=ce?je(ct,ot):ke(ct,ot))&&(St=oe$1(St,"onBeforeInput"),0<St.length&&(yt=new Ld("onBeforeInput","beforeinput",null,ot,yt),wt.push({event:yt,listeners:St}),yt.data=Bt))}se$1(wt,nt)})}function tf(ct,nt,ot){return{instance:ct,listener:nt,currentTarget:ot}}function oe$1(ct,nt){for(var ot=nt+"Capture",rt=[];ct!==null;){var ut=ct,gt=ut.stateNode;ut.tag===5&&gt!==null&&(ut=gt,gt=Kb(ct,ot),gt!=null&&rt.unshift(tf(ct,gt,ut)),gt=Kb(ct,nt),gt!=null&&rt.push(tf(ct,gt,ut))),ct=ct.return}return rt}function vf(ct){if(ct===null)return null;do ct=ct.return;while(ct&&ct.tag!==5);return ct||null}function wf(ct,nt,ot,rt,ut){for(var gt=nt._reactName,pt=[];ot!==null&&ot!==rt;){var mt=ot,vt=mt.alternate,St=mt.stateNode;if(vt!==null&&vt===rt)break;mt.tag===5&&St!==null&&(mt=St,ut?(vt=Kb(ot,gt),vt!=null&&pt.unshift(tf(ot,vt,mt))):ut||(vt=Kb(ot,gt),vt!=null&&pt.push(tf(ot,vt,mt)))),ot=ot.return}pt.length!==0&&ct.push({event:nt,listeners:pt})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(ct){return(typeof ct=="string"?ct:""+ct).replace(xf,`
`).replace(yf,"")}function Af(ct,nt,ot){if(nt=zf(nt),zf(ct)!==nt&&ot)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(ct,nt){return ct==="textarea"||ct==="noscript"||typeof nt.children=="string"||typeof nt.children=="number"||typeof nt.dangerouslySetInnerHTML=="object"&&nt.dangerouslySetInnerHTML!==null&&nt.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(ct){return Hf.resolve(null).then(ct).catch(If)}:Ff;function If(ct){setTimeout(function(){throw ct})}function Kf(ct,nt){var ot=nt,rt=0;do{var ut=ot.nextSibling;if(ct.removeChild(ot),ut&&ut.nodeType===8)if(ot=ut.data,ot==="/$"){if(rt===0){ct.removeChild(ut),bd(nt);return}rt--}else ot!=="$"&&ot!=="$?"&&ot!=="$!"||rt++;ot=ut}while(ot);bd(nt)}function Lf(ct){for(;ct!=null;ct=ct.nextSibling){var nt=ct.nodeType;if(nt===1||nt===3)break;if(nt===8){if(nt=ct.data,nt==="$"||nt==="$!"||nt==="$?")break;if(nt==="/$")return null}}return ct}function Mf(ct){ct=ct.previousSibling;for(var nt=0;ct;){if(ct.nodeType===8){var ot=ct.data;if(ot==="$"||ot==="$!"||ot==="$?"){if(nt===0)return ct;nt--}else ot==="/$"&&nt++}ct=ct.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(ct){var nt=ct[Of];if(nt)return nt;for(var ot=ct.parentNode;ot;){if(nt=ot[uf]||ot[Of]){if(ot=nt.alternate,nt.child!==null||ot!==null&&ot.child!==null)for(ct=Mf(ct);ct!==null;){if(ot=ct[Of])return ot;ct=Mf(ct)}return nt}ct=ot,ot=ct.parentNode}return null}function Cb(ct){return ct=ct[Of]||ct[uf],!ct||ct.tag!==5&&ct.tag!==6&&ct.tag!==13&&ct.tag!==3?null:ct}function ue$1(ct){if(ct.tag===5||ct.tag===6)return ct.stateNode;throw Error(p$1(33))}function Db(ct){return ct[Pf]||null}var Sf=[],Tf=-1;function Uf(ct){return{current:ct}}function E(ct){0>Tf||(ct.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$1(ct,nt){Tf++,Sf[Tf]=ct.current,ct.current=nt}var Vf={},H$1=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(ct,nt){var ot=ct.type.contextTypes;if(!ot)return Vf;var rt=ct.stateNode;if(rt&&rt.__reactInternalMemoizedUnmaskedChildContext===nt)return rt.__reactInternalMemoizedMaskedChildContext;var ut={},gt;for(gt in ot)ut[gt]=nt[gt];return rt&&(ct=ct.stateNode,ct.__reactInternalMemoizedUnmaskedChildContext=nt,ct.__reactInternalMemoizedMaskedChildContext=ut),ut}function Zf(ct){return ct=ct.childContextTypes,ct!=null}function $f(){E(Wf),E(H$1)}function ag(ct,nt,ot){if(H$1.current!==Vf)throw Error(p$1(168));G$1(H$1,nt),G$1(Wf,ot)}function bg(ct,nt,ot){var rt=ct.stateNode;if(nt=nt.childContextTypes,typeof rt.getChildContext!="function")return ot;rt=rt.getChildContext();for(var ut in rt)if(!(ut in nt))throw Error(p$1(108,Ra(ct)||"Unknown",ut));return A$1({},ot,rt)}function cg(ct){return ct=(ct=ct.stateNode)&&ct.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$1.current,G$1(H$1,ct),G$1(Wf,Wf.current),!0}function dg(ct,nt,ot){var rt=ct.stateNode;if(!rt)throw Error(p$1(169));ot?(ct=bg(ct,nt,Xf),rt.__reactInternalMemoizedMergedChildContext=ct,E(Wf),E(H$1),G$1(H$1,ct)):E(Wf),G$1(Wf,ot)}var eg=null,fg=!1,gg=!1;function hg(ct){eg===null?eg=[ct]:eg.push(ct)}function ig(ct){fg=!0,hg(ct)}function jg(){if(!gg&&eg!==null){gg=!0;var ct=0,nt=C;try{var ot=eg;for(C=1;ct<ot.length;ct++){var rt=ot[ct];do rt=rt(!0);while(rt!==null)}eg=null,fg=!1}catch(ut){throw eg!==null&&(eg=eg.slice(ct+1)),ac(fc,jg),ut}finally{C=nt,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(ct,nt){kg[lg++]=ng,kg[lg++]=mg,mg=ct,ng=nt}function ug(ct,nt,ot){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=ct;var rt=rg;ct=sg;var ut=32-oc(rt)-1;rt&=~(1<<ut),ot+=1;var gt=32-oc(nt)+ut;if(30<gt){var pt=ut-ut%5;gt=(rt&(1<<pt)-1).toString(32),rt>>=pt,ut-=pt,rg=1<<32-oc(nt)+ut|ot<<ut|rt,sg=gt+ct}else rg=1<<gt|ot<<ut|rt,sg=ct}function vg(ct){ct.return!==null&&(tg(ct,1),ug(ct,1,0))}function wg(ct){for(;ct===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;ct===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag(ct,nt){var ot=Bg(5,null,null,0);ot.elementType="DELETED",ot.stateNode=nt,ot.return=ct,nt=ct.deletions,nt===null?(ct.deletions=[ot],ct.flags|=16):nt.push(ot)}function Cg(ct,nt){switch(ct.tag){case 5:var ot=ct.type;return nt=nt.nodeType!==1||ot.toLowerCase()!==nt.nodeName.toLowerCase()?null:nt,nt!==null?(ct.stateNode=nt,xg=ct,yg=Lf(nt.firstChild),!0):!1;case 6:return nt=ct.pendingProps===""||nt.nodeType!==3?null:nt,nt!==null?(ct.stateNode=nt,xg=ct,yg=null,!0):!1;case 13:return nt=nt.nodeType!==8?null:nt,nt!==null?(ot=qg!==null?{id:rg,overflow:sg}:null,ct.memoizedState={dehydrated:nt,treeContext:ot,retryLane:1073741824},ot=Bg(18,null,null,0),ot.stateNode=nt,ot.return=ct,ct.child=ot,xg=ct,yg=null,!0):!1;default:return!1}}function Dg(ct){return(ct.mode&1)!==0&&(ct.flags&128)===0}function Eg(ct){if(I$1){var nt=yg;if(nt){var ot=nt;if(!Cg(ct,nt)){if(Dg(ct))throw Error(p$1(418));nt=Lf(ot.nextSibling);var rt=xg;nt&&Cg(ct,nt)?Ag(rt,ot):(ct.flags=ct.flags&-4097|2,I$1=!1,xg=ct)}}else{if(Dg(ct))throw Error(p$1(418));ct.flags=ct.flags&-4097|2,I$1=!1,xg=ct}}}function Fg(ct){for(ct=ct.return;ct!==null&&ct.tag!==5&&ct.tag!==3&&ct.tag!==13;)ct=ct.return;xg=ct}function Gg(ct){if(ct!==xg)return!1;if(!I$1)return Fg(ct),I$1=!0,!1;var nt;if((nt=ct.tag!==3)&&!(nt=ct.tag!==5)&&(nt=ct.type,nt=nt!=="head"&&nt!=="body"&&!Ef(ct.type,ct.memoizedProps)),nt&&(nt=yg)){if(Dg(ct))throw Hg(),Error(p$1(418));for(;nt;)Ag(ct,nt),nt=Lf(nt.nextSibling)}if(Fg(ct),ct.tag===13){if(ct=ct.memoizedState,ct=ct!==null?ct.dehydrated:null,!ct)throw Error(p$1(317));e:{for(ct=ct.nextSibling,nt=0;ct;){if(ct.nodeType===8){var ot=ct.data;if(ot==="/$"){if(nt===0){yg=Lf(ct.nextSibling);break e}nt--}else ot!=="$"&&ot!=="$!"&&ot!=="$?"||nt++}ct=ct.nextSibling}yg=null}}else yg=xg?Lf(ct.stateNode.nextSibling):null;return!0}function Hg(){for(var ct=yg;ct;)ct=Lf(ct.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg(ct){zg===null?zg=[ct]:zg.push(ct)}var Kg=ua.ReactCurrentBatchConfig;function Lg(ct,nt){if(ct&&ct.defaultProps){nt=A$1({},nt),ct=ct.defaultProps;for(var ot in ct)nt[ot]===void 0&&(nt[ot]=ct[ot]);return nt}return nt}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(ct){var nt=Mg.current;E(Mg),ct._currentValue=nt}function Sg(ct,nt,ot){for(;ct!==null;){var rt=ct.alternate;if((ct.childLanes&nt)!==nt?(ct.childLanes|=nt,rt!==null&&(rt.childLanes|=nt)):rt!==null&&(rt.childLanes&nt)!==nt&&(rt.childLanes|=nt),ct===ot)break;ct=ct.return}}function Tg(ct,nt){Ng=ct,Pg=Og=null,ct=ct.dependencies,ct!==null&&ct.firstContext!==null&&(ct.lanes&nt&&(Ug=!0),ct.firstContext=null)}function Vg(ct){var nt=ct._currentValue;if(Pg!==ct)if(ct={context:ct,memoizedValue:nt,next:null},Og===null){if(Ng===null)throw Error(p$1(308));Og=ct,Ng.dependencies={lanes:0,firstContext:ct}}else Og=Og.next=ct;return nt}var Wg=null;function Xg(ct){Wg===null?Wg=[ct]:Wg.push(ct)}function Yg(ct,nt,ot,rt){var ut=nt.interleaved;return ut===null?(ot.next=ot,Xg(nt)):(ot.next=ut.next,ut.next=ot),nt.interleaved=ot,Zg(ct,rt)}function Zg(ct,nt){ct.lanes|=nt;var ot=ct.alternate;for(ot!==null&&(ot.lanes|=nt),ot=ct,ct=ct.return;ct!==null;)ct.childLanes|=nt,ot=ct.alternate,ot!==null&&(ot.childLanes|=nt),ot=ct,ct=ct.return;return ot.tag===3?ot.stateNode:null}var $g=!1;function ah(ct){ct.updateQueue={baseState:ct.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(ct,nt){ct=ct.updateQueue,nt.updateQueue===ct&&(nt.updateQueue={baseState:ct.baseState,firstBaseUpdate:ct.firstBaseUpdate,lastBaseUpdate:ct.lastBaseUpdate,shared:ct.shared,effects:ct.effects})}function ch(ct,nt){return{eventTime:ct,lane:nt,tag:0,payload:null,callback:null,next:null}}function dh(ct,nt,ot){var rt=ct.updateQueue;if(rt===null)return null;if(rt=rt.shared,K&2){var ut=rt.pending;return ut===null?nt.next=nt:(nt.next=ut.next,ut.next=nt),rt.pending=nt,Zg(ct,ot)}return ut=rt.interleaved,ut===null?(nt.next=nt,Xg(rt)):(nt.next=ut.next,ut.next=nt),rt.interleaved=nt,Zg(ct,ot)}function eh(ct,nt,ot){if(nt=nt.updateQueue,nt!==null&&(nt=nt.shared,(ot&4194240)!==0)){var rt=nt.lanes;rt&=ct.pendingLanes,ot|=rt,nt.lanes=ot,Cc(ct,ot)}}function fh(ct,nt){var ot=ct.updateQueue,rt=ct.alternate;if(rt!==null&&(rt=rt.updateQueue,ot===rt)){var ut=null,gt=null;if(ot=ot.firstBaseUpdate,ot!==null){do{var pt={eventTime:ot.eventTime,lane:ot.lane,tag:ot.tag,payload:ot.payload,callback:ot.callback,next:null};gt===null?ut=gt=pt:gt=gt.next=pt,ot=ot.next}while(ot!==null);gt===null?ut=gt=nt:gt=gt.next=nt}else ut=gt=nt;ot={baseState:rt.baseState,firstBaseUpdate:ut,lastBaseUpdate:gt,shared:rt.shared,effects:rt.effects},ct.updateQueue=ot;return}ct=ot.lastBaseUpdate,ct===null?ot.firstBaseUpdate=nt:ct.next=nt,ot.lastBaseUpdate=nt}function gh(ct,nt,ot,rt){var ut=ct.updateQueue;$g=!1;var gt=ut.firstBaseUpdate,pt=ut.lastBaseUpdate,mt=ut.shared.pending;if(mt!==null){ut.shared.pending=null;var vt=mt,St=vt.next;vt.next=null,pt===null?gt=St:pt.next=St,pt=vt;var yt=ct.alternate;yt!==null&&(yt=yt.updateQueue,mt=yt.lastBaseUpdate,mt!==pt&&(mt===null?yt.firstBaseUpdate=St:mt.next=St,yt.lastBaseUpdate=vt))}if(gt!==null){var wt=ut.baseState;pt=0,yt=St=vt=null,mt=gt;do{var Lt=mt.lane,xt=mt.eventTime;if((rt&Lt)===Lt){yt!==null&&(yt=yt.next={eventTime:xt,lane:0,tag:mt.tag,payload:mt.payload,callback:mt.callback,next:null});e:{var It=ct,kt=mt;switch(Lt=nt,xt=ot,kt.tag){case 1:if(It=kt.payload,typeof It=="function"){wt=It.call(xt,wt,Lt);break e}wt=It;break e;case 3:It.flags=It.flags&-65537|128;case 0:if(It=kt.payload,Lt=typeof It=="function"?It.call(xt,wt,Lt):It,Lt==null)break e;wt=A$1({},wt,Lt);break e;case 2:$g=!0}}mt.callback!==null&&mt.lane!==0&&(ct.flags|=64,Lt=ut.effects,Lt===null?ut.effects=[mt]:Lt.push(mt))}else xt={eventTime:xt,lane:Lt,tag:mt.tag,payload:mt.payload,callback:mt.callback,next:null},yt===null?(St=yt=xt,vt=wt):yt=yt.next=xt,pt|=Lt;if(mt=mt.next,mt===null){if(mt=ut.shared.pending,mt===null)break;Lt=mt,mt=Lt.next,Lt.next=null,ut.lastBaseUpdate=Lt,ut.shared.pending=null}}while(1);if(yt===null&&(vt=wt),ut.baseState=vt,ut.firstBaseUpdate=St,ut.lastBaseUpdate=yt,nt=ut.shared.interleaved,nt!==null){ut=nt;do pt|=ut.lane,ut=ut.next;while(ut!==nt)}else gt===null&&(ut.shared.lanes=0);hh|=pt,ct.lanes=pt,ct.memoizedState=wt}}function ih(ct,nt,ot){if(ct=nt.effects,nt.effects=null,ct!==null)for(nt=0;nt<ct.length;nt++){var rt=ct[nt],ut=rt.callback;if(ut!==null){if(rt.callback=null,rt=ot,typeof ut!="function")throw Error(p$1(191,ut));ut.call(rt)}}}var jh=new aa.Component().refs;function kh(ct,nt,ot,rt){nt=ct.memoizedState,ot=ot(rt,nt),ot=ot==null?nt:A$1({},nt,ot),ct.memoizedState=ot,ct.lanes===0&&(ct.updateQueue.baseState=ot)}var nh={isMounted:function(ct){return(ct=ct._reactInternals)?Vb(ct)===ct:!1},enqueueSetState:function(ct,nt,ot){ct=ct._reactInternals;var rt=L(),ut=lh(ct),gt=ch(rt,ut);gt.payload=nt,ot!=null&&(gt.callback=ot),nt=dh(ct,gt,ut),nt!==null&&(mh(nt,ct,ut,rt),eh(nt,ct,ut))},enqueueReplaceState:function(ct,nt,ot){ct=ct._reactInternals;var rt=L(),ut=lh(ct),gt=ch(rt,ut);gt.tag=1,gt.payload=nt,ot!=null&&(gt.callback=ot),nt=dh(ct,gt,ut),nt!==null&&(mh(nt,ct,ut,rt),eh(nt,ct,ut))},enqueueForceUpdate:function(ct,nt){ct=ct._reactInternals;var ot=L(),rt=lh(ct),ut=ch(ot,rt);ut.tag=2,nt!=null&&(ut.callback=nt),nt=dh(ct,ut,rt),nt!==null&&(mh(nt,ct,rt,ot),eh(nt,ct,rt))}};function oh(ct,nt,ot,rt,ut,gt,pt){return ct=ct.stateNode,typeof ct.shouldComponentUpdate=="function"?ct.shouldComponentUpdate(rt,gt,pt):nt.prototype&&nt.prototype.isPureReactComponent?!Ie$1(ot,rt)||!Ie$1(ut,gt):!0}function ph(ct,nt,ot){var rt=!1,ut=Vf,gt=nt.contextType;return typeof gt=="object"&&gt!==null?gt=Vg(gt):(ut=Zf(nt)?Xf:H$1.current,rt=nt.contextTypes,gt=(rt=rt!=null)?Yf(ct,ut):Vf),nt=new nt(ot,gt),ct.memoizedState=nt.state!==null&&nt.state!==void 0?nt.state:null,nt.updater=nh,ct.stateNode=nt,nt._reactInternals=ct,rt&&(ct=ct.stateNode,ct.__reactInternalMemoizedUnmaskedChildContext=ut,ct.__reactInternalMemoizedMaskedChildContext=gt),nt}function qh(ct,nt,ot,rt){ct=nt.state,typeof nt.componentWillReceiveProps=="function"&&nt.componentWillReceiveProps(ot,rt),typeof nt.UNSAFE_componentWillReceiveProps=="function"&&nt.UNSAFE_componentWillReceiveProps(ot,rt),nt.state!==ct&&nh.enqueueReplaceState(nt,nt.state,null)}function rh(ct,nt,ot,rt){var ut=ct.stateNode;ut.props=ot,ut.state=ct.memoizedState,ut.refs=jh,ah(ct);var gt=nt.contextType;typeof gt=="object"&&gt!==null?ut.context=Vg(gt):(gt=Zf(nt)?Xf:H$1.current,ut.context=Yf(ct,gt)),ut.state=ct.memoizedState,gt=nt.getDerivedStateFromProps,typeof gt=="function"&&(kh(ct,nt,gt,ot),ut.state=ct.memoizedState),typeof nt.getDerivedStateFromProps=="function"||typeof ut.getSnapshotBeforeUpdate=="function"||typeof ut.UNSAFE_componentWillMount!="function"&&typeof ut.componentWillMount!="function"||(nt=ut.state,typeof ut.componentWillMount=="function"&&ut.componentWillMount(),typeof ut.UNSAFE_componentWillMount=="function"&&ut.UNSAFE_componentWillMount(),nt!==ut.state&&nh.enqueueReplaceState(ut,ut.state,null),gh(ct,ot,ut,rt),ut.state=ct.memoizedState),typeof ut.componentDidMount=="function"&&(ct.flags|=4194308)}function sh(ct,nt,ot){if(ct=ot.ref,ct!==null&&typeof ct!="function"&&typeof ct!="object"){if(ot._owner){if(ot=ot._owner,ot){if(ot.tag!==1)throw Error(p$1(309));var rt=ot.stateNode}if(!rt)throw Error(p$1(147,ct));var ut=rt,gt=""+ct;return nt!==null&&nt.ref!==null&&typeof nt.ref=="function"&&nt.ref._stringRef===gt?nt.ref:(nt=function(pt){var mt=ut.refs;mt===jh&&(mt=ut.refs={}),pt===null?delete mt[gt]:mt[gt]=pt},nt._stringRef=gt,nt)}if(typeof ct!="string")throw Error(p$1(284));if(!ot._owner)throw Error(p$1(290,ct))}return ct}function th(ct,nt){throw ct=Object.prototype.toString.call(nt),Error(p$1(31,ct==="[object Object]"?"object with keys {"+Object.keys(nt).join(", ")+"}":ct))}function uh(ct){var nt=ct._init;return nt(ct._payload)}function vh(ct){function nt(Tt,Rt){if(ct){var Nt=Tt.deletions;Nt===null?(Tt.deletions=[Rt],Tt.flags|=16):Nt.push(Rt)}}function ot(Tt,Rt){if(!ct)return null;for(;Rt!==null;)nt(Tt,Rt),Rt=Rt.sibling;return null}function rt(Tt,Rt){for(Tt=new Map;Rt!==null;)Rt.key!==null?Tt.set(Rt.key,Rt):Tt.set(Rt.index,Rt),Rt=Rt.sibling;return Tt}function ut(Tt,Rt){return Tt=wh(Tt,Rt),Tt.index=0,Tt.sibling=null,Tt}function gt(Tt,Rt,Nt){return Tt.index=Nt,ct?(Nt=Tt.alternate,Nt!==null?(Nt=Nt.index,Nt<Rt?(Tt.flags|=2,Rt):Nt):(Tt.flags|=2,Rt)):(Tt.flags|=1048576,Rt)}function pt(Tt){return ct&&Tt.alternate===null&&(Tt.flags|=2),Tt}function mt(Tt,Rt,Nt,Pt){return Rt===null||Rt.tag!==6?(Rt=xh(Nt,Tt.mode,Pt),Rt.return=Tt,Rt):(Rt=ut(Rt,Nt),Rt.return=Tt,Rt)}function vt(Tt,Rt,Nt,Pt){var Ft=Nt.type;return Ft===ya?yt(Tt,Rt,Nt.props.children,Pt,Nt.key):Rt!==null&&(Rt.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===Ha&&uh(Ft)===Rt.type)?(Pt=ut(Rt,Nt.props),Pt.ref=sh(Tt,Rt,Nt),Pt.return=Tt,Pt):(Pt=yh(Nt.type,Nt.key,Nt.props,null,Tt.mode,Pt),Pt.ref=sh(Tt,Rt,Nt),Pt.return=Tt,Pt)}function St(Tt,Rt,Nt,Pt){return Rt===null||Rt.tag!==4||Rt.stateNode.containerInfo!==Nt.containerInfo||Rt.stateNode.implementation!==Nt.implementation?(Rt=zh(Nt,Tt.mode,Pt),Rt.return=Tt,Rt):(Rt=ut(Rt,Nt.children||[]),Rt.return=Tt,Rt)}function yt(Tt,Rt,Nt,Pt,Ft){return Rt===null||Rt.tag!==7?(Rt=Ah(Nt,Tt.mode,Pt,Ft),Rt.return=Tt,Rt):(Rt=ut(Rt,Nt),Rt.return=Tt,Rt)}function wt(Tt,Rt,Nt){if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number")return Rt=xh(""+Rt,Tt.mode,Nt),Rt.return=Tt,Rt;if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case va:return Nt=yh(Rt.type,Rt.key,Rt.props,null,Tt.mode,Nt),Nt.ref=sh(Tt,null,Rt),Nt.return=Tt,Nt;case wa:return Rt=zh(Rt,Tt.mode,Nt),Rt.return=Tt,Rt;case Ha:var Pt=Rt._init;return wt(Tt,Pt(Rt._payload),Nt)}if(eb(Rt)||Ka(Rt))return Rt=Ah(Rt,Tt.mode,Nt,null),Rt.return=Tt,Rt;th(Tt,Rt)}return null}function Lt(Tt,Rt,Nt,Pt){var Ft=Rt!==null?Rt.key:null;if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number")return Ft!==null?null:mt(Tt,Rt,""+Nt,Pt);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case va:return Nt.key===Ft?vt(Tt,Rt,Nt,Pt):null;case wa:return Nt.key===Ft?St(Tt,Rt,Nt,Pt):null;case Ha:return Ft=Nt._init,Lt(Tt,Rt,Ft(Nt._payload),Pt)}if(eb(Nt)||Ka(Nt))return Ft!==null?null:yt(Tt,Rt,Nt,Pt,null);th(Tt,Nt)}return null}function xt(Tt,Rt,Nt,Pt,Ft){if(typeof Pt=="string"&&Pt!==""||typeof Pt=="number")return Tt=Tt.get(Nt)||null,mt(Rt,Tt,""+Pt,Ft);if(typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case va:return Tt=Tt.get(Pt.key===null?Nt:Pt.key)||null,vt(Rt,Tt,Pt,Ft);case wa:return Tt=Tt.get(Pt.key===null?Nt:Pt.key)||null,St(Rt,Tt,Pt,Ft);case Ha:var Kt=Pt._init;return xt(Tt,Rt,Nt,Kt(Pt._payload),Ft)}if(eb(Pt)||Ka(Pt))return Tt=Tt.get(Nt)||null,yt(Rt,Tt,Pt,Ft,null);th(Rt,Pt)}return null}function It(Tt,Rt,Nt,Pt){for(var Ft=null,Kt=null,Bt=Rt,Ut=Rt=0,qt=null;Bt!==null&&Ut<Nt.length;Ut++){Bt.index>Ut?(qt=Bt,Bt=null):qt=Bt.sibling;var Yt=Lt(Tt,Bt,Nt[Ut],Pt);if(Yt===null){Bt===null&&(Bt=qt);break}ct&&Bt&&Yt.alternate===null&&nt(Tt,Bt),Rt=gt(Yt,Rt,Ut),Kt===null?Ft=Yt:Kt.sibling=Yt,Kt=Yt,Bt=qt}if(Ut===Nt.length)return ot(Tt,Bt),I$1&&tg(Tt,Ut),Ft;if(Bt===null){for(;Ut<Nt.length;Ut++)Bt=wt(Tt,Nt[Ut],Pt),Bt!==null&&(Rt=gt(Bt,Rt,Ut),Kt===null?Ft=Bt:Kt.sibling=Bt,Kt=Bt);return I$1&&tg(Tt,Ut),Ft}for(Bt=rt(Tt,Bt);Ut<Nt.length;Ut++)qt=xt(Bt,Tt,Ut,Nt[Ut],Pt),qt!==null&&(ct&&qt.alternate!==null&&Bt.delete(qt.key===null?Ut:qt.key),Rt=gt(qt,Rt,Ut),Kt===null?Ft=qt:Kt.sibling=qt,Kt=qt);return ct&&Bt.forEach(function(Zt){return nt(Tt,Zt)}),I$1&&tg(Tt,Ut),Ft}function kt(Tt,Rt,Nt,Pt){var Ft=Ka(Nt);if(typeof Ft!="function")throw Error(p$1(150));if(Nt=Ft.call(Nt),Nt==null)throw Error(p$1(151));for(var Kt=Ft=null,Bt=Rt,Ut=Rt=0,qt=null,Yt=Nt.next();Bt!==null&&!Yt.done;Ut++,Yt=Nt.next()){Bt.index>Ut?(qt=Bt,Bt=null):qt=Bt.sibling;var Zt=Lt(Tt,Bt,Yt.value,Pt);if(Zt===null){Bt===null&&(Bt=qt);break}ct&&Bt&&Zt.alternate===null&&nt(Tt,Bt),Rt=gt(Zt,Rt,Ut),Kt===null?Ft=Zt:Kt.sibling=Zt,Kt=Zt,Bt=qt}if(Yt.done)return ot(Tt,Bt),I$1&&tg(Tt,Ut),Ft;if(Bt===null){for(;!Yt.done;Ut++,Yt=Nt.next())Yt=wt(Tt,Yt.value,Pt),Yt!==null&&(Rt=gt(Yt,Rt,Ut),Kt===null?Ft=Yt:Kt.sibling=Yt,Kt=Yt);return I$1&&tg(Tt,Ut),Ft}for(Bt=rt(Tt,Bt);!Yt.done;Ut++,Yt=Nt.next())Yt=xt(Bt,Tt,Ut,Yt.value,Pt),Yt!==null&&(ct&&Yt.alternate!==null&&Bt.delete(Yt.key===null?Ut:Yt.key),Rt=gt(Yt,Rt,Ut),Kt===null?Ft=Yt:Kt.sibling=Yt,Kt=Yt);return ct&&Bt.forEach(function(Xt){return nt(Tt,Xt)}),I$1&&tg(Tt,Ut),Ft}function At(Tt,Rt,Nt,Pt){if(typeof Nt=="object"&&Nt!==null&&Nt.type===ya&&Nt.key===null&&(Nt=Nt.props.children),typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case va:e:{for(var Ft=Nt.key,Kt=Rt;Kt!==null;){if(Kt.key===Ft){if(Ft=Nt.type,Ft===ya){if(Kt.tag===7){ot(Tt,Kt.sibling),Rt=ut(Kt,Nt.props.children),Rt.return=Tt,Tt=Rt;break e}}else if(Kt.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===Ha&&uh(Ft)===Kt.type){ot(Tt,Kt.sibling),Rt=ut(Kt,Nt.props),Rt.ref=sh(Tt,Kt,Nt),Rt.return=Tt,Tt=Rt;break e}ot(Tt,Kt);break}else nt(Tt,Kt);Kt=Kt.sibling}Nt.type===ya?(Rt=Ah(Nt.props.children,Tt.mode,Pt,Nt.key),Rt.return=Tt,Tt=Rt):(Pt=yh(Nt.type,Nt.key,Nt.props,null,Tt.mode,Pt),Pt.ref=sh(Tt,Rt,Nt),Pt.return=Tt,Tt=Pt)}return pt(Tt);case wa:e:{for(Kt=Nt.key;Rt!==null;){if(Rt.key===Kt)if(Rt.tag===4&&Rt.stateNode.containerInfo===Nt.containerInfo&&Rt.stateNode.implementation===Nt.implementation){ot(Tt,Rt.sibling),Rt=ut(Rt,Nt.children||[]),Rt.return=Tt,Tt=Rt;break e}else{ot(Tt,Rt);break}else nt(Tt,Rt);Rt=Rt.sibling}Rt=zh(Nt,Tt.mode,Pt),Rt.return=Tt,Tt=Rt}return pt(Tt);case Ha:return Kt=Nt._init,At(Tt,Rt,Kt(Nt._payload),Pt)}if(eb(Nt))return It(Tt,Rt,Nt,Pt);if(Ka(Nt))return kt(Tt,Rt,Nt,Pt);th(Tt,Nt)}return typeof Nt=="string"&&Nt!==""||typeof Nt=="number"?(Nt=""+Nt,Rt!==null&&Rt.tag===6?(ot(Tt,Rt.sibling),Rt=ut(Rt,Nt),Rt.return=Tt,Tt=Rt):(ot(Tt,Rt),Rt=xh(Nt,Tt.mode,Pt),Rt.return=Tt,Tt=Rt),pt(Tt)):ot(Tt,Rt)}return At}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(ct){if(ct===Dh)throw Error(p$1(174));return ct}function Ih(ct,nt){switch(G$1(Gh,nt),G$1(Fh,ct),G$1(Eh,Dh),ct=nt.nodeType,ct){case 9:case 11:nt=(nt=nt.documentElement)?nt.namespaceURI:lb(null,"");break;default:ct=ct===8?nt.parentNode:nt,nt=ct.namespaceURI||null,ct=ct.tagName,nt=lb(nt,ct)}E(Eh),G$1(Eh,nt)}function Jh(){E(Eh),E(Fh),E(Gh)}function Kh(ct){Hh(Gh.current);var nt=Hh(Eh.current),ot=lb(nt,ct.type);nt!==ot&&(G$1(Fh,ct),G$1(Eh,ot))}function Lh(ct){Fh.current===ct&&(E(Eh),E(Fh))}var M$1=Uf(0);function Mh(ct){for(var nt=ct;nt!==null;){if(nt.tag===13){var ot=nt.memoizedState;if(ot!==null&&(ot=ot.dehydrated,ot===null||ot.data==="$?"||ot.data==="$!"))return nt}else if(nt.tag===19&&nt.memoizedProps.revealOrder!==void 0){if(nt.flags&128)return nt}else if(nt.child!==null){nt.child.return=nt,nt=nt.child;continue}if(nt===ct)break;for(;nt.sibling===null;){if(nt.return===null||nt.return===ct)return null;nt=nt.return}nt.sibling.return=nt.return,nt=nt.sibling}return null}var Nh=[];function Oh(){for(var ct=0;ct<Nh.length;ct++)Nh[ct]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N=null,O$1=null,P$1=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q$1(){throw Error(p$1(321))}function Wh(ct,nt){if(nt===null)return!1;for(var ot=0;ot<nt.length&&ot<ct.length;ot++)if(!He(ct[ot],nt[ot]))return!1;return!0}function Xh(ct,nt,ot,rt,ut,gt){if(Rh=gt,N=nt,nt.memoizedState=null,nt.updateQueue=null,nt.lanes=0,Ph.current=ct===null||ct.memoizedState===null?Yh:Zh,ct=ot(rt,ut),Th){gt=0;do{if(Th=!1,Uh=0,25<=gt)throw Error(p$1(301));gt+=1,P$1=O$1=null,nt.updateQueue=null,Ph.current=$h,ct=ot(rt,ut)}while(Th)}if(Ph.current=ai,nt=O$1!==null&&O$1.next!==null,Rh=0,P$1=O$1=N=null,Sh=!1,nt)throw Error(p$1(300));return ct}function bi(){var ct=Uh!==0;return Uh=0,ct}function ci(){var ct={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P$1===null?N.memoizedState=P$1=ct:P$1=P$1.next=ct,P$1}function di(){if(O$1===null){var ct=N.alternate;ct=ct!==null?ct.memoizedState:null}else ct=O$1.next;var nt=P$1===null?N.memoizedState:P$1.next;if(nt!==null)P$1=nt,O$1=ct;else{if(ct===null)throw Error(p$1(310));O$1=ct,ct={memoizedState:O$1.memoizedState,baseState:O$1.baseState,baseQueue:O$1.baseQueue,queue:O$1.queue,next:null},P$1===null?N.memoizedState=P$1=ct:P$1=P$1.next=ct}return P$1}function ei(ct,nt){return typeof nt=="function"?nt(ct):nt}function fi(ct){var nt=di(),ot=nt.queue;if(ot===null)throw Error(p$1(311));ot.lastRenderedReducer=ct;var rt=O$1,ut=rt.baseQueue,gt=ot.pending;if(gt!==null){if(ut!==null){var pt=ut.next;ut.next=gt.next,gt.next=pt}rt.baseQueue=ut=gt,ot.pending=null}if(ut!==null){gt=ut.next,rt=rt.baseState;var mt=pt=null,vt=null,St=gt;do{var yt=St.lane;if((Rh&yt)===yt)vt!==null&&(vt=vt.next={lane:0,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null}),rt=St.hasEagerState?St.eagerState:ct(rt,St.action);else{var wt={lane:yt,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null};vt===null?(mt=vt=wt,pt=rt):vt=vt.next=wt,N.lanes|=yt,hh|=yt}St=St.next}while(St!==null&&St!==gt);vt===null?pt=rt:vt.next=mt,He(rt,nt.memoizedState)||(Ug=!0),nt.memoizedState=rt,nt.baseState=pt,nt.baseQueue=vt,ot.lastRenderedState=rt}if(ct=ot.interleaved,ct!==null){ut=ct;do gt=ut.lane,N.lanes|=gt,hh|=gt,ut=ut.next;while(ut!==ct)}else ut===null&&(ot.lanes=0);return[nt.memoizedState,ot.dispatch]}function gi(ct){var nt=di(),ot=nt.queue;if(ot===null)throw Error(p$1(311));ot.lastRenderedReducer=ct;var rt=ot.dispatch,ut=ot.pending,gt=nt.memoizedState;if(ut!==null){ot.pending=null;var pt=ut=ut.next;do gt=ct(gt,pt.action),pt=pt.next;while(pt!==ut);He(gt,nt.memoizedState)||(Ug=!0),nt.memoizedState=gt,nt.baseQueue===null&&(nt.baseState=gt),ot.lastRenderedState=gt}return[gt,rt]}function hi$1(){}function ii(ct,nt){var ot=N,rt=di(),ut=nt(),gt=!He(rt.memoizedState,ut);if(gt&&(rt.memoizedState=ut,Ug=!0),rt=rt.queue,ji(ki.bind(null,ot,rt,ct),[ct]),rt.getSnapshot!==nt||gt||P$1!==null&&P$1.memoizedState.tag&1){if(ot.flags|=2048,li(9,mi.bind(null,ot,rt,ut,nt),void 0,null),R$1===null)throw Error(p$1(349));Rh&30||ni(ot,nt,ut)}return ut}function ni(ct,nt,ot){ct.flags|=16384,ct={getSnapshot:nt,value:ot},nt=N.updateQueue,nt===null?(nt={lastEffect:null,stores:null},N.updateQueue=nt,nt.stores=[ct]):(ot=nt.stores,ot===null?nt.stores=[ct]:ot.push(ct))}function mi(ct,nt,ot,rt){nt.value=ot,nt.getSnapshot=rt,oi(nt)&&pi(ct)}function ki(ct,nt,ot){return ot(function(){oi(nt)&&pi(ct)})}function oi(ct){var nt=ct.getSnapshot;ct=ct.value;try{var ot=nt();return!He(ct,ot)}catch{return!0}}function pi(ct){var nt=Zg(ct,1);nt!==null&&mh(nt,ct,1,-1)}function qi(ct){var nt=ci();return typeof ct=="function"&&(ct=ct()),nt.memoizedState=nt.baseState=ct,ct={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:ct},nt.queue=ct,ct=ct.dispatch=ri.bind(null,N,ct),[nt.memoizedState,ct]}function li(ct,nt,ot,rt){return ct={tag:ct,create:nt,destroy:ot,deps:rt,next:null},nt=N.updateQueue,nt===null?(nt={lastEffect:null,stores:null},N.updateQueue=nt,nt.lastEffect=ct.next=ct):(ot=nt.lastEffect,ot===null?nt.lastEffect=ct.next=ct:(rt=ot.next,ot.next=ct,ct.next=rt,nt.lastEffect=ct)),ct}function si(){return di().memoizedState}function ti(ct,nt,ot,rt){var ut=ci();N.flags|=ct,ut.memoizedState=li(1|nt,ot,void 0,rt===void 0?null:rt)}function ui(ct,nt,ot,rt){var ut=di();rt=rt===void 0?null:rt;var gt=void 0;if(O$1!==null){var pt=O$1.memoizedState;if(gt=pt.destroy,rt!==null&&Wh(rt,pt.deps)){ut.memoizedState=li(nt,ot,gt,rt);return}}N.flags|=ct,ut.memoizedState=li(1|nt,ot,gt,rt)}function vi(ct,nt){return ti(8390656,8,ct,nt)}function ji(ct,nt){return ui(2048,8,ct,nt)}function wi(ct,nt){return ui(4,2,ct,nt)}function xi(ct,nt){return ui(4,4,ct,nt)}function yi(ct,nt){if(typeof nt=="function")return ct=ct(),nt(ct),function(){nt(null)};if(nt!=null)return ct=ct(),nt.current=ct,function(){nt.current=null}}function zi(ct,nt,ot){return ot=ot!=null?ot.concat([ct]):null,ui(4,4,yi.bind(null,nt,ct),ot)}function Ai(){}function Bi(ct,nt){var ot=di();nt=nt===void 0?null:nt;var rt=ot.memoizedState;return rt!==null&&nt!==null&&Wh(nt,rt[1])?rt[0]:(ot.memoizedState=[ct,nt],ct)}function Ci(ct,nt){var ot=di();nt=nt===void 0?null:nt;var rt=ot.memoizedState;return rt!==null&&nt!==null&&Wh(nt,rt[1])?rt[0]:(ct=ct(),ot.memoizedState=[ct,nt],ct)}function Di(ct,nt,ot){return Rh&21?(He(ot,nt)||(ot=yc(),N.lanes|=ot,hh|=ot,ct.baseState=!0),nt):(ct.baseState&&(ct.baseState=!1,Ug=!0),ct.memoizedState=ot)}function Ei(ct,nt){var ot=C;C=ot!==0&&4>ot?ot:4,ct(!0);var rt=Qh.transition;Qh.transition={};try{ct(!1),nt()}finally{C=ot,Qh.transition=rt}}function Fi(){return di().memoizedState}function Gi(ct,nt,ot){var rt=lh(ct);if(ot={lane:rt,action:ot,hasEagerState:!1,eagerState:null,next:null},Hi(ct))Ii(nt,ot);else if(ot=Yg(ct,nt,ot,rt),ot!==null){var ut=L();mh(ot,ct,rt,ut),Ji(ot,nt,rt)}}function ri(ct,nt,ot){var rt=lh(ct),ut={lane:rt,action:ot,hasEagerState:!1,eagerState:null,next:null};if(Hi(ct))Ii(nt,ut);else{var gt=ct.alternate;if(ct.lanes===0&&(gt===null||gt.lanes===0)&&(gt=nt.lastRenderedReducer,gt!==null))try{var pt=nt.lastRenderedState,mt=gt(pt,ot);if(ut.hasEagerState=!0,ut.eagerState=mt,He(mt,pt)){var vt=nt.interleaved;vt===null?(ut.next=ut,Xg(nt)):(ut.next=vt.next,vt.next=ut),nt.interleaved=ut;return}}catch{}finally{}ot=Yg(ct,nt,ut,rt),ot!==null&&(ut=L(),mh(ot,ct,rt,ut),Ji(ot,nt,rt))}}function Hi(ct){var nt=ct.alternate;return ct===N||nt!==null&&nt===N}function Ii(ct,nt){Th=Sh=!0;var ot=ct.pending;ot===null?nt.next=nt:(nt.next=ot.next,ot.next=nt),ct.pending=nt}function Ji(ct,nt,ot){if(ot&4194240){var rt=nt.lanes;rt&=ct.pendingLanes,ot|=rt,nt.lanes=ot,Cc(ct,ot)}}var ai={readContext:Vg,useCallback:Q$1,useContext:Q$1,useEffect:Q$1,useImperativeHandle:Q$1,useInsertionEffect:Q$1,useLayoutEffect:Q$1,useMemo:Q$1,useReducer:Q$1,useRef:Q$1,useState:Q$1,useDebugValue:Q$1,useDeferredValue:Q$1,useTransition:Q$1,useMutableSource:Q$1,useSyncExternalStore:Q$1,useId:Q$1,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(ct,nt){return ci().memoizedState=[ct,nt===void 0?null:nt],ct},useContext:Vg,useEffect:vi,useImperativeHandle:function(ct,nt,ot){return ot=ot!=null?ot.concat([ct]):null,ti(4194308,4,yi.bind(null,nt,ct),ot)},useLayoutEffect:function(ct,nt){return ti(4194308,4,ct,nt)},useInsertionEffect:function(ct,nt){return ti(4,2,ct,nt)},useMemo:function(ct,nt){var ot=ci();return nt=nt===void 0?null:nt,ct=ct(),ot.memoizedState=[ct,nt],ct},useReducer:function(ct,nt,ot){var rt=ci();return nt=ot!==void 0?ot(nt):nt,rt.memoizedState=rt.baseState=nt,ct={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ct,lastRenderedState:nt},rt.queue=ct,ct=ct.dispatch=Gi.bind(null,N,ct),[rt.memoizedState,ct]},useRef:function(ct){var nt=ci();return ct={current:ct},nt.memoizedState=ct},useState:qi,useDebugValue:Ai,useDeferredValue:function(ct){return ci().memoizedState=ct},useTransition:function(){var ct=qi(!1),nt=ct[0];return ct=Ei.bind(null,ct[1]),ci().memoizedState=ct,[nt,ct]},useMutableSource:function(){},useSyncExternalStore:function(ct,nt,ot){var rt=N,ut=ci();if(I$1){if(ot===void 0)throw Error(p$1(407));ot=ot()}else{if(ot=nt(),R$1===null)throw Error(p$1(349));Rh&30||ni(rt,nt,ot)}ut.memoizedState=ot;var gt={value:ot,getSnapshot:nt};return ut.queue=gt,vi(ki.bind(null,rt,gt,ct),[ct]),rt.flags|=2048,li(9,mi.bind(null,rt,gt,ot,nt),void 0,null),ot},useId:function(){var ct=ci(),nt=R$1.identifierPrefix;if(I$1){var ot=sg,rt=rg;ot=(rt&~(1<<32-oc(rt)-1)).toString(32)+ot,nt=":"+nt+"R"+ot,ot=Uh++,0<ot&&(nt+="H"+ot.toString(32)),nt+=":"}else ot=Vh++,nt=":"+nt+"r"+ot.toString(32)+":";return ct.memoizedState=nt},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(ct){var nt=di();return Di(nt,O$1.memoizedState,ct)},useTransition:function(){var ct=fi(ei)[0],nt=di().memoizedState;return[ct,nt]},useMutableSource:hi$1,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(ct){var nt=di();return O$1===null?nt.memoizedState=ct:Di(nt,O$1.memoizedState,ct)},useTransition:function(){var ct=gi(ei)[0],nt=di().memoizedState;return[ct,nt]},useMutableSource:hi$1,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(ct,nt){try{var ot="",rt=nt;do ot+=Pa(rt),rt=rt.return;while(rt);var ut=ot}catch(gt){ut=`
Error generating stack: `+gt.message+`
`+gt.stack}return{value:ct,source:nt,stack:ut,digest:null}}function Li(ct,nt,ot){return{value:ct,source:null,stack:ot??null,digest:nt??null}}function Mi(ct,nt){try{console.error(nt.value)}catch(ot){setTimeout(function(){throw ot})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(ct,nt,ot){ot=ch(-1,ot),ot.tag=3,ot.payload={element:null};var rt=nt.value;return ot.callback=function(){Pi||(Pi=!0,Qi=rt),Mi(ct,nt)},ot}function Ri(ct,nt,ot){ot=ch(-1,ot),ot.tag=3;var rt=ct.type.getDerivedStateFromError;if(typeof rt=="function"){var ut=nt.value;ot.payload=function(){return rt(ut)},ot.callback=function(){Mi(ct,nt)}}var gt=ct.stateNode;return gt!==null&&typeof gt.componentDidCatch=="function"&&(ot.callback=function(){Mi(ct,nt),typeof rt!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var pt=nt.stack;this.componentDidCatch(nt.value,{componentStack:pt!==null?pt:""})}),ot}function Ti(ct,nt,ot){var rt=ct.pingCache;if(rt===null){rt=ct.pingCache=new Ni;var ut=new Set;rt.set(nt,ut)}else ut=rt.get(nt),ut===void 0&&(ut=new Set,rt.set(nt,ut));ut.has(ot)||(ut.add(ot),ct=Ui.bind(null,ct,nt,ot),nt.then(ct,ct))}function Vi(ct){do{var nt;if((nt=ct.tag===13)&&(nt=ct.memoizedState,nt=nt!==null?nt.dehydrated!==null:!0),nt)return ct;ct=ct.return}while(ct!==null);return null}function Wi(ct,nt,ot,rt,ut){return ct.mode&1?(ct.flags|=65536,ct.lanes=ut,ct):(ct===nt?ct.flags|=65536:(ct.flags|=128,ot.flags|=131072,ot.flags&=-52805,ot.tag===1&&(ot.alternate===null?ot.tag=17:(nt=ch(-1,1),nt.tag=2,dh(ot,nt,1))),ot.lanes|=1),ct)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(ct,nt,ot,rt){nt.child=ct===null?Ch(nt,null,ot,rt):Bh(nt,ct.child,ot,rt)}function Zi(ct,nt,ot,rt,ut){ot=ot.render;var gt=nt.ref;return Tg(nt,ut),rt=Xh(ct,nt,ot,rt,gt,ut),ot=bi(),ct!==null&&!Ug?(nt.updateQueue=ct.updateQueue,nt.flags&=-2053,ct.lanes&=~ut,$i(ct,nt,ut)):(I$1&&ot&&vg(nt),nt.flags|=1,Yi(ct,nt,rt,ut),nt.child)}function aj(ct,nt,ot,rt,ut){if(ct===null){var gt=ot.type;return typeof gt=="function"&&!bj(gt)&&gt.defaultProps===void 0&&ot.compare===null&&ot.defaultProps===void 0?(nt.tag=15,nt.type=gt,cj(ct,nt,gt,rt,ut)):(ct=yh(ot.type,null,rt,nt,nt.mode,ut),ct.ref=nt.ref,ct.return=nt,nt.child=ct)}if(gt=ct.child,!(ct.lanes&ut)){var pt=gt.memoizedProps;if(ot=ot.compare,ot=ot!==null?ot:Ie$1,ot(pt,rt)&&ct.ref===nt.ref)return $i(ct,nt,ut)}return nt.flags|=1,ct=wh(gt,rt),ct.ref=nt.ref,ct.return=nt,nt.child=ct}function cj(ct,nt,ot,rt,ut){if(ct!==null){var gt=ct.memoizedProps;if(Ie$1(gt,rt)&&ct.ref===nt.ref)if(Ug=!1,nt.pendingProps=rt=gt,(ct.lanes&ut)!==0)ct.flags&131072&&(Ug=!0);else return nt.lanes=ct.lanes,$i(ct,nt,ut)}return dj(ct,nt,ot,rt,ut)}function ej(ct,nt,ot){var rt=nt.pendingProps,ut=rt.children,gt=ct!==null?ct.memoizedState:null;if(rt.mode==="hidden")if(!(nt.mode&1))nt.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(fj,gj),gj|=ot;else{if(!(ot&1073741824))return ct=gt!==null?gt.baseLanes|ot:ot,nt.lanes=nt.childLanes=1073741824,nt.memoizedState={baseLanes:ct,cachePool:null,transitions:null},nt.updateQueue=null,G$1(fj,gj),gj|=ct,null;nt.memoizedState={baseLanes:0,cachePool:null,transitions:null},rt=gt!==null?gt.baseLanes:ot,G$1(fj,gj),gj|=rt}else gt!==null?(rt=gt.baseLanes|ot,nt.memoizedState=null):rt=ot,G$1(fj,gj),gj|=rt;return Yi(ct,nt,ut,ot),nt.child}function hj(ct,nt){var ot=nt.ref;(ct===null&&ot!==null||ct!==null&&ct.ref!==ot)&&(nt.flags|=512,nt.flags|=2097152)}function dj(ct,nt,ot,rt,ut){var gt=Zf(ot)?Xf:H$1.current;return gt=Yf(nt,gt),Tg(nt,ut),ot=Xh(ct,nt,ot,rt,gt,ut),rt=bi(),ct!==null&&!Ug?(nt.updateQueue=ct.updateQueue,nt.flags&=-2053,ct.lanes&=~ut,$i(ct,nt,ut)):(I$1&&rt&&vg(nt),nt.flags|=1,Yi(ct,nt,ot,ut),nt.child)}function ij(ct,nt,ot,rt,ut){if(Zf(ot)){var gt=!0;cg(nt)}else gt=!1;if(Tg(nt,ut),nt.stateNode===null)jj(ct,nt),ph(nt,ot,rt),rh(nt,ot,rt,ut),rt=!0;else if(ct===null){var pt=nt.stateNode,mt=nt.memoizedProps;pt.props=mt;var vt=pt.context,St=ot.contextType;typeof St=="object"&&St!==null?St=Vg(St):(St=Zf(ot)?Xf:H$1.current,St=Yf(nt,St));var yt=ot.getDerivedStateFromProps,wt=typeof yt=="function"||typeof pt.getSnapshotBeforeUpdate=="function";wt||typeof pt.UNSAFE_componentWillReceiveProps!="function"&&typeof pt.componentWillReceiveProps!="function"||(mt!==rt||vt!==St)&&qh(nt,pt,rt,St),$g=!1;var Lt=nt.memoizedState;pt.state=Lt,gh(nt,rt,pt,ut),vt=nt.memoizedState,mt!==rt||Lt!==vt||Wf.current||$g?(typeof yt=="function"&&(kh(nt,ot,yt,rt),vt=nt.memoizedState),(mt=$g||oh(nt,ot,mt,rt,Lt,vt,St))?(wt||typeof pt.UNSAFE_componentWillMount!="function"&&typeof pt.componentWillMount!="function"||(typeof pt.componentWillMount=="function"&&pt.componentWillMount(),typeof pt.UNSAFE_componentWillMount=="function"&&pt.UNSAFE_componentWillMount()),typeof pt.componentDidMount=="function"&&(nt.flags|=4194308)):(typeof pt.componentDidMount=="function"&&(nt.flags|=4194308),nt.memoizedProps=rt,nt.memoizedState=vt),pt.props=rt,pt.state=vt,pt.context=St,rt=mt):(typeof pt.componentDidMount=="function"&&(nt.flags|=4194308),rt=!1)}else{pt=nt.stateNode,bh(ct,nt),mt=nt.memoizedProps,St=nt.type===nt.elementType?mt:Lg(nt.type,mt),pt.props=St,wt=nt.pendingProps,Lt=pt.context,vt=ot.contextType,typeof vt=="object"&&vt!==null?vt=Vg(vt):(vt=Zf(ot)?Xf:H$1.current,vt=Yf(nt,vt));var xt=ot.getDerivedStateFromProps;(yt=typeof xt=="function"||typeof pt.getSnapshotBeforeUpdate=="function")||typeof pt.UNSAFE_componentWillReceiveProps!="function"&&typeof pt.componentWillReceiveProps!="function"||(mt!==wt||Lt!==vt)&&qh(nt,pt,rt,vt),$g=!1,Lt=nt.memoizedState,pt.state=Lt,gh(nt,rt,pt,ut);var It=nt.memoizedState;mt!==wt||Lt!==It||Wf.current||$g?(typeof xt=="function"&&(kh(nt,ot,xt,rt),It=nt.memoizedState),(St=$g||oh(nt,ot,St,rt,Lt,It,vt)||!1)?(yt||typeof pt.UNSAFE_componentWillUpdate!="function"&&typeof pt.componentWillUpdate!="function"||(typeof pt.componentWillUpdate=="function"&&pt.componentWillUpdate(rt,It,vt),typeof pt.UNSAFE_componentWillUpdate=="function"&&pt.UNSAFE_componentWillUpdate(rt,It,vt)),typeof pt.componentDidUpdate=="function"&&(nt.flags|=4),typeof pt.getSnapshotBeforeUpdate=="function"&&(nt.flags|=1024)):(typeof pt.componentDidUpdate!="function"||mt===ct.memoizedProps&&Lt===ct.memoizedState||(nt.flags|=4),typeof pt.getSnapshotBeforeUpdate!="function"||mt===ct.memoizedProps&&Lt===ct.memoizedState||(nt.flags|=1024),nt.memoizedProps=rt,nt.memoizedState=It),pt.props=rt,pt.state=It,pt.context=vt,rt=St):(typeof pt.componentDidUpdate!="function"||mt===ct.memoizedProps&&Lt===ct.memoizedState||(nt.flags|=4),typeof pt.getSnapshotBeforeUpdate!="function"||mt===ct.memoizedProps&&Lt===ct.memoizedState||(nt.flags|=1024),rt=!1)}return kj(ct,nt,ot,rt,gt,ut)}function kj(ct,nt,ot,rt,ut,gt){hj(ct,nt);var pt=(nt.flags&128)!==0;if(!rt&&!pt)return ut&&dg(nt,ot,!1),$i(ct,nt,gt);rt=nt.stateNode,Xi.current=nt;var mt=pt&&typeof ot.getDerivedStateFromError!="function"?null:rt.render();return nt.flags|=1,ct!==null&&pt?(nt.child=Bh(nt,ct.child,null,gt),nt.child=Bh(nt,null,mt,gt)):Yi(ct,nt,mt,gt),nt.memoizedState=rt.state,ut&&dg(nt,ot,!0),nt.child}function lj(ct){var nt=ct.stateNode;nt.pendingContext?ag(ct,nt.pendingContext,nt.pendingContext!==nt.context):nt.context&&ag(ct,nt.context,!1),Ih(ct,nt.containerInfo)}function mj(ct,nt,ot,rt,ut){return Ig(),Jg(ut),nt.flags|=256,Yi(ct,nt,ot,rt),nt.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(ct){return{baseLanes:ct,cachePool:null,transitions:null}}function pj(ct,nt,ot){var rt=nt.pendingProps,ut=M$1.current,gt=!1,pt=(nt.flags&128)!==0,mt;if((mt=pt)||(mt=ct!==null&&ct.memoizedState===null?!1:(ut&2)!==0),mt?(gt=!0,nt.flags&=-129):(ct===null||ct.memoizedState!==null)&&(ut|=1),G$1(M$1,ut&1),ct===null)return Eg(nt),ct=nt.memoizedState,ct!==null&&(ct=ct.dehydrated,ct!==null)?(nt.mode&1?ct.data==="$!"?nt.lanes=8:nt.lanes=1073741824:nt.lanes=1,null):(pt=rt.children,ct=rt.fallback,gt?(rt=nt.mode,gt=nt.child,pt={mode:"hidden",children:pt},!(rt&1)&&gt!==null?(gt.childLanes=0,gt.pendingProps=pt):gt=qj(pt,rt,0,null),ct=Ah(ct,rt,ot,null),gt.return=nt,ct.return=nt,gt.sibling=ct,nt.child=gt,nt.child.memoizedState=oj(ot),nt.memoizedState=nj,ct):rj(nt,pt));if(ut=ct.memoizedState,ut!==null&&(mt=ut.dehydrated,mt!==null))return sj(ct,nt,pt,rt,mt,ut,ot);if(gt){gt=rt.fallback,pt=nt.mode,ut=ct.child,mt=ut.sibling;var vt={mode:"hidden",children:rt.children};return!(pt&1)&&nt.child!==ut?(rt=nt.child,rt.childLanes=0,rt.pendingProps=vt,nt.deletions=null):(rt=wh(ut,vt),rt.subtreeFlags=ut.subtreeFlags&14680064),mt!==null?gt=wh(mt,gt):(gt=Ah(gt,pt,ot,null),gt.flags|=2),gt.return=nt,rt.return=nt,rt.sibling=gt,nt.child=rt,rt=gt,gt=nt.child,pt=ct.child.memoizedState,pt=pt===null?oj(ot):{baseLanes:pt.baseLanes|ot,cachePool:null,transitions:pt.transitions},gt.memoizedState=pt,gt.childLanes=ct.childLanes&~ot,nt.memoizedState=nj,rt}return gt=ct.child,ct=gt.sibling,rt=wh(gt,{mode:"visible",children:rt.children}),!(nt.mode&1)&&(rt.lanes=ot),rt.return=nt,rt.sibling=null,ct!==null&&(ot=nt.deletions,ot===null?(nt.deletions=[ct],nt.flags|=16):ot.push(ct)),nt.child=rt,nt.memoizedState=null,rt}function rj(ct,nt){return nt=qj({mode:"visible",children:nt},ct.mode,0,null),nt.return=ct,ct.child=nt}function tj(ct,nt,ot,rt){return rt!==null&&Jg(rt),Bh(nt,ct.child,null,ot),ct=rj(nt,nt.pendingProps.children),ct.flags|=2,nt.memoizedState=null,ct}function sj(ct,nt,ot,rt,ut,gt,pt){if(ot)return nt.flags&256?(nt.flags&=-257,rt=Li(Error(p$1(422))),tj(ct,nt,pt,rt)):nt.memoizedState!==null?(nt.child=ct.child,nt.flags|=128,null):(gt=rt.fallback,ut=nt.mode,rt=qj({mode:"visible",children:rt.children},ut,0,null),gt=Ah(gt,ut,pt,null),gt.flags|=2,rt.return=nt,gt.return=nt,rt.sibling=gt,nt.child=rt,nt.mode&1&&Bh(nt,ct.child,null,pt),nt.child.memoizedState=oj(pt),nt.memoizedState=nj,gt);if(!(nt.mode&1))return tj(ct,nt,pt,null);if(ut.data==="$!"){if(rt=ut.nextSibling&&ut.nextSibling.dataset,rt)var mt=rt.dgst;return rt=mt,gt=Error(p$1(419)),rt=Li(gt,rt,void 0),tj(ct,nt,pt,rt)}if(mt=(pt&ct.childLanes)!==0,Ug||mt){if(rt=R$1,rt!==null){switch(pt&-pt){case 4:ut=2;break;case 16:ut=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:ut=32;break;case 536870912:ut=268435456;break;default:ut=0}ut=ut&(rt.suspendedLanes|pt)?0:ut,ut!==0&&ut!==gt.retryLane&&(gt.retryLane=ut,Zg(ct,ut),mh(rt,ct,ut,-1))}return uj(),rt=Li(Error(p$1(421))),tj(ct,nt,pt,rt)}return ut.data==="$?"?(nt.flags|=128,nt.child=ct.child,nt=vj.bind(null,ct),ut._reactRetry=nt,null):(ct=gt.treeContext,yg=Lf(ut.nextSibling),xg=nt,I$1=!0,zg=null,ct!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=ct.id,sg=ct.overflow,qg=nt),nt=rj(nt,rt.children),nt.flags|=4096,nt)}function wj(ct,nt,ot){ct.lanes|=nt;var rt=ct.alternate;rt!==null&&(rt.lanes|=nt),Sg(ct.return,nt,ot)}function xj(ct,nt,ot,rt,ut){var gt=ct.memoizedState;gt===null?ct.memoizedState={isBackwards:nt,rendering:null,renderingStartTime:0,last:rt,tail:ot,tailMode:ut}:(gt.isBackwards=nt,gt.rendering=null,gt.renderingStartTime=0,gt.last=rt,gt.tail=ot,gt.tailMode=ut)}function yj(ct,nt,ot){var rt=nt.pendingProps,ut=rt.revealOrder,gt=rt.tail;if(Yi(ct,nt,rt.children,ot),rt=M$1.current,rt&2)rt=rt&1|2,nt.flags|=128;else{if(ct!==null&&ct.flags&128)e:for(ct=nt.child;ct!==null;){if(ct.tag===13)ct.memoizedState!==null&&wj(ct,ot,nt);else if(ct.tag===19)wj(ct,ot,nt);else if(ct.child!==null){ct.child.return=ct,ct=ct.child;continue}if(ct===nt)break e;for(;ct.sibling===null;){if(ct.return===null||ct.return===nt)break e;ct=ct.return}ct.sibling.return=ct.return,ct=ct.sibling}rt&=1}if(G$1(M$1,rt),!(nt.mode&1))nt.memoizedState=null;else switch(ut){case"forwards":for(ot=nt.child,ut=null;ot!==null;)ct=ot.alternate,ct!==null&&Mh(ct)===null&&(ut=ot),ot=ot.sibling;ot=ut,ot===null?(ut=nt.child,nt.child=null):(ut=ot.sibling,ot.sibling=null),xj(nt,!1,ut,ot,gt);break;case"backwards":for(ot=null,ut=nt.child,nt.child=null;ut!==null;){if(ct=ut.alternate,ct!==null&&Mh(ct)===null){nt.child=ut;break}ct=ut.sibling,ut.sibling=ot,ot=ut,ut=ct}xj(nt,!0,ot,null,gt);break;case"together":xj(nt,!1,null,null,void 0);break;default:nt.memoizedState=null}return nt.child}function jj(ct,nt){!(nt.mode&1)&&ct!==null&&(ct.alternate=null,nt.alternate=null,nt.flags|=2)}function $i(ct,nt,ot){if(ct!==null&&(nt.dependencies=ct.dependencies),hh|=nt.lanes,!(ot&nt.childLanes))return null;if(ct!==null&&nt.child!==ct.child)throw Error(p$1(153));if(nt.child!==null){for(ct=nt.child,ot=wh(ct,ct.pendingProps),nt.child=ot,ot.return=nt;ct.sibling!==null;)ct=ct.sibling,ot=ot.sibling=wh(ct,ct.pendingProps),ot.return=nt;ot.sibling=null}return nt.child}function zj(ct,nt,ot){switch(nt.tag){case 3:lj(nt),Ig();break;case 5:Kh(nt);break;case 1:Zf(nt.type)&&cg(nt);break;case 4:Ih(nt,nt.stateNode.containerInfo);break;case 10:var rt=nt.type._context,ut=nt.memoizedProps.value;G$1(Mg,rt._currentValue),rt._currentValue=ut;break;case 13:if(rt=nt.memoizedState,rt!==null)return rt.dehydrated!==null?(G$1(M$1,M$1.current&1),nt.flags|=128,null):ot&nt.child.childLanes?pj(ct,nt,ot):(G$1(M$1,M$1.current&1),ct=$i(ct,nt,ot),ct!==null?ct.sibling:null);G$1(M$1,M$1.current&1);break;case 19:if(rt=(ot&nt.childLanes)!==0,ct.flags&128){if(rt)return yj(ct,nt,ot);nt.flags|=128}if(ut=nt.memoizedState,ut!==null&&(ut.rendering=null,ut.tail=null,ut.lastEffect=null),G$1(M$1,M$1.current),rt)break;return null;case 22:case 23:return nt.lanes=0,ej(ct,nt,ot)}return $i(ct,nt,ot)}var Aj,Bj,Cj,Dj;Aj=function(ct,nt){for(var ot=nt.child;ot!==null;){if(ot.tag===5||ot.tag===6)ct.appendChild(ot.stateNode);else if(ot.tag!==4&&ot.child!==null){ot.child.return=ot,ot=ot.child;continue}if(ot===nt)break;for(;ot.sibling===null;){if(ot.return===null||ot.return===nt)return;ot=ot.return}ot.sibling.return=ot.return,ot=ot.sibling}};Bj=function(){};Cj=function(ct,nt,ot,rt){var ut=ct.memoizedProps;if(ut!==rt){ct=nt.stateNode,Hh(Eh.current);var gt=null;switch(ot){case"input":ut=Ya(ct,ut),rt=Ya(ct,rt),gt=[];break;case"select":ut=A$1({},ut,{value:void 0}),rt=A$1({},rt,{value:void 0}),gt=[];break;case"textarea":ut=gb(ct,ut),rt=gb(ct,rt),gt=[];break;default:typeof ut.onClick!="function"&&typeof rt.onClick=="function"&&(ct.onclick=Bf)}ub(ot,rt);var pt;ot=null;for(St in ut)if(!rt.hasOwnProperty(St)&&ut.hasOwnProperty(St)&&ut[St]!=null)if(St==="style"){var mt=ut[St];for(pt in mt)mt.hasOwnProperty(pt)&&(ot||(ot={}),ot[pt]="")}else St!=="dangerouslySetInnerHTML"&&St!=="children"&&St!=="suppressContentEditableWarning"&&St!=="suppressHydrationWarning"&&St!=="autoFocus"&&(ea.hasOwnProperty(St)?gt||(gt=[]):(gt=gt||[]).push(St,null));for(St in rt){var vt=rt[St];if(mt=ut!=null?ut[St]:void 0,rt.hasOwnProperty(St)&&vt!==mt&&(vt!=null||mt!=null))if(St==="style")if(mt){for(pt in mt)!mt.hasOwnProperty(pt)||vt&&vt.hasOwnProperty(pt)||(ot||(ot={}),ot[pt]="");for(pt in vt)vt.hasOwnProperty(pt)&&mt[pt]!==vt[pt]&&(ot||(ot={}),ot[pt]=vt[pt])}else ot||(gt||(gt=[]),gt.push(St,ot)),ot=vt;else St==="dangerouslySetInnerHTML"?(vt=vt?vt.__html:void 0,mt=mt?mt.__html:void 0,vt!=null&&mt!==vt&&(gt=gt||[]).push(St,vt)):St==="children"?typeof vt!="string"&&typeof vt!="number"||(gt=gt||[]).push(St,""+vt):St!=="suppressContentEditableWarning"&&St!=="suppressHydrationWarning"&&(ea.hasOwnProperty(St)?(vt!=null&&St==="onScroll"&&D$1("scroll",ct),gt||mt===vt||(gt=[])):(gt=gt||[]).push(St,vt))}ot&&(gt=gt||[]).push("style",ot);var St=gt;(nt.updateQueue=St)&&(nt.flags|=4)}};Dj=function(ct,nt,ot,rt){ot!==rt&&(nt.flags|=4)};function Ej(ct,nt){if(!I$1)switch(ct.tailMode){case"hidden":nt=ct.tail;for(var ot=null;nt!==null;)nt.alternate!==null&&(ot=nt),nt=nt.sibling;ot===null?ct.tail=null:ot.sibling=null;break;case"collapsed":ot=ct.tail;for(var rt=null;ot!==null;)ot.alternate!==null&&(rt=ot),ot=ot.sibling;rt===null?nt||ct.tail===null?ct.tail=null:ct.tail.sibling=null:rt.sibling=null}}function S$1(ct){var nt=ct.alternate!==null&&ct.alternate.child===ct.child,ot=0,rt=0;if(nt)for(var ut=ct.child;ut!==null;)ot|=ut.lanes|ut.childLanes,rt|=ut.subtreeFlags&14680064,rt|=ut.flags&14680064,ut.return=ct,ut=ut.sibling;else for(ut=ct.child;ut!==null;)ot|=ut.lanes|ut.childLanes,rt|=ut.subtreeFlags,rt|=ut.flags,ut.return=ct,ut=ut.sibling;return ct.subtreeFlags|=rt,ct.childLanes=ot,nt}function Fj(ct,nt,ot){var rt=nt.pendingProps;switch(wg(nt),nt.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1(nt),null;case 1:return Zf(nt.type)&&$f(),S$1(nt),null;case 3:return rt=nt.stateNode,Jh(),E(Wf),E(H$1),Oh(),rt.pendingContext&&(rt.context=rt.pendingContext,rt.pendingContext=null),(ct===null||ct.child===null)&&(Gg(nt)?nt.flags|=4:ct===null||ct.memoizedState.isDehydrated&&!(nt.flags&256)||(nt.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(ct,nt),S$1(nt),null;case 5:Lh(nt);var ut=Hh(Gh.current);if(ot=nt.type,ct!==null&&nt.stateNode!=null)Cj(ct,nt,ot,rt,ut),ct.ref!==nt.ref&&(nt.flags|=512,nt.flags|=2097152);else{if(!rt){if(nt.stateNode===null)throw Error(p$1(166));return S$1(nt),null}if(ct=Hh(Eh.current),Gg(nt)){rt=nt.stateNode,ot=nt.type;var gt=nt.memoizedProps;switch(rt[Of]=nt,rt[Pf]=gt,ct=(nt.mode&1)!==0,ot){case"dialog":D$1("cancel",rt),D$1("close",rt);break;case"iframe":case"object":case"embed":D$1("load",rt);break;case"video":case"audio":for(ut=0;ut<lf.length;ut++)D$1(lf[ut],rt);break;case"source":D$1("error",rt);break;case"img":case"image":case"link":D$1("error",rt),D$1("load",rt);break;case"details":D$1("toggle",rt);break;case"input":Za(rt,gt),D$1("invalid",rt);break;case"select":rt._wrapperState={wasMultiple:!!gt.multiple},D$1("invalid",rt);break;case"textarea":hb(rt,gt),D$1("invalid",rt)}ub(ot,gt),ut=null;for(var pt in gt)if(gt.hasOwnProperty(pt)){var mt=gt[pt];pt==="children"?typeof mt=="string"?rt.textContent!==mt&&(gt.suppressHydrationWarning!==!0&&Af(rt.textContent,mt,ct),ut=["children",mt]):typeof mt=="number"&&rt.textContent!==""+mt&&(gt.suppressHydrationWarning!==!0&&Af(rt.textContent,mt,ct),ut=["children",""+mt]):ea.hasOwnProperty(pt)&&mt!=null&&pt==="onScroll"&&D$1("scroll",rt)}switch(ot){case"input":Va(rt),db(rt,gt,!0);break;case"textarea":Va(rt),jb(rt);break;case"select":case"option":break;default:typeof gt.onClick=="function"&&(rt.onclick=Bf)}rt=ut,nt.updateQueue=rt,rt!==null&&(nt.flags|=4)}else{pt=ut.nodeType===9?ut:ut.ownerDocument,ct==="http://www.w3.org/1999/xhtml"&&(ct=kb(ot)),ct==="http://www.w3.org/1999/xhtml"?ot==="script"?(ct=pt.createElement("div"),ct.innerHTML="<script><\/script>",ct=ct.removeChild(ct.firstChild)):typeof rt.is=="string"?ct=pt.createElement(ot,{is:rt.is}):(ct=pt.createElement(ot),ot==="select"&&(pt=ct,rt.multiple?pt.multiple=!0:rt.size&&(pt.size=rt.size))):ct=pt.createElementNS(ct,ot),ct[Of]=nt,ct[Pf]=rt,Aj(ct,nt,!1,!1),nt.stateNode=ct;e:{switch(pt=vb(ot,rt),ot){case"dialog":D$1("cancel",ct),D$1("close",ct),ut=rt;break;case"iframe":case"object":case"embed":D$1("load",ct),ut=rt;break;case"video":case"audio":for(ut=0;ut<lf.length;ut++)D$1(lf[ut],ct);ut=rt;break;case"source":D$1("error",ct),ut=rt;break;case"img":case"image":case"link":D$1("error",ct),D$1("load",ct),ut=rt;break;case"details":D$1("toggle",ct),ut=rt;break;case"input":Za(ct,rt),ut=Ya(ct,rt),D$1("invalid",ct);break;case"option":ut=rt;break;case"select":ct._wrapperState={wasMultiple:!!rt.multiple},ut=A$1({},rt,{value:void 0}),D$1("invalid",ct);break;case"textarea":hb(ct,rt),ut=gb(ct,rt),D$1("invalid",ct);break;default:ut=rt}ub(ot,ut),mt=ut;for(gt in mt)if(mt.hasOwnProperty(gt)){var vt=mt[gt];gt==="style"?sb(ct,vt):gt==="dangerouslySetInnerHTML"?(vt=vt?vt.__html:void 0,vt!=null&&nb(ct,vt)):gt==="children"?typeof vt=="string"?(ot!=="textarea"||vt!=="")&&ob(ct,vt):typeof vt=="number"&&ob(ct,""+vt):gt!=="suppressContentEditableWarning"&&gt!=="suppressHydrationWarning"&&gt!=="autoFocus"&&(ea.hasOwnProperty(gt)?vt!=null&&gt==="onScroll"&&D$1("scroll",ct):vt!=null&&ta(ct,gt,vt,pt))}switch(ot){case"input":Va(ct),db(ct,rt,!1);break;case"textarea":Va(ct),jb(ct);break;case"option":rt.value!=null&&ct.setAttribute("value",""+Sa(rt.value));break;case"select":ct.multiple=!!rt.multiple,gt=rt.value,gt!=null?fb(ct,!!rt.multiple,gt,!1):rt.defaultValue!=null&&fb(ct,!!rt.multiple,rt.defaultValue,!0);break;default:typeof ut.onClick=="function"&&(ct.onclick=Bf)}switch(ot){case"button":case"input":case"select":case"textarea":rt=!!rt.autoFocus;break e;case"img":rt=!0;break e;default:rt=!1}}rt&&(nt.flags|=4)}nt.ref!==null&&(nt.flags|=512,nt.flags|=2097152)}return S$1(nt),null;case 6:if(ct&&nt.stateNode!=null)Dj(ct,nt,ct.memoizedProps,rt);else{if(typeof rt!="string"&&nt.stateNode===null)throw Error(p$1(166));if(ot=Hh(Gh.current),Hh(Eh.current),Gg(nt)){if(rt=nt.stateNode,ot=nt.memoizedProps,rt[Of]=nt,(gt=rt.nodeValue!==ot)&&(ct=xg,ct!==null))switch(ct.tag){case 3:Af(rt.nodeValue,ot,(ct.mode&1)!==0);break;case 5:ct.memoizedProps.suppressHydrationWarning!==!0&&Af(rt.nodeValue,ot,(ct.mode&1)!==0)}gt&&(nt.flags|=4)}else rt=(ot.nodeType===9?ot:ot.ownerDocument).createTextNode(rt),rt[Of]=nt,nt.stateNode=rt}return S$1(nt),null;case 13:if(E(M$1),rt=nt.memoizedState,ct===null||ct.memoizedState!==null&&ct.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&nt.mode&1&&!(nt.flags&128))Hg(),Ig(),nt.flags|=98560,gt=!1;else if(gt=Gg(nt),rt!==null&&rt.dehydrated!==null){if(ct===null){if(!gt)throw Error(p$1(318));if(gt=nt.memoizedState,gt=gt!==null?gt.dehydrated:null,!gt)throw Error(p$1(317));gt[Of]=nt}else Ig(),!(nt.flags&128)&&(nt.memoizedState=null),nt.flags|=4;S$1(nt),gt=!1}else zg!==null&&(Gj(zg),zg=null),gt=!0;if(!gt)return nt.flags&65536?nt:null}return nt.flags&128?(nt.lanes=ot,nt):(rt=rt!==null,rt!==(ct!==null&&ct.memoizedState!==null)&&rt&&(nt.child.flags|=8192,nt.mode&1&&(ct===null||M$1.current&1?T$1===0&&(T$1=3):uj())),nt.updateQueue!==null&&(nt.flags|=4),S$1(nt),null);case 4:return Jh(),Bj(ct,nt),ct===null&&sf(nt.stateNode.containerInfo),S$1(nt),null;case 10:return Rg(nt.type._context),S$1(nt),null;case 17:return Zf(nt.type)&&$f(),S$1(nt),null;case 19:if(E(M$1),gt=nt.memoizedState,gt===null)return S$1(nt),null;if(rt=(nt.flags&128)!==0,pt=gt.rendering,pt===null)if(rt)Ej(gt,!1);else{if(T$1!==0||ct!==null&&ct.flags&128)for(ct=nt.child;ct!==null;){if(pt=Mh(ct),pt!==null){for(nt.flags|=128,Ej(gt,!1),rt=pt.updateQueue,rt!==null&&(nt.updateQueue=rt,nt.flags|=4),nt.subtreeFlags=0,rt=ot,ot=nt.child;ot!==null;)gt=ot,ct=rt,gt.flags&=14680066,pt=gt.alternate,pt===null?(gt.childLanes=0,gt.lanes=ct,gt.child=null,gt.subtreeFlags=0,gt.memoizedProps=null,gt.memoizedState=null,gt.updateQueue=null,gt.dependencies=null,gt.stateNode=null):(gt.childLanes=pt.childLanes,gt.lanes=pt.lanes,gt.child=pt.child,gt.subtreeFlags=0,gt.deletions=null,gt.memoizedProps=pt.memoizedProps,gt.memoizedState=pt.memoizedState,gt.updateQueue=pt.updateQueue,gt.type=pt.type,ct=pt.dependencies,gt.dependencies=ct===null?null:{lanes:ct.lanes,firstContext:ct.firstContext}),ot=ot.sibling;return G$1(M$1,M$1.current&1|2),nt.child}ct=ct.sibling}gt.tail!==null&&B()>Hj&&(nt.flags|=128,rt=!0,Ej(gt,!1),nt.lanes=4194304)}else{if(!rt)if(ct=Mh(pt),ct!==null){if(nt.flags|=128,rt=!0,ot=ct.updateQueue,ot!==null&&(nt.updateQueue=ot,nt.flags|=4),Ej(gt,!0),gt.tail===null&&gt.tailMode==="hidden"&&!pt.alternate&&!I$1)return S$1(nt),null}else 2*B()-gt.renderingStartTime>Hj&&ot!==1073741824&&(nt.flags|=128,rt=!0,Ej(gt,!1),nt.lanes=4194304);gt.isBackwards?(pt.sibling=nt.child,nt.child=pt):(ot=gt.last,ot!==null?ot.sibling=pt:nt.child=pt,gt.last=pt)}return gt.tail!==null?(nt=gt.tail,gt.rendering=nt,gt.tail=nt.sibling,gt.renderingStartTime=B(),nt.sibling=null,ot=M$1.current,G$1(M$1,rt?ot&1|2:ot&1),nt):(S$1(nt),null);case 22:case 23:return Ij(),rt=nt.memoizedState!==null,ct!==null&&ct.memoizedState!==null!==rt&&(nt.flags|=8192),rt&&nt.mode&1?gj&1073741824&&(S$1(nt),nt.subtreeFlags&6&&(nt.flags|=8192)):S$1(nt),null;case 24:return null;case 25:return null}throw Error(p$1(156,nt.tag))}function Jj(ct,nt){switch(wg(nt),nt.tag){case 1:return Zf(nt.type)&&$f(),ct=nt.flags,ct&65536?(nt.flags=ct&-65537|128,nt):null;case 3:return Jh(),E(Wf),E(H$1),Oh(),ct=nt.flags,ct&65536&&!(ct&128)?(nt.flags=ct&-65537|128,nt):null;case 5:return Lh(nt),null;case 13:if(E(M$1),ct=nt.memoizedState,ct!==null&&ct.dehydrated!==null){if(nt.alternate===null)throw Error(p$1(340));Ig()}return ct=nt.flags,ct&65536?(nt.flags=ct&-65537|128,nt):null;case 19:return E(M$1),null;case 4:return Jh(),null;case 10:return Rg(nt.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U$1=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V$1=null;function Mj(ct,nt){var ot=ct.ref;if(ot!==null)if(typeof ot=="function")try{ot(null)}catch(rt){W$1(ct,nt,rt)}else ot.current=null}function Nj(ct,nt,ot){try{ot()}catch(rt){W$1(ct,nt,rt)}}var Oj=!1;function Pj(ct,nt){if(Cf=dd,ct=Me(),Ne(ct)){if("selectionStart"in ct)var ot={start:ct.selectionStart,end:ct.selectionEnd};else e:{ot=(ot=ct.ownerDocument)&&ot.defaultView||window;var rt=ot.getSelection&&ot.getSelection();if(rt&&rt.rangeCount!==0){ot=rt.anchorNode;var ut=rt.anchorOffset,gt=rt.focusNode;rt=rt.focusOffset;try{ot.nodeType,gt.nodeType}catch{ot=null;break e}var pt=0,mt=-1,vt=-1,St=0,yt=0,wt=ct,Lt=null;t:for(;;){for(var xt;wt!==ot||ut!==0&&wt.nodeType!==3||(mt=pt+ut),wt!==gt||rt!==0&&wt.nodeType!==3||(vt=pt+rt),wt.nodeType===3&&(pt+=wt.nodeValue.length),(xt=wt.firstChild)!==null;)Lt=wt,wt=xt;for(;;){if(wt===ct)break t;if(Lt===ot&&++St===ut&&(mt=pt),Lt===gt&&++yt===rt&&(vt=pt),(xt=wt.nextSibling)!==null)break;wt=Lt,Lt=wt.parentNode}wt=xt}ot=mt===-1||vt===-1?null:{start:mt,end:vt}}else ot=null}ot=ot||{start:0,end:0}}else ot=null;for(Df={focusedElem:ct,selectionRange:ot},dd=!1,V$1=nt;V$1!==null;)if(nt=V$1,ct=nt.child,(nt.subtreeFlags&1028)!==0&&ct!==null)ct.return=nt,V$1=ct;else for(;V$1!==null;){nt=V$1;try{var It=nt.alternate;if(nt.flags&1024)switch(nt.tag){case 0:case 11:case 15:break;case 1:if(It!==null){var kt=It.memoizedProps,At=It.memoizedState,Tt=nt.stateNode,Rt=Tt.getSnapshotBeforeUpdate(nt.elementType===nt.type?kt:Lg(nt.type,kt),At);Tt.__reactInternalSnapshotBeforeUpdate=Rt}break;case 3:var Nt=nt.stateNode.containerInfo;Nt.nodeType===1?Nt.textContent="":Nt.nodeType===9&&Nt.documentElement&&Nt.removeChild(Nt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(Pt){W$1(nt,nt.return,Pt)}if(ct=nt.sibling,ct!==null){ct.return=nt.return,V$1=ct;break}V$1=nt.return}return It=Oj,Oj=!1,It}function Qj(ct,nt,ot){var rt=nt.updateQueue;if(rt=rt!==null?rt.lastEffect:null,rt!==null){var ut=rt=rt.next;do{if((ut.tag&ct)===ct){var gt=ut.destroy;ut.destroy=void 0,gt!==void 0&&Nj(nt,ot,gt)}ut=ut.next}while(ut!==rt)}}function Rj(ct,nt){if(nt=nt.updateQueue,nt=nt!==null?nt.lastEffect:null,nt!==null){var ot=nt=nt.next;do{if((ot.tag&ct)===ct){var rt=ot.create;ot.destroy=rt()}ot=ot.next}while(ot!==nt)}}function Sj(ct){var nt=ct.ref;if(nt!==null){var ot=ct.stateNode;switch(ct.tag){case 5:ct=ot;break;default:ct=ot}typeof nt=="function"?nt(ct):nt.current=ct}}function Tj(ct){var nt=ct.alternate;nt!==null&&(ct.alternate=null,Tj(nt)),ct.child=null,ct.deletions=null,ct.sibling=null,ct.tag===5&&(nt=ct.stateNode,nt!==null&&(delete nt[Of],delete nt[Pf],delete nt[of],delete nt[Qf],delete nt[Rf])),ct.stateNode=null,ct.return=null,ct.dependencies=null,ct.memoizedProps=null,ct.memoizedState=null,ct.pendingProps=null,ct.stateNode=null,ct.updateQueue=null}function Uj(ct){return ct.tag===5||ct.tag===3||ct.tag===4}function Vj(ct){e:for(;;){for(;ct.sibling===null;){if(ct.return===null||Uj(ct.return))return null;ct=ct.return}for(ct.sibling.return=ct.return,ct=ct.sibling;ct.tag!==5&&ct.tag!==6&&ct.tag!==18;){if(ct.flags&2||ct.child===null||ct.tag===4)continue e;ct.child.return=ct,ct=ct.child}if(!(ct.flags&2))return ct.stateNode}}function Wj(ct,nt,ot){var rt=ct.tag;if(rt===5||rt===6)ct=ct.stateNode,nt?ot.nodeType===8?ot.parentNode.insertBefore(ct,nt):ot.insertBefore(ct,nt):(ot.nodeType===8?(nt=ot.parentNode,nt.insertBefore(ct,ot)):(nt=ot,nt.appendChild(ct)),ot=ot._reactRootContainer,ot!=null||nt.onclick!==null||(nt.onclick=Bf));else if(rt!==4&&(ct=ct.child,ct!==null))for(Wj(ct,nt,ot),ct=ct.sibling;ct!==null;)Wj(ct,nt,ot),ct=ct.sibling}function Xj(ct,nt,ot){var rt=ct.tag;if(rt===5||rt===6)ct=ct.stateNode,nt?ot.insertBefore(ct,nt):ot.appendChild(ct);else if(rt!==4&&(ct=ct.child,ct!==null))for(Xj(ct,nt,ot),ct=ct.sibling;ct!==null;)Xj(ct,nt,ot),ct=ct.sibling}var X$1=null,Yj=!1;function Zj(ct,nt,ot){for(ot=ot.child;ot!==null;)ak(ct,nt,ot),ot=ot.sibling}function ak(ct,nt,ot){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,ot)}catch{}switch(ot.tag){case 5:U$1||Mj(ot,nt);case 6:var rt=X$1,ut=Yj;X$1=null,Zj(ct,nt,ot),X$1=rt,Yj=ut,X$1!==null&&(Yj?(ct=X$1,ot=ot.stateNode,ct.nodeType===8?ct.parentNode.removeChild(ot):ct.removeChild(ot)):X$1.removeChild(ot.stateNode));break;case 18:X$1!==null&&(Yj?(ct=X$1,ot=ot.stateNode,ct.nodeType===8?Kf(ct.parentNode,ot):ct.nodeType===1&&Kf(ct,ot),bd(ct)):Kf(X$1,ot.stateNode));break;case 4:rt=X$1,ut=Yj,X$1=ot.stateNode.containerInfo,Yj=!0,Zj(ct,nt,ot),X$1=rt,Yj=ut;break;case 0:case 11:case 14:case 15:if(!U$1&&(rt=ot.updateQueue,rt!==null&&(rt=rt.lastEffect,rt!==null))){ut=rt=rt.next;do{var gt=ut,pt=gt.destroy;gt=gt.tag,pt!==void 0&&(gt&2||gt&4)&&Nj(ot,nt,pt),ut=ut.next}while(ut!==rt)}Zj(ct,nt,ot);break;case 1:if(!U$1&&(Mj(ot,nt),rt=ot.stateNode,typeof rt.componentWillUnmount=="function"))try{rt.props=ot.memoizedProps,rt.state=ot.memoizedState,rt.componentWillUnmount()}catch(mt){W$1(ot,nt,mt)}Zj(ct,nt,ot);break;case 21:Zj(ct,nt,ot);break;case 22:ot.mode&1?(U$1=(rt=U$1)||ot.memoizedState!==null,Zj(ct,nt,ot),U$1=rt):Zj(ct,nt,ot);break;default:Zj(ct,nt,ot)}}function bk(ct){var nt=ct.updateQueue;if(nt!==null){ct.updateQueue=null;var ot=ct.stateNode;ot===null&&(ot=ct.stateNode=new Lj),nt.forEach(function(rt){var ut=ck.bind(null,ct,rt);ot.has(rt)||(ot.add(rt),rt.then(ut,ut))})}}function dk(ct,nt){var ot=nt.deletions;if(ot!==null)for(var rt=0;rt<ot.length;rt++){var ut=ot[rt];try{var gt=ct,pt=nt,mt=pt;e:for(;mt!==null;){switch(mt.tag){case 5:X$1=mt.stateNode,Yj=!1;break e;case 3:X$1=mt.stateNode.containerInfo,Yj=!0;break e;case 4:X$1=mt.stateNode.containerInfo,Yj=!0;break e}mt=mt.return}if(X$1===null)throw Error(p$1(160));ak(gt,pt,ut),X$1=null,Yj=!1;var vt=ut.alternate;vt!==null&&(vt.return=null),ut.return=null}catch(St){W$1(ut,nt,St)}}if(nt.subtreeFlags&12854)for(nt=nt.child;nt!==null;)ek(nt,ct),nt=nt.sibling}function ek(ct,nt){var ot=ct.alternate,rt=ct.flags;switch(ct.tag){case 0:case 11:case 14:case 15:if(dk(nt,ct),fk(ct),rt&4){try{Qj(3,ct,ct.return),Rj(3,ct)}catch(kt){W$1(ct,ct.return,kt)}try{Qj(5,ct,ct.return)}catch(kt){W$1(ct,ct.return,kt)}}break;case 1:dk(nt,ct),fk(ct),rt&512&&ot!==null&&Mj(ot,ot.return);break;case 5:if(dk(nt,ct),fk(ct),rt&512&&ot!==null&&Mj(ot,ot.return),ct.flags&32){var ut=ct.stateNode;try{ob(ut,"")}catch(kt){W$1(ct,ct.return,kt)}}if(rt&4&&(ut=ct.stateNode,ut!=null)){var gt=ct.memoizedProps,pt=ot!==null?ot.memoizedProps:gt,mt=ct.type,vt=ct.updateQueue;if(ct.updateQueue=null,vt!==null)try{mt==="input"&&gt.type==="radio"&&gt.name!=null&&ab(ut,gt),vb(mt,pt);var St=vb(mt,gt);for(pt=0;pt<vt.length;pt+=2){var yt=vt[pt],wt=vt[pt+1];yt==="style"?sb(ut,wt):yt==="dangerouslySetInnerHTML"?nb(ut,wt):yt==="children"?ob(ut,wt):ta(ut,yt,wt,St)}switch(mt){case"input":bb(ut,gt);break;case"textarea":ib(ut,gt);break;case"select":var Lt=ut._wrapperState.wasMultiple;ut._wrapperState.wasMultiple=!!gt.multiple;var xt=gt.value;xt!=null?fb(ut,!!gt.multiple,xt,!1):Lt!==!!gt.multiple&&(gt.defaultValue!=null?fb(ut,!!gt.multiple,gt.defaultValue,!0):fb(ut,!!gt.multiple,gt.multiple?[]:"",!1))}ut[Pf]=gt}catch(kt){W$1(ct,ct.return,kt)}}break;case 6:if(dk(nt,ct),fk(ct),rt&4){if(ct.stateNode===null)throw Error(p$1(162));ut=ct.stateNode,gt=ct.memoizedProps;try{ut.nodeValue=gt}catch(kt){W$1(ct,ct.return,kt)}}break;case 3:if(dk(nt,ct),fk(ct),rt&4&&ot!==null&&ot.memoizedState.isDehydrated)try{bd(nt.containerInfo)}catch(kt){W$1(ct,ct.return,kt)}break;case 4:dk(nt,ct),fk(ct);break;case 13:dk(nt,ct),fk(ct),ut=ct.child,ut.flags&8192&&(gt=ut.memoizedState!==null,ut.stateNode.isHidden=gt,!gt||ut.alternate!==null&&ut.alternate.memoizedState!==null||(gk=B())),rt&4&&bk(ct);break;case 22:if(yt=ot!==null&&ot.memoizedState!==null,ct.mode&1?(U$1=(St=U$1)||yt,dk(nt,ct),U$1=St):dk(nt,ct),fk(ct),rt&8192){if(St=ct.memoizedState!==null,(ct.stateNode.isHidden=St)&&!yt&&ct.mode&1)for(V$1=ct,yt=ct.child;yt!==null;){for(wt=V$1=yt;V$1!==null;){switch(Lt=V$1,xt=Lt.child,Lt.tag){case 0:case 11:case 14:case 15:Qj(4,Lt,Lt.return);break;case 1:Mj(Lt,Lt.return);var It=Lt.stateNode;if(typeof It.componentWillUnmount=="function"){rt=Lt,ot=Lt.return;try{nt=rt,It.props=nt.memoizedProps,It.state=nt.memoizedState,It.componentWillUnmount()}catch(kt){W$1(rt,ot,kt)}}break;case 5:Mj(Lt,Lt.return);break;case 22:if(Lt.memoizedState!==null){hk(wt);continue}}xt!==null?(xt.return=Lt,V$1=xt):hk(wt)}yt=yt.sibling}e:for(yt=null,wt=ct;;){if(wt.tag===5){if(yt===null){yt=wt;try{ut=wt.stateNode,St?(gt=ut.style,typeof gt.setProperty=="function"?gt.setProperty("display","none","important"):gt.display="none"):(mt=wt.stateNode,vt=wt.memoizedProps.style,pt=vt!=null&&vt.hasOwnProperty("display")?vt.display:null,mt.style.display=rb("display",pt))}catch(kt){W$1(ct,ct.return,kt)}}}else if(wt.tag===6){if(yt===null)try{wt.stateNode.nodeValue=St?"":wt.memoizedProps}catch(kt){W$1(ct,ct.return,kt)}}else if((wt.tag!==22&&wt.tag!==23||wt.memoizedState===null||wt===ct)&&wt.child!==null){wt.child.return=wt,wt=wt.child;continue}if(wt===ct)break e;for(;wt.sibling===null;){if(wt.return===null||wt.return===ct)break e;yt===wt&&(yt=null),wt=wt.return}yt===wt&&(yt=null),wt.sibling.return=wt.return,wt=wt.sibling}}break;case 19:dk(nt,ct),fk(ct),rt&4&&bk(ct);break;case 21:break;default:dk(nt,ct),fk(ct)}}function fk(ct){var nt=ct.flags;if(nt&2){try{e:{for(var ot=ct.return;ot!==null;){if(Uj(ot)){var rt=ot;break e}ot=ot.return}throw Error(p$1(160))}switch(rt.tag){case 5:var ut=rt.stateNode;rt.flags&32&&(ob(ut,""),rt.flags&=-33);var gt=Vj(ct);Xj(ct,gt,ut);break;case 3:case 4:var pt=rt.stateNode.containerInfo,mt=Vj(ct);Wj(ct,mt,pt);break;default:throw Error(p$1(161))}}catch(vt){W$1(ct,ct.return,vt)}ct.flags&=-3}nt&4096&&(ct.flags&=-4097)}function ik(ct,nt,ot){V$1=ct,jk(ct)}function jk(ct,nt,ot){for(var rt=(ct.mode&1)!==0;V$1!==null;){var ut=V$1,gt=ut.child;if(ut.tag===22&&rt){var pt=ut.memoizedState!==null||Kj;if(!pt){var mt=ut.alternate,vt=mt!==null&&mt.memoizedState!==null||U$1;mt=Kj;var St=U$1;if(Kj=pt,(U$1=vt)&&!St)for(V$1=ut;V$1!==null;)pt=V$1,vt=pt.child,pt.tag===22&&pt.memoizedState!==null?kk(ut):vt!==null?(vt.return=pt,V$1=vt):kk(ut);for(;gt!==null;)V$1=gt,jk(gt),gt=gt.sibling;V$1=ut,Kj=mt,U$1=St}lk(ct)}else ut.subtreeFlags&8772&&gt!==null?(gt.return=ut,V$1=gt):lk(ct)}}function lk(ct){for(;V$1!==null;){var nt=V$1;if(nt.flags&8772){var ot=nt.alternate;try{if(nt.flags&8772)switch(nt.tag){case 0:case 11:case 15:U$1||Rj(5,nt);break;case 1:var rt=nt.stateNode;if(nt.flags&4&&!U$1)if(ot===null)rt.componentDidMount();else{var ut=nt.elementType===nt.type?ot.memoizedProps:Lg(nt.type,ot.memoizedProps);rt.componentDidUpdate(ut,ot.memoizedState,rt.__reactInternalSnapshotBeforeUpdate)}var gt=nt.updateQueue;gt!==null&&ih(nt,gt,rt);break;case 3:var pt=nt.updateQueue;if(pt!==null){if(ot=null,nt.child!==null)switch(nt.child.tag){case 5:ot=nt.child.stateNode;break;case 1:ot=nt.child.stateNode}ih(nt,pt,ot)}break;case 5:var mt=nt.stateNode;if(ot===null&&nt.flags&4){ot=mt;var vt=nt.memoizedProps;switch(nt.type){case"button":case"input":case"select":case"textarea":vt.autoFocus&&ot.focus();break;case"img":vt.src&&(ot.src=vt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(nt.memoizedState===null){var St=nt.alternate;if(St!==null){var yt=St.memoizedState;if(yt!==null){var wt=yt.dehydrated;wt!==null&&bd(wt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U$1||nt.flags&512&&Sj(nt)}catch(Lt){W$1(nt,nt.return,Lt)}}if(nt===ct){V$1=null;break}if(ot=nt.sibling,ot!==null){ot.return=nt.return,V$1=ot;break}V$1=nt.return}}function hk(ct){for(;V$1!==null;){var nt=V$1;if(nt===ct){V$1=null;break}var ot=nt.sibling;if(ot!==null){ot.return=nt.return,V$1=ot;break}V$1=nt.return}}function kk(ct){for(;V$1!==null;){var nt=V$1;try{switch(nt.tag){case 0:case 11:case 15:var ot=nt.return;try{Rj(4,nt)}catch(vt){W$1(nt,ot,vt)}break;case 1:var rt=nt.stateNode;if(typeof rt.componentDidMount=="function"){var ut=nt.return;try{rt.componentDidMount()}catch(vt){W$1(nt,ut,vt)}}var gt=nt.return;try{Sj(nt)}catch(vt){W$1(nt,gt,vt)}break;case 5:var pt=nt.return;try{Sj(nt)}catch(vt){W$1(nt,pt,vt)}}}catch(vt){W$1(nt,nt.return,vt)}if(nt===ct){V$1=null;break}var mt=nt.sibling;if(mt!==null){mt.return=nt.return,V$1=mt;break}V$1=nt.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok$1=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K=0,R$1=null,Y$2=null,Z$2=0,gj=0,fj=Uf(0),T$1=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return K&6?B():Bk!==-1?Bk:Bk=B()}function lh(ct){return ct.mode&1?K&2&&Z$2!==0?Z$2&-Z$2:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(ct=C,ct!==0||(ct=window.event,ct=ct===void 0?16:jd(ct.type)),ct):1}function mh(ct,nt,ot,rt){if(50<zk)throw zk=0,Ak=null,Error(p$1(185));Ac(ct,ot,rt),(!(K&2)||ct!==R$1)&&(ct===R$1&&(!(K&2)&&(rk|=ot),T$1===4&&Dk(ct,Z$2)),Ek(ct,rt),ot===1&&K===0&&!(nt.mode&1)&&(Hj=B()+500,fg&&jg()))}function Ek(ct,nt){var ot=ct.callbackNode;wc(ct,nt);var rt=uc(ct,ct===R$1?Z$2:0);if(rt===0)ot!==null&&bc(ot),ct.callbackNode=null,ct.callbackPriority=0;else if(nt=rt&-rt,ct.callbackPriority!==nt){if(ot!=null&&bc(ot),nt===1)ct.tag===0?ig(Fk.bind(null,ct)):hg(Fk.bind(null,ct)),Jf(function(){!(K&6)&&jg()}),ot=null;else{switch(Dc(rt)){case 1:ot=fc;break;case 4:ot=gc;break;case 16:ot=hc;break;case 536870912:ot=jc;break;default:ot=hc}ot=Gk(ot,Hk.bind(null,ct))}ct.callbackPriority=nt,ct.callbackNode=ot}}function Hk(ct,nt){if(Bk=-1,Ck=0,K&6)throw Error(p$1(327));var ot=ct.callbackNode;if(Ik()&&ct.callbackNode!==ot)return null;var rt=uc(ct,ct===R$1?Z$2:0);if(rt===0)return null;if(rt&30||rt&ct.expiredLanes||nt)nt=Jk(ct,rt);else{nt=rt;var ut=K;K|=2;var gt=Kk();(R$1!==ct||Z$2!==nt)&&(vk=null,Hj=B()+500,Lk(ct,nt));do try{Mk();break}catch(mt){Nk(ct,mt)}while(1);Qg(),nk.current=gt,K=ut,Y$2!==null?nt=0:(R$1=null,Z$2=0,nt=T$1)}if(nt!==0){if(nt===2&&(ut=xc(ct),ut!==0&&(rt=ut,nt=Ok(ct,ut))),nt===1)throw ot=qk,Lk(ct,0),Dk(ct,rt),Ek(ct,B()),ot;if(nt===6)Dk(ct,rt);else{if(ut=ct.current.alternate,!(rt&30)&&!Pk(ut)&&(nt=Jk(ct,rt),nt===2&&(gt=xc(ct),gt!==0&&(rt=gt,nt=Ok(ct,gt))),nt===1))throw ot=qk,Lk(ct,0),Dk(ct,rt),Ek(ct,B()),ot;switch(ct.finishedWork=ut,ct.finishedLanes=rt,nt){case 0:case 1:throw Error(p$1(345));case 2:Qk(ct,uk,vk);break;case 3:if(Dk(ct,rt),(rt&130023424)===rt&&(nt=gk+500-B(),10<nt)){if(uc(ct,0)!==0)break;if(ut=ct.suspendedLanes,(ut&rt)!==rt){L(),ct.pingedLanes|=ct.suspendedLanes&ut;break}ct.timeoutHandle=Ff(Qk.bind(null,ct,uk,vk),nt);break}Qk(ct,uk,vk);break;case 4:if(Dk(ct,rt),(rt&4194240)===rt)break;for(nt=ct.eventTimes,ut=-1;0<rt;){var pt=31-oc(rt);gt=1<<pt,pt=nt[pt],pt>ut&&(ut=pt),rt&=~gt}if(rt=ut,rt=B()-rt,rt=(120>rt?120:480>rt?480:1080>rt?1080:1920>rt?1920:3e3>rt?3e3:4320>rt?4320:1960*mk(rt/1960))-rt,10<rt){ct.timeoutHandle=Ff(Qk.bind(null,ct,uk,vk),rt);break}Qk(ct,uk,vk);break;case 5:Qk(ct,uk,vk);break;default:throw Error(p$1(329))}}}return Ek(ct,B()),ct.callbackNode===ot?Hk.bind(null,ct):null}function Ok(ct,nt){var ot=tk;return ct.current.memoizedState.isDehydrated&&(Lk(ct,nt).flags|=256),ct=Jk(ct,nt),ct!==2&&(nt=uk,uk=ot,nt!==null&&Gj(nt)),ct}function Gj(ct){uk===null?uk=ct:uk.push.apply(uk,ct)}function Pk(ct){for(var nt=ct;;){if(nt.flags&16384){var ot=nt.updateQueue;if(ot!==null&&(ot=ot.stores,ot!==null))for(var rt=0;rt<ot.length;rt++){var ut=ot[rt],gt=ut.getSnapshot;ut=ut.value;try{if(!He(gt(),ut))return!1}catch{return!1}}}if(ot=nt.child,nt.subtreeFlags&16384&&ot!==null)ot.return=nt,nt=ot;else{if(nt===ct)break;for(;nt.sibling===null;){if(nt.return===null||nt.return===ct)return!0;nt=nt.return}nt.sibling.return=nt.return,nt=nt.sibling}}return!0}function Dk(ct,nt){for(nt&=~sk,nt&=~rk,ct.suspendedLanes|=nt,ct.pingedLanes&=~nt,ct=ct.expirationTimes;0<nt;){var ot=31-oc(nt),rt=1<<ot;ct[ot]=-1,nt&=~rt}}function Fk(ct){if(K&6)throw Error(p$1(327));Ik();var nt=uc(ct,0);if(!(nt&1))return Ek(ct,B()),null;var ot=Jk(ct,nt);if(ct.tag!==0&&ot===2){var rt=xc(ct);rt!==0&&(nt=rt,ot=Ok(ct,rt))}if(ot===1)throw ot=qk,Lk(ct,0),Dk(ct,nt),Ek(ct,B()),ot;if(ot===6)throw Error(p$1(345));return ct.finishedWork=ct.current.alternate,ct.finishedLanes=nt,Qk(ct,uk,vk),Ek(ct,B()),null}function Rk(ct,nt){var ot=K;K|=1;try{return ct(nt)}finally{K=ot,K===0&&(Hj=B()+500,fg&&jg())}}function Sk(ct){xk!==null&&xk.tag===0&&!(K&6)&&Ik();var nt=K;K|=1;var ot=pk.transition,rt=C;try{if(pk.transition=null,C=1,ct)return ct()}finally{C=rt,pk.transition=ot,K=nt,!(K&6)&&jg()}}function Ij(){gj=fj.current,E(fj)}function Lk(ct,nt){ct.finishedWork=null,ct.finishedLanes=0;var ot=ct.timeoutHandle;if(ot!==-1&&(ct.timeoutHandle=-1,Gf(ot)),Y$2!==null)for(ot=Y$2.return;ot!==null;){var rt=ot;switch(wg(rt),rt.tag){case 1:rt=rt.type.childContextTypes,rt!=null&&$f();break;case 3:Jh(),E(Wf),E(H$1),Oh();break;case 5:Lh(rt);break;case 4:Jh();break;case 13:E(M$1);break;case 19:E(M$1);break;case 10:Rg(rt.type._context);break;case 22:case 23:Ij()}ot=ot.return}if(R$1=ct,Y$2=ct=wh(ct.current,null),Z$2=gj=nt,T$1=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(nt=0;nt<Wg.length;nt++)if(ot=Wg[nt],rt=ot.interleaved,rt!==null){ot.interleaved=null;var ut=rt.next,gt=ot.pending;if(gt!==null){var pt=gt.next;gt.next=ut,rt.next=pt}ot.pending=rt}Wg=null}return ct}function Nk(ct,nt){do{var ot=Y$2;try{if(Qg(),Ph.current=ai,Sh){for(var rt=N.memoizedState;rt!==null;){var ut=rt.queue;ut!==null&&(ut.pending=null),rt=rt.next}Sh=!1}if(Rh=0,P$1=O$1=N=null,Th=!1,Uh=0,ok$1.current=null,ot===null||ot.return===null){T$1=1,qk=nt,Y$2=null;break}e:{var gt=ct,pt=ot.return,mt=ot,vt=nt;if(nt=Z$2,mt.flags|=32768,vt!==null&&typeof vt=="object"&&typeof vt.then=="function"){var St=vt,yt=mt,wt=yt.tag;if(!(yt.mode&1)&&(wt===0||wt===11||wt===15)){var Lt=yt.alternate;Lt?(yt.updateQueue=Lt.updateQueue,yt.memoizedState=Lt.memoizedState,yt.lanes=Lt.lanes):(yt.updateQueue=null,yt.memoizedState=null)}var xt=Vi(pt);if(xt!==null){xt.flags&=-257,Wi(xt,pt,mt,gt,nt),xt.mode&1&&Ti(gt,St,nt),nt=xt,vt=St;var It=nt.updateQueue;if(It===null){var kt=new Set;kt.add(vt),nt.updateQueue=kt}else It.add(vt);break e}else{if(!(nt&1)){Ti(gt,St,nt),uj();break e}vt=Error(p$1(426))}}else if(I$1&&mt.mode&1){var At=Vi(pt);if(At!==null){!(At.flags&65536)&&(At.flags|=256),Wi(At,pt,mt,gt,nt),Jg(Ki(vt,mt));break e}}gt=vt=Ki(vt,mt),T$1!==4&&(T$1=2),tk===null?tk=[gt]:tk.push(gt),gt=pt;do{switch(gt.tag){case 3:gt.flags|=65536,nt&=-nt,gt.lanes|=nt;var Tt=Oi(gt,vt,nt);fh(gt,Tt);break e;case 1:mt=vt;var Rt=gt.type,Nt=gt.stateNode;if(!(gt.flags&128)&&(typeof Rt.getDerivedStateFromError=="function"||Nt!==null&&typeof Nt.componentDidCatch=="function"&&(Si===null||!Si.has(Nt)))){gt.flags|=65536,nt&=-nt,gt.lanes|=nt;var Pt=Ri(gt,mt,nt);fh(gt,Pt);break e}}gt=gt.return}while(gt!==null)}Tk(ot)}catch(Ft){nt=Ft,Y$2===ot&&ot!==null&&(Y$2=ot=ot.return);continue}break}while(1)}function Kk(){var ct=nk.current;return nk.current=ai,ct===null?ai:ct}function uj(){(T$1===0||T$1===3||T$1===2)&&(T$1=4),R$1===null||!(hh&268435455)&&!(rk&268435455)||Dk(R$1,Z$2)}function Jk(ct,nt){var ot=K;K|=2;var rt=Kk();(R$1!==ct||Z$2!==nt)&&(vk=null,Lk(ct,nt));do try{Uk();break}catch(ut){Nk(ct,ut)}while(1);if(Qg(),K=ot,nk.current=rt,Y$2!==null)throw Error(p$1(261));return R$1=null,Z$2=0,T$1}function Uk(){for(;Y$2!==null;)Vk(Y$2)}function Mk(){for(;Y$2!==null&&!cc();)Vk(Y$2)}function Vk(ct){var nt=Wk(ct.alternate,ct,gj);ct.memoizedProps=ct.pendingProps,nt===null?Tk(ct):Y$2=nt,ok$1.current=null}function Tk(ct){var nt=ct;do{var ot=nt.alternate;if(ct=nt.return,nt.flags&32768){if(ot=Jj(ot,nt),ot!==null){ot.flags&=32767,Y$2=ot;return}if(ct!==null)ct.flags|=32768,ct.subtreeFlags=0,ct.deletions=null;else{T$1=6,Y$2=null;return}}else if(ot=Fj(ot,nt,gj),ot!==null){Y$2=ot;return}if(nt=nt.sibling,nt!==null){Y$2=nt;return}Y$2=nt=ct}while(nt!==null);T$1===0&&(T$1=5)}function Qk(ct,nt,ot){var rt=C,ut=pk.transition;try{pk.transition=null,C=1,Xk(ct,nt,ot,rt)}finally{pk.transition=ut,C=rt}return null}function Xk(ct,nt,ot,rt){do Ik();while(xk!==null);if(K&6)throw Error(p$1(327));ot=ct.finishedWork;var ut=ct.finishedLanes;if(ot===null)return null;if(ct.finishedWork=null,ct.finishedLanes=0,ot===ct.current)throw Error(p$1(177));ct.callbackNode=null,ct.callbackPriority=0;var gt=ot.lanes|ot.childLanes;if(Bc(ct,gt),ct===R$1&&(Y$2=R$1=null,Z$2=0),!(ot.subtreeFlags&2064)&&!(ot.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),gt=(ot.flags&15990)!==0,ot.subtreeFlags&15990||gt){gt=pk.transition,pk.transition=null;var pt=C;C=1;var mt=K;K|=4,ok$1.current=null,Pj(ct,ot),ek(ot,ct),Oe(Df),dd=!!Cf,Df=Cf=null,ct.current=ot,ik(ot),dc(),K=mt,C=pt,pk.transition=gt}else ct.current=ot;if(wk&&(wk=!1,xk=ct,yk=ut),gt=ct.pendingLanes,gt===0&&(Si=null),mc(ot.stateNode),Ek(ct,B()),nt!==null)for(rt=ct.onRecoverableError,ot=0;ot<nt.length;ot++)ut=nt[ot],rt(ut.value,{componentStack:ut.stack,digest:ut.digest});if(Pi)throw Pi=!1,ct=Qi,Qi=null,ct;return yk&1&&ct.tag!==0&&Ik(),gt=ct.pendingLanes,gt&1?ct===Ak?zk++:(zk=0,Ak=ct):zk=0,jg(),null}function Ik(){if(xk!==null){var ct=Dc(yk),nt=pk.transition,ot=C;try{if(pk.transition=null,C=16>ct?16:ct,xk===null)var rt=!1;else{if(ct=xk,xk=null,yk=0,K&6)throw Error(p$1(331));var ut=K;for(K|=4,V$1=ct.current;V$1!==null;){var gt=V$1,pt=gt.child;if(V$1.flags&16){var mt=gt.deletions;if(mt!==null){for(var vt=0;vt<mt.length;vt++){var St=mt[vt];for(V$1=St;V$1!==null;){var yt=V$1;switch(yt.tag){case 0:case 11:case 15:Qj(8,yt,gt)}var wt=yt.child;if(wt!==null)wt.return=yt,V$1=wt;else for(;V$1!==null;){yt=V$1;var Lt=yt.sibling,xt=yt.return;if(Tj(yt),yt===St){V$1=null;break}if(Lt!==null){Lt.return=xt,V$1=Lt;break}V$1=xt}}}var It=gt.alternate;if(It!==null){var kt=It.child;if(kt!==null){It.child=null;do{var At=kt.sibling;kt.sibling=null,kt=At}while(kt!==null)}}V$1=gt}}if(gt.subtreeFlags&2064&&pt!==null)pt.return=gt,V$1=pt;else e:for(;V$1!==null;){if(gt=V$1,gt.flags&2048)switch(gt.tag){case 0:case 11:case 15:Qj(9,gt,gt.return)}var Tt=gt.sibling;if(Tt!==null){Tt.return=gt.return,V$1=Tt;break e}V$1=gt.return}}var Rt=ct.current;for(V$1=Rt;V$1!==null;){pt=V$1;var Nt=pt.child;if(pt.subtreeFlags&2064&&Nt!==null)Nt.return=pt,V$1=Nt;else e:for(pt=Rt;V$1!==null;){if(mt=V$1,mt.flags&2048)try{switch(mt.tag){case 0:case 11:case 15:Rj(9,mt)}}catch(Ft){W$1(mt,mt.return,Ft)}if(mt===pt){V$1=null;break e}var Pt=mt.sibling;if(Pt!==null){Pt.return=mt.return,V$1=Pt;break e}V$1=mt.return}}if(K=ut,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,ct)}catch{}rt=!0}return rt}finally{C=ot,pk.transition=nt}}return!1}function Yk(ct,nt,ot){nt=Ki(ot,nt),nt=Oi(ct,nt,1),ct=dh(ct,nt,1),nt=L(),ct!==null&&(Ac(ct,1,nt),Ek(ct,nt))}function W$1(ct,nt,ot){if(ct.tag===3)Yk(ct,ct,ot);else for(;nt!==null;){if(nt.tag===3){Yk(nt,ct,ot);break}else if(nt.tag===1){var rt=nt.stateNode;if(typeof nt.type.getDerivedStateFromError=="function"||typeof rt.componentDidCatch=="function"&&(Si===null||!Si.has(rt))){ct=Ki(ot,ct),ct=Ri(nt,ct,1),nt=dh(nt,ct,1),ct=L(),nt!==null&&(Ac(nt,1,ct),Ek(nt,ct));break}}nt=nt.return}}function Ui(ct,nt,ot){var rt=ct.pingCache;rt!==null&&rt.delete(nt),nt=L(),ct.pingedLanes|=ct.suspendedLanes&ot,R$1===ct&&(Z$2&ot)===ot&&(T$1===4||T$1===3&&(Z$2&130023424)===Z$2&&500>B()-gk?Lk(ct,0):sk|=ot),Ek(ct,nt)}function Zk(ct,nt){nt===0&&(ct.mode&1?(nt=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):nt=1);var ot=L();ct=Zg(ct,nt),ct!==null&&(Ac(ct,nt,ot),Ek(ct,ot))}function vj(ct){var nt=ct.memoizedState,ot=0;nt!==null&&(ot=nt.retryLane),Zk(ct,ot)}function ck(ct,nt){var ot=0;switch(ct.tag){case 13:var rt=ct.stateNode,ut=ct.memoizedState;ut!==null&&(ot=ut.retryLane);break;case 19:rt=ct.stateNode;break;default:throw Error(p$1(314))}rt!==null&&rt.delete(nt),Zk(ct,ot)}var Wk;Wk=function(ct,nt,ot){if(ct!==null)if(ct.memoizedProps!==nt.pendingProps||Wf.current)Ug=!0;else{if(!(ct.lanes&ot)&&!(nt.flags&128))return Ug=!1,zj(ct,nt,ot);Ug=!!(ct.flags&131072)}else Ug=!1,I$1&&nt.flags&1048576&&ug(nt,ng,nt.index);switch(nt.lanes=0,nt.tag){case 2:var rt=nt.type;jj(ct,nt),ct=nt.pendingProps;var ut=Yf(nt,H$1.current);Tg(nt,ot),ut=Xh(null,nt,rt,ct,ut,ot);var gt=bi();return nt.flags|=1,typeof ut=="object"&&ut!==null&&typeof ut.render=="function"&&ut.$$typeof===void 0?(nt.tag=1,nt.memoizedState=null,nt.updateQueue=null,Zf(rt)?(gt=!0,cg(nt)):gt=!1,nt.memoizedState=ut.state!==null&&ut.state!==void 0?ut.state:null,ah(nt),ut.updater=nh,nt.stateNode=ut,ut._reactInternals=nt,rh(nt,rt,ct,ot),nt=kj(null,nt,rt,!0,gt,ot)):(nt.tag=0,I$1&&gt&&vg(nt),Yi(null,nt,ut,ot),nt=nt.child),nt;case 16:rt=nt.elementType;e:{switch(jj(ct,nt),ct=nt.pendingProps,ut=rt._init,rt=ut(rt._payload),nt.type=rt,ut=nt.tag=$k(rt),ct=Lg(rt,ct),ut){case 0:nt=dj(null,nt,rt,ct,ot);break e;case 1:nt=ij(null,nt,rt,ct,ot);break e;case 11:nt=Zi(null,nt,rt,ct,ot);break e;case 14:nt=aj(null,nt,rt,Lg(rt.type,ct),ot);break e}throw Error(p$1(306,rt,""))}return nt;case 0:return rt=nt.type,ut=nt.pendingProps,ut=nt.elementType===rt?ut:Lg(rt,ut),dj(ct,nt,rt,ut,ot);case 1:return rt=nt.type,ut=nt.pendingProps,ut=nt.elementType===rt?ut:Lg(rt,ut),ij(ct,nt,rt,ut,ot);case 3:e:{if(lj(nt),ct===null)throw Error(p$1(387));rt=nt.pendingProps,gt=nt.memoizedState,ut=gt.element,bh(ct,nt),gh(nt,rt,null,ot);var pt=nt.memoizedState;if(rt=pt.element,gt.isDehydrated)if(gt={element:rt,isDehydrated:!1,cache:pt.cache,pendingSuspenseBoundaries:pt.pendingSuspenseBoundaries,transitions:pt.transitions},nt.updateQueue.baseState=gt,nt.memoizedState=gt,nt.flags&256){ut=Ki(Error(p$1(423)),nt),nt=mj(ct,nt,rt,ot,ut);break e}else if(rt!==ut){ut=Ki(Error(p$1(424)),nt),nt=mj(ct,nt,rt,ot,ut);break e}else for(yg=Lf(nt.stateNode.containerInfo.firstChild),xg=nt,I$1=!0,zg=null,ot=Ch(nt,null,rt,ot),nt.child=ot;ot;)ot.flags=ot.flags&-3|4096,ot=ot.sibling;else{if(Ig(),rt===ut){nt=$i(ct,nt,ot);break e}Yi(ct,nt,rt,ot)}nt=nt.child}return nt;case 5:return Kh(nt),ct===null&&Eg(nt),rt=nt.type,ut=nt.pendingProps,gt=ct!==null?ct.memoizedProps:null,pt=ut.children,Ef(rt,ut)?pt=null:gt!==null&&Ef(rt,gt)&&(nt.flags|=32),hj(ct,nt),Yi(ct,nt,pt,ot),nt.child;case 6:return ct===null&&Eg(nt),null;case 13:return pj(ct,nt,ot);case 4:return Ih(nt,nt.stateNode.containerInfo),rt=nt.pendingProps,ct===null?nt.child=Bh(nt,null,rt,ot):Yi(ct,nt,rt,ot),nt.child;case 11:return rt=nt.type,ut=nt.pendingProps,ut=nt.elementType===rt?ut:Lg(rt,ut),Zi(ct,nt,rt,ut,ot);case 7:return Yi(ct,nt,nt.pendingProps,ot),nt.child;case 8:return Yi(ct,nt,nt.pendingProps.children,ot),nt.child;case 12:return Yi(ct,nt,nt.pendingProps.children,ot),nt.child;case 10:e:{if(rt=nt.type._context,ut=nt.pendingProps,gt=nt.memoizedProps,pt=ut.value,G$1(Mg,rt._currentValue),rt._currentValue=pt,gt!==null)if(He(gt.value,pt)){if(gt.children===ut.children&&!Wf.current){nt=$i(ct,nt,ot);break e}}else for(gt=nt.child,gt!==null&&(gt.return=nt);gt!==null;){var mt=gt.dependencies;if(mt!==null){pt=gt.child;for(var vt=mt.firstContext;vt!==null;){if(vt.context===rt){if(gt.tag===1){vt=ch(-1,ot&-ot),vt.tag=2;var St=gt.updateQueue;if(St!==null){St=St.shared;var yt=St.pending;yt===null?vt.next=vt:(vt.next=yt.next,yt.next=vt),St.pending=vt}}gt.lanes|=ot,vt=gt.alternate,vt!==null&&(vt.lanes|=ot),Sg(gt.return,ot,nt),mt.lanes|=ot;break}vt=vt.next}}else if(gt.tag===10)pt=gt.type===nt.type?null:gt.child;else if(gt.tag===18){if(pt=gt.return,pt===null)throw Error(p$1(341));pt.lanes|=ot,mt=pt.alternate,mt!==null&&(mt.lanes|=ot),Sg(pt,ot,nt),pt=gt.sibling}else pt=gt.child;if(pt!==null)pt.return=gt;else for(pt=gt;pt!==null;){if(pt===nt){pt=null;break}if(gt=pt.sibling,gt!==null){gt.return=pt.return,pt=gt;break}pt=pt.return}gt=pt}Yi(ct,nt,ut.children,ot),nt=nt.child}return nt;case 9:return ut=nt.type,rt=nt.pendingProps.children,Tg(nt,ot),ut=Vg(ut),rt=rt(ut),nt.flags|=1,Yi(ct,nt,rt,ot),nt.child;case 14:return rt=nt.type,ut=Lg(rt,nt.pendingProps),ut=Lg(rt.type,ut),aj(ct,nt,rt,ut,ot);case 15:return cj(ct,nt,nt.type,nt.pendingProps,ot);case 17:return rt=nt.type,ut=nt.pendingProps,ut=nt.elementType===rt?ut:Lg(rt,ut),jj(ct,nt),nt.tag=1,Zf(rt)?(ct=!0,cg(nt)):ct=!1,Tg(nt,ot),ph(nt,rt,ut),rh(nt,rt,ut,ot),kj(null,nt,rt,!0,ct,ot);case 19:return yj(ct,nt,ot);case 22:return ej(ct,nt,ot)}throw Error(p$1(156,nt.tag))};function Gk(ct,nt){return ac(ct,nt)}function al(ct,nt,ot,rt){this.tag=ct,this.key=ot,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=nt,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=rt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(ct,nt,ot,rt){return new al(ct,nt,ot,rt)}function bj(ct){return ct=ct.prototype,!(!ct||!ct.isReactComponent)}function $k(ct){if(typeof ct=="function")return bj(ct)?1:0;if(ct!=null){if(ct=ct.$$typeof,ct===Da)return 11;if(ct===Ga)return 14}return 2}function wh(ct,nt){var ot=ct.alternate;return ot===null?(ot=Bg(ct.tag,nt,ct.key,ct.mode),ot.elementType=ct.elementType,ot.type=ct.type,ot.stateNode=ct.stateNode,ot.alternate=ct,ct.alternate=ot):(ot.pendingProps=nt,ot.type=ct.type,ot.flags=0,ot.subtreeFlags=0,ot.deletions=null),ot.flags=ct.flags&14680064,ot.childLanes=ct.childLanes,ot.lanes=ct.lanes,ot.child=ct.child,ot.memoizedProps=ct.memoizedProps,ot.memoizedState=ct.memoizedState,ot.updateQueue=ct.updateQueue,nt=ct.dependencies,ot.dependencies=nt===null?null:{lanes:nt.lanes,firstContext:nt.firstContext},ot.sibling=ct.sibling,ot.index=ct.index,ot.ref=ct.ref,ot}function yh(ct,nt,ot,rt,ut,gt){var pt=2;if(rt=ct,typeof ct=="function")bj(ct)&&(pt=1);else if(typeof ct=="string")pt=5;else e:switch(ct){case ya:return Ah(ot.children,ut,gt,nt);case za:pt=8,ut|=8;break;case Aa:return ct=Bg(12,ot,nt,ut|2),ct.elementType=Aa,ct.lanes=gt,ct;case Ea:return ct=Bg(13,ot,nt,ut),ct.elementType=Ea,ct.lanes=gt,ct;case Fa:return ct=Bg(19,ot,nt,ut),ct.elementType=Fa,ct.lanes=gt,ct;case Ia:return qj(ot,ut,gt,nt);default:if(typeof ct=="object"&&ct!==null)switch(ct.$$typeof){case Ba:pt=10;break e;case Ca:pt=9;break e;case Da:pt=11;break e;case Ga:pt=14;break e;case Ha:pt=16,rt=null;break e}throw Error(p$1(130,ct==null?ct:typeof ct,""))}return nt=Bg(pt,ot,nt,ut),nt.elementType=ct,nt.type=rt,nt.lanes=gt,nt}function Ah(ct,nt,ot,rt){return ct=Bg(7,ct,rt,nt),ct.lanes=ot,ct}function qj(ct,nt,ot,rt){return ct=Bg(22,ct,rt,nt),ct.elementType=Ia,ct.lanes=ot,ct.stateNode={isHidden:!1},ct}function xh(ct,nt,ot){return ct=Bg(6,ct,null,nt),ct.lanes=ot,ct}function zh(ct,nt,ot){return nt=Bg(4,ct.children!==null?ct.children:[],ct.key,nt),nt.lanes=ot,nt.stateNode={containerInfo:ct.containerInfo,pendingChildren:null,implementation:ct.implementation},nt}function bl(ct,nt,ot,rt,ut){this.tag=nt,this.containerInfo=ct,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=rt,this.onRecoverableError=ut,this.mutableSourceEagerHydrationData=null}function cl(ct,nt,ot,rt,ut,gt,pt,mt,vt){return ct=new bl(ct,nt,ot,mt,vt),nt===1?(nt=1,gt===!0&&(nt|=8)):nt=0,gt=Bg(3,null,null,nt),ct.current=gt,gt.stateNode=ct,gt.memoizedState={element:rt,isDehydrated:ot,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(gt),ct}function dl(ct,nt,ot){var rt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:rt==null?null:""+rt,children:ct,containerInfo:nt,implementation:ot}}function el(ct){if(!ct)return Vf;ct=ct._reactInternals;e:{if(Vb(ct)!==ct||ct.tag!==1)throw Error(p$1(170));var nt=ct;do{switch(nt.tag){case 3:nt=nt.stateNode.context;break e;case 1:if(Zf(nt.type)){nt=nt.stateNode.__reactInternalMemoizedMergedChildContext;break e}}nt=nt.return}while(nt!==null);throw Error(p$1(171))}if(ct.tag===1){var ot=ct.type;if(Zf(ot))return bg(ct,ot,nt)}return nt}function fl(ct,nt,ot,rt,ut,gt,pt,mt,vt){return ct=cl(ot,rt,!0,ct,ut,gt,pt,mt,vt),ct.context=el(null),ot=ct.current,rt=L(),ut=lh(ot),gt=ch(rt,ut),gt.callback=nt??null,dh(ot,gt,ut),ct.current.lanes=ut,Ac(ct,ut,rt),Ek(ct,rt),ct}function gl(ct,nt,ot,rt){var ut=nt.current,gt=L(),pt=lh(ut);return ot=el(ot),nt.context===null?nt.context=ot:nt.pendingContext=ot,nt=ch(gt,pt),nt.payload={element:ct},rt=rt===void 0?null:rt,rt!==null&&(nt.callback=rt),ct=dh(ut,nt,pt),ct!==null&&(mh(ct,ut,pt,gt),eh(ct,ut,pt)),pt}function hl(ct){if(ct=ct.current,!ct.child)return null;switch(ct.child.tag){case 5:return ct.child.stateNode;default:return ct.child.stateNode}}function il(ct,nt){if(ct=ct.memoizedState,ct!==null&&ct.dehydrated!==null){var ot=ct.retryLane;ct.retryLane=ot!==0&&ot<nt?ot:nt}}function jl(ct,nt){il(ct,nt),(ct=ct.alternate)&&il(ct,nt)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(ct){console.error(ct)};function ml(ct){this._internalRoot=ct}nl.prototype.render=ml.prototype.render=function(ct){var nt=this._internalRoot;if(nt===null)throw Error(p$1(409));gl(ct,nt,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var ct=this._internalRoot;if(ct!==null){this._internalRoot=null;var nt=ct.containerInfo;Sk(function(){gl(null,ct,null,null)}),nt[uf]=null}};function nl(ct){this._internalRoot=ct}nl.prototype.unstable_scheduleHydration=function(ct){if(ct){var nt=Hc();ct={blockedOn:null,target:ct,priority:nt};for(var ot=0;ot<Qc.length&&nt!==0&&nt<Qc[ot].priority;ot++);Qc.splice(ot,0,ct),ot===0&&Vc(ct)}};function ol(ct){return!(!ct||ct.nodeType!==1&&ct.nodeType!==9&&ct.nodeType!==11)}function pl(ct){return!(!ct||ct.nodeType!==1&&ct.nodeType!==9&&ct.nodeType!==11&&(ct.nodeType!==8||ct.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(ct,nt,ot,rt,ut){if(ut){if(typeof rt=="function"){var gt=rt;rt=function(){var St=hl(pt);gt.call(St)}}var pt=fl(nt,rt,ct,0,null,!1,!1,"",ql);return ct._reactRootContainer=pt,ct[uf]=pt.current,sf(ct.nodeType===8?ct.parentNode:ct),Sk(),pt}for(;ut=ct.lastChild;)ct.removeChild(ut);if(typeof rt=="function"){var mt=rt;rt=function(){var St=hl(vt);mt.call(St)}}var vt=cl(ct,0,!1,null,null,!1,!1,"",ql);return ct._reactRootContainer=vt,ct[uf]=vt.current,sf(ct.nodeType===8?ct.parentNode:ct),Sk(function(){gl(nt,vt,ot,rt)}),vt}function sl(ct,nt,ot,rt,ut){var gt=ot._reactRootContainer;if(gt){var pt=gt;if(typeof ut=="function"){var mt=ut;ut=function(){var vt=hl(pt);mt.call(vt)}}gl(nt,pt,ct,ut)}else pt=rl(ot,nt,ct,ut,rt);return hl(pt)}Ec=function(ct){switch(ct.tag){case 3:var nt=ct.stateNode;if(nt.current.memoizedState.isDehydrated){var ot=tc(nt.pendingLanes);ot!==0&&(Cc(nt,ot|1),Ek(nt,B()),!(K&6)&&(Hj=B()+500,jg()))}break;case 13:Sk(function(){var rt=Zg(ct,1);if(rt!==null){var ut=L();mh(rt,ct,1,ut)}}),jl(ct,1)}};Fc=function(ct){if(ct.tag===13){var nt=Zg(ct,134217728);if(nt!==null){var ot=L();mh(nt,ct,134217728,ot)}jl(ct,134217728)}};Gc=function(ct){if(ct.tag===13){var nt=lh(ct),ot=Zg(ct,nt);if(ot!==null){var rt=L();mh(ot,ct,nt,rt)}jl(ct,nt)}};Hc=function(){return C};Ic=function(ct,nt){var ot=C;try{return C=ct,nt()}finally{C=ot}};yb=function(ct,nt,ot){switch(nt){case"input":if(bb(ct,ot),nt=ot.name,ot.type==="radio"&&nt!=null){for(ot=ct;ot.parentNode;)ot=ot.parentNode;for(ot=ot.querySelectorAll("input[name="+JSON.stringify(""+nt)+'][type="radio"]'),nt=0;nt<ot.length;nt++){var rt=ot[nt];if(rt!==ct&&rt.form===ct.form){var ut=Db(rt);if(!ut)throw Error(p$1(90));Wa(rt),bb(rt,ut)}}}break;case"textarea":ib(ct,ot);break;case"select":nt=ot.value,nt!=null&&fb(ct,!!ot.multiple,nt,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue$1,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(ct){return ct=Zb(ct),ct===null?null:ct.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(ct,nt){var ot=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(nt))throw Error(p$1(200));return dl(ct,nt,null,ot)};reactDom_production_min.createRoot=function(ct,nt){if(!ol(ct))throw Error(p$1(299));var ot=!1,rt="",ut=ll;return nt!=null&&(nt.unstable_strictMode===!0&&(ot=!0),nt.identifierPrefix!==void 0&&(rt=nt.identifierPrefix),nt.onRecoverableError!==void 0&&(ut=nt.onRecoverableError)),nt=cl(ct,1,!1,null,null,ot,!1,rt,ut),ct[uf]=nt.current,sf(ct.nodeType===8?ct.parentNode:ct),new ml(nt)};reactDom_production_min.findDOMNode=function(ct){if(ct==null)return null;if(ct.nodeType===1)return ct;var nt=ct._reactInternals;if(nt===void 0)throw typeof ct.render=="function"?Error(p$1(188)):(ct=Object.keys(ct).join(","),Error(p$1(268,ct)));return ct=Zb(nt),ct=ct===null?null:ct.stateNode,ct};reactDom_production_min.flushSync=function(ct){return Sk(ct)};reactDom_production_min.hydrate=function(ct,nt,ot){if(!pl(nt))throw Error(p$1(200));return sl(null,ct,nt,!0,ot)};reactDom_production_min.hydrateRoot=function(ct,nt,ot){if(!ol(ct))throw Error(p$1(405));var rt=ot!=null&&ot.hydratedSources||null,ut=!1,gt="",pt=ll;if(ot!=null&&(ot.unstable_strictMode===!0&&(ut=!0),ot.identifierPrefix!==void 0&&(gt=ot.identifierPrefix),ot.onRecoverableError!==void 0&&(pt=ot.onRecoverableError)),nt=fl(nt,null,ct,1,ot??null,ut,!1,gt,pt),ct[uf]=nt.current,sf(ct),rt)for(ct=0;ct<rt.length;ct++)ot=rt[ct],ut=ot._getVersion,ut=ut(ot._source),nt.mutableSourceEagerHydrationData==null?nt.mutableSourceEagerHydrationData=[ot,ut]:nt.mutableSourceEagerHydrationData.push(ot,ut);return new nl(nt)};reactDom_production_min.render=function(ct,nt,ot){if(!pl(nt))throw Error(p$1(200));return sl(null,ct,nt,!1,ot)};reactDom_production_min.unmountComponentAtNode=function(ct){if(!pl(ct))throw Error(p$1(40));return ct._reactRootContainer?(Sk(function(){sl(null,null,ct,!1,function(){ct._reactRootContainer=null,ct[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(ct,nt,ot,rt){if(!pl(ot))throw Error(p$1(200));if(ct==null||ct._reactInternals===void 0)throw Error(p$1(38));return sl(ct,nt,ot,!1,rt)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(ct){console.error(ct)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$1=reactDomExports;client.createRoot=m$1.createRoot,client.hydrateRoot=m$1.hydrateRoot;const App$1="";/**
 * @remix-run/router v1.6.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(ct){for(var nt=1;nt<arguments.length;nt++){var ot=arguments[nt];for(var rt in ot)Object.prototype.hasOwnProperty.call(ot,rt)&&(ct[rt]=ot[rt])}return ct},_extends$2.apply(this,arguments)}var Action$1;(function(ct){ct.Pop="POP",ct.Push="PUSH",ct.Replace="REPLACE"})(Action$1||(Action$1={}));const PopStateEventType="popstate";function createBrowserHistory(ct){ct===void 0&&(ct={});function nt(rt,ut){let{pathname:gt,search:pt,hash:mt}=rt.location;return createLocation("",{pathname:gt,search:pt,hash:mt},ut.state&&ut.state.usr||null,ut.state&&ut.state.key||"default")}function ot(rt,ut){return typeof ut=="string"?ut:createPath(ut)}return getUrlBasedHistory(nt,ot,null,ct)}function invariant(ct,nt){if(ct===!1||ct===null||typeof ct>"u")throw new Error(nt)}function warning(ct,nt){if(!ct){typeof console<"u"&&console.warn(nt);try{throw new Error(nt)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(ct,nt){return{usr:ct.state,key:ct.key,idx:nt}}function createLocation(ct,nt,ot,rt){return ot===void 0&&(ot=null),_extends$2({pathname:typeof ct=="string"?ct:ct.pathname,search:"",hash:""},typeof nt=="string"?parsePath(nt):nt,{state:ot,key:nt&&nt.key||rt||createKey()})}function createPath(ct){let{pathname:nt="/",search:ot="",hash:rt=""}=ct;return ot&&ot!=="?"&&(nt+=ot.charAt(0)==="?"?ot:"?"+ot),rt&&rt!=="#"&&(nt+=rt.charAt(0)==="#"?rt:"#"+rt),nt}function parsePath(ct){let nt={};if(ct){let ot=ct.indexOf("#");ot>=0&&(nt.hash=ct.substr(ot),ct=ct.substr(0,ot));let rt=ct.indexOf("?");rt>=0&&(nt.search=ct.substr(rt),ct=ct.substr(0,rt)),ct&&(nt.pathname=ct)}return nt}function getUrlBasedHistory(ct,nt,ot,rt){rt===void 0&&(rt={});let{window:ut=document.defaultView,v5Compat:gt=!1}=rt,pt=ut.history,mt=Action$1.Pop,vt=null,St=yt();St==null&&(St=0,pt.replaceState(_extends$2({},pt.state,{idx:St}),""));function yt(){return(pt.state||{idx:null}).idx}function wt(){mt=Action$1.Pop;let At=yt(),Tt=At==null?null:At-St;St=At,vt&&vt({action:mt,location:kt.location,delta:Tt})}function Lt(At,Tt){mt=Action$1.Push;let Rt=createLocation(kt.location,At,Tt);ot&&ot(Rt,At),St=yt()+1;let Nt=getHistoryState(Rt,St),Pt=kt.createHref(Rt);try{pt.pushState(Nt,"",Pt)}catch{ut.location.assign(Pt)}gt&&vt&&vt({action:mt,location:kt.location,delta:1})}function xt(At,Tt){mt=Action$1.Replace;let Rt=createLocation(kt.location,At,Tt);ot&&ot(Rt,At),St=yt();let Nt=getHistoryState(Rt,St),Pt=kt.createHref(Rt);pt.replaceState(Nt,"",Pt),gt&&vt&&vt({action:mt,location:kt.location,delta:0})}function It(At){let Tt=ut.location.origin!=="null"?ut.location.origin:ut.location.href,Rt=typeof At=="string"?At:createPath(At);return invariant(Tt,"No window.location.(origin|href) available to create URL for href: "+Rt),new URL(Rt,Tt)}let kt={get action(){return mt},get location(){return ct(ut,pt)},listen(At){if(vt)throw new Error("A history only accepts one active listener");return ut.addEventListener(PopStateEventType,wt),vt=At,()=>{ut.removeEventListener(PopStateEventType,wt),vt=null}},createHref(At){return nt(ut,At)},createURL:It,encodeLocation(At){let Tt=It(At);return{pathname:Tt.pathname,search:Tt.search,hash:Tt.hash}},push:Lt,replace:xt,go(At){return pt.go(At)}};return kt}var ResultType;(function(ct){ct.data="data",ct.deferred="deferred",ct.redirect="redirect",ct.error="error"})(ResultType||(ResultType={}));function matchRoutes(ct,nt,ot){ot===void 0&&(ot="/");let rt=typeof nt=="string"?parsePath(nt):nt,ut=stripBasename(rt.pathname||"/",ot);if(ut==null)return null;let gt=flattenRoutes(ct);rankRouteBranches(gt);let pt=null;for(let mt=0;pt==null&&mt<gt.length;++mt)pt=matchRouteBranch(gt[mt],safelyDecodeURI(ut));return pt}function flattenRoutes(ct,nt,ot,rt){nt===void 0&&(nt=[]),ot===void 0&&(ot=[]),rt===void 0&&(rt="");let ut=(gt,pt,mt)=>{let vt={relativePath:mt===void 0?gt.path||"":mt,caseSensitive:gt.caseSensitive===!0,childrenIndex:pt,route:gt};vt.relativePath.startsWith("/")&&(invariant(vt.relativePath.startsWith(rt),'Absolute route path "'+vt.relativePath+'" nested under path '+('"'+rt+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),vt.relativePath=vt.relativePath.slice(rt.length));let St=joinPaths([rt,vt.relativePath]),yt=ot.concat(vt);gt.children&&gt.children.length>0&&(invariant(gt.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+St+'".')),flattenRoutes(gt.children,nt,yt,St)),!(gt.path==null&&!gt.index)&&nt.push({path:St,score:computeScore(St,gt.index),routesMeta:yt})};return ct.forEach((gt,pt)=>{var mt;if(gt.path===""||!((mt=gt.path)!=null&&mt.includes("?")))ut(gt,pt);else for(let vt of explodeOptionalSegments(gt.path))ut(gt,pt,vt)}),nt}function explodeOptionalSegments(ct){let nt=ct.split("/");if(nt.length===0)return[];let[ot,...rt]=nt,ut=ot.endsWith("?"),gt=ot.replace(/\?$/,"");if(rt.length===0)return ut?[gt,""]:[gt];let pt=explodeOptionalSegments(rt.join("/")),mt=[];return mt.push(...pt.map(vt=>vt===""?gt:[gt,vt].join("/"))),ut&&mt.push(...pt),mt.map(vt=>ct.startsWith("/")&&vt===""?"/":vt)}function rankRouteBranches(ct){ct.sort((nt,ot)=>nt.score!==ot.score?ot.score-nt.score:compareIndexes(nt.routesMeta.map(rt=>rt.childrenIndex),ot.routesMeta.map(rt=>rt.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=ct=>ct==="*";function computeScore(ct,nt){let ot=ct.split("/"),rt=ot.length;return ot.some(isSplat)&&(rt+=splatPenalty),nt&&(rt+=indexRouteValue),ot.filter(ut=>!isSplat(ut)).reduce((ut,gt)=>ut+(paramRe.test(gt)?dynamicSegmentValue:gt===""?emptySegmentValue:staticSegmentValue),rt)}function compareIndexes(ct,nt){return ct.length===nt.length&&ct.slice(0,-1).every((rt,ut)=>rt===nt[ut])?ct[ct.length-1]-nt[nt.length-1]:0}function matchRouteBranch(ct,nt){let{routesMeta:ot}=ct,rt={},ut="/",gt=[];for(let pt=0;pt<ot.length;++pt){let mt=ot[pt],vt=pt===ot.length-1,St=ut==="/"?nt:nt.slice(ut.length)||"/",yt=matchPath({path:mt.relativePath,caseSensitive:mt.caseSensitive,end:vt},St);if(!yt)return null;Object.assign(rt,yt.params);let wt=mt.route;gt.push({params:rt,pathname:joinPaths([ut,yt.pathname]),pathnameBase:normalizePathname(joinPaths([ut,yt.pathnameBase])),route:wt}),yt.pathnameBase!=="/"&&(ut=joinPaths([ut,yt.pathnameBase]))}return gt}function matchPath(ct,nt){typeof ct=="string"&&(ct={path:ct,caseSensitive:!1,end:!0});let[ot,rt]=compilePath(ct.path,ct.caseSensitive,ct.end),ut=nt.match(ot);if(!ut)return null;let gt=ut[0],pt=gt.replace(/(.)\/+$/,"$1"),mt=ut.slice(1);return{params:rt.reduce((St,yt,wt)=>{if(yt==="*"){let Lt=mt[wt]||"";pt=gt.slice(0,gt.length-Lt.length).replace(/(.)\/+$/,"$1")}return St[yt]=safelyDecodeURIComponent(mt[wt]||"",yt),St},{}),pathname:gt,pathnameBase:pt,pattern:ct}}function compilePath(ct,nt,ot){nt===void 0&&(nt=!1),ot===void 0&&(ot=!0),warning(ct==="*"||!ct.endsWith("*")||ct.endsWith("/*"),'Route path "'+ct+'" will be treated as if it were '+('"'+ct.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+ct.replace(/\*$/,"/*")+'".'));let rt=[],ut="^"+ct.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(pt,mt)=>(rt.push(mt),"/([^\\/]+)"));return ct.endsWith("*")?(rt.push("*"),ut+=ct==="*"||ct==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):ot?ut+="\\/*$":ct!==""&&ct!=="/"&&(ut+="(?:(?=\\/|$))"),[new RegExp(ut,nt?void 0:"i"),rt]}function safelyDecodeURI(ct){try{return decodeURI(ct)}catch(nt){return warning(!1,'The URL path "'+ct+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+nt+").")),ct}}function safelyDecodeURIComponent(ct,nt){try{return decodeURIComponent(ct)}catch(ot){return warning(!1,'The value for the URL param "'+nt+'" will not be decoded because'+(' the string "'+ct+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+ot+").")),ct}}function stripBasename(ct,nt){if(nt==="/")return ct;if(!ct.toLowerCase().startsWith(nt.toLowerCase()))return null;let ot=nt.endsWith("/")?nt.length-1:nt.length,rt=ct.charAt(ot);return rt&&rt!=="/"?null:ct.slice(ot)||"/"}function resolvePath$1(ct,nt){nt===void 0&&(nt="/");let{pathname:ot,search:rt="",hash:ut=""}=typeof ct=="string"?parsePath(ct):ct;return{pathname:ot?ot.startsWith("/")?ot:resolvePathname(ot,nt):nt,search:normalizeSearch(rt),hash:normalizeHash(ut)}}function resolvePathname(ct,nt){let ot=nt.replace(/\/+$/,"").split("/");return ct.split("/").forEach(ut=>{ut===".."?ot.length>1&&ot.pop():ut!=="."&&ot.push(ut)}),ot.length>1?ot.join("/"):"/"}function getInvalidPathError(ct,nt,ot,rt){return"Cannot include a '"+ct+"' character in a manually specified "+("`to."+nt+"` field ["+JSON.stringify(rt)+"].  Please separate it out to the ")+("`to."+ot+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(ct){return ct.filter((nt,ot)=>ot===0||nt.route.path&&nt.route.path.length>0)}function resolveTo(ct,nt,ot,rt){rt===void 0&&(rt=!1);let ut;typeof ct=="string"?ut=parsePath(ct):(ut=_extends$2({},ct),invariant(!ut.pathname||!ut.pathname.includes("?"),getInvalidPathError("?","pathname","search",ut)),invariant(!ut.pathname||!ut.pathname.includes("#"),getInvalidPathError("#","pathname","hash",ut)),invariant(!ut.search||!ut.search.includes("#"),getInvalidPathError("#","search","hash",ut)));let gt=ct===""||ut.pathname==="",pt=gt?"/":ut.pathname,mt;if(rt||pt==null)mt=ot;else{let wt=nt.length-1;if(pt.startsWith("..")){let Lt=pt.split("/");for(;Lt[0]==="..";)Lt.shift(),wt-=1;ut.pathname=Lt.join("/")}mt=wt>=0?nt[wt]:"/"}let vt=resolvePath$1(ut,mt),St=pt&&pt!=="/"&&pt.endsWith("/"),yt=(gt||pt===".")&&ot.endsWith("/");return!vt.pathname.endsWith("/")&&(St||yt)&&(vt.pathname+="/"),vt}const joinPaths=ct=>ct.join("/").replace(/\/\/+/g,"/"),normalizePathname=ct=>ct.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=ct=>!ct||ct==="?"?"":ct.startsWith("?")?ct:"?"+ct,normalizeHash=ct=>!ct||ct==="#"?"":ct.startsWith("#")?ct:"#"+ct;function isRouteErrorResponse(ct){return ct!=null&&typeof ct.status=="number"&&typeof ct.statusText=="string"&&typeof ct.internal=="boolean"&&"data"in ct}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.11.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(ct){for(var nt=1;nt<arguments.length;nt++){var ot=arguments[nt];for(var rt in ot)Object.prototype.hasOwnProperty.call(ot,rt)&&(ct[rt]=ot[rt])}return ct},_extends$1.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect(ct){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(ct)}function useNavigate(){let{isDataRoute:ct}=reactExports.useContext(RouteContext);return ct?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let{basename:ct,navigator:nt}=reactExports.useContext(NavigationContext),{matches:ot}=reactExports.useContext(RouteContext),{pathname:rt}=useLocation(),ut=JSON.stringify(getPathContributingMatches(ot).map(mt=>mt.pathnameBase)),gt=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{gt.current=!0}),reactExports.useCallback(function(mt,vt){if(vt===void 0&&(vt={}),!gt.current)return;if(typeof mt=="number"){nt.go(mt);return}let St=resolveTo(mt,JSON.parse(ut),rt,vt.relative==="path");ct!=="/"&&(St.pathname=St.pathname==="/"?ct:joinPaths([ct,St.pathname])),(vt.replace?nt.replace:nt.push)(St,vt.state,vt)},[ct,nt,ut,rt])}function useParams(){let{matches:ct}=reactExports.useContext(RouteContext),nt=ct[ct.length-1];return nt?nt.params:{}}function useRoutes(ct,nt){return useRoutesImpl(ct,nt)}function useRoutesImpl(ct,nt,ot){useInRouterContext()||invariant(!1);let{navigator:rt}=reactExports.useContext(NavigationContext),{matches:ut}=reactExports.useContext(RouteContext),gt=ut[ut.length-1],pt=gt?gt.params:{};gt&&gt.pathname;let mt=gt?gt.pathnameBase:"/";gt&&gt.route;let vt=useLocation(),St;if(nt){var yt;let kt=typeof nt=="string"?parsePath(nt):nt;mt==="/"||(yt=kt.pathname)!=null&&yt.startsWith(mt)||invariant(!1),St=kt}else St=vt;let wt=St.pathname||"/",Lt=mt==="/"?wt:wt.slice(mt.length)||"/",xt=matchRoutes(ct,{pathname:Lt}),It=_renderMatches(xt&&xt.map(kt=>Object.assign({},kt,{params:Object.assign({},pt,kt.params),pathname:joinPaths([mt,rt.encodeLocation?rt.encodeLocation(kt.pathname).pathname:kt.pathname]),pathnameBase:kt.pathnameBase==="/"?mt:joinPaths([mt,rt.encodeLocation?rt.encodeLocation(kt.pathnameBase).pathname:kt.pathnameBase])})),ut,ot);return nt&&It?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},St),navigationType:Action$1.Pop}},It):It}function DefaultErrorComponent(){let ct=useRouteError(),nt=isRouteErrorResponse(ct)?ct.status+" "+ct.statusText:ct instanceof Error?ct.message:JSON.stringify(ct),ot=ct instanceof Error?ct.stack:null,ut={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},gt=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},nt),ot?reactExports.createElement("pre",{style:ut},ot):null,gt)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(nt){super(nt),this.state={location:nt.location,revalidation:nt.revalidation,error:nt.error}}static getDerivedStateFromError(nt){return{error:nt}}static getDerivedStateFromProps(nt,ot){return ot.location!==nt.location||ot.revalidation!=="idle"&&nt.revalidation==="idle"?{error:nt.error,location:nt.location,revalidation:nt.revalidation}:{error:nt.error||ot.error,location:ot.location,revalidation:nt.revalidation||ot.revalidation}}componentDidCatch(nt,ot){console.error("React Router caught the following error during render",nt,ot)}render(){return this.state.error?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(ct){let{routeContext:nt,match:ot,children:rt}=ct,ut=reactExports.useContext(DataRouterContext);return ut&&ut.static&&ut.staticContext&&(ot.route.errorElement||ot.route.ErrorBoundary)&&(ut.staticContext._deepestRenderedBoundaryId=ot.route.id),reactExports.createElement(RouteContext.Provider,{value:nt},rt)}function _renderMatches(ct,nt,ot){var rt;if(nt===void 0&&(nt=[]),ot===void 0&&(ot=null),ct==null){var ut;if((ut=ot)!=null&&ut.errors)ct=ot.matches;else return null}let gt=ct,pt=(rt=ot)==null?void 0:rt.errors;if(pt!=null){let mt=gt.findIndex(vt=>vt.route.id&&(pt==null?void 0:pt[vt.route.id]));mt>=0||invariant(!1),gt=gt.slice(0,Math.min(gt.length,mt+1))}return gt.reduceRight((mt,vt,St)=>{let yt=vt.route.id?pt==null?void 0:pt[vt.route.id]:null,wt=null;ot&&(wt=vt.route.errorElement||defaultErrorElement);let Lt=nt.concat(gt.slice(0,St+1)),xt=()=>{let It;return yt?It=wt:vt.route.Component?It=reactExports.createElement(vt.route.Component,null):vt.route.element?It=vt.route.element:It=mt,reactExports.createElement(RenderedRoute,{match:vt,routeContext:{outlet:mt,matches:Lt,isDataRoute:ot!=null},children:It})};return ot&&(vt.route.ErrorBoundary||vt.route.errorElement||St===0)?reactExports.createElement(RenderErrorBoundary,{location:ot.location,revalidation:ot.revalidation,component:wt,error:yt,children:xt(),routeContext:{outlet:null,matches:Lt,isDataRoute:!0}}):xt()},null)}var DataRouterHook$1;(function(ct){ct.UseBlocker="useBlocker",ct.UseRevalidator="useRevalidator",ct.UseNavigateStable="useNavigate"})(DataRouterHook$1||(DataRouterHook$1={}));var DataRouterStateHook$1;(function(ct){ct.UseBlocker="useBlocker",ct.UseLoaderData="useLoaderData",ct.UseActionData="useActionData",ct.UseRouteError="useRouteError",ct.UseNavigation="useNavigation",ct.UseRouteLoaderData="useRouteLoaderData",ct.UseMatches="useMatches",ct.UseRevalidator="useRevalidator",ct.UseNavigateStable="useNavigate",ct.UseRouteId="useRouteId"})(DataRouterStateHook$1||(DataRouterStateHook$1={}));function useDataRouterContext(ct){let nt=reactExports.useContext(DataRouterContext);return nt||invariant(!1),nt}function useDataRouterState(ct){let nt=reactExports.useContext(DataRouterStateContext);return nt||invariant(!1),nt}function useRouteContext(ct){let nt=reactExports.useContext(RouteContext);return nt||invariant(!1),nt}function useCurrentRouteId(ct){let nt=useRouteContext(),ot=nt.matches[nt.matches.length-1];return ot.route.id||invariant(!1),ot.route.id}function useRouteError(){var ct;let nt=reactExports.useContext(RouteErrorContext),ot=useDataRouterState(DataRouterStateHook$1.UseRouteError),rt=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return nt||((ct=ot.errors)==null?void 0:ct[rt])}function useNavigateStable(){let{router:ct}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),nt=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),ot=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{ot.current=!0}),reactExports.useCallback(function(ut,gt){gt===void 0&&(gt={}),ot.current&&(typeof ut=="number"?ct.navigate(ut):ct.navigate(ut,_extends$1({fromRouteId:nt},gt)))},[ct,nt])}function Navigate(ct){let{to:nt,replace:ot,state:rt,relative:ut}=ct;useInRouterContext()||invariant(!1);let{matches:gt}=reactExports.useContext(RouteContext),{pathname:pt}=useLocation(),mt=useNavigate(),vt=resolveTo(nt,getPathContributingMatches(gt).map(yt=>yt.pathnameBase),pt,ut==="path"),St=JSON.stringify(vt);return reactExports.useEffect(()=>mt(JSON.parse(St),{replace:ot,state:rt,relative:ut}),[mt,St,ut,ot,rt]),null}function Route(ct){invariant(!1)}function Router(ct){let{basename:nt="/",children:ot=null,location:rt,navigationType:ut=Action$1.Pop,navigator:gt,static:pt=!1}=ct;useInRouterContext()&&invariant(!1);let mt=nt.replace(/^\/*/,"/"),vt=reactExports.useMemo(()=>({basename:mt,navigator:gt,static:pt}),[mt,gt,pt]);typeof rt=="string"&&(rt=parsePath(rt));let{pathname:St="/",search:yt="",hash:wt="",state:Lt=null,key:xt="default"}=rt,It=reactExports.useMemo(()=>{let kt=stripBasename(St,mt);return kt==null?null:{location:{pathname:kt,search:yt,hash:wt,state:Lt,key:xt},navigationType:ut}},[mt,St,yt,wt,Lt,xt,ut]);return It==null?null:reactExports.createElement(NavigationContext.Provider,{value:vt},reactExports.createElement(LocationContext.Provider,{children:ot,value:It}))}function Routes(ct){let{children:nt,location:ot}=ct;return useRoutes(createRoutesFromChildren(nt),ot)}var AwaitRenderStatus;(function(ct){ct[ct.pending=0]="pending",ct[ct.success=1]="success",ct[ct.error=2]="error"})(AwaitRenderStatus||(AwaitRenderStatus={}));new Promise(()=>{});function createRoutesFromChildren(ct,nt){nt===void 0&&(nt=[]);let ot=[];return reactExports.Children.forEach(ct,(rt,ut)=>{if(!reactExports.isValidElement(rt))return;let gt=[...nt,ut];if(rt.type===reactExports.Fragment){ot.push.apply(ot,createRoutesFromChildren(rt.props.children,gt));return}rt.type!==Route&&invariant(!1),!rt.props.index||!rt.props.children||invariant(!1);let pt={id:rt.props.id||gt.join("-"),caseSensitive:rt.props.caseSensitive,element:rt.props.element,Component:rt.props.Component,index:rt.props.index,path:rt.props.path,loader:rt.props.loader,action:rt.props.action,errorElement:rt.props.errorElement,ErrorBoundary:rt.props.ErrorBoundary,hasErrorBoundary:rt.props.ErrorBoundary!=null||rt.props.errorElement!=null,shouldRevalidate:rt.props.shouldRevalidate,handle:rt.props.handle,lazy:rt.props.lazy};rt.props.children&&(pt.children=createRoutesFromChildren(rt.props.children,gt)),ot.push(pt)}),ot}/**
 * React Router DOM v6.11.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function BrowserRouter(ct){let{basename:nt,children:ot,window:rt}=ct,ut=reactExports.useRef();ut.current==null&&(ut.current=createBrowserHistory({window:rt,v5Compat:!0}));let gt=ut.current,[pt,mt]=reactExports.useState({action:gt.action,location:gt.location});return reactExports.useLayoutEffect(()=>gt.listen(mt),[gt]),reactExports.createElement(Router,{basename:nt,children:ot,location:pt.location,navigationType:pt.action,navigator:gt})}var DataRouterHook;(function(ct){ct.UseScrollRestoration="useScrollRestoration",ct.UseSubmitImpl="useSubmitImpl",ct.UseFetcher="useFetcher"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(ct){ct.UseFetchers="useFetchers",ct.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));let e={data:""},t=ct=>typeof window=="object"?((ct?ct.querySelector("#_goober"):window._goober)||Object.assign((ct||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:ct||e,l$1=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,a=/\/\*[^]*?\*\/|  +/g,n$1=/\n+/g,o=(ct,nt)=>{let ot="",rt="",ut="";for(let gt in ct){let pt=ct[gt];gt[0]=="@"?gt[1]=="i"?ot=gt+" "+pt+";":rt+=gt[1]=="f"?o(pt,gt):gt+"{"+o(pt,gt[1]=="k"?"":nt)+"}":typeof pt=="object"?rt+=o(pt,nt?nt.replace(/([^,])+/g,mt=>gt.replace(/(^:.*)|([^,])+/g,vt=>/&/.test(vt)?vt.replace(/&/g,mt):mt?mt+" "+vt:vt)):gt):pt!=null&&(gt=/^--/.test(gt)?gt:gt.replace(/[A-Z]/g,"-$&").toLowerCase(),ut+=o.p?o.p(gt,pt):gt+":"+pt+";")}return ot+(nt&&ut?nt+"{"+ut+"}":ut)+rt},c={},s=ct=>{if(typeof ct=="object"){let nt="";for(let ot in ct)nt+=ot+s(ct[ot]);return nt}return ct},i$1=(ct,nt,ot,rt,ut)=>{let gt=s(ct),pt=c[gt]||(c[gt]=(vt=>{let St=0,yt=11;for(;St<vt.length;)yt=101*yt+vt.charCodeAt(St++)>>>0;return"go"+yt})(gt));if(!c[pt]){let vt=gt!==ct?ct:(St=>{let yt,wt,Lt=[{}];for(;yt=l$1.exec(St.replace(a,""));)yt[4]?Lt.shift():yt[3]?(wt=yt[3].replace(n$1," ").trim(),Lt.unshift(Lt[0][wt]=Lt[0][wt]||{})):Lt[0][yt[1]]=yt[2].replace(n$1," ").trim();return Lt[0]})(ct);c[pt]=o(ut?{["@keyframes "+pt]:vt}:vt,ot?"":"."+pt)}let mt=ot&&c.g?c.g:null;return ot&&(c.g=c[pt]),((vt,St,yt,wt)=>{wt?St.data=St.data.replace(wt,vt):St.data.indexOf(vt)===-1&&(St.data=yt?vt+St.data:St.data+vt)})(c[pt],nt,rt,mt),pt},p=(ct,nt,ot)=>ct.reduce((rt,ut,gt)=>{let pt=nt[gt];if(pt&&pt.call){let mt=pt(ot),vt=mt&&mt.props&&mt.props.className||/^go/.test(mt)&&mt;pt=vt?"."+vt:mt&&typeof mt=="object"?mt.props?"":o(mt,""):mt===!1?"":mt}return rt+ut+(pt??"")},"");function u$1(ct){let nt=this||{},ot=ct.call?ct(nt.p):ct;return i$1(ot.unshift?ot.raw?p(ot,[].slice.call(arguments,1),nt.p):ot.reduce((rt,ut)=>Object.assign(rt,ut&&ut.call?ut(nt.p):ut),{}):ot,t(nt.target),nt.g,nt.o,nt.k)}let d,f,g;u$1.bind({g:1});let h$3=u$1.bind({k:1});function m(ct,nt,ot,rt){o.p=nt,d=ct,f=ot,g=rt}function j(ct,nt){let ot=this||{};return function(){let rt=arguments;function ut(gt,pt){let mt=Object.assign({},gt),vt=mt.className||ut.className;ot.p=Object.assign({theme:f&&f()},mt),ot.o=/ *go\d+/.test(vt),mt.className=u$1.apply(ot,rt)+(vt?" "+vt:""),nt&&(mt.ref=pt);let St=ct;return ct[0]&&(St=mt.as||ct,delete mt.as),g&&St[0]&&g(mt),d(St,mt)}return nt?nt(ut):ut}}var W=ct=>typeof ct=="function",T=(ct,nt)=>W(ct)?ct(nt):ct,U=(()=>{let ct=0;return()=>(++ct).toString()})(),b$1=(()=>{let ct;return()=>{if(ct===void 0&&typeof window<"u"){let nt=matchMedia("(prefers-reduced-motion: reduce)");ct=!nt||nt.matches}return ct}})(),Q=20,S=new Map,X=1e3,$$x=ct=>{if(S.has(ct))return;let nt=setTimeout(()=>{S.delete(ct),u({type:4,toastId:ct})},X);S.set(ct,nt)},J=ct=>{let nt=S.get(ct);nt&&clearTimeout(nt)},v$1=(ct,nt)=>{switch(nt.type){case 0:return{...ct,toasts:[nt.toast,...ct.toasts].slice(0,Q)};case 1:return nt.toast.id&&J(nt.toast.id),{...ct,toasts:ct.toasts.map(gt=>gt.id===nt.toast.id?{...gt,...nt.toast}:gt)};case 2:let{toast:ot}=nt;return ct.toasts.find(gt=>gt.id===ot.id)?v$1(ct,{type:1,toast:ot}):v$1(ct,{type:0,toast:ot});case 3:let{toastId:rt}=nt;return rt?$$x(rt):ct.toasts.forEach(gt=>{$$x(gt.id)}),{...ct,toasts:ct.toasts.map(gt=>gt.id===rt||rt===void 0?{...gt,visible:!1}:gt)};case 4:return nt.toastId===void 0?{...ct,toasts:[]}:{...ct,toasts:ct.toasts.filter(gt=>gt.id!==nt.toastId)};case 5:return{...ct,pausedAt:nt.time};case 6:let ut=nt.time-(ct.pausedAt||0);return{...ct,pausedAt:void 0,toasts:ct.toasts.map(gt=>({...gt,pauseDuration:gt.pauseDuration+ut}))}}},A=[],P={toasts:[],pausedAt:void 0},u=ct=>{P=v$1(P,ct),A.forEach(nt=>{nt(P)})},Y$1={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},I=(ct={})=>{let[nt,ot]=reactExports.useState(P);reactExports.useEffect(()=>(A.push(ot),()=>{let ut=A.indexOf(ot);ut>-1&&A.splice(ut,1)}),[nt]);let rt=nt.toasts.map(ut=>{var gt,pt;return{...ct,...ct[ut.type],...ut,duration:ut.duration||((gt=ct[ut.type])==null?void 0:gt.duration)||(ct==null?void 0:ct.duration)||Y$1[ut.type],style:{...ct.style,...(pt=ct[ut.type])==null?void 0:pt.style,...ut.style}}});return{...nt,toasts:rt}},G=(ct,nt="blank",ot)=>({createdAt:Date.now(),visible:!0,type:nt,ariaProps:{role:"status","aria-live":"polite"},message:ct,pauseDuration:0,...ot,id:(ot==null?void 0:ot.id)||U()}),h$2=ct=>(nt,ot)=>{let rt=G(nt,ct,ot);return u({type:2,toast:rt}),rt.id},n=(ct,nt)=>h$2("blank")(ct,nt);n.error=h$2("error");n.success=h$2("success");n.loading=h$2("loading");n.custom=h$2("custom");n.dismiss=ct=>{u({type:3,toastId:ct})};n.remove=ct=>u({type:4,toastId:ct});n.promise=(ct,nt,ot)=>{let rt=n.loading(nt.loading,{...ot,...ot==null?void 0:ot.loading});return ct.then(ut=>(n.success(T(nt.success,ut),{id:rt,...ot,...ot==null?void 0:ot.success}),ut)).catch(ut=>{n.error(T(nt.error,ut),{id:rt,...ot,...ot==null?void 0:ot.error})}),ct};var Z$1=(ct,nt)=>{u({type:1,toast:{id:ct,height:nt}})},ee=()=>{u({type:5,time:Date.now()})},D=ct=>{let{toasts:nt,pausedAt:ot}=I(ct);reactExports.useEffect(()=>{if(ot)return;let gt=Date.now(),pt=nt.map(mt=>{if(mt.duration===1/0)return;let vt=(mt.duration||0)+mt.pauseDuration-(gt-mt.createdAt);if(vt<0){mt.visible&&n.dismiss(mt.id);return}return setTimeout(()=>n.dismiss(mt.id),vt)});return()=>{pt.forEach(mt=>mt&&clearTimeout(mt))}},[nt,ot]);let rt=reactExports.useCallback(()=>{ot&&u({type:6,time:Date.now()})},[ot]),ut=reactExports.useCallback((gt,pt)=>{let{reverseOrder:mt=!1,gutter:vt=8,defaultPosition:St}=pt||{},yt=nt.filter(xt=>(xt.position||St)===(gt.position||St)&&xt.height),wt=yt.findIndex(xt=>xt.id===gt.id),Lt=yt.filter((xt,It)=>It<wt&&xt.visible).length;return yt.filter(xt=>xt.visible).slice(...mt?[Lt+1]:[0,Lt]).reduce((xt,It)=>xt+(It.height||0)+vt,0)},[nt]);return{toasts:nt,handlers:{updateHeight:Z$1,startPause:ee,endPause:rt,calculateOffset:ut}}},oe=h$3`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,re$1=h$3`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,se=h$3`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,_$1=j("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${ct=>ct.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${oe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${re$1} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${ct=>ct.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${se} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,ne=h$3`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,V=j("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${ct=>ct.secondary||"#e0e0e0"};
  border-right-color: ${ct=>ct.primary||"#616161"};
  animation: ${ne} 1s linear infinite;
`,pe=h$3`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,de=h$3`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,w=j("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${ct=>ct.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${pe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${de} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${ct=>ct.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,ue=j("div")`
  position: absolute;
`,le=j("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Te=h$3`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,fe=j("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Te} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,M=({toast:ct})=>{let{icon:nt,type:ot,iconTheme:rt}=ct;return nt!==void 0?typeof nt=="string"?reactExports.createElement(fe,null,nt):nt:ot==="blank"?null:reactExports.createElement(le,null,reactExports.createElement(V,{...rt}),ot!=="loading"&&reactExports.createElement(ue,null,ot==="error"?reactExports.createElement(_$1,{...rt}):reactExports.createElement(w,{...rt})))},ye=ct=>`
0% {transform: translate3d(0,${ct*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,ge=ct=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${ct*-150}%,-1px) scale(.6); opacity:0;}
`,he="0%{opacity:0;} 100%{opacity:1;}",xe="0%{opacity:1;} 100%{opacity:0;}",be=j("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Se=j("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Ae=(ct,nt)=>{let ot=ct.includes("top")?1:-1,[rt,ut]=b$1()?[he,xe]:[ye(ot),ge(ot)];return{animation:nt?`${h$3(rt)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${h$3(ut)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},F=reactExports.memo(({toast:ct,position:nt,style:ot,children:rt})=>{let ut=ct.height?Ae(ct.position||nt||"top-center",ct.visible):{opacity:0},gt=reactExports.createElement(M,{toast:ct}),pt=reactExports.createElement(Se,{...ct.ariaProps},T(ct.message,ct));return reactExports.createElement(be,{className:ct.className,style:{...ut,...ot,...ct.style}},typeof rt=="function"?rt({icon:gt,message:pt}):reactExports.createElement(reactExports.Fragment,null,gt,pt))});m(reactExports.createElement);var Ee=({id:ct,className:nt,style:ot,onHeightUpdate:rt,children:ut})=>{let gt=reactExports.useCallback(pt=>{if(pt){let mt=()=>{let vt=pt.getBoundingClientRect().height;rt(ct,vt)};mt(),new MutationObserver(mt).observe(pt,{subtree:!0,childList:!0,characterData:!0})}},[ct,rt]);return reactExports.createElement("div",{ref:gt,className:nt,style:ot},ut)},Re=(ct,nt)=>{let ot=ct.includes("top"),rt=ot?{top:0}:{bottom:0},ut=ct.includes("center")?{justifyContent:"center"}:ct.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:b$1()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${nt*(ot?1:-1)}px)`,...rt,...ut}},ve=u$1`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,O=16,Ie=({reverseOrder:ct,position:nt="top-center",toastOptions:ot,gutter:rt,children:ut,containerStyle:gt,containerClassName:pt})=>{let{toasts:mt,handlers:vt}=D(ot);return reactExports.createElement("div",{style:{position:"fixed",zIndex:9999,top:O,left:O,right:O,bottom:O,pointerEvents:"none",...gt},className:pt,onMouseEnter:vt.startPause,onMouseLeave:vt.endPause},mt.map(St=>{let yt=St.position||nt,wt=vt.calculateOffset(St,{reverseOrder:ct,gutter:rt,defaultPosition:nt}),Lt=Re(yt,wt);return reactExports.createElement(Ee,{id:St.id,key:St.id,onHeightUpdate:vt.updateHeight,className:St.visible?ve:"",style:Lt},St.type==="custom"?T(St.message,St):ut?ut(St):reactExports.createElement(F,{toast:St,position:yt}))}))},_t=n;let getRandomValues$1;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues$1&&(getRandomValues$1=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues$1))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues$1(rnds8)}const byteToHex=[];for(let ct=0;ct<256;++ct)byteToHex.push((ct+256).toString(16).slice(1));function unsafeStringify(ct,nt=0){return(byteToHex[ct[nt+0]]+byteToHex[ct[nt+1]]+byteToHex[ct[nt+2]]+byteToHex[ct[nt+3]]+"-"+byteToHex[ct[nt+4]]+byteToHex[ct[nt+5]]+"-"+byteToHex[ct[nt+6]]+byteToHex[ct[nt+7]]+"-"+byteToHex[ct[nt+8]]+byteToHex[ct[nt+9]]+"-"+byteToHex[ct[nt+10]]+byteToHex[ct[nt+11]]+byteToHex[ct[nt+12]]+byteToHex[ct[nt+13]]+byteToHex[ct[nt+14]]+byteToHex[ct[nt+15]]).toLowerCase()}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4(ct,nt,ot){if(native.randomUUID&&!nt&&!ct)return native.randomUUID();ct=ct||{};const rt=ct.random||(ct.rng||rng)();if(rt[6]=rt[6]&15|64,rt[8]=rt[8]&63|128,nt){ot=ot||0;for(let ut=0;ut<16;++ut)nt[ot+ut]=rt[ut];return nt}return unsafeStringify(rt)}const Home=()=>{const ct=useNavigate(),[nt,ot]=reactExports.useState(""),[rt,ut]=reactExports.useState(""),gt=vt=>{vt.preventDefault();const St=v4();ot(St),_t.success("Created your new room ")},pt=()=>{if(!nt||!rt){_t.error("ROOM ID & username is required");return}ct(`/editor/${nt}`,{state:{username:rt}})},mt=vt=>{vt.code==="Enter"&&pt()};return jsxRuntimeExports.jsxs("div",{className:"homePagewrapper",children:[jsxRuntimeExports.jsxs("div",{className:"formwrapper",children:[jsxRuntimeExports.jsxs("div",{className:"someStyle",children:[jsxRuntimeExports.jsx("img",{className:"homeLogo",src:"icons8-metamask-logo-50.png",alt:"logo-image"}),jsxRuntimeExports.jsx("h1",{className:"styling",children:"|"}),jsxRuntimeExports.jsx("h1",{className:"code",children:"Let's Code"}),jsxRuntimeExports.jsx("h4",{className:"mainLabel",children:"Paste invitation ROOM ID"})]}),jsxRuntimeExports.jsxs("div",{className:"form",children:[jsxRuntimeExports.jsx("input",{type:"text",className:"inputBox",placeholder:"ROOM ID",onChange:vt=>ot(vt.target.value),value:nt,onKeyUp:mt}),jsxRuntimeExports.jsx("input",{type:"text",className:"inputBox",placeholder:"USERNAME",onChange:vt=>ut(vt.target.value),value:rt,onKeyUp:mt}),jsxRuntimeExports.jsx("button",{className:"btn joinBtn",onClick:pt,children:"Join"}),jsxRuntimeExports.jsxs("span",{className:"information",children:["Create ROOM ID",jsxRuntimeExports.jsx("a",{onClick:gt,href:"",className:"createNewBtn",children:"new room"})]})]})]}),jsxRuntimeExports.jsx("footer",{children:jsxRuntimeExports.jsxs("h4",{children:["React project by  ",jsxRuntimeExports.jsx("a",{href:"",children:"Shaina"})]})})]})},ACTIONS={JOIN:"join",JOINED:"joined",DISCONNECTED:"disconnected",CODE_CHANGE:"code-change",SYNC_CODE:"sync-code",LEAVE:"leave"};function _extends(){return _extends=Object.assign?Object.assign.bind():function(ct){for(var nt=1;nt<arguments.length;nt++){var ot=arguments[nt];for(var rt in ot)Object.prototype.hasOwnProperty.call(ot,rt)&&(ct[rt]=ot[rt])}return ct},_extends.apply(this,arguments)}var check=function(ct){return ct&&ct.Math==Math&&ct},global$d=check(typeof globalThis=="object"&&globalThis)||check(typeof window=="object"&&window)||check(typeof self=="object"&&self)||check(typeof commonjsGlobal=="object"&&commonjsGlobal)||function(){return this}()||commonjsGlobal||Function("return this")(),fails$j=function(ct){try{return!!ct()}catch{return!0}},fails$i=fails$j,functionBindNative=!fails$i(function(){var ct=function(){}.bind();return typeof ct!="function"||ct.hasOwnProperty("prototype")}),NATIVE_BIND$4=functionBindNative,FunctionPrototype$1=Function.prototype,apply$5=FunctionPrototype$1.apply,call$9=FunctionPrototype$1.call,functionApply=typeof Reflect=="object"&&Reflect.apply||(NATIVE_BIND$4?call$9.bind(apply$5):function(){return call$9.apply(apply$5,arguments)}),NATIVE_BIND$3=functionBindNative,FunctionPrototype=Function.prototype,call$8=FunctionPrototype.call,uncurryThisWithBind=NATIVE_BIND$3&&FunctionPrototype.bind.bind(call$8,call$8),functionUncurryThis=NATIVE_BIND$3?uncurryThisWithBind:function(ct){return function(){return call$8.apply(ct,arguments)}},uncurryThis$k=functionUncurryThis,toString$8=uncurryThis$k({}.toString),stringSlice=uncurryThis$k("".slice),classofRaw$2=function(ct){return stringSlice(toString$8(ct),8,-1)},classofRaw$1=classofRaw$2,uncurryThis$j=functionUncurryThis,functionUncurryThisClause=function(ct){if(classofRaw$1(ct)==="Function")return uncurryThis$j(ct)},documentAll$2=typeof document=="object"&&document.all,IS_HTMLDDA=typeof documentAll$2>"u"&&documentAll$2!==void 0,documentAll_1={all:documentAll$2,IS_HTMLDDA},$documentAll$1=documentAll_1,documentAll$1=$documentAll$1.all,isCallable$d=$documentAll$1.IS_HTMLDDA?function(ct){return typeof ct=="function"||ct===documentAll$1}:function(ct){return typeof ct=="function"},objectGetOwnPropertyDescriptor={},fails$h=fails$j,descriptors=!fails$h(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),NATIVE_BIND$2=functionBindNative,call$7=Function.prototype.call,functionCall=NATIVE_BIND$2?call$7.bind(call$7):function(){return call$7.apply(call$7,arguments)},objectPropertyIsEnumerable={},$propertyIsEnumerable$1={}.propertyIsEnumerable,getOwnPropertyDescriptor$5=Object.getOwnPropertyDescriptor,NASHORN_BUG=getOwnPropertyDescriptor$5&&!$propertyIsEnumerable$1.call({1:2},1);objectPropertyIsEnumerable.f=NASHORN_BUG?function(nt){var ot=getOwnPropertyDescriptor$5(this,nt);return!!ot&&ot.enumerable}:$propertyIsEnumerable$1;var createPropertyDescriptor$4=function(ct,nt){return{enumerable:!(ct&1),configurable:!(ct&2),writable:!(ct&4),value:nt}},uncurryThis$i=functionUncurryThis,fails$g=fails$j,classof$8=classofRaw$2,$Object$3=Object,split=uncurryThis$i("".split),indexedObject=fails$g(function(){return!$Object$3("z").propertyIsEnumerable(0)})?function(ct){return classof$8(ct)=="String"?split(ct,""):$Object$3(ct)}:$Object$3,isNullOrUndefined$2=function(ct){return ct==null},isNullOrUndefined$1=isNullOrUndefined$2,$TypeError$8=TypeError,requireObjectCoercible$3=function(ct){if(isNullOrUndefined$1(ct))throw $TypeError$8("Can't call method on "+ct);return ct},IndexedObject$3=indexedObject,requireObjectCoercible$2=requireObjectCoercible$3,toIndexedObject$9=function(ct){return IndexedObject$3(requireObjectCoercible$2(ct))},isCallable$c=isCallable$d,$documentAll=documentAll_1,documentAll=$documentAll.all,isObject$e=$documentAll.IS_HTMLDDA?function(ct){return typeof ct=="object"?ct!==null:isCallable$c(ct)||ct===documentAll}:function(ct){return typeof ct=="object"?ct!==null:isCallable$c(ct)},path$e={},path$d=path$e,global$c=global$d,isCallable$b=isCallable$d,aFunction=function(ct){return isCallable$b(ct)?ct:void 0},getBuiltIn$8=function(ct,nt){return arguments.length<2?aFunction(path$d[ct])||aFunction(global$c[ct]):path$d[ct]&&path$d[ct][nt]||global$c[ct]&&global$c[ct][nt]},uncurryThis$h=functionUncurryThis,objectIsPrototypeOf=uncurryThis$h({}.isPrototypeOf),engineUserAgent=typeof navigator<"u"&&String(navigator.userAgent)||"",global$b=global$d,userAgent$2=engineUserAgent,process$1=global$b.process,Deno=global$b.Deno,versions=process$1&&process$1.versions||Deno&&Deno.version,v8=versions&&versions.v8,match$1,version;v8&&(match$1=v8.split("."),version=match$1[0]>0&&match$1[0]<4?1:+(match$1[0]+match$1[1]));!version&&userAgent$2&&(match$1=userAgent$2.match(/Edge\/(\d+)/),(!match$1||match$1[1]>=74)&&(match$1=userAgent$2.match(/Chrome\/(\d+)/),match$1&&(version=+match$1[1])));var engineV8Version=version,V8_VERSION$2=engineV8Version,fails$f=fails$j,global$a=global$d,$String$4=global$a.String,symbolConstructorDetection=!!Object.getOwnPropertySymbols&&!fails$f(function(){var ct=Symbol();return!$String$4(ct)||!(Object(ct)instanceof Symbol)||!Symbol.sham&&V8_VERSION$2&&V8_VERSION$2<41}),NATIVE_SYMBOL$5=symbolConstructorDetection,useSymbolAsUid=NATIVE_SYMBOL$5&&!Symbol.sham&&typeof Symbol.iterator=="symbol",getBuiltIn$7=getBuiltIn$8,isCallable$a=isCallable$d,isPrototypeOf$6=objectIsPrototypeOf,USE_SYMBOL_AS_UID$1=useSymbolAsUid,$Object$2=Object,isSymbol$4=USE_SYMBOL_AS_UID$1?function(ct){return typeof ct=="symbol"}:function(ct){var nt=getBuiltIn$7("Symbol");return isCallable$a(nt)&&isPrototypeOf$6(nt.prototype,$Object$2(ct))},$String$3=String,tryToString$3=function(ct){try{return $String$3(ct)}catch{return"Object"}},isCallable$9=isCallable$d,tryToString$2=tryToString$3,$TypeError$7=TypeError,aCallable$4=function(ct){if(isCallable$9(ct))return ct;throw $TypeError$7(tryToString$2(ct)+" is not a function")},aCallable$3=aCallable$4,isNullOrUndefined=isNullOrUndefined$2,getMethod$1=function(ct,nt){var ot=ct[nt];return isNullOrUndefined(ot)?void 0:aCallable$3(ot)},call$6=functionCall,isCallable$8=isCallable$d,isObject$d=isObject$e,$TypeError$6=TypeError,ordinaryToPrimitive$1=function(ct,nt){var ot,rt;if(nt==="string"&&isCallable$8(ot=ct.toString)&&!isObject$d(rt=call$6(ot,ct))||isCallable$8(ot=ct.valueOf)&&!isObject$d(rt=call$6(ot,ct))||nt!=="string"&&isCallable$8(ot=ct.toString)&&!isObject$d(rt=call$6(ot,ct)))return rt;throw $TypeError$6("Can't convert object to primitive value")},shared$6={exports:{}},global$9=global$d,defineProperty$8=Object.defineProperty,defineGlobalProperty$1=function(ct,nt){try{defineProperty$8(global$9,ct,{value:nt,configurable:!0,writable:!0})}catch{global$9[ct]=nt}return nt},global$8=global$d,defineGlobalProperty=defineGlobalProperty$1,SHARED="__core-js_shared__",store$3=global$8[SHARED]||defineGlobalProperty(SHARED,{}),sharedStore=store$3,store$2=sharedStore;(shared$6.exports=function(ct,nt){return store$2[ct]||(store$2[ct]=nt!==void 0?nt:{})})("versions",[]).push({version:"3.30.2",mode:"pure",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.2/LICENSE",source:"https://github.com/zloirock/core-js"});var sharedExports=shared$6.exports,requireObjectCoercible$1=requireObjectCoercible$3,$Object$1=Object,toObject$7=function(ct){return $Object$1(requireObjectCoercible$1(ct))},uncurryThis$g=functionUncurryThis,toObject$6=toObject$7,hasOwnProperty$4=uncurryThis$g({}.hasOwnProperty),hasOwnProperty_1=Object.hasOwn||function(nt,ot){return hasOwnProperty$4(toObject$6(nt),ot)},uncurryThis$f=functionUncurryThis,id$1=0,postfix=Math.random(),toString$7=uncurryThis$f(1 .toString),uid$3=function(ct){return"Symbol("+(ct===void 0?"":ct)+")_"+toString$7(++id$1+postfix,36)},global$7=global$d,shared$5=sharedExports,hasOwn$a=hasOwnProperty_1,uid$2=uid$3,NATIVE_SYMBOL$4=symbolConstructorDetection,USE_SYMBOL_AS_UID=useSymbolAsUid,Symbol$2=global$7.Symbol,WellKnownSymbolsStore$1=shared$5("wks"),createWellKnownSymbol=USE_SYMBOL_AS_UID?Symbol$2.for||Symbol$2:Symbol$2&&Symbol$2.withoutSetter||uid$2,wellKnownSymbol$b=function(ct){return hasOwn$a(WellKnownSymbolsStore$1,ct)||(WellKnownSymbolsStore$1[ct]=NATIVE_SYMBOL$4&&hasOwn$a(Symbol$2,ct)?Symbol$2[ct]:createWellKnownSymbol("Symbol."+ct)),WellKnownSymbolsStore$1[ct]},call$5=functionCall,isObject$c=isObject$e,isSymbol$3=isSymbol$4,getMethod=getMethod$1,ordinaryToPrimitive=ordinaryToPrimitive$1,wellKnownSymbol$a=wellKnownSymbol$b,$TypeError$5=TypeError,TO_PRIMITIVE=wellKnownSymbol$a("toPrimitive"),toPrimitive$1=function(ct,nt){if(!isObject$c(ct)||isSymbol$3(ct))return ct;var ot=getMethod(ct,TO_PRIMITIVE),rt;if(ot){if(nt===void 0&&(nt="default"),rt=call$5(ot,ct,nt),!isObject$c(rt)||isSymbol$3(rt))return rt;throw $TypeError$5("Can't convert object to primitive value")}return nt===void 0&&(nt="number"),ordinaryToPrimitive(ct,nt)},toPrimitive=toPrimitive$1,isSymbol$2=isSymbol$4,toPropertyKey$4=function(ct){var nt=toPrimitive(ct,"string");return isSymbol$2(nt)?nt:nt+""},global$6=global$d,isObject$b=isObject$e,document$1=global$6.document,EXISTS=isObject$b(document$1)&&isObject$b(document$1.createElement),documentCreateElement$1=function(ct){return EXISTS?document$1.createElement(ct):{}},DESCRIPTORS$b=descriptors,fails$e=fails$j,createElement$1=documentCreateElement$1,ie8DomDefine=!DESCRIPTORS$b&&!fails$e(function(){return Object.defineProperty(createElement$1("div"),"a",{get:function(){return 7}}).a!=7}),DESCRIPTORS$a=descriptors,call$4=functionCall,propertyIsEnumerableModule$2=objectPropertyIsEnumerable,createPropertyDescriptor$3=createPropertyDescriptor$4,toIndexedObject$8=toIndexedObject$9,toPropertyKey$3=toPropertyKey$4,hasOwn$9=hasOwnProperty_1,IE8_DOM_DEFINE$1=ie8DomDefine,$getOwnPropertyDescriptor$2=Object.getOwnPropertyDescriptor;objectGetOwnPropertyDescriptor.f=DESCRIPTORS$a?$getOwnPropertyDescriptor$2:function(nt,ot){if(nt=toIndexedObject$8(nt),ot=toPropertyKey$3(ot),IE8_DOM_DEFINE$1)try{return $getOwnPropertyDescriptor$2(nt,ot)}catch{}if(hasOwn$9(nt,ot))return createPropertyDescriptor$3(!call$4(propertyIsEnumerableModule$2.f,nt,ot),nt[ot])};var fails$d=fails$j,isCallable$7=isCallable$d,replacement=/#|\.prototype\./,isForced$1=function(ct,nt){var ot=data[normalize$1(ct)];return ot==POLYFILL?!0:ot==NATIVE?!1:isCallable$7(nt)?fails$d(nt):!!nt},normalize$1=isForced$1.normalize=function(ct){return String(ct).replace(replacement,".").toLowerCase()},data=isForced$1.data={},NATIVE=isForced$1.NATIVE="N",POLYFILL=isForced$1.POLYFILL="P",isForced_1=isForced$1,uncurryThis$e=functionUncurryThisClause,aCallable$2=aCallable$4,NATIVE_BIND$1=functionBindNative,bind$3=uncurryThis$e(uncurryThis$e.bind),functionBindContext=function(ct,nt){return aCallable$2(ct),nt===void 0?ct:NATIVE_BIND$1?bind$3(ct,nt):function(){return ct.apply(nt,arguments)}},objectDefineProperty={},DESCRIPTORS$9=descriptors,fails$c=fails$j,v8PrototypeDefineBug=DESCRIPTORS$9&&fails$c(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),isObject$a=isObject$e,$String$2=String,$TypeError$4=TypeError,anObject$6=function(ct){if(isObject$a(ct))return ct;throw $TypeError$4($String$2(ct)+" is not an object")},DESCRIPTORS$8=descriptors,IE8_DOM_DEFINE=ie8DomDefine,V8_PROTOTYPE_DEFINE_BUG$1=v8PrototypeDefineBug,anObject$5=anObject$6,toPropertyKey$2=toPropertyKey$4,$TypeError$3=TypeError,$defineProperty$1=Object.defineProperty,$getOwnPropertyDescriptor$1=Object.getOwnPropertyDescriptor,ENUMERABLE="enumerable",CONFIGURABLE="configurable",WRITABLE="writable";objectDefineProperty.f=DESCRIPTORS$8?V8_PROTOTYPE_DEFINE_BUG$1?function(nt,ot,rt){if(anObject$5(nt),ot=toPropertyKey$2(ot),anObject$5(rt),typeof nt=="function"&&ot==="prototype"&&"value"in rt&&WRITABLE in rt&&!rt[WRITABLE]){var ut=$getOwnPropertyDescriptor$1(nt,ot);ut&&ut[WRITABLE]&&(nt[ot]=rt.value,rt={configurable:CONFIGURABLE in rt?rt[CONFIGURABLE]:ut[CONFIGURABLE],enumerable:ENUMERABLE in rt?rt[ENUMERABLE]:ut[ENUMERABLE],writable:!1})}return $defineProperty$1(nt,ot,rt)}:$defineProperty$1:function(nt,ot,rt){if(anObject$5(nt),ot=toPropertyKey$2(ot),anObject$5(rt),IE8_DOM_DEFINE)try{return $defineProperty$1(nt,ot,rt)}catch{}if("get"in rt||"set"in rt)throw $TypeError$3("Accessors not supported");return"value"in rt&&(nt[ot]=rt.value),nt};var DESCRIPTORS$7=descriptors,definePropertyModule$3=objectDefineProperty,createPropertyDescriptor$2=createPropertyDescriptor$4,createNonEnumerableProperty$4=DESCRIPTORS$7?function(ct,nt,ot){return definePropertyModule$3.f(ct,nt,createPropertyDescriptor$2(1,ot))}:function(ct,nt,ot){return ct[nt]=ot,ct},global$5=global$d,apply$4=functionApply,uncurryThis$d=functionUncurryThisClause,isCallable$6=isCallable$d,getOwnPropertyDescriptor$4=objectGetOwnPropertyDescriptor.f,isForced=isForced_1,path$c=path$e,bind$2=functionBindContext,createNonEnumerableProperty$3=createNonEnumerableProperty$4,hasOwn$8=hasOwnProperty_1,wrapConstructor=function(ct){var nt=function(ot,rt,ut){if(this instanceof nt){switch(arguments.length){case 0:return new ct;case 1:return new ct(ot);case 2:return new ct(ot,rt)}return new ct(ot,rt,ut)}return apply$4(ct,this,arguments)};return nt.prototype=ct.prototype,nt},_export=function(ct,nt){var ot=ct.target,rt=ct.global,ut=ct.stat,gt=ct.proto,pt=rt?global$5:ut?global$5[ot]:(global$5[ot]||{}).prototype,mt=rt?path$c:path$c[ot]||createNonEnumerableProperty$3(path$c,ot,{})[ot],vt=mt.prototype,St,yt,wt,Lt,xt,It,kt,At,Tt;for(Lt in nt)St=isForced(rt?Lt:ot+(ut?".":"#")+Lt,ct.forced),yt=!St&&pt&&hasOwn$8(pt,Lt),It=mt[Lt],yt&&(ct.dontCallGetSet?(Tt=getOwnPropertyDescriptor$4(pt,Lt),kt=Tt&&Tt.value):kt=pt[Lt]),xt=yt&&kt?kt:nt[Lt],!(yt&&typeof It==typeof xt)&&(ct.bind&&yt?At=bind$2(xt,global$5):ct.wrap&&yt?At=wrapConstructor(xt):gt&&isCallable$6(xt)?At=uncurryThis$d(xt):At=xt,(ct.sham||xt&&xt.sham||It&&It.sham)&&createNonEnumerableProperty$3(At,"sham",!0),createNonEnumerableProperty$3(mt,Lt,At),gt&&(wt=ot+"Prototype",hasOwn$8(path$c,wt)||createNonEnumerableProperty$3(path$c,wt,{}),createNonEnumerableProperty$3(path$c[wt],Lt,xt),ct.real&&vt&&(St||!vt[Lt])&&createNonEnumerableProperty$3(vt,Lt,xt)))},ceil=Math.ceil,floor$1=Math.floor,mathTrunc=Math.trunc||function(nt){var ot=+nt;return(ot>0?floor$1:ceil)(ot)},trunc=mathTrunc,toIntegerOrInfinity$2=function(ct){var nt=+ct;return nt!==nt||nt===0?0:trunc(nt)},toIntegerOrInfinity$1=toIntegerOrInfinity$2,max$3=Math.max,min$2=Math.min,toAbsoluteIndex$3=function(ct,nt){var ot=toIntegerOrInfinity$1(ct);return ot<0?max$3(ot+nt,0):min$2(ot,nt)},toIntegerOrInfinity=toIntegerOrInfinity$2,min$1=Math.min,toLength$2=function(ct){return ct>0?min$1(toIntegerOrInfinity(ct),9007199254740991):0},toLength$1=toLength$2,lengthOfArrayLike$6=function(ct){return toLength$1(ct.length)},toIndexedObject$7=toIndexedObject$9,toAbsoluteIndex$2=toAbsoluteIndex$3,lengthOfArrayLike$5=lengthOfArrayLike$6,createMethod$3=function(ct){return function(nt,ot,rt){var ut=toIndexedObject$7(nt),gt=lengthOfArrayLike$5(ut),pt=toAbsoluteIndex$2(rt,gt),mt;if(ct&&ot!=ot){for(;gt>pt;)if(mt=ut[pt++],mt!=mt)return!0}else for(;gt>pt;pt++)if((ct||pt in ut)&&ut[pt]===ot)return ct||pt||0;return!ct&&-1}},arrayIncludes={includes:createMethod$3(!0),indexOf:createMethod$3(!1)},hiddenKeys$5={},uncurryThis$c=functionUncurryThis,hasOwn$7=hasOwnProperty_1,toIndexedObject$6=toIndexedObject$9,indexOf=arrayIncludes.indexOf,hiddenKeys$4=hiddenKeys$5,push$4=uncurryThis$c([].push),objectKeysInternal=function(ct,nt){var ot=toIndexedObject$6(ct),rt=0,ut=[],gt;for(gt in ot)!hasOwn$7(hiddenKeys$4,gt)&&hasOwn$7(ot,gt)&&push$4(ut,gt);for(;nt.length>rt;)hasOwn$7(ot,gt=nt[rt++])&&(~indexOf(ut,gt)||push$4(ut,gt));return ut},enumBugKeys$3=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],internalObjectKeys$1=objectKeysInternal,enumBugKeys$2=enumBugKeys$3,objectKeys$3=Object.keys||function(nt){return internalObjectKeys$1(nt,enumBugKeys$2)},objectGetOwnPropertySymbols={};objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols;var DESCRIPTORS$6=descriptors,uncurryThis$b=functionUncurryThis,call$3=functionCall,fails$b=fails$j,objectKeys$2=objectKeys$3,getOwnPropertySymbolsModule$3=objectGetOwnPropertySymbols,propertyIsEnumerableModule$1=objectPropertyIsEnumerable,toObject$5=toObject$7,IndexedObject$2=indexedObject,$assign=Object.assign,defineProperty$7=Object.defineProperty,concat$7=uncurryThis$b([].concat),objectAssign=!$assign||fails$b(function(){if(DESCRIPTORS$6&&$assign({b:1},$assign(defineProperty$7({},"a",{enumerable:!0,get:function(){defineProperty$7(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var ct={},nt={},ot=Symbol(),rt="abcdefghijklmnopqrst";return ct[ot]=7,rt.split("").forEach(function(ut){nt[ut]=ut}),$assign({},ct)[ot]!=7||objectKeys$2($assign({},nt)).join("")!=rt})?function(nt,ot){for(var rt=toObject$5(nt),ut=arguments.length,gt=1,pt=getOwnPropertySymbolsModule$3.f,mt=propertyIsEnumerableModule$1.f;ut>gt;)for(var vt=IndexedObject$2(arguments[gt++]),St=pt?concat$7(objectKeys$2(vt),pt(vt)):objectKeys$2(vt),yt=St.length,wt=0,Lt;yt>wt;)Lt=St[wt++],(!DESCRIPTORS$6||call$3(mt,vt,Lt))&&(rt[Lt]=vt[Lt]);return rt}:$assign,$$w=_export,assign$3=objectAssign;$$w({target:"Object",stat:!0,arity:2,forced:Object.assign!==assign$3},{assign:assign$3});var path$b=path$e,assign$2=path$b.Object.assign,parent$e=assign$2,assign$1=parent$e;const _Object$assign=getDefaultExportFromCjs(assign$1);function _classCallCheck(ct,nt){if(!(ct instanceof nt))throw new TypeError("Cannot call a class as a function")}function _typeof$1(ct){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(nt){return typeof nt}:function(nt){return nt&&typeof Symbol=="function"&&nt.constructor===Symbol&&nt!==Symbol.prototype?"symbol":typeof nt},_typeof$1(ct)}function _toPrimitive(ct,nt){if(_typeof$1(ct)!=="object"||ct===null)return ct;var ot=ct[Symbol.toPrimitive];if(ot!==void 0){var rt=ot.call(ct,nt||"default");if(_typeof$1(rt)!=="object")return rt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(nt==="string"?String:Number)(ct)}function _toPropertyKey(ct){var nt=_toPrimitive(ct,"string");return _typeof$1(nt)==="symbol"?nt:String(nt)}function _defineProperties(ct,nt){for(var ot=0;ot<nt.length;ot++){var rt=nt[ot];rt.enumerable=rt.enumerable||!1,rt.configurable=!0,"value"in rt&&(rt.writable=!0),Object.defineProperty(ct,_toPropertyKey(rt.key),rt)}}function _createClass(ct,nt,ot){return nt&&_defineProperties(ct.prototype,nt),ot&&_defineProperties(ct,ot),Object.defineProperty(ct,"prototype",{writable:!1}),ct}var uncurryThis$a=functionUncurryThis,arraySlice$3=uncurryThis$a([].slice),classof$7=classofRaw$2,isArray$5=Array.isArray||function(nt){return classof$7(nt)=="Array"},wellKnownSymbol$9=wellKnownSymbol$b,TO_STRING_TAG$2=wellKnownSymbol$9("toStringTag"),test={};test[TO_STRING_TAG$2]="z";var toStringTagSupport=String(test)==="[object z]",TO_STRING_TAG_SUPPORT$2=toStringTagSupport,isCallable$5=isCallable$d,classofRaw=classofRaw$2,wellKnownSymbol$8=wellKnownSymbol$b,TO_STRING_TAG$1=wellKnownSymbol$8("toStringTag"),$Object=Object,CORRECT_ARGUMENTS=classofRaw(function(){return arguments}())=="Arguments",tryGet=function(ct,nt){try{return ct[nt]}catch{}},classof$6=TO_STRING_TAG_SUPPORT$2?classofRaw:function(ct){var nt,ot,rt;return ct===void 0?"Undefined":ct===null?"Null":typeof(ot=tryGet(nt=$Object(ct),TO_STRING_TAG$1))=="string"?ot:CORRECT_ARGUMENTS?classofRaw(nt):(rt=classofRaw(nt))=="Object"&&isCallable$5(nt.callee)?"Arguments":rt},classof$5=classof$6,$String$1=String,toString$6=function(ct){if(classof$5(ct)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return $String$1(ct)},uncurryThis$9=functionUncurryThis,isArray$4=isArray$5,isCallable$4=isCallable$d,classof$4=classofRaw$2,toString$5=toString$6,push$3=uncurryThis$9([].push),getJsonReplacerFunction=function(ct){if(isCallable$4(ct))return ct;if(isArray$4(ct)){for(var nt=ct.length,ot=[],rt=0;rt<nt;rt++){var ut=ct[rt];typeof ut=="string"?push$3(ot,ut):(typeof ut=="number"||classof$4(ut)=="Number"||classof$4(ut)=="String")&&push$3(ot,toString$5(ut))}var gt=ot.length,pt=!0;return function(mt,vt){if(pt)return pt=!1,vt;if(isArray$4(this))return vt;for(var St=0;St<gt;St++)if(ot[St]===mt)return vt}}},$$v=_export,getBuiltIn$6=getBuiltIn$8,apply$3=functionApply,call$2=functionCall,uncurryThis$8=functionUncurryThis,fails$a=fails$j,isCallable$3=isCallable$d,isSymbol$1=isSymbol$4,arraySlice$2=arraySlice$3,getReplacerFunction=getJsonReplacerFunction,NATIVE_SYMBOL$3=symbolConstructorDetection,$String=String,$stringify=getBuiltIn$6("JSON","stringify"),exec$1=uncurryThis$8(/./.exec),charAt$1=uncurryThis$8("".charAt),charCodeAt=uncurryThis$8("".charCodeAt),replace$1=uncurryThis$8("".replace),numberToString=uncurryThis$8(1 .toString),tester=/[\uD800-\uDFFF]/g,low=/^[\uD800-\uDBFF]$/,hi=/^[\uDC00-\uDFFF]$/,WRONG_SYMBOLS_CONVERSION=!NATIVE_SYMBOL$3||fails$a(function(){var ct=getBuiltIn$6("Symbol")();return $stringify([ct])!="[null]"||$stringify({a:ct})!="{}"||$stringify(Object(ct))!="{}"}),ILL_FORMED_UNICODE=fails$a(function(){return $stringify("\uDF06\uD834")!=='"\\udf06\\ud834"'||$stringify("\uDEAD")!=='"\\udead"'}),stringifyWithSymbolsFix=function(ct,nt){var ot=arraySlice$2(arguments),rt=getReplacerFunction(nt);if(!(!isCallable$3(rt)&&(ct===void 0||isSymbol$1(ct))))return ot[1]=function(ut,gt){if(isCallable$3(rt)&&(gt=call$2(rt,this,$String(ut),gt)),!isSymbol$1(gt))return gt},apply$3($stringify,null,ot)},fixIllFormed=function(ct,nt,ot){var rt=charAt$1(ot,nt-1),ut=charAt$1(ot,nt+1);return exec$1(low,ct)&&!exec$1(hi,ut)||exec$1(hi,ct)&&!exec$1(low,rt)?"\\u"+numberToString(charCodeAt(ct,0),16):ct};$stringify&&$$v({target:"JSON",stat:!0,arity:3,forced:WRONG_SYMBOLS_CONVERSION||ILL_FORMED_UNICODE},{stringify:function(nt,ot,rt){var ut=arraySlice$2(arguments),gt=apply$3(WRONG_SYMBOLS_CONVERSION?stringifyWithSymbolsFix:$stringify,null,ut);return ILL_FORMED_UNICODE&&typeof gt=="string"?replace$1(gt,tester,fixIllFormed):gt}});var path$a=path$e,apply$2=functionApply;path$a.JSON||(path$a.JSON={stringify:JSON.stringify});var stringify$1=function(nt,ot,rt){return apply$2(path$a.JSON.stringify,null,arguments)},parent$d=stringify$1,stringify=parent$d;const _JSON$stringify=getDefaultExportFromCjs(stringify);var uncurryThis$7=functionUncurryThis,isCallable$2=isCallable$d,store$1=sharedStore,functionToString=uncurryThis$7(Function.toString);isCallable$2(store$1.inspectSource)||(store$1.inspectSource=function(ct){return functionToString(ct)});var inspectSource$1=store$1.inspectSource,uncurryThis$6=functionUncurryThis,fails$9=fails$j,isCallable$1=isCallable$d,classof$3=classof$6,getBuiltIn$5=getBuiltIn$8,inspectSource=inspectSource$1,noop=function(){},empty$2=[],construct$4=getBuiltIn$5("Reflect","construct"),constructorRegExp=/^\s*(?:class|function)\b/,exec=uncurryThis$6(constructorRegExp.exec),INCORRECT_TO_STRING=!constructorRegExp.exec(noop),isConstructorModern=function(nt){if(!isCallable$1(nt))return!1;try{return construct$4(noop,empty$2,nt),!0}catch{return!1}},isConstructorLegacy=function(nt){if(!isCallable$1(nt))return!1;switch(classof$3(nt)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return INCORRECT_TO_STRING||!!exec(constructorRegExp,inspectSource(nt))}catch{return!0}};isConstructorLegacy.sham=!0;var isConstructor$3=!construct$4||fails$9(function(){var ct;return isConstructorModern(isConstructorModern.call)||!isConstructorModern(Object)||!isConstructorModern(function(){ct=!0})||ct})?isConstructorLegacy:isConstructorModern,isArray$3=isArray$5,isConstructor$2=isConstructor$3,isObject$9=isObject$e,wellKnownSymbol$7=wellKnownSymbol$b,SPECIES$2=wellKnownSymbol$7("species"),$Array$2=Array,arraySpeciesConstructor$1=function(ct){var nt;return isArray$3(ct)&&(nt=ct.constructor,isConstructor$2(nt)&&(nt===$Array$2||isArray$3(nt.prototype))?nt=void 0:isObject$9(nt)&&(nt=nt[SPECIES$2],nt===null&&(nt=void 0))),nt===void 0?$Array$2:nt},arraySpeciesConstructor=arraySpeciesConstructor$1,arraySpeciesCreate$2=function(ct,nt){return new(arraySpeciesConstructor(ct))(nt===0?0:nt)},bind$1=functionBindContext,uncurryThis$5=functionUncurryThis,IndexedObject$1=indexedObject,toObject$4=toObject$7,lengthOfArrayLike$4=lengthOfArrayLike$6,arraySpeciesCreate$1=arraySpeciesCreate$2,push$2=uncurryThis$5([].push),createMethod$2=function(ct){var nt=ct==1,ot=ct==2,rt=ct==3,ut=ct==4,gt=ct==6,pt=ct==7,mt=ct==5||gt;return function(vt,St,yt,wt){for(var Lt=toObject$4(vt),xt=IndexedObject$1(Lt),It=bind$1(St,yt),kt=lengthOfArrayLike$4(xt),At=0,Tt=wt||arraySpeciesCreate$1,Rt=nt?Tt(vt,kt):ot||pt?Tt(vt,0):void 0,Nt,Pt;kt>At;At++)if((mt||At in xt)&&(Nt=xt[At],Pt=It(Nt,At,Lt),ct))if(nt)Rt[At]=Pt;else if(Pt)switch(ct){case 3:return!0;case 5:return Nt;case 6:return At;case 2:push$2(Rt,Nt)}else switch(ct){case 4:return!1;case 7:push$2(Rt,Nt)}return gt?-1:rt||ut?ut:Rt}},arrayIteration={forEach:createMethod$2(0),map:createMethod$2(1),filter:createMethod$2(2),some:createMethod$2(3),every:createMethod$2(4),find:createMethod$2(5),findIndex:createMethod$2(6),filterReject:createMethod$2(7)},fails$8=fails$j,wellKnownSymbol$6=wellKnownSymbol$b,V8_VERSION$1=engineV8Version,SPECIES$1=wellKnownSymbol$6("species"),arrayMethodHasSpeciesSupport$4=function(ct){return V8_VERSION$1>=51||!fails$8(function(){var nt=[],ot=nt.constructor={};return ot[SPECIES$1]=function(){return{foo:1}},nt[ct](Boolean).foo!==1})},$$u=_export,$filter=arrayIteration.filter,arrayMethodHasSpeciesSupport$3=arrayMethodHasSpeciesSupport$4,HAS_SPECIES_SUPPORT$2=arrayMethodHasSpeciesSupport$3("filter");$$u({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$2},{filter:function(nt){return $filter(this,nt,arguments.length>1?arguments[1]:void 0)}});var path$9=path$e,entryVirtual$5=function(ct){return path$9[ct+"Prototype"]},entryVirtual$4=entryVirtual$5,filter$2=entryVirtual$4("Array").filter,isPrototypeOf$5=objectIsPrototypeOf,method$4=filter$2,ArrayPrototype$4=Array.prototype,filter$1=function(ct){var nt=ct.filter;return ct===ArrayPrototype$4||isPrototypeOf$5(ArrayPrototype$4,ct)&&nt===ArrayPrototype$4.filter?method$4:nt},parent$c=filter$1,filter=parent$c;const _filterInstanceProperty=getDefaultExportFromCjs(filter);var toPropertyKey$1=toPropertyKey$4,definePropertyModule$2=objectDefineProperty,createPropertyDescriptor$1=createPropertyDescriptor$4,createProperty$4=function(ct,nt,ot){var rt=toPropertyKey$1(nt);rt in ct?definePropertyModule$2.f(ct,rt,createPropertyDescriptor$1(0,ot)):ct[rt]=ot},$$t=_export,isArray$2=isArray$5,isConstructor$1=isConstructor$3,isObject$8=isObject$e,toAbsoluteIndex$1=toAbsoluteIndex$3,lengthOfArrayLike$3=lengthOfArrayLike$6,toIndexedObject$5=toIndexedObject$9,createProperty$3=createProperty$4,wellKnownSymbol$5=wellKnownSymbol$b,arrayMethodHasSpeciesSupport$2=arrayMethodHasSpeciesSupport$4,nativeSlice=arraySlice$3,HAS_SPECIES_SUPPORT$1=arrayMethodHasSpeciesSupport$2("slice"),SPECIES=wellKnownSymbol$5("species"),$Array$1=Array,max$2=Math.max;$$t({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$1},{slice:function(nt,ot){var rt=toIndexedObject$5(this),ut=lengthOfArrayLike$3(rt),gt=toAbsoluteIndex$1(nt,ut),pt=toAbsoluteIndex$1(ot===void 0?ut:ot,ut),mt,vt,St;if(isArray$2(rt)&&(mt=rt.constructor,isConstructor$1(mt)&&(mt===$Array$1||isArray$2(mt.prototype))?mt=void 0:isObject$8(mt)&&(mt=mt[SPECIES],mt===null&&(mt=void 0)),mt===$Array$1||mt===void 0))return nativeSlice(rt,gt,pt);for(vt=new(mt===void 0?$Array$1:mt)(max$2(pt-gt,0)),St=0;gt<pt;gt++,St++)gt in rt&&createProperty$3(vt,St,rt[gt]);return vt.length=St,vt}});var entryVirtual$3=entryVirtual$5,slice$2=entryVirtual$3("Array").slice,isPrototypeOf$4=objectIsPrototypeOf,method$3=slice$2,ArrayPrototype$3=Array.prototype,slice$1=function(ct){var nt=ct.slice;return ct===ArrayPrototype$3||isPrototypeOf$4(ArrayPrototype$3,ct)&&nt===ArrayPrototype$3.slice?method$3:nt},parent$b=slice$1,slice=parent$b;const _sliceInstanceProperty=getDefaultExportFromCjs(slice);var CACHE_PREFIX="react-avatar/",CACHE_KEY_FAILING="failing",_hasLocalStorage=function(){try{return"localStorage"in window&&window.localStorage}catch{return!1}}(),Cache=function(){function ct(){var nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_classCallCheck(this,ct);var ot=nt.cachePrefix,rt=ot===void 0?CACHE_PREFIX:ot,ut=nt.sourceTTL,gt=ut===void 0?7*24*3600*1e3:ut,pt=nt.sourceSize,mt=pt===void 0?20:pt;this.cachePrefix=rt,this.sourceTTL=gt,this.sourceSize=mt}return _createClass(ct,[{key:"set",value:function(ot,rt){if(_hasLocalStorage){rt=_JSON$stringify(rt);try{localStorage.setItem(this.cachePrefix+ot,rt)}catch(ut){console.error(ut)}}}},{key:"get",value:function(ot){if(!_hasLocalStorage)return null;var rt=localStorage.getItem(this.cachePrefix+ot);return rt?JSON.parse(rt):null}},{key:"sourceFailed",value:function(ot){var rt=this.get(CACHE_KEY_FAILING)||[];return rt=_filterInstanceProperty(rt).call(rt,function(ut){var gt=ut.expires>0&&ut.expires<Date.now(),pt=ut===ot||ut.url==ot;return!gt&&!pt}),rt.unshift({url:ot,expires:Date.now()+this.sourceTTL}),rt=_sliceInstanceProperty(rt).call(rt,0,this.sourceSize-1),this.set(CACHE_KEY_FAILING,rt)}},{key:"hasSourceFailedBefore",value:function(ot){var rt=this.get(CACHE_KEY_FAILING)||[];return rt.some(function(ut){var gt=ut.expires>0&&ut.expires<Date.now(),pt=ut===ot||ut.url==ot;return pt&&!gt})}}]),ct}();const defaultCache=new Cache;var uncurryThis$4=functionUncurryThis,aCallable$1=aCallable$4,isObject$7=isObject$e,hasOwn$6=hasOwnProperty_1,arraySlice$1=arraySlice$3,NATIVE_BIND=functionBindNative,$Function=Function,concat$6=uncurryThis$4([].concat),join$1=uncurryThis$4([].join),factories={},construct$3=function(ct,nt,ot){if(!hasOwn$6(factories,nt)){for(var rt=[],ut=0;ut<nt;ut++)rt[ut]="a["+ut+"]";factories[nt]=$Function("C,a","return new C("+join$1(rt,",")+")")}return factories[nt](ct,ot)},functionBind=NATIVE_BIND?$Function.bind:function(nt){var ot=aCallable$1(this),rt=ot.prototype,ut=arraySlice$1(arguments,1),gt=function(){var mt=concat$6(ut,arraySlice$1(arguments));return this instanceof gt?construct$3(ot,mt.length,mt):ot.apply(nt,mt)};return isObject$7(rt)&&(gt.prototype=rt),gt},isConstructor=isConstructor$3,tryToString$1=tryToString$3,$TypeError$2=TypeError,aConstructor$1=function(ct){if(isConstructor(ct))return ct;throw $TypeError$2(tryToString$1(ct)+" is not a constructor")},objectDefineProperties={},DESCRIPTORS$5=descriptors,V8_PROTOTYPE_DEFINE_BUG=v8PrototypeDefineBug,definePropertyModule$1=objectDefineProperty,anObject$4=anObject$6,toIndexedObject$4=toIndexedObject$9,objectKeys$1=objectKeys$3;objectDefineProperties.f=DESCRIPTORS$5&&!V8_PROTOTYPE_DEFINE_BUG?Object.defineProperties:function(nt,ot){anObject$4(nt);for(var rt=toIndexedObject$4(ot),ut=objectKeys$1(ot),gt=ut.length,pt=0,mt;gt>pt;)definePropertyModule$1.f(nt,mt=ut[pt++],rt[mt]);return nt};var getBuiltIn$4=getBuiltIn$8,html$3=getBuiltIn$4("document","documentElement"),shared$4=sharedExports,uid$1=uid$3,keys$3=shared$4("keys"),sharedKey$3=function(ct){return keys$3[ct]||(keys$3[ct]=uid$1(ct))},anObject$3=anObject$6,definePropertiesModule$1=objectDefineProperties,enumBugKeys$1=enumBugKeys$3,hiddenKeys$3=hiddenKeys$5,html$2=html$3,documentCreateElement=documentCreateElement$1,sharedKey$2=sharedKey$3,GT=">",LT="<",PROTOTYPE$1="prototype",SCRIPT="script",IE_PROTO=sharedKey$2("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(ct){return LT+SCRIPT+GT+ct+LT+"/"+SCRIPT+GT},NullProtoObjectViaActiveX=function(ct){ct.write(scriptTag("")),ct.close();var nt=ct.parentWindow.Object;return ct=null,nt},NullProtoObjectViaIFrame=function(){var ct=documentCreateElement("iframe"),nt="java"+SCRIPT+":",ot;return ct.style.display="none",html$2.appendChild(ct),ct.src=String(nt),ot=ct.contentWindow.document,ot.open(),ot.write(scriptTag("document.F=Object")),ot.close(),ot.F},activeXDocument,NullProtoObject=function(){try{activeXDocument=new ActiveXObject("htmlfile")}catch{}NullProtoObject=typeof document<"u"?document.domain&&activeXDocument?NullProtoObjectViaActiveX(activeXDocument):NullProtoObjectViaIFrame():NullProtoObjectViaActiveX(activeXDocument);for(var ct=enumBugKeys$1.length;ct--;)delete NullProtoObject[PROTOTYPE$1][enumBugKeys$1[ct]];return NullProtoObject()};hiddenKeys$3[IE_PROTO]=!0;var objectCreate=Object.create||function(nt,ot){var rt;return nt!==null?(EmptyConstructor[PROTOTYPE$1]=anObject$3(nt),rt=new EmptyConstructor,EmptyConstructor[PROTOTYPE$1]=null,rt[IE_PROTO]=nt):rt=NullProtoObject(),ot===void 0?rt:definePropertiesModule$1.f(rt,ot)},$$s=_export,getBuiltIn$3=getBuiltIn$8,apply$1=functionApply,bind=functionBind,aConstructor=aConstructor$1,anObject$2=anObject$6,isObject$6=isObject$e,create$9=objectCreate,fails$7=fails$j,nativeConstruct=getBuiltIn$3("Reflect","construct"),ObjectPrototype$1=Object.prototype,push$1=[].push,NEW_TARGET_BUG=fails$7(function(){function ct(){}return!(nativeConstruct(function(){},[],ct)instanceof ct)}),ARGS_BUG=!fails$7(function(){nativeConstruct(function(){})}),FORCED$5=NEW_TARGET_BUG||ARGS_BUG;$$s({target:"Reflect",stat:!0,forced:FORCED$5,sham:FORCED$5},{construct:function(nt,ot){aConstructor(nt),anObject$2(ot);var rt=arguments.length<3?nt:aConstructor(arguments[2]);if(ARGS_BUG&&!NEW_TARGET_BUG)return nativeConstruct(nt,ot,rt);if(nt==rt){switch(ot.length){case 0:return new nt;case 1:return new nt(ot[0]);case 2:return new nt(ot[0],ot[1]);case 3:return new nt(ot[0],ot[1],ot[2]);case 4:return new nt(ot[0],ot[1],ot[2],ot[3])}var ut=[null];return apply$1(push$1,ut,ot),new(apply$1(bind,nt,ut))}var gt=rt.prototype,pt=create$9(isObject$6(gt)?gt:ObjectPrototype$1),mt=apply$1(nt,pt,ot);return isObject$6(mt)?mt:pt}});var path$8=path$e,construct$2=path$8.Reflect.construct,parent$a=construct$2,construct$1=parent$a;const _Reflect$construct=getDefaultExportFromCjs(construct$1);function _setPrototypeOf(ct,nt){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(rt,ut){return rt.__proto__=ut,rt},_setPrototypeOf(ct,nt)}function _inherits(ct,nt){if(typeof nt!="function"&&nt!==null)throw new TypeError("Super expression must either be null or a function");ct.prototype=Object.create(nt&&nt.prototype,{constructor:{value:ct,writable:!0,configurable:!0}}),Object.defineProperty(ct,"prototype",{writable:!1}),nt&&_setPrototypeOf(ct,nt)}function _assertThisInitialized(ct){if(ct===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ct}function _possibleConstructorReturn(ct,nt){if(nt&&(_typeof$1(nt)==="object"||typeof nt=="function"))return nt;if(nt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(ct)}function _getPrototypeOf(ct){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ot){return ot.__proto__||Object.getPrototypeOf(ot)},_getPrototypeOf(ct)}function _defineProperty$2(ct,nt,ot){return nt=_toPropertyKey(nt),nt in ct?Object.defineProperty(ct,nt,{value:ot,enumerable:!0,configurable:!0,writable:!0}):ct[nt]=ot,ct}var $$r=_export,toObject$3=toObject$7,nativeKeys=objectKeys$3,fails$6=fails$j,FAILS_ON_PRIMITIVES=fails$6(function(){nativeKeys(1)});$$r({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES},{keys:function(nt){return nativeKeys(toObject$3(nt))}});var path$7=path$e,keys$2=path$7.Object.keys,parent$9=keys$2,keys$1=parent$9;const _Object$keys=getDefaultExportFromCjs(keys$1);var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function ct(rt,ut,gt,pt,mt,vt){if(vt!==ReactPropTypesSecret){var St=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw St.name="Invariant Violation",St}}ct.isRequired=ct;function nt(){return ct}var ot={array:ct,bigint:ct,bool:ct,func:ct,number:ct,object:ct,string:ct,symbol:ct,any:ct,arrayOf:nt,element:ct,elementType:ct,instanceOf:nt,node:ct,objectOf:nt,oneOf:nt,oneOfType:nt,shape:nt,exact:nt,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return ot.PropTypes=ot,ot};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs(propTypesExports);function _arrayWithHoles$1(ct){if(Array.isArray(ct))return ct}function _iterableToArrayLimit$1(ct,nt){var ot=ct==null?null:typeof Symbol<"u"&&ct[Symbol.iterator]||ct["@@iterator"];if(ot!=null){var rt,ut,gt,pt,mt=[],vt=!0,St=!1;try{if(gt=(ot=ot.call(ct)).next,nt===0){if(Object(ot)!==ot)return;vt=!1}else for(;!(vt=(rt=gt.call(ot)).done)&&(mt.push(rt.value),mt.length!==nt);vt=!0);}catch(yt){St=!0,ut=yt}finally{try{if(!vt&&ot.return!=null&&(pt=ot.return(),Object(pt)!==pt))return}finally{if(St)throw ut}}return mt}}function _arrayLikeToArray$1(ct,nt){(nt==null||nt>ct.length)&&(nt=ct.length);for(var ot=0,rt=new Array(nt);ot<nt;ot++)rt[ot]=ct[ot];return rt}function _unsupportedIterableToArray$1(ct,nt){if(ct){if(typeof ct=="string")return _arrayLikeToArray$1(ct,nt);var ot=Object.prototype.toString.call(ct).slice(8,-1);if(ot==="Object"&&ct.constructor&&(ot=ct.constructor.name),ot==="Map"||ot==="Set")return Array.from(ct);if(ot==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ot))return _arrayLikeToArray$1(ct,nt)}}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray$1(ct,nt){return _arrayWithHoles$1(ct)||_iterableToArrayLimit$1(ct,nt)||_unsupportedIterableToArray$1(ct,nt)||_nonIterableRest$1()}function _arrayWithoutHoles(ct){if(Array.isArray(ct))return _arrayLikeToArray$1(ct)}function _iterableToArray(ct){if(typeof Symbol<"u"&&ct[Symbol.iterator]!=null||ct["@@iterator"]!=null)return Array.from(ct)}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toConsumableArray$2(ct){return _arrayWithoutHoles(ct)||_iterableToArray(ct)||_unsupportedIterableToArray$1(ct)||_nonIterableSpread()}var fails$5=fails$j,arrayMethodIsStrict$1=function(ct,nt){var ot=[][ct];return!!ot&&fails$5(function(){ot.call(null,nt||function(){return 1},1)})},$$q=_export,$map=arrayIteration.map,arrayMethodHasSpeciesSupport$1=arrayMethodHasSpeciesSupport$4,HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport$1("map");$$q({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT},{map:function(nt){return $map(this,nt,arguments.length>1?arguments[1]:void 0)}});var entryVirtual$2=entryVirtual$5,map$4=entryVirtual$2("Array").map,isPrototypeOf$3=objectIsPrototypeOf,method$2=map$4,ArrayPrototype$2=Array.prototype,map$3=function(ct){var nt=ct.map;return ct===ArrayPrototype$2||isPrototypeOf$3(ArrayPrototype$2,ct)&&nt===ArrayPrototype$2.map?method$2:nt},parent$8=map$3,map$2=parent$8;const _mapInstanceProperty=getDefaultExportFromCjs(map$2);var aCallable=aCallable$4,toObject$2=toObject$7,IndexedObject=indexedObject,lengthOfArrayLike$2=lengthOfArrayLike$6,$TypeError$1=TypeError,createMethod$1=function(ct){return function(nt,ot,rt,ut){aCallable(ot);var gt=toObject$2(nt),pt=IndexedObject(gt),mt=lengthOfArrayLike$2(gt),vt=ct?mt-1:0,St=ct?-1:1;if(rt<2)for(;;){if(vt in pt){ut=pt[vt],vt+=St;break}if(vt+=St,ct?vt<0:mt<=vt)throw $TypeError$1("Reduce of empty array with no initial value")}for(;ct?vt>=0:mt>vt;vt+=St)vt in pt&&(ut=ot(ut,pt[vt],vt,gt));return ut}},arrayReduce={left:createMethod$1(!1),right:createMethod$1(!0)},classof$2=classofRaw$2,engineIsNode=typeof process<"u"&&classof$2(process)=="process",$$p=_export,$reduce=arrayReduce.left,arrayMethodIsStrict=arrayMethodIsStrict$1,CHROME_VERSION=engineV8Version,IS_NODE=engineIsNode,CHROME_BUG=!IS_NODE&&CHROME_VERSION>79&&CHROME_VERSION<83,FORCED$4=CHROME_BUG||!arrayMethodIsStrict("reduce");$$p({target:"Array",proto:!0,forced:FORCED$4},{reduce:function(nt){var ot=arguments.length;return $reduce(this,nt,ot,ot>1?arguments[1]:void 0)}});var entryVirtual$1=entryVirtual$5,reduce$2=entryVirtual$1("Array").reduce,isPrototypeOf$2=objectIsPrototypeOf,method$1=reduce$2,ArrayPrototype$1=Array.prototype,reduce$1=function(ct){var nt=ct.reduce;return ct===ArrayPrototype$1||isPrototypeOf$2(ArrayPrototype$1,ct)&&nt===ArrayPrototype$1.reduce?method$1:nt},parent$7=reduce$1,reduce=parent$7;const _reduceInstanceProperty=getDefaultExportFromCjs(reduce);var whitespaces$2=`	
\v\f\r \u2028\u2029\uFEFF`,uncurryThis$3=functionUncurryThis,requireObjectCoercible=requireObjectCoercible$3,toString$4=toString$6,whitespaces$1=whitespaces$2,replace=uncurryThis$3("".replace),ltrim$1=RegExp("^["+whitespaces$1+"]+"),rtrim$1=RegExp("(^|[^"+whitespaces$1+"])["+whitespaces$1+"]+$"),createMethod=function(ct){return function(nt){var ot=toString$4(requireObjectCoercible(nt));return ct&1&&(ot=replace(ot,ltrim$1,"")),ct&2&&(ot=replace(ot,rtrim$1,"$1")),ot}},stringTrim$1={start:createMethod(1),end:createMethod(2),trim:createMethod(3)},global$4=global$d,fails$4=fails$j,uncurryThis$2=functionUncurryThis,toString$3=toString$6,trim$1=stringTrim$1.trim,whitespaces=whitespaces$2,charAt=uncurryThis$2("".charAt),$parseFloat$1=global$4.parseFloat,Symbol$1=global$4.Symbol,ITERATOR=Symbol$1&&Symbol$1.iterator,FORCED$3=1/$parseFloat$1(whitespaces+"-0")!==-1/0||ITERATOR&&!fails$4(function(){$parseFloat$1(Object(ITERATOR))}),numberParseFloat=FORCED$3?function(nt){var ot=trim$1(toString$3(nt)),rt=$parseFloat$1(ot);return rt===0&&charAt(ot,0)=="-"?-0:rt}:$parseFloat$1,$$o=_export,$parseFloat=numberParseFloat;$$o({global:!0,forced:parseFloat!=$parseFloat},{parseFloat:$parseFloat});var path$6=path$e,_parseFloat$2=path$6.parseFloat,parent$6=_parseFloat$2,_parseFloat=parent$6;const _parseFloat$1=getDefaultExportFromCjs(_parseFloat);var isRetina=function(){var ct;return!!(typeof window<"u"&&window!==null&&(ct="(-webkit-min-device-pixel-ratio: 1.25), (min--moz-device-pixel-ratio: 1.25), (-o-min-device-pixel-ratio: 5/4), (min-resolution: 1.25dppx)",window.devicePixelRatio>1.25||window.matchMedia&&window.matchMedia(ct).matches))};const retina=getDefaultExportFromCjs(isRetina);var IS_RETINA=retina(),defaultColors=["#A62A21","#7e3794","#0B51C1","#3A6024","#A81563","#B3003C"],reSize=/^([-+]?(?:\d+(?:\.\d+)?|\.\d+))([a-z]{2,4}|%)?$/;function _stringAsciiPRNG(ct,nt){for(var ot,rt=_mapInstanceProperty(ot=_toConsumableArray$2(ct)).call(ot,function(St){return St.charCodeAt(0)}),ut=rt.length,gt=ut%(nt-1)+1,pt=_reduceInstanceProperty(rt).call(rt,function(St,yt){return St+yt})%nt,mt=rt[0]%nt,vt=0;vt<ut;vt++)mt=(gt*mt+pt)%nt;return mt}function getRandomColor(ct){var nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:defaultColors;if(!ct)return"transparent";var ot=_stringAsciiPRNG(ct,nt.length);return nt[ot]}function parseSize(ct){ct=""+ct;var nt=reSize.exec(ct)||[],ot=_slicedToArray$1(nt,3),rt=ot[1],ut=rt===void 0?0:rt,gt=ot[2],pt=gt===void 0?"px":gt;return{value:_parseFloat$1(ut),str:ut+pt,unit:pt}}function getImageSize(ct){return ct=parseSize(ct),isNaN(ct.value)?ct=512:ct.unit==="px"?ct=ct.value:ct.value===0?ct=0:ct=512,IS_RETINA&&(ct=ct*2),ct}function defaultInitials(ct,nt){var ot,rt,ut,gt=nt.maxInitials;return _sliceInstanceProperty(ot=_filterInstanceProperty(rt=_mapInstanceProperty(ut=ct.split(/\s/)).call(ut,function(pt){return pt.substring(0,1).toUpperCase()})).call(rt,function(pt){return!!pt})).call(ot,0,gt).join("").toUpperCase()}var timeoutGroups={};function setGroupedTimeout(ct,nt){if(timeoutGroups[nt]){timeoutGroups[nt].push(ct);return}var ot=timeoutGroups[nt]=[ct];setTimeout(function(){delete timeoutGroups[nt],ot.forEach(function(rt){return rt()})},nt)}function getNullableText(){for(var ct=arguments.length,nt=new Array(ct),ot=0;ot<ct;ot++)nt[ot]=arguments[ot];for(var rt=0,ut=nt;rt<ut.length;rt++){var gt=ut[rt];if(gt||gt==="")return gt;if(gt===!1||gt===null)return null}}function calculateBorderRadius(ct){if(ct===!0)return"100%";if(ct!==!1)return ct}function _createSuper$4(ct){var nt=_isNativeReflectConstruct$4();return function(){var rt=_getPrototypeOf(ct),ut;if(nt){var gt=_getPrototypeOf(this).constructor;ut=_Reflect$construct(rt,arguments,gt)}else ut=rt.apply(this,arguments);return _possibleConstructorReturn(this,ut)}}function _isNativeReflectConstruct$4(){if(typeof Reflect>"u"||!_Reflect$construct||_Reflect$construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(_Reflect$construct(Boolean,[],function(){})),!0}catch{return!1}}var defaults={cache:defaultCache,colors:defaultColors,initials:defaultInitials,avatarRedirectUrl:null},contextKeys=_Object$keys(defaults),ConfigContext=Wt.createContext&&Wt.createContext(),isLegacyContext=!ConfigContext,ConfigConsumer=isLegacyContext?null:ConfigContext.Consumer,forwardRef=Wt.forwardRef||function(ct){return ct},ConfigProvider=function(ct){_inherits(ot,ct);var nt=_createSuper$4(ot);function ot(){return _classCallCheck(this,ot),nt.apply(this,arguments)}return _createClass(ot,[{key:"_getContext",value:function(){var ut=this,gt={};return contextKeys.forEach(function(pt){typeof ut.props[pt]<"u"&&(gt[pt]=ut.props[pt])}),gt}},{key:"render",value:function(){var ut=this.props.children;return isLegacyContext?Wt.Children.only(ut):Wt.createElement(ConfigContext.Provider,{value:this._getContext()},Wt.Children.only(ut))}}]),ot}(Wt.Component);_defineProperty$2(ConfigProvider,"displayName","ConfigProvider");_defineProperty$2(ConfigProvider,"propTypes",{cache:PropTypes.object,colors:PropTypes.arrayOf(PropTypes.string),initials:PropTypes.func,avatarRedirectUrl:PropTypes.string,children:PropTypes.node});var withConfig=function(nt){function ot(rt,ut){if(isLegacyContext){var gt=ut&&ut.reactAvatar;return Wt.createElement(nt,_extends({},defaults,gt,rt))}return Wt.createElement(ConfigConsumer,null,function(pt){return Wt.createElement(nt,_extends({ref:ut},defaults,pt,rt))})}return ot.contextTypes=ConfigProvider.childContextTypes,forwardRef(ot)};isLegacyContext&&(ConfigProvider.childContextTypes={reactAvatar:PropTypes.object},ConfigProvider.prototype.getChildContext=function(){return{reactAvatar:this._getContext()}});var objectGetOwnPropertyNames={},internalObjectKeys=objectKeysInternal,enumBugKeys=enumBugKeys$3,hiddenKeys$2=enumBugKeys.concat("length","prototype");objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(nt){return internalObjectKeys(nt,hiddenKeys$2)};var objectGetOwnPropertyNamesExternal={},toAbsoluteIndex=toAbsoluteIndex$3,lengthOfArrayLike$1=lengthOfArrayLike$6,createProperty$2=createProperty$4,$Array=Array,max$1=Math.max,arraySliceSimple=function(ct,nt,ot){for(var rt=lengthOfArrayLike$1(ct),ut=toAbsoluteIndex(nt,rt),gt=toAbsoluteIndex(ot===void 0?rt:ot,rt),pt=$Array(max$1(gt-ut,0)),mt=0;ut<gt;ut++,mt++)createProperty$2(pt,mt,ct[ut]);return pt.length=mt,pt},classof$1=classofRaw$2,toIndexedObject$3=toIndexedObject$9,$getOwnPropertyNames$1=objectGetOwnPropertyNames.f,arraySlice=arraySliceSimple,windowNames=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(ct){try{return $getOwnPropertyNames$1(ct)}catch{return arraySlice(windowNames)}};objectGetOwnPropertyNamesExternal.f=function(nt){return windowNames&&classof$1(nt)=="Window"?getWindowNames(nt):$getOwnPropertyNames$1(toIndexedObject$3(nt))};var createNonEnumerableProperty$2=createNonEnumerableProperty$4,defineBuiltIn$2=function(ct,nt,ot,rt){return rt&&rt.enumerable?ct[nt]=ot:createNonEnumerableProperty$2(ct,nt,ot),ct},defineProperty$6=objectDefineProperty,defineBuiltInAccessor$1=function(ct,nt,ot){return defineProperty$6.f(ct,nt,ot)},wellKnownSymbolWrapped={},wellKnownSymbol$4=wellKnownSymbol$b;wellKnownSymbolWrapped.f=wellKnownSymbol$4;var path$5=path$e,hasOwn$5=hasOwnProperty_1,wrappedWellKnownSymbolModule$1=wellKnownSymbolWrapped,defineProperty$5=objectDefineProperty.f,wellKnownSymbolDefine=function(ct){var nt=path$5.Symbol||(path$5.Symbol={});hasOwn$5(nt,ct)||defineProperty$5(nt,ct,{value:wrappedWellKnownSymbolModule$1.f(ct)})},call$1=functionCall,getBuiltIn$2=getBuiltIn$8,wellKnownSymbol$3=wellKnownSymbol$b,defineBuiltIn$1=defineBuiltIn$2,symbolDefineToPrimitive=function(){var ct=getBuiltIn$2("Symbol"),nt=ct&&ct.prototype,ot=nt&&nt.valueOf,rt=wellKnownSymbol$3("toPrimitive");nt&&!nt[rt]&&defineBuiltIn$1(nt,rt,function(ut){return call$1(ot,this)},{arity:1})},TO_STRING_TAG_SUPPORT$1=toStringTagSupport,classof=classof$6,objectToString=TO_STRING_TAG_SUPPORT$1?{}.toString:function(){return"[object "+classof(this)+"]"},TO_STRING_TAG_SUPPORT=toStringTagSupport,defineProperty$4=objectDefineProperty.f,createNonEnumerableProperty$1=createNonEnumerableProperty$4,hasOwn$4=hasOwnProperty_1,toString$2=objectToString,wellKnownSymbol$2=wellKnownSymbol$b,TO_STRING_TAG=wellKnownSymbol$2("toStringTag"),setToStringTag$1=function(ct,nt,ot,rt){if(ct){var ut=ot?ct:ct.prototype;hasOwn$4(ut,TO_STRING_TAG)||defineProperty$4(ut,TO_STRING_TAG,{configurable:!0,value:nt}),rt&&!TO_STRING_TAG_SUPPORT&&createNonEnumerableProperty$1(ut,"toString",toString$2)}},global$3=global$d,isCallable=isCallable$d,WeakMap$2=global$3.WeakMap,weakMapBasicDetection=isCallable(WeakMap$2)&&/native code/.test(String(WeakMap$2)),NATIVE_WEAK_MAP=weakMapBasicDetection,global$2=global$d,isObject$5=isObject$e,createNonEnumerableProperty=createNonEnumerableProperty$4,hasOwn$3=hasOwnProperty_1,shared$3=sharedStore,sharedKey$1=sharedKey$3,hiddenKeys$1=hiddenKeys$5,OBJECT_ALREADY_INITIALIZED="Object already initialized",TypeError$2=global$2.TypeError,WeakMap$1=global$2.WeakMap,set,get,has,enforce=function(ct){return has(ct)?get(ct):set(ct,{})},getterFor=function(ct){return function(nt){var ot;if(!isObject$5(nt)||(ot=get(nt)).type!==ct)throw TypeError$2("Incompatible receiver, "+ct+" required");return ot}};if(NATIVE_WEAK_MAP||shared$3.state){var store=shared$3.state||(shared$3.state=new WeakMap$1);store.get=store.get,store.has=store.has,store.set=store.set,set=function(ct,nt){if(store.has(ct))throw TypeError$2(OBJECT_ALREADY_INITIALIZED);return nt.facade=ct,store.set(ct,nt),nt},get=function(ct){return store.get(ct)||{}},has=function(ct){return store.has(ct)}}else{var STATE=sharedKey$1("state");hiddenKeys$1[STATE]=!0,set=function(ct,nt){if(hasOwn$3(ct,STATE))throw TypeError$2(OBJECT_ALREADY_INITIALIZED);return nt.facade=ct,createNonEnumerableProperty(ct,STATE,nt),nt},get=function(ct){return hasOwn$3(ct,STATE)?ct[STATE]:{}},has=function(ct){return hasOwn$3(ct,STATE)}}var internalState={set,get,has,enforce,getterFor},$$n=_export,global$1=global$d,call=functionCall,uncurryThis$1=functionUncurryThis,DESCRIPTORS$4=descriptors,NATIVE_SYMBOL$2=symbolConstructorDetection,fails$3=fails$j,hasOwn$2=hasOwnProperty_1,isPrototypeOf$1=objectIsPrototypeOf,anObject$1=anObject$6,toIndexedObject$2=toIndexedObject$9,toPropertyKey=toPropertyKey$4,$toString=toString$6,createPropertyDescriptor=createPropertyDescriptor$4,nativeObjectCreate=objectCreate,objectKeys=objectKeys$3,getOwnPropertyNamesModule$1=objectGetOwnPropertyNames,getOwnPropertyNamesExternal=objectGetOwnPropertyNamesExternal,getOwnPropertySymbolsModule$2=objectGetOwnPropertySymbols,getOwnPropertyDescriptorModule$1=objectGetOwnPropertyDescriptor,definePropertyModule=objectDefineProperty,definePropertiesModule=objectDefineProperties,propertyIsEnumerableModule=objectPropertyIsEnumerable,defineBuiltIn=defineBuiltIn$2,defineBuiltInAccessor=defineBuiltInAccessor$1,shared$2=sharedExports,sharedKey=sharedKey$3,hiddenKeys=hiddenKeys$5,uid=uid$3,wellKnownSymbol$1=wellKnownSymbol$b,wrappedWellKnownSymbolModule=wellKnownSymbolWrapped,defineWellKnownSymbol=wellKnownSymbolDefine,defineSymbolToPrimitive=symbolDefineToPrimitive,setToStringTag=setToStringTag$1,InternalStateModule=internalState,$forEach=arrayIteration.forEach,HIDDEN=sharedKey("hidden"),SYMBOL="Symbol",PROTOTYPE="prototype",setInternalState=InternalStateModule.set,getInternalState=InternalStateModule.getterFor(SYMBOL),ObjectPrototype=Object[PROTOTYPE],$Symbol=global$1.Symbol,SymbolPrototype=$Symbol&&$Symbol[PROTOTYPE],TypeError$1=global$1.TypeError,QObject=global$1.QObject,nativeGetOwnPropertyDescriptor$1=getOwnPropertyDescriptorModule$1.f,nativeDefineProperty=definePropertyModule.f,nativeGetOwnPropertyNames=getOwnPropertyNamesExternal.f,nativePropertyIsEnumerable=propertyIsEnumerableModule.f,push=uncurryThis$1([].push),AllSymbols=shared$2("symbols"),ObjectPrototypeSymbols=shared$2("op-symbols"),WellKnownSymbolsStore=shared$2("wks"),USE_SETTER=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild,setSymbolDescriptor=DESCRIPTORS$4&&fails$3(function(){return nativeObjectCreate(nativeDefineProperty({},"a",{get:function(){return nativeDefineProperty(this,"a",{value:7}).a}})).a!=7})?function(ct,nt,ot){var rt=nativeGetOwnPropertyDescriptor$1(ObjectPrototype,nt);rt&&delete ObjectPrototype[nt],nativeDefineProperty(ct,nt,ot),rt&&ct!==ObjectPrototype&&nativeDefineProperty(ObjectPrototype,nt,rt)}:nativeDefineProperty,wrap=function(ct,nt){var ot=AllSymbols[ct]=nativeObjectCreate(SymbolPrototype);return setInternalState(ot,{type:SYMBOL,tag:ct,description:nt}),DESCRIPTORS$4||(ot.description=nt),ot},$defineProperty=function(nt,ot,rt){nt===ObjectPrototype&&$defineProperty(ObjectPrototypeSymbols,ot,rt),anObject$1(nt);var ut=toPropertyKey(ot);return anObject$1(rt),hasOwn$2(AllSymbols,ut)?(rt.enumerable?(hasOwn$2(nt,HIDDEN)&&nt[HIDDEN][ut]&&(nt[HIDDEN][ut]=!1),rt=nativeObjectCreate(rt,{enumerable:createPropertyDescriptor(0,!1)})):(hasOwn$2(nt,HIDDEN)||nativeDefineProperty(nt,HIDDEN,createPropertyDescriptor(1,{})),nt[HIDDEN][ut]=!0),setSymbolDescriptor(nt,ut,rt)):nativeDefineProperty(nt,ut,rt)},$defineProperties=function(nt,ot){anObject$1(nt);var rt=toIndexedObject$2(ot),ut=objectKeys(rt).concat($getOwnPropertySymbols(rt));return $forEach(ut,function(gt){(!DESCRIPTORS$4||call($propertyIsEnumerable,rt,gt))&&$defineProperty(nt,gt,rt[gt])}),nt},$create=function(nt,ot){return ot===void 0?nativeObjectCreate(nt):$defineProperties(nativeObjectCreate(nt),ot)},$propertyIsEnumerable=function(nt){var ot=toPropertyKey(nt),rt=call(nativePropertyIsEnumerable,this,ot);return this===ObjectPrototype&&hasOwn$2(AllSymbols,ot)&&!hasOwn$2(ObjectPrototypeSymbols,ot)?!1:rt||!hasOwn$2(this,ot)||!hasOwn$2(AllSymbols,ot)||hasOwn$2(this,HIDDEN)&&this[HIDDEN][ot]?rt:!0},$getOwnPropertyDescriptor=function(nt,ot){var rt=toIndexedObject$2(nt),ut=toPropertyKey(ot);if(!(rt===ObjectPrototype&&hasOwn$2(AllSymbols,ut)&&!hasOwn$2(ObjectPrototypeSymbols,ut))){var gt=nativeGetOwnPropertyDescriptor$1(rt,ut);return gt&&hasOwn$2(AllSymbols,ut)&&!(hasOwn$2(rt,HIDDEN)&&rt[HIDDEN][ut])&&(gt.enumerable=!0),gt}},$getOwnPropertyNames=function(nt){var ot=nativeGetOwnPropertyNames(toIndexedObject$2(nt)),rt=[];return $forEach(ot,function(ut){!hasOwn$2(AllSymbols,ut)&&!hasOwn$2(hiddenKeys,ut)&&push(rt,ut)}),rt},$getOwnPropertySymbols=function(ct){var nt=ct===ObjectPrototype,ot=nativeGetOwnPropertyNames(nt?ObjectPrototypeSymbols:toIndexedObject$2(ct)),rt=[];return $forEach(ot,function(ut){hasOwn$2(AllSymbols,ut)&&(!nt||hasOwn$2(ObjectPrototype,ut))&&push(rt,AllSymbols[ut])}),rt};NATIVE_SYMBOL$2||($Symbol=function(){if(isPrototypeOf$1(SymbolPrototype,this))throw TypeError$1("Symbol is not a constructor");var nt=!arguments.length||arguments[0]===void 0?void 0:$toString(arguments[0]),ot=uid(nt),rt=function(ut){this===ObjectPrototype&&call(rt,ObjectPrototypeSymbols,ut),hasOwn$2(this,HIDDEN)&&hasOwn$2(this[HIDDEN],ot)&&(this[HIDDEN][ot]=!1),setSymbolDescriptor(this,ot,createPropertyDescriptor(1,ut))};return DESCRIPTORS$4&&USE_SETTER&&setSymbolDescriptor(ObjectPrototype,ot,{configurable:!0,set:rt}),wrap(ot,nt)},SymbolPrototype=$Symbol[PROTOTYPE],defineBuiltIn(SymbolPrototype,"toString",function(){return getInternalState(this).tag}),defineBuiltIn($Symbol,"withoutSetter",function(ct){return wrap(uid(ct),ct)}),propertyIsEnumerableModule.f=$propertyIsEnumerable,definePropertyModule.f=$defineProperty,definePropertiesModule.f=$defineProperties,getOwnPropertyDescriptorModule$1.f=$getOwnPropertyDescriptor,getOwnPropertyNamesModule$1.f=getOwnPropertyNamesExternal.f=$getOwnPropertyNames,getOwnPropertySymbolsModule$2.f=$getOwnPropertySymbols,wrappedWellKnownSymbolModule.f=function(ct){return wrap(wellKnownSymbol$1(ct),ct)},DESCRIPTORS$4&&defineBuiltInAccessor(SymbolPrototype,"description",{configurable:!0,get:function(){return getInternalState(this).description}}));$$n({global:!0,constructor:!0,wrap:!0,forced:!NATIVE_SYMBOL$2,sham:!NATIVE_SYMBOL$2},{Symbol:$Symbol});$forEach(objectKeys(WellKnownSymbolsStore),function(ct){defineWellKnownSymbol(ct)});$$n({target:SYMBOL,stat:!0,forced:!NATIVE_SYMBOL$2},{useSetter:function(){USE_SETTER=!0},useSimple:function(){USE_SETTER=!1}});$$n({target:"Object",stat:!0,forced:!NATIVE_SYMBOL$2,sham:!DESCRIPTORS$4},{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor});$$n({target:"Object",stat:!0,forced:!NATIVE_SYMBOL$2},{getOwnPropertyNames:$getOwnPropertyNames});defineSymbolToPrimitive();setToStringTag($Symbol,SYMBOL);hiddenKeys[HIDDEN]=!0;var NATIVE_SYMBOL$1=symbolConstructorDetection,symbolRegistryDetection=NATIVE_SYMBOL$1&&!!Symbol.for&&!!Symbol.keyFor,$$m=_export,getBuiltIn$1=getBuiltIn$8,hasOwn$1=hasOwnProperty_1,toString$1=toString$6,shared$1=sharedExports,NATIVE_SYMBOL_REGISTRY$1=symbolRegistryDetection,StringToSymbolRegistry=shared$1("string-to-symbol-registry"),SymbolToStringRegistry$1=shared$1("symbol-to-string-registry");$$m({target:"Symbol",stat:!0,forced:!NATIVE_SYMBOL_REGISTRY$1},{for:function(ct){var nt=toString$1(ct);if(hasOwn$1(StringToSymbolRegistry,nt))return StringToSymbolRegistry[nt];var ot=getBuiltIn$1("Symbol")(nt);return StringToSymbolRegistry[nt]=ot,SymbolToStringRegistry$1[ot]=nt,ot}});var $$l=_export,hasOwn=hasOwnProperty_1,isSymbol=isSymbol$4,tryToString=tryToString$3,shared=sharedExports,NATIVE_SYMBOL_REGISTRY=symbolRegistryDetection,SymbolToStringRegistry=shared("symbol-to-string-registry");$$l({target:"Symbol",stat:!0,forced:!NATIVE_SYMBOL_REGISTRY},{keyFor:function(nt){if(!isSymbol(nt))throw TypeError(tryToString(nt)+" is not a symbol");if(hasOwn(SymbolToStringRegistry,nt))return SymbolToStringRegistry[nt]}});var $$k=_export,NATIVE_SYMBOL=symbolConstructorDetection,fails$2=fails$j,getOwnPropertySymbolsModule$1=objectGetOwnPropertySymbols,toObject$1=toObject$7,FORCED$2=!NATIVE_SYMBOL||fails$2(function(){getOwnPropertySymbolsModule$1.f(1)});$$k({target:"Object",stat:!0,forced:FORCED$2},{getOwnPropertySymbols:function(nt){var ot=getOwnPropertySymbolsModule$1.f;return ot?ot(toObject$1(nt)):[]}});var path$4=path$e,getOwnPropertySymbols$1=path$4.Object.getOwnPropertySymbols,parent$5=getOwnPropertySymbols$1,getOwnPropertySymbols=parent$5;const _Object$getOwnPropertySymbols=getDefaultExportFromCjs(getOwnPropertySymbols);var getOwnPropertyDescriptor$3={exports:{}},$$j=_export,fails$1=fails$j,toIndexedObject$1=toIndexedObject$9,nativeGetOwnPropertyDescriptor=objectGetOwnPropertyDescriptor.f,DESCRIPTORS$3=descriptors,FORCED$1=!DESCRIPTORS$3||fails$1(function(){nativeGetOwnPropertyDescriptor(1)});$$j({target:"Object",stat:!0,forced:FORCED$1,sham:!DESCRIPTORS$3},{getOwnPropertyDescriptor:function(nt,ot){return nativeGetOwnPropertyDescriptor(toIndexedObject$1(nt),ot)}});var path$3=path$e,Object$3=path$3.Object,getOwnPropertyDescriptor$2=getOwnPropertyDescriptor$3.exports=function(nt,ot){return Object$3.getOwnPropertyDescriptor(nt,ot)};Object$3.getOwnPropertyDescriptor.sham&&(getOwnPropertyDescriptor$2.sham=!0);var getOwnPropertyDescriptorExports=getOwnPropertyDescriptor$3.exports,parent$4=getOwnPropertyDescriptorExports,getOwnPropertyDescriptor$1=parent$4;const _Object$getOwnPropertyDescriptor=getDefaultExportFromCjs(getOwnPropertyDescriptor$1);var getBuiltIn=getBuiltIn$8,uncurryThis=functionUncurryThis,getOwnPropertyNamesModule=objectGetOwnPropertyNames,getOwnPropertySymbolsModule=objectGetOwnPropertySymbols,anObject=anObject$6,concat$5=uncurryThis([].concat),ownKeys$5=getBuiltIn("Reflect","ownKeys")||function(nt){var ot=getOwnPropertyNamesModule.f(anObject(nt)),rt=getOwnPropertySymbolsModule.f;return rt?concat$5(ot,rt(nt)):ot},$$i=_export,DESCRIPTORS$2=descriptors,ownKeys$4=ownKeys$5,toIndexedObject=toIndexedObject$9,getOwnPropertyDescriptorModule=objectGetOwnPropertyDescriptor,createProperty$1=createProperty$4;$$i({target:"Object",stat:!0,sham:!DESCRIPTORS$2},{getOwnPropertyDescriptors:function(nt){for(var ot=toIndexedObject(nt),rt=getOwnPropertyDescriptorModule.f,ut=ownKeys$4(ot),gt={},pt=0,mt,vt;ut.length>pt;)vt=rt(ot,mt=ut[pt++]),vt!==void 0&&createProperty$1(gt,mt,vt);return gt}});var path$2=path$e,getOwnPropertyDescriptors$1=path$2.Object.getOwnPropertyDescriptors,parent$3=getOwnPropertyDescriptors$1,getOwnPropertyDescriptors=parent$3;const _Object$getOwnPropertyDescriptors=getDefaultExportFromCjs(getOwnPropertyDescriptors);var defineProperties$3={exports:{}},$$h=_export,DESCRIPTORS$1=descriptors,defineProperties$2=objectDefineProperties.f;$$h({target:"Object",stat:!0,forced:Object.defineProperties!==defineProperties$2,sham:!DESCRIPTORS$1},{defineProperties:defineProperties$2});var path$1=path$e,Object$2=path$1.Object,defineProperties$1=defineProperties$3.exports=function(nt,ot){return Object$2.defineProperties(nt,ot)};Object$2.defineProperties.sham&&(defineProperties$1.sham=!0);var definePropertiesExports=defineProperties$3.exports,parent$2=definePropertiesExports,defineProperties=parent$2;const _Object$defineProperties=getDefaultExportFromCjs(defineProperties);var defineProperty$3={exports:{}},$$g=_export,DESCRIPTORS=descriptors,defineProperty$2=objectDefineProperty.f;$$g({target:"Object",stat:!0,forced:Object.defineProperty!==defineProperty$2,sham:!DESCRIPTORS},{defineProperty:defineProperty$2});var path=path$e,Object$1=path.Object,defineProperty$1=defineProperty$3.exports=function(nt,ot,rt){return Object$1.defineProperty(nt,ot,rt)};Object$1.defineProperty.sham&&(defineProperty$1.sham=!0);var definePropertyExports=defineProperty$3.exports,parent$1=definePropertyExports,defineProperty=parent$1;const _Object$defineProperty=getDefaultExportFromCjs(defineProperty);var InternalState=function(){function ct(){_classCallCheck(this,ct),this.sourcePointer=0,this.active=!0,this.fetch=null}return _createClass(ct,[{key:"isActive",value:function(){var ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return!(ot.internal!==this||!this.fetch||this.active!==!0)}}]),ct}();function ownKeys$3(ct,nt){var ot=_Object$keys(ct);if(_Object$getOwnPropertySymbols){var rt=_Object$getOwnPropertySymbols(ct);nt&&(rt=_filterInstanceProperty(rt).call(rt,function(ut){return _Object$getOwnPropertyDescriptor(ct,ut).enumerable})),ot.push.apply(ot,rt)}return ot}function _objectSpread$1(ct){for(var nt=1;nt<arguments.length;nt++){var ot=arguments[nt]!=null?arguments[nt]:{};nt%2?ownKeys$3(Object(ot),!0).forEach(function(rt){_defineProperty$2(ct,rt,ot[rt])}):_Object$getOwnPropertyDescriptors?_Object$defineProperties(ct,_Object$getOwnPropertyDescriptors(ot)):ownKeys$3(Object(ot)).forEach(function(rt){_Object$defineProperty(ct,rt,_Object$getOwnPropertyDescriptor(ot,rt))})}return ct}function _createSuper$3(ct){var nt=_isNativeReflectConstruct$3();return function(){var rt=_getPrototypeOf(ct),ut;if(nt){var gt=_getPrototypeOf(this).constructor;ut=_Reflect$construct(rt,arguments,gt)}else ut=rt.apply(this,arguments);return _possibleConstructorReturn(this,ut)}}function _isNativeReflectConstruct$3(){if(typeof Reflect>"u"||!_Reflect$construct||_Reflect$construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(_Reflect$construct(Boolean,[],function(){})),!0}catch{return!1}}function matchSource(ct,nt,ot){var rt=nt.cache,ut=new ct(nt);if(!ut.isCompatible(nt))return ot();ut.get(function(gt){var pt=gt&&gt.src&&rt.hasSourceFailedBefore(gt.src);!pt&&gt?ot(gt):ot()})}function createAvatarDataProvider(ct){var nt=ct.sources,ot=nt===void 0?[]:nt,rt=_reduceInstanceProperty(ot).call(ot,function(gt,pt){return _Object$assign(gt,pt.propTypes)},{}),ut=function(gt){_inherits(mt,gt);var pt=_createSuper$3(mt);function mt(vt){var St;return _classCallCheck(this,mt),St=pt.call(this,vt),_defineProperty$2(_assertThisInitialized(St),"_createFetcher",function(yt){return function(wt){var Lt=St.props.cache;if(yt.isActive(St.state)){wt&&wt.type==="error"&&Lt.sourceFailed(wt.target.src);var xt=yt.sourcePointer;if(ot.length!==xt){var It=ot[xt];yt.sourcePointer++,matchSource(It,St.props,function(kt){if(!kt)return setTimeout(yt.fetch,0);yt.isActive(St.state)&&(kt=_objectSpread$1({src:null,value:null,color:null},kt),St.setState(function(At){return yt.isActive(At)?kt:{}}))})}}}}),_defineProperty$2(_assertThisInitialized(St),"fetch",function(){var yt=new InternalState;yt.fetch=St._createFetcher(yt),St.setState({internal:yt},yt.fetch)}),St.state={internal:null,src:null,value:null,color:vt.color},St}return _createClass(mt,[{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentDidUpdate",value:function(St){var yt=!1;for(var wt in rt)yt=yt||St[wt]!==this.props[wt];yt&&setTimeout(this.fetch,0)}},{key:"componentWillUnmount",value:function(){this.state.internal&&(this.state.internal.active=!1)}},{key:"render",value:function(){var St=this.props,yt=St.children,wt=St.propertyName,Lt=this.state,xt=Lt.src,It=Lt.value,kt=Lt.color,At=Lt.sourceName,Tt=Lt.internal,Rt={src:xt,value:It,color:kt,sourceName:At,onRenderFailed:function(){return Tt&&Tt.fetch()}};if(typeof yt=="function")return yt(Rt);var Nt=Wt.Children.only(yt);return Wt.cloneElement(Nt,_defineProperty$2({},wt,Rt))}}]),mt}(reactExports.PureComponent);return _defineProperty$2(ut,"displayName","AvatarDataProvider"),_defineProperty$2(ut,"propTypes",_objectSpread$1(_objectSpread$1({},rt),{},{cache:PropTypes.object,propertyName:PropTypes.string})),_defineProperty$2(ut,"defaultProps",{propertyName:"avatar"}),_defineProperty$2(ut,"Cache",Cache),_defineProperty$2(ut,"ConfigProvider",ConfigProvider),_Object$assign(withConfig(ut),{ConfigProvider,Cache})}function ownKeys$2(ct,nt){var ot=_Object$keys(ct);if(_Object$getOwnPropertySymbols){var rt=_Object$getOwnPropertySymbols(ct);nt&&(rt=_filterInstanceProperty(rt).call(rt,function(ut){return _Object$getOwnPropertyDescriptor(ct,ut).enumerable})),ot.push.apply(ot,rt)}return ot}function _objectSpread(ct){for(var nt=1;nt<arguments.length;nt++){var ot=arguments[nt]!=null?arguments[nt]:{};nt%2?ownKeys$2(Object(ot),!0).forEach(function(rt){_defineProperty$2(ct,rt,ot[rt])}):_Object$getOwnPropertyDescriptors?_Object$defineProperties(ct,_Object$getOwnPropertyDescriptors(ot)):ownKeys$2(Object(ot)).forEach(function(rt){_Object$defineProperty(ct,rt,_Object$getOwnPropertyDescriptor(ot,rt))})}return ct}function _createSuper$2(ct){var nt=_isNativeReflectConstruct$2();return function(){var rt=_getPrototypeOf(ct),ut;if(nt){var gt=_getPrototypeOf(this).constructor;ut=_Reflect$construct(rt,arguments,gt)}else ut=rt.apply(this,arguments);return _possibleConstructorReturn(this,ut)}}function _isNativeReflectConstruct$2(){if(typeof Reflect>"u"||!_Reflect$construct||_Reflect$construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(_Reflect$construct(Boolean,[],function(){})),!0}catch{return!1}}var AvatarWrapper=function(ct){_inherits(ot,ct);var nt=_createSuper$2(ot);function ot(){return _classCallCheck(this,ot),nt.apply(this,arguments)}return _createClass(ot,[{key:"render",value:function(){var ut=this.props,gt=ut.className,pt=ut.unstyled,mt=ut.round,vt=ut.style,St=ut.avatar,yt=ut.onClick,wt=ut.children,Lt=St.sourceName,xt=parseSize(this.props.size),It=pt?null:_objectSpread({display:"inline-block",verticalAlign:"middle",width:xt.str,height:xt.str,borderRadius:calculateBorderRadius(mt),fontFamily:"Helvetica, Arial, sans-serif"},vt),kt=[gt,"sb-avatar"];if(Lt){var At=Lt.toLowerCase().replace(/[^a-z0-9-]+/g,"-").replace(/^-+|-+$/g,"");kt.push("sb-avatar--"+At)}return Wt.createElement("div",{className:kt.join(" "),onClick:yt,style:It},wt)}}]),ot}(Wt.PureComponent);_defineProperty$2(AvatarWrapper,"propTypes",{className:PropTypes.string,round:PropTypes.oneOfType([PropTypes.bool,PropTypes.string]),style:PropTypes.object,size:PropTypes.oneOfType([PropTypes.number,PropTypes.string]),unstyled:PropTypes.bool,avatar:PropTypes.object,onClick:PropTypes.func,children:PropTypes.node});function _createSuper$1(ct){var nt=_isNativeReflectConstruct$1();return function(){var rt=_getPrototypeOf(ct),ut;if(nt){var gt=_getPrototypeOf(this).constructor;ut=_Reflect$construct(rt,arguments,gt)}else ut=rt.apply(this,arguments);return _possibleConstructorReturn(this,ut)}}function _isNativeReflectConstruct$1(){if(typeof Reflect>"u"||!_Reflect$construct||_Reflect$construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(_Reflect$construct(Boolean,[],function(){})),!0}catch{return!1}}var AvatarImage=function(ct){_inherits(ot,ct);var nt=_createSuper$1(ot);function ot(){return _classCallCheck(this,ot),nt.apply(this,arguments)}return _createClass(ot,[{key:"render",value:function(){var ut=this.props,gt=ut.className,pt=ut.round,mt=ut.unstyled,vt=ut.alt,St=ut.title,yt=ut.name,wt=ut.value,Lt=ut.avatar,xt=parseSize(this.props.size),It=mt?null:{maxWidth:"100%",width:xt.str,height:xt.str,borderRadius:calculateBorderRadius(pt)};return Wt.createElement(AvatarWrapper,this.props,Wt.createElement("img",{className:gt+" sb-avatar__image",width:xt.str,height:xt.str,style:It,src:Lt.src,alt:getNullableText(vt,yt||wt),title:getNullableText(St,yt||wt),onError:Lt.onRenderFailed}))}}]),ot}(Wt.PureComponent);_defineProperty$2(AvatarImage,"propTypes",{alt:PropTypes.oneOfType([PropTypes.string,PropTypes.bool]),title:PropTypes.oneOfType([PropTypes.string,PropTypes.bool]),name:PropTypes.string,value:PropTypes.string,avatar:PropTypes.object,className:PropTypes.string,unstyled:PropTypes.bool,round:PropTypes.oneOfType([PropTypes.bool,PropTypes.string,PropTypes.number]),size:PropTypes.oneOfType([PropTypes.number,PropTypes.string])});_defineProperty$2(AvatarImage,"defaultProps",{className:"",round:!1,size:100,unstyled:!1});var $TypeError=TypeError,MAX_SAFE_INTEGER$1=9007199254740991,doesNotExceedSafeInteger$1=function(ct){if(ct>MAX_SAFE_INTEGER$1)throw $TypeError("Maximum allowed index exceeded");return ct},$$f=_export,fails=fails$j,isArray$1=isArray$5,isObject$4=isObject$e,toObject=toObject$7,lengthOfArrayLike=lengthOfArrayLike$6,doesNotExceedSafeInteger=doesNotExceedSafeInteger$1,createProperty=createProperty$4,arraySpeciesCreate=arraySpeciesCreate$2,arrayMethodHasSpeciesSupport=arrayMethodHasSpeciesSupport$4,wellKnownSymbol=wellKnownSymbol$b,V8_VERSION=engineV8Version,IS_CONCAT_SPREADABLE=wellKnownSymbol("isConcatSpreadable"),IS_CONCAT_SPREADABLE_SUPPORT=V8_VERSION>=51||!fails(function(){var ct=[];return ct[IS_CONCAT_SPREADABLE]=!1,ct.concat()[0]!==ct}),isConcatSpreadable=function(ct){if(!isObject$4(ct))return!1;var nt=ct[IS_CONCAT_SPREADABLE];return nt!==void 0?!!nt:isArray$1(ct)},FORCED=!IS_CONCAT_SPREADABLE_SUPPORT||!arrayMethodHasSpeciesSupport("concat");$$f({target:"Array",proto:!0,arity:1,forced:FORCED},{concat:function(nt){var ot=toObject(this),rt=arraySpeciesCreate(ot,0),ut=0,gt,pt,mt,vt,St;for(gt=-1,mt=arguments.length;gt<mt;gt++)if(St=gt===-1?ot:arguments[gt],isConcatSpreadable(St))for(vt=lengthOfArrayLike(St),doesNotExceedSafeInteger(ut+vt),pt=0;pt<vt;pt++,ut++)pt in St&&createProperty(rt,ut,St[pt]);else doesNotExceedSafeInteger(ut+1),createProperty(rt,ut++,St);return rt.length=ut,rt}});var entryVirtual=entryVirtual$5,concat$4=entryVirtual("Array").concat,isPrototypeOf=objectIsPrototypeOf,method=concat$4,ArrayPrototype=Array.prototype,concat$3=function(ct){var nt=ct.concat;return ct===ArrayPrototype||isPrototypeOf(ArrayPrototype,ct)&&nt===ArrayPrototype.concat?method:nt},parent=concat$3,concat$2=parent;const _concatInstanceProperty=getDefaultExportFromCjs(concat$2);function _createSuper(ct){var nt=_isNativeReflectConstruct();return function(){var rt=_getPrototypeOf(ct),ut;if(nt){var gt=_getPrototypeOf(this).constructor;ut=_Reflect$construct(rt,arguments,gt)}else ut=rt.apply(this,arguments);return _possibleConstructorReturn(this,ut)}}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!_Reflect$construct||_Reflect$construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(_Reflect$construct(Boolean,[],function(){})),!0}catch{return!1}}var AvatarText=function(ct){_inherits(ot,ct);var nt=_createSuper(ot);function ot(){var rt,ut;_classCallCheck(this,ot);for(var gt=arguments.length,pt=new Array(gt),mt=0;mt<gt;mt++)pt[mt]=arguments[mt];return ut=nt.call.apply(nt,_concatInstanceProperty(rt=[this]).call(rt,pt)),_defineProperty$2(_assertThisInitialized(ut),"_scaleTextNode",function(vt){var St=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,yt=ut.props,wt=yt.unstyled,Lt=yt.textSizeRatio,xt=yt.textMarginRatio,It=yt.avatar;if(ut._node=vt,!(!vt||!vt.parentNode||wt||It.src||!ut._mounted)){var kt=vt.parentNode,At=kt.parentNode,Tt=kt.getBoundingClientRect(),Rt=Tt.width,Nt=Tt.height;if(Rt==0&&Nt==0){var Pt=Math.min(St*1.5,500);setGroupedTimeout(function(){return ut._scaleTextNode(vt,Pt)},Pt);return}if(!At.style.fontSize){var Ft=Nt/Lt;At.style.fontSize="".concat(Ft,"px")}kt.style.fontSize=null;var Kt=vt.getBoundingClientRect(),Bt=Kt.width;if(!(Bt<0)){var Ut=Rt*(1-2*xt);Bt>Ut&&(kt.style.fontSize="calc(1em * ".concat(Ut/Bt,")"))}}}),ut}return _createClass(ot,[{key:"componentDidMount",value:function(){this._mounted=!0,this._scaleTextNode(this._node)}},{key:"componentWillUnmount",value:function(){this._mounted=!1}},{key:"render",value:function(){var ut=this.props,gt=ut.className,pt=ut.round,mt=ut.unstyled,vt=ut.title,St=ut.name,yt=ut.value,wt=ut.avatar,Lt=parseSize(this.props.size),xt=mt?null:{width:Lt.str,height:Lt.str,lineHeight:"initial",textAlign:"center",color:this.props.fgColor,background:wt.color,borderRadius:calculateBorderRadius(pt)},It=mt?null:{display:"table",tableLayout:"fixed",width:"100%",height:"100%"},kt=mt?null:{display:"table-cell",verticalAlign:"middle",fontSize:"100%",whiteSpace:"nowrap"},At=[wt.value,this.props.size].join("");return Wt.createElement(AvatarWrapper,this.props,Wt.createElement("div",{className:gt+" sb-avatar__text",style:xt,title:getNullableText(vt,St||yt)},Wt.createElement("div",{style:It},Wt.createElement("span",{style:kt},Wt.createElement("span",{ref:this._scaleTextNode,key:At},wt.value)))))}}]),ot}(Wt.PureComponent);_defineProperty$2(AvatarText,"propTypes",{name:PropTypes.string,value:PropTypes.string,avatar:PropTypes.object,title:PropTypes.oneOfType([PropTypes.string,PropTypes.bool]),className:PropTypes.string,unstyled:PropTypes.bool,fgColor:PropTypes.string,textSizeRatio:PropTypes.number,textMarginRatio:PropTypes.number,round:PropTypes.oneOfType([PropTypes.bool,PropTypes.string,PropTypes.number]),size:PropTypes.oneOfType([PropTypes.number,PropTypes.string])});_defineProperty$2(AvatarText,"defaultProps",{className:"",fgColor:"#FFF",round:!1,size:100,textSizeRatio:3,textMarginRatio:.15,unstyled:!1});function createAvatarComponent(ct){var nt=createAvatarDataProvider(ct),ot=withConfig(Wt.forwardRef(function(rt,ut){return Wt.createElement(nt,_extends({},rt,{propertyName:"avatar"}),function(gt){var pt=gt.src?AvatarImage:AvatarText;return Wt.createElement(pt,_extends({},rt,{avatar:gt,ref:ut}))})}));return _Object$assign(ot,{getRandomColor,ConfigProvider,Cache})}var md5$1={exports:{}},crypt={exports:{}};(function(){var ct="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nt={rotl:function(ot,rt){return ot<<rt|ot>>>32-rt},rotr:function(ot,rt){return ot<<32-rt|ot>>>rt},endian:function(ot){if(ot.constructor==Number)return nt.rotl(ot,8)&16711935|nt.rotl(ot,24)&4278255360;for(var rt=0;rt<ot.length;rt++)ot[rt]=nt.endian(ot[rt]);return ot},randomBytes:function(ot){for(var rt=[];ot>0;ot--)rt.push(Math.floor(Math.random()*256));return rt},bytesToWords:function(ot){for(var rt=[],ut=0,gt=0;ut<ot.length;ut++,gt+=8)rt[gt>>>5]|=ot[ut]<<24-gt%32;return rt},wordsToBytes:function(ot){for(var rt=[],ut=0;ut<ot.length*32;ut+=8)rt.push(ot[ut>>>5]>>>24-ut%32&255);return rt},bytesToHex:function(ot){for(var rt=[],ut=0;ut<ot.length;ut++)rt.push((ot[ut]>>>4).toString(16)),rt.push((ot[ut]&15).toString(16));return rt.join("")},hexToBytes:function(ot){for(var rt=[],ut=0;ut<ot.length;ut+=2)rt.push(parseInt(ot.substr(ut,2),16));return rt},bytesToBase64:function(ot){for(var rt=[],ut=0;ut<ot.length;ut+=3)for(var gt=ot[ut]<<16|ot[ut+1]<<8|ot[ut+2],pt=0;pt<4;pt++)ut*8+pt*6<=ot.length*8?rt.push(ct.charAt(gt>>>6*(3-pt)&63)):rt.push("=");return rt.join("")},base64ToBytes:function(ot){ot=ot.replace(/[^A-Z0-9+\/]/ig,"");for(var rt=[],ut=0,gt=0;ut<ot.length;gt=++ut%4)gt!=0&&rt.push((ct.indexOf(ot.charAt(ut-1))&Math.pow(2,-2*gt+8)-1)<<gt*2|ct.indexOf(ot.charAt(ut))>>>6-gt*2);return rt}};crypt.exports=nt})();var cryptExports=crypt.exports,charenc={utf8:{stringToBytes:function(ct){return charenc.bin.stringToBytes(unescape(encodeURIComponent(ct)))},bytesToString:function(ct){return decodeURIComponent(escape(charenc.bin.bytesToString(ct)))}},bin:{stringToBytes:function(ct){for(var nt=[],ot=0;ot<ct.length;ot++)nt.push(ct.charCodeAt(ot)&255);return nt},bytesToString:function(ct){for(var nt=[],ot=0;ot<ct.length;ot++)nt.push(String.fromCharCode(ct[ot]));return nt.join("")}}},charenc_1=charenc;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var isBuffer_1=function(ct){return ct!=null&&(isBuffer(ct)||isSlowBuffer(ct)||!!ct._isBuffer)};function isBuffer(ct){return!!ct.constructor&&typeof ct.constructor.isBuffer=="function"&&ct.constructor.isBuffer(ct)}function isSlowBuffer(ct){return typeof ct.readFloatLE=="function"&&typeof ct.slice=="function"&&isBuffer(ct.slice(0,0))}(function(){var ct=cryptExports,nt=charenc_1.utf8,ot=isBuffer_1,rt=charenc_1.bin,ut=function(gt,pt){gt.constructor==String?pt&&pt.encoding==="binary"?gt=rt.stringToBytes(gt):gt=nt.stringToBytes(gt):ot(gt)?gt=Array.prototype.slice.call(gt,0):!Array.isArray(gt)&&gt.constructor!==Uint8Array&&(gt=gt.toString());for(var mt=ct.bytesToWords(gt),vt=gt.length*8,St=1732584193,yt=-271733879,wt=-1732584194,Lt=271733878,xt=0;xt<mt.length;xt++)mt[xt]=(mt[xt]<<8|mt[xt]>>>24)&16711935|(mt[xt]<<24|mt[xt]>>>8)&4278255360;mt[vt>>>5]|=128<<vt%32,mt[(vt+64>>>9<<4)+14]=vt;for(var It=ut._ff,kt=ut._gg,At=ut._hh,Tt=ut._ii,xt=0;xt<mt.length;xt+=16){var Rt=St,Nt=yt,Pt=wt,Ft=Lt;St=It(St,yt,wt,Lt,mt[xt+0],7,-680876936),Lt=It(Lt,St,yt,wt,mt[xt+1],12,-389564586),wt=It(wt,Lt,St,yt,mt[xt+2],17,606105819),yt=It(yt,wt,Lt,St,mt[xt+3],22,-1044525330),St=It(St,yt,wt,Lt,mt[xt+4],7,-176418897),Lt=It(Lt,St,yt,wt,mt[xt+5],12,1200080426),wt=It(wt,Lt,St,yt,mt[xt+6],17,-1473231341),yt=It(yt,wt,Lt,St,mt[xt+7],22,-45705983),St=It(St,yt,wt,Lt,mt[xt+8],7,1770035416),Lt=It(Lt,St,yt,wt,mt[xt+9],12,-1958414417),wt=It(wt,Lt,St,yt,mt[xt+10],17,-42063),yt=It(yt,wt,Lt,St,mt[xt+11],22,-1990404162),St=It(St,yt,wt,Lt,mt[xt+12],7,1804603682),Lt=It(Lt,St,yt,wt,mt[xt+13],12,-40341101),wt=It(wt,Lt,St,yt,mt[xt+14],17,-1502002290),yt=It(yt,wt,Lt,St,mt[xt+15],22,1236535329),St=kt(St,yt,wt,Lt,mt[xt+1],5,-165796510),Lt=kt(Lt,St,yt,wt,mt[xt+6],9,-1069501632),wt=kt(wt,Lt,St,yt,mt[xt+11],14,643717713),yt=kt(yt,wt,Lt,St,mt[xt+0],20,-373897302),St=kt(St,yt,wt,Lt,mt[xt+5],5,-701558691),Lt=kt(Lt,St,yt,wt,mt[xt+10],9,38016083),wt=kt(wt,Lt,St,yt,mt[xt+15],14,-660478335),yt=kt(yt,wt,Lt,St,mt[xt+4],20,-405537848),St=kt(St,yt,wt,Lt,mt[xt+9],5,568446438),Lt=kt(Lt,St,yt,wt,mt[xt+14],9,-1019803690),wt=kt(wt,Lt,St,yt,mt[xt+3],14,-187363961),yt=kt(yt,wt,Lt,St,mt[xt+8],20,1163531501),St=kt(St,yt,wt,Lt,mt[xt+13],5,-1444681467),Lt=kt(Lt,St,yt,wt,mt[xt+2],9,-51403784),wt=kt(wt,Lt,St,yt,mt[xt+7],14,1735328473),yt=kt(yt,wt,Lt,St,mt[xt+12],20,-1926607734),St=At(St,yt,wt,Lt,mt[xt+5],4,-378558),Lt=At(Lt,St,yt,wt,mt[xt+8],11,-2022574463),wt=At(wt,Lt,St,yt,mt[xt+11],16,1839030562),yt=At(yt,wt,Lt,St,mt[xt+14],23,-35309556),St=At(St,yt,wt,Lt,mt[xt+1],4,-1530992060),Lt=At(Lt,St,yt,wt,mt[xt+4],11,1272893353),wt=At(wt,Lt,St,yt,mt[xt+7],16,-155497632),yt=At(yt,wt,Lt,St,mt[xt+10],23,-1094730640),St=At(St,yt,wt,Lt,mt[xt+13],4,681279174),Lt=At(Lt,St,yt,wt,mt[xt+0],11,-358537222),wt=At(wt,Lt,St,yt,mt[xt+3],16,-722521979),yt=At(yt,wt,Lt,St,mt[xt+6],23,76029189),St=At(St,yt,wt,Lt,mt[xt+9],4,-640364487),Lt=At(Lt,St,yt,wt,mt[xt+12],11,-421815835),wt=At(wt,Lt,St,yt,mt[xt+15],16,530742520),yt=At(yt,wt,Lt,St,mt[xt+2],23,-995338651),St=Tt(St,yt,wt,Lt,mt[xt+0],6,-198630844),Lt=Tt(Lt,St,yt,wt,mt[xt+7],10,1126891415),wt=Tt(wt,Lt,St,yt,mt[xt+14],15,-1416354905),yt=Tt(yt,wt,Lt,St,mt[xt+5],21,-57434055),St=Tt(St,yt,wt,Lt,mt[xt+12],6,1700485571),Lt=Tt(Lt,St,yt,wt,mt[xt+3],10,-1894986606),wt=Tt(wt,Lt,St,yt,mt[xt+10],15,-1051523),yt=Tt(yt,wt,Lt,St,mt[xt+1],21,-2054922799),St=Tt(St,yt,wt,Lt,mt[xt+8],6,1873313359),Lt=Tt(Lt,St,yt,wt,mt[xt+15],10,-30611744),wt=Tt(wt,Lt,St,yt,mt[xt+6],15,-1560198380),yt=Tt(yt,wt,Lt,St,mt[xt+13],21,1309151649),St=Tt(St,yt,wt,Lt,mt[xt+4],6,-145523070),Lt=Tt(Lt,St,yt,wt,mt[xt+11],10,-1120210379),wt=Tt(wt,Lt,St,yt,mt[xt+2],15,718787259),yt=Tt(yt,wt,Lt,St,mt[xt+9],21,-343485551),St=St+Rt>>>0,yt=yt+Nt>>>0,wt=wt+Pt>>>0,Lt=Lt+Ft>>>0}return ct.endian([St,yt,wt,Lt])};ut._ff=function(gt,pt,mt,vt,St,yt,wt){var Lt=gt+(pt&mt|~pt&vt)+(St>>>0)+wt;return(Lt<<yt|Lt>>>32-yt)+pt},ut._gg=function(gt,pt,mt,vt,St,yt,wt){var Lt=gt+(pt&vt|mt&~vt)+(St>>>0)+wt;return(Lt<<yt|Lt>>>32-yt)+pt},ut._hh=function(gt,pt,mt,vt,St,yt,wt){var Lt=gt+(pt^mt^vt)+(St>>>0)+wt;return(Lt<<yt|Lt>>>32-yt)+pt},ut._ii=function(gt,pt,mt,vt,St,yt,wt){var Lt=gt+(mt^(pt|~vt))+(St>>>0)+wt;return(Lt<<yt|Lt>>>32-yt)+pt},ut._blocksize=16,ut._digestsize=16,md5$1.exports=function(gt,pt){if(gt==null)throw new Error("Illegal argument "+gt);var mt=ct.wordsToBytes(ut(gt,pt));return pt&&pt.asBytes?mt:pt&&pt.asString?rt.bytesToString(mt):ct.bytesToHex(mt)}})();var md5Exports=md5$1.exports;const md5=getDefaultExportFromCjs(md5Exports);var GravatarSource=_createClass(function ct(nt){var ot=this;_classCallCheck(this,ct),_defineProperty$2(this,"props",null),_defineProperty$2(this,"isCompatible",function(){return!!ot.props.email||!!ot.props.md5Email}),_defineProperty$2(this,"get",function(rt){var ut=ot.props,gt=ut.md5Email||md5(ut.email),pt=getImageSize(ut.size),mt="https://secure.gravatar.com/avatar/".concat(gt,"?d=404");pt&&(mt+="&s=".concat(pt)),rt({sourceName:"gravatar",src:mt})}),this.props=nt});_defineProperty$2(GravatarSource,"propTypes",{email:PropTypes.string,md5Email:PropTypes.string});var FacebookSource=_createClass(function ct(nt){var ot=this;_classCallCheck(this,ct),_defineProperty$2(this,"props",null),_defineProperty$2(this,"isCompatible",function(){return!!ot.props.facebookId}),_defineProperty$2(this,"get",function(rt){var ut,gt=ot.props.facebookId,pt=getImageSize(ot.props.size),mt="https://graph.facebook.com/".concat(gt,"/picture");pt&&(mt+=_concatInstanceProperty(ut="?width=".concat(pt,"&height=")).call(ut,pt)),rt({sourceName:"facebook",src:mt})}),this.props=nt});_defineProperty$2(FacebookSource,"propTypes",{facebookId:PropTypes.string});var GithubSource=_createClass(function ct(nt){var ot=this;_classCallCheck(this,ct),_defineProperty$2(this,"props",null),_defineProperty$2(this,"isCompatible",function(){return!!ot.props.githubHandle}),_defineProperty$2(this,"get",function(rt){var ut=ot.props.githubHandle,gt=getImageSize(ot.props.size),pt="https://avatars.githubusercontent.com/".concat(ut,"?v=4");gt&&(pt+="&s=".concat(gt)),rt({sourceName:"github",src:pt})}),this.props=nt});_defineProperty$2(GithubSource,"propTypes",{githubHandle:PropTypes.string});var SkypeSource=_createClass(function ct(nt){var ot=this;_classCallCheck(this,ct),_defineProperty$2(this,"props",null),_defineProperty$2(this,"isCompatible",function(){return!!ot.props.skypeId}),_defineProperty$2(this,"get",function(rt){var ut=ot.props.skypeId,gt="https://api.skype.com/users/".concat(ut,"/profile/avatar");rt({sourceName:"skype",src:gt})}),this.props=nt});_defineProperty$2(SkypeSource,"propTypes",{skypeId:PropTypes.string});var ValueSource=function(){function ct(nt){var ot=this;_classCallCheck(this,ct),_defineProperty$2(this,"props",null),_defineProperty$2(this,"isCompatible",function(){return!!(ot.props.name||ot.props.value||ot.props.email)}),_defineProperty$2(this,"get",function(rt){var ut=ot.getValue();if(!ut)return rt(null);rt({sourceName:"text",value:ut,color:ot.getColor()})}),this.props=nt}return _createClass(ct,[{key:"getInitials",value:function(){var ot=this.props,rt=ot.name,ut=ot.initials;return typeof ut=="string"?ut:typeof ut=="function"?ut(rt,this.props):defaultInitials(rt,this.props)}},{key:"getValue",value:function(){return this.props.name?this.getInitials():this.props.value?this.props.value:null}},{key:"getColor",value:function(){var ot=this.props,rt=ot.color,ut=ot.colors,gt=ot.name,pt=ot.email,mt=ot.value,vt=gt||pt||mt;return rt||getRandomColor(vt,ut)}}]),ct}();_defineProperty$2(ValueSource,"propTypes",{color:PropTypes.string,name:PropTypes.string,value:PropTypes.string,email:PropTypes.string,maxInitials:PropTypes.number,initials:PropTypes.oneOfType([PropTypes.string,PropTypes.func])});var SrcSource=_createClass(function ct(nt){var ot=this;_classCallCheck(this,ct),_defineProperty$2(this,"props",null),_defineProperty$2(this,"isCompatible",function(){return!!ot.props.src}),_defineProperty$2(this,"get",function(rt){rt({sourceName:"src",src:ot.props.src})}),this.props=nt});_defineProperty$2(SrcSource,"propTypes",{src:PropTypes.string});var IconSource=_createClass(function ct(nt){var ot=this;_classCallCheck(this,ct),_defineProperty$2(this,"props",null),_defineProperty$2(this,"icon",""),_defineProperty$2(this,"isCompatible",function(){return!0}),_defineProperty$2(this,"get",function(rt){var ut=ot.props,gt=ut.color,pt=ut.colors;rt({sourceName:"icon",value:ot.icon,color:gt||getRandomColor(ot.icon,pt)})}),this.props=nt});_defineProperty$2(IconSource,"propTypes",{color:PropTypes.string});function createRedirectSource(ct,nt){var ot;return ot=_createClass(function rt(ut){var gt=this;_classCallCheck(this,rt),_defineProperty$2(this,"props",null),_defineProperty$2(this,"isCompatible",function(){return!!gt.props.avatarRedirectUrl&&!!gt.props[nt]}),_defineProperty$2(this,"get",function(pt){var mt,vt,St,yt=gt.props.avatarRedirectUrl,wt=getImageSize(gt.props.size),Lt=yt.replace(/\/*$/,"/"),xt=gt.props[nt],It=wt?"size=".concat(wt):"",kt=_concatInstanceProperty(mt=_concatInstanceProperty(vt=_concatInstanceProperty(St="".concat(Lt)).call(St,ct,"/")).call(vt,xt,"?")).call(mt,It);pt({sourceName:ct,src:kt})}),this.props=ut}),_defineProperty$2(ot,"propTypes",_defineProperty$2({},nt,PropTypes.oneOfType([PropTypes.string,PropTypes.number]))),ot}const twitterSource=createRedirectSource("twitter","twitterHandle"),vkontakteSource=createRedirectSource("vkontakte","vkontakteId"),instagramSource=createRedirectSource("instagram","instagramId"),googleSource=createRedirectSource("google","googleId");var SOURCES=[FacebookSource,googleSource,GithubSource,twitterSource,instagramSource,vkontakteSource,SkypeSource,GravatarSource,SrcSource,ValueSource,IconSource];const Avatar=createAvatarComponent({sources:SOURCES}),Client=({username:ct})=>jsxRuntimeExports.jsxs("div",{className:"client",children:[jsxRuntimeExports.jsx(ConfigProvider,{colors:["#791111","#ccb782"],children:jsxRuntimeExports.jsx(Avatar,{name:ct,size:60,round:"35%"})}),jsxRuntimeExports.jsx("span",{className:"userName",children:ct})]});function _defineProperty$1(ct,nt,ot){return nt in ct?Object.defineProperty(ct,nt,{value:ot,enumerable:!0,configurable:!0,writable:!0}):ct[nt]=ot,ct}function ownKeys$1(ct,nt){var ot=Object.keys(ct);if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(ct);nt&&(rt=rt.filter(function(ut){return Object.getOwnPropertyDescriptor(ct,ut).enumerable})),ot.push.apply(ot,rt)}return ot}function _objectSpread2$1(ct){for(var nt=1;nt<arguments.length;nt++){var ot=arguments[nt]!=null?arguments[nt]:{};nt%2?ownKeys$1(Object(ot),!0).forEach(function(rt){_defineProperty$1(ct,rt,ot[rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ct,Object.getOwnPropertyDescriptors(ot)):ownKeys$1(Object(ot)).forEach(function(rt){Object.defineProperty(ct,rt,Object.getOwnPropertyDescriptor(ot,rt))})}return ct}function _objectWithoutPropertiesLoose(ct,nt){if(ct==null)return{};var ot={},rt=Object.keys(ct),ut,gt;for(gt=0;gt<rt.length;gt++)ut=rt[gt],!(nt.indexOf(ut)>=0)&&(ot[ut]=ct[ut]);return ot}function _objectWithoutProperties(ct,nt){if(ct==null)return{};var ot=_objectWithoutPropertiesLoose(ct,nt),rt,ut;if(Object.getOwnPropertySymbols){var gt=Object.getOwnPropertySymbols(ct);for(ut=0;ut<gt.length;ut++)rt=gt[ut],!(nt.indexOf(rt)>=0)&&Object.prototype.propertyIsEnumerable.call(ct,rt)&&(ot[rt]=ct[rt])}return ot}function _slicedToArray(ct,nt){return _arrayWithHoles(ct)||_iterableToArrayLimit(ct,nt)||_unsupportedIterableToArray(ct,nt)||_nonIterableRest()}function _arrayWithHoles(ct){if(Array.isArray(ct))return ct}function _iterableToArrayLimit(ct,nt){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(ct)))){var ot=[],rt=!0,ut=!1,gt=void 0;try{for(var pt=ct[Symbol.iterator](),mt;!(rt=(mt=pt.next()).done)&&(ot.push(mt.value),!(nt&&ot.length===nt));rt=!0);}catch(vt){ut=!0,gt=vt}finally{try{!rt&&pt.return!=null&&pt.return()}finally{if(ut)throw gt}}return ot}}function _unsupportedIterableToArray(ct,nt){if(ct){if(typeof ct=="string")return _arrayLikeToArray(ct,nt);var ot=Object.prototype.toString.call(ct).slice(8,-1);if(ot==="Object"&&ct.constructor&&(ot=ct.constructor.name),ot==="Map"||ot==="Set")return Array.from(ct);if(ot==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ot))return _arrayLikeToArray(ct,nt)}}function _arrayLikeToArray(ct,nt){(nt==null||nt>ct.length)&&(nt=ct.length);for(var ot=0,rt=new Array(nt);ot<nt;ot++)rt[ot]=ct[ot];return rt}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _defineProperty(ct,nt,ot){return nt in ct?Object.defineProperty(ct,nt,{value:ot,enumerable:!0,configurable:!0,writable:!0}):ct[nt]=ot,ct}function ownKeys(ct,nt){var ot=Object.keys(ct);if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(ct);nt&&(rt=rt.filter(function(ut){return Object.getOwnPropertyDescriptor(ct,ut).enumerable})),ot.push.apply(ot,rt)}return ot}function _objectSpread2(ct){for(var nt=1;nt<arguments.length;nt++){var ot=arguments[nt]!=null?arguments[nt]:{};nt%2?ownKeys(Object(ot),!0).forEach(function(rt){_defineProperty(ct,rt,ot[rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ct,Object.getOwnPropertyDescriptors(ot)):ownKeys(Object(ot)).forEach(function(rt){Object.defineProperty(ct,rt,Object.getOwnPropertyDescriptor(ot,rt))})}return ct}function compose$1(){for(var ct=arguments.length,nt=new Array(ct),ot=0;ot<ct;ot++)nt[ot]=arguments[ot];return function(rt){return nt.reduceRight(function(ut,gt){return gt(ut)},rt)}}function curry$1(ct){return function nt(){for(var ot=this,rt=arguments.length,ut=new Array(rt),gt=0;gt<rt;gt++)ut[gt]=arguments[gt];return ut.length>=ct.length?ct.apply(this,ut):function(){for(var pt=arguments.length,mt=new Array(pt),vt=0;vt<pt;vt++)mt[vt]=arguments[vt];return nt.apply(ot,[].concat(ut,mt))}}}function isObject$3(ct){return{}.toString.call(ct).includes("Object")}function isEmpty$1(ct){return!Object.keys(ct).length}function isFunction$1(ct){return typeof ct=="function"}function hasOwnProperty$3(ct,nt){return Object.prototype.hasOwnProperty.call(ct,nt)}function validateChanges(ct,nt){return isObject$3(nt)||errorHandler$2("changeType"),Object.keys(nt).some(function(ot){return!hasOwnProperty$3(ct,ot)})&&errorHandler$2("changeField"),nt}function validateSelector(ct){isFunction$1(ct)||errorHandler$2("selectorType")}function validateHandler(ct){isFunction$1(ct)||isObject$3(ct)||errorHandler$2("handlerType"),isObject$3(ct)&&Object.values(ct).some(function(nt){return!isFunction$1(nt)})&&errorHandler$2("handlersType")}function validateInitial(ct){ct||errorHandler$2("initialIsRequired"),isObject$3(ct)||errorHandler$2("initialType"),isEmpty$1(ct)&&errorHandler$2("initialContent")}function throwError$1(ct,nt){throw new Error(ct[nt]||ct.default)}var errorMessages$1={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},errorHandler$2=curry$1(throwError$1)(errorMessages$1),validators$1={changes:validateChanges,selector:validateSelector,handler:validateHandler,initial:validateInitial};function create$8(ct){var nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};validators$1.initial(ct),validators$1.handler(nt);var ot={current:ct},rt=curry$1(didStateUpdate)(ot,nt),ut=curry$1(updateState)(ot),gt=curry$1(validators$1.changes)(ct),pt=curry$1(extractChanges)(ot);function mt(){var St=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(yt){return yt};return validators$1.selector(St),St(ot.current)}function vt(St){compose$1(rt,ut,gt,pt)(St)}return[mt,vt]}function extractChanges(ct,nt){return isFunction$1(nt)?nt(ct.current):nt}function updateState(ct,nt){return ct.current=_objectSpread2(_objectSpread2({},ct.current),nt),nt}function didStateUpdate(ct,nt,ot){return isFunction$1(nt)?nt(ct.current):Object.keys(ot).forEach(function(rt){var ut;return(ut=nt[rt])===null||ut===void 0?void 0:ut.call(nt,ct.current[rt])}),ot}var index$1={create:create$8},config$1={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.36.1/min/vs"}};function curry(ct){return function nt(){for(var ot=this,rt=arguments.length,ut=new Array(rt),gt=0;gt<rt;gt++)ut[gt]=arguments[gt];return ut.length>=ct.length?ct.apply(this,ut):function(){for(var pt=arguments.length,mt=new Array(pt),vt=0;vt<pt;vt++)mt[vt]=arguments[vt];return nt.apply(ot,[].concat(ut,mt))}}}function isObject$2(ct){return{}.toString.call(ct).includes("Object")}function validateConfig(ct){return ct||errorHandler$1("configIsRequired"),isObject$2(ct)||errorHandler$1("configType"),ct.urls?(informAboutDeprecation(),{paths:{vs:ct.urls.monacoBase}}):ct}function informAboutDeprecation(){console.warn(errorMessages.deprecation)}function throwError(ct,nt){throw new Error(ct[nt]||ct.default)}var errorMessages={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},errorHandler$1=curry(throwError)(errorMessages),validators={config:validateConfig},compose=function(){for(var nt=arguments.length,ot=new Array(nt),rt=0;rt<nt;rt++)ot[rt]=arguments[rt];return function(ut){return ot.reduceRight(function(gt,pt){return pt(gt)},ut)}};function merge(ct,nt){return Object.keys(nt).forEach(function(ot){nt[ot]instanceof Object&&ct[ot]&&Object.assign(nt[ot],merge(ct[ot],nt[ot]))}),_objectSpread2$1(_objectSpread2$1({},ct),nt)}var CANCELATION_MESSAGE={type:"cancelation",msg:"operation is manually canceled"};function makeCancelable(ct){var nt=!1,ot=new Promise(function(rt,ut){ct.then(function(gt){return nt?ut(CANCELATION_MESSAGE):rt(gt)}),ct.catch(ut)});return ot.cancel=function(){return nt=!0},ot}var _state$create=index$1.create({config:config$1,isInitialized:!1,resolve:null,reject:null,monaco:null}),_state$create2=_slicedToArray(_state$create,2),getState$1=_state$create2[0],setState=_state$create2[1];function config(ct){var nt=validators.config(ct),ot=nt.monaco,rt=_objectWithoutProperties(nt,["monaco"]);setState(function(ut){return{config:merge(ut.config,rt),monaco:ot}})}function init(){var ct=getState$1(function(nt){var ot=nt.monaco,rt=nt.isInitialized,ut=nt.resolve;return{monaco:ot,isInitialized:rt,resolve:ut}});if(!ct.isInitialized){if(setState({isInitialized:!0}),ct.monaco)return ct.resolve(ct.monaco),makeCancelable(wrapperPromise);if(window.monaco&&window.monaco.editor)return storeMonacoInstance(window.monaco),ct.resolve(window.monaco),makeCancelable(wrapperPromise);compose(injectScripts,getMonacoLoaderScript)(configureLoader)}return makeCancelable(wrapperPromise)}function injectScripts(ct){return document.body.appendChild(ct)}function createScript(ct){var nt=document.createElement("script");return ct&&(nt.src=ct),nt}function getMonacoLoaderScript(ct){var nt=getState$1(function(rt){var ut=rt.config,gt=rt.reject;return{config:ut,reject:gt}}),ot=createScript("".concat(nt.config.paths.vs,"/loader.js"));return ot.onload=function(){return ct()},ot.onerror=nt.reject,ot}function configureLoader(){var ct=getState$1(function(ot){var rt=ot.config,ut=ot.resolve,gt=ot.reject;return{config:rt,resolve:ut,reject:gt}}),nt=window.require;nt.config(ct.config),nt(["vs/editor/editor.main"],function(ot){storeMonacoInstance(ot),ct.resolve(ot)},function(ot){ct.reject(ot)})}function storeMonacoInstance(ct){getState$1().monaco||setState({monaco:ct})}function __getMonacoInstance(){return getState$1(function(ct){var nt=ct.monaco;return nt})}var wrapperPromise=new Promise(function(ct,nt){return setState({resolve:ct,reject:nt})}),loader={config,init,__getMonacoInstance},lt={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},v=lt,at={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},Y=at;function Mt({children:ct}){return Wt.createElement("div",{style:Y.container},ct)}var Z=Mt,$$e=Z;function Et({width:ct,height:nt,isEditorReady:ot,loading:rt,_ref:ut,className:gt,wrapperProps:pt}){return Wt.createElement("section",{style:{...v.wrapper,width:ct,height:nt},...pt},!ot&&Wt.createElement($$e,null,rt),Wt.createElement("div",{ref:ut,style:{...v.fullWidth,...!ot&&v.hide},className:gt}))}var tt=Et,H=reactExports.memo(tt);function Ct(ct){reactExports.useEffect(ct,[])}var b=Ct;function ht(ct,nt,ot=!0){let rt=reactExports.useRef(!0);reactExports.useEffect(rt.current||!ot?()=>{rt.current=!1}:ct,nt)}var l=ht;function h$1(){}function R(ct,nt,ot,rt){return Dt(ct,rt)||bt(ct,nt,ot,rt)}function Dt(ct,nt){return ct.editor.getModel(et(ct,nt))}function bt(ct,nt,ot,rt){return ct.editor.createModel(nt,ot,rt?et(ct,rt):void 0)}function et(ct,nt){return ct.Uri.parse(nt)}function Ot({original:ct,modified:nt,language:ot,originalLanguage:rt,modifiedLanguage:ut,originalModelPath:gt,modifiedModelPath:pt,keepCurrentOriginalModel:mt=!1,keepCurrentModifiedModel:vt=!1,theme:St="light",loading:yt="Loading...",options:wt={},height:Lt="100%",width:xt="100%",className:It,wrapperProps:kt={},beforeMount:At=h$1,onMount:Tt=h$1}){let[Rt,Nt]=reactExports.useState(!1),[Pt,Ft]=reactExports.useState(!0),Kt=reactExports.useRef(null),Bt=reactExports.useRef(null),Ut=reactExports.useRef(null),qt=reactExports.useRef(Tt),Yt=reactExports.useRef(At),Zt=reactExports.useRef(!1);b(()=>{let rn=loader.init();return rn.then(dn=>(Bt.current=dn)&&Ft(!1)).catch(dn=>(dn==null?void 0:dn.type)!=="cancelation"&&console.error("Monaco initialization: error:",dn)),()=>Kt.current?nn():rn.cancel()}),l(()=>{let rn=Kt.current.getModifiedEditor();rn.getOption(Bt.current.editor.EditorOption.readOnly)?rn.setValue(nt||""):nt!==rn.getValue()&&(rn.executeEdits("",[{range:rn.getModel().getFullModelRange(),text:nt||"",forceMoveMarkers:!0}]),rn.pushUndoStop())},[nt],Rt),l(()=>{var rn,dn;(dn=(rn=Kt.current)==null?void 0:rn.getModel())==null||dn.original.setValue(ct||"")},[ct],Rt),l(()=>{let{original:rn,modified:dn}=Kt.current.getModel();Bt.current.editor.setModelLanguage(rn,rt||ot||"text"),Bt.current.editor.setModelLanguage(dn,ut||ot||"text")},[ot,rt,ut],Rt),l(()=>{var rn;(rn=Bt.current)==null||rn.editor.setTheme(St)},[St],Rt),l(()=>{var rn;(rn=Kt.current)==null||rn.updateOptions(wt)},[wt],Rt);let Xt=reactExports.useCallback(()=>{var bn;if(!Bt.current)return;Yt.current(Bt.current);let rn=R(Bt.current,ct||"",rt||ot||"text",gt||""),dn=R(Bt.current,nt||"",ut||ot||"text",pt||"");(bn=Kt.current)==null||bn.setModel({original:rn,modified:dn})},[ot,nt,ut,ct,rt,gt,pt]),_i=reactExports.useCallback(()=>{var rn;!Zt.current&&Ut.current&&(Kt.current=Bt.current.editor.createDiffEditor(Ut.current,{automaticLayout:!0,...wt}),Xt(),(rn=Bt.current)==null||rn.editor.setTheme(St),Nt(!0),Zt.current=!0)},[wt,St,Xt]);reactExports.useEffect(()=>{Rt&&qt.current(Kt.current,Bt.current)},[Rt]),reactExports.useEffect(()=>{!Pt&&!Rt&&_i()},[Pt,Rt,_i]),l(()=>{if(Kt.current&&Bt.current){let rn=Kt.current.getOriginalEditor(),dn=R(Bt.current,ct||"",rt||ot||"text",gt||"");dn!==rn.getModel()&&rn.setModel(dn)}},[gt],Rt),l(()=>{if(Kt.current&&Bt.current){let rn=Kt.current.getModifiedEditor(),dn=R(Bt.current,nt||"",ut||ot||"text",pt||"");dn!==rn.getModel()&&rn.setModel(dn)}},[pt],Rt);function nn(){var dn,bn,un,an;let rn=(dn=Kt.current)==null?void 0:dn.getModel();mt||((bn=rn==null?void 0:rn.original)==null||bn.dispose()),vt||((un=rn==null?void 0:rn.modified)==null||un.dispose()),(an=Kt.current)==null||an.dispose()}return Wt.createElement(H,{width:xt,height:Lt,isEditorReady:Rt,loading:yt,_ref:Ut,className:It,wrapperProps:kt})}var it=Ot;reactExports.memo(it);function Ht(ct){let nt=reactExports.useRef();return reactExports.useEffect(()=>{nt.current=ct},[ct]),nt.current}var st=Ht,_=new Map;function Vt({defaultValue:ct,defaultLanguage:nt,defaultPath:ot,value:rt,language:ut,path:gt,theme:pt="light",line:mt,loading:vt="Loading...",options:St={},overrideServices:yt={},saveViewState:wt=!0,keepCurrentModel:Lt=!1,width:xt="100%",height:It="100%",className:kt,wrapperProps:At={},beforeMount:Tt=h$1,onMount:Rt=h$1,onChange:Nt,onValidate:Pt=h$1}){let[Ft,Kt]=reactExports.useState(!1),[Bt,Ut]=reactExports.useState(!0),qt=reactExports.useRef(null),Yt=reactExports.useRef(null),Zt=reactExports.useRef(null),Xt=reactExports.useRef(Rt),_i=reactExports.useRef(Tt),nn=reactExports.useRef(),rn=reactExports.useRef(rt),dn=st(gt),bn=reactExports.useRef(!1),un=reactExports.useRef(!1);b(()=>{let _n=loader.init();return _n.then(hn=>(qt.current=hn)&&Ut(!1)).catch(hn=>(hn==null?void 0:hn.type)!=="cancelation"&&console.error("Monaco initialization: error:",hn)),()=>Yt.current?Cn():_n.cancel()}),l(()=>{var hn,pn,yn,Mn;let _n=R(qt.current,ct||rt||"",nt||ut||"",gt||ot||"");_n!==((hn=Yt.current)==null?void 0:hn.getModel())&&(wt&&_.set(dn,(pn=Yt.current)==null?void 0:pn.saveViewState()),(yn=Yt.current)==null||yn.setModel(_n),wt&&((Mn=Yt.current)==null||Mn.restoreViewState(_.get(gt))))},[gt],Ft),l(()=>{var _n;(_n=Yt.current)==null||_n.updateOptions(St)},[St],Ft),l(()=>{!Yt.current||rt===void 0||(Yt.current.getOption(qt.current.editor.EditorOption.readOnly)?Yt.current.setValue(rt):rt!==Yt.current.getValue()&&(un.current=!0,Yt.current.executeEdits("",[{range:Yt.current.getModel().getFullModelRange(),text:rt,forceMoveMarkers:!0}]),Yt.current.pushUndoStop(),un.current=!1))},[rt],Ft),l(()=>{var hn,pn;let _n=(hn=Yt.current)==null?void 0:hn.getModel();_n&&ut&&((pn=qt.current)==null||pn.editor.setModelLanguage(_n,ut))},[ut],Ft),l(()=>{var _n;mt!==void 0&&((_n=Yt.current)==null||_n.revealLine(mt))},[mt],Ft),l(()=>{var _n;(_n=qt.current)==null||_n.editor.setTheme(pt)},[pt],Ft);let an=reactExports.useCallback(()=>{var _n;if(!(!Zt.current||!qt.current)&&!bn.current){_i.current(qt.current);let hn=gt||ot,pn=R(qt.current,rt||ct||"",nt||ut||"",hn||"");Yt.current=(_n=qt.current)==null?void 0:_n.editor.create(Zt.current,{model:pn,automaticLayout:!0,...St},yt),wt&&Yt.current.restoreViewState(_.get(hn)),qt.current.editor.setTheme(pt),Kt(!0),bn.current=!0}},[ct,nt,ot,rt,ut,gt,St,yt,wt,pt]);reactExports.useEffect(()=>{Ft&&Xt.current(Yt.current,qt.current)},[Ft]),reactExports.useEffect(()=>{!Bt&&!Ft&&an()},[Bt,Ft,an]),rn.current=rt,reactExports.useEffect(()=>{var _n,hn;Ft&&Nt&&((_n=nn.current)==null||_n.dispose(),nn.current=(hn=Yt.current)==null?void 0:hn.onDidChangeModelContent(pn=>{un.current||Nt(Yt.current.getValue(),pn)}))},[Ft,Nt]),reactExports.useEffect(()=>{if(Ft){let _n=qt.current.editor.onDidChangeMarkers(hn=>{var yn;let pn=(yn=Yt.current.getModel())==null?void 0:yn.uri;if(pn&&hn.find(Mn=>Mn.path===pn.path)){let Mn=qt.current.editor.getModelMarkers({resource:pn});Pt==null||Pt(Mn)}});return()=>{_n==null||_n.dispose()}}return()=>{}},[Ft,Pt]);function Cn(){var _n,hn;(_n=nn.current)==null||_n.dispose(),Lt?wt&&_.set(gt,Yt.current.saveViewState()):(hn=Yt.current.getModel())==null||hn.dispose(),Yt.current.dispose()}return Wt.createElement(H,{width:xt,height:It,isEditorReady:Ft,loading:vt,_ref:Zt,className:kt,wrapperProps:At})}var ft=Vt,dt=reactExports.memo(ft),Fe=dt;const create$7=()=>new Map,copy=ct=>{const nt=create$7();return ct.forEach((ot,rt)=>{nt.set(rt,ot)}),nt},setIfUndefined=(ct,nt,ot)=>{let rt=ct.get(nt);return rt===void 0&&ct.set(nt,rt=ot()),rt},map$1=(ct,nt)=>{const ot=[];for(const[rt,ut]of ct)ot.push(nt(ut,rt));return ot},any=(ct,nt)=>{for(const[ot,rt]of ct)if(nt(rt,ot))return!0;return!1},create$6=()=>new Set,last=ct=>ct[ct.length-1],appendTo=(ct,nt)=>{for(let ot=0;ot<nt.length;ot++)ct.push(nt[ot])},from=Array.from,isArray=Array.isArray;class Observable{constructor(){this._observers=create$7()}on(nt,ot){setIfUndefined(this._observers,nt,create$6).add(ot)}once(nt,ot){const rt=(...ut)=>{this.off(nt,rt),ot(...ut)};this.on(nt,rt)}off(nt,ot){const rt=this._observers.get(nt);rt!==void 0&&(rt.delete(ot),rt.size===0&&this._observers.delete(nt))}emit(nt,ot){return from((this._observers.get(nt)||create$7()).values()).forEach(rt=>rt(...ot))}destroy(){this._observers=create$7()}}const floor=Math.floor,abs$1=Math.abs,log10=Math.log10,min=(ct,nt)=>ct<nt?ct:nt,max=(ct,nt)=>ct>nt?ct:nt,isNegativeZero=ct=>ct!==0?ct<0:1/ct<0,fromCharCode=String.fromCharCode,toLowerCase=ct=>ct.toLowerCase(),trimLeftRegex=/^\s*/g,trimLeft=ct=>ct.replace(trimLeftRegex,""),fromCamelCaseRegex=/([A-Z])/g,fromCamelCase=(ct,nt)=>trimLeft(ct.replace(fromCamelCaseRegex,ot=>`${nt}${toLowerCase(ot)}`)),_encodeUtf8Polyfill=ct=>{const nt=unescape(encodeURIComponent(ct)),ot=nt.length,rt=new Uint8Array(ot);for(let ut=0;ut<ot;ut++)rt[ut]=nt.codePointAt(ut);return rt},utf8TextEncoder=typeof TextEncoder<"u"?new TextEncoder:null,_encodeUtf8Native=ct=>utf8TextEncoder.encode(ct),encodeUtf8=utf8TextEncoder?_encodeUtf8Native:_encodeUtf8Polyfill;let utf8TextDecoder=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});utf8TextDecoder&&utf8TextDecoder.decode(new Uint8Array).length===1&&(utf8TextDecoder=null);const undefinedToNull=ct=>ct===void 0?null:ct;class VarStoragePolyfill{constructor(){this.map=new Map}setItem(nt,ot){this.map.set(nt,ot)}getItem(nt){return this.map.get(nt)}}let _localStorage=new VarStoragePolyfill,usePolyfill=!0;try{typeof localStorage<"u"&&(_localStorage=localStorage,usePolyfill=!1)}catch{}const varStorage=_localStorage,onChange=ct=>usePolyfill||addEventListener("storage",ct),offChange=ct=>usePolyfill||removeEventListener("storage",ct),assign=Object.assign,keys=Object.keys,forEach=(ct,nt)=>{for(const ot in ct)nt(ct[ot],ot)},length$3=ct=>keys(ct).length,isEmpty=ct=>{for(const nt in ct)return!1;return!0},every=(ct,nt)=>{for(const ot in ct)if(!nt(ct[ot],ot))return!1;return!0},hasProperty=(ct,nt)=>Object.prototype.hasOwnProperty.call(ct,nt),equalFlat=(ct,nt)=>ct===nt||length$3(ct)===length$3(nt)&&every(ct,(ot,rt)=>(ot!==void 0||hasProperty(nt,rt))&&nt[rt]===ot),callAll=(ct,nt,ot=0)=>{try{for(;ot<ct.length;ot++)ct[ot](...nt)}finally{ot<ct.length&&callAll(ct,nt,ot+1)}},nop=()=>{},id=ct=>ct,equalityStrict=(ct,nt)=>ct===nt,equalityDeep=(ct,nt)=>{if(ct==null||nt==null)return equalityStrict(ct,nt);if(ct.constructor!==nt.constructor)return!1;if(ct===nt)return!0;switch(ct.constructor){case ArrayBuffer:ct=new Uint8Array(ct),nt=new Uint8Array(nt);case Uint8Array:{if(ct.byteLength!==nt.byteLength)return!1;for(let ot=0;ot<ct.length;ot++)if(ct[ot]!==nt[ot])return!1;break}case Set:{if(ct.size!==nt.size)return!1;for(const ot of ct)if(!nt.has(ot))return!1;break}case Map:{if(ct.size!==nt.size)return!1;for(const ot of ct.keys())if(!nt.has(ot)||!equalityDeep(ct.get(ot),nt.get(ot)))return!1;break}case Object:if(length$3(ct)!==length$3(nt))return!1;for(const ot in ct)if(!hasProperty(ct,ot)||!equalityDeep(ct[ot],nt[ot]))return!1;break;case Array:if(ct.length!==nt.length)return!1;for(let ot=0;ot<ct.length;ot++)if(!equalityDeep(ct[ot],nt[ot]))return!1;break;default:return!1}return!0},isOneOf=(ct,nt)=>nt.includes(ct),isNode=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name),isBrowser=typeof window<"u"&&typeof document<"u"&&!isNode;let params;const computeParams=()=>{if(params===void 0)if(isNode){params=create$7();const ct=process.argv;let nt=null;for(let ot=0;ot<ct.length;ot++){const rt=ct[ot];rt[0]==="-"?(nt!==null&&params.set(nt,""),nt=rt):nt!==null&&(params.set(nt,rt),nt=null)}nt!==null&&params.set(nt,"")}else typeof location=="object"?(params=create$7(),(location.search||"?").slice(1).split("&").forEach(ct=>{if(ct.length!==0){const[nt,ot]=ct.split("=");params.set(`--${fromCamelCase(nt,"-")}`,ot),params.set(`-${fromCamelCase(nt,"-")}`,ot)}})):params=create$7();return params},hasParam=ct=>computeParams().has(ct),getVariable=ct=>undefinedToNull(isNode?process.env[ct.toUpperCase()]:varStorage.getItem(ct)),hasConf=ct=>hasParam("--"+ct)||getVariable(ct)!==null;hasConf("production");const forceColor=isNode&&isOneOf({}.FORCE_COLOR,["true","1","2"]),supportsColor=!hasParam("no-colors")&&(!isNode||process.stdout.isTTY||forceColor)&&(!isNode||hasParam("color")||forceColor||getVariable("COLORTERM")!==null||(getVariable("TERM")||"").includes("color")),BIT1=1,BIT2=2,BIT3=4,BIT4=8,BIT6=32,BIT7=64,BIT8=128,BITS5=31,BITS6=63,BITS7=127,BITS31=2147483647,MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER,isInteger=Number.isInteger||(ct=>typeof ct=="number"&&isFinite(ct)&&floor(ct)===ct),create$5=ct=>new Error(ct),methodUnimplemented=()=>{throw create$5("Method unimplemented")},unexpectedCase=()=>{throw create$5("Unexpected case")},errorUnexpectedEndOfArray=create$5("Unexpected end of array"),errorIntegerOutOfRange=create$5("Integer out of Range");let Decoder$1=class{constructor(nt){this.arr=nt,this.pos=0}};const createDecoder=ct=>new Decoder$1(ct),hasContent=ct=>ct.pos!==ct.arr.length,readUint8Array=(ct,nt)=>{const ot=createUint8ArrayViewFromArrayBuffer(ct.arr.buffer,ct.pos+ct.arr.byteOffset,nt);return ct.pos+=nt,ot},readVarUint8Array=ct=>readUint8Array(ct,readVarUint(ct)),readUint8=ct=>ct.arr[ct.pos++],readVarUint=ct=>{let nt=0,ot=1;const rt=ct.arr.length;for(;ct.pos<rt;){const ut=ct.arr[ct.pos++];if(nt=nt+(ut&BITS7)*ot,ot*=128,ut<BIT8)return nt;if(nt>MAX_SAFE_INTEGER)throw errorIntegerOutOfRange}throw errorUnexpectedEndOfArray},readVarInt=ct=>{let nt=ct.arr[ct.pos++],ot=nt&BITS6,rt=64;const ut=(nt&BIT7)>0?-1:1;if(!(nt&BIT8))return ut*ot;const gt=ct.arr.length;for(;ct.pos<gt;){if(nt=ct.arr[ct.pos++],ot=ot+(nt&BITS7)*rt,rt*=128,nt<BIT8)return ut*ot;if(ot>MAX_SAFE_INTEGER)throw errorIntegerOutOfRange}throw errorUnexpectedEndOfArray},_readVarStringPolyfill=ct=>{let nt=readVarUint(ct);if(nt===0)return"";{let ot=String.fromCodePoint(readUint8(ct));if(--nt<100)for(;nt--;)ot+=String.fromCodePoint(readUint8(ct));else for(;nt>0;){const rt=nt<1e4?nt:1e4,ut=ct.arr.subarray(ct.pos,ct.pos+rt);ct.pos+=rt,ot+=String.fromCodePoint.apply(null,ut),nt-=rt}return decodeURIComponent(escape(ot))}},_readVarStringNative=ct=>utf8TextDecoder.decode(readVarUint8Array(ct)),readVarString=utf8TextDecoder?_readVarStringNative:_readVarStringPolyfill,readFromDataView=(ct,nt)=>{const ot=new DataView(ct.arr.buffer,ct.arr.byteOffset+ct.pos,nt);return ct.pos+=nt,ot},readFloat32=ct=>readFromDataView(ct,4).getFloat32(0,!1),readFloat64=ct=>readFromDataView(ct,8).getFloat64(0,!1),readBigInt64=ct=>readFromDataView(ct,8).getBigInt64(0,!1),readAnyLookupTable=[ct=>{},ct=>null,readVarInt,readFloat32,readFloat64,readBigInt64,ct=>!1,ct=>!0,readVarString,ct=>{const nt=readVarUint(ct),ot={};for(let rt=0;rt<nt;rt++){const ut=readVarString(ct);ot[ut]=readAny(ct)}return ot},ct=>{const nt=readVarUint(ct),ot=[];for(let rt=0;rt<nt;rt++)ot.push(readAny(ct));return ot},readVarUint8Array],readAny=ct=>readAnyLookupTable[127-readUint8(ct)](ct);class RleDecoder extends Decoder$1{constructor(nt,ot){super(nt),this.reader=ot,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),hasContent(this)?this.count=readVarUint(this)+1:this.count=-1),this.count--,this.s}}class UintOptRleDecoder extends Decoder$1{constructor(nt){super(nt),this.s=0,this.count=0}read(){if(this.count===0){this.s=readVarInt(this);const nt=isNegativeZero(this.s);this.count=1,nt&&(this.s=-this.s,this.count=readVarUint(this)+2)}return this.count--,this.s}}class IntDiffOptRleDecoder extends Decoder$1{constructor(nt){super(nt),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const nt=readVarInt(this),ot=nt&1;this.diff=floor(nt/2),this.count=1,ot&&(this.count=readVarUint(this)+2)}return this.s+=this.diff,this.count--,this.s}}class StringDecoder{constructor(nt){this.decoder=new UintOptRleDecoder(nt),this.str=readVarString(this.decoder),this.spos=0}read(){const nt=this.spos+this.decoder.read(),ot=this.str.slice(this.spos,nt);return this.spos=nt,ot}}const createUint8ArrayFromLen=ct=>new Uint8Array(ct),createUint8ArrayViewFromArrayBuffer=(ct,nt,ot)=>new Uint8Array(ct,nt,ot),createUint8ArrayFromArrayBuffer=ct=>new Uint8Array(ct),toBase64Browser=ct=>{let nt="";for(let ot=0;ot<ct.byteLength;ot++)nt+=fromCharCode(ct[ot]);return btoa(nt)},toBase64Node=ct=>Buffer.from(ct.buffer,ct.byteOffset,ct.byteLength).toString("base64"),fromBase64Browser=ct=>{const nt=atob(ct),ot=createUint8ArrayFromLen(nt.length);for(let rt=0;rt<nt.length;rt++)ot[rt]=nt.charCodeAt(rt);return ot},fromBase64Node=ct=>{const nt=Buffer.from(ct,"base64");return new Uint8Array(nt.buffer,nt.byteOffset,nt.byteLength)},toBase64=isBrowser?toBase64Browser:toBase64Node,fromBase64=isBrowser?fromBase64Browser:fromBase64Node,copyUint8Array=ct=>{const nt=createUint8ArrayFromLen(ct.byteLength);return nt.set(ct),nt};let Encoder$1=class{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}};const createEncoder=()=>new Encoder$1,length$2=ct=>{let nt=ct.cpos;for(let ot=0;ot<ct.bufs.length;ot++)nt+=ct.bufs[ot].length;return nt},toUint8Array=ct=>{const nt=new Uint8Array(length$2(ct));let ot=0;for(let rt=0;rt<ct.bufs.length;rt++){const ut=ct.bufs[rt];nt.set(ut,ot),ot+=ut.length}return nt.set(createUint8ArrayViewFromArrayBuffer(ct.cbuf.buffer,0,ct.cpos),ot),nt},verifyLen=(ct,nt)=>{const ot=ct.cbuf.length;ot-ct.cpos<nt&&(ct.bufs.push(createUint8ArrayViewFromArrayBuffer(ct.cbuf.buffer,0,ct.cpos)),ct.cbuf=new Uint8Array(max(ot,nt)*2),ct.cpos=0)},write=(ct,nt)=>{const ot=ct.cbuf.length;ct.cpos===ot&&(ct.bufs.push(ct.cbuf),ct.cbuf=new Uint8Array(ot*2),ct.cpos=0),ct.cbuf[ct.cpos++]=nt},writeUint8=write,writeVarUint=(ct,nt)=>{for(;nt>BITS7;)write(ct,BIT8|BITS7&nt),nt=floor(nt/128);write(ct,BITS7&nt)},writeVarInt=(ct,nt)=>{const ot=isNegativeZero(nt);for(ot&&(nt=-nt),write(ct,(nt>BITS6?BIT8:0)|(ot?BIT7:0)|BITS6&nt),nt=floor(nt/64);nt>0;)write(ct,(nt>BITS7?BIT8:0)|BITS7&nt),nt=floor(nt/128)},_strBuffer=new Uint8Array(3e4),_maxStrBSize=_strBuffer.length/3,_writeVarStringNative=(ct,nt)=>{if(nt.length<_maxStrBSize){const ot=utf8TextEncoder.encodeInto(nt,_strBuffer).written||0;writeVarUint(ct,ot);for(let rt=0;rt<ot;rt++)write(ct,_strBuffer[rt])}else writeVarUint8Array(ct,encodeUtf8(nt))},_writeVarStringPolyfill=(ct,nt)=>{const ot=unescape(encodeURIComponent(nt)),rt=ot.length;writeVarUint(ct,rt);for(let ut=0;ut<rt;ut++)write(ct,ot.codePointAt(ut))},writeVarString=utf8TextEncoder&&utf8TextEncoder.encodeInto?_writeVarStringNative:_writeVarStringPolyfill,writeUint8Array=(ct,nt)=>{const ot=ct.cbuf.length,rt=ct.cpos,ut=min(ot-rt,nt.length),gt=nt.length-ut;ct.cbuf.set(nt.subarray(0,ut),rt),ct.cpos+=ut,gt>0&&(ct.bufs.push(ct.cbuf),ct.cbuf=new Uint8Array(max(ot*2,gt)),ct.cbuf.set(nt.subarray(ut)),ct.cpos=gt)},writeVarUint8Array=(ct,nt)=>{writeVarUint(ct,nt.byteLength),writeUint8Array(ct,nt)},writeOnDataView=(ct,nt)=>{verifyLen(ct,nt);const ot=new DataView(ct.cbuf.buffer,ct.cpos,nt);return ct.cpos+=nt,ot},writeFloat32=(ct,nt)=>writeOnDataView(ct,4).setFloat32(0,nt,!1),writeFloat64=(ct,nt)=>writeOnDataView(ct,8).setFloat64(0,nt,!1),writeBigInt64=(ct,nt)=>writeOnDataView(ct,8).setBigInt64(0,nt,!1),floatTestBed=new DataView(new ArrayBuffer(4)),isFloat32=ct=>(floatTestBed.setFloat32(0,ct),floatTestBed.getFloat32(0)===ct),writeAny=(ct,nt)=>{switch(typeof nt){case"string":write(ct,119),writeVarString(ct,nt);break;case"number":isInteger(nt)&&abs$1(nt)<=BITS31?(write(ct,125),writeVarInt(ct,nt)):isFloat32(nt)?(write(ct,124),writeFloat32(ct,nt)):(write(ct,123),writeFloat64(ct,nt));break;case"bigint":write(ct,122),writeBigInt64(ct,nt);break;case"object":if(nt===null)write(ct,126);else if(isArray(nt)){write(ct,117),writeVarUint(ct,nt.length);for(let ot=0;ot<nt.length;ot++)writeAny(ct,nt[ot])}else if(nt instanceof Uint8Array)write(ct,116),writeVarUint8Array(ct,nt);else{write(ct,118);const ot=Object.keys(nt);writeVarUint(ct,ot.length);for(let rt=0;rt<ot.length;rt++){const ut=ot[rt];writeVarString(ct,ut),writeAny(ct,nt[ut])}}break;case"boolean":write(ct,nt?120:121);break;default:write(ct,127)}};class RleEncoder extends Encoder$1{constructor(nt){super(),this.w=nt,this.s=null,this.count=0}write(nt){this.s===nt?this.count++:(this.count>0&&writeVarUint(this,this.count-1),this.count=1,this.w(this,nt),this.s=nt)}}const flushUintOptRleEncoder=ct=>{ct.count>0&&(writeVarInt(ct.encoder,ct.count===1?ct.s:-ct.s),ct.count>1&&writeVarUint(ct.encoder,ct.count-2))};class UintOptRleEncoder{constructor(){this.encoder=new Encoder$1,this.s=0,this.count=0}write(nt){this.s===nt?this.count++:(flushUintOptRleEncoder(this),this.count=1,this.s=nt)}toUint8Array(){return flushUintOptRleEncoder(this),toUint8Array(this.encoder)}}const flushIntDiffOptRleEncoder=ct=>{if(ct.count>0){const nt=ct.diff*2+(ct.count===1?0:1);writeVarInt(ct.encoder,nt),ct.count>1&&writeVarUint(ct.encoder,ct.count-2)}};class IntDiffOptRleEncoder{constructor(){this.encoder=new Encoder$1,this.s=0,this.count=0,this.diff=0}write(nt){this.diff===nt-this.s?(this.s=nt,this.count++):(flushIntDiffOptRleEncoder(this),this.count=1,this.diff=nt-this.s,this.s=nt)}toUint8Array(){return flushIntDiffOptRleEncoder(this),toUint8Array(this.encoder)}}class StringEncoder{constructor(){this.sarr=[],this.s="",this.lensE=new UintOptRleEncoder}write(nt){this.s+=nt,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(nt.length)}toUint8Array(){const nt=new Encoder$1;return this.sarr.push(this.s),this.s="",writeVarString(nt,this.sarr.join("")),writeUint8Array(nt,this.lensE.toUint8Array()),toUint8Array(nt)}}const getRandomValues=crypto.getRandomValues.bind(crypto),rand=Math.random,uint32=()=>getRandomValues(new Uint32Array(1))[0],uuidv4Template=[1e7]+-1e3+-4e3+-8e3+-1e11,uuidv4=()=>uuidv4Template.replace(/[018]/g,ct=>(ct^uint32()&15>>ct/4).toString(16)),getUnixTime=Date.now,create$4=ct=>new Promise(ct);Promise.all.bind(Promise);const reject=ct=>Promise.reject(ct),resolve$1=ct=>Promise.resolve(ct);class Pair{constructor(nt,ot){this.left=nt,this.right=ot}}const create$3=(ct,nt)=>new Pair(ct,nt);typeof DOMParser<"u"&&new DOMParser;const mapToStyleString=ct=>map$1(ct,(nt,ot)=>`${ot}:${nt};`).join(""),create$2=Symbol,BOLD=create$2(),UNBOLD=create$2(),BLUE=create$2(),GREY=create$2(),GREEN=create$2(),RED=create$2(),PURPLE=create$2(),ORANGE=create$2(),UNCOLOR=create$2(),computeNoColorLoggingArgs=ct=>{const nt=[];let ot=0;for(;ot<ct.length;ot++){const rt=ct[ot];rt.constructor===String||rt.constructor===Number||rt.constructor===Object&&nt.push(JSON.stringify(rt))}return nt},loggingColors=[GREEN,PURPLE,ORANGE,BLUE];let nextColor=0,lastLoggingTime=getUnixTime();const createModuleLogger$1=(ct,nt)=>{const ot=loggingColors[nextColor],rt=getVariable("log"),ut=rt!==null&&(rt==="*"||rt==="true"||new RegExp(rt,"gi").test(nt));return nextColor=(nextColor+1)%loggingColors.length,nt+=": ",ut?(...gt)=>{const pt=getUnixTime(),mt=pt-lastLoggingTime;lastLoggingTime=pt,ct(ot,nt,UNCOLOR,...gt.map(vt=>typeof vt=="string"||typeof vt=="symbol"?vt:JSON.stringify(vt)),ot," +"+mt+"ms")}:nop},_browserStyleMap={[BOLD]:create$3("font-weight","bold"),[UNBOLD]:create$3("font-weight","normal"),[BLUE]:create$3("color","blue"),[GREEN]:create$3("color","green"),[GREY]:create$3("color","grey"),[RED]:create$3("color","red"),[PURPLE]:create$3("color","purple"),[ORANGE]:create$3("color","orange"),[UNCOLOR]:create$3("color","black")},computeBrowserLoggingArgs=ct=>{const nt=[],ot=[],rt=create$7();let ut=[],gt=0;for(;gt<ct.length;gt++){const pt=ct[gt],mt=_browserStyleMap[pt];if(mt!==void 0)rt.set(mt.left,mt.right);else if(pt.constructor===String||pt.constructor===Number){const vt=mapToStyleString(rt);gt>0||vt.length>0?(nt.push("%c"+pt),ot.push(vt)):nt.push(pt)}else break}for(gt>0&&(ut=ot,ut.unshift(nt.join("")));gt<ct.length;gt++){const pt=ct[gt];pt instanceof Symbol||ut.push(pt)}return ut},computeLoggingArgs=supportsColor?computeBrowserLoggingArgs:computeNoColorLoggingArgs,print=(...ct)=>{console.log(...computeLoggingArgs(ct)),vconsoles.forEach(nt=>nt.print(ct))},vconsoles=create$6(),createModuleLogger=ct=>createModuleLogger$1(print,ct),createIterator=ct=>({[Symbol.iterator](){return this},next:ct}),iteratorFilter=(ct,nt)=>createIterator(()=>{let ot;do ot=ct.next();while(!ot.done&&!nt(ot.value));return ot}),iteratorMap=(ct,nt)=>createIterator(()=>{const{done:ot,value:rt}=ct.next();return{done:ot,value:ot?void 0:nt(rt)}});class DeleteItem{constructor(nt,ot){this.clock=nt,this.len=ot}}class DeleteSet{constructor(){this.clients=new Map}}const iterateDeletedStructs=(ct,nt,ot)=>nt.clients.forEach((rt,ut)=>{const gt=ct.doc.store.clients.get(ut);for(let pt=0;pt<rt.length;pt++){const mt=rt[pt];iterateStructs(ct,gt,mt.clock,mt.len,ot)}}),findIndexDS=(ct,nt)=>{let ot=0,rt=ct.length-1;for(;ot<=rt;){const ut=floor((ot+rt)/2),gt=ct[ut],pt=gt.clock;if(pt<=nt){if(nt<pt+gt.len)return ut;ot=ut+1}else rt=ut-1}return null},isDeleted=(ct,nt)=>{const ot=ct.clients.get(nt.client);return ot!==void 0&&findIndexDS(ot,nt.clock)!==null},sortAndMergeDeleteSet=ct=>{ct.clients.forEach(nt=>{nt.sort((ut,gt)=>ut.clock-gt.clock);let ot,rt;for(ot=1,rt=1;ot<nt.length;ot++){const ut=nt[rt-1],gt=nt[ot];ut.clock+ut.len>=gt.clock?ut.len=max(ut.len,gt.clock+gt.len-ut.clock):(rt<ot&&(nt[rt]=gt),rt++)}nt.length=rt})},mergeDeleteSets=ct=>{const nt=new DeleteSet;for(let ot=0;ot<ct.length;ot++)ct[ot].clients.forEach((rt,ut)=>{if(!nt.clients.has(ut)){const gt=rt.slice();for(let pt=ot+1;pt<ct.length;pt++)appendTo(gt,ct[pt].clients.get(ut)||[]);nt.clients.set(ut,gt)}});return sortAndMergeDeleteSet(nt),nt},addToDeleteSet=(ct,nt,ot,rt)=>{setIfUndefined(ct.clients,nt,()=>[]).push(new DeleteItem(ot,rt))},createDeleteSet=()=>new DeleteSet,createDeleteSetFromStructStore=ct=>{const nt=createDeleteSet();return ct.clients.forEach((ot,rt)=>{const ut=[];for(let gt=0;gt<ot.length;gt++){const pt=ot[gt];if(pt.deleted){const mt=pt.id.clock;let vt=pt.length;if(gt+1<ot.length)for(let St=ot[gt+1];gt+1<ot.length&&St.deleted;St=ot[++gt+1])vt+=St.length;ut.push(new DeleteItem(mt,vt))}}ut.length>0&&nt.clients.set(rt,ut)}),nt},writeDeleteSet=(ct,nt)=>{writeVarUint(ct.restEncoder,nt.clients.size),from(nt.clients.entries()).sort((ot,rt)=>rt[0]-ot[0]).forEach(([ot,rt])=>{ct.resetDsCurVal(),writeVarUint(ct.restEncoder,ot);const ut=rt.length;writeVarUint(ct.restEncoder,ut);for(let gt=0;gt<ut;gt++){const pt=rt[gt];ct.writeDsClock(pt.clock),ct.writeDsLen(pt.len)}})},readDeleteSet=ct=>{const nt=new DeleteSet,ot=readVarUint(ct.restDecoder);for(let rt=0;rt<ot;rt++){ct.resetDsCurVal();const ut=readVarUint(ct.restDecoder),gt=readVarUint(ct.restDecoder);if(gt>0){const pt=setIfUndefined(nt.clients,ut,()=>[]);for(let mt=0;mt<gt;mt++)pt.push(new DeleteItem(ct.readDsClock(),ct.readDsLen()))}}return nt},readAndApplyDeleteSet=(ct,nt,ot)=>{const rt=new DeleteSet,ut=readVarUint(ct.restDecoder);for(let gt=0;gt<ut;gt++){ct.resetDsCurVal();const pt=readVarUint(ct.restDecoder),mt=readVarUint(ct.restDecoder),vt=ot.clients.get(pt)||[],St=getState(ot,pt);for(let yt=0;yt<mt;yt++){const wt=ct.readDsClock(),Lt=wt+ct.readDsLen();if(wt<St){St<Lt&&addToDeleteSet(rt,pt,St,Lt-St);let xt=findIndexSS(vt,wt),It=vt[xt];for(!It.deleted&&It.id.clock<wt&&(vt.splice(xt+1,0,splitItem(nt,It,wt-It.id.clock)),xt++);xt<vt.length&&(It=vt[xt++],It.id.clock<Lt);)It.deleted||(Lt<It.id.clock+It.length&&vt.splice(xt,0,splitItem(nt,It,Lt-It.id.clock)),It.delete(nt))}else addToDeleteSet(rt,pt,wt,Lt-wt)}}if(rt.clients.size>0){const gt=new UpdateEncoderV2;return writeVarUint(gt.restEncoder,0),writeDeleteSet(gt,rt),gt.toUint8Array()}return null},generateNewClientId=uint32;class Doc extends Observable{constructor({guid:nt=uuidv4(),collectionid:ot=null,gc:rt=!0,gcFilter:ut=()=>!0,meta:gt=null,autoLoad:pt=!1,shouldLoad:mt=!0}={}){super(),this.gc=rt,this.gcFilter=ut,this.clientID=generateNewClientId(),this.guid=nt,this.collectionid=ot,this.share=new Map,this.store=new StructStore,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=mt,this.autoLoad=pt,this.meta=gt,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=create$4(St=>{this.on("load",()=>{this.isLoaded=!0,St(this)})});const vt=()=>create$4(St=>{const yt=wt=>{(wt===void 0||wt===!0)&&(this.off("sync",yt),St())};this.on("sync",yt)});this.on("sync",St=>{St===!1&&this.isSynced&&(this.whenSynced=vt()),this.isSynced=St===void 0||St===!0,this.isLoaded||this.emit("load",[])}),this.whenSynced=vt()}load(){const nt=this._item;nt!==null&&!this.shouldLoad&&transact(nt.parent.doc,ot=>{ot.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(from(this.subdocs).map(nt=>nt.guid))}transact(nt,ot=null){return transact(this,nt,ot)}get(nt,ot=AbstractType){const rt=setIfUndefined(this.share,nt,()=>{const gt=new ot;return gt._integrate(this,null),gt}),ut=rt.constructor;if(ot!==AbstractType&&ut!==ot)if(ut===AbstractType){const gt=new ot;gt._map=rt._map,rt._map.forEach(pt=>{for(;pt!==null;pt=pt.left)pt.parent=gt}),gt._start=rt._start;for(let pt=gt._start;pt!==null;pt=pt.right)pt.parent=gt;return gt._length=rt._length,this.share.set(nt,gt),gt._integrate(this,null),gt}else throw new Error(`Type with the name ${nt} has already been defined with a different constructor`);return rt}getArray(nt=""){return this.get(nt,YArray)}getText(nt=""){return this.get(nt,YText)}getMap(nt=""){return this.get(nt,YMap)}getXmlFragment(nt=""){return this.get(nt,YXmlFragment)}toJSON(){const nt={};return this.share.forEach((ot,rt)=>{nt[rt]=ot.toJSON()}),nt}destroy(){from(this.subdocs).forEach(ot=>ot.destroy());const nt=this._item;if(nt!==null){this._item=null;const ot=nt.content;ot.doc=new Doc({guid:this.guid,...ot.opts,shouldLoad:!1}),ot.doc._item=nt,transact(nt.parent.doc,rt=>{const ut=ot.doc;nt.deleted||rt.subdocsAdded.add(ut),rt.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(nt,ot){super.on(nt,ot)}off(nt,ot){super.off(nt,ot)}}class DSDecoderV1{constructor(nt){this.restDecoder=nt}resetDsCurVal(){}readDsClock(){return readVarUint(this.restDecoder)}readDsLen(){return readVarUint(this.restDecoder)}}class UpdateDecoderV1 extends DSDecoderV1{readLeftID(){return createID(readVarUint(this.restDecoder),readVarUint(this.restDecoder))}readRightID(){return createID(readVarUint(this.restDecoder),readVarUint(this.restDecoder))}readClient(){return readVarUint(this.restDecoder)}readInfo(){return readUint8(this.restDecoder)}readString(){return readVarString(this.restDecoder)}readParentInfo(){return readVarUint(this.restDecoder)===1}readTypeRef(){return readVarUint(this.restDecoder)}readLen(){return readVarUint(this.restDecoder)}readAny(){return readAny(this.restDecoder)}readBuf(){return copyUint8Array(readVarUint8Array(this.restDecoder))}readJSON(){return JSON.parse(readVarString(this.restDecoder))}readKey(){return readVarString(this.restDecoder)}}class DSDecoderV2{constructor(nt){this.dsCurrVal=0,this.restDecoder=nt}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=readVarUint(this.restDecoder),this.dsCurrVal}readDsLen(){const nt=readVarUint(this.restDecoder)+1;return this.dsCurrVal+=nt,nt}}class UpdateDecoderV2 extends DSDecoderV2{constructor(nt){super(nt),this.keys=[],readVarUint(nt),this.keyClockDecoder=new IntDiffOptRleDecoder(readVarUint8Array(nt)),this.clientDecoder=new UintOptRleDecoder(readVarUint8Array(nt)),this.leftClockDecoder=new IntDiffOptRleDecoder(readVarUint8Array(nt)),this.rightClockDecoder=new IntDiffOptRleDecoder(readVarUint8Array(nt)),this.infoDecoder=new RleDecoder(readVarUint8Array(nt),readUint8),this.stringDecoder=new StringDecoder(readVarUint8Array(nt)),this.parentInfoDecoder=new RleDecoder(readVarUint8Array(nt),readUint8),this.typeRefDecoder=new UintOptRleDecoder(readVarUint8Array(nt)),this.lenDecoder=new UintOptRleDecoder(readVarUint8Array(nt))}readLeftID(){return new ID(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new ID(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return readAny(this.restDecoder)}readBuf(){return readVarUint8Array(this.restDecoder)}readJSON(){return readAny(this.restDecoder)}readKey(){const nt=this.keyClockDecoder.read();if(nt<this.keys.length)return this.keys[nt];{const ot=this.stringDecoder.read();return this.keys.push(ot),ot}}}class DSEncoderV1{constructor(){this.restEncoder=createEncoder()}toUint8Array(){return toUint8Array(this.restEncoder)}resetDsCurVal(){}writeDsClock(nt){writeVarUint(this.restEncoder,nt)}writeDsLen(nt){writeVarUint(this.restEncoder,nt)}}class UpdateEncoderV1 extends DSEncoderV1{writeLeftID(nt){writeVarUint(this.restEncoder,nt.client),writeVarUint(this.restEncoder,nt.clock)}writeRightID(nt){writeVarUint(this.restEncoder,nt.client),writeVarUint(this.restEncoder,nt.clock)}writeClient(nt){writeVarUint(this.restEncoder,nt)}writeInfo(nt){writeUint8(this.restEncoder,nt)}writeString(nt){writeVarString(this.restEncoder,nt)}writeParentInfo(nt){writeVarUint(this.restEncoder,nt?1:0)}writeTypeRef(nt){writeVarUint(this.restEncoder,nt)}writeLen(nt){writeVarUint(this.restEncoder,nt)}writeAny(nt){writeAny(this.restEncoder,nt)}writeBuf(nt){writeVarUint8Array(this.restEncoder,nt)}writeJSON(nt){writeVarString(this.restEncoder,JSON.stringify(nt))}writeKey(nt){writeVarString(this.restEncoder,nt)}}class DSEncoderV2{constructor(){this.restEncoder=createEncoder(),this.dsCurrVal=0}toUint8Array(){return toUint8Array(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(nt){const ot=nt-this.dsCurrVal;this.dsCurrVal=nt,writeVarUint(this.restEncoder,ot)}writeDsLen(nt){nt===0&&unexpectedCase(),writeVarUint(this.restEncoder,nt-1),this.dsCurrVal+=nt}}class UpdateEncoderV2 extends DSEncoderV2{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new IntDiffOptRleEncoder,this.clientEncoder=new UintOptRleEncoder,this.leftClockEncoder=new IntDiffOptRleEncoder,this.rightClockEncoder=new IntDiffOptRleEncoder,this.infoEncoder=new RleEncoder(writeUint8),this.stringEncoder=new StringEncoder,this.parentInfoEncoder=new RleEncoder(writeUint8),this.typeRefEncoder=new UintOptRleEncoder,this.lenEncoder=new UintOptRleEncoder}toUint8Array(){const nt=createEncoder();return writeVarUint(nt,0),writeVarUint8Array(nt,this.keyClockEncoder.toUint8Array()),writeVarUint8Array(nt,this.clientEncoder.toUint8Array()),writeVarUint8Array(nt,this.leftClockEncoder.toUint8Array()),writeVarUint8Array(nt,this.rightClockEncoder.toUint8Array()),writeVarUint8Array(nt,toUint8Array(this.infoEncoder)),writeVarUint8Array(nt,this.stringEncoder.toUint8Array()),writeVarUint8Array(nt,toUint8Array(this.parentInfoEncoder)),writeVarUint8Array(nt,this.typeRefEncoder.toUint8Array()),writeVarUint8Array(nt,this.lenEncoder.toUint8Array()),writeUint8Array(nt,toUint8Array(this.restEncoder)),toUint8Array(nt)}writeLeftID(nt){this.clientEncoder.write(nt.client),this.leftClockEncoder.write(nt.clock)}writeRightID(nt){this.clientEncoder.write(nt.client),this.rightClockEncoder.write(nt.clock)}writeClient(nt){this.clientEncoder.write(nt)}writeInfo(nt){this.infoEncoder.write(nt)}writeString(nt){this.stringEncoder.write(nt)}writeParentInfo(nt){this.parentInfoEncoder.write(nt?1:0)}writeTypeRef(nt){this.typeRefEncoder.write(nt)}writeLen(nt){this.lenEncoder.write(nt)}writeAny(nt){writeAny(this.restEncoder,nt)}writeBuf(nt){writeVarUint8Array(this.restEncoder,nt)}writeJSON(nt){writeAny(this.restEncoder,nt)}writeKey(nt){const ot=this.keyMap.get(nt);ot===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(nt)):this.keyClockEncoder.write(ot)}}const writeStructs=(ct,nt,ot,rt)=>{rt=max(rt,nt[0].id.clock);const ut=findIndexSS(nt,rt);writeVarUint(ct.restEncoder,nt.length-ut),ct.writeClient(ot),writeVarUint(ct.restEncoder,rt);const gt=nt[ut];gt.write(ct,rt-gt.id.clock);for(let pt=ut+1;pt<nt.length;pt++)nt[pt].write(ct,0)},writeClientsStructs=(ct,nt,ot)=>{const rt=new Map;ot.forEach((ut,gt)=>{getState(nt,gt)>ut&&rt.set(gt,ut)}),getStateVector(nt).forEach((ut,gt)=>{ot.has(gt)||rt.set(gt,0)}),writeVarUint(ct.restEncoder,rt.size),from(rt.entries()).sort((ut,gt)=>gt[0]-ut[0]).forEach(([ut,gt])=>{writeStructs(ct,nt.clients.get(ut),ut,gt)})},readClientsStructRefs=(ct,nt)=>{const ot=create$7(),rt=readVarUint(ct.restDecoder);for(let ut=0;ut<rt;ut++){const gt=readVarUint(ct.restDecoder),pt=new Array(gt),mt=ct.readClient();let vt=readVarUint(ct.restDecoder);ot.set(mt,{i:0,refs:pt});for(let St=0;St<gt;St++){const yt=ct.readInfo();switch(BITS5&yt){case 0:{const wt=ct.readLen();pt[St]=new GC(createID(mt,vt),wt),vt+=wt;break}case 10:{const wt=readVarUint(ct.restDecoder);pt[St]=new Skip(createID(mt,vt),wt),vt+=wt;break}default:{const wt=(yt&(BIT7|BIT8))===0,Lt=new Item(createID(mt,vt),null,(yt&BIT8)===BIT8?ct.readLeftID():null,null,(yt&BIT7)===BIT7?ct.readRightID():null,wt?ct.readParentInfo()?nt.get(ct.readString()):ct.readLeftID():null,wt&&(yt&BIT6)===BIT6?ct.readString():null,readItemContent(ct,yt));pt[St]=Lt,vt+=Lt.length}}}}return ot},integrateStructs=(ct,nt,ot)=>{const rt=[];let ut=from(ot.keys()).sort((xt,It)=>xt-It);if(ut.length===0)return null;const gt=()=>{if(ut.length===0)return null;let xt=ot.get(ut[ut.length-1]);for(;xt.refs.length===xt.i;)if(ut.pop(),ut.length>0)xt=ot.get(ut[ut.length-1]);else return null;return xt};let pt=gt();if(pt===null&&rt.length===0)return null;const mt=new StructStore,vt=new Map,St=(xt,It)=>{const kt=vt.get(xt);(kt==null||kt>It)&&vt.set(xt,It)};let yt=pt.refs[pt.i++];const wt=new Map,Lt=()=>{for(const xt of rt){const It=xt.id.client,kt=ot.get(It);kt?(kt.i--,mt.clients.set(It,kt.refs.slice(kt.i)),ot.delete(It),kt.i=0,kt.refs=[]):mt.clients.set(It,[xt]),ut=ut.filter(At=>At!==It)}rt.length=0};for(;;){if(yt.constructor!==Skip){const It=setIfUndefined(wt,yt.id.client,()=>getState(nt,yt.id.client))-yt.id.clock;if(It<0)rt.push(yt),St(yt.id.client,yt.id.clock-1),Lt();else{const kt=yt.getMissing(ct,nt);if(kt!==null){rt.push(yt);const At=ot.get(kt)||{refs:[],i:0};if(At.refs.length===At.i)St(kt,getState(nt,kt)),Lt();else{yt=At.refs[At.i++];continue}}else(It===0||It<yt.length)&&(yt.integrate(ct,It),wt.set(yt.id.client,yt.id.clock+yt.length))}}if(rt.length>0)yt=rt.pop();else if(pt!==null&&pt.i<pt.refs.length)yt=pt.refs[pt.i++];else{if(pt=gt(),pt===null)break;yt=pt.refs[pt.i++]}}if(mt.clients.size>0){const xt=new UpdateEncoderV2;return writeClientsStructs(xt,mt,new Map),writeVarUint(xt.restEncoder,0),{missing:vt,update:xt.toUint8Array()}}return null},writeStructsFromTransaction=(ct,nt)=>writeClientsStructs(ct,nt.doc.store,nt.beforeState),readUpdateV2=(ct,nt,ot,rt=new UpdateDecoderV2(ct))=>transact(nt,ut=>{ut.local=!1;let gt=!1;const pt=ut.doc,mt=pt.store,vt=readClientsStructRefs(rt,pt),St=integrateStructs(ut,mt,vt),yt=mt.pendingStructs;if(yt){for(const[Lt,xt]of yt.missing)if(xt<getState(mt,Lt)){gt=!0;break}if(St){for(const[Lt,xt]of St.missing){const It=yt.missing.get(Lt);(It==null||It>xt)&&yt.missing.set(Lt,xt)}yt.update=mergeUpdatesV2([yt.update,St.update])}}else mt.pendingStructs=St;const wt=readAndApplyDeleteSet(rt,ut,mt);if(mt.pendingDs){const Lt=new UpdateDecoderV2(createDecoder(mt.pendingDs));readVarUint(Lt.restDecoder);const xt=readAndApplyDeleteSet(Lt,ut,mt);wt&&xt?mt.pendingDs=mergeUpdatesV2([wt,xt]):mt.pendingDs=wt||xt}else mt.pendingDs=wt;if(gt){const Lt=mt.pendingStructs.update;mt.pendingStructs=null,applyUpdateV2(ut.doc,Lt)}},ot,!1),applyUpdateV2=(ct,nt,ot,rt=UpdateDecoderV2)=>{const ut=createDecoder(nt);readUpdateV2(ut,ct,ot,new rt(ut))},applyUpdate$1=(ct,nt,ot)=>applyUpdateV2(ct,nt,ot,UpdateDecoderV1),writeStateAsUpdate=(ct,nt,ot=new Map)=>{writeClientsStructs(ct,nt.store,ot),writeDeleteSet(ct,createDeleteSetFromStructStore(nt.store))},encodeStateAsUpdateV2=(ct,nt=new Uint8Array([0]),ot=new UpdateEncoderV2)=>{const rt=decodeStateVector(nt);writeStateAsUpdate(ot,ct,rt);const ut=[ot.toUint8Array()];if(ct.store.pendingDs&&ut.push(ct.store.pendingDs),ct.store.pendingStructs&&ut.push(diffUpdateV2(ct.store.pendingStructs.update,nt)),ut.length>1){if(ot.constructor===UpdateEncoderV1)return mergeUpdates(ut.map((gt,pt)=>pt===0?gt:convertUpdateFormatV2ToV1(gt)));if(ot.constructor===UpdateEncoderV2)return mergeUpdatesV2(ut)}return ut[0]},encodeStateAsUpdate=(ct,nt)=>encodeStateAsUpdateV2(ct,nt,new UpdateEncoderV1),readStateVector=ct=>{const nt=new Map,ot=readVarUint(ct.restDecoder);for(let rt=0;rt<ot;rt++){const ut=readVarUint(ct.restDecoder),gt=readVarUint(ct.restDecoder);nt.set(ut,gt)}return nt},decodeStateVector=ct=>readStateVector(new DSDecoderV1(createDecoder(ct))),writeStateVector=(ct,nt)=>(writeVarUint(ct.restEncoder,nt.size),from(nt.entries()).sort((ot,rt)=>rt[0]-ot[0]).forEach(([ot,rt])=>{writeVarUint(ct.restEncoder,ot),writeVarUint(ct.restEncoder,rt)}),ct),writeDocumentStateVector=(ct,nt)=>writeStateVector(ct,getStateVector(nt.store)),encodeStateVectorV2=(ct,nt=new DSEncoderV2)=>(ct instanceof Map?writeStateVector(nt,ct):writeDocumentStateVector(nt,ct),nt.toUint8Array()),encodeStateVector=ct=>encodeStateVectorV2(ct,new DSEncoderV1);class EventHandler{constructor(){this.l=[]}}const createEventHandler=()=>new EventHandler,addEventHandlerListener=(ct,nt)=>ct.l.push(nt),removeEventHandlerListener=(ct,nt)=>{const ot=ct.l,rt=ot.length;ct.l=ot.filter(ut=>nt!==ut),rt===ct.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},callEventHandlerListeners=(ct,nt,ot)=>callAll(ct.l,[nt,ot]);class ID{constructor(nt,ot){this.client=nt,this.clock=ot}}const compareIDs=(ct,nt)=>ct===nt||ct!==null&&nt!==null&&ct.client===nt.client&&ct.clock===nt.clock,createID=(ct,nt)=>new ID(ct,nt),findRootTypeKey=ct=>{for(const[nt,ot]of ct.doc.share.entries())if(ot===ct)return nt;throw unexpectedCase()};class RelativePosition{constructor(nt,ot,rt,ut=0){this.type=nt,this.tname=ot,this.item=rt,this.assoc=ut}}class AbsolutePosition{constructor(nt,ot,rt=0){this.type=nt,this.index=ot,this.assoc=rt}}const createAbsolutePosition=(ct,nt,ot=0)=>new AbsolutePosition(ct,nt,ot),createRelativePosition=(ct,nt,ot)=>{let rt=null,ut=null;return ct._item===null?ut=findRootTypeKey(ct):rt=createID(ct._item.id.client,ct._item.id.clock),new RelativePosition(rt,ut,nt,ot)},createRelativePositionFromTypeIndex=(ct,nt,ot=0)=>{let rt=ct._start;if(ot<0){if(nt===0)return createRelativePosition(ct,null,ot);nt--}for(;rt!==null;){if(!rt.deleted&&rt.countable){if(rt.length>nt)return createRelativePosition(ct,createID(rt.id.client,rt.id.clock+nt),ot);nt-=rt.length}if(rt.right===null&&ot<0)return createRelativePosition(ct,rt.lastId,ot);rt=rt.right}return createRelativePosition(ct,null,ot)},createAbsolutePositionFromRelativePosition=(ct,nt)=>{const ot=nt.store,rt=ct.item,ut=ct.type,gt=ct.tname,pt=ct.assoc;let mt=null,vt=0;if(rt!==null){if(getState(ot,rt.client)<=rt.clock)return null;const St=followRedone(ot,rt),yt=St.item;if(!(yt instanceof Item))return null;if(mt=yt.parent,mt._item===null||!mt._item.deleted){vt=yt.deleted||!yt.countable?0:St.diff+(pt>=0?0:1);let wt=yt.left;for(;wt!==null;)!wt.deleted&&wt.countable&&(vt+=wt.length),wt=wt.left}}else{if(gt!==null)mt=nt.get(gt);else if(ut!==null){if(getState(ot,ut.client)<=ut.clock)return null;const{item:St}=followRedone(ot,ut);if(St instanceof Item&&St.content instanceof ContentType)mt=St.content.type;else return null}else throw unexpectedCase();pt>=0?vt=mt._length:vt=0}return createAbsolutePosition(mt,vt,ct.assoc)};class Snapshot{constructor(nt,ot){this.ds=nt,this.sv=ot}}const createSnapshot=(ct,nt)=>new Snapshot(ct,nt);createSnapshot(createDeleteSet(),new Map);const isVisible=(ct,nt)=>nt===void 0?!ct.deleted:nt.sv.has(ct.id.client)&&(nt.sv.get(ct.id.client)||0)>ct.id.clock&&!isDeleted(nt.ds,ct.id),splitSnapshotAffectedStructs=(ct,nt)=>{const ot=setIfUndefined(ct.meta,splitSnapshotAffectedStructs,create$6),rt=ct.doc.store;ot.has(nt)||(nt.sv.forEach((ut,gt)=>{ut<getState(rt,gt)&&getItemCleanStart(ct,createID(gt,ut))}),iterateDeletedStructs(ct,nt.ds,ut=>{}),ot.add(nt))};class StructStore{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const getStateVector=ct=>{const nt=new Map;return ct.clients.forEach((ot,rt)=>{const ut=ot[ot.length-1];nt.set(rt,ut.id.clock+ut.length)}),nt},getState=(ct,nt)=>{const ot=ct.clients.get(nt);if(ot===void 0)return 0;const rt=ot[ot.length-1];return rt.id.clock+rt.length},addStruct=(ct,nt)=>{let ot=ct.clients.get(nt.id.client);if(ot===void 0)ot=[],ct.clients.set(nt.id.client,ot);else{const rt=ot[ot.length-1];if(rt.id.clock+rt.length!==nt.id.clock)throw unexpectedCase()}ot.push(nt)},findIndexSS=(ct,nt)=>{let ot=0,rt=ct.length-1,ut=ct[rt],gt=ut.id.clock;if(gt===nt)return rt;let pt=floor(nt/(gt+ut.length-1)*rt);for(;ot<=rt;){if(ut=ct[pt],gt=ut.id.clock,gt<=nt){if(nt<gt+ut.length)return pt;ot=pt+1}else rt=pt-1;pt=floor((ot+rt)/2)}throw unexpectedCase()},find=(ct,nt)=>{const ot=ct.clients.get(nt.client);return ot[findIndexSS(ot,nt.clock)]},getItem=find,findIndexCleanStart=(ct,nt,ot)=>{const rt=findIndexSS(nt,ot),ut=nt[rt];return ut.id.clock<ot&&ut instanceof Item?(nt.splice(rt+1,0,splitItem(ct,ut,ot-ut.id.clock)),rt+1):rt},getItemCleanStart=(ct,nt)=>{const ot=ct.doc.store.clients.get(nt.client);return ot[findIndexCleanStart(ct,ot,nt.clock)]},getItemCleanEnd=(ct,nt,ot)=>{const rt=nt.clients.get(ot.client),ut=findIndexSS(rt,ot.clock),gt=rt[ut];return ot.clock!==gt.id.clock+gt.length-1&&gt.constructor!==GC&&rt.splice(ut+1,0,splitItem(ct,gt,ot.clock-gt.id.clock+1)),gt},replaceStruct=(ct,nt,ot)=>{const rt=ct.clients.get(nt.id.client);rt[findIndexSS(rt,nt.id.clock)]=ot},iterateStructs=(ct,nt,ot,rt,ut)=>{if(rt===0)return;const gt=ot+rt;let pt=findIndexCleanStart(ct,nt,ot),mt;do mt=nt[pt++],gt<mt.id.clock+mt.length&&findIndexCleanStart(ct,nt,gt),ut(mt);while(pt<nt.length&&nt[pt].id.clock<gt)};class Transaction{constructor(nt,ot,rt){this.doc=nt,this.deleteSet=new DeleteSet,this.beforeState=getStateVector(nt.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=ot,this.meta=new Map,this.local=rt,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const writeUpdateMessageFromTransaction=(ct,nt)=>nt.deleteSet.clients.size===0&&!any(nt.afterState,(ot,rt)=>nt.beforeState.get(rt)!==ot)?!1:(sortAndMergeDeleteSet(nt.deleteSet),writeStructsFromTransaction(ct,nt),writeDeleteSet(ct,nt.deleteSet),!0),addChangedTypeToTransaction=(ct,nt,ot)=>{const rt=nt._item;(rt===null||rt.id.clock<(ct.beforeState.get(rt.id.client)||0)&&!rt.deleted)&&setIfUndefined(ct.changed,nt,create$6).add(ot)},tryToMergeWithLefts=(ct,nt)=>{let ot=ct[nt],rt=ct[nt-1],ut=nt;for(;ut>0;ot=rt,rt=ct[--ut-1]){if(rt.deleted===ot.deleted&&rt.constructor===ot.constructor&&rt.mergeWith(ot)){ot instanceof Item&&ot.parentSub!==null&&ot.parent._map.get(ot.parentSub)===ot&&ot.parent._map.set(ot.parentSub,rt);continue}break}const gt=nt-ut;return gt&&ct.splice(nt+1-gt,gt),gt},tryGcDeleteSet=(ct,nt,ot)=>{for(const[rt,ut]of ct.clients.entries()){const gt=nt.clients.get(rt);for(let pt=ut.length-1;pt>=0;pt--){const mt=ut[pt],vt=mt.clock+mt.len;for(let St=findIndexSS(gt,mt.clock),yt=gt[St];St<gt.length&&yt.id.clock<vt;yt=gt[++St]){const wt=gt[St];if(mt.clock+mt.len<=wt.id.clock)break;wt instanceof Item&&wt.deleted&&!wt.keep&&ot(wt)&&wt.gc(nt,!1)}}}},tryMergeDeleteSet=(ct,nt)=>{ct.clients.forEach((ot,rt)=>{const ut=nt.clients.get(rt);for(let gt=ot.length-1;gt>=0;gt--){const pt=ot[gt],mt=min(ut.length-1,1+findIndexSS(ut,pt.clock+pt.len-1));for(let vt=mt,St=ut[vt];vt>0&&St.id.clock>=pt.clock;St=ut[vt])vt-=1+tryToMergeWithLefts(ut,vt)}})},cleanupTransactions=(ct,nt)=>{if(nt<ct.length){const ot=ct[nt],rt=ot.doc,ut=rt.store,gt=ot.deleteSet,pt=ot._mergeStructs;try{sortAndMergeDeleteSet(gt),ot.afterState=getStateVector(ot.doc.store),rt.emit("beforeObserverCalls",[ot,rt]);const mt=[];ot.changed.forEach((vt,St)=>mt.push(()=>{(St._item===null||!St._item.deleted)&&St._callObserver(ot,vt)})),mt.push(()=>{ot.changedParentTypes.forEach((vt,St)=>{St._dEH.l.length>0&&(St._item===null||!St._item.deleted)&&(vt=vt.filter(yt=>yt.target._item===null||!yt.target._item.deleted),vt.forEach(yt=>{yt.currentTarget=St,yt._path=null}),vt.sort((yt,wt)=>yt.path.length-wt.path.length),callEventHandlerListeners(St._dEH,vt,ot))})}),mt.push(()=>rt.emit("afterTransaction",[ot,rt])),callAll(mt,[]),ot._needFormattingCleanup&&cleanupYTextAfterTransaction(ot)}finally{rt.gc&&tryGcDeleteSet(gt,ut,rt.gcFilter),tryMergeDeleteSet(gt,ut),ot.afterState.forEach((yt,wt)=>{const Lt=ot.beforeState.get(wt)||0;if(Lt!==yt){const xt=ut.clients.get(wt),It=max(findIndexSS(xt,Lt),1);for(let kt=xt.length-1;kt>=It;)kt-=1+tryToMergeWithLefts(xt,kt)}});for(let yt=pt.length-1;yt>=0;yt--){const{client:wt,clock:Lt}=pt[yt].id,xt=ut.clients.get(wt),It=findIndexSS(xt,Lt);It+1<xt.length&&tryToMergeWithLefts(xt,It+1)>1||It>0&&tryToMergeWithLefts(xt,It)}if(!ot.local&&ot.afterState.get(rt.clientID)!==ot.beforeState.get(rt.clientID)&&(print(ORANGE,BOLD,"[yjs] ",UNBOLD,RED,"Changed the client-id because another client seems to be using it."),rt.clientID=generateNewClientId()),rt.emit("afterTransactionCleanup",[ot,rt]),rt._observers.has("update")){const yt=new UpdateEncoderV1;writeUpdateMessageFromTransaction(yt,ot)&&rt.emit("update",[yt.toUint8Array(),ot.origin,rt,ot])}if(rt._observers.has("updateV2")){const yt=new UpdateEncoderV2;writeUpdateMessageFromTransaction(yt,ot)&&rt.emit("updateV2",[yt.toUint8Array(),ot.origin,rt,ot])}const{subdocsAdded:mt,subdocsLoaded:vt,subdocsRemoved:St}=ot;(mt.size>0||St.size>0||vt.size>0)&&(mt.forEach(yt=>{yt.clientID=rt.clientID,yt.collectionid==null&&(yt.collectionid=rt.collectionid),rt.subdocs.add(yt)}),St.forEach(yt=>rt.subdocs.delete(yt)),rt.emit("subdocs",[{loaded:vt,added:mt,removed:St},rt,ot]),St.forEach(yt=>yt.destroy())),ct.length<=nt+1?(rt._transactionCleanups=[],rt.emit("afterAllTransactions",[rt,ct])):cleanupTransactions(ct,nt+1)}}},transact=(ct,nt,ot=null,rt=!0)=>{const ut=ct._transactionCleanups;let gt=!1,pt=null;ct._transaction===null&&(gt=!0,ct._transaction=new Transaction(ct,ot,rt),ut.push(ct._transaction),ut.length===1&&ct.emit("beforeAllTransactions",[ct]),ct.emit("beforeTransaction",[ct._transaction,ct]));try{pt=nt(ct._transaction)}finally{if(gt){const mt=ct._transaction===ut[0];ct._transaction=null,mt&&cleanupTransactions(ut,0)}}return pt};function*lazyStructReaderGenerator(ct){const nt=readVarUint(ct.restDecoder);for(let ot=0;ot<nt;ot++){const rt=readVarUint(ct.restDecoder),ut=ct.readClient();let gt=readVarUint(ct.restDecoder);for(let pt=0;pt<rt;pt++){const mt=ct.readInfo();if(mt===10){const vt=readVarUint(ct.restDecoder);yield new Skip(createID(ut,gt),vt),gt+=vt}else if(BITS5&mt){const vt=(mt&(BIT7|BIT8))===0,St=new Item(createID(ut,gt),null,(mt&BIT8)===BIT8?ct.readLeftID():null,null,(mt&BIT7)===BIT7?ct.readRightID():null,vt?ct.readParentInfo()?ct.readString():ct.readLeftID():null,vt&&(mt&BIT6)===BIT6?ct.readString():null,readItemContent(ct,mt));yield St,gt+=St.length}else{const vt=ct.readLen();yield new GC(createID(ut,gt),vt),gt+=vt}}}}class LazyStructReader{constructor(nt,ot){this.gen=lazyStructReaderGenerator(nt),this.curr=null,this.done=!1,this.filterSkips=ot,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Skip);return this.curr}}class LazyStructWriter{constructor(nt){this.currClient=0,this.startClock=0,this.written=0,this.encoder=nt,this.clientStructs=[]}}const mergeUpdates=ct=>mergeUpdatesV2(ct,UpdateDecoderV1,UpdateEncoderV1),sliceStruct=(ct,nt)=>{if(ct.constructor===GC){const{client:ot,clock:rt}=ct.id;return new GC(createID(ot,rt+nt),ct.length-nt)}else if(ct.constructor===Skip){const{client:ot,clock:rt}=ct.id;return new Skip(createID(ot,rt+nt),ct.length-nt)}else{const ot=ct,{client:rt,clock:ut}=ot.id;return new Item(createID(rt,ut+nt),null,createID(rt,ut+nt-1),null,ot.rightOrigin,ot.parent,ot.parentSub,ot.content.splice(nt))}},mergeUpdatesV2=(ct,nt=UpdateDecoderV2,ot=UpdateEncoderV2)=>{if(ct.length===1)return ct[0];const rt=ct.map(yt=>new nt(createDecoder(yt)));let ut=rt.map(yt=>new LazyStructReader(yt,!0)),gt=null;const pt=new ot,mt=new LazyStructWriter(pt);for(;ut=ut.filter(Lt=>Lt.curr!==null),ut.sort((Lt,xt)=>{if(Lt.curr.id.client===xt.curr.id.client){const It=Lt.curr.id.clock-xt.curr.id.clock;return It===0?Lt.curr.constructor===xt.curr.constructor?0:Lt.curr.constructor===Skip?1:-1:It}else return xt.curr.id.client-Lt.curr.id.client}),ut.length!==0;){const yt=ut[0],wt=yt.curr.id.client;if(gt!==null){let Lt=yt.curr,xt=!1;for(;Lt!==null&&Lt.id.clock+Lt.length<=gt.struct.id.clock+gt.struct.length&&Lt.id.client>=gt.struct.id.client;)Lt=yt.next(),xt=!0;if(Lt===null||Lt.id.client!==wt||xt&&Lt.id.clock>gt.struct.id.clock+gt.struct.length)continue;if(wt!==gt.struct.id.client)writeStructToLazyStructWriter(mt,gt.struct,gt.offset),gt={struct:Lt,offset:0},yt.next();else if(gt.struct.id.clock+gt.struct.length<Lt.id.clock)if(gt.struct.constructor===Skip)gt.struct.length=Lt.id.clock+Lt.length-gt.struct.id.clock;else{writeStructToLazyStructWriter(mt,gt.struct,gt.offset);const It=Lt.id.clock-gt.struct.id.clock-gt.struct.length;gt={struct:new Skip(createID(wt,gt.struct.id.clock+gt.struct.length),It),offset:0}}else{const It=gt.struct.id.clock+gt.struct.length-Lt.id.clock;It>0&&(gt.struct.constructor===Skip?gt.struct.length-=It:Lt=sliceStruct(Lt,It)),gt.struct.mergeWith(Lt)||(writeStructToLazyStructWriter(mt,gt.struct,gt.offset),gt={struct:Lt,offset:0},yt.next())}}else gt={struct:yt.curr,offset:0},yt.next();for(let Lt=yt.curr;Lt!==null&&Lt.id.client===wt&&Lt.id.clock===gt.struct.id.clock+gt.struct.length&&Lt.constructor!==Skip;Lt=yt.next())writeStructToLazyStructWriter(mt,gt.struct,gt.offset),gt={struct:Lt,offset:0}}gt!==null&&(writeStructToLazyStructWriter(mt,gt.struct,gt.offset),gt=null),finishLazyStructWriting(mt);const vt=rt.map(yt=>readDeleteSet(yt)),St=mergeDeleteSets(vt);return writeDeleteSet(pt,St),pt.toUint8Array()},diffUpdateV2=(ct,nt,ot=UpdateDecoderV2,rt=UpdateEncoderV2)=>{const ut=decodeStateVector(nt),gt=new rt,pt=new LazyStructWriter(gt),mt=new ot(createDecoder(ct)),vt=new LazyStructReader(mt,!1);for(;vt.curr;){const yt=vt.curr,wt=yt.id.client,Lt=ut.get(wt)||0;if(vt.curr.constructor===Skip){vt.next();continue}if(yt.id.clock+yt.length>Lt)for(writeStructToLazyStructWriter(pt,yt,max(Lt-yt.id.clock,0)),vt.next();vt.curr&&vt.curr.id.client===wt;)writeStructToLazyStructWriter(pt,vt.curr,0),vt.next();else for(;vt.curr&&vt.curr.id.client===wt&&vt.curr.id.clock+vt.curr.length<=Lt;)vt.next()}finishLazyStructWriting(pt);const St=readDeleteSet(mt);return writeDeleteSet(gt,St),gt.toUint8Array()},flushLazyStructWriter=ct=>{ct.written>0&&(ct.clientStructs.push({written:ct.written,restEncoder:toUint8Array(ct.encoder.restEncoder)}),ct.encoder.restEncoder=createEncoder(),ct.written=0)},writeStructToLazyStructWriter=(ct,nt,ot)=>{ct.written>0&&ct.currClient!==nt.id.client&&flushLazyStructWriter(ct),ct.written===0&&(ct.currClient=nt.id.client,ct.encoder.writeClient(nt.id.client),writeVarUint(ct.encoder.restEncoder,nt.id.clock+ot)),nt.write(ct.encoder,ot),ct.written++},finishLazyStructWriting=ct=>{flushLazyStructWriter(ct);const nt=ct.encoder.restEncoder;writeVarUint(nt,ct.clientStructs.length);for(let ot=0;ot<ct.clientStructs.length;ot++){const rt=ct.clientStructs[ot];writeVarUint(nt,rt.written),writeUint8Array(nt,rt.restEncoder)}},convertUpdateFormat=(ct,nt,ot,rt)=>{const ut=new ot(createDecoder(ct)),gt=new LazyStructReader(ut,!1),pt=new rt,mt=new LazyStructWriter(pt);for(let St=gt.curr;St!==null;St=gt.next())writeStructToLazyStructWriter(mt,nt(St),0);finishLazyStructWriting(mt);const vt=readDeleteSet(ut);return writeDeleteSet(pt,vt),pt.toUint8Array()},convertUpdateFormatV2ToV1=ct=>convertUpdateFormat(ct,id,UpdateDecoderV2,UpdateEncoderV1),errorComputeChanges="You must not compute changes after the event-handler fired.";class YEvent{constructor(nt,ot){this.target=nt,this.currentTarget=nt,this.transaction=ot,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=getPathTo(this.currentTarget,this.target))}deletes(nt){return isDeleted(this.transaction.deleteSet,nt.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw create$5(errorComputeChanges);const nt=new Map,ot=this.target;this.transaction.changed.get(ot).forEach(ut=>{if(ut!==null){const gt=ot._map.get(ut);let pt,mt;if(this.adds(gt)){let vt=gt.left;for(;vt!==null&&this.adds(vt);)vt=vt.left;if(this.deletes(gt))if(vt!==null&&this.deletes(vt))pt="delete",mt=last(vt.content.getContent());else return;else vt!==null&&this.deletes(vt)?(pt="update",mt=last(vt.content.getContent())):(pt="add",mt=void 0)}else if(this.deletes(gt))pt="delete",mt=last(gt.content.getContent());else return;nt.set(ut,{action:pt,oldValue:mt})}}),this._keys=nt}return this._keys}get delta(){return this.changes.delta}adds(nt){return nt.id.clock>=(this.transaction.beforeState.get(nt.id.client)||0)}get changes(){let nt=this._changes;if(nt===null){if(this.transaction.doc._transactionCleanups.length===0)throw create$5(errorComputeChanges);const ot=this.target,rt=create$6(),ut=create$6(),gt=[];if(nt={added:rt,deleted:ut,delta:gt,keys:this.keys},this.transaction.changed.get(ot).has(null)){let mt=null;const vt=()=>{mt&&gt.push(mt)};for(let St=ot._start;St!==null;St=St.right)St.deleted?this.deletes(St)&&!this.adds(St)&&((mt===null||mt.delete===void 0)&&(vt(),mt={delete:0}),mt.delete+=St.length,ut.add(St)):this.adds(St)?((mt===null||mt.insert===void 0)&&(vt(),mt={insert:[]}),mt.insert=mt.insert.concat(St.content.getContent()),rt.add(St)):((mt===null||mt.retain===void 0)&&(vt(),mt={retain:0}),mt.retain+=St.length);mt!==null&&mt.retain===void 0&&vt()}this._changes=nt}return nt}}const getPathTo=(ct,nt)=>{const ot=[];for(;nt._item!==null&&nt!==ct;){if(nt._item.parentSub!==null)ot.unshift(nt._item.parentSub);else{let rt=0,ut=nt._item.parent._start;for(;ut!==nt._item&&ut!==null;)ut.deleted||rt++,ut=ut.right;ot.unshift(rt)}nt=nt._item.parent}return ot},maxSearchMarker=80;let globalSearchMarkerTimestamp=0;class ArraySearchMarker{constructor(nt,ot){nt.marker=!0,this.p=nt,this.index=ot,this.timestamp=globalSearchMarkerTimestamp++}}const refreshMarkerTimestamp=ct=>{ct.timestamp=globalSearchMarkerTimestamp++},overwriteMarker=(ct,nt,ot)=>{ct.p.marker=!1,ct.p=nt,nt.marker=!0,ct.index=ot,ct.timestamp=globalSearchMarkerTimestamp++},markPosition=(ct,nt,ot)=>{if(ct.length>=maxSearchMarker){const rt=ct.reduce((ut,gt)=>ut.timestamp<gt.timestamp?ut:gt);return overwriteMarker(rt,nt,ot),rt}else{const rt=new ArraySearchMarker(nt,ot);return ct.push(rt),rt}},findMarker=(ct,nt)=>{if(ct._start===null||nt===0||ct._searchMarker===null)return null;const ot=ct._searchMarker.length===0?null:ct._searchMarker.reduce((gt,pt)=>abs$1(nt-gt.index)<abs$1(nt-pt.index)?gt:pt);let rt=ct._start,ut=0;for(ot!==null&&(rt=ot.p,ut=ot.index,refreshMarkerTimestamp(ot));rt.right!==null&&ut<nt;){if(!rt.deleted&&rt.countable){if(nt<ut+rt.length)break;ut+=rt.length}rt=rt.right}for(;rt.left!==null&&ut>nt;)rt=rt.left,!rt.deleted&&rt.countable&&(ut-=rt.length);for(;rt.left!==null&&rt.left.id.client===rt.id.client&&rt.left.id.clock+rt.left.length===rt.id.clock;)rt=rt.left,!rt.deleted&&rt.countable&&(ut-=rt.length);return ot!==null&&abs$1(ot.index-ut)<rt.parent.length/maxSearchMarker?(overwriteMarker(ot,rt,ut),ot):markPosition(ct._searchMarker,rt,ut)},updateMarkerChanges=(ct,nt,ot)=>{for(let rt=ct.length-1;rt>=0;rt--){const ut=ct[rt];if(ot>0){let gt=ut.p;for(gt.marker=!1;gt&&(gt.deleted||!gt.countable);)gt=gt.left,gt&&!gt.deleted&&gt.countable&&(ut.index-=gt.length);if(gt===null||gt.marker===!0){ct.splice(rt,1);continue}ut.p=gt,gt.marker=!0}(nt<ut.index||ot>0&&nt===ut.index)&&(ut.index=max(nt,ut.index+ot))}},callTypeObservers=(ct,nt,ot)=>{const rt=ct,ut=nt.changedParentTypes;for(;setIfUndefined(ut,ct,()=>[]).push(ot),ct._item!==null;)ct=ct._item.parent;callEventHandlerListeners(rt._eH,ot,nt)};class AbstractType{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=createEventHandler(),this._dEH=createEventHandler(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(nt,ot){this.doc=nt,this._item=ot}_copy(){throw methodUnimplemented()}clone(){throw methodUnimplemented()}_write(nt){}get _first(){let nt=this._start;for(;nt!==null&&nt.deleted;)nt=nt.right;return nt}_callObserver(nt,ot){!nt.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(nt){addEventHandlerListener(this._eH,nt)}observeDeep(nt){addEventHandlerListener(this._dEH,nt)}unobserve(nt){removeEventHandlerListener(this._eH,nt)}unobserveDeep(nt){removeEventHandlerListener(this._dEH,nt)}toJSON(){}}const typeListSlice=(ct,nt,ot)=>{nt<0&&(nt=ct._length+nt),ot<0&&(ot=ct._length+ot);let rt=ot-nt;const ut=[];let gt=ct._start;for(;gt!==null&&rt>0;){if(gt.countable&&!gt.deleted){const pt=gt.content.getContent();if(pt.length<=nt)nt-=pt.length;else{for(let mt=nt;mt<pt.length&&rt>0;mt++)ut.push(pt[mt]),rt--;nt=0}}gt=gt.right}return ut},typeListToArray=ct=>{const nt=[];let ot=ct._start;for(;ot!==null;){if(ot.countable&&!ot.deleted){const rt=ot.content.getContent();for(let ut=0;ut<rt.length;ut++)nt.push(rt[ut])}ot=ot.right}return nt},typeListForEach=(ct,nt)=>{let ot=0,rt=ct._start;for(;rt!==null;){if(rt.countable&&!rt.deleted){const ut=rt.content.getContent();for(let gt=0;gt<ut.length;gt++)nt(ut[gt],ot++,ct)}rt=rt.right}},typeListMap=(ct,nt)=>{const ot=[];return typeListForEach(ct,(rt,ut)=>{ot.push(nt(rt,ut,ct))}),ot},typeListCreateIterator=ct=>{let nt=ct._start,ot=null,rt=0;return{[Symbol.iterator](){return this},next:()=>{if(ot===null){for(;nt!==null&&nt.deleted;)nt=nt.right;if(nt===null)return{done:!0,value:void 0};ot=nt.content.getContent(),rt=0,nt=nt.right}const ut=ot[rt++];return ot.length<=rt&&(ot=null),{done:!1,value:ut}}}},typeListGet=(ct,nt)=>{const ot=findMarker(ct,nt);let rt=ct._start;for(ot!==null&&(rt=ot.p,nt-=ot.index);rt!==null;rt=rt.right)if(!rt.deleted&&rt.countable){if(nt<rt.length)return rt.content.getContent()[nt];nt-=rt.length}},typeListInsertGenericsAfter=(ct,nt,ot,rt)=>{let ut=ot;const gt=ct.doc,pt=gt.clientID,mt=gt.store,vt=ot===null?nt._start:ot.right;let St=[];const yt=()=>{St.length>0&&(ut=new Item(createID(pt,getState(mt,pt)),ut,ut&&ut.lastId,vt,vt&&vt.id,nt,null,new ContentAny(St)),ut.integrate(ct,0),St=[])};rt.forEach(wt=>{if(wt===null)St.push(wt);else switch(wt.constructor){case Number:case Object:case Boolean:case Array:case String:St.push(wt);break;default:switch(yt(),wt.constructor){case Uint8Array:case ArrayBuffer:ut=new Item(createID(pt,getState(mt,pt)),ut,ut&&ut.lastId,vt,vt&&vt.id,nt,null,new ContentBinary(new Uint8Array(wt))),ut.integrate(ct,0);break;case Doc:ut=new Item(createID(pt,getState(mt,pt)),ut,ut&&ut.lastId,vt,vt&&vt.id,nt,null,new ContentDoc(wt)),ut.integrate(ct,0);break;default:if(wt instanceof AbstractType)ut=new Item(createID(pt,getState(mt,pt)),ut,ut&&ut.lastId,vt,vt&&vt.id,nt,null,new ContentType(wt)),ut.integrate(ct,0);else throw new Error("Unexpected content type in insert operation")}}}),yt()},lengthExceeded=create$5("Length exceeded!"),typeListInsertGenerics=(ct,nt,ot,rt)=>{if(ot>nt._length)throw lengthExceeded;if(ot===0)return nt._searchMarker&&updateMarkerChanges(nt._searchMarker,ot,rt.length),typeListInsertGenericsAfter(ct,nt,null,rt);const ut=ot,gt=findMarker(nt,ot);let pt=nt._start;for(gt!==null&&(pt=gt.p,ot-=gt.index,ot===0&&(pt=pt.prev,ot+=pt&&pt.countable&&!pt.deleted?pt.length:0));pt!==null;pt=pt.right)if(!pt.deleted&&pt.countable){if(ot<=pt.length){ot<pt.length&&getItemCleanStart(ct,createID(pt.id.client,pt.id.clock+ot));break}ot-=pt.length}return nt._searchMarker&&updateMarkerChanges(nt._searchMarker,ut,rt.length),typeListInsertGenericsAfter(ct,nt,pt,rt)},typeListPushGenerics=(ct,nt,ot)=>{let ut=(nt._searchMarker||[]).reduce((gt,pt)=>pt.index>gt.index?pt:gt,{index:0,p:nt._start}).p;if(ut)for(;ut.right;)ut=ut.right;return typeListInsertGenericsAfter(ct,nt,ut,ot)},typeListDelete=(ct,nt,ot,rt)=>{if(rt===0)return;const ut=ot,gt=rt,pt=findMarker(nt,ot);let mt=nt._start;for(pt!==null&&(mt=pt.p,ot-=pt.index);mt!==null&&ot>0;mt=mt.right)!mt.deleted&&mt.countable&&(ot<mt.length&&getItemCleanStart(ct,createID(mt.id.client,mt.id.clock+ot)),ot-=mt.length);for(;rt>0&&mt!==null;)mt.deleted||(rt<mt.length&&getItemCleanStart(ct,createID(mt.id.client,mt.id.clock+rt)),mt.delete(ct),rt-=mt.length),mt=mt.right;if(rt>0)throw lengthExceeded;nt._searchMarker&&updateMarkerChanges(nt._searchMarker,ut,-gt+rt)},typeMapDelete=(ct,nt,ot)=>{const rt=nt._map.get(ot);rt!==void 0&&rt.delete(ct)},typeMapSet=(ct,nt,ot,rt)=>{const ut=nt._map.get(ot)||null,gt=ct.doc,pt=gt.clientID;let mt;if(rt==null)mt=new ContentAny([rt]);else switch(rt.constructor){case Number:case Object:case Boolean:case Array:case String:mt=new ContentAny([rt]);break;case Uint8Array:mt=new ContentBinary(rt);break;case Doc:mt=new ContentDoc(rt);break;default:if(rt instanceof AbstractType)mt=new ContentType(rt);else throw new Error("Unexpected content type")}new Item(createID(pt,getState(gt.store,pt)),ut,ut&&ut.lastId,null,null,nt,ot,mt).integrate(ct,0)},typeMapGet=(ct,nt)=>{const ot=ct._map.get(nt);return ot!==void 0&&!ot.deleted?ot.content.getContent()[ot.length-1]:void 0},typeMapGetAll=ct=>{const nt={};return ct._map.forEach((ot,rt)=>{ot.deleted||(nt[rt]=ot.content.getContent()[ot.length-1])}),nt},typeMapHas=(ct,nt)=>{const ot=ct._map.get(nt);return ot!==void 0&&!ot.deleted},createMapIterator=ct=>iteratorFilter(ct.entries(),nt=>!nt[1].deleted);class YArrayEvent extends YEvent{constructor(nt,ot){super(nt,ot),this._transaction=ot}}class YArray extends AbstractType{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(nt){const ot=new YArray;return ot.push(nt),ot}_integrate(nt,ot){super._integrate(nt,ot),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new YArray}clone(){const nt=new YArray;return nt.insert(0,this.toArray().map(ot=>ot instanceof AbstractType?ot.clone():ot)),nt}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(nt,ot){super._callObserver(nt,ot),callTypeObservers(this,nt,new YArrayEvent(this,nt))}insert(nt,ot){this.doc!==null?transact(this.doc,rt=>{typeListInsertGenerics(rt,this,nt,ot)}):this._prelimContent.splice(nt,0,...ot)}push(nt){this.doc!==null?transact(this.doc,ot=>{typeListPushGenerics(ot,this,nt)}):this._prelimContent.push(...nt)}unshift(nt){this.insert(0,nt)}delete(nt,ot=1){this.doc!==null?transact(this.doc,rt=>{typeListDelete(rt,this,nt,ot)}):this._prelimContent.splice(nt,ot)}get(nt){return typeListGet(this,nt)}toArray(){return typeListToArray(this)}slice(nt=0,ot=this.length){return typeListSlice(this,nt,ot)}toJSON(){return this.map(nt=>nt instanceof AbstractType?nt.toJSON():nt)}map(nt){return typeListMap(this,nt)}forEach(nt){typeListForEach(this,nt)}[Symbol.iterator](){return typeListCreateIterator(this)}_write(nt){nt.writeTypeRef(YArrayRefID)}}const readYArray=ct=>new YArray;class YMapEvent extends YEvent{constructor(nt,ot,rt){super(nt,ot),this.keysChanged=rt}}class YMap extends AbstractType{constructor(nt){super(),this._prelimContent=null,nt===void 0?this._prelimContent=new Map:this._prelimContent=new Map(nt)}_integrate(nt,ot){super._integrate(nt,ot),this._prelimContent.forEach((rt,ut)=>{this.set(ut,rt)}),this._prelimContent=null}_copy(){return new YMap}clone(){const nt=new YMap;return this.forEach((ot,rt)=>{nt.set(rt,ot instanceof AbstractType?ot.clone():ot)}),nt}_callObserver(nt,ot){callTypeObservers(this,nt,new YMapEvent(this,nt,ot))}toJSON(){const nt={};return this._map.forEach((ot,rt)=>{if(!ot.deleted){const ut=ot.content.getContent()[ot.length-1];nt[rt]=ut instanceof AbstractType?ut.toJSON():ut}}),nt}get size(){return[...createMapIterator(this._map)].length}keys(){return iteratorMap(createMapIterator(this._map),nt=>nt[0])}values(){return iteratorMap(createMapIterator(this._map),nt=>nt[1].content.getContent()[nt[1].length-1])}entries(){return iteratorMap(createMapIterator(this._map),nt=>[nt[0],nt[1].content.getContent()[nt[1].length-1]])}forEach(nt){this._map.forEach((ot,rt)=>{ot.deleted||nt(ot.content.getContent()[ot.length-1],rt,this)})}[Symbol.iterator](){return this.entries()}delete(nt){this.doc!==null?transact(this.doc,ot=>{typeMapDelete(ot,this,nt)}):this._prelimContent.delete(nt)}set(nt,ot){return this.doc!==null?transact(this.doc,rt=>{typeMapSet(rt,this,nt,ot)}):this._prelimContent.set(nt,ot),ot}get(nt){return typeMapGet(this,nt)}has(nt){return typeMapHas(this,nt)}clear(){this.doc!==null?transact(this.doc,nt=>{this.forEach(function(ot,rt,ut){typeMapDelete(nt,ut,rt)})}):this._prelimContent.clear()}_write(nt){nt.writeTypeRef(YMapRefID)}}const readYMap=ct=>new YMap,equalAttrs=(ct,nt)=>ct===nt||typeof ct=="object"&&typeof nt=="object"&&ct&&nt&&equalFlat(ct,nt);class ItemTextListPosition{constructor(nt,ot,rt,ut){this.left=nt,this.right=ot,this.index=rt,this.currentAttributes=ut}forward(){switch(this.right===null&&unexpectedCase(),this.right.content.constructor){case ContentFormat:this.right.deleted||updateCurrentAttributes(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const findNextPosition=(ct,nt,ot)=>{for(;nt.right!==null&&ot>0;){switch(nt.right.content.constructor){case ContentFormat:nt.right.deleted||updateCurrentAttributes(nt.currentAttributes,nt.right.content);break;default:nt.right.deleted||(ot<nt.right.length&&getItemCleanStart(ct,createID(nt.right.id.client,nt.right.id.clock+ot)),nt.index+=nt.right.length,ot-=nt.right.length);break}nt.left=nt.right,nt.right=nt.right.right}return nt},findPosition=(ct,nt,ot)=>{const rt=new Map,ut=findMarker(nt,ot);if(ut){const gt=new ItemTextListPosition(ut.p.left,ut.p,ut.index,rt);return findNextPosition(ct,gt,ot-ut.index)}else{const gt=new ItemTextListPosition(null,nt._start,0,rt);return findNextPosition(ct,gt,ot)}},insertNegatedAttributes=(ct,nt,ot,rt)=>{for(;ot.right!==null&&(ot.right.deleted===!0||ot.right.content.constructor===ContentFormat&&equalAttrs(rt.get(ot.right.content.key),ot.right.content.value));)ot.right.deleted||rt.delete(ot.right.content.key),ot.forward();const ut=ct.doc,gt=ut.clientID;rt.forEach((pt,mt)=>{const vt=ot.left,St=ot.right,yt=new Item(createID(gt,getState(ut.store,gt)),vt,vt&&vt.lastId,St,St&&St.id,nt,null,new ContentFormat(mt,pt));yt.integrate(ct,0),ot.right=yt,ot.forward()})},updateCurrentAttributes=(ct,nt)=>{const{key:ot,value:rt}=nt;rt===null?ct.delete(ot):ct.set(ot,rt)},minimizeAttributeChanges=(ct,nt)=>{for(;ct.right!==null;){if(!(ct.right.deleted||ct.right.content.constructor===ContentFormat&&equalAttrs(nt[ct.right.content.key]||null,ct.right.content.value)))break;ct.forward()}},insertAttributes=(ct,nt,ot,rt)=>{const ut=ct.doc,gt=ut.clientID,pt=new Map;for(const mt in rt){const vt=rt[mt],St=ot.currentAttributes.get(mt)||null;if(!equalAttrs(St,vt)){pt.set(mt,St);const{left:yt,right:wt}=ot;ot.right=new Item(createID(gt,getState(ut.store,gt)),yt,yt&&yt.lastId,wt,wt&&wt.id,nt,null,new ContentFormat(mt,vt)),ot.right.integrate(ct,0),ot.forward()}}return pt},insertText=(ct,nt,ot,rt,ut)=>{ot.currentAttributes.forEach((Lt,xt)=>{ut[xt]===void 0&&(ut[xt]=null)});const gt=ct.doc,pt=gt.clientID;minimizeAttributeChanges(ot,ut);const mt=insertAttributes(ct,nt,ot,ut),vt=rt.constructor===String?new ContentString(rt):rt instanceof AbstractType?new ContentType(rt):new ContentEmbed(rt);let{left:St,right:yt,index:wt}=ot;nt._searchMarker&&updateMarkerChanges(nt._searchMarker,ot.index,vt.getLength()),yt=new Item(createID(pt,getState(gt.store,pt)),St,St&&St.lastId,yt,yt&&yt.id,nt,null,vt),yt.integrate(ct,0),ot.right=yt,ot.index=wt,ot.forward(),insertNegatedAttributes(ct,nt,ot,mt)},formatText=(ct,nt,ot,rt,ut)=>{const gt=ct.doc,pt=gt.clientID;minimizeAttributeChanges(ot,ut);const mt=insertAttributes(ct,nt,ot,ut);e:for(;ot.right!==null&&(rt>0||mt.size>0&&(ot.right.deleted||ot.right.content.constructor===ContentFormat));){if(!ot.right.deleted)switch(ot.right.content.constructor){case ContentFormat:{const{key:vt,value:St}=ot.right.content,yt=ut[vt];if(yt!==void 0){if(equalAttrs(yt,St))mt.delete(vt);else{if(rt===0)break e;mt.set(vt,St)}ot.right.delete(ct)}else ot.currentAttributes.set(vt,St);break}default:rt<ot.right.length&&getItemCleanStart(ct,createID(ot.right.id.client,ot.right.id.clock+rt)),rt-=ot.right.length;break}ot.forward()}if(rt>0){let vt="";for(;rt>0;rt--)vt+=`
`;ot.right=new Item(createID(pt,getState(gt.store,pt)),ot.left,ot.left&&ot.left.lastId,ot.right,ot.right&&ot.right.id,nt,null,new ContentString(vt)),ot.right.integrate(ct,0),ot.forward()}insertNegatedAttributes(ct,nt,ot,mt)},cleanupFormattingGap=(ct,nt,ot,rt,ut)=>{let gt=nt;const pt=create$7();for(;gt&&(!gt.countable||gt.deleted);){if(!gt.deleted&&gt.content.constructor===ContentFormat){const St=gt.content;pt.set(St.key,St)}gt=gt.right}let mt=0,vt=!1;for(;nt!==gt;){if(ot===nt&&(vt=!0),!nt.deleted){const St=nt.content;switch(St.constructor){case ContentFormat:{const{key:yt,value:wt}=St,Lt=rt.get(yt)||null;(pt.get(yt)!==St||Lt===wt)&&(nt.delete(ct),mt++,!vt&&(ut.get(yt)||null)===wt&&Lt!==wt&&(Lt===null?ut.delete(yt):ut.set(yt,Lt))),!vt&&!nt.deleted&&updateCurrentAttributes(ut,St);break}}}nt=nt.right}return mt},cleanupContextlessFormattingGap=(ct,nt)=>{for(;nt&&nt.right&&(nt.right.deleted||!nt.right.countable);)nt=nt.right;const ot=new Set;for(;nt&&(nt.deleted||!nt.countable);){if(!nt.deleted&&nt.content.constructor===ContentFormat){const rt=nt.content.key;ot.has(rt)?nt.delete(ct):ot.add(rt)}nt=nt.left}},cleanupYTextFormatting=ct=>{let nt=0;return transact(ct.doc,ot=>{let rt=ct._start,ut=ct._start,gt=create$7();const pt=copy(gt);for(;ut;){if(ut.deleted===!1)switch(ut.content.constructor){case ContentFormat:updateCurrentAttributes(pt,ut.content);break;default:nt+=cleanupFormattingGap(ot,rt,ut,gt,pt),gt=copy(pt),rt=ut;break}ut=ut.right}}),nt},cleanupYTextAfterTransaction=ct=>{const nt=new Set,ot=ct.doc;for(const[rt,ut]of ct.afterState.entries()){const gt=ct.beforeState.get(rt)||0;ut!==gt&&iterateStructs(ct,ot.store.clients.get(rt),gt,ut,pt=>{!pt.deleted&&pt.content.constructor===ContentFormat&&pt.constructor!==GC&&nt.add(pt.parent)})}transact(ot,rt=>{iterateDeletedStructs(ct,ct.deleteSet,ut=>{if(ut instanceof GC||!ut.parent._hasFormatting||nt.has(ut.parent))return;const gt=ut.parent;ut.content.constructor===ContentFormat?nt.add(gt):cleanupContextlessFormattingGap(rt,ut)});for(const ut of nt)cleanupYTextFormatting(ut)})},deleteText=(ct,nt,ot)=>{const rt=ot,ut=copy(nt.currentAttributes),gt=nt.right;for(;ot>0&&nt.right!==null;){if(nt.right.deleted===!1)switch(nt.right.content.constructor){case ContentType:case ContentEmbed:case ContentString:ot<nt.right.length&&getItemCleanStart(ct,createID(nt.right.id.client,nt.right.id.clock+ot)),ot-=nt.right.length,nt.right.delete(ct);break}nt.forward()}gt&&cleanupFormattingGap(ct,gt,nt.right,ut,nt.currentAttributes);const pt=(nt.left||nt.right).parent;return pt._searchMarker&&updateMarkerChanges(pt._searchMarker,nt.index,-rt+ot),nt};class YTextEvent extends YEvent{constructor(nt,ot,rt){super(nt,ot),this.childListChanged=!1,this.keysChanged=new Set,rt.forEach(ut=>{ut===null?this.childListChanged=!0:this.keysChanged.add(ut)})}get changes(){if(this._changes===null){const nt={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=nt}return this._changes}get delta(){if(this._delta===null){const nt=this.target.doc,ot=[];transact(nt,rt=>{const ut=new Map,gt=new Map;let pt=this.target._start,mt=null;const vt={};let St="",yt=0,wt=0;const Lt=()=>{if(mt!==null){let xt=null;switch(mt){case"delete":wt>0&&(xt={delete:wt}),wt=0;break;case"insert":(typeof St=="object"||St.length>0)&&(xt={insert:St},ut.size>0&&(xt.attributes={},ut.forEach((It,kt)=>{It!==null&&(xt.attributes[kt]=It)}))),St="";break;case"retain":yt>0&&(xt={retain:yt},isEmpty(vt)||(xt.attributes=assign({},vt))),yt=0;break}xt&&ot.push(xt),mt=null}};for(;pt!==null;){switch(pt.content.constructor){case ContentType:case ContentEmbed:this.adds(pt)?this.deletes(pt)||(Lt(),mt="insert",St=pt.content.getContent()[0],Lt()):this.deletes(pt)?(mt!=="delete"&&(Lt(),mt="delete"),wt+=1):pt.deleted||(mt!=="retain"&&(Lt(),mt="retain"),yt+=1);break;case ContentString:this.adds(pt)?this.deletes(pt)||(mt!=="insert"&&(Lt(),mt="insert"),St+=pt.content.str):this.deletes(pt)?(mt!=="delete"&&(Lt(),mt="delete"),wt+=pt.length):pt.deleted||(mt!=="retain"&&(Lt(),mt="retain"),yt+=pt.length);break;case ContentFormat:{const{key:xt,value:It}=pt.content;if(this.adds(pt)){if(!this.deletes(pt)){const kt=ut.get(xt)||null;equalAttrs(kt,It)?It!==null&&pt.delete(rt):(mt==="retain"&&Lt(),equalAttrs(It,gt.get(xt)||null)?delete vt[xt]:vt[xt]=It)}}else if(this.deletes(pt)){gt.set(xt,It);const kt=ut.get(xt)||null;equalAttrs(kt,It)||(mt==="retain"&&Lt(),vt[xt]=kt)}else if(!pt.deleted){gt.set(xt,It);const kt=vt[xt];kt!==void 0&&(equalAttrs(kt,It)?kt!==null&&pt.delete(rt):(mt==="retain"&&Lt(),It===null?delete vt[xt]:vt[xt]=It))}pt.deleted||(mt==="insert"&&Lt(),updateCurrentAttributes(ut,pt.content));break}}pt=pt.right}for(Lt();ot.length>0;){const xt=ot[ot.length-1];if(xt.retain!==void 0&&xt.attributes===void 0)ot.pop();else break}}),this._delta=ot}return this._delta}}class YText extends AbstractType{constructor(nt){super(),this._pending=nt!==void 0?[()=>this.insert(0,nt)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(nt,ot){super._integrate(nt,ot);try{this._pending.forEach(rt=>rt())}catch(rt){console.error(rt)}this._pending=null}_copy(){return new YText}clone(){const nt=new YText;return nt.applyDelta(this.toDelta()),nt}_callObserver(nt,ot){super._callObserver(nt,ot);const rt=new YTextEvent(this,nt,ot);callTypeObservers(this,nt,rt),!nt.local&&this._hasFormatting&&(nt._needFormattingCleanup=!0)}toString(){let nt="",ot=this._start;for(;ot!==null;)!ot.deleted&&ot.countable&&ot.content.constructor===ContentString&&(nt+=ot.content.str),ot=ot.right;return nt}toJSON(){return this.toString()}applyDelta(nt,{sanitize:ot=!0}={}){this.doc!==null?transact(this.doc,rt=>{const ut=new ItemTextListPosition(null,this._start,0,new Map);for(let gt=0;gt<nt.length;gt++){const pt=nt[gt];if(pt.insert!==void 0){const mt=!ot&&typeof pt.insert=="string"&&gt===nt.length-1&&ut.right===null&&pt.insert.slice(-1)===`
`?pt.insert.slice(0,-1):pt.insert;(typeof mt!="string"||mt.length>0)&&insertText(rt,this,ut,mt,pt.attributes||{})}else pt.retain!==void 0?formatText(rt,this,ut,pt.retain,pt.attributes||{}):pt.delete!==void 0&&deleteText(rt,ut,pt.delete)}}):this._pending.push(()=>this.applyDelta(nt))}toDelta(nt,ot,rt){const ut=[],gt=new Map,pt=this.doc;let mt="",vt=this._start;function St(){if(mt.length>0){const wt={};let Lt=!1;gt.forEach((It,kt)=>{Lt=!0,wt[kt]=It});const xt={insert:mt};Lt&&(xt.attributes=wt),ut.push(xt),mt=""}}const yt=()=>{for(;vt!==null;){if(isVisible(vt,nt)||ot!==void 0&&isVisible(vt,ot))switch(vt.content.constructor){case ContentString:{const wt=gt.get("ychange");nt!==void 0&&!isVisible(vt,nt)?(wt===void 0||wt.user!==vt.id.client||wt.type!=="removed")&&(St(),gt.set("ychange",rt?rt("removed",vt.id):{type:"removed"})):ot!==void 0&&!isVisible(vt,ot)?(wt===void 0||wt.user!==vt.id.client||wt.type!=="added")&&(St(),gt.set("ychange",rt?rt("added",vt.id):{type:"added"})):wt!==void 0&&(St(),gt.delete("ychange")),mt+=vt.content.str;break}case ContentType:case ContentEmbed:{St();const wt={insert:vt.content.getContent()[0]};if(gt.size>0){const Lt={};wt.attributes=Lt,gt.forEach((xt,It)=>{Lt[It]=xt})}ut.push(wt);break}case ContentFormat:isVisible(vt,nt)&&(St(),updateCurrentAttributes(gt,vt.content));break}vt=vt.right}St()};return nt||ot?transact(pt,wt=>{nt&&splitSnapshotAffectedStructs(wt,nt),ot&&splitSnapshotAffectedStructs(wt,ot),yt()},"cleanup"):yt(),ut}insert(nt,ot,rt){if(ot.length<=0)return;const ut=this.doc;ut!==null?transact(ut,gt=>{const pt=findPosition(gt,this,nt);rt||(rt={},pt.currentAttributes.forEach((mt,vt)=>{rt[vt]=mt})),insertText(gt,this,pt,ot,rt)}):this._pending.push(()=>this.insert(nt,ot,rt))}insertEmbed(nt,ot,rt={}){const ut=this.doc;ut!==null?transact(ut,gt=>{const pt=findPosition(gt,this,nt);insertText(gt,this,pt,ot,rt)}):this._pending.push(()=>this.insertEmbed(nt,ot,rt))}delete(nt,ot){if(ot===0)return;const rt=this.doc;rt!==null?transact(rt,ut=>{deleteText(ut,findPosition(ut,this,nt),ot)}):this._pending.push(()=>this.delete(nt,ot))}format(nt,ot,rt){if(ot===0)return;const ut=this.doc;ut!==null?transact(ut,gt=>{const pt=findPosition(gt,this,nt);pt.right!==null&&formatText(gt,this,pt,ot,rt)}):this._pending.push(()=>this.format(nt,ot,rt))}removeAttribute(nt){this.doc!==null?transact(this.doc,ot=>{typeMapDelete(ot,this,nt)}):this._pending.push(()=>this.removeAttribute(nt))}setAttribute(nt,ot){this.doc!==null?transact(this.doc,rt=>{typeMapSet(rt,this,nt,ot)}):this._pending.push(()=>this.setAttribute(nt,ot))}getAttribute(nt){return typeMapGet(this,nt)}getAttributes(){return typeMapGetAll(this)}_write(nt){nt.writeTypeRef(YTextRefID)}}const readYText=ct=>new YText;class YXmlTreeWalker{constructor(nt,ot=()=>!0){this._filter=ot,this._root=nt,this._currentNode=nt._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let nt=this._currentNode,ot=nt&&nt.content&&nt.content.type;if(nt!==null&&(!this._firstCall||nt.deleted||!this._filter(ot)))do if(ot=nt.content.type,!nt.deleted&&(ot.constructor===YXmlElement||ot.constructor===YXmlFragment)&&ot._start!==null)nt=ot._start;else for(;nt!==null;)if(nt.right!==null){nt=nt.right;break}else nt.parent===this._root?nt=null:nt=nt.parent._item;while(nt!==null&&(nt.deleted||!this._filter(nt.content.type)));return this._firstCall=!1,nt===null?{value:void 0,done:!0}:(this._currentNode=nt,{value:nt.content.type,done:!1})}}class YXmlFragment extends AbstractType{constructor(){super(),this._prelimContent=[]}get firstChild(){const nt=this._first;return nt?nt.content.getContent()[0]:null}_integrate(nt,ot){super._integrate(nt,ot),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new YXmlFragment}clone(){const nt=new YXmlFragment;return nt.insert(0,this.toArray().map(ot=>ot instanceof AbstractType?ot.clone():ot)),nt}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(nt){return new YXmlTreeWalker(this,nt)}querySelector(nt){nt=nt.toUpperCase();const rt=new YXmlTreeWalker(this,ut=>ut.nodeName&&ut.nodeName.toUpperCase()===nt).next();return rt.done?null:rt.value}querySelectorAll(nt){return nt=nt.toUpperCase(),from(new YXmlTreeWalker(this,ot=>ot.nodeName&&ot.nodeName.toUpperCase()===nt))}_callObserver(nt,ot){callTypeObservers(this,nt,new YXmlEvent(this,ot,nt))}toString(){return typeListMap(this,nt=>nt.toString()).join("")}toJSON(){return this.toString()}toDOM(nt=document,ot={},rt){const ut=nt.createDocumentFragment();return rt!==void 0&&rt._createAssociation(ut,this),typeListForEach(this,gt=>{ut.insertBefore(gt.toDOM(nt,ot,rt),null)}),ut}insert(nt,ot){this.doc!==null?transact(this.doc,rt=>{typeListInsertGenerics(rt,this,nt,ot)}):this._prelimContent.splice(nt,0,...ot)}insertAfter(nt,ot){if(this.doc!==null)transact(this.doc,rt=>{const ut=nt&&nt instanceof AbstractType?nt._item:nt;typeListInsertGenericsAfter(rt,this,ut,ot)});else{const rt=this._prelimContent,ut=nt===null?0:rt.findIndex(gt=>gt===nt)+1;if(ut===0&&nt!==null)throw create$5("Reference item not found");rt.splice(ut,0,...ot)}}delete(nt,ot=1){this.doc!==null?transact(this.doc,rt=>{typeListDelete(rt,this,nt,ot)}):this._prelimContent.splice(nt,ot)}toArray(){return typeListToArray(this)}push(nt){this.insert(this.length,nt)}unshift(nt){this.insert(0,nt)}get(nt){return typeListGet(this,nt)}slice(nt=0,ot=this.length){return typeListSlice(this,nt,ot)}forEach(nt){typeListForEach(this,nt)}_write(nt){nt.writeTypeRef(YXmlFragmentRefID)}}const readYXmlFragment=ct=>new YXmlFragment;class YXmlElement extends YXmlFragment{constructor(nt="UNDEFINED"){super(),this.nodeName=nt,this._prelimAttrs=new Map}get nextSibling(){const nt=this._item?this._item.next:null;return nt?nt.content.type:null}get prevSibling(){const nt=this._item?this._item.prev:null;return nt?nt.content.type:null}_integrate(nt,ot){super._integrate(nt,ot),this._prelimAttrs.forEach((rt,ut)=>{this.setAttribute(ut,rt)}),this._prelimAttrs=null}_copy(){return new YXmlElement(this.nodeName)}clone(){const nt=new YXmlElement(this.nodeName),ot=this.getAttributes();return forEach(ot,(rt,ut)=>{typeof rt=="string"&&nt.setAttribute(ut,rt)}),nt.insert(0,this.toArray().map(rt=>rt instanceof AbstractType?rt.clone():rt)),nt}toString(){const nt=this.getAttributes(),ot=[],rt=[];for(const mt in nt)rt.push(mt);rt.sort();const ut=rt.length;for(let mt=0;mt<ut;mt++){const vt=rt[mt];ot.push(vt+'="'+nt[vt]+'"')}const gt=this.nodeName.toLocaleLowerCase(),pt=ot.length>0?" "+ot.join(" "):"";return`<${gt}${pt}>${super.toString()}</${gt}>`}removeAttribute(nt){this.doc!==null?transact(this.doc,ot=>{typeMapDelete(ot,this,nt)}):this._prelimAttrs.delete(nt)}setAttribute(nt,ot){this.doc!==null?transact(this.doc,rt=>{typeMapSet(rt,this,nt,ot)}):this._prelimAttrs.set(nt,ot)}getAttribute(nt){return typeMapGet(this,nt)}hasAttribute(nt){return typeMapHas(this,nt)}getAttributes(){return typeMapGetAll(this)}toDOM(nt=document,ot={},rt){const ut=nt.createElement(this.nodeName),gt=this.getAttributes();for(const pt in gt){const mt=gt[pt];typeof mt=="string"&&ut.setAttribute(pt,mt)}return typeListForEach(this,pt=>{ut.appendChild(pt.toDOM(nt,ot,rt))}),rt!==void 0&&rt._createAssociation(ut,this),ut}_write(nt){nt.writeTypeRef(YXmlElementRefID),nt.writeKey(this.nodeName)}}const readYXmlElement=ct=>new YXmlElement(ct.readKey());class YXmlEvent extends YEvent{constructor(nt,ot,rt){super(nt,rt),this.childListChanged=!1,this.attributesChanged=new Set,ot.forEach(ut=>{ut===null?this.childListChanged=!0:this.attributesChanged.add(ut)})}}class YXmlHook extends YMap{constructor(nt){super(),this.hookName=nt}_copy(){return new YXmlHook(this.hookName)}clone(){const nt=new YXmlHook(this.hookName);return this.forEach((ot,rt)=>{nt.set(rt,ot)}),nt}toDOM(nt=document,ot={},rt){const ut=ot[this.hookName];let gt;return ut!==void 0?gt=ut.createDom(this):gt=document.createElement(this.hookName),gt.setAttribute("data-yjs-hook",this.hookName),rt!==void 0&&rt._createAssociation(gt,this),gt}_write(nt){nt.writeTypeRef(YXmlHookRefID),nt.writeKey(this.hookName)}}const readYXmlHook=ct=>new YXmlHook(ct.readKey());class YXmlText extends YText{get nextSibling(){const nt=this._item?this._item.next:null;return nt?nt.content.type:null}get prevSibling(){const nt=this._item?this._item.prev:null;return nt?nt.content.type:null}_copy(){return new YXmlText}clone(){const nt=new YXmlText;return nt.applyDelta(this.toDelta()),nt}toDOM(nt=document,ot,rt){const ut=nt.createTextNode(this.toString());return rt!==void 0&&rt._createAssociation(ut,this),ut}toString(){return this.toDelta().map(nt=>{const ot=[];for(const ut in nt.attributes){const gt=[];for(const pt in nt.attributes[ut])gt.push({key:pt,value:nt.attributes[ut][pt]});gt.sort((pt,mt)=>pt.key<mt.key?-1:1),ot.push({nodeName:ut,attrs:gt})}ot.sort((ut,gt)=>ut.nodeName<gt.nodeName?-1:1);let rt="";for(let ut=0;ut<ot.length;ut++){const gt=ot[ut];rt+=`<${gt.nodeName}`;for(let pt=0;pt<gt.attrs.length;pt++){const mt=gt.attrs[pt];rt+=` ${mt.key}="${mt.value}"`}rt+=">"}rt+=nt.insert;for(let ut=ot.length-1;ut>=0;ut--)rt+=`</${ot[ut].nodeName}>`;return rt}).join("")}toJSON(){return this.toString()}_write(nt){nt.writeTypeRef(YXmlTextRefID)}}const readYXmlText=ct=>new YXmlText;class AbstractStruct{constructor(nt,ot){this.id=nt,this.length=ot}get deleted(){throw methodUnimplemented()}mergeWith(nt){return!1}write(nt,ot,rt){throw methodUnimplemented()}integrate(nt,ot){throw methodUnimplemented()}}const structGCRefNumber=0;class GC extends AbstractStruct{get deleted(){return!0}delete(){}mergeWith(nt){return this.constructor!==nt.constructor?!1:(this.length+=nt.length,!0)}integrate(nt,ot){ot>0&&(this.id.clock+=ot,this.length-=ot),addStruct(nt.doc.store,this)}write(nt,ot){nt.writeInfo(structGCRefNumber),nt.writeLen(this.length-ot)}getMissing(nt,ot){return null}}class ContentBinary{constructor(nt){this.content=nt}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new ContentBinary(this.content)}splice(nt){throw methodUnimplemented()}mergeWith(nt){return!1}integrate(nt,ot){}delete(nt){}gc(nt){}write(nt,ot){nt.writeBuf(this.content)}getRef(){return 3}}const readContentBinary=ct=>new ContentBinary(ct.readBuf());class ContentDeleted{constructor(nt){this.len=nt}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new ContentDeleted(this.len)}splice(nt){const ot=new ContentDeleted(this.len-nt);return this.len=nt,ot}mergeWith(nt){return this.len+=nt.len,!0}integrate(nt,ot){addToDeleteSet(nt.deleteSet,ot.id.client,ot.id.clock,this.len),ot.markDeleted()}delete(nt){}gc(nt){}write(nt,ot){nt.writeLen(this.len-ot)}getRef(){return 1}}const readContentDeleted=ct=>new ContentDeleted(ct.readLen()),createDocFromOpts=(ct,nt)=>new Doc({guid:ct,...nt,shouldLoad:nt.shouldLoad||nt.autoLoad||!1});class ContentDoc{constructor(nt){nt._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=nt;const ot={};this.opts=ot,nt.gc||(ot.gc=!1),nt.autoLoad&&(ot.autoLoad=!0),nt.meta!==null&&(ot.meta=nt.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new ContentDoc(createDocFromOpts(this.doc.guid,this.opts))}splice(nt){throw methodUnimplemented()}mergeWith(nt){return!1}integrate(nt,ot){this.doc._item=ot,nt.subdocsAdded.add(this.doc),this.doc.shouldLoad&&nt.subdocsLoaded.add(this.doc)}delete(nt){nt.subdocsAdded.has(this.doc)?nt.subdocsAdded.delete(this.doc):nt.subdocsRemoved.add(this.doc)}gc(nt){}write(nt,ot){nt.writeString(this.doc.guid),nt.writeAny(this.opts)}getRef(){return 9}}const readContentDoc=ct=>new ContentDoc(createDocFromOpts(ct.readString(),ct.readAny()));class ContentEmbed{constructor(nt){this.embed=nt}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new ContentEmbed(this.embed)}splice(nt){throw methodUnimplemented()}mergeWith(nt){return!1}integrate(nt,ot){}delete(nt){}gc(nt){}write(nt,ot){nt.writeJSON(this.embed)}getRef(){return 5}}const readContentEmbed=ct=>new ContentEmbed(ct.readJSON());class ContentFormat{constructor(nt,ot){this.key=nt,this.value=ot}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ContentFormat(this.key,this.value)}splice(nt){throw methodUnimplemented()}mergeWith(nt){return!1}integrate(nt,ot){const rt=ot.parent;rt._searchMarker=null,rt._hasFormatting=!0}delete(nt){}gc(nt){}write(nt,ot){nt.writeKey(this.key),nt.writeJSON(this.value)}getRef(){return 6}}const readContentFormat=ct=>new ContentFormat(ct.readKey(),ct.readJSON());class ContentJSON{constructor(nt){this.arr=nt}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ContentJSON(this.arr)}splice(nt){const ot=new ContentJSON(this.arr.slice(nt));return this.arr=this.arr.slice(0,nt),ot}mergeWith(nt){return this.arr=this.arr.concat(nt.arr),!0}integrate(nt,ot){}delete(nt){}gc(nt){}write(nt,ot){const rt=this.arr.length;nt.writeLen(rt-ot);for(let ut=ot;ut<rt;ut++){const gt=this.arr[ut];nt.writeString(gt===void 0?"undefined":JSON.stringify(gt))}}getRef(){return 2}}const readContentJSON=ct=>{const nt=ct.readLen(),ot=[];for(let rt=0;rt<nt;rt++){const ut=ct.readString();ut==="undefined"?ot.push(void 0):ot.push(JSON.parse(ut))}return new ContentJSON(ot)};class ContentAny{constructor(nt){this.arr=nt}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ContentAny(this.arr)}splice(nt){const ot=new ContentAny(this.arr.slice(nt));return this.arr=this.arr.slice(0,nt),ot}mergeWith(nt){return this.arr=this.arr.concat(nt.arr),!0}integrate(nt,ot){}delete(nt){}gc(nt){}write(nt,ot){const rt=this.arr.length;nt.writeLen(rt-ot);for(let ut=ot;ut<rt;ut++){const gt=this.arr[ut];nt.writeAny(gt)}}getRef(){return 8}}const readContentAny=ct=>{const nt=ct.readLen(),ot=[];for(let rt=0;rt<nt;rt++)ot.push(ct.readAny());return new ContentAny(ot)};class ContentString{constructor(nt){this.str=nt}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ContentString(this.str)}splice(nt){const ot=new ContentString(this.str.slice(nt));this.str=this.str.slice(0,nt);const rt=this.str.charCodeAt(nt-1);return rt>=55296&&rt<=56319&&(this.str=this.str.slice(0,nt-1)+"",ot.str=""+ot.str.slice(1)),ot}mergeWith(nt){return this.str+=nt.str,!0}integrate(nt,ot){}delete(nt){}gc(nt){}write(nt,ot){nt.writeString(ot===0?this.str:this.str.slice(ot))}getRef(){return 4}}const readContentString=ct=>new ContentString(ct.readString()),typeRefs=[readYArray,readYMap,readYText,readYXmlElement,readYXmlFragment,readYXmlHook,readYXmlText],YArrayRefID=0,YMapRefID=1,YTextRefID=2,YXmlElementRefID=3,YXmlFragmentRefID=4,YXmlHookRefID=5,YXmlTextRefID=6;class ContentType{constructor(nt){this.type=nt}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new ContentType(this.type._copy())}splice(nt){throw methodUnimplemented()}mergeWith(nt){return!1}integrate(nt,ot){this.type._integrate(nt.doc,ot)}delete(nt){let ot=this.type._start;for(;ot!==null;)ot.deleted?ot.id.clock<(nt.beforeState.get(ot.id.client)||0)&&nt._mergeStructs.push(ot):ot.delete(nt),ot=ot.right;this.type._map.forEach(rt=>{rt.deleted?rt.id.clock<(nt.beforeState.get(rt.id.client)||0)&&nt._mergeStructs.push(rt):rt.delete(nt)}),nt.changed.delete(this.type)}gc(nt){let ot=this.type._start;for(;ot!==null;)ot.gc(nt,!0),ot=ot.right;this.type._start=null,this.type._map.forEach(rt=>{for(;rt!==null;)rt.gc(nt,!0),rt=rt.left}),this.type._map=new Map}write(nt,ot){this.type._write(nt)}getRef(){return 7}}const readContentType=ct=>new ContentType(typeRefs[ct.readTypeRef()](ct)),followRedone=(ct,nt)=>{let ot=nt,rt=0,ut;do rt>0&&(ot=createID(ot.client,ot.clock+rt)),ut=getItem(ct,ot),rt=ot.clock-ut.id.clock,ot=ut.redone;while(ot!==null&&ut instanceof Item);return{item:ut,diff:rt}},splitItem=(ct,nt,ot)=>{const{client:rt,clock:ut}=nt.id,gt=new Item(createID(rt,ut+ot),nt,createID(rt,ut+ot-1),nt.right,nt.rightOrigin,nt.parent,nt.parentSub,nt.content.splice(ot));return nt.deleted&&gt.markDeleted(),nt.keep&&(gt.keep=!0),nt.redone!==null&&(gt.redone=createID(nt.redone.client,nt.redone.clock+ot)),nt.right=gt,gt.right!==null&&(gt.right.left=gt),ct._mergeStructs.push(gt),gt.parentSub!==null&&gt.right===null&&gt.parent._map.set(gt.parentSub,gt),nt.length=ot,gt};class Item extends AbstractStruct{constructor(nt,ot,rt,ut,gt,pt,mt,vt){super(nt,vt.getLength()),this.origin=rt,this.left=ot,this.right=ut,this.rightOrigin=gt,this.parent=pt,this.parentSub=mt,this.redone=null,this.content=vt,this.info=this.content.isCountable()?BIT2:0}set marker(nt){(this.info&BIT4)>0!==nt&&(this.info^=BIT4)}get marker(){return(this.info&BIT4)>0}get keep(){return(this.info&BIT1)>0}set keep(nt){this.keep!==nt&&(this.info^=BIT1)}get countable(){return(this.info&BIT2)>0}get deleted(){return(this.info&BIT3)>0}set deleted(nt){this.deleted!==nt&&(this.info^=BIT3)}markDeleted(){this.info|=BIT3}getMissing(nt,ot){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=getState(ot,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=getState(ot,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ID&&this.id.client!==this.parent.client&&this.parent.clock>=getState(ot,this.parent.client))return this.parent.client;if(this.origin&&(this.left=getItemCleanEnd(nt,ot,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=getItemCleanStart(nt,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===GC||this.right&&this.right.constructor===GC)&&(this.parent=null),!this.parent)this.left&&this.left.constructor===Item&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Item&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===ID){const rt=getItem(ot,this.parent);rt.constructor===GC?this.parent=null:this.parent=rt.content.type}return null}integrate(nt,ot){if(ot>0&&(this.id.clock+=ot,this.left=getItemCleanEnd(nt,nt.doc.store,createID(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(ot),this.length-=ot),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let rt=this.left,ut;if(rt!==null)ut=rt.right;else if(this.parentSub!==null)for(ut=this.parent._map.get(this.parentSub)||null;ut!==null&&ut.left!==null;)ut=ut.left;else ut=this.parent._start;const gt=new Set,pt=new Set;for(;ut!==null&&ut!==this.right;){if(pt.add(ut),gt.add(ut),compareIDs(this.origin,ut.origin)){if(ut.id.client<this.id.client)rt=ut,gt.clear();else if(compareIDs(this.rightOrigin,ut.rightOrigin))break}else if(ut.origin!==null&&pt.has(getItem(nt.doc.store,ut.origin)))gt.has(getItem(nt.doc.store,ut.origin))||(rt=ut,gt.clear());else break;ut=ut.right}this.left=rt}if(this.left!==null){const rt=this.left.right;this.right=rt,this.left.right=this}else{let rt;if(this.parentSub!==null)for(rt=this.parent._map.get(this.parentSub)||null;rt!==null&&rt.left!==null;)rt=rt.left;else rt=this.parent._start,this.parent._start=this;this.right=rt}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(nt)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),addStruct(nt.doc.store,this),this.content.integrate(nt,this),addChangedTypeToTransaction(nt,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(nt)}else new GC(this.id,this.length).integrate(nt,0)}get next(){let nt=this.right;for(;nt!==null&&nt.deleted;)nt=nt.right;return nt}get prev(){let nt=this.left;for(;nt!==null&&nt.deleted;)nt=nt.left;return nt}get lastId(){return this.length===1?this.id:createID(this.id.client,this.id.clock+this.length-1)}mergeWith(nt){if(this.constructor===nt.constructor&&compareIDs(nt.origin,this.lastId)&&this.right===nt&&compareIDs(this.rightOrigin,nt.rightOrigin)&&this.id.client===nt.id.client&&this.id.clock+this.length===nt.id.clock&&this.deleted===nt.deleted&&this.redone===null&&nt.redone===null&&this.content.constructor===nt.content.constructor&&this.content.mergeWith(nt.content)){const ot=this.parent._searchMarker;return ot&&ot.forEach(rt=>{rt.p===nt&&(rt.p=this,!this.deleted&&this.countable&&(rt.index-=this.length))}),nt.keep&&(this.keep=!0),this.right=nt.right,this.right!==null&&(this.right.left=this),this.length+=nt.length,!0}return!1}delete(nt){if(!this.deleted){const ot=this.parent;this.countable&&this.parentSub===null&&(ot._length-=this.length),this.markDeleted(),addToDeleteSet(nt.deleteSet,this.id.client,this.id.clock,this.length),addChangedTypeToTransaction(nt,ot,this.parentSub),this.content.delete(nt)}}gc(nt,ot){if(!this.deleted)throw unexpectedCase();this.content.gc(nt),ot?replaceStruct(nt,this,new GC(this.id,this.length)):this.content=new ContentDeleted(this.length)}write(nt,ot){const rt=ot>0?createID(this.id.client,this.id.clock+ot-1):this.origin,ut=this.rightOrigin,gt=this.parentSub,pt=this.content.getRef()&BITS5|(rt===null?0:BIT8)|(ut===null?0:BIT7)|(gt===null?0:BIT6);if(nt.writeInfo(pt),rt!==null&&nt.writeLeftID(rt),ut!==null&&nt.writeRightID(ut),rt===null&&ut===null){const mt=this.parent;if(mt._item!==void 0){const vt=mt._item;if(vt===null){const St=findRootTypeKey(mt);nt.writeParentInfo(!0),nt.writeString(St)}else nt.writeParentInfo(!1),nt.writeLeftID(vt.id)}else mt.constructor===String?(nt.writeParentInfo(!0),nt.writeString(mt)):mt.constructor===ID?(nt.writeParentInfo(!1),nt.writeLeftID(mt)):unexpectedCase();gt!==null&&nt.writeString(gt)}this.content.write(nt,ot)}}const readItemContent=(ct,nt)=>contentRefs[nt&BITS5](ct),contentRefs=[()=>{unexpectedCase()},readContentDeleted,readContentJSON,readContentBinary,readContentString,readContentEmbed,readContentFormat,readContentType,readContentAny,readContentDoc,()=>{unexpectedCase()}],structSkipRefNumber=10;class Skip extends AbstractStruct{get deleted(){return!0}delete(){}mergeWith(nt){return this.constructor!==nt.constructor?!1:(this.length+=nt.length,!0)}integrate(nt,ot){unexpectedCase()}write(nt,ot){nt.writeInfo(structSkipRefNumber),writeVarUint(nt.restEncoder,this.length-ot)}getMissing(nt,ot){return null}}const glo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},importIdentifier="__ $YJS$ __";glo[importIdentifier]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");glo[importIdentifier]=!0;const reconnectTimeoutBase=1200,maxReconnectTimeout=2500,messageReconnectTimeout=3e4,setupWS=ct=>{if(ct.shouldConnect&&ct.ws===null){const nt=new WebSocket(ct.url),ot=ct.binaryType;let rt=null;ot&&(nt.binaryType=ot),ct.ws=nt,ct.connecting=!0,ct.connected=!1,nt.onmessage=pt=>{ct.lastMessageReceived=getUnixTime();const mt=pt.data,vt=typeof mt=="string"?JSON.parse(mt):mt;vt&&vt.type==="pong"&&(clearTimeout(rt),rt=setTimeout(gt,messageReconnectTimeout/2)),ct.emit("message",[vt,ct])};const ut=pt=>{ct.ws!==null&&(ct.ws=null,ct.connecting=!1,ct.connected?(ct.connected=!1,ct.emit("disconnect",[{type:"disconnect",error:pt},ct])):ct.unsuccessfulReconnects++,setTimeout(setupWS,min(log10(ct.unsuccessfulReconnects+1)*reconnectTimeoutBase,maxReconnectTimeout),ct)),clearTimeout(rt)},gt=()=>{ct.ws===nt&&ct.send({type:"ping"})};nt.onclose=()=>ut(null),nt.onerror=pt=>ut(pt),nt.onopen=()=>{ct.lastMessageReceived=getUnixTime(),ct.connecting=!1,ct.connected=!0,ct.unsuccessfulReconnects=0,ct.emit("connect",[{type:"connect"},ct]),rt=setTimeout(gt,messageReconnectTimeout/2)}}};class WebsocketClient extends Observable{constructor(nt,{binaryType:ot}={}){super(),this.url=nt,this.ws=null,this.binaryType=ot||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&messageReconnectTimeout<getUnixTime()-this.lastMessageReceived&&this.ws.close()},messageReconnectTimeout/2),setupWS(this)}send(nt){this.ws&&this.ws.send(JSON.stringify(nt))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&setupWS(this)}}const channels=new Map;class LocalStoragePolyfill{constructor(nt){this.room=nt,this.onmessage=null,this._onChange=ot=>ot.key===nt&&this.onmessage!==null&&this.onmessage({data:fromBase64(ot.newValue||"")}),onChange(this._onChange)}postMessage(nt){varStorage.setItem(this.room,toBase64(createUint8ArrayFromArrayBuffer(nt)))}close(){offChange(this._onChange)}}const BC=typeof BroadcastChannel>"u"?LocalStoragePolyfill:BroadcastChannel,getChannel=ct=>setIfUndefined(channels,ct,()=>{const nt=create$6(),ot=new BC(ct);return ot.onmessage=rt=>nt.forEach(ut=>ut(rt.data,"broadcastchannel")),{bc:ot,subs:nt}}),subscribe=(ct,nt)=>(getChannel(ct).subs.add(nt),nt),unsubscribe=(ct,nt)=>{const ot=getChannel(ct),rt=ot.subs.delete(nt);return rt&&ot.subs.size===0&&(ot.bc.close(),channels.delete(ct)),rt},publish=(ct,nt,ot=null)=>{const rt=getChannel(ct);rt.bc.postMessage(nt),rt.subs.forEach(ut=>ut(nt,ot))},createMutex=()=>{let ct=!0;return(nt,ot)=>{if(ct){ct=!1;try{nt()}finally{ct=!0}}else ot!==void 0&&ot()}};function commonjsRequire(ct){throw new Error('Could not dynamically require "'+ct+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var simplepeer_min={exports:{}};(function(ct,nt){(function(ot){ct.exports=ot()})(function(){var ot=Math.floor,rt=Math.abs,ut=Math.pow;return function(){function gt(pt,mt,vt){function St(Lt,xt){if(!mt[Lt]){if(!pt[Lt]){var It=typeof commonjsRequire=="function"&&commonjsRequire;if(!xt&&It)return It(Lt,!0);if(yt)return yt(Lt,!0);var kt=new Error("Cannot find module '"+Lt+"'");throw kt.code="MODULE_NOT_FOUND",kt}var At=mt[Lt]={exports:{}};pt[Lt][0].call(At.exports,function(Tt){var Rt=pt[Lt][1][Tt];return St(Rt||Tt)},At,At.exports,gt,pt,mt,vt)}return mt[Lt].exports}for(var yt=typeof commonjsRequire=="function"&&commonjsRequire,wt=0;wt<vt.length;wt++)St(vt[wt]);return St}return gt}()({1:[function(gt,pt,mt){function vt(Pt){var Ft=Pt.length;if(0<Ft%4)throw new Error("Invalid string. Length must be a multiple of 4");var Kt=Pt.indexOf("=");Kt===-1&&(Kt=Ft);var Bt=Kt===Ft?0:4-Kt%4;return[Kt,Bt]}function St(Pt,Ft,Kt){return 3*(Ft+Kt)/4-Kt}function yt(Pt){var Ft,Kt,Bt=vt(Pt),Ut=Bt[0],qt=Bt[1],Yt=new At(St(Pt,Ut,qt)),Zt=0,Xt=0<qt?Ut-4:Ut;for(Kt=0;Kt<Xt;Kt+=4)Ft=kt[Pt.charCodeAt(Kt)]<<18|kt[Pt.charCodeAt(Kt+1)]<<12|kt[Pt.charCodeAt(Kt+2)]<<6|kt[Pt.charCodeAt(Kt+3)],Yt[Zt++]=255&Ft>>16,Yt[Zt++]=255&Ft>>8,Yt[Zt++]=255&Ft;return qt===2&&(Ft=kt[Pt.charCodeAt(Kt)]<<2|kt[Pt.charCodeAt(Kt+1)]>>4,Yt[Zt++]=255&Ft),qt===1&&(Ft=kt[Pt.charCodeAt(Kt)]<<10|kt[Pt.charCodeAt(Kt+1)]<<4|kt[Pt.charCodeAt(Kt+2)]>>2,Yt[Zt++]=255&Ft>>8,Yt[Zt++]=255&Ft),Yt}function wt(Pt){return It[63&Pt>>18]+It[63&Pt>>12]+It[63&Pt>>6]+It[63&Pt]}function Lt(Pt,Ft,Kt){for(var Bt,Ut=[],qt=Ft;qt<Kt;qt+=3)Bt=(16711680&Pt[qt]<<16)+(65280&Pt[qt+1]<<8)+(255&Pt[qt+2]),Ut.push(wt(Bt));return Ut.join("")}function xt(Pt){for(var Ft,Kt=Pt.length,Bt=Kt%3,Ut=[],qt=16383,Yt=0,Zt=Kt-Bt;Yt<Zt;Yt+=qt)Ut.push(Lt(Pt,Yt,Yt+qt>Zt?Zt:Yt+qt));return Bt===1?(Ft=Pt[Kt-1],Ut.push(It[Ft>>2]+It[63&Ft<<4]+"==")):Bt===2&&(Ft=(Pt[Kt-2]<<8)+Pt[Kt-1],Ut.push(It[Ft>>10]+It[63&Ft>>4]+It[63&Ft<<2]+"=")),Ut.join("")}mt.byteLength=function(Pt){var Ft=vt(Pt),Kt=Ft[0],Bt=Ft[1];return 3*(Kt+Bt)/4-Bt},mt.toByteArray=yt,mt.fromByteArray=xt;for(var It=[],kt=[],At=typeof Uint8Array>"u"?Array:Uint8Array,Tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Rt=0,Nt=Tt.length;Rt<Nt;++Rt)It[Rt]=Tt[Rt],kt[Tt.charCodeAt(Rt)]=Rt;kt[45]=62,kt[95]=63},{}],2:[function(){},{}],3:[function(gt,pt,mt){(function(){(function(){var vt=String.fromCharCode,St=Math.min;function yt($t){if(2147483647<$t)throw new RangeError('The value "'+$t+'" is invalid for option "size"');var zt=new Uint8Array($t);return zt.__proto__=wt.prototype,zt}function wt($t,zt,jt){if(typeof $t=="number"){if(typeof zt=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return kt($t)}return Lt($t,zt,jt)}function Lt($t,zt,jt){if(typeof $t=="string")return At($t,zt);if(ArrayBuffer.isView($t))return Tt($t);if($t==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof $t);if(ln($t,ArrayBuffer)||$t&&ln($t.buffer,ArrayBuffer))return Rt($t,zt,jt);if(typeof $t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Gt=$t.valueOf&&$t.valueOf();if(Gt!=null&&Gt!==$t)return wt.from(Gt,zt,jt);var Qt=Nt($t);if(Qt)return Qt;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof $t[Symbol.toPrimitive]=="function")return wt.from($t[Symbol.toPrimitive]("string"),zt,jt);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof $t)}function xt($t){if(typeof $t!="number")throw new TypeError('"size" argument must be of type number');if(0>$t)throw new RangeError('The value "'+$t+'" is invalid for option "size"')}function It($t,zt,jt){return xt($t),0>=$t||zt===void 0?yt($t):typeof jt=="string"?yt($t).fill(zt,jt):yt($t).fill(zt)}function kt($t){return xt($t),yt(0>$t?0:0|Pt($t))}function At($t,zt){if((typeof zt!="string"||zt==="")&&(zt="utf8"),!wt.isEncoding(zt))throw new TypeError("Unknown encoding: "+zt);var jt=0|Ft($t,zt),Gt=yt(jt),Qt=Gt.write($t,zt);return Qt!==jt&&(Gt=Gt.slice(0,Qt)),Gt}function Tt($t){for(var zt=0>$t.length?0:0|Pt($t.length),jt=yt(zt),Gt=0;Gt<zt;Gt+=1)jt[Gt]=255&$t[Gt];return jt}function Rt($t,zt,jt){if(0>zt||$t.byteLength<zt)throw new RangeError('"offset" is outside of buffer bounds');if($t.byteLength<zt+(jt||0))throw new RangeError('"length" is outside of buffer bounds');var Gt;return Gt=zt===void 0&&jt===void 0?new Uint8Array($t):jt===void 0?new Uint8Array($t,zt):new Uint8Array($t,zt,jt),Gt.__proto__=wt.prototype,Gt}function Nt($t){if(wt.isBuffer($t)){var zt=0|Pt($t.length),jt=yt(zt);return jt.length===0||$t.copy(jt,0,0,zt),jt}return $t.length===void 0?$t.type==="Buffer"&&Array.isArray($t.data)?Tt($t.data):void 0:typeof $t.length!="number"||fn($t.length)?yt(0):Tt($t)}function Pt($t){if($t>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|$t}function Ft($t,zt){if(wt.isBuffer($t))return $t.length;if(ArrayBuffer.isView($t)||ln($t,ArrayBuffer))return $t.byteLength;if(typeof $t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof $t);var jt=$t.length,Gt=2<arguments.length&&arguments[2]===!0;if(!Gt&&jt===0)return 0;for(var Qt=!1;;)switch(zt){case"ascii":case"latin1":case"binary":return jt;case"utf8":case"utf-8":return Un($t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*jt;case"hex":return jt>>>1;case"base64":return Gn($t).length;default:if(Qt)return Gt?-1:Un($t).length;zt=(""+zt).toLowerCase(),Qt=!0}}function Kt($t,zt,jt){var Gt=!1;if((zt===void 0||0>zt)&&(zt=0),zt>this.length||((jt===void 0||jt>this.length)&&(jt=this.length),0>=jt)||(jt>>>=0,zt>>>=0,jt<=zt))return"";for($t||($t="utf8");;)switch($t){case"hex":return _n(this,zt,jt);case"utf8":case"utf-8":return bn(this,zt,jt);case"ascii":return an(this,zt,jt);case"latin1":case"binary":return Cn(this,zt,jt);case"base64":return dn(this,zt,jt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return hn(this,zt,jt);default:if(Gt)throw new TypeError("Unknown encoding: "+$t);$t=($t+"").toLowerCase(),Gt=!0}}function Bt($t,zt,jt){var Gt=$t[zt];$t[zt]=$t[jt],$t[jt]=Gt}function Ut($t,zt,jt,Gt,Qt){if($t.length===0)return-1;if(typeof jt=="string"?(Gt=jt,jt=0):2147483647<jt?jt=2147483647:-2147483648>jt&&(jt=-2147483648),jt=+jt,fn(jt)&&(jt=Qt?0:$t.length-1),0>jt&&(jt=$t.length+jt),jt>=$t.length){if(Qt)return-1;jt=$t.length-1}else if(0>jt)if(Qt)jt=0;else return-1;if(typeof zt=="string"&&(zt=wt.from(zt,Gt)),wt.isBuffer(zt))return zt.length===0?-1:qt($t,zt,jt,Gt,Qt);if(typeof zt=="number")return zt&=255,typeof Uint8Array.prototype.indexOf=="function"?Qt?Uint8Array.prototype.indexOf.call($t,zt,jt):Uint8Array.prototype.lastIndexOf.call($t,zt,jt):qt($t,[zt],jt,Gt,Qt);throw new TypeError("val must be string, number or Buffer")}function qt($t,zt,jt,Gt,Qt){function Jt(An,Rn){return en===1?An[Rn]:An.readUInt16BE(Rn*en)}var en=1,sn=$t.length,gn=zt.length;if(Gt!==void 0&&(Gt=(Gt+"").toLowerCase(),Gt==="ucs2"||Gt==="ucs-2"||Gt==="utf16le"||Gt==="utf-16le")){if(2>$t.length||2>zt.length)return-1;en=2,sn/=2,gn/=2,jt/=2}var mn;if(Qt){var vn=-1;for(mn=jt;mn<sn;mn++)if(Jt($t,mn)!==Jt(zt,vn===-1?0:mn-vn))vn!==-1&&(mn-=mn-vn),vn=-1;else if(vn===-1&&(vn=mn),mn-vn+1===gn)return vn*en}else for(jt+gn>sn&&(jt=sn-gn),mn=jt;0<=mn;mn--){for(var En=!0,Dn=0;Dn<gn;Dn++)if(Jt($t,mn+Dn)!==Jt(zt,Dn)){En=!1;break}if(En)return mn}return-1}function Yt($t,zt,jt,Gt){jt=+jt||0;var Qt=$t.length-jt;Gt?(Gt=+Gt,Gt>Qt&&(Gt=Qt)):Gt=Qt;var Jt=zt.length;Gt>Jt/2&&(Gt=Jt/2);for(var en,sn=0;sn<Gt;++sn){if(en=parseInt(zt.substr(2*sn,2),16),fn(en))return sn;$t[jt+sn]=en}return sn}function Zt($t,zt,jt,Gt){return qn(Un(zt,$t.length-jt),$t,jt,Gt)}function Xt($t,zt,jt,Gt){return qn(In(zt),$t,jt,Gt)}function _i($t,zt,jt,Gt){return Xt($t,zt,jt,Gt)}function nn($t,zt,jt,Gt){return qn(Gn(zt),$t,jt,Gt)}function rn($t,zt,jt,Gt){return qn(jn(zt,$t.length-jt),$t,jt,Gt)}function dn($t,zt,jt){return zt===0&&jt===$t.length?Sn.fromByteArray($t):Sn.fromByteArray($t.slice(zt,jt))}function bn($t,zt,jt){jt=St($t.length,jt);for(var Gt=[],Qt=zt;Qt<jt;){var Jt=$t[Qt],en=null,sn=239<Jt?4:223<Jt?3:191<Jt?2:1;if(Qt+sn<=jt){var gn,mn,vn,En;sn===1?128>Jt&&(en=Jt):sn===2?(gn=$t[Qt+1],(192&gn)==128&&(En=(31&Jt)<<6|63&gn,127<En&&(en=En))):sn===3?(gn=$t[Qt+1],mn=$t[Qt+2],(192&gn)==128&&(192&mn)==128&&(En=(15&Jt)<<12|(63&gn)<<6|63&mn,2047<En&&(55296>En||57343<En)&&(en=En))):sn===4&&(gn=$t[Qt+1],mn=$t[Qt+2],vn=$t[Qt+3],(192&gn)==128&&(192&mn)==128&&(192&vn)==128&&(En=(15&Jt)<<18|(63&gn)<<12|(63&mn)<<6|63&vn,65535<En&&1114112>En&&(en=En)))}en===null?(en=65533,sn=1):65535<en&&(en-=65536,Gt.push(55296|1023&en>>>10),en=56320|1023&en),Gt.push(en),Qt+=sn}return un(Gt)}function un($t){var zt=$t.length;if(zt<=4096)return vt.apply(String,$t);for(var jt="",Gt=0;Gt<zt;)jt+=vt.apply(String,$t.slice(Gt,Gt+=4096));return jt}function an($t,zt,jt){var Gt="";jt=St($t.length,jt);for(var Qt=zt;Qt<jt;++Qt)Gt+=vt(127&$t[Qt]);return Gt}function Cn($t,zt,jt){var Gt="";jt=St($t.length,jt);for(var Qt=zt;Qt<jt;++Qt)Gt+=vt($t[Qt]);return Gt}function _n($t,zt,jt){var Gt=$t.length;(!zt||0>zt)&&(zt=0),(!jt||0>jt||jt>Gt)&&(jt=Gt);for(var Qt="",Jt=zt;Jt<jt;++Jt)Qt+=Xn($t[Jt]);return Qt}function hn($t,zt,jt){for(var Gt=$t.slice(zt,jt),Qt="",Jt=0;Jt<Gt.length;Jt+=2)Qt+=vt(Gt[Jt]+256*Gt[Jt+1]);return Qt}function pn($t,zt,jt){if($t%1!=0||0>$t)throw new RangeError("offset is not uint");if($t+zt>jt)throw new RangeError("Trying to access beyond buffer length")}function yn($t,zt,jt,Gt,Qt,Jt){if(!wt.isBuffer($t))throw new TypeError('"buffer" argument must be a Buffer instance');if(zt>Qt||zt<Jt)throw new RangeError('"value" argument is out of bounds');if(jt+Gt>$t.length)throw new RangeError("Index out of range")}function Mn($t,zt,jt,Gt){if(jt+Gt>$t.length)throw new RangeError("Index out of range");if(0>jt)throw new RangeError("Index out of range")}function Nn($t,zt,jt,Gt,Qt){return zt=+zt,jt>>>=0,Qt||Mn($t,zt,jt,4),xn.write($t,zt,jt,Gt,23,4),jt+4}function Wn($t,zt,jt,Gt,Qt){return zt=+zt,jt>>>=0,Qt||Mn($t,zt,jt,8),xn.write($t,zt,jt,Gt,52,8),jt+8}function Jn($t){if($t=$t.split("=")[0],$t=$t.trim().replace(tn,""),2>$t.length)return"";for(;$t.length%4!=0;)$t+="=";return $t}function Xn($t){return 16>$t?"0"+$t.toString(16):$t.toString(16)}function Un($t,zt){zt=zt||1/0;for(var jt,Gt=$t.length,Qt=null,Jt=[],en=0;en<Gt;++en){if(jt=$t.charCodeAt(en),55295<jt&&57344>jt){if(!Qt){if(56319<jt){-1<(zt-=3)&&Jt.push(239,191,189);continue}else if(en+1===Gt){-1<(zt-=3)&&Jt.push(239,191,189);continue}Qt=jt;continue}if(56320>jt){-1<(zt-=3)&&Jt.push(239,191,189),Qt=jt;continue}jt=(Qt-55296<<10|jt-56320)+65536}else Qt&&-1<(zt-=3)&&Jt.push(239,191,189);if(Qt=null,128>jt){if(0>(zt-=1))break;Jt.push(jt)}else if(2048>jt){if(0>(zt-=2))break;Jt.push(192|jt>>6,128|63&jt)}else if(65536>jt){if(0>(zt-=3))break;Jt.push(224|jt>>12,128|63&jt>>6,128|63&jt)}else if(1114112>jt){if(0>(zt-=4))break;Jt.push(240|jt>>18,128|63&jt>>12,128|63&jt>>6,128|63&jt)}else throw new Error("Invalid code point")}return Jt}function In($t){for(var zt=[],jt=0;jt<$t.length;++jt)zt.push(255&$t.charCodeAt(jt));return zt}function jn($t,zt){for(var jt,Gt,Qt,Jt=[],en=0;en<$t.length&&!(0>(zt-=2));++en)jt=$t.charCodeAt(en),Gt=jt>>8,Qt=jt%256,Jt.push(Qt),Jt.push(Gt);return Jt}function Gn($t){return Sn.toByteArray(Jn($t))}function qn($t,zt,jt,Gt){for(var Qt=0;Qt<Gt&&!(Qt+jt>=zt.length||Qt>=$t.length);++Qt)zt[Qt+jt]=$t[Qt];return Qt}function ln($t,zt){return $t instanceof zt||$t!=null&&$t.constructor!=null&&$t.constructor.name!=null&&$t.constructor.name===zt.name}function fn($t){return $t!==$t}var Sn=gt("base64-js"),xn=gt("ieee754");mt.Buffer=wt,mt.SlowBuffer=function($t){return+$t!=$t&&($t=0),wt.alloc(+$t)},mt.INSPECT_MAX_BYTES=50,mt.kMaxLength=2147483647,wt.TYPED_ARRAY_SUPPORT=function(){try{var $t=new Uint8Array(1);return $t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},$t.foo()===42}catch{return!1}}(),wt.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(wt.prototype,"parent",{enumerable:!0,get:function(){return wt.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(wt.prototype,"offset",{enumerable:!0,get:function(){return wt.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&wt[Symbol.species]===wt&&Object.defineProperty(wt,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),wt.poolSize=8192,wt.from=function($t,zt,jt){return Lt($t,zt,jt)},wt.prototype.__proto__=Uint8Array.prototype,wt.__proto__=Uint8Array,wt.alloc=function($t,zt,jt){return It($t,zt,jt)},wt.allocUnsafe=function($t){return kt($t)},wt.allocUnsafeSlow=function($t){return kt($t)},wt.isBuffer=function($t){return $t!=null&&$t._isBuffer===!0&&$t!==wt.prototype},wt.compare=function($t,zt){if(ln($t,Uint8Array)&&($t=wt.from($t,$t.offset,$t.byteLength)),ln(zt,Uint8Array)&&(zt=wt.from(zt,zt.offset,zt.byteLength)),!wt.isBuffer($t)||!wt.isBuffer(zt))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if($t===zt)return 0;for(var jt=$t.length,Gt=zt.length,Qt=0,Jt=St(jt,Gt);Qt<Jt;++Qt)if($t[Qt]!==zt[Qt]){jt=$t[Qt],Gt=zt[Qt];break}return jt<Gt?-1:Gt<jt?1:0},wt.isEncoding=function($t){switch(($t+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},wt.concat=function($t,zt){if(!Array.isArray($t))throw new TypeError('"list" argument must be an Array of Buffers');if($t.length===0)return wt.alloc(0);var jt;if(zt===void 0)for(zt=0,jt=0;jt<$t.length;++jt)zt+=$t[jt].length;var Gt=wt.allocUnsafe(zt),Qt=0;for(jt=0;jt<$t.length;++jt){var Jt=$t[jt];if(ln(Jt,Uint8Array)&&(Jt=wt.from(Jt)),!wt.isBuffer(Jt))throw new TypeError('"list" argument must be an Array of Buffers');Jt.copy(Gt,Qt),Qt+=Jt.length}return Gt},wt.byteLength=Ft,wt.prototype._isBuffer=!0,wt.prototype.swap16=function(){var $t=this.length;if($t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var zt=0;zt<$t;zt+=2)Bt(this,zt,zt+1);return this},wt.prototype.swap32=function(){var $t=this.length;if($t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var zt=0;zt<$t;zt+=4)Bt(this,zt,zt+3),Bt(this,zt+1,zt+2);return this},wt.prototype.swap64=function(){var $t=this.length;if($t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var zt=0;zt<$t;zt+=8)Bt(this,zt,zt+7),Bt(this,zt+1,zt+6),Bt(this,zt+2,zt+5),Bt(this,zt+3,zt+4);return this},wt.prototype.toString=function(){var $t=this.length;return $t===0?"":arguments.length===0?bn(this,0,$t):Kt.apply(this,arguments)},wt.prototype.toLocaleString=wt.prototype.toString,wt.prototype.equals=function($t){if(!wt.isBuffer($t))throw new TypeError("Argument must be a Buffer");return this===$t||wt.compare(this,$t)===0},wt.prototype.inspect=function(){var $t="",zt=mt.INSPECT_MAX_BYTES;return $t=this.toString("hex",0,zt).replace(/(.{2})/g,"$1 ").trim(),this.length>zt&&($t+=" ... "),"<Buffer "+$t+">"},wt.prototype.compare=function($t,zt,jt,Gt,Qt){if(ln($t,Uint8Array)&&($t=wt.from($t,$t.offset,$t.byteLength)),!wt.isBuffer($t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof $t);if(zt===void 0&&(zt=0),jt===void 0&&(jt=$t?$t.length:0),Gt===void 0&&(Gt=0),Qt===void 0&&(Qt=this.length),0>zt||jt>$t.length||0>Gt||Qt>this.length)throw new RangeError("out of range index");if(Gt>=Qt&&zt>=jt)return 0;if(Gt>=Qt)return-1;if(zt>=jt)return 1;if(zt>>>=0,jt>>>=0,Gt>>>=0,Qt>>>=0,this===$t)return 0;for(var Jt=Qt-Gt,en=jt-zt,sn=St(Jt,en),gn=this.slice(Gt,Qt),mn=$t.slice(zt,jt),vn=0;vn<sn;++vn)if(gn[vn]!==mn[vn]){Jt=gn[vn],en=mn[vn];break}return Jt<en?-1:en<Jt?1:0},wt.prototype.includes=function($t,zt,jt){return this.indexOf($t,zt,jt)!==-1},wt.prototype.indexOf=function($t,zt,jt){return Ut(this,$t,zt,jt,!0)},wt.prototype.lastIndexOf=function($t,zt,jt){return Ut(this,$t,zt,jt,!1)},wt.prototype.write=function($t,zt,jt,Gt){if(zt===void 0)Gt="utf8",jt=this.length,zt=0;else if(jt===void 0&&typeof zt=="string")Gt=zt,jt=this.length,zt=0;else if(isFinite(zt))zt>>>=0,isFinite(jt)?(jt>>>=0,Gt===void 0&&(Gt="utf8")):(Gt=jt,jt=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Qt=this.length-zt;if((jt===void 0||jt>Qt)&&(jt=Qt),0<$t.length&&(0>jt||0>zt)||zt>this.length)throw new RangeError("Attempt to write outside buffer bounds");Gt||(Gt="utf8");for(var Jt=!1;;)switch(Gt){case"hex":return Yt(this,$t,zt,jt);case"utf8":case"utf-8":return Zt(this,$t,zt,jt);case"ascii":return Xt(this,$t,zt,jt);case"latin1":case"binary":return _i(this,$t,zt,jt);case"base64":return nn(this,$t,zt,jt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return rn(this,$t,zt,jt);default:if(Jt)throw new TypeError("Unknown encoding: "+Gt);Gt=(""+Gt).toLowerCase(),Jt=!0}},wt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},wt.prototype.slice=function($t,zt){var jt=this.length;$t=~~$t,zt=zt===void 0?jt:~~zt,0>$t?($t+=jt,0>$t&&($t=0)):$t>jt&&($t=jt),0>zt?(zt+=jt,0>zt&&(zt=0)):zt>jt&&(zt=jt),zt<$t&&(zt=$t);var Gt=this.subarray($t,zt);return Gt.__proto__=wt.prototype,Gt},wt.prototype.readUIntLE=function($t,zt,jt){$t>>>=0,zt>>>=0,jt||pn($t,zt,this.length);for(var Gt=this[$t],Qt=1,Jt=0;++Jt<zt&&(Qt*=256);)Gt+=this[$t+Jt]*Qt;return Gt},wt.prototype.readUIntBE=function($t,zt,jt){$t>>>=0,zt>>>=0,jt||pn($t,zt,this.length);for(var Gt=this[$t+--zt],Qt=1;0<zt&&(Qt*=256);)Gt+=this[$t+--zt]*Qt;return Gt},wt.prototype.readUInt8=function($t,zt){return $t>>>=0,zt||pn($t,1,this.length),this[$t]},wt.prototype.readUInt16LE=function($t,zt){return $t>>>=0,zt||pn($t,2,this.length),this[$t]|this[$t+1]<<8},wt.prototype.readUInt16BE=function($t,zt){return $t>>>=0,zt||pn($t,2,this.length),this[$t]<<8|this[$t+1]},wt.prototype.readUInt32LE=function($t,zt){return $t>>>=0,zt||pn($t,4,this.length),(this[$t]|this[$t+1]<<8|this[$t+2]<<16)+16777216*this[$t+3]},wt.prototype.readUInt32BE=function($t,zt){return $t>>>=0,zt||pn($t,4,this.length),16777216*this[$t]+(this[$t+1]<<16|this[$t+2]<<8|this[$t+3])},wt.prototype.readIntLE=function($t,zt,jt){$t>>>=0,zt>>>=0,jt||pn($t,zt,this.length);for(var Gt=this[$t],Qt=1,Jt=0;++Jt<zt&&(Qt*=256);)Gt+=this[$t+Jt]*Qt;return Qt*=128,Gt>=Qt&&(Gt-=ut(2,8*zt)),Gt},wt.prototype.readIntBE=function($t,zt,jt){$t>>>=0,zt>>>=0,jt||pn($t,zt,this.length);for(var Gt=zt,Qt=1,Jt=this[$t+--Gt];0<Gt&&(Qt*=256);)Jt+=this[$t+--Gt]*Qt;return Qt*=128,Jt>=Qt&&(Jt-=ut(2,8*zt)),Jt},wt.prototype.readInt8=function($t,zt){return $t>>>=0,zt||pn($t,1,this.length),128&this[$t]?-1*(255-this[$t]+1):this[$t]},wt.prototype.readInt16LE=function($t,zt){$t>>>=0,zt||pn($t,2,this.length);var jt=this[$t]|this[$t+1]<<8;return 32768&jt?4294901760|jt:jt},wt.prototype.readInt16BE=function($t,zt){$t>>>=0,zt||pn($t,2,this.length);var jt=this[$t+1]|this[$t]<<8;return 32768&jt?4294901760|jt:jt},wt.prototype.readInt32LE=function($t,zt){return $t>>>=0,zt||pn($t,4,this.length),this[$t]|this[$t+1]<<8|this[$t+2]<<16|this[$t+3]<<24},wt.prototype.readInt32BE=function($t,zt){return $t>>>=0,zt||pn($t,4,this.length),this[$t]<<24|this[$t+1]<<16|this[$t+2]<<8|this[$t+3]},wt.prototype.readFloatLE=function($t,zt){return $t>>>=0,zt||pn($t,4,this.length),xn.read(this,$t,!0,23,4)},wt.prototype.readFloatBE=function($t,zt){return $t>>>=0,zt||pn($t,4,this.length),xn.read(this,$t,!1,23,4)},wt.prototype.readDoubleLE=function($t,zt){return $t>>>=0,zt||pn($t,8,this.length),xn.read(this,$t,!0,52,8)},wt.prototype.readDoubleBE=function($t,zt){return $t>>>=0,zt||pn($t,8,this.length),xn.read(this,$t,!1,52,8)},wt.prototype.writeUIntLE=function($t,zt,jt,Gt){if($t=+$t,zt>>>=0,jt>>>=0,!Gt){var Qt=ut(2,8*jt)-1;yn(this,$t,zt,jt,Qt,0)}var Jt=1,en=0;for(this[zt]=255&$t;++en<jt&&(Jt*=256);)this[zt+en]=255&$t/Jt;return zt+jt},wt.prototype.writeUIntBE=function($t,zt,jt,Gt){if($t=+$t,zt>>>=0,jt>>>=0,!Gt){var Qt=ut(2,8*jt)-1;yn(this,$t,zt,jt,Qt,0)}var Jt=jt-1,en=1;for(this[zt+Jt]=255&$t;0<=--Jt&&(en*=256);)this[zt+Jt]=255&$t/en;return zt+jt},wt.prototype.writeUInt8=function($t,zt,jt){return $t=+$t,zt>>>=0,jt||yn(this,$t,zt,1,255,0),this[zt]=255&$t,zt+1},wt.prototype.writeUInt16LE=function($t,zt,jt){return $t=+$t,zt>>>=0,jt||yn(this,$t,zt,2,65535,0),this[zt]=255&$t,this[zt+1]=$t>>>8,zt+2},wt.prototype.writeUInt16BE=function($t,zt,jt){return $t=+$t,zt>>>=0,jt||yn(this,$t,zt,2,65535,0),this[zt]=$t>>>8,this[zt+1]=255&$t,zt+2},wt.prototype.writeUInt32LE=function($t,zt,jt){return $t=+$t,zt>>>=0,jt||yn(this,$t,zt,4,4294967295,0),this[zt+3]=$t>>>24,this[zt+2]=$t>>>16,this[zt+1]=$t>>>8,this[zt]=255&$t,zt+4},wt.prototype.writeUInt32BE=function($t,zt,jt){return $t=+$t,zt>>>=0,jt||yn(this,$t,zt,4,4294967295,0),this[zt]=$t>>>24,this[zt+1]=$t>>>16,this[zt+2]=$t>>>8,this[zt+3]=255&$t,zt+4},wt.prototype.writeIntLE=function($t,zt,jt,Gt){if($t=+$t,zt>>>=0,!Gt){var Qt=ut(2,8*jt-1);yn(this,$t,zt,jt,Qt-1,-Qt)}var Jt=0,en=1,sn=0;for(this[zt]=255&$t;++Jt<jt&&(en*=256);)0>$t&&sn===0&&this[zt+Jt-1]!==0&&(sn=1),this[zt+Jt]=255&($t/en>>0)-sn;return zt+jt},wt.prototype.writeIntBE=function($t,zt,jt,Gt){if($t=+$t,zt>>>=0,!Gt){var Qt=ut(2,8*jt-1);yn(this,$t,zt,jt,Qt-1,-Qt)}var Jt=jt-1,en=1,sn=0;for(this[zt+Jt]=255&$t;0<=--Jt&&(en*=256);)0>$t&&sn===0&&this[zt+Jt+1]!==0&&(sn=1),this[zt+Jt]=255&($t/en>>0)-sn;return zt+jt},wt.prototype.writeInt8=function($t,zt,jt){return $t=+$t,zt>>>=0,jt||yn(this,$t,zt,1,127,-128),0>$t&&($t=255+$t+1),this[zt]=255&$t,zt+1},wt.prototype.writeInt16LE=function($t,zt,jt){return $t=+$t,zt>>>=0,jt||yn(this,$t,zt,2,32767,-32768),this[zt]=255&$t,this[zt+1]=$t>>>8,zt+2},wt.prototype.writeInt16BE=function($t,zt,jt){return $t=+$t,zt>>>=0,jt||yn(this,$t,zt,2,32767,-32768),this[zt]=$t>>>8,this[zt+1]=255&$t,zt+2},wt.prototype.writeInt32LE=function($t,zt,jt){return $t=+$t,zt>>>=0,jt||yn(this,$t,zt,4,2147483647,-2147483648),this[zt]=255&$t,this[zt+1]=$t>>>8,this[zt+2]=$t>>>16,this[zt+3]=$t>>>24,zt+4},wt.prototype.writeInt32BE=function($t,zt,jt){return $t=+$t,zt>>>=0,jt||yn(this,$t,zt,4,2147483647,-2147483648),0>$t&&($t=4294967295+$t+1),this[zt]=$t>>>24,this[zt+1]=$t>>>16,this[zt+2]=$t>>>8,this[zt+3]=255&$t,zt+4},wt.prototype.writeFloatLE=function($t,zt,jt){return Nn(this,$t,zt,!0,jt)},wt.prototype.writeFloatBE=function($t,zt,jt){return Nn(this,$t,zt,!1,jt)},wt.prototype.writeDoubleLE=function($t,zt,jt){return Wn(this,$t,zt,!0,jt)},wt.prototype.writeDoubleBE=function($t,zt,jt){return Wn(this,$t,zt,!1,jt)},wt.prototype.copy=function($t,zt,jt,Gt){if(!wt.isBuffer($t))throw new TypeError("argument should be a Buffer");if(jt||(jt=0),Gt||Gt===0||(Gt=this.length),zt>=$t.length&&(zt=$t.length),zt||(zt=0),0<Gt&&Gt<jt&&(Gt=jt),Gt===jt||$t.length===0||this.length===0)return 0;if(0>zt)throw new RangeError("targetStart out of bounds");if(0>jt||jt>=this.length)throw new RangeError("Index out of range");if(0>Gt)throw new RangeError("sourceEnd out of bounds");Gt>this.length&&(Gt=this.length),$t.length-zt<Gt-jt&&(Gt=$t.length-zt+jt);var Qt=Gt-jt;if(this===$t&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(zt,jt,Gt);else if(this===$t&&jt<zt&&zt<Gt)for(var Jt=Qt-1;0<=Jt;--Jt)$t[Jt+zt]=this[Jt+jt];else Uint8Array.prototype.set.call($t,this.subarray(jt,Gt),zt);return Qt},wt.prototype.fill=function($t,zt,jt,Gt){if(typeof $t=="string"){if(typeof zt=="string"?(Gt=zt,zt=0,jt=this.length):typeof jt=="string"&&(Gt=jt,jt=this.length),Gt!==void 0&&typeof Gt!="string")throw new TypeError("encoding must be a string");if(typeof Gt=="string"&&!wt.isEncoding(Gt))throw new TypeError("Unknown encoding: "+Gt);if($t.length===1){var Qt=$t.charCodeAt(0);(Gt==="utf8"&&128>Qt||Gt==="latin1")&&($t=Qt)}}else typeof $t=="number"&&($t&=255);if(0>zt||this.length<zt||this.length<jt)throw new RangeError("Out of range index");if(jt<=zt)return this;zt>>>=0,jt=jt===void 0?this.length:jt>>>0,$t||($t=0);var Jt;if(typeof $t=="number")for(Jt=zt;Jt<jt;++Jt)this[Jt]=$t;else{var en=wt.isBuffer($t)?$t:wt.from($t,Gt),sn=en.length;if(sn===0)throw new TypeError('The value "'+$t+'" is invalid for argument "value"');for(Jt=0;Jt<jt-zt;++Jt)this[Jt+zt]=en[Jt%sn]}return this};var tn=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,gt("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(gt,pt,mt){(function(vt){(function(){function St(){let wt;try{wt=mt.storage.getItem("debug")}catch{}return!wt&&typeof vt<"u"&&"env"in vt&&(wt=vt.env.DEBUG),wt}mt.formatArgs=function(wt){if(wt[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+wt[0]+(this.useColors?"%c ":" ")+"+"+pt.exports.humanize(this.diff),!this.useColors)return;const Lt="color: "+this.color;wt.splice(1,0,Lt,"color: inherit");let xt=0,It=0;wt[0].replace(/%[a-zA-Z%]/g,kt=>{kt==="%%"||(xt++,kt==="%c"&&(It=xt))}),wt.splice(It,0,Lt)},mt.save=function(wt){try{wt?mt.storage.setItem("debug",wt):mt.storage.removeItem("debug")}catch{}},mt.load=St,mt.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},mt.storage=function(){try{return localStorage}catch{}}(),mt.destroy=(()=>{let wt=!1;return()=>{wt||(wt=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),mt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],mt.log=console.debug||console.log||(()=>{}),pt.exports=gt("./common")(mt);const{formatters:yt}=pt.exports;yt.j=function(wt){try{return JSON.stringify(wt)}catch(Lt){return"[UnexpectedJSONParseError]: "+Lt.message}}}).call(this)}).call(this,gt("_process"))},{"./common":5,_process:12}],5:[function(gt,pt){pt.exports=function(mt){function vt(wt){function Lt(...kt){if(!Lt.enabled)return;const At=Lt,Tt=+new Date,Rt=Tt-(xt||Tt);At.diff=Rt,At.prev=xt,At.curr=Tt,xt=Tt,kt[0]=vt.coerce(kt[0]),typeof kt[0]!="string"&&kt.unshift("%O");let Nt=0;kt[0]=kt[0].replace(/%([a-zA-Z%])/g,(Ft,Kt)=>{if(Ft==="%%")return"%";Nt++;const Bt=vt.formatters[Kt];if(typeof Bt=="function"){const Ut=kt[Nt];Ft=Bt.call(At,Ut),kt.splice(Nt,1),Nt--}return Ft}),vt.formatArgs.call(At,kt),(At.log||vt.log).apply(At,kt)}let xt,It=null;return Lt.namespace=wt,Lt.useColors=vt.useColors(),Lt.color=vt.selectColor(wt),Lt.extend=St,Lt.destroy=vt.destroy,Object.defineProperty(Lt,"enabled",{enumerable:!0,configurable:!1,get:()=>It===null?vt.enabled(wt):It,set:kt=>{It=kt}}),typeof vt.init=="function"&&vt.init(Lt),Lt}function St(wt,Lt){const xt=vt(this.namespace+(typeof Lt>"u"?":":Lt)+wt);return xt.log=this.log,xt}function yt(wt){return wt.toString().substring(2,wt.toString().length-2).replace(/\.\*\?$/,"*")}return vt.debug=vt,vt.default=vt,vt.coerce=function(wt){return wt instanceof Error?wt.stack||wt.message:wt},vt.disable=function(){const wt=[...vt.names.map(yt),...vt.skips.map(yt).map(Lt=>"-"+Lt)].join(",");return vt.enable(""),wt},vt.enable=function(wt){vt.save(wt),vt.names=[],vt.skips=[];let Lt;const xt=(typeof wt=="string"?wt:"").split(/[\s,]+/),It=xt.length;for(Lt=0;Lt<It;Lt++)xt[Lt]&&(wt=xt[Lt].replace(/\*/g,".*?"),wt[0]==="-"?vt.skips.push(new RegExp("^"+wt.substr(1)+"$")):vt.names.push(new RegExp("^"+wt+"$")))},vt.enabled=function(wt){if(wt[wt.length-1]==="*")return!0;let Lt,xt;for(Lt=0,xt=vt.skips.length;Lt<xt;Lt++)if(vt.skips[Lt].test(wt))return!1;for(Lt=0,xt=vt.names.length;Lt<xt;Lt++)if(vt.names[Lt].test(wt))return!0;return!1},vt.humanize=gt("ms"),vt.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(mt).forEach(wt=>{vt[wt]=mt[wt]}),vt.names=[],vt.skips=[],vt.formatters={},vt.selectColor=function(wt){let Lt=0;for(let xt=0;xt<wt.length;xt++)Lt=(Lt<<5)-Lt+wt.charCodeAt(xt),Lt|=0;return vt.colors[rt(Lt)%vt.colors.length]},vt.enable(vt.load()),vt}},{ms:11}],6:[function(gt,pt){function mt(vt,St){for(const yt in St)Object.defineProperty(vt,yt,{value:St[yt],enumerable:!0,configurable:!0});return vt}pt.exports=function(vt,St,yt){if(!vt||typeof vt=="string")throw new TypeError("Please pass an Error to err-code");yt||(yt={}),typeof St=="object"&&(yt=St,St=""),St&&(yt.code=St);try{return mt(vt,yt)}catch{yt.message=vt.message,yt.stack=vt.stack;const Lt=function(){};return Lt.prototype=Object.create(Object.getPrototypeOf(vt)),mt(new Lt,yt)}}},{}],7:[function(gt,pt){function mt(Yt){console&&console.warn&&console.warn(Yt)}function vt(){vt.init.call(this)}function St(Yt){if(typeof Yt!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Yt)}function yt(Yt){return Yt._maxListeners===void 0?vt.defaultMaxListeners:Yt._maxListeners}function wt(Yt,Zt,Xt,_i){var nn,rn,dn;if(St(Xt),rn=Yt._events,rn===void 0?(rn=Yt._events=Object.create(null),Yt._eventsCount=0):(rn.newListener!==void 0&&(Yt.emit("newListener",Zt,Xt.listener?Xt.listener:Xt),rn=Yt._events),dn=rn[Zt]),dn===void 0)dn=rn[Zt]=Xt,++Yt._eventsCount;else if(typeof dn=="function"?dn=rn[Zt]=_i?[Xt,dn]:[dn,Xt]:_i?dn.unshift(Xt):dn.push(Xt),nn=yt(Yt),0<nn&&dn.length>nn&&!dn.warned){dn.warned=!0;var bn=new Error("Possible EventEmitter memory leak detected. "+dn.length+" "+(Zt+" listeners added. Use emitter.setMaxListeners() to increase limit"));bn.name="MaxListenersExceededWarning",bn.emitter=Yt,bn.type=Zt,bn.count=dn.length,mt(bn)}return Yt}function Lt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function xt(Yt,Zt,Xt){var _i={fired:!1,wrapFn:void 0,target:Yt,type:Zt,listener:Xt},nn=Lt.bind(_i);return nn.listener=Xt,_i.wrapFn=nn,nn}function It(Yt,Zt,Xt){var _i=Yt._events;if(_i===void 0)return[];var nn=_i[Zt];return nn===void 0?[]:typeof nn=="function"?Xt?[nn.listener||nn]:[nn]:Xt?Rt(nn):At(nn,nn.length)}function kt(Yt){var Zt=this._events;if(Zt!==void 0){var Xt=Zt[Yt];if(typeof Xt=="function")return 1;if(Xt!==void 0)return Xt.length}return 0}function At(Yt,Zt){for(var Xt=Array(Zt),_i=0;_i<Zt;++_i)Xt[_i]=Yt[_i];return Xt}function Tt(Yt,Zt){for(;Zt+1<Yt.length;Zt++)Yt[Zt]=Yt[Zt+1];Yt.pop()}function Rt(Yt){for(var Zt=Array(Yt.length),Xt=0;Xt<Zt.length;++Xt)Zt[Xt]=Yt[Xt].listener||Yt[Xt];return Zt}function Nt(Yt,Zt,Xt){typeof Yt.on=="function"&&Pt(Yt,"error",Zt,Xt)}function Pt(Yt,Zt,Xt,_i){if(typeof Yt.on=="function")_i.once?Yt.once(Zt,Xt):Yt.on(Zt,Xt);else if(typeof Yt.addEventListener=="function")Yt.addEventListener(Zt,function nn(rn){_i.once&&Yt.removeEventListener(Zt,nn),Xt(rn)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Yt)}var Ft,Kt=typeof Reflect=="object"?Reflect:null,Bt=Kt&&typeof Kt.apply=="function"?Kt.apply:function(Yt,Zt,Xt){return Function.prototype.apply.call(Yt,Zt,Xt)};Ft=Kt&&typeof Kt.ownKeys=="function"?Kt.ownKeys:Object.getOwnPropertySymbols?function(Yt){return Object.getOwnPropertyNames(Yt).concat(Object.getOwnPropertySymbols(Yt))}:function(Yt){return Object.getOwnPropertyNames(Yt)};var Ut=Number.isNaN||function(Yt){return Yt!==Yt};pt.exports=vt,pt.exports.once=function(Yt,Zt){return new Promise(function(Xt,_i){function nn(dn){Yt.removeListener(Zt,rn),_i(dn)}function rn(){typeof Yt.removeListener=="function"&&Yt.removeListener("error",nn),Xt([].slice.call(arguments))}Pt(Yt,Zt,rn,{once:!0}),Zt!=="error"&&Nt(Yt,nn,{once:!0})})},vt.EventEmitter=vt,vt.prototype._events=void 0,vt.prototype._eventsCount=0,vt.prototype._maxListeners=void 0;var qt=10;Object.defineProperty(vt,"defaultMaxListeners",{enumerable:!0,get:function(){return qt},set:function(Yt){if(typeof Yt!="number"||0>Yt||Ut(Yt))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Yt+".");qt=Yt}}),vt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},vt.prototype.setMaxListeners=function(Yt){if(typeof Yt!="number"||0>Yt||Ut(Yt))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Yt+".");return this._maxListeners=Yt,this},vt.prototype.getMaxListeners=function(){return yt(this)},vt.prototype.emit=function(Yt){for(var Zt=[],Xt=1;Xt<arguments.length;Xt++)Zt.push(arguments[Xt]);var _i=Yt==="error",nn=this._events;if(nn!==void 0)_i=_i&&nn.error===void 0;else if(!_i)return!1;if(_i){var rn;if(0<Zt.length&&(rn=Zt[0]),rn instanceof Error)throw rn;var dn=new Error("Unhandled error."+(rn?" ("+rn.message+")":""));throw dn.context=rn,dn}var bn=nn[Yt];if(bn===void 0)return!1;if(typeof bn=="function")Bt(bn,this,Zt);else for(var un=bn.length,an=At(bn,un),Xt=0;Xt<un;++Xt)Bt(an[Xt],this,Zt);return!0},vt.prototype.addListener=function(Yt,Zt){return wt(this,Yt,Zt,!1)},vt.prototype.on=vt.prototype.addListener,vt.prototype.prependListener=function(Yt,Zt){return wt(this,Yt,Zt,!0)},vt.prototype.once=function(Yt,Zt){return St(Zt),this.on(Yt,xt(this,Yt,Zt)),this},vt.prototype.prependOnceListener=function(Yt,Zt){return St(Zt),this.prependListener(Yt,xt(this,Yt,Zt)),this},vt.prototype.removeListener=function(Yt,Zt){var Xt,_i,nn,rn,dn;if(St(Zt),_i=this._events,_i===void 0)return this;if(Xt=_i[Yt],Xt===void 0)return this;if(Xt===Zt||Xt.listener===Zt)--this._eventsCount==0?this._events=Object.create(null):(delete _i[Yt],_i.removeListener&&this.emit("removeListener",Yt,Xt.listener||Zt));else if(typeof Xt!="function"){for(nn=-1,rn=Xt.length-1;0<=rn;rn--)if(Xt[rn]===Zt||Xt[rn].listener===Zt){dn=Xt[rn].listener,nn=rn;break}if(0>nn)return this;nn===0?Xt.shift():Tt(Xt,nn),Xt.length===1&&(_i[Yt]=Xt[0]),_i.removeListener!==void 0&&this.emit("removeListener",Yt,dn||Zt)}return this},vt.prototype.off=vt.prototype.removeListener,vt.prototype.removeAllListeners=function(Yt){var Zt,Xt,_i;if(Xt=this._events,Xt===void 0)return this;if(Xt.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Xt[Yt]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete Xt[Yt]),this;if(arguments.length===0){var nn,rn=Object.keys(Xt);for(_i=0;_i<rn.length;++_i)nn=rn[_i],nn!=="removeListener"&&this.removeAllListeners(nn);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(Zt=Xt[Yt],typeof Zt=="function")this.removeListener(Yt,Zt);else if(Zt!==void 0)for(_i=Zt.length-1;0<=_i;_i--)this.removeListener(Yt,Zt[_i]);return this},vt.prototype.listeners=function(Yt){return It(this,Yt,!0)},vt.prototype.rawListeners=function(Yt){return It(this,Yt,!1)},vt.listenerCount=function(Yt,Zt){return typeof Yt.listenerCount=="function"?Yt.listenerCount(Zt):kt.call(Yt,Zt)},vt.prototype.listenerCount=kt,vt.prototype.eventNames=function(){return 0<this._eventsCount?Ft(this._events):[]}},{}],8:[function(gt,pt){pt.exports=function(){if(typeof globalThis>"u")return null;var mt={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return mt.RTCPeerConnection?mt:null}},{}],9:[function(gt,pt,mt){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */mt.read=function(vt,St,yt,wt,Lt){var xt,It,kt=8*Lt-wt-1,At=(1<<kt)-1,Tt=At>>1,Rt=-7,Nt=yt?Lt-1:0,Pt=yt?-1:1,Ft=vt[St+Nt];for(Nt+=Pt,xt=Ft&(1<<-Rt)-1,Ft>>=-Rt,Rt+=kt;0<Rt;xt=256*xt+vt[St+Nt],Nt+=Pt,Rt-=8);for(It=xt&(1<<-Rt)-1,xt>>=-Rt,Rt+=wt;0<Rt;It=256*It+vt[St+Nt],Nt+=Pt,Rt-=8);if(xt===0)xt=1-Tt;else{if(xt===At)return It?NaN:(Ft?-1:1)*(1/0);It+=ut(2,wt),xt-=Tt}return(Ft?-1:1)*It*ut(2,xt-wt)},mt.write=function(vt,St,yt,wt,Lt,xt){var It,kt,At,Tt=Math.LN2,Rt=Math.log,Nt=8*xt-Lt-1,Pt=(1<<Nt)-1,Ft=Pt>>1,Kt=Lt===23?ut(2,-24)-ut(2,-77):0,Bt=wt?0:xt-1,Ut=wt?1:-1,qt=0>St||St===0&&0>1/St?1:0;for(St=rt(St),isNaN(St)||St===1/0?(kt=isNaN(St)?1:0,It=Pt):(It=ot(Rt(St)/Tt),1>St*(At=ut(2,-It))&&(It--,At*=2),St+=1<=It+Ft?Kt/At:Kt*ut(2,1-Ft),2<=St*At&&(It++,At/=2),It+Ft>=Pt?(kt=0,It=Pt):1<=It+Ft?(kt=(St*At-1)*ut(2,Lt),It+=Ft):(kt=St*ut(2,Ft-1)*ut(2,Lt),It=0));8<=Lt;vt[yt+Bt]=255&kt,Bt+=Ut,kt/=256,Lt-=8);for(It=It<<Lt|kt,Nt+=Lt;0<Nt;vt[yt+Bt]=255&It,Bt+=Ut,It/=256,Nt-=8);vt[yt+Bt-Ut]|=128*qt}},{}],10:[function(gt,pt){pt.exports=typeof Object.create=="function"?function(mt,vt){vt&&(mt.super_=vt,mt.prototype=Object.create(vt.prototype,{constructor:{value:mt,enumerable:!1,writable:!0,configurable:!0}}))}:function(mt,vt){if(vt){mt.super_=vt;var St=function(){};St.prototype=vt.prototype,mt.prototype=new St,mt.prototype.constructor=mt}}},{}],11:[function(gt,pt){var mt=Math.round;function vt(Lt){if(Lt+="",!(100<Lt.length)){var xt=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(Lt);if(xt){var It=parseFloat(xt[1]),kt=(xt[2]||"ms").toLowerCase();return kt==="years"||kt==="year"||kt==="yrs"||kt==="yr"||kt==="y"?315576e5*It:kt==="weeks"||kt==="week"||kt==="w"?6048e5*It:kt==="days"||kt==="day"||kt==="d"?864e5*It:kt==="hours"||kt==="hour"||kt==="hrs"||kt==="hr"||kt==="h"?36e5*It:kt==="minutes"||kt==="minute"||kt==="mins"||kt==="min"||kt==="m"?6e4*It:kt==="seconds"||kt==="second"||kt==="secs"||kt==="sec"||kt==="s"?1e3*It:kt==="milliseconds"||kt==="millisecond"||kt==="msecs"||kt==="msec"||kt==="ms"?It:void 0}}}function St(Lt){var xt=rt(Lt);return 864e5<=xt?mt(Lt/864e5)+"d":36e5<=xt?mt(Lt/36e5)+"h":6e4<=xt?mt(Lt/6e4)+"m":1e3<=xt?mt(Lt/1e3)+"s":Lt+"ms"}function yt(Lt){var xt=rt(Lt);return 864e5<=xt?wt(Lt,xt,864e5,"day"):36e5<=xt?wt(Lt,xt,36e5,"hour"):6e4<=xt?wt(Lt,xt,6e4,"minute"):1e3<=xt?wt(Lt,xt,1e3,"second"):Lt+" ms"}function wt(Lt,xt,It,kt){return mt(Lt/It)+" "+kt+(xt>=1.5*It?"s":"")}pt.exports=function(Lt,xt){xt=xt||{};var It=typeof Lt;if(It=="string"&&0<Lt.length)return vt(Lt);if(It==="number"&&isFinite(Lt))return xt.long?yt(Lt):St(Lt);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(Lt))}},{}],12:[function(gt,pt){function mt(){throw new Error("setTimeout has not been defined")}function vt(){throw new Error("clearTimeout has not been defined")}function St(Kt){if(kt===setTimeout)return setTimeout(Kt,0);if((kt===mt||!kt)&&setTimeout)return kt=setTimeout,setTimeout(Kt,0);try{return kt(Kt,0)}catch{try{return kt.call(null,Kt,0)}catch{return kt.call(this,Kt,0)}}}function yt(Kt){if(At===clearTimeout)return clearTimeout(Kt);if((At===vt||!At)&&clearTimeout)return At=clearTimeout,clearTimeout(Kt);try{return At(Kt)}catch{try{return At.call(null,Kt)}catch{return At.call(this,Kt)}}}function wt(){Pt&&Rt&&(Pt=!1,Rt.length?Nt=Rt.concat(Nt):Ft=-1,Nt.length&&Lt())}function Lt(){if(!Pt){var Kt=St(wt);Pt=!0;for(var Bt=Nt.length;Bt;){for(Rt=Nt,Nt=[];++Ft<Bt;)Rt&&Rt[Ft].run();Ft=-1,Bt=Nt.length}Rt=null,Pt=!1,yt(Kt)}}function xt(Kt,Bt){this.fun=Kt,this.array=Bt}function It(){}var kt,At,Tt=pt.exports={};(function(){try{kt=typeof setTimeout=="function"?setTimeout:mt}catch{kt=mt}try{At=typeof clearTimeout=="function"?clearTimeout:vt}catch{At=vt}})();var Rt,Nt=[],Pt=!1,Ft=-1;Tt.nextTick=function(Kt){var Bt=Array(arguments.length-1);if(1<arguments.length)for(var Ut=1;Ut<arguments.length;Ut++)Bt[Ut-1]=arguments[Ut];Nt.push(new xt(Kt,Bt)),Nt.length!==1||Pt||St(Lt)},xt.prototype.run=function(){this.fun.apply(null,this.array)},Tt.title="browser",Tt.browser=!0,Tt.env={},Tt.argv=[],Tt.version="",Tt.versions={},Tt.on=It,Tt.addListener=It,Tt.once=It,Tt.off=It,Tt.removeListener=It,Tt.removeAllListeners=It,Tt.emit=It,Tt.prependListener=It,Tt.prependOnceListener=It,Tt.listeners=function(){return[]},Tt.binding=function(){throw new Error("process.binding is not supported")},Tt.cwd=function(){return"/"},Tt.chdir=function(){throw new Error("process.chdir is not supported")},Tt.umask=function(){return 0}},{}],13:[function(gt,pt){(function(mt){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let vt;pt.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?mt:window):St=>(vt||(vt=Promise.resolve())).then(St).catch(yt=>setTimeout(()=>{throw yt},0))}).call(this)}).call(this,typeof commonjsGlobal>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:commonjsGlobal)},{}],14:[function(gt,pt){(function(mt,vt){(function(){var St=gt("safe-buffer").Buffer,yt=vt.crypto||vt.msCrypto;pt.exports=yt&&yt.getRandomValues?function(wt,Lt){if(wt>4294967295)throw new RangeError("requested too many random bytes");var xt=St.allocUnsafe(wt);if(0<wt)if(65536<wt)for(var It=0;It<wt;It+=65536)yt.getRandomValues(xt.slice(It,It+65536));else yt.getRandomValues(xt);return typeof Lt=="function"?mt.nextTick(function(){Lt(null,xt)}):xt}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,gt("_process"),typeof commonjsGlobal>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:commonjsGlobal)},{_process:12,"safe-buffer":30}],15:[function(gt,pt){function mt(It,kt){It.prototype=Object.create(kt.prototype),It.prototype.constructor=It,It.__proto__=kt}function vt(It,kt,At){function Tt(Nt,Pt,Ft){return typeof kt=="string"?kt:kt(Nt,Pt,Ft)}At||(At=Error);var Rt=function(Nt){function Pt(Ft,Kt,Bt){return Nt.call(this,Tt(Ft,Kt,Bt))||this}return mt(Pt,Nt),Pt}(At);Rt.prototype.name=At.name,Rt.prototype.code=It,xt[It]=Rt}function St(It,kt){if(Array.isArray(It)){var At=It.length;return It=It.map(function(Tt){return Tt+""}),2<At?"one of ".concat(kt," ").concat(It.slice(0,At-1).join(", "),", or ")+It[At-1]:At===2?"one of ".concat(kt," ").concat(It[0]," or ").concat(It[1]):"of ".concat(kt," ").concat(It[0])}return"of ".concat(kt," ").concat(It+"")}function yt(It,kt,At){return It.substr(!At||0>At?0:+At,kt.length)===kt}function wt(It,kt,At){return(At===void 0||At>It.length)&&(At=It.length),It.substring(At-kt.length,At)===kt}function Lt(It,kt,At){return typeof At!="number"&&(At=0),!(At+kt.length>It.length)&&It.indexOf(kt,At)!==-1}var xt={};vt("ERR_INVALID_OPT_VALUE",function(It,kt){return'The value "'+kt+'" is invalid for option "'+It+'"'},TypeError),vt("ERR_INVALID_ARG_TYPE",function(It,kt,At){var Tt;typeof kt=="string"&&yt(kt,"not ")?(Tt="must not be",kt=kt.replace(/^not /,"")):Tt="must be";var Rt;if(wt(It," argument"))Rt="The ".concat(It," ").concat(Tt," ").concat(St(kt,"type"));else{var Nt=Lt(It,".")?"property":"argument";Rt='The "'.concat(It,'" ').concat(Nt," ").concat(Tt," ").concat(St(kt,"type"))}return Rt+=". Received type ".concat(typeof At),Rt},TypeError),vt("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),vt("ERR_METHOD_NOT_IMPLEMENTED",function(It){return"The "+It+" method is not implemented"}),vt("ERR_STREAM_PREMATURE_CLOSE","Premature close"),vt("ERR_STREAM_DESTROYED",function(It){return"Cannot call "+It+" after a stream was destroyed"}),vt("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),vt("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),vt("ERR_STREAM_WRITE_AFTER_END","write after end"),vt("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),vt("ERR_UNKNOWN_ENCODING",function(It){return"Unknown encoding: "+It},TypeError),vt("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),pt.exports.codes=xt},{}],16:[function(gt,pt){(function(mt){(function(){function vt(Tt){return this instanceof vt?(Lt.call(this,Tt),xt.call(this,Tt),this.allowHalfOpen=!0,void(Tt&&(Tt.readable===!1&&(this.readable=!1),Tt.writable===!1&&(this.writable=!1),Tt.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",St))))):new vt(Tt)}function St(){this._writableState.ended||mt.nextTick(yt,this)}function yt(Tt){Tt.end()}var wt=Object.keys||function(Tt){var Rt=[];for(var Nt in Tt)Rt.push(Nt);return Rt};pt.exports=vt;var Lt=gt("./_stream_readable"),xt=gt("./_stream_writable");gt("inherits")(vt,Lt);for(var It,kt=wt(xt.prototype),At=0;At<kt.length;At++)It=kt[At],vt.prototype[It]||(vt.prototype[It]=xt.prototype[It]);Object.defineProperty(vt.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(vt.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(vt.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(vt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(Tt){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=Tt,this._writableState.destroyed=Tt)}})}).call(this)}).call(this,gt("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(gt,pt){function mt(St){return this instanceof mt?void vt.call(this,St):new mt(St)}pt.exports=mt;var vt=gt("./_stream_transform");gt("inherits")(mt,vt),mt.prototype._transform=function(St,yt,wt){wt(null,St)}},{"./_stream_transform":19,inherits:10}],18:[function(gt,pt){(function(mt,vt){(function(){function St(tn){return hn.from(tn)}function yt(tn){return hn.isBuffer(tn)||tn instanceof pn}function wt(tn,$t,zt){return typeof tn.prependListener=="function"?tn.prependListener($t,zt):void(tn._events&&tn._events[$t]?Array.isArray(tn._events[$t])?tn._events[$t].unshift(zt):tn._events[$t]=[zt,tn._events[$t]]:tn.on($t,zt))}function Lt(tn,$t,zt){un=un||gt("./_stream_duplex"),tn=tn||{},typeof zt!="boolean"&&(zt=$t instanceof un),this.objectMode=!!tn.objectMode,zt&&(this.objectMode=this.objectMode||!!tn.readableObjectMode),this.highWaterMark=In(this,tn,"readableHighWaterMark",zt),this.buffer=new Jn,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=tn.emitClose!==!1,this.autoDestroy=!!tn.autoDestroy,this.destroyed=!1,this.defaultEncoding=tn.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,tn.encoding&&(!Mn&&(Mn=gt("string_decoder/").StringDecoder),this.decoder=new Mn(tn.encoding),this.encoding=tn.encoding)}function xt(tn){if(un=un||gt("./_stream_duplex"),!(this instanceof xt))return new xt(tn);var $t=this instanceof un;this._readableState=new Lt(tn,this,$t),this.readable=!0,tn&&(typeof tn.read=="function"&&(this._read=tn.read),typeof tn.destroy=="function"&&(this._destroy=tn.destroy)),_n.call(this)}function It(tn,$t,zt,jt,Gt){an("readableAddChunk",$t);var Qt=tn._readableState;if($t===null)Qt.reading=!1,Nt(tn,Qt);else{var Jt;if(Gt||(Jt=At(Qt,$t)),Jt)Sn(tn,Jt);else if(!(Qt.objectMode||$t&&0<$t.length))jt||(Qt.reading=!1,Kt(tn,Qt));else if(typeof $t=="string"||Qt.objectMode||Object.getPrototypeOf($t)===hn.prototype||($t=St($t)),jt)Qt.endEmitted?Sn(tn,new fn):kt(tn,Qt,$t,!0);else if(Qt.ended)Sn(tn,new qn);else{if(Qt.destroyed)return!1;Qt.reading=!1,Qt.decoder&&!zt?($t=Qt.decoder.write($t),Qt.objectMode||$t.length!==0?kt(tn,Qt,$t,!1):Kt(tn,Qt)):kt(tn,Qt,$t,!1)}}return!Qt.ended&&(Qt.length<Qt.highWaterMark||Qt.length===0)}function kt(tn,$t,zt,jt){$t.flowing&&$t.length===0&&!$t.sync?($t.awaitDrain=0,tn.emit("data",zt)):($t.length+=$t.objectMode?1:zt.length,jt?$t.buffer.unshift(zt):$t.buffer.push(zt),$t.needReadable&&Pt(tn)),Kt(tn,$t)}function At(tn,$t){var zt;return yt($t)||typeof $t=="string"||$t===void 0||tn.objectMode||(zt=new Gn("chunk",["string","Buffer","Uint8Array"],$t)),zt}function Tt(tn){return 1073741824<=tn?tn=1073741824:(tn--,tn|=tn>>>1,tn|=tn>>>2,tn|=tn>>>4,tn|=tn>>>8,tn|=tn>>>16,tn++),tn}function Rt(tn,$t){return 0>=tn||$t.length===0&&$t.ended?0:$t.objectMode?1:tn===tn?(tn>$t.highWaterMark&&($t.highWaterMark=Tt(tn)),tn<=$t.length?tn:$t.ended?$t.length:($t.needReadable=!0,0)):$t.flowing&&$t.length?$t.buffer.head.data.length:$t.length}function Nt(tn,$t){if(an("onEofChunk"),!$t.ended){if($t.decoder){var zt=$t.decoder.end();zt&&zt.length&&($t.buffer.push(zt),$t.length+=$t.objectMode?1:zt.length)}$t.ended=!0,$t.sync?Pt(tn):($t.needReadable=!1,!$t.emittedReadable&&($t.emittedReadable=!0,Ft(tn)))}}function Pt(tn){var $t=tn._readableState;an("emitReadable",$t.needReadable,$t.emittedReadable),$t.needReadable=!1,$t.emittedReadable||(an("emitReadable",$t.flowing),$t.emittedReadable=!0,mt.nextTick(Ft,tn))}function Ft(tn){var $t=tn._readableState;an("emitReadable_",$t.destroyed,$t.length,$t.ended),!$t.destroyed&&($t.length||$t.ended)&&(tn.emit("readable"),$t.emittedReadable=!1),$t.needReadable=!$t.flowing&&!$t.ended&&$t.length<=$t.highWaterMark,_i(tn)}function Kt(tn,$t){$t.readingMore||($t.readingMore=!0,mt.nextTick(Bt,tn,$t))}function Bt(tn,$t){for(;!$t.reading&&!$t.ended&&($t.length<$t.highWaterMark||$t.flowing&&$t.length===0);){var zt=$t.length;if(an("maybeReadMore read 0"),tn.read(0),zt===$t.length)break}$t.readingMore=!1}function Ut(tn){return function(){var $t=tn._readableState;an("pipeOnDrain",$t.awaitDrain),$t.awaitDrain&&$t.awaitDrain--,$t.awaitDrain===0&&Cn(tn,"data")&&($t.flowing=!0,_i(tn))}}function qt(tn){var $t=tn._readableState;$t.readableListening=0<tn.listenerCount("readable"),$t.resumeScheduled&&!$t.paused?$t.flowing=!0:0<tn.listenerCount("data")&&tn.resume()}function Yt(tn){an("readable nexttick read 0"),tn.read(0)}function Zt(tn,$t){$t.resumeScheduled||($t.resumeScheduled=!0,mt.nextTick(Xt,tn,$t))}function Xt(tn,$t){an("resume",$t.reading),$t.reading||tn.read(0),$t.resumeScheduled=!1,tn.emit("resume"),_i(tn),$t.flowing&&!$t.reading&&tn.read(0)}function _i(tn){var $t=tn._readableState;for(an("flow",$t.flowing);$t.flowing&&tn.read()!==null;);}function nn(tn,$t){if($t.length===0)return null;var zt;return $t.objectMode?zt=$t.buffer.shift():!tn||tn>=$t.length?(zt=$t.decoder?$t.buffer.join(""):$t.buffer.length===1?$t.buffer.first():$t.buffer.concat($t.length),$t.buffer.clear()):zt=$t.buffer.consume(tn,$t.decoder),zt}function rn(tn){var $t=tn._readableState;an("endReadable",$t.endEmitted),$t.endEmitted||($t.ended=!0,mt.nextTick(dn,$t,tn))}function dn(tn,$t){if(an("endReadableNT",tn.endEmitted,tn.length),!tn.endEmitted&&tn.length===0&&(tn.endEmitted=!0,$t.readable=!1,$t.emit("end"),tn.autoDestroy)){var zt=$t._writableState;(!zt||zt.autoDestroy&&zt.finished)&&$t.destroy()}}function bn(tn,$t){for(var zt=0,jt=tn.length;zt<jt;zt++)if(tn[zt]===$t)return zt;return-1}pt.exports=xt;var un;xt.ReadableState=Lt;var an;gt("events").EventEmitter;var Cn=function(tn,$t){return tn.listeners($t).length},_n=gt("./internal/streams/stream"),hn=gt("buffer").Buffer,pn=vt.Uint8Array||function(){},yn=gt("util");an=yn&&yn.debuglog?yn.debuglog("stream"):function(){};var Mn,Nn,Wn,Jn=gt("./internal/streams/buffer_list"),Xn=gt("./internal/streams/destroy"),Un=gt("./internal/streams/state"),In=Un.getHighWaterMark,jn=gt("../errors").codes,Gn=jn.ERR_INVALID_ARG_TYPE,qn=jn.ERR_STREAM_PUSH_AFTER_EOF,ln=jn.ERR_METHOD_NOT_IMPLEMENTED,fn=jn.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;gt("inherits")(xt,_n);var Sn=Xn.errorOrDestroy,xn=["error","close","destroy","pause","resume"];Object.defineProperty(xt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(tn){this._readableState&&(this._readableState.destroyed=tn)}}),xt.prototype.destroy=Xn.destroy,xt.prototype._undestroy=Xn.undestroy,xt.prototype._destroy=function(tn,$t){$t(tn)},xt.prototype.push=function(tn,$t){var zt,jt=this._readableState;return jt.objectMode?zt=!0:typeof tn=="string"&&($t=$t||jt.defaultEncoding,$t!==jt.encoding&&(tn=hn.from(tn,$t),$t=""),zt=!0),It(this,tn,$t,!1,zt)},xt.prototype.unshift=function(tn){return It(this,tn,null,!0,!1)},xt.prototype.isPaused=function(){return this._readableState.flowing===!1},xt.prototype.setEncoding=function(tn){Mn||(Mn=gt("string_decoder/").StringDecoder);var $t=new Mn(tn);this._readableState.decoder=$t,this._readableState.encoding=this._readableState.decoder.encoding;for(var zt=this._readableState.buffer.head,jt="";zt!==null;)jt+=$t.write(zt.data),zt=zt.next;return this._readableState.buffer.clear(),jt!==""&&this._readableState.buffer.push(jt),this._readableState.length=jt.length,this},xt.prototype.read=function(tn){an("read",tn),tn=parseInt(tn,10);var $t=this._readableState,zt=tn;if(tn!==0&&($t.emittedReadable=!1),tn===0&&$t.needReadable&&(($t.highWaterMark===0?0<$t.length:$t.length>=$t.highWaterMark)||$t.ended))return an("read: emitReadable",$t.length,$t.ended),$t.length===0&&$t.ended?rn(this):Pt(this),null;if(tn=Rt(tn,$t),tn===0&&$t.ended)return $t.length===0&&rn(this),null;var jt=$t.needReadable;an("need readable",jt),($t.length===0||$t.length-tn<$t.highWaterMark)&&(jt=!0,an("length less than watermark",jt)),$t.ended||$t.reading?(jt=!1,an("reading or ended",jt)):jt&&(an("do read"),$t.reading=!0,$t.sync=!0,$t.length===0&&($t.needReadable=!0),this._read($t.highWaterMark),$t.sync=!1,!$t.reading&&(tn=Rt(zt,$t)));var Gt;return Gt=0<tn?nn(tn,$t):null,Gt===null?($t.needReadable=$t.length<=$t.highWaterMark,tn=0):($t.length-=tn,$t.awaitDrain=0),$t.length===0&&(!$t.ended&&($t.needReadable=!0),zt!==tn&&$t.ended&&rn(this)),Gt!==null&&this.emit("data",Gt),Gt},xt.prototype._read=function(){Sn(this,new ln("_read()"))},xt.prototype.pipe=function(tn,$t){function zt(Ln,Pn){an("onunpipe"),Ln===mn&&Pn&&Pn.hasUnpiped===!1&&(Pn.hasUnpiped=!0,Gt())}function jt(){an("onend"),tn.end()}function Gt(){an("cleanup"),tn.removeListener("close",en),tn.removeListener("finish",sn),tn.removeListener("drain",An),tn.removeListener("error",Jt),tn.removeListener("unpipe",zt),mn.removeListener("end",jt),mn.removeListener("end",gn),mn.removeListener("data",Qt),Rn=!0,vn.awaitDrain&&(!tn._writableState||tn._writableState.needDrain)&&An()}function Qt(Ln){an("ondata");var Pn=tn.write(Ln);an("dest.write",Pn),Pn===!1&&((vn.pipesCount===1&&vn.pipes===tn||1<vn.pipesCount&&bn(vn.pipes,tn)!==-1)&&!Rn&&(an("false write response, pause",vn.awaitDrain),vn.awaitDrain++),mn.pause())}function Jt(Ln){an("onerror",Ln),gn(),tn.removeListener("error",Jt),Cn(tn,"error")===0&&Sn(tn,Ln)}function en(){tn.removeListener("finish",sn),gn()}function sn(){an("onfinish"),tn.removeListener("close",en),gn()}function gn(){an("unpipe"),mn.unpipe(tn)}var mn=this,vn=this._readableState;switch(vn.pipesCount){case 0:vn.pipes=tn;break;case 1:vn.pipes=[vn.pipes,tn];break;default:vn.pipes.push(tn)}vn.pipesCount+=1,an("pipe count=%d opts=%j",vn.pipesCount,$t);var En=(!$t||$t.end!==!1)&&tn!==mt.stdout&&tn!==mt.stderr,Dn=En?jt:gn;vn.endEmitted?mt.nextTick(Dn):mn.once("end",Dn),tn.on("unpipe",zt);var An=Ut(mn);tn.on("drain",An);var Rn=!1;return mn.on("data",Qt),wt(tn,"error",Jt),tn.once("close",en),tn.once("finish",sn),tn.emit("pipe",mn),vn.flowing||(an("pipe resume"),mn.resume()),tn},xt.prototype.unpipe=function(tn){var $t=this._readableState,zt={hasUnpiped:!1};if($t.pipesCount===0)return this;if($t.pipesCount===1)return tn&&tn!==$t.pipes?this:(tn||(tn=$t.pipes),$t.pipes=null,$t.pipesCount=0,$t.flowing=!1,tn&&tn.emit("unpipe",this,zt),this);if(!tn){var jt=$t.pipes,Gt=$t.pipesCount;$t.pipes=null,$t.pipesCount=0,$t.flowing=!1;for(var Qt=0;Qt<Gt;Qt++)jt[Qt].emit("unpipe",this,{hasUnpiped:!1});return this}var Jt=bn($t.pipes,tn);return Jt===-1?this:($t.pipes.splice(Jt,1),$t.pipesCount-=1,$t.pipesCount===1&&($t.pipes=$t.pipes[0]),tn.emit("unpipe",this,zt),this)},xt.prototype.on=function(tn,$t){var zt=_n.prototype.on.call(this,tn,$t),jt=this._readableState;return tn==="data"?(jt.readableListening=0<this.listenerCount("readable"),jt.flowing!==!1&&this.resume()):tn=="readable"&&!jt.endEmitted&&!jt.readableListening&&(jt.readableListening=jt.needReadable=!0,jt.flowing=!1,jt.emittedReadable=!1,an("on readable",jt.length,jt.reading),jt.length?Pt(this):!jt.reading&&mt.nextTick(Yt,this)),zt},xt.prototype.addListener=xt.prototype.on,xt.prototype.removeListener=function(tn,$t){var zt=_n.prototype.removeListener.call(this,tn,$t);return tn==="readable"&&mt.nextTick(qt,this),zt},xt.prototype.removeAllListeners=function(tn){var $t=_n.prototype.removeAllListeners.apply(this,arguments);return(tn==="readable"||tn===void 0)&&mt.nextTick(qt,this),$t},xt.prototype.resume=function(){var tn=this._readableState;return tn.flowing||(an("resume"),tn.flowing=!tn.readableListening,Zt(this,tn)),tn.paused=!1,this},xt.prototype.pause=function(){return an("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(an("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},xt.prototype.wrap=function(tn){var $t=this,zt=this._readableState,jt=!1;for(var Gt in tn.on("end",function(){if(an("wrapped end"),zt.decoder&&!zt.ended){var Jt=zt.decoder.end();Jt&&Jt.length&&$t.push(Jt)}$t.push(null)}),tn.on("data",function(Jt){if(an("wrapped data"),zt.decoder&&(Jt=zt.decoder.write(Jt)),!(zt.objectMode&&Jt==null)&&(zt.objectMode||Jt&&Jt.length)){var en=$t.push(Jt);en||(jt=!0,tn.pause())}}),tn)this[Gt]===void 0&&typeof tn[Gt]=="function"&&(this[Gt]=function(Jt){return function(){return tn[Jt].apply(tn,arguments)}}(Gt));for(var Qt=0;Qt<xn.length;Qt++)tn.on(xn[Qt],this.emit.bind(this,xn[Qt]));return this._read=function(Jt){an("wrapped _read",Jt),jt&&(jt=!1,tn.resume())},this},typeof Symbol=="function"&&(xt.prototype[Symbol.asyncIterator]=function(){return Nn===void 0&&(Nn=gt("./internal/streams/async_iterator")),Nn(this)}),Object.defineProperty(xt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(xt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(xt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(tn){this._readableState&&(this._readableState.flowing=tn)}}),xt._fromList=nn,Object.defineProperty(xt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(xt.from=function(tn,$t){return Wn===void 0&&(Wn=gt("./internal/streams/from")),Wn(xt,tn,$t)})}).call(this)}).call(this,gt("_process"),typeof commonjsGlobal>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:commonjsGlobal)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(gt,pt){function mt(Tt,Rt){var Nt=this._transformState;Nt.transforming=!1;var Pt=Nt.writecb;if(Pt===null)return this.emit("error",new xt);Nt.writechunk=null,Nt.writecb=null,Rt!=null&&this.push(Rt),Pt(Tt);var Ft=this._readableState;Ft.reading=!1,(Ft.needReadable||Ft.length<Ft.highWaterMark)&&this._read(Ft.highWaterMark)}function vt(Tt){return this instanceof vt?(At.call(this,Tt),this._transformState={afterTransform:mt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,Tt&&(typeof Tt.transform=="function"&&(this._transform=Tt.transform),typeof Tt.flush=="function"&&(this._flush=Tt.flush)),void this.on("prefinish",St)):new vt(Tt)}function St(){var Tt=this;typeof this._flush!="function"||this._readableState.destroyed?yt(this,null,null):this._flush(function(Rt,Nt){yt(Tt,Rt,Nt)})}function yt(Tt,Rt,Nt){if(Rt)return Tt.emit("error",Rt);if(Nt!=null&&Tt.push(Nt),Tt._writableState.length)throw new kt;if(Tt._transformState.transforming)throw new It;return Tt.push(null)}pt.exports=vt;var wt=gt("../errors").codes,Lt=wt.ERR_METHOD_NOT_IMPLEMENTED,xt=wt.ERR_MULTIPLE_CALLBACK,It=wt.ERR_TRANSFORM_ALREADY_TRANSFORMING,kt=wt.ERR_TRANSFORM_WITH_LENGTH_0,At=gt("./_stream_duplex");gt("inherits")(vt,At),vt.prototype.push=function(Tt,Rt){return this._transformState.needTransform=!1,At.prototype.push.call(this,Tt,Rt)},vt.prototype._transform=function(Tt,Rt,Nt){Nt(new Lt("_transform()"))},vt.prototype._write=function(Tt,Rt,Nt){var Pt=this._transformState;if(Pt.writecb=Nt,Pt.writechunk=Tt,Pt.writeencoding=Rt,!Pt.transforming){var Ft=this._readableState;(Pt.needTransform||Ft.needReadable||Ft.length<Ft.highWaterMark)&&this._read(Ft.highWaterMark)}},vt.prototype._read=function(){var Tt=this._transformState;Tt.writechunk===null||Tt.transforming?Tt.needTransform=!0:(Tt.transforming=!0,this._transform(Tt.writechunk,Tt.writeencoding,Tt.afterTransform))},vt.prototype._destroy=function(Tt,Rt){At.prototype._destroy.call(this,Tt,function(Nt){Rt(Nt)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(gt,pt){(function(mt,vt){(function(){function St(ln){var fn=this;this.next=null,this.entry=null,this.finish=function(){rn(fn,ln)}}function yt(ln){return an.from(ln)}function wt(ln){return an.isBuffer(ln)||ln instanceof Cn}function Lt(){}function xt(ln,fn,Sn){dn=dn||gt("./_stream_duplex"),ln=ln||{},typeof Sn!="boolean"&&(Sn=fn instanceof dn),this.objectMode=!!ln.objectMode,Sn&&(this.objectMode=this.objectMode||!!ln.writableObjectMode),this.highWaterMark=pn(this,ln,"writableHighWaterMark",Sn),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var xn=ln.decodeStrings===!1;this.decodeStrings=!xn,this.defaultEncoding=ln.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(tn){Kt(fn,tn)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=ln.emitClose!==!1,this.autoDestroy=!!ln.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new St(this)}function It(ln){dn=dn||gt("./_stream_duplex");var fn=this instanceof dn;return fn||qn.call(It,this)?(this._writableState=new xt(ln,this,fn),this.writable=!0,ln&&(typeof ln.write=="function"&&(this._write=ln.write),typeof ln.writev=="function"&&(this._writev=ln.writev),typeof ln.destroy=="function"&&(this._destroy=ln.destroy),typeof ln.final=="function"&&(this._final=ln.final)),void un.call(this)):new It(ln)}function kt(ln,fn){var Sn=new In;Gn(ln,Sn),mt.nextTick(fn,Sn)}function At(ln,fn,Sn,xn){var tn;return Sn===null?tn=new Un:typeof Sn!="string"&&!fn.objectMode&&(tn=new Mn("chunk",["string","Buffer"],Sn)),!tn||(Gn(ln,tn),mt.nextTick(xn,tn),!1)}function Tt(ln,fn,Sn){return ln.objectMode||ln.decodeStrings===!1||typeof fn!="string"||(fn=an.from(fn,Sn)),fn}function Rt(ln,fn,Sn,xn,tn,$t){if(!Sn){var zt=Tt(fn,xn,tn);xn!==zt&&(Sn=!0,tn="buffer",xn=zt)}var jt=fn.objectMode?1:xn.length;fn.length+=jt;var Gt=fn.length<fn.highWaterMark;if(Gt||(fn.needDrain=!0),fn.writing||fn.corked){var Qt=fn.lastBufferedRequest;fn.lastBufferedRequest={chunk:xn,encoding:tn,isBuf:Sn,callback:$t,next:null},Qt?Qt.next=fn.lastBufferedRequest:fn.bufferedRequest=fn.lastBufferedRequest,fn.bufferedRequestCount+=1}else Nt(ln,fn,!1,jt,xn,tn,$t);return Gt}function Nt(ln,fn,Sn,xn,tn,$t,zt){fn.writelen=xn,fn.writecb=zt,fn.writing=!0,fn.sync=!0,fn.destroyed?fn.onwrite(new Xn("write")):Sn?ln._writev(tn,fn.onwrite):ln._write(tn,$t,fn.onwrite),fn.sync=!1}function Pt(ln,fn,Sn,xn,tn){--fn.pendingcb,Sn?(mt.nextTick(tn,xn),mt.nextTick(_i,ln,fn),ln._writableState.errorEmitted=!0,Gn(ln,xn)):(tn(xn),ln._writableState.errorEmitted=!0,Gn(ln,xn),_i(ln,fn))}function Ft(ln){ln.writing=!1,ln.writecb=null,ln.length-=ln.writelen,ln.writelen=0}function Kt(ln,fn){var Sn=ln._writableState,xn=Sn.sync,tn=Sn.writecb;if(typeof tn!="function")throw new Wn;if(Ft(Sn),fn)Pt(ln,Sn,xn,fn,tn);else{var $t=Yt(Sn)||ln.destroyed;$t||Sn.corked||Sn.bufferProcessing||!Sn.bufferedRequest||qt(ln,Sn),xn?mt.nextTick(Bt,ln,Sn,$t,tn):Bt(ln,Sn,$t,tn)}}function Bt(ln,fn,Sn,xn){Sn||Ut(ln,fn),fn.pendingcb--,xn(),_i(ln,fn)}function Ut(ln,fn){fn.length===0&&fn.needDrain&&(fn.needDrain=!1,ln.emit("drain"))}function qt(ln,fn){fn.bufferProcessing=!0;var Sn=fn.bufferedRequest;if(ln._writev&&Sn&&Sn.next){var xn=fn.bufferedRequestCount,tn=Array(xn),$t=fn.corkedRequestsFree;$t.entry=Sn;for(var zt=0,jt=!0;Sn;)tn[zt]=Sn,Sn.isBuf||(jt=!1),Sn=Sn.next,zt+=1;tn.allBuffers=jt,Nt(ln,fn,!0,fn.length,tn,"",$t.finish),fn.pendingcb++,fn.lastBufferedRequest=null,$t.next?(fn.corkedRequestsFree=$t.next,$t.next=null):fn.corkedRequestsFree=new St(fn),fn.bufferedRequestCount=0}else{for(;Sn;){var Gt=Sn.chunk,Qt=Sn.encoding,Jt=Sn.callback,en=fn.objectMode?1:Gt.length;if(Nt(ln,fn,!1,en,Gt,Qt,Jt),Sn=Sn.next,fn.bufferedRequestCount--,fn.writing)break}Sn===null&&(fn.lastBufferedRequest=null)}fn.bufferedRequest=Sn,fn.bufferProcessing=!1}function Yt(ln){return ln.ending&&ln.length===0&&ln.bufferedRequest===null&&!ln.finished&&!ln.writing}function Zt(ln,fn){ln._final(function(Sn){fn.pendingcb--,Sn&&Gn(ln,Sn),fn.prefinished=!0,ln.emit("prefinish"),_i(ln,fn)})}function Xt(ln,fn){fn.prefinished||fn.finalCalled||(typeof ln._final!="function"||fn.destroyed?(fn.prefinished=!0,ln.emit("prefinish")):(fn.pendingcb++,fn.finalCalled=!0,mt.nextTick(Zt,ln,fn)))}function _i(ln,fn){var Sn=Yt(fn);if(Sn&&(Xt(ln,fn),fn.pendingcb===0&&(fn.finished=!0,ln.emit("finish"),fn.autoDestroy))){var xn=ln._readableState;(!xn||xn.autoDestroy&&xn.endEmitted)&&ln.destroy()}return Sn}function nn(ln,fn,Sn){fn.ending=!0,_i(ln,fn),Sn&&(fn.finished?mt.nextTick(Sn):ln.once("finish",Sn)),fn.ended=!0,ln.writable=!1}function rn(ln,fn,Sn){var xn=ln.entry;for(ln.entry=null;xn;){var tn=xn.callback;fn.pendingcb--,tn(Sn),xn=xn.next}fn.corkedRequestsFree.next=ln}pt.exports=It;var dn;It.WritableState=xt;var bn={deprecate:gt("util-deprecate")},un=gt("./internal/streams/stream"),an=gt("buffer").Buffer,Cn=vt.Uint8Array||function(){},_n=gt("./internal/streams/destroy"),hn=gt("./internal/streams/state"),pn=hn.getHighWaterMark,yn=gt("../errors").codes,Mn=yn.ERR_INVALID_ARG_TYPE,Nn=yn.ERR_METHOD_NOT_IMPLEMENTED,Wn=yn.ERR_MULTIPLE_CALLBACK,Jn=yn.ERR_STREAM_CANNOT_PIPE,Xn=yn.ERR_STREAM_DESTROYED,Un=yn.ERR_STREAM_NULL_VALUES,In=yn.ERR_STREAM_WRITE_AFTER_END,jn=yn.ERR_UNKNOWN_ENCODING,Gn=_n.errorOrDestroy;gt("inherits")(It,un),xt.prototype.getBuffer=function(){for(var ln=this.bufferedRequest,fn=[];ln;)fn.push(ln),ln=ln.next;return fn},function(){try{Object.defineProperty(xt.prototype,"buffer",{get:bn.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var qn;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(qn=Function.prototype[Symbol.hasInstance],Object.defineProperty(It,Symbol.hasInstance,{value:function(ln){return!!qn.call(this,ln)||this===It&&ln&&ln._writableState instanceof xt}})):qn=function(ln){return ln instanceof this},It.prototype.pipe=function(){Gn(this,new Jn)},It.prototype.write=function(ln,fn,Sn){var xn=this._writableState,tn=!1,$t=!xn.objectMode&&wt(ln);return $t&&!an.isBuffer(ln)&&(ln=yt(ln)),typeof fn=="function"&&(Sn=fn,fn=null),$t?fn="buffer":!fn&&(fn=xn.defaultEncoding),typeof Sn!="function"&&(Sn=Lt),xn.ending?kt(this,Sn):($t||At(this,xn,ln,Sn))&&(xn.pendingcb++,tn=Rt(this,xn,$t,ln,fn,Sn)),tn},It.prototype.cork=function(){this._writableState.corked++},It.prototype.uncork=function(){var ln=this._writableState;ln.corked&&(ln.corked--,!ln.writing&&!ln.corked&&!ln.bufferProcessing&&ln.bufferedRequest&&qt(this,ln))},It.prototype.setDefaultEncoding=function(ln){if(typeof ln=="string"&&(ln=ln.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ln+"").toLowerCase())))throw new jn(ln);return this._writableState.defaultEncoding=ln,this},Object.defineProperty(It.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(It.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),It.prototype._write=function(ln,fn,Sn){Sn(new Nn("_write()"))},It.prototype._writev=null,It.prototype.end=function(ln,fn,Sn){var xn=this._writableState;return typeof ln=="function"?(Sn=ln,ln=null,fn=null):typeof fn=="function"&&(Sn=fn,fn=null),ln!=null&&this.write(ln,fn),xn.corked&&(xn.corked=1,this.uncork()),xn.ending||nn(this,xn,Sn),this},Object.defineProperty(It.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(It.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(ln){this._writableState&&(this._writableState.destroyed=ln)}}),It.prototype.destroy=_n.destroy,It.prototype._undestroy=_n.undestroy,It.prototype._destroy=function(ln,fn){fn(ln)}}).call(this)}).call(this,gt("_process"),typeof commonjsGlobal>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:commonjsGlobal)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(gt,pt){(function(mt){(function(){function vt(Ut,qt,Yt){return qt in Ut?Object.defineProperty(Ut,qt,{value:Yt,enumerable:!0,configurable:!0,writable:!0}):Ut[qt]=Yt,Ut}function St(Ut,qt){return{value:Ut,done:qt}}function yt(Ut){var qt=Ut[kt];if(qt!==null){var Yt=Ut[Ft].read();Yt!==null&&(Ut[Nt]=null,Ut[kt]=null,Ut[At]=null,qt(St(Yt,!1)))}}function wt(Ut){mt.nextTick(yt,Ut)}function Lt(Ut,qt){return function(Yt,Zt){Ut.then(function(){return qt[Rt]?void Yt(St(void 0,!0)):void qt[Pt](Yt,Zt)},Zt)}}var xt,It=gt("./end-of-stream"),kt=Symbol("lastResolve"),At=Symbol("lastReject"),Tt=Symbol("error"),Rt=Symbol("ended"),Nt=Symbol("lastPromise"),Pt=Symbol("handlePromise"),Ft=Symbol("stream"),Kt=Object.getPrototypeOf(function(){}),Bt=Object.setPrototypeOf((xt={get stream(){return this[Ft]},next:function(){var Ut=this,qt=this[Tt];if(qt!==null)return Promise.reject(qt);if(this[Rt])return Promise.resolve(St(void 0,!0));if(this[Ft].destroyed)return new Promise(function(_i,nn){mt.nextTick(function(){Ut[Tt]?nn(Ut[Tt]):_i(St(void 0,!0))})});var Yt,Zt=this[Nt];if(Zt)Yt=new Promise(Lt(Zt,this));else{var Xt=this[Ft].read();if(Xt!==null)return Promise.resolve(St(Xt,!1));Yt=new Promise(this[Pt])}return this[Nt]=Yt,Yt}},vt(xt,Symbol.asyncIterator,function(){return this}),vt(xt,"return",function(){var Ut=this;return new Promise(function(qt,Yt){Ut[Ft].destroy(null,function(Zt){return Zt?void Yt(Zt):void qt(St(void 0,!0))})})}),xt),Kt);pt.exports=function(Ut){var qt,Yt=Object.create(Bt,(qt={},vt(qt,Ft,{value:Ut,writable:!0}),vt(qt,kt,{value:null,writable:!0}),vt(qt,At,{value:null,writable:!0}),vt(qt,Tt,{value:null,writable:!0}),vt(qt,Rt,{value:Ut._readableState.endEmitted,writable:!0}),vt(qt,Pt,{value:function(Zt,Xt){var _i=Yt[Ft].read();_i?(Yt[Nt]=null,Yt[kt]=null,Yt[At]=null,Zt(St(_i,!1))):(Yt[kt]=Zt,Yt[At]=Xt)},writable:!0}),qt));return Yt[Nt]=null,It(Ut,function(Zt){if(Zt&&Zt.code!=="ERR_STREAM_PREMATURE_CLOSE"){var Xt=Yt[At];return Xt!==null&&(Yt[Nt]=null,Yt[kt]=null,Yt[At]=null,Xt(Zt)),void(Yt[Tt]=Zt)}var _i=Yt[kt];_i!==null&&(Yt[Nt]=null,Yt[kt]=null,Yt[At]=null,_i(St(void 0,!0))),Yt[Rt]=!0}),Ut.on("readable",wt.bind(null,Yt)),Yt}}).call(this)}).call(this,gt("_process"))},{"./end-of-stream":24,_process:12}],22:[function(gt,pt){function mt(Nt,Pt){var Ft=Object.keys(Nt);if(Object.getOwnPropertySymbols){var Kt=Object.getOwnPropertySymbols(Nt);Pt&&(Kt=Kt.filter(function(Bt){return Object.getOwnPropertyDescriptor(Nt,Bt).enumerable})),Ft.push.apply(Ft,Kt)}return Ft}function vt(Nt){for(var Pt,Ft=1;Ft<arguments.length;Ft++)Pt=arguments[Ft]==null?{}:arguments[Ft],Ft%2?mt(Object(Pt),!0).forEach(function(Kt){St(Nt,Kt,Pt[Kt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Nt,Object.getOwnPropertyDescriptors(Pt)):mt(Object(Pt)).forEach(function(Kt){Object.defineProperty(Nt,Kt,Object.getOwnPropertyDescriptor(Pt,Kt))});return Nt}function St(Nt,Pt,Ft){return Pt in Nt?Object.defineProperty(Nt,Pt,{value:Ft,enumerable:!0,configurable:!0,writable:!0}):Nt[Pt]=Ft,Nt}function yt(Nt,Pt){if(!(Nt instanceof Pt))throw new TypeError("Cannot call a class as a function")}function wt(Nt,Pt){for(var Ft,Kt=0;Kt<Pt.length;Kt++)Ft=Pt[Kt],Ft.enumerable=Ft.enumerable||!1,Ft.configurable=!0,"value"in Ft&&(Ft.writable=!0),Object.defineProperty(Nt,Ft.key,Ft)}function Lt(Nt,Pt,Ft){return Pt&&wt(Nt.prototype,Pt),Ft&&wt(Nt,Ft),Nt}function xt(Nt,Pt,Ft){kt.prototype.copy.call(Nt,Pt,Ft)}var It=gt("buffer"),kt=It.Buffer,At=gt("util"),Tt=At.inspect,Rt=Tt&&Tt.custom||"inspect";pt.exports=function(){function Nt(){yt(this,Nt),this.head=null,this.tail=null,this.length=0}return Lt(Nt,[{key:"push",value:function(Pt){var Ft={data:Pt,next:null};0<this.length?this.tail.next=Ft:this.head=Ft,this.tail=Ft,++this.length}},{key:"unshift",value:function(Pt){var Ft={data:Pt,next:this.head};this.length===0&&(this.tail=Ft),this.head=Ft,++this.length}},{key:"shift",value:function(){if(this.length!==0){var Pt=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,Pt}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(Pt){if(this.length===0)return"";for(var Ft=this.head,Kt=""+Ft.data;Ft=Ft.next;)Kt+=Pt+Ft.data;return Kt}},{key:"concat",value:function(Pt){if(this.length===0)return kt.alloc(0);for(var Ft=kt.allocUnsafe(Pt>>>0),Kt=this.head,Bt=0;Kt;)xt(Kt.data,Ft,Bt),Bt+=Kt.data.length,Kt=Kt.next;return Ft}},{key:"consume",value:function(Pt,Ft){var Kt;return Pt<this.head.data.length?(Kt=this.head.data.slice(0,Pt),this.head.data=this.head.data.slice(Pt)):Pt===this.head.data.length?Kt=this.shift():Kt=Ft?this._getString(Pt):this._getBuffer(Pt),Kt}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(Pt){var Ft=this.head,Kt=1,Bt=Ft.data;for(Pt-=Bt.length;Ft=Ft.next;){var Ut=Ft.data,qt=Pt>Ut.length?Ut.length:Pt;if(Bt+=qt===Ut.length?Ut:Ut.slice(0,Pt),Pt-=qt,Pt===0){qt===Ut.length?(++Kt,this.head=Ft.next?Ft.next:this.tail=null):(this.head=Ft,Ft.data=Ut.slice(qt));break}++Kt}return this.length-=Kt,Bt}},{key:"_getBuffer",value:function(Pt){var Ft=kt.allocUnsafe(Pt),Kt=this.head,Bt=1;for(Kt.data.copy(Ft),Pt-=Kt.data.length;Kt=Kt.next;){var Ut=Kt.data,qt=Pt>Ut.length?Ut.length:Pt;if(Ut.copy(Ft,Ft.length-Pt,0,qt),Pt-=qt,Pt===0){qt===Ut.length?(++Bt,this.head=Kt.next?Kt.next:this.tail=null):(this.head=Kt,Kt.data=Ut.slice(qt));break}++Bt}return this.length-=Bt,Ft}},{key:Rt,value:function(Pt,Ft){return Tt(this,vt({},Ft,{depth:0,customInspect:!1}))}}]),Nt}()},{buffer:3,util:2}],23:[function(gt,pt){(function(mt){(function(){function vt(wt,Lt){yt(wt,Lt),St(wt)}function St(wt){wt._writableState&&!wt._writableState.emitClose||wt._readableState&&!wt._readableState.emitClose||wt.emit("close")}function yt(wt,Lt){wt.emit("error",Lt)}pt.exports={destroy:function(wt,Lt){var xt=this,It=this._readableState&&this._readableState.destroyed,kt=this._writableState&&this._writableState.destroyed;return It||kt?(Lt?Lt(wt):wt&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,mt.nextTick(yt,this,wt)):mt.nextTick(yt,this,wt)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(wt||null,function(At){!Lt&&At?xt._writableState?xt._writableState.errorEmitted?mt.nextTick(St,xt):(xt._writableState.errorEmitted=!0,mt.nextTick(vt,xt,At)):mt.nextTick(vt,xt,At):Lt?(mt.nextTick(St,xt),Lt(At)):mt.nextTick(St,xt)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(wt,Lt){var xt=wt._readableState,It=wt._writableState;xt&&xt.autoDestroy||It&&It.autoDestroy?wt.destroy(Lt):wt.emit("error",Lt)}}}).call(this)}).call(this,gt("_process"))},{_process:12}],24:[function(gt,pt){function mt(Lt){var xt=!1;return function(){if(!xt){xt=!0;for(var It=arguments.length,kt=Array(It),At=0;At<It;At++)kt[At]=arguments[At];Lt.apply(this,kt)}}}function vt(){}function St(Lt){return Lt.setHeader&&typeof Lt.abort=="function"}function yt(Lt,xt,It){if(typeof xt=="function")return yt(Lt,null,xt);xt||(xt={}),It=mt(It||vt);var kt=xt.readable||xt.readable!==!1&&Lt.readable,At=xt.writable||xt.writable!==!1&&Lt.writable,Tt=function(){Lt.writable||Nt()},Rt=Lt._writableState&&Lt._writableState.finished,Nt=function(){At=!1,Rt=!0,kt||It.call(Lt)},Pt=Lt._readableState&&Lt._readableState.endEmitted,Ft=function(){kt=!1,Pt=!0,At||It.call(Lt)},Kt=function(qt){It.call(Lt,qt)},Bt=function(){var qt;return kt&&!Pt?(Lt._readableState&&Lt._readableState.ended||(qt=new wt),It.call(Lt,qt)):At&&!Rt?(Lt._writableState&&Lt._writableState.ended||(qt=new wt),It.call(Lt,qt)):void 0},Ut=function(){Lt.req.on("finish",Nt)};return St(Lt)?(Lt.on("complete",Nt),Lt.on("abort",Bt),Lt.req?Ut():Lt.on("request",Ut)):At&&!Lt._writableState&&(Lt.on("end",Tt),Lt.on("close",Tt)),Lt.on("end",Ft),Lt.on("finish",Nt),xt.error!==!1&&Lt.on("error",Kt),Lt.on("close",Bt),function(){Lt.removeListener("complete",Nt),Lt.removeListener("abort",Bt),Lt.removeListener("request",Ut),Lt.req&&Lt.req.removeListener("finish",Nt),Lt.removeListener("end",Tt),Lt.removeListener("close",Tt),Lt.removeListener("finish",Nt),Lt.removeListener("end",Ft),Lt.removeListener("error",Kt),Lt.removeListener("close",Bt)}}var wt=gt("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;pt.exports=yt},{"../../../errors":15}],25:[function(gt,pt){pt.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(gt,pt){function mt(Rt){var Nt=!1;return function(){Nt||(Nt=!0,Rt.apply(void 0,arguments))}}function vt(Rt){if(Rt)throw Rt}function St(Rt){return Rt.setHeader&&typeof Rt.abort=="function"}function yt(Rt,Nt,Pt,Ft){Ft=mt(Ft);var Kt=!1;Rt.on("close",function(){Kt=!0}),It===void 0&&(It=gt("./end-of-stream")),It(Rt,{readable:Nt,writable:Pt},function(Ut){return Ut?Ft(Ut):(Kt=!0,void Ft())});var Bt=!1;return function(Ut){if(!Kt)return Bt?void 0:(Bt=!0,St(Rt)?Rt.abort():typeof Rt.destroy=="function"?Rt.destroy():void Ft(Ut||new Tt("pipe")))}}function wt(Rt){Rt()}function Lt(Rt,Nt){return Rt.pipe(Nt)}function xt(Rt){return Rt.length&&typeof Rt[Rt.length-1]=="function"?Rt.pop():vt}var It,kt=gt("../../../errors").codes,At=kt.ERR_MISSING_ARGS,Tt=kt.ERR_STREAM_DESTROYED;pt.exports=function(){for(var Rt=arguments.length,Nt=Array(Rt),Pt=0;Pt<Rt;Pt++)Nt[Pt]=arguments[Pt];var Ft=xt(Nt);if(Array.isArray(Nt[0])&&(Nt=Nt[0]),2>Nt.length)throw new At("streams");var Kt,Bt=Nt.map(function(Ut,qt){var Yt=qt<Nt.length-1;return yt(Ut,Yt,0<qt,function(Zt){Kt||(Kt=Zt),Zt&&Bt.forEach(wt),Yt||(Bt.forEach(wt),Ft(Kt))})});return Nt.reduce(Lt)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(gt,pt){function mt(St,yt,wt){return St.highWaterMark==null?yt?St[wt]:null:St.highWaterMark}var vt=gt("../../../errors").codes.ERR_INVALID_OPT_VALUE;pt.exports={getHighWaterMark:function(St,yt,wt,Lt){var xt=mt(yt,Lt,wt);if(xt!=null){if(!(isFinite(xt)&&ot(xt)===xt)||0>xt){var It=Lt?wt:"highWaterMark";throw new vt(It,xt)}return ot(xt)}return St.objectMode?16:16384}}},{"../../../errors":15}],28:[function(gt,pt){pt.exports=gt("events").EventEmitter},{events:7}],29:[function(gt,pt,mt){mt=pt.exports=gt("./lib/_stream_readable.js"),mt.Stream=mt,mt.Readable=mt,mt.Writable=gt("./lib/_stream_writable.js"),mt.Duplex=gt("./lib/_stream_duplex.js"),mt.Transform=gt("./lib/_stream_transform.js"),mt.PassThrough=gt("./lib/_stream_passthrough.js"),mt.finished=gt("./lib/internal/streams/end-of-stream.js"),mt.pipeline=gt("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(gt,pt,mt){function vt(Lt,xt){for(var It in Lt)xt[It]=Lt[It]}function St(Lt,xt,It){return wt(Lt,xt,It)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var yt=gt("buffer"),wt=yt.Buffer;wt.from&&wt.alloc&&wt.allocUnsafe&&wt.allocUnsafeSlow?pt.exports=yt:(vt(yt,mt),mt.Buffer=St),St.prototype=Object.create(wt.prototype),vt(wt,St),St.from=function(Lt,xt,It){if(typeof Lt=="number")throw new TypeError("Argument must not be a number");return wt(Lt,xt,It)},St.alloc=function(Lt,xt,It){if(typeof Lt!="number")throw new TypeError("Argument must be a number");var kt=wt(Lt);return xt===void 0?kt.fill(0):typeof It=="string"?kt.fill(xt,It):kt.fill(xt),kt},St.allocUnsafe=function(Lt){if(typeof Lt!="number")throw new TypeError("Argument must be a number");return wt(Lt)},St.allocUnsafeSlow=function(Lt){if(typeof Lt!="number")throw new TypeError("Argument must be a number");return yt.SlowBuffer(Lt)}},{buffer:3}],31:[function(gt,pt,mt){function vt(Bt){if(!Bt)return"utf8";for(var Ut;;)switch(Bt){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return Bt;default:if(Ut)return;Bt=(""+Bt).toLowerCase(),Ut=!0}}function St(Bt){var Ut=vt(Bt);if(typeof Ut!="string"&&(Ft.isEncoding===Kt||!Kt(Bt)))throw new Error("Unknown encoding: "+Bt);return Ut||Bt}function yt(Bt){this.encoding=St(Bt);var Ut;switch(this.encoding){case"utf16le":this.text=kt,this.end=At,Ut=4;break;case"utf8":this.fillLast=It,Ut=4;break;case"base64":this.text=Tt,this.end=Rt,Ut=3;break;default:return this.write=Nt,void(this.end=Pt)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Ft.allocUnsafe(Ut)}function wt(Bt){return 127>=Bt?0:Bt>>5==6?2:Bt>>4==14?3:Bt>>3==30?4:Bt>>6==2?-1:-2}function Lt(Bt,Ut,qt){var Yt=Ut.length-1;if(Yt<qt)return 0;var Zt=wt(Ut[Yt]);return 0<=Zt?(0<Zt&&(Bt.lastNeed=Zt-1),Zt):--Yt<qt||Zt===-2?0:(Zt=wt(Ut[Yt]),0<=Zt?(0<Zt&&(Bt.lastNeed=Zt-2),Zt):--Yt<qt||Zt===-2?0:(Zt=wt(Ut[Yt]),0<=Zt?(0<Zt&&(Zt===2?Zt=0:Bt.lastNeed=Zt-3),Zt):0))}function xt(Bt,Ut){if((192&Ut[0])!=128)return Bt.lastNeed=0,"";if(1<Bt.lastNeed&&1<Ut.length){if((192&Ut[1])!=128)return Bt.lastNeed=1,"";if(2<Bt.lastNeed&&2<Ut.length&&(192&Ut[2])!=128)return Bt.lastNeed=2,""}}function It(Bt){var Ut=this.lastTotal-this.lastNeed,qt=xt(this,Bt);return qt===void 0?this.lastNeed<=Bt.length?(Bt.copy(this.lastChar,Ut,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(Bt.copy(this.lastChar,Ut,0,Bt.length),void(this.lastNeed-=Bt.length)):qt}function kt(Bt,Ut){if((Bt.length-Ut)%2==0){var qt=Bt.toString("utf16le",Ut);if(qt){var Yt=qt.charCodeAt(qt.length-1);if(55296<=Yt&&56319>=Yt)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=Bt[Bt.length-2],this.lastChar[1]=Bt[Bt.length-1],qt.slice(0,-1)}return qt}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=Bt[Bt.length-1],Bt.toString("utf16le",Ut,Bt.length-1)}function At(Bt){var Ut=Bt&&Bt.length?this.write(Bt):"";if(this.lastNeed){var qt=this.lastTotal-this.lastNeed;return Ut+this.lastChar.toString("utf16le",0,qt)}return Ut}function Tt(Bt,Ut){var qt=(Bt.length-Ut)%3;return qt==0?Bt.toString("base64",Ut):(this.lastNeed=3-qt,this.lastTotal=3,qt==1?this.lastChar[0]=Bt[Bt.length-1]:(this.lastChar[0]=Bt[Bt.length-2],this.lastChar[1]=Bt[Bt.length-1]),Bt.toString("base64",Ut,Bt.length-qt))}function Rt(Bt){var Ut=Bt&&Bt.length?this.write(Bt):"";return this.lastNeed?Ut+this.lastChar.toString("base64",0,3-this.lastNeed):Ut}function Nt(Bt){return Bt.toString(this.encoding)}function Pt(Bt){return Bt&&Bt.length?this.write(Bt):""}var Ft=gt("safe-buffer").Buffer,Kt=Ft.isEncoding||function(Bt){switch(Bt=""+Bt,Bt&&Bt.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};mt.StringDecoder=yt,yt.prototype.write=function(Bt){if(Bt.length===0)return"";var Ut,qt;if(this.lastNeed){if(Ut=this.fillLast(Bt),Ut===void 0)return"";qt=this.lastNeed,this.lastNeed=0}else qt=0;return qt<Bt.length?Ut?Ut+this.text(Bt,qt):this.text(Bt,qt):Ut||""},yt.prototype.end=function(Bt){var Ut=Bt&&Bt.length?this.write(Bt):"";return this.lastNeed?Ut+"":Ut},yt.prototype.text=function(Bt,Ut){var qt=Lt(this,Bt,Ut);if(!this.lastNeed)return Bt.toString("utf8",Ut);this.lastTotal=qt;var Yt=Bt.length-(qt-this.lastNeed);return Bt.copy(this.lastChar,0,Yt),Bt.toString("utf8",Ut,Yt)},yt.prototype.fillLast=function(Bt){return this.lastNeed<=Bt.length?(Bt.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(Bt.copy(this.lastChar,this.lastTotal-this.lastNeed,0,Bt.length),void(this.lastNeed-=Bt.length))}},{"safe-buffer":30}],32:[function(gt,pt){(function(mt){(function(){function vt(St){try{if(!mt.localStorage)return!1}catch{return!1}var yt=mt.localStorage[St];return yt!=null&&(yt+"").toLowerCase()==="true"}pt.exports=function(St,yt){function wt(){if(!Lt){if(vt("throwDeprecation"))throw new Error(yt);vt("traceDeprecation")?console.trace(yt):console.warn(yt),Lt=!0}return St.apply(this,arguments)}if(vt("noDeprecation"))return St;var Lt=!1;return wt}}).call(this)}).call(this,typeof commonjsGlobal>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:commonjsGlobal)},{}],"/":[function(gt,pt){function mt(Rt){return Rt.replace(/a=ice-options:trickle\s\n/g,"")}function vt(Rt){console.warn(Rt)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const St=gt("debug")("simple-peer"),yt=gt("get-browser-rtc"),wt=gt("randombytes"),Lt=gt("readable-stream"),xt=gt("queue-microtask"),It=gt("err-code"),{Buffer:kt}=gt("buffer"),At=65536;class Tt extends Lt.Duplex{constructor(Nt){if(Nt=Object.assign({allowHalfOpen:!1},Nt),super(Nt),this._id=wt(4).toString("hex").slice(0,7),this._debug("new peer %o",Nt),this.channelName=Nt.initiator?Nt.channelName||wt(20).toString("hex"):null,this.initiator=Nt.initiator||!1,this.channelConfig=Nt.channelConfig||Tt.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},Tt.config,Nt.config),this.offerOptions=Nt.offerOptions||{},this.answerOptions=Nt.answerOptions||{},this.sdpTransform=Nt.sdpTransform||(Pt=>Pt),this.streams=Nt.streams||(Nt.stream?[Nt.stream]:[]),this.trickle=Nt.trickle===void 0||Nt.trickle,this.allowHalfTrickle=Nt.allowHalfTrickle!==void 0&&Nt.allowHalfTrickle,this.iceCompleteTimeout=Nt.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=Nt.wrtc&&typeof Nt.wrtc=="object"?Nt.wrtc:yt(),!this._wrtc)throw It(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(Pt){return void this.destroy(It(Pt,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=Pt=>{this._onIceCandidate(Pt)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(Pt=>{this.destroy(It(Pt,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=Pt=>{this._setupData(Pt)},this.streams&&this.streams.forEach(Pt=>{this.addStream(Pt)}),this._pc.ontrack=Pt=>{this._onTrack(Pt)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(Nt){if(!this.destroying){if(this.destroyed)throw It(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof Nt=="string")try{Nt=JSON.parse(Nt)}catch{Nt={}}this._debug("signal()"),Nt.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),Nt.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(Nt.transceiverRequest.kind,Nt.transceiverRequest.init)),Nt.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(Nt.candidate):this._pendingCandidates.push(Nt.candidate)),Nt.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(Nt)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(Pt=>{this._addIceCandidate(Pt)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(Pt=>{this.destroy(It(Pt,"ERR_SET_REMOTE_DESCRIPTION"))}),Nt.sdp||Nt.candidate||Nt.renegotiate||Nt.transceiverRequest||this.destroy(It(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(Nt){const Pt=new this._wrtc.RTCIceCandidate(Nt);this._pc.addIceCandidate(Pt).catch(Ft=>{!Pt.address||Pt.address.endsWith(".local")?vt("Ignoring unsupported ICE candidate."):this.destroy(It(Ft,"ERR_ADD_ICE_CANDIDATE"))})}send(Nt){if(!this.destroying){if(this.destroyed)throw It(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(Nt)}}addTransceiver(Nt,Pt){if(!this.destroying){if(this.destroyed)throw It(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(Nt,Pt),this._needsNegotiation()}catch(Ft){this.destroy(It(Ft,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:Nt,init:Pt}})}}addStream(Nt){if(!this.destroying){if(this.destroyed)throw It(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),Nt.getTracks().forEach(Pt=>{this.addTrack(Pt,Nt)})}}addTrack(Nt,Pt){if(this.destroying)return;if(this.destroyed)throw It(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const Ft=this._senderMap.get(Nt)||new Map;let Kt=Ft.get(Pt);if(!Kt)Kt=this._pc.addTrack(Nt,Pt),Ft.set(Pt,Kt),this._senderMap.set(Nt,Ft),this._needsNegotiation();else throw Kt.removed?It(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):It(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(Nt,Pt,Ft){if(this.destroying)return;if(this.destroyed)throw It(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const Kt=this._senderMap.get(Nt),Bt=Kt?Kt.get(Ft):null;if(!Bt)throw It(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");Pt&&this._senderMap.set(Pt,Kt),Bt.replaceTrack==null?this.destroy(It(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):Bt.replaceTrack(Pt)}removeTrack(Nt,Pt){if(this.destroying)return;if(this.destroyed)throw It(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const Ft=this._senderMap.get(Nt),Kt=Ft?Ft.get(Pt):null;if(!Kt)throw It(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{Kt.removed=!0,this._pc.removeTrack(Kt)}catch(Bt){Bt.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(Kt):this.destroy(It(Bt,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(Nt){if(!this.destroying){if(this.destroyed)throw It(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),Nt.getTracks().forEach(Pt=>{this.removeTrack(Pt,Nt)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,xt(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw It(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(Nt){this._destroy(Nt,()=>{})}_destroy(Nt,Pt){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",Nt&&(Nt.message||Nt)),xt(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",Nt&&(Nt.message||Nt)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,Nt&&this.emit("error",Nt),this.emit("close"),Pt()}))}_setupData(Nt){if(!Nt.channel)return this.destroy(It(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=Nt.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=At),this.channelName=this._channel.label,this._channel.onmessage=Ft=>{this._onChannelMessage(Ft)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=Ft=>{const Kt=Ft.error instanceof Error?Ft.error:new Error(`Datachannel error: ${Ft.message} ${Ft.filename}:${Ft.lineno}:${Ft.colno}`);this.destroy(It(Kt,"ERR_DATA_CHANNEL"))};let Pt=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(Pt&&this._onChannelClose(),Pt=!0):Pt=!1},5e3)}_read(){}_write(Nt,Pt,Ft){if(this.destroyed)return Ft(It(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(Nt)}catch(Kt){return this.destroy(It(Kt,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>At?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=Ft):Ft(null)}else this._debug("write before connect"),this._chunk=Nt,this._cb=Ft}_onFinish(){if(!this.destroyed){const Nt=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?Nt():this.once("connect",Nt)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(Nt=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(Nt.sdp=mt(Nt.sdp)),Nt.sdp=this.sdpTransform(Nt.sdp);const Pt=()=>{if(!this.destroyed){const Ft=this._pc.localDescription||Nt;this._debug("signal"),this.emit("signal",{type:Ft.type,sdp:Ft.sdp})}};this._pc.setLocalDescription(Nt).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?Pt():this.once("_iceComplete",Pt))}).catch(Ft=>{this.destroy(It(Ft,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(Nt=>{this.destroy(It(Nt,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(Nt=>{Nt.mid||!Nt.sender.track||Nt.requested||(Nt.requested=!0,this.addTransceiver(Nt.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(Nt=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(Nt.sdp=mt(Nt.sdp)),Nt.sdp=this.sdpTransform(Nt.sdp);const Pt=()=>{if(!this.destroyed){const Ft=this._pc.localDescription||Nt;this._debug("signal"),this.emit("signal",{type:Ft.type,sdp:Ft.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(Nt).then(()=>{this.destroyed||(this.trickle||this._iceComplete?Pt():this.once("_iceComplete",Pt))}).catch(Ft=>{this.destroy(It(Ft,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(Nt=>{this.destroy(It(Nt,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(It(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const Nt=this._pc.iceConnectionState,Pt=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",Nt,Pt),this.emit("iceStateChange",Nt,Pt),(Nt==="connected"||Nt==="completed")&&(this._pcReady=!0,this._maybeReady()),Nt==="failed"&&this.destroy(It(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),Nt==="closed"&&this.destroy(It(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(Nt){const Pt=Ft=>(Object.prototype.toString.call(Ft.values)==="[object Array]"&&Ft.values.forEach(Kt=>{Object.assign(Ft,Kt)}),Ft);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(Ft=>{const Kt=[];Ft.forEach(Bt=>{Kt.push(Pt(Bt))}),Nt(null,Kt)},Ft=>Nt(Ft)):0<this._pc.getStats.length?this._pc.getStats(Ft=>{if(this.destroyed)return;const Kt=[];Ft.result().forEach(Bt=>{const Ut={};Bt.names().forEach(qt=>{Ut[qt]=Bt.stat(qt)}),Ut.id=Bt.id,Ut.type=Bt.type,Ut.timestamp=Bt.timestamp,Kt.push(Pt(Ut))}),Nt(null,Kt)},Ft=>Nt(Ft)):Nt(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const Nt=()=>{this.destroyed||this.getStats((Pt,Ft)=>{if(this.destroyed)return;Pt&&(Ft=[]);const Kt={},Bt={},Ut={};let qt=!1;Ft.forEach(Zt=>{(Zt.type==="remotecandidate"||Zt.type==="remote-candidate")&&(Kt[Zt.id]=Zt),(Zt.type==="localcandidate"||Zt.type==="local-candidate")&&(Bt[Zt.id]=Zt),(Zt.type==="candidatepair"||Zt.type==="candidate-pair")&&(Ut[Zt.id]=Zt)});const Yt=Zt=>{qt=!0;let Xt=Bt[Zt.localCandidateId];Xt&&(Xt.ip||Xt.address)?(this.localAddress=Xt.ip||Xt.address,this.localPort=+Xt.port):Xt&&Xt.ipAddress?(this.localAddress=Xt.ipAddress,this.localPort=+Xt.portNumber):typeof Zt.googLocalAddress=="string"&&(Xt=Zt.googLocalAddress.split(":"),this.localAddress=Xt[0],this.localPort=+Xt[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let _i=Kt[Zt.remoteCandidateId];_i&&(_i.ip||_i.address)?(this.remoteAddress=_i.ip||_i.address,this.remotePort=+_i.port):_i&&_i.ipAddress?(this.remoteAddress=_i.ipAddress,this.remotePort=+_i.portNumber):typeof Zt.googRemoteAddress=="string"&&(_i=Zt.googRemoteAddress.split(":"),this.remoteAddress=_i[0],this.remotePort=+_i[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(Ft.forEach(Zt=>{Zt.type==="transport"&&Zt.selectedCandidatePairId&&Yt(Ut[Zt.selectedCandidatePairId]),(Zt.type==="googCandidatePair"&&Zt.googActiveConnection==="true"||(Zt.type==="candidatepair"||Zt.type==="candidate-pair")&&Zt.selected)&&Yt(Zt)}),!qt&&(!Object.keys(Ut).length||Object.keys(Bt).length))return void setTimeout(Nt,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(Xt){return this.destroy(It(Xt,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const Zt=this._cb;this._cb=null,Zt(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};Nt()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>At)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(Nt=>{this._pc.removeTrack(Nt),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(Nt){this.destroyed||(Nt.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:Nt.candidate.candidate,sdpMLineIndex:Nt.candidate.sdpMLineIndex,sdpMid:Nt.candidate.sdpMid}}):!Nt.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),Nt.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(Nt){if(this.destroyed)return;let Pt=Nt.data;Pt instanceof ArrayBuffer&&(Pt=kt.from(Pt)),this.push(Pt)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const Nt=this._cb;this._cb=null,Nt(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(Nt){this.destroyed||Nt.streams.forEach(Pt=>{this._debug("on track"),this.emit("track",Nt.track,Pt),this._remoteTracks.push({track:Nt.track,stream:Pt}),this._remoteStreams.some(Ft=>Ft.id===Pt.id)||(this._remoteStreams.push(Pt),xt(()=>{this._debug("on stream"),this.emit("stream",Pt)}))})}_debug(){const Nt=[].slice.call(arguments);Nt[0]="["+this._id+"] "+Nt[0],St.apply(null,Nt)}}Tt.WEBRTC_SUPPORT=!!yt(),Tt.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},Tt.channelConfig={},pt.exports=Tt},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(simplepeer_min);var simplepeer_minExports=simplepeer_min.exports;const Peer=getDefaultExportFromCjs(simplepeer_minExports),messageYjsSyncStep1=0,messageYjsSyncStep2=1,messageYjsUpdate=2,writeSyncStep1=(ct,nt)=>{writeVarUint(ct,messageYjsSyncStep1);const ot=encodeStateVector(nt);writeVarUint8Array(ct,ot)},writeSyncStep2=(ct,nt,ot)=>{writeVarUint(ct,messageYjsSyncStep2),writeVarUint8Array(ct,encodeStateAsUpdate(nt,ot))},readSyncStep1=(ct,nt,ot)=>writeSyncStep2(nt,ot,readVarUint8Array(ct)),readSyncStep2=(ct,nt,ot)=>{try{applyUpdate$1(nt,readVarUint8Array(ct),ot)}catch(rt){console.error("Caught error while handling a Yjs update",rt)}},writeUpdate=(ct,nt)=>{writeVarUint(ct,messageYjsUpdate),writeVarUint8Array(ct,nt)},readUpdate=readSyncStep2,readSyncMessage=(ct,nt,ot,rt)=>{const ut=readVarUint(ct);switch(ut){case messageYjsSyncStep1:readSyncStep1(ct,nt,ot);break;case messageYjsSyncStep2:readSyncStep2(ct,ot,rt);break;case messageYjsUpdate:readUpdate(ct,ot,rt);break;default:throw new Error("Unknown message type")}return ut},outdatedTimeout=3e4;class Awareness extends Observable{constructor(nt){super(),this.doc=nt,this.clientID=nt.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const ot=getUnixTime();this.getLocalState()!==null&&outdatedTimeout/2<=ot-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const rt=[];this.meta.forEach((ut,gt)=>{gt!==this.clientID&&outdatedTimeout<=ot-ut.lastUpdated&&this.states.has(gt)&&rt.push(gt)}),rt.length>0&&removeAwarenessStates(this,rt,"timeout")},floor(outdatedTimeout/10)),nt.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(nt){const ot=this.clientID,rt=this.meta.get(ot),ut=rt===void 0?0:rt.clock+1,gt=this.states.get(ot);nt===null?this.states.delete(ot):this.states.set(ot,nt),this.meta.set(ot,{clock:ut,lastUpdated:getUnixTime()});const pt=[],mt=[],vt=[],St=[];nt===null?St.push(ot):gt==null?nt!=null&&pt.push(ot):(mt.push(ot),equalityDeep(gt,nt)||vt.push(ot)),(pt.length>0||vt.length>0||St.length>0)&&this.emit("change",[{added:pt,updated:vt,removed:St},"local"]),this.emit("update",[{added:pt,updated:mt,removed:St},"local"])}setLocalStateField(nt,ot){const rt=this.getLocalState();rt!==null&&this.setLocalState({...rt,[nt]:ot})}getStates(){return this.states}}const removeAwarenessStates=(ct,nt,ot)=>{const rt=[];for(let ut=0;ut<nt.length;ut++){const gt=nt[ut];if(ct.states.has(gt)){if(ct.states.delete(gt),gt===ct.clientID){const pt=ct.meta.get(gt);ct.meta.set(gt,{clock:pt.clock+1,lastUpdated:getUnixTime()})}rt.push(gt)}}rt.length>0&&(ct.emit("change",[{added:[],updated:[],removed:rt},ot]),ct.emit("update",[{added:[],updated:[],removed:rt},ot]))},encodeAwarenessUpdate=(ct,nt,ot=ct.states)=>{const rt=nt.length,ut=createEncoder();writeVarUint(ut,rt);for(let gt=0;gt<rt;gt++){const pt=nt[gt],mt=ot.get(pt)||null,vt=ct.meta.get(pt).clock;writeVarUint(ut,pt),writeVarUint(ut,vt),writeVarString(ut,JSON.stringify(mt))}return toUint8Array(ut)},applyAwarenessUpdate=(ct,nt,ot)=>{const rt=createDecoder(nt),ut=getUnixTime(),gt=[],pt=[],mt=[],vt=[],St=readVarUint(rt);for(let yt=0;yt<St;yt++){const wt=readVarUint(rt);let Lt=readVarUint(rt);const xt=JSON.parse(readVarString(rt)),It=ct.meta.get(wt),kt=ct.states.get(wt),At=It===void 0?0:It.clock;(At<Lt||At===Lt&&xt===null&&ct.states.has(wt))&&(xt===null?wt===ct.clientID&&ct.getLocalState()!=null?Lt++:ct.states.delete(wt):ct.states.set(wt,xt),ct.meta.set(wt,{clock:Lt,lastUpdated:ut}),It===void 0&&xt!==null?gt.push(wt):It!==void 0&&xt===null?vt.push(wt):xt!==null&&(equalityDeep(xt,kt)||mt.push(wt),pt.push(wt)))}(gt.length>0||mt.length>0||vt.length>0)&&ct.emit("change",[{added:gt,updated:mt,removed:vt},ot]),(gt.length>0||pt.length>0||vt.length>0)&&ct.emit("update",[{added:gt,updated:pt,removed:vt},ot])},deriveKey=(ct,nt)=>{const ot=encodeUtf8(ct).buffer,rt=encodeUtf8(nt).buffer;return crypto.subtle.importKey("raw",ot,"PBKDF2",!1,["deriveKey"]).then(ut=>crypto.subtle.deriveKey({name:"PBKDF2",salt:rt,iterations:1e5,hash:"SHA-256"},ut,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},encrypt=(ct,nt)=>{if(!nt)return resolve$1(ct);const ot=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:ot},nt,ct).then(rt=>{const ut=createEncoder();return writeVarString(ut,"AES-GCM"),writeVarUint8Array(ut,ot),writeVarUint8Array(ut,new Uint8Array(rt)),toUint8Array(ut)})},encryptJson=(ct,nt)=>{const ot=createEncoder();return writeAny(ot,ct),encrypt(toUint8Array(ot),nt)},decrypt=(ct,nt)=>{if(!nt)return resolve$1(ct);const ot=createDecoder(ct);readVarString(ot)!=="AES-GCM"&&reject(create$5("Unknown encryption algorithm"));const ut=readVarUint8Array(ot),gt=readVarUint8Array(ot);return crypto.subtle.decrypt({name:"AES-GCM",iv:ut},nt,gt).then(pt=>new Uint8Array(pt))},decryptJson=(ct,nt)=>decrypt(ct,nt).then(ot=>readAny(createDecoder(new Uint8Array(ot)))),log$1=createModuleLogger("y-webrtc"),messageSync=0,messageQueryAwareness=3,messageAwareness=1,messageBcPeerId=4,signalingConns=new Map,rooms=new Map,checkIsSynced=ct=>{let nt=!0;ct.webrtcConns.forEach(ot=>{ot.synced||(nt=!1)}),(!nt&&ct.synced||nt&&!ct.synced)&&(ct.synced=nt,ct.provider.emit("synced",[{synced:nt}]),log$1("synced ",BOLD,ct.name,UNBOLD," with all peers"))},readMessage=(ct,nt,ot)=>{const rt=createDecoder(nt),ut=createEncoder(),gt=readVarUint(rt);if(ct===void 0)return null;const pt=ct.awareness,mt=ct.doc;let vt=!1;switch(gt){case messageSync:{writeVarUint(ut,messageSync);const St=readSyncMessage(rt,ut,mt,ct);St===messageYjsSyncStep2&&!ct.synced&&ot(),St===messageYjsSyncStep1&&(vt=!0);break}case messageQueryAwareness:writeVarUint(ut,messageAwareness),writeVarUint8Array(ut,encodeAwarenessUpdate(pt,Array.from(pt.getStates().keys()))),vt=!0;break;case messageAwareness:applyAwarenessUpdate(pt,readVarUint8Array(rt),ct);break;case messageBcPeerId:{const St=readUint8(rt)===1,yt=readVarString(rt);if(yt!==ct.peerId&&(ct.bcConns.has(yt)&&!St||!ct.bcConns.has(yt)&&St)){const wt=[],Lt=[];St?(ct.bcConns.add(yt),Lt.push(yt)):(ct.bcConns.delete(yt),wt.push(yt)),ct.provider.emit("peers",[{added:Lt,removed:wt,webrtcPeers:Array.from(ct.webrtcConns.keys()),bcPeers:Array.from(ct.bcConns)}]),broadcastBcPeerId(ct)}break}default:return console.error("Unable to compute message"),ut}return vt?ut:null},readPeerMessage=(ct,nt)=>{const ot=ct.room;return log$1("received message from ",BOLD,ct.remotePeerId,GREY," (",ot.name,")",UNBOLD,UNCOLOR),readMessage(ot,nt,()=>{ct.synced=!0,log$1("synced ",BOLD,ot.name,UNBOLD," with ",BOLD,ct.remotePeerId),checkIsSynced(ot)})},sendWebrtcConn=(ct,nt)=>{log$1("send message to ",BOLD,ct.remotePeerId,UNBOLD,GREY," (",ct.room.name,")",UNCOLOR);try{ct.peer.send(toUint8Array(nt))}catch{}},broadcastWebrtcConn=(ct,nt)=>{log$1("broadcast message in ",BOLD,ct.name,UNBOLD),ct.webrtcConns.forEach(ot=>{try{ot.peer.send(nt)}catch{}})};class WebrtcConn{constructor(nt,ot,rt,ut){log$1("establishing connection to ",BOLD,rt),this.room=ut,this.remotePeerId=rt,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new Peer({initiator:ot,...ut.provider.peerOpts}),this.peer.on("signal",gt=>{publishSignalingMessage(nt,ut,{to:rt,from:ut.peerId,type:"signal",signal:gt})}),this.peer.on("connect",()=>{log$1("connected to ",BOLD,rt),this.connected=!0;const pt=ut.provider.doc,mt=ut.awareness,vt=createEncoder();writeVarUint(vt,messageSync),writeSyncStep1(vt,pt),sendWebrtcConn(this,vt);const St=mt.getStates();if(St.size>0){const yt=createEncoder();writeVarUint(yt,messageAwareness),writeVarUint8Array(yt,encodeAwarenessUpdate(mt,Array.from(St.keys()))),sendWebrtcConn(this,yt)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,ut.webrtcConns.has(this.remotePeerId)&&(ut.webrtcConns.delete(this.remotePeerId),ut.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(ut.webrtcConns.keys()),bcPeers:Array.from(ut.bcConns)}])),checkIsSynced(ut),this.peer.destroy(),log$1("closed connection to ",BOLD,rt),announceSignalingInfo(ut)}),this.peer.on("error",gt=>{log$1("Error in connection to ",BOLD,rt,": ",gt),announceSignalingInfo(ut)}),this.peer.on("data",gt=>{const pt=readPeerMessage(this,gt);pt!==null&&sendWebrtcConn(this,pt)})}destroy(){this.peer.destroy()}}const broadcastBcMessage=(ct,nt)=>encrypt(nt,ct.key).then(ot=>ct.mux(()=>publish(ct.name,ot))),broadcastRoomMessage=(ct,nt)=>{ct.bcconnected&&broadcastBcMessage(ct,nt),broadcastWebrtcConn(ct,nt)},announceSignalingInfo=ct=>{signalingConns.forEach(nt=>{nt.connected&&(nt.send({type:"subscribe",topics:[ct.name]}),ct.webrtcConns.size<ct.provider.maxConns&&publishSignalingMessage(nt,ct,{type:"announce",from:ct.peerId}))})},broadcastBcPeerId=ct=>{if(ct.provider.filterBcConns){const nt=createEncoder();writeVarUint(nt,messageBcPeerId),writeUint8(nt,1),writeVarString(nt,ct.peerId),broadcastBcMessage(ct,toUint8Array(nt))}};class Room{constructor(nt,ot,rt,ut){this.peerId=uuidv4(),this.doc=nt,this.awareness=ot.awareness,this.provider=ot,this.synced=!1,this.name=rt,this.key=ut,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=createMutex(),this.bcconnected=!1,this._bcSubscriber=gt=>decrypt(new Uint8Array(gt),ut).then(pt=>this.mux(()=>{const mt=readMessage(this,pt,()=>{});mt&&broadcastBcMessage(this,toUint8Array(mt))})),this._docUpdateHandler=(gt,pt)=>{const mt=createEncoder();writeVarUint(mt,messageSync),writeUpdate(mt,gt),broadcastRoomMessage(this,toUint8Array(mt))},this._awarenessUpdateHandler=({added:gt,updated:pt,removed:mt},vt)=>{const St=gt.concat(pt).concat(mt),yt=createEncoder();writeVarUint(yt,messageAwareness),writeVarUint8Array(yt,encodeAwarenessUpdate(this.awareness,St)),broadcastRoomMessage(this,toUint8Array(yt))},this._beforeUnloadHandler=()=>{removeAwarenessStates(this.awareness,[nt.clientID],"window unload"),rooms.forEach(gt=>{gt.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),announceSignalingInfo(this);const nt=this.name;subscribe(nt,this._bcSubscriber),this.bcconnected=!0,broadcastBcPeerId(this);const ot=createEncoder();writeVarUint(ot,messageSync),writeSyncStep1(ot,this.doc),broadcastBcMessage(this,toUint8Array(ot));const rt=createEncoder();writeVarUint(rt,messageSync),writeSyncStep2(rt,this.doc),broadcastBcMessage(this,toUint8Array(rt));const ut=createEncoder();writeVarUint(ut,messageQueryAwareness),broadcastBcMessage(this,toUint8Array(ut));const gt=createEncoder();writeVarUint(gt,messageAwareness),writeVarUint8Array(gt,encodeAwarenessUpdate(this.awareness,[this.doc.clientID])),broadcastBcMessage(this,toUint8Array(gt))}disconnect(){signalingConns.forEach(ot=>{ot.connected&&ot.send({type:"unsubscribe",topics:[this.name]})}),removeAwarenessStates(this.awareness,[this.doc.clientID],"disconnect");const nt=createEncoder();writeVarUint(nt,messageBcPeerId),writeUint8(nt,0),writeVarString(nt,this.peerId),broadcastBcMessage(this,toUint8Array(nt)),unsubscribe(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(ot=>ot.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const openRoom=(ct,nt,ot,rt)=>{if(rooms.has(ot))throw create$5(`A Yjs Doc connected to room "${ot}" already exists!`);const ut=new Room(ct,nt,ot,rt);return rooms.set(ot,ut),ut},publishSignalingMessage=(ct,nt,ot)=>{nt.key?encryptJson(ot,nt.key).then(rt=>{ct.send({type:"publish",topic:nt.name,data:toBase64(rt)})}):ct.send({type:"publish",topic:nt.name,data:ot})};class SignalingConn extends WebsocketClient{constructor(nt){super(nt),this.providers=new Set,this.on("connect",()=>{log$1(`connected (${nt})`);const ot=Array.from(rooms.keys());this.send({type:"subscribe",topics:ot}),rooms.forEach(rt=>publishSignalingMessage(this,rt,{type:"announce",from:rt.peerId}))}),this.on("message",ot=>{switch(ot.type){case"publish":{const rt=ot.topic,ut=rooms.get(rt);if(ut==null||typeof rt!="string")return;const gt=pt=>{const mt=ut.webrtcConns,vt=ut.peerId;if(pt==null||pt.from===vt||pt.to!==void 0&&pt.to!==vt||ut.bcConns.has(pt.from))return;const St=mt.has(pt.from)?()=>{}:()=>ut.provider.emit("peers",[{removed:[],added:[pt.from],webrtcPeers:Array.from(ut.webrtcConns.keys()),bcPeers:Array.from(ut.bcConns)}]);switch(pt.type){case"announce":mt.size<ut.provider.maxConns&&(setIfUndefined(mt,pt.from,()=>new WebrtcConn(this,!0,pt.from,ut)),St());break;case"signal":pt.to===vt&&(setIfUndefined(mt,pt.from,()=>new WebrtcConn(this,!1,pt.from,ut)).peer.signal(pt.signal),St());break}};ut.key?typeof ot.data=="string"&&decryptJson(fromBase64(ot.data),ut.key).then(gt):gt(ot.data)}}}),this.on("disconnect",()=>log$1(`disconnect (${nt})`))}}class WebrtcProvider extends Observable{constructor(nt,ot,{signaling:rt=["wss://y-webrtc-eu.fly.dev"],password:ut=null,awareness:gt=new Awareness(ot),maxConns:pt=20+floor(rand()*15),filterBcConns:mt=!0,peerOpts:vt={}}={}){super(),this.roomName=nt,this.doc=ot,this.filterBcConns=mt,this.awareness=gt,this.shouldConnect=!1,this.signalingUrls=rt,this.signalingConns=[],this.maxConns=pt,this.peerOpts=vt,this.key=ut?deriveKey(ut,nt):resolve$1(null),this.room=null,this.key.then(St=>{this.room=openRoom(ot,this,nt,St),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),ot.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(nt=>{const ot=setIfUndefined(signalingConns,nt,()=>new SignalingConn(nt));this.signalingConns.push(ot),ot.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(nt=>{nt.providers.delete(this),nt.providers.size===0&&(nt.destroy(),signalingConns.delete(nt.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),rooms.delete(this.roomName)}),super.destroy()}}globalThis&&globalThis.__awaiter;let isPseudo=typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function _format$1(ct,nt){let ot;return nt.length===0?ot=ct:ot=ct.replace(/\{(\d+)\}/g,(rt,ut)=>{const gt=ut[0],pt=nt[gt];let mt=rt;return typeof pt=="string"?mt=pt:(typeof pt=="number"||typeof pt=="boolean"||pt===void 0||pt===null)&&(mt=String(pt)),mt}),isPseudo&&(ot=""+ot.replace(/[aouei]/g,"$&$&")+""),ot}function localize(ct,nt,...ot){return _format$1(nt,ot)}function getConfiguredDefaultLocale(ct){}var _a$d;const LANGUAGE_DEFAULT="en";let _isWindows=!1,_isMacintosh=!1,_isLinux=!1,_isNative=!1,_isWeb=!1,_isIOS=!1,_isMobile=!1,_locale,_language=LANGUAGE_DEFAULT,_platformLocale=LANGUAGE_DEFAULT,_translationsConfigFile,_userAgent;const globals=typeof self=="object"?self:typeof global=="object"?global:{};let nodeProcess;typeof globals.vscode<"u"&&typeof globals.vscode.process<"u"?nodeProcess=globals.vscode.process:typeof process<"u"&&(nodeProcess=process);const isElectronProcess=typeof((_a$d=nodeProcess==null?void 0:nodeProcess.versions)===null||_a$d===void 0?void 0:_a$d.electron)=="string",isElectronRenderer=isElectronProcess&&(nodeProcess==null?void 0:nodeProcess.type)==="renderer";if(typeof navigator=="object"&&!isElectronRenderer)_userAgent=navigator.userAgent,_isWindows=_userAgent.indexOf("Windows")>=0,_isMacintosh=_userAgent.indexOf("Macintosh")>=0,_isIOS=(_userAgent.indexOf("Macintosh")>=0||_userAgent.indexOf("iPad")>=0||_userAgent.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,_isLinux=_userAgent.indexOf("Linux")>=0,_isMobile=(_userAgent==null?void 0:_userAgent.indexOf("Mobi"))>=0,_isWeb=!0,localize({key:"ensureLoaderPluginIsLoaded",comment:["{Locked}"]},"_"),_locale=LANGUAGE_DEFAULT,_language=_locale,_platformLocale=navigator.language;else if(typeof nodeProcess=="object"){_isWindows=nodeProcess.platform==="win32",_isMacintosh=nodeProcess.platform==="darwin",_isLinux=nodeProcess.platform==="linux",_isLinux&&nodeProcess.env.SNAP&&nodeProcess.env.SNAP_REVISION,nodeProcess.env.CI||nodeProcess.env.BUILD_ARTIFACTSTAGINGDIRECTORY,_locale=LANGUAGE_DEFAULT,_language=LANGUAGE_DEFAULT;const ct=nodeProcess.env.VSCODE_NLS_CONFIG;if(ct)try{const nt=JSON.parse(ct),ot=nt.availableLanguages["*"];_locale=nt.locale,_platformLocale=nt.osLocale,_language=ot||LANGUAGE_DEFAULT,_translationsConfigFile=nt._translationsConfigFile}catch{}_isNative=!0}else console.error("Unable to resolve platform.");const isWindows=_isWindows,isMacintosh=_isMacintosh,isLinux=_isLinux,isNative=_isNative,isWeb=_isWeb,isWebWorker=_isWeb&&typeof globals.importScripts=="function",isIOS=_isIOS,isMobile=_isMobile,userAgent$1=_userAgent,language=_language,setTimeout0IsFaster=typeof globals.postMessage=="function"&&!globals.importScripts,setTimeout0=(()=>{if(setTimeout0IsFaster){const ct=[];globals.addEventListener("message",ot=>{if(ot.data&&ot.data.vscodeScheduleAsyncWork)for(let rt=0,ut=ct.length;rt<ut;rt++){const gt=ct[rt];if(gt.id===ot.data.vscodeScheduleAsyncWork){ct.splice(rt,1),gt.callback();return}}});let nt=0;return ot=>{const rt=++nt;ct.push({id:rt,callback:ot}),globals.postMessage({vscodeScheduleAsyncWork:rt},"*")}}return ct=>setTimeout(ct)})(),OS=_isMacintosh||_isIOS?2:_isWindows?1:3;let _isLittleEndian=!0,_isLittleEndianComputed=!1;function isLittleEndian(){if(!_isLittleEndianComputed){_isLittleEndianComputed=!0;const ct=new Uint8Array(2);ct[0]=1,ct[1]=2,_isLittleEndian=new Uint16Array(ct.buffer)[0]===512+1}return _isLittleEndian}const isChrome$1=!!(userAgent$1&&userAgent$1.indexOf("Chrome")>=0),isFirefox$1=!!(userAgent$1&&userAgent$1.indexOf("Firefox")>=0),isSafari$1=!!(!isChrome$1&&userAgent$1&&userAgent$1.indexOf("Safari")>=0),isEdge=!!(userAgent$1&&userAgent$1.indexOf("Edg/")>=0);userAgent$1&&userAgent$1.indexOf("Android")>=0;var Iterable;(function(ct){function nt(Tt){return Tt&&typeof Tt=="object"&&typeof Tt[Symbol.iterator]=="function"}ct.is=nt;const ot=Object.freeze([]);function rt(){return ot}ct.empty=rt;function*ut(Tt){yield Tt}ct.single=ut;function gt(Tt){return nt(Tt)?Tt:ut(Tt)}ct.wrap=gt;function pt(Tt){return Tt||ot}ct.from=pt;function mt(Tt){return!Tt||Tt[Symbol.iterator]().next().done===!0}ct.isEmpty=mt;function vt(Tt){return Tt[Symbol.iterator]().next().value}ct.first=vt;function St(Tt,Rt){for(const Nt of Tt)if(Rt(Nt))return!0;return!1}ct.some=St;function yt(Tt,Rt){for(const Nt of Tt)if(Rt(Nt))return Nt}ct.find=yt;function*wt(Tt,Rt){for(const Nt of Tt)Rt(Nt)&&(yield Nt)}ct.filter=wt;function*Lt(Tt,Rt){let Nt=0;for(const Pt of Tt)yield Rt(Pt,Nt++)}ct.map=Lt;function*xt(...Tt){for(const Rt of Tt)for(const Nt of Rt)yield Nt}ct.concat=xt;function It(Tt,Rt,Nt){let Pt=Nt;for(const Ft of Tt)Pt=Rt(Pt,Ft);return Pt}ct.reduce=It;function*kt(Tt,Rt,Nt=Tt.length){for(Rt<0&&(Rt+=Tt.length),Nt<0?Nt+=Tt.length:Nt>Tt.length&&(Nt=Tt.length);Rt<Nt;Rt++)yield Tt[Rt]}ct.slice=kt;function At(Tt,Rt=Number.POSITIVE_INFINITY){const Nt=[];if(Rt===0)return[Nt,Tt];const Pt=Tt[Symbol.iterator]();for(let Ft=0;Ft<Rt;Ft++){const Kt=Pt.next();if(Kt.done)return[Nt,ct.empty()];Nt.push(Kt.value)}return[Nt,{[Symbol.iterator](){return Pt}}]}ct.consume=At})(Iterable||(Iterable={}));let Node$2=class Wo{constructor(nt){this.element=nt,this.next=Wo.Undefined,this.prev=Wo.Undefined}};Node$2.Undefined=new Node$2(void 0);class LinkedList{constructor(){this._first=Node$2.Undefined,this._last=Node$2.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Node$2.Undefined}clear(){let nt=this._first;for(;nt!==Node$2.Undefined;){const ot=nt.next;nt.prev=Node$2.Undefined,nt.next=Node$2.Undefined,nt=ot}this._first=Node$2.Undefined,this._last=Node$2.Undefined,this._size=0}unshift(nt){return this._insert(nt,!1)}push(nt){return this._insert(nt,!0)}_insert(nt,ot){const rt=new Node$2(nt);if(this._first===Node$2.Undefined)this._first=rt,this._last=rt;else if(ot){const gt=this._last;this._last=rt,rt.prev=gt,gt.next=rt}else{const gt=this._first;this._first=rt,rt.next=gt,gt.prev=rt}this._size+=1;let ut=!1;return()=>{ut||(ut=!0,this._remove(rt))}}shift(){if(this._first!==Node$2.Undefined){const nt=this._first.element;return this._remove(this._first),nt}}pop(){if(this._last!==Node$2.Undefined){const nt=this._last.element;return this._remove(this._last),nt}}_remove(nt){if(nt.prev!==Node$2.Undefined&&nt.next!==Node$2.Undefined){const ot=nt.prev;ot.next=nt.next,nt.next.prev=ot}else nt.prev===Node$2.Undefined&&nt.next===Node$2.Undefined?(this._first=Node$2.Undefined,this._last=Node$2.Undefined):nt.next===Node$2.Undefined?(this._last=this._last.prev,this._last.next=Node$2.Undefined):nt.prev===Node$2.Undefined&&(this._first=this._first.next,this._first.prev=Node$2.Undefined);this._size-=1}*[Symbol.iterator](){let nt=this._first;for(;nt!==Node$2.Undefined;)yield nt.element,nt=nt.next}}const USUAL_WORD_SEPARATORS="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function createWordRegExp(ct=""){let nt="(-?\\d*\\.\\d\\w*)|([^";for(const ot of USUAL_WORD_SEPARATORS)ct.indexOf(ot)>=0||(nt+="\\"+ot);return nt+="\\s]+)",new RegExp(nt,"g")}const DEFAULT_WORD_REGEXP=createWordRegExp();function ensureValidWordDefinition(ct){let nt=DEFAULT_WORD_REGEXP;if(ct&&ct instanceof RegExp)if(ct.global)nt=ct;else{let ot="g";ct.ignoreCase&&(ot+="i"),ct.multiline&&(ot+="m"),ct.unicode&&(ot+="u"),nt=new RegExp(ct.source,ot)}return nt.lastIndex=0,nt}const _defaultConfig=new LinkedList;_defaultConfig.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function getWordAtText(ct,nt,ot,rt,ut){if(ut||(ut=Iterable.first(_defaultConfig)),ot.length>ut.maxLen){let St=ct-ut.maxLen/2;return St<0?St=0:rt+=St,ot=ot.substring(St,ct+ut.maxLen/2),getWordAtText(ct,nt,ot,rt,ut)}const gt=Date.now(),pt=ct-1-rt;let mt=-1,vt=null;for(let St=1;!(Date.now()-gt>=ut.timeBudget);St++){const yt=pt-ut.windowSize*St;nt.lastIndex=Math.max(0,yt);const wt=_findRegexMatchEnclosingPosition(nt,ot,pt,mt);if(!wt&&vt||(vt=wt,yt<=0))break;mt=yt}if(vt){const St={word:vt[0],startColumn:rt+1+vt.index,endColumn:rt+1+vt.index+vt[0].length};return nt.lastIndex=0,St}return null}function _findRegexMatchEnclosingPosition(ct,nt,ot,rt){let ut;for(;ut=ct.exec(nt);){const gt=ut.index||0;if(gt<=ot&&ct.lastIndex>=ot)return ut;if(rt>0&&gt>rt)return null}return null}function tail(ct,nt=0){return ct[ct.length-(1+nt)]}function tail2(ct){if(ct.length===0)throw new Error("Invalid tail call");return[ct.slice(0,ct.length-1),ct[ct.length-1]]}function equals$2(ct,nt,ot=(rt,ut)=>rt===ut){if(ct===nt)return!0;if(!ct||!nt||ct.length!==nt.length)return!1;for(let rt=0,ut=ct.length;rt<ut;rt++)if(!ot(ct[rt],nt[rt]))return!1;return!0}function removeFastWithoutKeepingOrder(ct,nt){const ot=ct.length-1;nt<ot&&(ct[nt]=ct[ot]),ct.pop()}function binarySearch(ct,nt,ot){return binarySearch2(ct.length,rt=>ot(ct[rt],nt))}function binarySearch2(ct,nt){let ot=0,rt=ct-1;for(;ot<=rt;){const ut=(ot+rt)/2|0,gt=nt(ut);if(gt<0)ot=ut+1;else if(gt>0)rt=ut-1;else return ut}return-(ot+1)}function findFirstInSorted(ct,nt){let ot=0,rt=ct.length;if(rt===0)return 0;for(;ot<rt;){const ut=Math.floor((ot+rt)/2);nt(ct[ut])?rt=ut:ot=ut+1}return ot}function quickSelect(ct,nt,ot){if(ct=ct|0,ct>=nt.length)throw new TypeError("invalid index");const rt=nt[Math.floor(nt.length*Math.random())],ut=[],gt=[],pt=[];for(const mt of nt){const vt=ot(mt,rt);vt<0?ut.push(mt):vt>0?gt.push(mt):pt.push(mt)}return ct<ut.length?quickSelect(ct,ut,ot):ct<ut.length+pt.length?pt[0]:quickSelect(ct-(ut.length+pt.length),gt,ot)}function groupBy(ct,nt){const ot=[];let rt;for(const ut of ct.slice(0).sort(nt))!rt||nt(rt[0],ut)!==0?(rt=[ut],ot.push(rt)):rt.push(ut);return ot}function coalesce(ct){return ct.filter(nt=>!!nt)}function coalesceInPlace(ct){let nt=0;for(let ot=0;ot<ct.length;ot++)ct[ot]&&(ct[nt]=ct[ot],nt+=1);ct.length=nt}function isFalsyOrEmpty(ct){return!Array.isArray(ct)||ct.length===0}function isNonEmptyArray(ct){return Array.isArray(ct)&&ct.length>0}function distinct(ct,nt=ot=>ot){const ot=new Set;return ct.filter(rt=>{const ut=nt(rt);return ot.has(ut)?!1:(ot.add(ut),!0)})}function findLast(ct,nt){const ot=lastIndex(ct,nt);if(ot!==-1)return ct[ot]}function lastIndex(ct,nt){for(let ot=ct.length-1;ot>=0;ot--){const rt=ct[ot];if(nt(rt))return ot}return-1}function firstOrDefault(ct,nt){return ct.length>0?ct[0]:nt}function range(ct,nt){let ot=typeof nt=="number"?ct:0;typeof nt=="number"?ot=ct:(ot=0,nt=ct);const rt=[];if(ot<=nt)for(let ut=ot;ut<nt;ut++)rt.push(ut);else for(let ut=ot;ut>nt;ut--)rt.push(ut);return rt}function arrayInsert(ct,nt,ot){const rt=ct.slice(0,nt),ut=ct.slice(nt);return rt.concat(ot,ut)}function pushToStart(ct,nt){const ot=ct.indexOf(nt);ot>-1&&(ct.splice(ot,1),ct.unshift(nt))}function pushToEnd(ct,nt){const ot=ct.indexOf(nt);ot>-1&&(ct.splice(ot,1),ct.push(nt))}function pushMany(ct,nt){for(const ot of nt)ct.push(ot)}function asArray(ct){return Array.isArray(ct)?ct:[ct]}function mapFind(ct,nt){for(const ot of ct){const rt=nt(ot);if(rt!==void 0)return rt}}function insertInto(ct,nt,ot){const rt=getActualStartIndex(ct,nt),ut=ct.length,gt=ot.length;ct.length=ut+gt;for(let pt=ut-1;pt>=rt;pt--)ct[pt+gt]=ct[pt];for(let pt=0;pt<gt;pt++)ct[pt+rt]=ot[pt]}function splice$1(ct,nt,ot,rt){const ut=getActualStartIndex(ct,nt),gt=ct.splice(ut,ot);return insertInto(ct,ut,rt),gt}function getActualStartIndex(ct,nt){return nt<0?Math.max(nt+ct.length,0):Math.min(nt,ct.length)}var CompareResult;(function(ct){function nt(ut){return ut<0}ct.isLessThan=nt;function ot(ut){return ut>0}ct.isGreaterThan=ot;function rt(ut){return ut===0}ct.isNeitherLessOrGreaterThan=rt,ct.greaterThan=1,ct.lessThan=-1,ct.neitherLessOrGreaterThan=0})(CompareResult||(CompareResult={}));function compareBy(ct,nt){return(ot,rt)=>nt(ct(ot),ct(rt))}const numberComparator=(ct,nt)=>ct-nt;function findMaxBy(ct,nt){if(ct.length===0)return;let ot=ct[0];for(let rt=1;rt<ct.length;rt++){const ut=ct[rt];nt(ut,ot)>0&&(ot=ut)}return ot}function findLastMaxBy(ct,nt){if(ct.length===0)return;let ot=ct[0];for(let rt=1;rt<ct.length;rt++){const ut=ct[rt];nt(ut,ot)>=0&&(ot=ut)}return ot}function findMinBy(ct,nt){return findMaxBy(ct,(ot,rt)=>-nt(ot,rt))}class ArrayQueue{constructor(nt){this.items=nt,this.firstIdx=0,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(nt){let ot=this.firstIdx;for(;ot<this.items.length&&nt(this.items[ot]);)ot++;const rt=ot===this.firstIdx?null:this.items.slice(this.firstIdx,ot);return this.firstIdx=ot,rt}takeFromEndWhile(nt){let ot=this.lastIdx;for(;ot>=0&&nt(this.items[ot]);)ot--;const rt=ot===this.lastIdx?null:this.items.slice(ot+1,this.lastIdx+1);return this.lastIdx=ot,rt}peek(){if(this.length!==0)return this.items[this.firstIdx]}dequeue(){const nt=this.items[this.firstIdx];return this.firstIdx++,nt}takeCount(nt){const ot=this.items.slice(this.firstIdx,this.firstIdx+nt);return this.firstIdx+=nt,ot}}class CallbackIterable{constructor(nt){this.iterate=nt}toArray(){const nt=[];return this.iterate(ot=>(nt.push(ot),!0)),nt}filter(nt){return new CallbackIterable(ot=>this.iterate(rt=>nt(rt)?ot(rt):!0))}map(nt){return new CallbackIterable(ot=>this.iterate(rt=>ot(nt(rt))))}findLast(nt){let ot;return this.iterate(rt=>(nt(rt)&&(ot=rt),!0)),ot}findLastMaxBy(nt){let ot,rt=!0;return this.iterate(ut=>((rt||CompareResult.isGreaterThan(nt(ut,ot)))&&(rt=!1,ot=ut),!0)),ot}}CallbackIterable.empty=new CallbackIterable(ct=>{});function isString$1(ct){return typeof ct=="string"}function isObject$1(ct){return typeof ct=="object"&&ct!==null&&!Array.isArray(ct)&&!(ct instanceof RegExp)&&!(ct instanceof Date)}function isTypedArray(ct){const nt=Object.getPrototypeOf(Uint8Array);return typeof ct=="object"&&ct instanceof nt}function isNumber$1(ct){return typeof ct=="number"&&!isNaN(ct)}function isIterable(ct){return!!ct&&typeof ct[Symbol.iterator]=="function"}function isBoolean(ct){return ct===!0||ct===!1}function isUndefined(ct){return typeof ct>"u"}function isDefined(ct){return!isUndefinedOrNull(ct)}function isUndefinedOrNull(ct){return isUndefined(ct)||ct===null}function assertType(ct,nt){if(!ct)throw new Error(nt?`Unexpected type, expected '${nt}'`:"Unexpected type")}function assertIsDefined(ct){if(isUndefinedOrNull(ct))throw new Error("Assertion Failed: argument is undefined or null");return ct}function isFunction(ct){return typeof ct=="function"}function validateConstraints(ct,nt){const ot=Math.min(ct.length,nt.length);for(let rt=0;rt<ot;rt++)validateConstraint(ct[rt],nt[rt])}function validateConstraint(ct,nt){if(isString$1(nt)){if(typeof ct!==nt)throw new Error(`argument does not match constraint: typeof ${nt}`)}else if(isFunction(nt)){try{if(ct instanceof nt)return}catch{}if(!isUndefinedOrNull(ct)&&ct.constructor===nt||nt.length===1&&nt.call(void 0,ct)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function withNullAsUndefined(ct){return ct===null?void 0:ct}function withUndefinedAsNull(ct){return typeof ct>"u"?null:ct}function deepClone(ct){if(!ct||typeof ct!="object"||ct instanceof RegExp)return ct;const nt=Array.isArray(ct)?[]:{};return Object.entries(ct).forEach(([ot,rt])=>{nt[ot]=rt&&typeof rt=="object"?deepClone(rt):rt}),nt}function deepFreeze(ct){if(!ct||typeof ct!="object")return ct;const nt=[ct];for(;nt.length>0;){const ot=nt.shift();Object.freeze(ot);for(const rt in ot)if(_hasOwnProperty.call(ot,rt)){const ut=ot[rt];typeof ut=="object"&&!Object.isFrozen(ut)&&!isTypedArray(ut)&&nt.push(ut)}}return ct}const _hasOwnProperty=Object.prototype.hasOwnProperty;function cloneAndChange(ct,nt){return _cloneAndChange(ct,nt,new Set)}function _cloneAndChange(ct,nt,ot){if(isUndefinedOrNull(ct))return ct;const rt=nt(ct);if(typeof rt<"u")return rt;if(Array.isArray(ct)){const ut=[];for(const gt of ct)ut.push(_cloneAndChange(gt,nt,ot));return ut}if(isObject$1(ct)){if(ot.has(ct))throw new Error("Cannot clone recursive data-structure");ot.add(ct);const ut={};for(const gt in ct)_hasOwnProperty.call(ct,gt)&&(ut[gt]=_cloneAndChange(ct[gt],nt,ot));return ot.delete(ct),ut}return ct}function mixin$1(ct,nt,ot=!0){return isObject$1(ct)?(isObject$1(nt)&&Object.keys(nt).forEach(rt=>{rt in ct?ot&&(isObject$1(ct[rt])&&isObject$1(nt[rt])?mixin$1(ct[rt],nt[rt],ot):ct[rt]=nt[rt]):ct[rt]=nt[rt]}),ct):nt}function equals$1(ct,nt){if(ct===nt)return!0;if(ct==null||nt===null||nt===void 0||typeof ct!=typeof nt||typeof ct!="object"||Array.isArray(ct)!==Array.isArray(nt))return!1;let ot,rt;if(Array.isArray(ct)){if(ct.length!==nt.length)return!1;for(ot=0;ot<ct.length;ot++)if(!equals$1(ct[ot],nt[ot]))return!1}else{const ut=[];for(rt in ct)ut.push(rt);ut.sort();const gt=[];for(rt in nt)gt.push(rt);if(gt.sort(),!equals$1(ut,gt))return!1;for(ot=0;ot<ut.length;ot++)if(!equals$1(ct[ut[ot]],nt[ut[ot]]))return!1}return!0}function getAllPropertyNames(ct){let nt=[],ot=Object.getPrototypeOf(ct);for(;Object.prototype!==ot;)nt=nt.concat(Object.getOwnPropertyNames(ot)),ot=Object.getPrototypeOf(ot);return nt}function getAllMethodNames(ct){const nt=[];for(const ot of getAllPropertyNames(ct))typeof ct[ot]=="function"&&nt.push(ot);return nt}function createProxyObject$1(ct,nt){const ot=ut=>function(){const gt=Array.prototype.slice.call(arguments,0);return nt(ut,gt)},rt={};for(const ut of ct)rt[ut]=ot(ut);return rt}const EDITOR_MODEL_DEFAULTS={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},MINIMAP_GUTTER_WIDTH=8;class ConfigurationChangedEvent{constructor(nt){this._values=nt}hasChanged(nt){return this._values[nt]}}class ComputeOptionsMemory{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class BaseEditorOption{constructor(nt,ot,rt,ut){this.id=nt,this.name=ot,this.defaultValue=rt,this.schema=ut}applyUpdate(nt,ot){return applyUpdate(nt,ot)}compute(nt,ot,rt){return rt}}class ApplyUpdateResult{constructor(nt,ot){this.newValue=nt,this.didChange=ot}}function applyUpdate(ct,nt){if(typeof ct!="object"||typeof nt!="object"||!ct||!nt)return new ApplyUpdateResult(nt,ct!==nt);if(Array.isArray(ct)||Array.isArray(nt)){const rt=Array.isArray(ct)&&Array.isArray(nt)&&equals$2(ct,nt);return new ApplyUpdateResult(nt,!rt)}let ot=!1;for(const rt in nt)if(nt.hasOwnProperty(rt)){const ut=applyUpdate(ct[rt],nt[rt]);ut.didChange&&(ct[rt]=ut.newValue,ot=!0)}return new ApplyUpdateResult(ct,ot)}class ComputedEditorOption{constructor(nt){this.schema=void 0,this.id=nt,this.name="_never_",this.defaultValue=void 0}applyUpdate(nt,ot){return applyUpdate(nt,ot)}validate(nt){return this.defaultValue}}class SimpleEditorOption{constructor(nt,ot,rt,ut){this.id=nt,this.name=ot,this.defaultValue=rt,this.schema=ut}applyUpdate(nt,ot){return applyUpdate(nt,ot)}validate(nt){return typeof nt>"u"?this.defaultValue:nt}compute(nt,ot,rt){return rt}}function boolean(ct,nt){return typeof ct>"u"?nt:ct==="false"?!1:!!ct}class EditorBooleanOption extends SimpleEditorOption{constructor(nt,ot,rt,ut=void 0){typeof ut<"u"&&(ut.type="boolean",ut.default=rt),super(nt,ot,rt,ut)}validate(nt){return boolean(nt,this.defaultValue)}}function clampedInt(ct,nt,ot,rt){if(typeof ct>"u")return nt;let ut=parseInt(ct,10);return isNaN(ut)?nt:(ut=Math.max(ot,ut),ut=Math.min(rt,ut),ut|0)}class EditorIntOption extends SimpleEditorOption{static clampedInt(nt,ot,rt,ut){return clampedInt(nt,ot,rt,ut)}constructor(nt,ot,rt,ut,gt,pt=void 0){typeof pt<"u"&&(pt.type="integer",pt.default=rt,pt.minimum=ut,pt.maximum=gt),super(nt,ot,rt,pt),this.minimum=ut,this.maximum=gt}validate(nt){return EditorIntOption.clampedInt(nt,this.defaultValue,this.minimum,this.maximum)}}function clampedFloat(ct,nt,ot,rt){if(typeof ct>"u")return nt;const ut=EditorFloatOption.float(ct,nt);return EditorFloatOption.clamp(ut,ot,rt)}class EditorFloatOption extends SimpleEditorOption{static clamp(nt,ot,rt){return nt<ot?ot:nt>rt?rt:nt}static float(nt,ot){if(typeof nt=="number")return nt;if(typeof nt>"u")return ot;const rt=parseFloat(nt);return isNaN(rt)?ot:rt}constructor(nt,ot,rt,ut,gt){typeof gt<"u"&&(gt.type="number",gt.default=rt),super(nt,ot,rt,gt),this.validationFn=ut}validate(nt){return this.validationFn(EditorFloatOption.float(nt,this.defaultValue))}}class EditorStringOption extends SimpleEditorOption{static string(nt,ot){return typeof nt!="string"?ot:nt}constructor(nt,ot,rt,ut=void 0){typeof ut<"u"&&(ut.type="string",ut.default=rt),super(nt,ot,rt,ut)}validate(nt){return EditorStringOption.string(nt,this.defaultValue)}}function stringSet(ct,nt,ot,rt){return typeof ct!="string"?nt:rt&&ct in rt?rt[ct]:ot.indexOf(ct)===-1?nt:ct}class EditorStringEnumOption extends SimpleEditorOption{constructor(nt,ot,rt,ut,gt=void 0){typeof gt<"u"&&(gt.type="string",gt.enum=ut,gt.default=rt),super(nt,ot,rt,gt),this._allowedValues=ut}validate(nt){return stringSet(nt,this.defaultValue,this._allowedValues)}}class EditorEnumOption extends BaseEditorOption{constructor(nt,ot,rt,ut,gt,pt,mt=void 0){typeof mt<"u"&&(mt.type="string",mt.enum=gt,mt.default=ut),super(nt,ot,rt,mt),this._allowedValues=gt,this._convert=pt}validate(nt){return typeof nt!="string"?this.defaultValue:this._allowedValues.indexOf(nt)===-1?this.defaultValue:this._convert(nt)}}function _autoIndentFromString(ct){switch(ct){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class EditorAccessibilitySupport extends BaseEditorOption{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[localize("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached"),localize("accessibilitySupport.on","Optimize for usage with a Screen Reader"),localize("accessibilitySupport.off","Assume a screen reader is not attached")],default:"auto",tags:["accessibility"],description:localize("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(nt){switch(nt){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(nt,ot,rt){return rt===0?nt.accessibilitySupport:rt}}class EditorComments extends BaseEditorOption{constructor(){const nt={insertSpace:!0,ignoreEmptyLines:!0};super(21,"comments",nt,{"editor.comments.insertSpace":{type:"boolean",default:nt.insertSpace,description:localize("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:nt.ignoreEmptyLines,description:localize("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{insertSpace:boolean(ot.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:boolean(ot.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function _cursorBlinkingStyleFromString(ct){switch(ct){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var TextEditorCursorStyle$1;(function(ct){ct[ct.Line=1]="Line",ct[ct.Block=2]="Block",ct[ct.Underline=3]="Underline",ct[ct.LineThin=4]="LineThin",ct[ct.BlockOutline=5]="BlockOutline",ct[ct.UnderlineThin=6]="UnderlineThin"})(TextEditorCursorStyle$1||(TextEditorCursorStyle$1={}));function _cursorStyleFromString(ct){switch(ct){case"line":return TextEditorCursorStyle$1.Line;case"block":return TextEditorCursorStyle$1.Block;case"underline":return TextEditorCursorStyle$1.Underline;case"line-thin":return TextEditorCursorStyle$1.LineThin;case"block-outline":return TextEditorCursorStyle$1.BlockOutline;case"underline-thin":return TextEditorCursorStyle$1.UnderlineThin}}class EditorClassName extends ComputedEditorOption{constructor(){super(136)}compute(nt,ot,rt){const ut=["monaco-editor"];return ot.get(37)&&ut.push(ot.get(37)),nt.extraEditorClassName&&ut.push(nt.extraEditorClassName),ot.get(71)==="default"?ut.push("mouse-default"):ot.get(71)==="copy"&&ut.push("mouse-copy"),ot.get(106)&&ut.push("showUnused"),ot.get(134)&&ut.push("showDeprecated"),ut.join(" ")}}class EditorEmptySelectionClipboard extends EditorBooleanOption{constructor(){super(35,"emptySelectionClipboard",!0,{description:localize("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(nt,ot,rt){return rt&&nt.emptySelectionClipboard}}class EditorFind extends BaseEditorOption{constructor(){const nt={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(39,"find",nt,{"editor.find.cursorMoveOnType":{type:"boolean",default:nt.cursorMoveOnType,description:localize("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:nt.seedSearchStringFromSelection,enumDescriptions:[localize("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),localize("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),localize("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:localize("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:nt.autoFindInSelection,enumDescriptions:[localize("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),localize("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),localize("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:localize("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:nt.globalFindClipboard,description:localize("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:isMacintosh},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:nt.addExtraSpaceOnTop,description:localize("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:nt.loop,description:localize("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{cursorMoveOnType:boolean(ot.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof nt.seedSearchStringFromSelection=="boolean"?nt.seedSearchStringFromSelection?"always":"never":stringSet(ot.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof nt.autoFindInSelection=="boolean"?nt.autoFindInSelection?"always":"never":stringSet(ot.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:boolean(ot.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:boolean(ot.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:boolean(ot.loop,this.defaultValue.loop)}}}class EditorFontLigatures extends BaseEditorOption{constructor(){super(49,"fontLigatures",EditorFontLigatures.OFF,{anyOf:[{type:"boolean",description:localize("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:localize("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:localize("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(nt){return typeof nt>"u"?this.defaultValue:typeof nt=="string"?nt==="false"?EditorFontLigatures.OFF:nt==="true"?EditorFontLigatures.ON:nt:nt?EditorFontLigatures.ON:EditorFontLigatures.OFF}}EditorFontLigatures.OFF='"liga" off, "calt" off';EditorFontLigatures.ON='"liga" on, "calt" on';class EditorFontVariations extends BaseEditorOption{constructor(){super(52,"fontVariations",EditorFontVariations.OFF,{anyOf:[{type:"boolean",description:localize("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:localize("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:localize("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(nt){return typeof nt>"u"?this.defaultValue:typeof nt=="string"?nt==="false"?EditorFontVariations.OFF:nt==="true"?EditorFontVariations.TRANSLATE:nt:nt?EditorFontVariations.TRANSLATE:EditorFontVariations.OFF}compute(nt,ot,rt){return nt.fontInfo.fontVariationSettings}}EditorFontVariations.OFF="normal";EditorFontVariations.TRANSLATE="translate";class EditorFontInfo extends ComputedEditorOption{constructor(){super(48)}compute(nt,ot,rt){return nt.fontInfo}}class EditorFontSize extends SimpleEditorOption{constructor(){super(50,"fontSize",EDITOR_FONT_DEFAULTS.fontSize,{type:"number",minimum:6,maximum:100,default:EDITOR_FONT_DEFAULTS.fontSize,description:localize("fontSize","Controls the font size in pixels.")})}validate(nt){const ot=EditorFloatOption.float(nt,this.defaultValue);return ot===0?EDITOR_FONT_DEFAULTS.fontSize:EditorFloatOption.clamp(ot,6,100)}compute(nt,ot,rt){return nt.fontInfo.fontSize}}class EditorFontWeight extends BaseEditorOption{constructor(){super(51,"fontWeight",EDITOR_FONT_DEFAULTS.fontWeight,{anyOf:[{type:"number",minimum:EditorFontWeight.MINIMUM_VALUE,maximum:EditorFontWeight.MAXIMUM_VALUE,errorMessage:localize("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:EditorFontWeight.SUGGESTION_VALUES}],default:EDITOR_FONT_DEFAULTS.fontWeight,description:localize("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(nt){return nt==="normal"||nt==="bold"?nt:String(EditorIntOption.clampedInt(nt,EDITOR_FONT_DEFAULTS.fontWeight,EditorFontWeight.MINIMUM_VALUE,EditorFontWeight.MAXIMUM_VALUE))}}EditorFontWeight.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];EditorFontWeight.MINIMUM_VALUE=1;EditorFontWeight.MAXIMUM_VALUE=1e3;class EditorGoToLocation extends BaseEditorOption{constructor(){const nt={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:""},ot={type:"string",enum:["peek","gotoAndPeek","goto"],default:nt.multiple,enumDescriptions:[localize("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),localize("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),localize("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},rt=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(56,"gotoLocation",nt,{"editor.gotoLocation.multiple":{deprecationMessage:localize("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":Object.assign({description:localize("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist.")},ot),"editor.gotoLocation.multipleTypeDefinitions":Object.assign({description:localize("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist.")},ot),"editor.gotoLocation.multipleDeclarations":Object.assign({description:localize("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist.")},ot),"editor.gotoLocation.multipleImplementations":Object.assign({description:localize("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist.")},ot),"editor.gotoLocation.multipleReferences":Object.assign({description:localize("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist.")},ot),"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:nt.alternativeDefinitionCommand,enum:rt,description:localize("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:nt.alternativeTypeDefinitionCommand,enum:rt,description:localize("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:nt.alternativeDeclarationCommand,enum:rt,description:localize("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:nt.alternativeImplementationCommand,enum:rt,description:localize("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:nt.alternativeReferenceCommand,enum:rt,description:localize("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(nt){var ot,rt,ut,gt,pt;if(!nt||typeof nt!="object")return this.defaultValue;const mt=nt;return{multiple:stringSet(mt.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:(ot=mt.multipleDefinitions)!==null&&ot!==void 0?ot:stringSet(mt.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:(rt=mt.multipleTypeDefinitions)!==null&&rt!==void 0?rt:stringSet(mt.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:(ut=mt.multipleDeclarations)!==null&&ut!==void 0?ut:stringSet(mt.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:(gt=mt.multipleImplementations)!==null&&gt!==void 0?gt:stringSet(mt.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:(pt=mt.multipleReferences)!==null&&pt!==void 0?pt:stringSet(mt.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:EditorStringOption.string(mt.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:EditorStringOption.string(mt.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:EditorStringOption.string(mt.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:EditorStringOption.string(mt.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:EditorStringOption.string(mt.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand)}}}class EditorHover extends BaseEditorOption{constructor(){const nt={enabled:!0,delay:300,sticky:!0,above:!0};super(58,"hover",nt,{"editor.hover.enabled":{type:"boolean",default:nt.enabled,description:localize("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:nt.delay,minimum:0,maximum:1e4,description:localize("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:nt.sticky,description:localize("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.above":{type:"boolean",default:nt.above,description:localize("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{enabled:boolean(ot.enabled,this.defaultValue.enabled),delay:EditorIntOption.clampedInt(ot.delay,this.defaultValue.delay,0,1e4),sticky:boolean(ot.sticky,this.defaultValue.sticky),above:boolean(ot.above,this.defaultValue.above)}}}class EditorLayoutInfoComputer extends ComputedEditorOption{constructor(){super(139)}compute(nt,ot,rt){return EditorLayoutInfoComputer.computeLayout(ot,{memory:nt.memory,outerWidth:nt.outerWidth,outerHeight:nt.outerHeight,isDominatedByLongLines:nt.isDominatedByLongLines,lineHeight:nt.fontInfo.lineHeight,viewLineCount:nt.viewLineCount,lineNumbersDigitCount:nt.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:nt.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:nt.fontInfo.maxDigitWidth,pixelRatio:nt.pixelRatio,glyphMarginDecorationLaneCount:nt.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(nt){const ot=nt.height/nt.lineHeight,rt=Math.floor(nt.paddingTop/nt.lineHeight);let ut=Math.floor(nt.paddingBottom/nt.lineHeight);nt.scrollBeyondLastLine&&(ut=Math.max(ut,ot-1));const gt=(rt+nt.viewLineCount+ut)/(nt.pixelRatio*nt.height),pt=Math.floor(nt.viewLineCount/gt);return{typicalViewportLineCount:ot,extraLinesBeforeFirstLine:rt,extraLinesBeyondLastLine:ut,desiredRatio:gt,minimapLineCount:pt}}static _computeMinimapLayout(nt,ot){const rt=nt.outerWidth,ut=nt.outerHeight,gt=nt.pixelRatio;if(!nt.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(gt*ut),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:ut};const pt=ot.stableMinimapLayoutInput,mt=pt&&nt.outerHeight===pt.outerHeight&&nt.lineHeight===pt.lineHeight&&nt.typicalHalfwidthCharacterWidth===pt.typicalHalfwidthCharacterWidth&&nt.pixelRatio===pt.pixelRatio&&nt.scrollBeyondLastLine===pt.scrollBeyondLastLine&&nt.paddingTop===pt.paddingTop&&nt.paddingBottom===pt.paddingBottom&&nt.minimap.enabled===pt.minimap.enabled&&nt.minimap.side===pt.minimap.side&&nt.minimap.size===pt.minimap.size&&nt.minimap.showSlider===pt.minimap.showSlider&&nt.minimap.renderCharacters===pt.minimap.renderCharacters&&nt.minimap.maxColumn===pt.minimap.maxColumn&&nt.minimap.scale===pt.minimap.scale&&nt.verticalScrollbarWidth===pt.verticalScrollbarWidth&&nt.isViewportWrapping===pt.isViewportWrapping,vt=nt.lineHeight,St=nt.typicalHalfwidthCharacterWidth,yt=nt.scrollBeyondLastLine,wt=nt.minimap.renderCharacters;let Lt=gt>=2?Math.round(nt.minimap.scale*2):nt.minimap.scale;const xt=nt.minimap.maxColumn,It=nt.minimap.size,kt=nt.minimap.side,At=nt.verticalScrollbarWidth,Tt=nt.viewLineCount,Rt=nt.remainingWidth,Nt=nt.isViewportWrapping,Pt=wt?2:3;let Ft=Math.floor(gt*ut);const Kt=Ft/gt;let Bt=!1,Ut=!1,qt=Pt*Lt,Yt=Lt/gt,Zt=1;if(It==="fill"||It==="fit"){const{typicalViewportLineCount:un,extraLinesBeforeFirstLine:an,extraLinesBeyondLastLine:Cn,desiredRatio:_n,minimapLineCount:hn}=EditorLayoutInfoComputer.computeContainedMinimapLineCount({viewLineCount:Tt,scrollBeyondLastLine:yt,paddingTop:nt.paddingTop,paddingBottom:nt.paddingBottom,height:ut,lineHeight:vt,pixelRatio:gt});if(Tt/hn>1)Bt=!0,Ut=!0,Lt=1,qt=1,Yt=Lt/gt;else{let yn=!1,Mn=Lt+1;if(It==="fit"){const Nn=Math.ceil((an+Tt+Cn)*qt);Nt&&mt&&Rt<=ot.stableFitRemainingWidth?(yn=!0,Mn=ot.stableFitMaxMinimapScale):yn=Nn>Ft}if(It==="fill"||yn){Bt=!0;const Nn=Lt;qt=Math.min(vt*gt,Math.max(1,Math.floor(1/_n))),Nt&&mt&&Rt<=ot.stableFitRemainingWidth&&(Mn=ot.stableFitMaxMinimapScale),Lt=Math.min(Mn,Math.max(1,Math.floor(qt/Pt))),Lt>Nn&&(Zt=Math.min(2,Lt/Nn)),Yt=Lt/gt/Zt,Ft=Math.ceil(Math.max(un,an+Tt+Cn)*qt),Nt?(ot.stableMinimapLayoutInput=nt,ot.stableFitRemainingWidth=Rt,ot.stableFitMaxMinimapScale=Lt):(ot.stableMinimapLayoutInput=null,ot.stableFitRemainingWidth=0)}}}const Xt=Math.floor(xt*Yt),_i=Math.min(Xt,Math.max(0,Math.floor((Rt-At-2)*Yt/(St+Yt)))+MINIMAP_GUTTER_WIDTH);let nn=Math.floor(gt*_i);const rn=nn/gt;nn=Math.floor(nn*Zt);const dn=wt?1:2,bn=kt==="left"?0:rt-_i-At;return{renderMinimap:dn,minimapLeft:bn,minimapWidth:_i,minimapHeightIsEditorHeight:Bt,minimapIsSampling:Ut,minimapScale:Lt,minimapLineHeight:qt,minimapCanvasInnerWidth:nn,minimapCanvasInnerHeight:Ft,minimapCanvasOuterWidth:rn,minimapCanvasOuterHeight:Kt}}static computeLayout(nt,ot){const rt=ot.outerWidth|0,ut=ot.outerHeight|0,gt=ot.lineHeight|0,pt=ot.lineNumbersDigitCount|0,mt=ot.typicalHalfwidthCharacterWidth,vt=ot.maxDigitWidth,St=ot.pixelRatio,yt=ot.viewLineCount,wt=nt.get(131),Lt=wt==="inherit"?nt.get(130):wt,xt=Lt==="inherit"?nt.get(126):Lt,It=nt.get(129),kt=ot.isDominatedByLongLines,At=nt.get(55),Tt=nt.get(65).renderType!==0,Rt=nt.get(66),Nt=nt.get(100),Pt=nt.get(81),Ft=nt.get(70),Kt=nt.get(98),Bt=Kt.verticalScrollbarSize,Ut=Kt.verticalHasArrows,qt=Kt.arrowSize,Yt=Kt.horizontalScrollbarSize,Zt=nt.get(41),Xt=nt.get(105)!=="never";let _i=nt.get(63);Zt&&Xt&&(_i+=16);let nn=0;if(Tt){const Jn=Math.max(pt,Rt);nn=Math.round(Jn*vt)}let rn=0;At&&(rn=gt*ot.glyphMarginDecorationLaneCount);let dn=0,bn=dn+rn,un=bn+nn,an=un+_i;const Cn=rt-rn-nn-_i;let _n=!1,hn=!1,pn=-1;Lt==="inherit"&&kt?(_n=!0,hn=!0):xt==="on"||xt==="bounded"?hn=!0:xt==="wordWrapColumn"&&(pn=It);const yn=EditorLayoutInfoComputer._computeMinimapLayout({outerWidth:rt,outerHeight:ut,lineHeight:gt,typicalHalfwidthCharacterWidth:mt,pixelRatio:St,scrollBeyondLastLine:Nt,paddingTop:Pt.top,paddingBottom:Pt.bottom,minimap:Ft,verticalScrollbarWidth:Bt,viewLineCount:yt,remainingWidth:Cn,isViewportWrapping:hn},ot.memory||new ComputeOptionsMemory);yn.renderMinimap!==0&&yn.minimapLeft===0&&(dn+=yn.minimapWidth,bn+=yn.minimapWidth,un+=yn.minimapWidth,an+=yn.minimapWidth);const Mn=Cn-yn.minimapWidth,Nn=Math.max(1,Math.floor((Mn-Bt-2)/mt)),Wn=Ut?qt:0;return hn&&(pn=Math.max(1,Nn),xt==="bounded"&&(pn=Math.min(pn,It))),{width:rt,height:ut,glyphMarginLeft:dn,glyphMarginWidth:rn,glyphMarginDecorationLaneCount:ot.glyphMarginDecorationLaneCount,lineNumbersLeft:bn,lineNumbersWidth:nn,decorationsLeft:un,decorationsWidth:_i,contentLeft:an,contentWidth:Mn,minimap:yn,viewportColumn:Nn,isWordWrapMinified:_n,isViewportWrapping:hn,wrappingColumn:pn,verticalScrollbarWidth:Bt,horizontalScrollbarHeight:Yt,overviewRuler:{top:Wn,width:Bt,height:ut-2*Wn,right:0}}}}class WrappingStrategy extends BaseEditorOption{constructor(){super(133,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[localize("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),localize("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:localize("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(nt){return stringSet(nt,"simple",["simple","advanced"])}compute(nt,ot,rt){return ot.get(2)===2?"advanced":rt}}class EditorLightbulb extends BaseEditorOption{constructor(){const nt={enabled:!0};super(62,"lightbulb",nt,{"editor.lightbulb.enabled":{type:"boolean",default:nt.enabled,description:localize("codeActions","Enables the Code Action lightbulb in the editor.")}})}validate(nt){return!nt||typeof nt!="object"?this.defaultValue:{enabled:boolean(nt.enabled,this.defaultValue.enabled)}}}class EditorStickyScroll extends BaseEditorOption{constructor(){const nt={enabled:!1,maxLineCount:5,defaultModel:"outlineModel"};super(110,"stickyScroll",nt,{"editor.stickyScroll.enabled":{type:"boolean",default:nt.enabled,description:localize("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor.")},"editor.stickyScroll.maxLineCount":{type:"number",default:nt.maxLineCount,minimum:1,maximum:10,description:localize("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:nt.defaultModel,description:localize("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{enabled:boolean(ot.enabled,this.defaultValue.enabled),maxLineCount:EditorIntOption.clampedInt(ot.maxLineCount,this.defaultValue.maxLineCount,1,10),defaultModel:stringSet(ot.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"])}}}class EditorInlayHints extends BaseEditorOption{constructor(){const nt={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(135,"inlayHints",nt,{"editor.inlayHints.enabled":{type:"string",default:nt.enabled,description:localize("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[localize("editor.inlayHints.on","Inlay hints are enabled"),localize("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",isMacintosh?"Ctrl+Option":"Ctrl+Alt"),localize("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",isMacintosh?"Ctrl+Option":"Ctrl+Alt"),localize("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:nt.fontSize,markdownDescription:localize("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:nt.fontFamily,markdownDescription:localize("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:nt.padding,description:localize("inlayHints.padding","Enables the padding around the inlay hints in the editor.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return typeof ot.enabled=="boolean"&&(ot.enabled=ot.enabled?"on":"off"),{enabled:stringSet(ot.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:EditorIntOption.clampedInt(ot.fontSize,this.defaultValue.fontSize,0,100),fontFamily:EditorStringOption.string(ot.fontFamily,this.defaultValue.fontFamily),padding:boolean(ot.padding,this.defaultValue.padding)}}}class EditorLineDecorationsWidth extends BaseEditorOption{constructor(){super(63,"lineDecorationsWidth",10)}validate(nt){return typeof nt=="string"&&/^\d+(\.\d+)?ch$/.test(nt)?-parseFloat(nt.substring(0,nt.length-2)):EditorIntOption.clampedInt(nt,this.defaultValue,0,1e3)}compute(nt,ot,rt){return rt<0?EditorIntOption.clampedInt(-rt*nt.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):rt}}class EditorLineHeight extends EditorFloatOption{constructor(){super(64,"lineHeight",EDITOR_FONT_DEFAULTS.lineHeight,nt=>EditorFloatOption.clamp(nt,0,150),{markdownDescription:localize("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(nt,ot,rt){return nt.fontInfo.lineHeight}}class EditorMinimap extends BaseEditorOption{constructor(){const nt={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1};super(70,"minimap",nt,{"editor.minimap.enabled":{type:"boolean",default:nt.enabled,description:localize("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:nt.autohide,description:localize("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[localize("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),localize("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),localize("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:nt.size,description:localize("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:nt.side,description:localize("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:nt.showSlider,description:localize("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:nt.scale,minimum:1,maximum:3,enum:[1,2,3],description:localize("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:nt.renderCharacters,description:localize("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:nt.maxColumn,description:localize("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{enabled:boolean(ot.enabled,this.defaultValue.enabled),autohide:boolean(ot.autohide,this.defaultValue.autohide),size:stringSet(ot.size,this.defaultValue.size,["proportional","fill","fit"]),side:stringSet(ot.side,this.defaultValue.side,["right","left"]),showSlider:stringSet(ot.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:boolean(ot.renderCharacters,this.defaultValue.renderCharacters),scale:EditorIntOption.clampedInt(ot.scale,1,1,3),maxColumn:EditorIntOption.clampedInt(ot.maxColumn,this.defaultValue.maxColumn,1,1e4)}}}function _multiCursorModifierFromString(ct){return ct==="ctrlCmd"?isMacintosh?"metaKey":"ctrlKey":"altKey"}class EditorPadding extends BaseEditorOption{constructor(){super(81,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:localize("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:localize("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{top:EditorIntOption.clampedInt(ot.top,0,0,1e3),bottom:EditorIntOption.clampedInt(ot.bottom,0,0,1e3)}}}class EditorParameterHints extends BaseEditorOption{constructor(){const nt={enabled:!0,cycle:!0};super(82,"parameterHints",nt,{"editor.parameterHints.enabled":{type:"boolean",default:nt.enabled,description:localize("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:nt.cycle,description:localize("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{enabled:boolean(ot.enabled,this.defaultValue.enabled),cycle:boolean(ot.cycle,this.defaultValue.cycle)}}}class EditorPixelRatio extends ComputedEditorOption{constructor(){super(137)}compute(nt,ot,rt){return nt.pixelRatio}}class EditorQuickSuggestions extends BaseEditorOption{constructor(){const nt={other:"on",comments:"off",strings:"off"},ot=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[localize("on","Quick suggestions show inside the suggest widget"),localize("inline","Quick suggestions show as ghost text"),localize("off","Quick suggestions are disabled")]}];super(85,"quickSuggestions",nt,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:ot,default:nt.strings,description:localize("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:ot,default:nt.comments,description:localize("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:ot,default:nt.other,description:localize("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:nt,markdownDescription:localize("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the '{0}'-setting which controls if suggestions are triggered by special characters.","#editor.suggestOnTriggerCharacters#")}),this.defaultValue=nt}validate(nt){if(typeof nt=="boolean"){const St=nt?"on":"off";return{comments:St,strings:St,other:St}}if(!nt||typeof nt!="object")return this.defaultValue;const{other:ot,comments:rt,strings:ut}=nt,gt=["on","inline","off"];let pt,mt,vt;return typeof ot=="boolean"?pt=ot?"on":"off":pt=stringSet(ot,this.defaultValue.other,gt),typeof rt=="boolean"?mt=rt?"on":"off":mt=stringSet(rt,this.defaultValue.comments,gt),typeof ut=="boolean"?vt=ut?"on":"off":vt=stringSet(ut,this.defaultValue.strings,gt),{other:pt,comments:mt,strings:vt}}}class EditorRenderLineNumbersOption extends BaseEditorOption{constructor(){super(65,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[localize("lineNumbers.off","Line numbers are not rendered."),localize("lineNumbers.on","Line numbers are rendered as absolute number."),localize("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),localize("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:localize("lineNumbers","Controls the display of line numbers.")})}validate(nt){let ot=this.defaultValue.renderType,rt=this.defaultValue.renderFn;return typeof nt<"u"&&(typeof nt=="function"?(ot=4,rt=nt):nt==="interval"?ot=3:nt==="relative"?ot=2:nt==="on"?ot=1:ot=0),{renderType:ot,renderFn:rt}}}function filterValidationDecorations(ct){const nt=ct.get(93);return nt==="editable"?ct.get(87):nt!=="on"}class EditorRulers extends BaseEditorOption{constructor(){const nt=[],ot={type:"number",description:localize("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(97,"rulers",nt,{type:"array",items:{anyOf:[ot,{type:["object"],properties:{column:ot,color:{type:"string",description:localize("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:nt,description:localize("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(nt){if(Array.isArray(nt)){const ot=[];for(const rt of nt)if(typeof rt=="number")ot.push({column:EditorIntOption.clampedInt(rt,0,0,1e4),color:null});else if(rt&&typeof rt=="object"){const ut=rt;ot.push({column:EditorIntOption.clampedInt(ut.column,0,0,1e4),color:ut.color})}return ot.sort((rt,ut)=>rt.column-ut.column),ot}return this.defaultValue}}function _scrollbarVisibilityFromString(ct,nt){if(typeof ct!="string")return nt;switch(ct){case"hidden":return 2;case"visible":return 3;default:return 1}}let EditorScrollbar$1=class extends BaseEditorOption{constructor(){const nt={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1};super(98,"scrollbar",nt,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[localize("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),localize("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),localize("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:localize("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[localize("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),localize("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),localize("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:localize("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:nt.verticalScrollbarSize,description:localize("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:nt.horizontalScrollbarSize,description:localize("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:nt.scrollByPage,description:localize("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt,rt=EditorIntOption.clampedInt(ot.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),ut=EditorIntOption.clampedInt(ot.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:EditorIntOption.clampedInt(ot.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:_scrollbarVisibilityFromString(ot.vertical,this.defaultValue.vertical),horizontal:_scrollbarVisibilityFromString(ot.horizontal,this.defaultValue.horizontal),useShadows:boolean(ot.useShadows,this.defaultValue.useShadows),verticalHasArrows:boolean(ot.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:boolean(ot.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:boolean(ot.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:boolean(ot.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:rt,horizontalSliderSize:EditorIntOption.clampedInt(ot.horizontalSliderSize,rt,0,1e3),verticalScrollbarSize:ut,verticalSliderSize:EditorIntOption.clampedInt(ot.verticalSliderSize,ut,0,1e3),scrollByPage:boolean(ot.scrollByPage,this.defaultValue.scrollByPage)}}};const inUntrustedWorkspace="inUntrustedWorkspace",unicodeHighlightConfigKeys={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class UnicodeHighlight extends BaseEditorOption{constructor(){const nt={nonBasicASCII:inUntrustedWorkspace,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:inUntrustedWorkspace,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(120,"unicodeHighlight",nt,{[unicodeHighlightConfigKeys.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,inUntrustedWorkspace],default:nt.nonBasicASCII,description:localize("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[unicodeHighlightConfigKeys.invisibleCharacters]:{restricted:!0,type:"boolean",default:nt.invisibleCharacters,description:localize("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[unicodeHighlightConfigKeys.ambiguousCharacters]:{restricted:!0,type:"boolean",default:nt.ambiguousCharacters,description:localize("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[unicodeHighlightConfigKeys.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,inUntrustedWorkspace],default:nt.includeComments,description:localize("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[unicodeHighlightConfigKeys.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,inUntrustedWorkspace],default:nt.includeStrings,description:localize("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[unicodeHighlightConfigKeys.allowedCharacters]:{restricted:!0,type:"object",default:nt.allowedCharacters,description:localize("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[unicodeHighlightConfigKeys.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:nt.allowedLocales,description:localize("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(nt,ot){let rt=!1;ot.allowedCharacters&&nt&&(equals$1(nt.allowedCharacters,ot.allowedCharacters)||(nt=Object.assign(Object.assign({},nt),{allowedCharacters:ot.allowedCharacters}),rt=!0)),ot.allowedLocales&&nt&&(equals$1(nt.allowedLocales,ot.allowedLocales)||(nt=Object.assign(Object.assign({},nt),{allowedLocales:ot.allowedLocales}),rt=!0));const ut=super.applyUpdate(nt,ot);return rt?new ApplyUpdateResult(ut.newValue,!0):ut}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{nonBasicASCII:primitiveSet(ot.nonBasicASCII,inUntrustedWorkspace,[!0,!1,inUntrustedWorkspace]),invisibleCharacters:boolean(ot.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:boolean(ot.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:primitiveSet(ot.includeComments,inUntrustedWorkspace,[!0,!1,inUntrustedWorkspace]),includeStrings:primitiveSet(ot.includeStrings,inUntrustedWorkspace,[!0,!1,inUntrustedWorkspace]),allowedCharacters:this.validateBooleanMap(nt.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(nt.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(nt,ot){if(typeof nt!="object"||!nt)return ot;const rt={};for(const[ut,gt]of Object.entries(nt))gt===!0&&(rt[ut]=!0);return rt}}class InlineEditorSuggest extends BaseEditorOption{constructor(){const nt={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1};super(60,"inlineSuggest",nt,{"editor.inlineSuggest.enabled":{type:"boolean",default:nt.enabled,description:localize("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:nt.showToolbar,enum:["always","onHover"],enumDescriptions:[localize("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),localize("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion.")],description:localize("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:nt.suppressSuggestions,description:localize("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{enabled:boolean(ot.enabled,this.defaultValue.enabled),mode:stringSet(ot.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:stringSet(ot.showToolbar,this.defaultValue.showToolbar,["always","onHover"]),suppressSuggestions:boolean(ot.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:boolean(ot.keepOnBlur,this.defaultValue.keepOnBlur)}}}class BracketPairColorization extends BaseEditorOption{constructor(){const nt={enabled:EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(13,"bracketPairColorization",nt,{"editor.bracketPairColorization.enabled":{type:"boolean",default:nt.enabled,markdownDescription:localize("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:nt.independentColorPoolPerBracketType,description:localize("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{enabled:boolean(ot.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:boolean(ot.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class GuideOptions extends BaseEditorOption{constructor(){const nt={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(14,"guides",nt,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[localize("editor.guides.bracketPairs.true","Enables bracket pair guides."),localize("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),localize("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:nt.bracketPairs,description:localize("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[localize("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),localize("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),localize("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:nt.bracketPairsHorizontal,description:localize("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:nt.highlightActiveBracketPair,description:localize("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:nt.indentation,description:localize("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[localize("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),localize("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),localize("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:nt.highlightActiveIndentation,description:localize("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{bracketPairs:primitiveSet(ot.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:primitiveSet(ot.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:boolean(ot.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:boolean(ot.indentation,this.defaultValue.indentation),highlightActiveIndentation:primitiveSet(ot.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function primitiveSet(ct,nt,ot){const rt=ot.indexOf(ct);return rt===-1?nt:ot[rt]}class EditorSuggest extends BaseEditorOption{constructor(){const nt={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!0,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(113,"suggest",nt,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[localize("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),localize("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:nt.insertMode,description:localize("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:nt.filterGraceful,description:localize("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:nt.localityBonus,description:localize("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:nt.shareSuggestSelections,markdownDescription:localize("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[localize("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),localize("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),localize("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),localize("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:nt.selectionMode,markdownDescription:localize("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions (`#editor.quickSuggestions#` and `#editor.suggestOnTriggerCharacters#`) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:nt.snippetsPreventQuickSuggestions,description:localize("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:nt.showIcons,description:localize("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:nt.showStatusBar,description:localize("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:nt.preview,description:localize("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:nt.showInlineDetails,description:localize("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:localize("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:localize("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{insertMode:stringSet(ot.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:boolean(ot.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:boolean(ot.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:boolean(ot.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:boolean(ot.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:stringSet(ot.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:boolean(ot.showIcons,this.defaultValue.showIcons),showStatusBar:boolean(ot.showStatusBar,this.defaultValue.showStatusBar),preview:boolean(ot.preview,this.defaultValue.preview),previewMode:stringSet(ot.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:boolean(ot.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:boolean(ot.showMethods,this.defaultValue.showMethods),showFunctions:boolean(ot.showFunctions,this.defaultValue.showFunctions),showConstructors:boolean(ot.showConstructors,this.defaultValue.showConstructors),showDeprecated:boolean(ot.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:boolean(ot.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:boolean(ot.showFields,this.defaultValue.showFields),showVariables:boolean(ot.showVariables,this.defaultValue.showVariables),showClasses:boolean(ot.showClasses,this.defaultValue.showClasses),showStructs:boolean(ot.showStructs,this.defaultValue.showStructs),showInterfaces:boolean(ot.showInterfaces,this.defaultValue.showInterfaces),showModules:boolean(ot.showModules,this.defaultValue.showModules),showProperties:boolean(ot.showProperties,this.defaultValue.showProperties),showEvents:boolean(ot.showEvents,this.defaultValue.showEvents),showOperators:boolean(ot.showOperators,this.defaultValue.showOperators),showUnits:boolean(ot.showUnits,this.defaultValue.showUnits),showValues:boolean(ot.showValues,this.defaultValue.showValues),showConstants:boolean(ot.showConstants,this.defaultValue.showConstants),showEnums:boolean(ot.showEnums,this.defaultValue.showEnums),showEnumMembers:boolean(ot.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:boolean(ot.showKeywords,this.defaultValue.showKeywords),showWords:boolean(ot.showWords,this.defaultValue.showWords),showColors:boolean(ot.showColors,this.defaultValue.showColors),showFiles:boolean(ot.showFiles,this.defaultValue.showFiles),showReferences:boolean(ot.showReferences,this.defaultValue.showReferences),showFolders:boolean(ot.showFolders,this.defaultValue.showFolders),showTypeParameters:boolean(ot.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:boolean(ot.showSnippets,this.defaultValue.showSnippets),showUsers:boolean(ot.showUsers,this.defaultValue.showUsers),showIssues:boolean(ot.showIssues,this.defaultValue.showIssues)}}}class SmartSelect extends BaseEditorOption{constructor(){super(108,"smartSelect",{selectLeadingAndTrailingWhitespace:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:localize("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"}})}validate(nt){return!nt||typeof nt!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:boolean(nt.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace)}}}class WrappingIndentOption extends BaseEditorOption{constructor(){super(132,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[localize("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),localize("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),localize("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),localize("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:localize("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(nt){switch(nt){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(nt,ot,rt){return ot.get(2)===2?0:rt}}class EditorWrappingInfoComputer extends ComputedEditorOption{constructor(){super(140)}compute(nt,ot,rt){const ut=ot.get(139);return{isDominatedByLongLines:nt.isDominatedByLongLines,isWordWrapMinified:ut.isWordWrapMinified,isViewportWrapping:ut.isViewportWrapping,wrappingColumn:ut.wrappingColumn}}}class EditorDropIntoEditor extends BaseEditorOption{constructor(){const nt={enabled:!0,showDropSelector:"afterDrop"};super(34,"dropIntoEditor",nt,{"editor.dropIntoEditor.enabled":{type:"boolean",default:nt.enabled,markdownDescription:localize("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down `shift` (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:localize("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[localize("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),localize("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(nt){if(!nt||typeof nt!="object")return this.defaultValue;const ot=nt;return{enabled:boolean(ot.enabled,this.defaultValue.enabled),showDropSelector:stringSet(ot.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}const DEFAULT_WINDOWS_FONT_FAMILY="Consolas, 'Courier New', monospace",DEFAULT_MAC_FONT_FAMILY="Menlo, Monaco, 'Courier New', monospace",DEFAULT_LINUX_FONT_FAMILY="'Droid Sans Mono', 'monospace', monospace",EDITOR_FONT_DEFAULTS={fontFamily:isMacintosh?DEFAULT_MAC_FONT_FAMILY:isLinux?DEFAULT_LINUX_FONT_FAMILY:DEFAULT_WINDOWS_FONT_FAMILY,fontWeight:"normal",fontSize:isMacintosh?12:14,lineHeight:0,letterSpacing:0},editorOptionsRegistry=[];function register$2(ct){return editorOptionsRegistry[ct.id]=ct,ct}const EditorOptions={acceptSuggestionOnCommitCharacter:register$2(new EditorBooleanOption(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:localize("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:register$2(new EditorStringEnumOption(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",localize("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:localize("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:register$2(new EditorAccessibilitySupport),accessibilityPageSize:register$2(new EditorIntOption(3,"accessibilityPageSize",10,1,1073741824,{description:localize("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:register$2(new EditorStringOption(4,"ariaLabel",localize("editorViewAccessibleLabel","Editor content"))),screenReaderAnnounceInlineSuggestion:register$2(new EditorBooleanOption(6,"screenReaderAnnounceInlineSuggestion",!1,{description:localize("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader. Note that this does not work on macOS with VoiceOver."),tags:["accessibility"]})),autoClosingBrackets:register$2(new EditorStringEnumOption(5,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",localize("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),localize("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:localize("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingDelete:register$2(new EditorStringEnumOption(7,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",localize("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:localize("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:register$2(new EditorStringEnumOption(8,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",localize("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:localize("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:register$2(new EditorStringEnumOption(9,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",localize("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),localize("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:localize("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:register$2(new EditorEnumOption(10,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],_autoIndentFromString,{enumDescriptions:[localize("editor.autoIndent.none","The editor will not insert indentation automatically."),localize("editor.autoIndent.keep","The editor will keep the current line's indentation."),localize("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),localize("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),localize("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:localize("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:register$2(new EditorBooleanOption(11,"automaticLayout",!1)),autoSurround:register$2(new EditorStringEnumOption(12,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[localize("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),localize("editor.autoSurround.quotes","Surround with quotes but not brackets."),localize("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:localize("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:register$2(new BracketPairColorization),bracketPairGuides:register$2(new GuideOptions),stickyTabStops:register$2(new EditorBooleanOption(111,"stickyTabStops",!1,{description:localize("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:register$2(new EditorBooleanOption(15,"codeLens",!0,{description:localize("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:register$2(new EditorStringOption(16,"codeLensFontFamily","",{description:localize("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:register$2(new EditorIntOption(17,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:localize("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:register$2(new EditorBooleanOption(18,"colorDecorators",!0,{description:localize("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorsLimit:register$2(new EditorIntOption(19,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:localize("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:register$2(new EditorBooleanOption(20,"columnSelection",!1,{description:localize("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:register$2(new EditorComments),contextmenu:register$2(new EditorBooleanOption(22,"contextmenu",!0)),copyWithSyntaxHighlighting:register$2(new EditorBooleanOption(23,"copyWithSyntaxHighlighting",!0,{description:localize("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:register$2(new EditorEnumOption(24,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],_cursorBlinkingStyleFromString,{description:localize("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:register$2(new EditorStringEnumOption(25,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[localize("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),localize("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),localize("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:localize("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:register$2(new EditorEnumOption(26,"cursorStyle",TextEditorCursorStyle$1.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],_cursorStyleFromString,{description:localize("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:register$2(new EditorIntOption(27,"cursorSurroundingLines",0,0,1073741824,{description:localize("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:register$2(new EditorStringEnumOption(28,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[localize("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),localize("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],description:localize("cursorSurroundingLinesStyle","Controls when `cursorSurroundingLines` should be enforced.")})),cursorWidth:register$2(new EditorIntOption(29,"cursorWidth",0,0,1073741824,{markdownDescription:localize("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:register$2(new EditorBooleanOption(30,"disableLayerHinting",!1)),disableMonospaceOptimizations:register$2(new EditorBooleanOption(31,"disableMonospaceOptimizations",!1)),domReadOnly:register$2(new EditorBooleanOption(32,"domReadOnly",!1)),dragAndDrop:register$2(new EditorBooleanOption(33,"dragAndDrop",!0,{description:localize("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:register$2(new EditorEmptySelectionClipboard),dropIntoEditor:register$2(new EditorDropIntoEditor),stickyScroll:register$2(new EditorStickyScroll),experimentalWhitespaceRendering:register$2(new EditorStringEnumOption(36,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[localize("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),localize("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),localize("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:localize("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:register$2(new EditorStringOption(37,"extraEditorClassName","")),fastScrollSensitivity:register$2(new EditorFloatOption(38,"fastScrollSensitivity",5,ct=>ct<=0?5:ct,{markdownDescription:localize("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:register$2(new EditorFind),fixedOverflowWidgets:register$2(new EditorBooleanOption(40,"fixedOverflowWidgets",!1)),folding:register$2(new EditorBooleanOption(41,"folding",!0,{description:localize("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:register$2(new EditorStringEnumOption(42,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[localize("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),localize("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:localize("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:register$2(new EditorBooleanOption(43,"foldingHighlight",!0,{description:localize("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:register$2(new EditorBooleanOption(44,"foldingImportsByDefault",!1,{description:localize("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:register$2(new EditorIntOption(45,"foldingMaximumRegions",5e3,10,65e3,{description:localize("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:register$2(new EditorBooleanOption(46,"unfoldOnClickAfterEndOfLine",!1,{description:localize("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:register$2(new EditorStringOption(47,"fontFamily",EDITOR_FONT_DEFAULTS.fontFamily,{description:localize("fontFamily","Controls the font family.")})),fontInfo:register$2(new EditorFontInfo),fontLigatures2:register$2(new EditorFontLigatures),fontSize:register$2(new EditorFontSize),fontWeight:register$2(new EditorFontWeight),fontVariations:register$2(new EditorFontVariations),formatOnPaste:register$2(new EditorBooleanOption(53,"formatOnPaste",!1,{description:localize("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:register$2(new EditorBooleanOption(54,"formatOnType",!1,{description:localize("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:register$2(new EditorBooleanOption(55,"glyphMargin",!0,{description:localize("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:register$2(new EditorGoToLocation),hideCursorInOverviewRuler:register$2(new EditorBooleanOption(57,"hideCursorInOverviewRuler",!1,{description:localize("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:register$2(new EditorHover),inDiffEditor:register$2(new EditorBooleanOption(59,"inDiffEditor",!1)),letterSpacing:register$2(new EditorFloatOption(61,"letterSpacing",EDITOR_FONT_DEFAULTS.letterSpacing,ct=>EditorFloatOption.clamp(ct,-5,20),{description:localize("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:register$2(new EditorLightbulb),lineDecorationsWidth:register$2(new EditorLineDecorationsWidth),lineHeight:register$2(new EditorLineHeight),lineNumbers:register$2(new EditorRenderLineNumbersOption),lineNumbersMinChars:register$2(new EditorIntOption(66,"lineNumbersMinChars",5,1,300)),linkedEditing:register$2(new EditorBooleanOption(67,"linkedEditing",!1,{description:localize("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:register$2(new EditorBooleanOption(68,"links",!0,{description:localize("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:register$2(new EditorStringEnumOption(69,"matchBrackets","always",["always","near","never"],{description:localize("matchBrackets","Highlight matching brackets.")})),minimap:register$2(new EditorMinimap),mouseStyle:register$2(new EditorStringEnumOption(71,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:register$2(new EditorFloatOption(72,"mouseWheelScrollSensitivity",1,ct=>ct===0?1:ct,{markdownDescription:localize("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:register$2(new EditorBooleanOption(73,"mouseWheelZoom",!1,{markdownDescription:localize("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:register$2(new EditorBooleanOption(74,"multiCursorMergeOverlapping",!0,{description:localize("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:register$2(new EditorEnumOption(75,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],_multiCursorModifierFromString,{markdownEnumDescriptions:[localize("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),localize("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:localize({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:register$2(new EditorStringEnumOption(76,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[localize("multiCursorPaste.spread","Each cursor pastes a single line of the text."),localize("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:localize("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:register$2(new EditorIntOption(77,"multiCursorLimit",1e4,1,1e5,{markdownDescription:localize("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:register$2(new EditorBooleanOption(78,"occurrencesHighlight",!0,{description:localize("occurrencesHighlight","Controls whether the editor should highlight semantic symbol occurrences.")})),overviewRulerBorder:register$2(new EditorBooleanOption(79,"overviewRulerBorder",!0,{description:localize("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:register$2(new EditorIntOption(80,"overviewRulerLanes",3,0,3)),padding:register$2(new EditorPadding),parameterHints:register$2(new EditorParameterHints),peekWidgetDefaultFocus:register$2(new EditorStringEnumOption(83,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[localize("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),localize("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:localize("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),definitionLinkOpensInPeek:register$2(new EditorBooleanOption(84,"definitionLinkOpensInPeek",!1,{description:localize("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:register$2(new EditorQuickSuggestions),quickSuggestionsDelay:register$2(new EditorIntOption(86,"quickSuggestionsDelay",10,0,1073741824,{description:localize("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:register$2(new EditorBooleanOption(87,"readOnly",!1)),renameOnType:register$2(new EditorBooleanOption(88,"renameOnType",!1,{description:localize("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:localize("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:register$2(new EditorBooleanOption(89,"renderControlCharacters",!0,{description:localize("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:register$2(new EditorStringEnumOption(90,"renderFinalNewline",isLinux?"dimmed":"on",["off","on","dimmed"],{description:localize("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:register$2(new EditorStringEnumOption(91,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",localize("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:localize("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:register$2(new EditorBooleanOption(92,"renderLineHighlightOnlyWhenFocus",!1,{description:localize("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:register$2(new EditorStringEnumOption(93,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:register$2(new EditorStringEnumOption(94,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",localize("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),localize("renderWhitespace.selection","Render whitespace characters only on selected text."),localize("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:localize("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:register$2(new EditorIntOption(95,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:register$2(new EditorBooleanOption(96,"roundedSelection",!0,{description:localize("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:register$2(new EditorRulers),scrollbar:register$2(new EditorScrollbar$1),scrollBeyondLastColumn:register$2(new EditorIntOption(99,"scrollBeyondLastColumn",4,0,1073741824,{description:localize("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:register$2(new EditorBooleanOption(100,"scrollBeyondLastLine",!0,{description:localize("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:register$2(new EditorBooleanOption(101,"scrollPredominantAxis",!0,{description:localize("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:register$2(new EditorBooleanOption(102,"selectionClipboard",!0,{description:localize("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:isLinux})),selectionHighlight:register$2(new EditorBooleanOption(103,"selectionHighlight",!0,{description:localize("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:register$2(new EditorBooleanOption(104,"selectOnLineNumbers",!0)),showFoldingControls:register$2(new EditorStringEnumOption(105,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[localize("showFoldingControls.always","Always show the folding controls."),localize("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),localize("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:localize("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:register$2(new EditorBooleanOption(106,"showUnused",!0,{description:localize("showUnused","Controls fading out of unused code.")})),showDeprecated:register$2(new EditorBooleanOption(134,"showDeprecated",!0,{description:localize("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:register$2(new EditorInlayHints),snippetSuggestions:register$2(new EditorStringEnumOption(107,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[localize("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),localize("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),localize("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),localize("snippetSuggestions.none","Do not show snippet suggestions.")],description:localize("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:register$2(new SmartSelect),smoothScrolling:register$2(new EditorBooleanOption(109,"smoothScrolling",!1,{description:localize("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:register$2(new EditorIntOption(112,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:register$2(new EditorSuggest),inlineSuggest:register$2(new InlineEditorSuggest),suggestFontSize:register$2(new EditorIntOption(114,"suggestFontSize",0,0,1e3,{markdownDescription:localize("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:register$2(new EditorIntOption(115,"suggestLineHeight",0,0,1e3,{markdownDescription:localize("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:register$2(new EditorBooleanOption(116,"suggestOnTriggerCharacters",!0,{description:localize("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:register$2(new EditorStringEnumOption(117,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[localize("suggestSelection.first","Always select the first suggestion."),localize("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),localize("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:localize("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:register$2(new EditorStringEnumOption(118,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[localize("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),localize("tabCompletion.off","Disable tab completions."),localize("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:localize("tabCompletion","Enables tab completions.")})),tabIndex:register$2(new EditorIntOption(119,"tabIndex",0,-1,1073741824)),unicodeHighlight:register$2(new UnicodeHighlight),unusualLineTerminators:register$2(new EditorStringEnumOption(121,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[localize("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),localize("unusualLineTerminators.off","Unusual line terminators are ignored."),localize("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:localize("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:register$2(new EditorBooleanOption(122,"useShadowDOM",!0)),useTabStops:register$2(new EditorBooleanOption(123,"useTabStops",!0,{description:localize("useTabStops","Inserting and deleting whitespace follows tab stops.")})),wordBreak:register$2(new EditorStringEnumOption(124,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[localize("wordBreak.normal","Use the default line break rule."),localize("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:localize("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSeparators:register$2(new EditorStringOption(125,"wordSeparators",USUAL_WORD_SEPARATORS,{description:localize("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:register$2(new EditorStringEnumOption(126,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[localize("wordWrap.off","Lines will never wrap."),localize("wordWrap.on","Lines will wrap at the viewport width."),localize({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),localize({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:localize({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:register$2(new EditorStringOption(127,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;")),wordWrapBreakBeforeCharacters:register$2(new EditorStringOption(128,"wordWrapBreakBeforeCharacters","([{+")),wordWrapColumn:register$2(new EditorIntOption(129,"wordWrapColumn",80,1,1073741824,{markdownDescription:localize({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:register$2(new EditorStringEnumOption(130,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:register$2(new EditorStringEnumOption(131,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:register$2(new EditorClassName),defaultColorDecorators:register$2(new EditorBooleanOption(141,"defaultColorDecorators",!1,{markdownDescription:localize("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:register$2(new EditorPixelRatio),tabFocusMode:register$2(new EditorBooleanOption(138,"tabFocusMode",!1,{markdownDescription:localize("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:register$2(new EditorLayoutInfoComputer),wrappingInfo:register$2(new EditorWrappingInfoComputer),wrappingIndent:register$2(new WrappingIndentOption),wrappingStrategy:register$2(new WrappingStrategy)};class ErrorHandler{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(nt){setTimeout(()=>{throw nt.stack?ErrorNoTelemetry.isErrorNoTelemetry(nt)?new ErrorNoTelemetry(nt.message+`

`+nt.stack):new Error(nt.message+`

`+nt.stack):nt},0)}}emit(nt){this.listeners.forEach(ot=>{ot(nt)})}onUnexpectedError(nt){this.unexpectedErrorHandler(nt),this.emit(nt)}onUnexpectedExternalError(nt){this.unexpectedErrorHandler(nt)}}const errorHandler=new ErrorHandler;function onUnexpectedError(ct){isCancellationError(ct)||errorHandler.onUnexpectedError(ct)}function onUnexpectedExternalError(ct){isCancellationError(ct)||errorHandler.onUnexpectedExternalError(ct)}function transformErrorForSerialization(ct){if(ct instanceof Error){const{name:nt,message:ot}=ct,rt=ct.stacktrace||ct.stack;return{$isError:!0,name:nt,message:ot,stack:rt,noTelemetry:ErrorNoTelemetry.isErrorNoTelemetry(ct)}}return ct}const canceledName="Canceled";function isCancellationError(ct){return ct instanceof CancellationError?!0:ct instanceof Error&&ct.name===canceledName&&ct.message===canceledName}class CancellationError extends Error{constructor(){super(canceledName),this.name=this.message}}function canceled(){const ct=new Error(canceledName);return ct.name=ct.message,ct}function illegalArgument(ct){return ct?new Error(`Illegal argument: ${ct}`):new Error("Illegal argument")}function illegalState(ct){return ct?new Error(`Illegal state: ${ct}`):new Error("Illegal state")}class NotSupportedError extends Error{constructor(nt){super("NotSupported"),nt&&(this.message=nt)}}class ErrorNoTelemetry extends Error{constructor(nt){super(nt),this.name="CodeExpectedError"}static fromError(nt){if(nt instanceof ErrorNoTelemetry)return nt;const ot=new ErrorNoTelemetry;return ot.message=nt.message,ot.stack=nt.stack,ot}static isErrorNoTelemetry(nt){return nt.name==="CodeExpectedError"}}class BugIndicatingError extends Error{constructor(nt){super(nt||"An unexpected bug occurred."),Object.setPrototypeOf(this,BugIndicatingError.prototype);debugger}}function once$1(ct){const nt=this;let ot=!1,rt;return function(){return ot||(ot=!0,rt=ct.apply(nt,arguments)),rt}}function trackDisposable(ct){return ct}function setParentOfDisposable(ct,nt){}function markAsSingleton(ct){return ct}function isDisposable(ct){return typeof ct.dispose=="function"&&ct.dispose.length===0}function dispose(ct){if(Iterable.is(ct)){const nt=[];for(const ot of ct)if(ot)try{ot.dispose()}catch(rt){nt.push(rt)}if(nt.length===1)throw nt[0];if(nt.length>1)throw new AggregateError(nt,"Encountered errors while disposing of store");return Array.isArray(ct)?[]:ct}else if(ct)return ct.dispose(),ct}function combinedDisposable(...ct){return toDisposable(()=>dispose(ct))}function toDisposable(ct){return{dispose:once$1(()=>{ct()})}}class DisposableStore{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{dispose(this._toDispose)}finally{this._toDispose.clear()}}add(nt){if(!nt)return nt;if(nt===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?DisposableStore.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(nt),nt}}DisposableStore.DISABLE_DISPOSED_WARNING=!1;class Disposable{constructor(){this._store=new DisposableStore,this._store}dispose(){this._store.dispose()}_register(nt){if(nt===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(nt)}}Disposable.None=Object.freeze({dispose(){}});class MutableDisposable{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(nt){var ot;this._isDisposed||nt===this._value||((ot=this._value)===null||ot===void 0||ot.dispose(),this._value=nt)}clear(){this.value=void 0}dispose(){var nt;this._isDisposed=!0,(nt=this._value)===null||nt===void 0||nt.dispose(),this._value=void 0}}class RefCountedDisposable{constructor(nt){this._disposable=nt,this._counter=1}acquire(){return this._counter++,this}release(){return--this._counter===0&&this._disposable.dispose(),this}}class SafeDisposable{constructor(){this.dispose=()=>{},this.unset=()=>{},this.isset=()=>!1}set(nt){let ot=nt;return this.unset=()=>ot=void 0,this.isset=()=>ot!==void 0,this.dispose=()=>{ot&&(ot(),ot=void 0)},this}}class ImmortalReference{constructor(nt){this.object=nt}dispose(){}}class DisposableMap{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{dispose(this._store.values())}finally{this._store.clear()}}get(nt){return this._store.get(nt)}set(nt,ot,rt=!1){var ut;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),rt||(ut=this._store.get(nt))===null||ut===void 0||ut.dispose(),this._store.set(nt,ot)}deleteAndDispose(nt){var ot;(ot=this._store.get(nt))===null||ot===void 0||ot.dispose(),this._store.delete(nt)}[Symbol.iterator](){return this._store[Symbol.iterator]()}}const hasPerformanceNow=globals.performance&&typeof globals.performance.now=="function";class StopWatch{static create(nt=!0){return new StopWatch(nt)}constructor(nt){this._highResolution=hasPerformanceNow&&nt,this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}_now(){return this._highResolution?globals.performance.now():Date.now()}}var Event;(function(ct){ct.None=()=>Disposable.None;function nt(qt,Yt){return yt(qt,()=>{},0,void 0,!0,void 0,Yt)}ct.defer=nt;function ot(qt){return(Yt,Zt=null,Xt)=>{let _i=!1,nn;return nn=qt(rn=>{if(!_i)return nn?nn.dispose():_i=!0,Yt.call(Zt,rn)},null,Xt),_i&&nn.dispose(),nn}}ct.once=ot;function rt(qt,Yt,Zt){return St((Xt,_i=null,nn)=>qt(rn=>Xt.call(_i,Yt(rn)),null,nn),Zt)}ct.map=rt;function ut(qt,Yt,Zt){return St((Xt,_i=null,nn)=>qt(rn=>{Yt(rn),Xt.call(_i,rn)},null,nn),Zt)}ct.forEach=ut;function gt(qt,Yt,Zt){return St((Xt,_i=null,nn)=>qt(rn=>Yt(rn)&&Xt.call(_i,rn),null,nn),Zt)}ct.filter=gt;function pt(qt){return qt}ct.signal=pt;function mt(...qt){return(Yt,Zt=null,Xt)=>combinedDisposable(...qt.map(_i=>_i(nn=>Yt.call(Zt,nn),null,Xt)))}ct.any=mt;function vt(qt,Yt,Zt,Xt){let _i=Zt;return rt(qt,nn=>(_i=Yt(_i,nn),_i),Xt)}ct.reduce=vt;function St(qt,Yt){let Zt;const Xt={onWillAddFirstListener(){Zt=qt(_i.fire,_i)},onDidRemoveLastListener(){Zt==null||Zt.dispose()}},_i=new Emitter$2(Xt);return Yt==null||Yt.add(_i),_i.event}function yt(qt,Yt,Zt=100,Xt=!1,_i=!1,nn,rn){let dn,bn,un,an=0,Cn;const _n={leakWarningThreshold:nn,onWillAddFirstListener(){dn=qt(pn=>{an++,bn=Yt(bn,pn),Xt&&!un&&(hn.fire(bn),bn=void 0),Cn=()=>{const yn=bn;bn=void 0,un=void 0,(!Xt||an>1)&&hn.fire(yn),an=0},typeof Zt=="number"?(clearTimeout(un),un=setTimeout(Cn,Zt)):un===void 0&&(un=0,queueMicrotask(Cn))})},onWillRemoveListener(){_i&&an>0&&(Cn==null||Cn())},onDidRemoveLastListener(){Cn=void 0,dn.dispose()}},hn=new Emitter$2(_n);return rn==null||rn.add(hn),hn.event}ct.debounce=yt;function wt(qt,Yt=0,Zt){return ct.debounce(qt,(Xt,_i)=>Xt?(Xt.push(_i),Xt):[_i],Yt,void 0,!0,void 0,Zt)}ct.accumulate=wt;function Lt(qt,Yt=(Xt,_i)=>Xt===_i,Zt){let Xt=!0,_i;return gt(qt,nn=>{const rn=Xt||!Yt(nn,_i);return Xt=!1,_i=nn,rn},Zt)}ct.latch=Lt;function xt(qt,Yt,Zt){return[ct.filter(qt,Yt,Zt),ct.filter(qt,Xt=>!Yt(Xt),Zt)]}ct.split=xt;function It(qt,Yt=!1,Zt=[]){let Xt=Zt.slice(),_i=qt(dn=>{Xt?Xt.push(dn):rn.fire(dn)});const nn=()=>{Xt==null||Xt.forEach(dn=>rn.fire(dn)),Xt=null},rn=new Emitter$2({onWillAddFirstListener(){_i||(_i=qt(dn=>rn.fire(dn)))},onDidAddFirstListener(){Xt&&(Yt?setTimeout(nn):nn())},onDidRemoveLastListener(){_i&&_i.dispose(),_i=null}});return rn.event}ct.buffer=It;class kt{constructor(Yt){this.event=Yt,this.disposables=new DisposableStore}map(Yt){return new kt(rt(this.event,Yt,this.disposables))}forEach(Yt){return new kt(ut(this.event,Yt,this.disposables))}filter(Yt){return new kt(gt(this.event,Yt,this.disposables))}reduce(Yt,Zt){return new kt(vt(this.event,Yt,Zt,this.disposables))}latch(){return new kt(Lt(this.event,void 0,this.disposables))}debounce(Yt,Zt=100,Xt=!1,_i=!1,nn){return new kt(yt(this.event,Yt,Zt,Xt,_i,nn,this.disposables))}on(Yt,Zt,Xt){return this.event(Yt,Zt,Xt)}once(Yt,Zt,Xt){return ot(this.event)(Yt,Zt,Xt)}dispose(){this.disposables.dispose()}}function At(qt){return new kt(qt)}ct.chain=At;function Tt(qt,Yt,Zt=Xt=>Xt){const Xt=(...dn)=>rn.fire(Zt(...dn)),_i=()=>qt.on(Yt,Xt),nn=()=>qt.removeListener(Yt,Xt),rn=new Emitter$2({onWillAddFirstListener:_i,onDidRemoveLastListener:nn});return rn.event}ct.fromNodeEventEmitter=Tt;function Rt(qt,Yt,Zt=Xt=>Xt){const Xt=(...dn)=>rn.fire(Zt(...dn)),_i=()=>qt.addEventListener(Yt,Xt),nn=()=>qt.removeEventListener(Yt,Xt),rn=new Emitter$2({onWillAddFirstListener:_i,onDidRemoveLastListener:nn});return rn.event}ct.fromDOMEventEmitter=Rt;function Nt(qt){return new Promise(Yt=>ot(qt)(Yt))}ct.toPromise=Nt;function Pt(qt,Yt){return Yt(void 0),qt(Zt=>Yt(Zt))}ct.runAndSubscribe=Pt;function Ft(qt,Yt){let Zt=null;function Xt(nn){Zt==null||Zt.dispose(),Zt=new DisposableStore,Yt(nn,Zt)}Xt(void 0);const _i=qt(nn=>Xt(nn));return toDisposable(()=>{_i.dispose(),Zt==null||Zt.dispose()})}ct.runAndSubscribeWithStore=Ft;class Kt{constructor(Yt,Zt){this._observable=Yt,this._counter=0,this._hasChanged=!1;const Xt={onWillAddFirstListener:()=>{Yt.addObserver(this)},onDidRemoveLastListener:()=>{Yt.removeObserver(this)}};this.emitter=new Emitter$2(Xt),Zt&&Zt.add(this.emitter)}beginUpdate(Yt){this._counter++}handlePossibleChange(Yt){}handleChange(Yt,Zt){this._hasChanged=!0}endUpdate(Yt){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function Bt(qt,Yt){return new Kt(qt,Yt).emitter.event}ct.fromObservable=Bt;function Ut(qt){return Yt=>{let Zt=0,Xt=!1;const _i={beginUpdate(){Zt++},endUpdate(){Zt--,Zt===0&&(qt.reportChanges(),Xt&&(Xt=!1,Yt()))},handlePossibleChange(){},handleChange(){Xt=!0}};return qt.addObserver(_i),{dispose(){qt.removeObserver(_i)}}}}ct.fromObservableLight=Ut})(Event||(Event={}));class EventProfiling{constructor(nt){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${nt}_${EventProfiling._idPool++}`,EventProfiling.all.add(this)}start(nt){this._stopWatch=new StopWatch(!0),this.listenerCount=nt}stop(){if(this._stopWatch){const nt=this._stopWatch.elapsed();this.durations.push(nt),this.elapsedOverall+=nt,this.invocationCount+=1,this._stopWatch=void 0}}}EventProfiling.all=new Set;EventProfiling._idPool=0;let _globalLeakWarningThreshold=-1;class LeakageMonitor{constructor(nt,ot=Math.random().toString(18).slice(2,5)){this.threshold=nt,this.name=ot,this._warnCountdown=0}dispose(){var nt;(nt=this._stacks)===null||nt===void 0||nt.clear()}check(nt,ot){const rt=this.threshold;if(rt<=0||ot<rt)return;this._stacks||(this._stacks=new Map);const ut=this._stacks.get(nt.value)||0;if(this._stacks.set(nt.value,ut+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=rt*.5;let gt,pt=0;for(const[mt,vt]of this._stacks)(!gt||pt<vt)&&(gt=mt,pt=vt);console.warn(`[${this.name}] potential listener LEAK detected, having ${ot} listeners already. MOST frequent listener (${pt}):`),console.warn(gt)}return()=>{const gt=this._stacks.get(nt.value)||0;this._stacks.set(nt.value,gt-1)}}}class Stacktrace{static create(){var nt;return new Stacktrace((nt=new Error().stack)!==null&&nt!==void 0?nt:"")}constructor(nt){this.value=nt}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class Listener{constructor(nt,ot,rt){this.callback=nt,this.callbackThis=ot,this.stack=rt,this.subscription=new SafeDisposable}invoke(nt){this.callback.call(this.callbackThis,nt)}}let Emitter$2=class{constructor(nt){var ot,rt,ut,gt,pt;this._disposed=!1,this._options=nt,this._leakageMon=!((ot=this._options)===null||ot===void 0)&&ot.leakWarningThreshold?new LeakageMonitor((ut=(rt=this._options)===null||rt===void 0?void 0:rt.leakWarningThreshold)!==null&&ut!==void 0?ut:_globalLeakWarningThreshold):void 0,this._perfMon=!((gt=this._options)===null||gt===void 0)&&gt._profName?new EventProfiling(this._options._profName):void 0,this._deliveryQueue=(pt=this._options)===null||pt===void 0?void 0:pt.deliveryQueue}dispose(){var nt,ot,rt,ut;this._disposed||(this._disposed=!0,this._listeners&&this._listeners.clear(),(nt=this._deliveryQueue)===null||nt===void 0||nt.clear(this),(rt=(ot=this._options)===null||ot===void 0?void 0:ot.onDidRemoveLastListener)===null||rt===void 0||rt.call(ot),(ut=this._leakageMon)===null||ut===void 0||ut.dispose())}get event(){return this._event||(this._event=(nt,ot,rt)=>{var ut,gt,pt;if(this._listeners||(this._listeners=new LinkedList),this._leakageMon&&this._listeners.size>this._leakageMon.threshold*3)return console.warn(`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far`),Disposable.None;const mt=this._listeners.isEmpty();mt&&(!((ut=this._options)===null||ut===void 0)&&ut.onWillAddFirstListener)&&this._options.onWillAddFirstListener(this);let vt,St;this._leakageMon&&this._listeners.size>=Math.ceil(this._leakageMon.threshold*.2)&&(St=Stacktrace.create(),vt=this._leakageMon.check(St,this._listeners.size+1));const yt=new Listener(nt,ot,St),wt=this._listeners.push(yt);mt&&(!((gt=this._options)===null||gt===void 0)&&gt.onDidAddFirstListener)&&this._options.onDidAddFirstListener(this),!((pt=this._options)===null||pt===void 0)&&pt.onDidAddListener&&this._options.onDidAddListener(this,nt,ot);const Lt=yt.subscription.set(()=>{var xt,It;vt==null||vt(),this._disposed||((It=(xt=this._options)===null||xt===void 0?void 0:xt.onWillRemoveListener)===null||It===void 0||It.call(xt,this),wt(),this._options&&this._options.onDidRemoveLastListener&&(this._listeners&&!this._listeners.isEmpty()||this._options.onDidRemoveLastListener(this)))});return rt instanceof DisposableStore?rt.add(Lt):Array.isArray(rt)&&rt.push(Lt),Lt}),this._event}fire(nt){var ot,rt,ut;if(this._listeners){this._deliveryQueue||(this._deliveryQueue=new PrivateEventDeliveryQueue((ot=this._options)===null||ot===void 0?void 0:ot.onListenerError));for(const gt of this._listeners)this._deliveryQueue.push(this,gt,nt);(rt=this._perfMon)===null||rt===void 0||rt.start(this._deliveryQueue.size),this._deliveryQueue.deliver(),(ut=this._perfMon)===null||ut===void 0||ut.stop()}}hasListeners(){return this._listeners?!this._listeners.isEmpty():!1}};class EventDeliveryQueue{constructor(nt=onUnexpectedError){this._onListenerError=nt,this._queue=new LinkedList}get size(){return this._queue.size}push(nt,ot,rt){this._queue.push(new EventDeliveryQueueElement(nt,ot,rt))}clear(nt){const ot=new LinkedList;for(const rt of this._queue)rt.emitter!==nt&&ot.push(rt);this._queue=ot}deliver(){for(;this._queue.size>0;){const nt=this._queue.shift();try{nt.listener.invoke(nt.event)}catch(ot){this._onListenerError(ot)}}}}class PrivateEventDeliveryQueue extends EventDeliveryQueue{clear(nt){this._queue.clear()}}class EventDeliveryQueueElement{constructor(nt,ot,rt){this.emitter=nt,this.listener=ot,this.event=rt}}class PauseableEmitter extends Emitter$2{constructor(nt){super(nt),this._isPaused=0,this._eventQueue=new LinkedList,this._mergeFn=nt==null?void 0:nt.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const nt=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(nt))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(nt){this._listeners&&(this._isPaused!==0?this._eventQueue.push(nt):super.fire(nt))}}class DebounceEmitter extends PauseableEmitter{constructor(nt){var ot;super(nt),this._delay=(ot=nt.delay)!==null&&ot!==void 0?ot:100}fire(nt){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(nt)}}class MicrotaskEmitter extends Emitter$2{constructor(nt){super(nt),this._queuedEvents=[],this._mergeFn=nt==null?void 0:nt.merge}fire(nt){this.hasListeners()&&(this._queuedEvents.push(nt),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(ot=>super.fire(ot)),this._queuedEvents=[]}))}}class EventMultiplexer{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new Emitter$2({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(nt){const ot={event:nt,listener:null};return this.events.push(ot),this.hasListeners&&this.hook(ot),toDisposable(once$1(()=>{this.hasListeners&&this.unhook(ot);const ut=this.events.indexOf(ot);this.events.splice(ut,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(nt=>this.hook(nt))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(nt=>this.unhook(nt))}hook(nt){nt.listener=nt.event(ot=>this.emitter.fire(ot))}unhook(nt){nt.listener&&nt.listener.dispose(),nt.listener=null}dispose(){this.emitter.dispose()}}class EventBufferer{constructor(){this.buffers=[]}wrapEvent(nt){return(ot,rt,ut)=>nt(gt=>{const pt=this.buffers[this.buffers.length-1];pt?pt.push(()=>ot.call(rt,gt)):ot.call(rt,gt)},void 0,ut)}bufferEvents(nt){const ot=[];this.buffers.push(ot);const rt=nt();return this.buffers.pop(),ot.forEach(ut=>ut()),rt}}class Relay{constructor(){this.listening=!1,this.inputEvent=Event.None,this.inputEventListener=Disposable.None,this.emitter=new Emitter$2({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(nt){this.inputEvent=nt,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=nt(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const shortcutEvent=Object.freeze(function(ct,nt){const ot=setTimeout(ct.bind(nt),0);return{dispose(){clearTimeout(ot)}}});var CancellationToken;(function(ct){function nt(ot){return ot===ct.None||ot===ct.Cancelled||ot instanceof MutableToken?!0:!ot||typeof ot!="object"?!1:typeof ot.isCancellationRequested=="boolean"&&typeof ot.onCancellationRequested=="function"}ct.isCancellationToken=nt,ct.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Event.None}),ct.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:shortcutEvent})})(CancellationToken||(CancellationToken={}));class MutableToken{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?shortcutEvent:(this._emitter||(this._emitter=new Emitter$2),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}let CancellationTokenSource$1=class{constructor(nt){this._token=void 0,this._parentListener=void 0,this._parentListener=nt&&nt.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new MutableToken),this._token}cancel(){this._token?this._token instanceof MutableToken&&this._token.cancel():this._token=CancellationToken.Cancelled}dispose(nt=!1){var ot;nt&&this.cancel(),(ot=this._parentListener)===null||ot===void 0||ot.dispose(),this._token?this._token instanceof MutableToken&&this._token.dispose():this._token=CancellationToken.None}};class KeyCodeStrMap{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(nt,ot){this._keyCodeToStr[nt]=ot,this._strToKeyCode[ot.toLowerCase()]=nt}keyCodeToStr(nt){return this._keyCodeToStr[nt]}strToKeyCode(nt){return this._strToKeyCode[nt.toLowerCase()]||0}}const uiMap=new KeyCodeStrMap,userSettingsUSMap=new KeyCodeStrMap,userSettingsGeneralMap=new KeyCodeStrMap,EVENT_KEY_CODE_MAP=new Array(230),scanCodeStrToInt=Object.create(null),scanCodeLowerCaseStrToInt=Object.create(null),IMMUTABLE_CODE_TO_KEY_CODE=[];for(let ct=0;ct<=193;ct++)IMMUTABLE_CODE_TO_KEY_CODE[ct]=-1;(function(){const ct="",nt=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",ct,ct],[1,1,"Hyper",0,ct,0,ct,ct,ct],[1,2,"Super",0,ct,0,ct,ct,ct],[1,3,"Fn",0,ct,0,ct,ct,ct],[1,4,"FnLock",0,ct,0,ct,ct,ct],[1,5,"Suspend",0,ct,0,ct,ct,ct],[1,6,"Resume",0,ct,0,ct,ct,ct],[1,7,"Turbo",0,ct,0,ct,ct,ct],[1,8,"Sleep",0,ct,0,"VK_SLEEP",ct,ct],[1,9,"WakeUp",0,ct,0,ct,ct,ct],[0,10,"KeyA",31,"A",65,"VK_A",ct,ct],[0,11,"KeyB",32,"B",66,"VK_B",ct,ct],[0,12,"KeyC",33,"C",67,"VK_C",ct,ct],[0,13,"KeyD",34,"D",68,"VK_D",ct,ct],[0,14,"KeyE",35,"E",69,"VK_E",ct,ct],[0,15,"KeyF",36,"F",70,"VK_F",ct,ct],[0,16,"KeyG",37,"G",71,"VK_G",ct,ct],[0,17,"KeyH",38,"H",72,"VK_H",ct,ct],[0,18,"KeyI",39,"I",73,"VK_I",ct,ct],[0,19,"KeyJ",40,"J",74,"VK_J",ct,ct],[0,20,"KeyK",41,"K",75,"VK_K",ct,ct],[0,21,"KeyL",42,"L",76,"VK_L",ct,ct],[0,22,"KeyM",43,"M",77,"VK_M",ct,ct],[0,23,"KeyN",44,"N",78,"VK_N",ct,ct],[0,24,"KeyO",45,"O",79,"VK_O",ct,ct],[0,25,"KeyP",46,"P",80,"VK_P",ct,ct],[0,26,"KeyQ",47,"Q",81,"VK_Q",ct,ct],[0,27,"KeyR",48,"R",82,"VK_R",ct,ct],[0,28,"KeyS",49,"S",83,"VK_S",ct,ct],[0,29,"KeyT",50,"T",84,"VK_T",ct,ct],[0,30,"KeyU",51,"U",85,"VK_U",ct,ct],[0,31,"KeyV",52,"V",86,"VK_V",ct,ct],[0,32,"KeyW",53,"W",87,"VK_W",ct,ct],[0,33,"KeyX",54,"X",88,"VK_X",ct,ct],[0,34,"KeyY",55,"Y",89,"VK_Y",ct,ct],[0,35,"KeyZ",56,"Z",90,"VK_Z",ct,ct],[0,36,"Digit1",22,"1",49,"VK_1",ct,ct],[0,37,"Digit2",23,"2",50,"VK_2",ct,ct],[0,38,"Digit3",24,"3",51,"VK_3",ct,ct],[0,39,"Digit4",25,"4",52,"VK_4",ct,ct],[0,40,"Digit5",26,"5",53,"VK_5",ct,ct],[0,41,"Digit6",27,"6",54,"VK_6",ct,ct],[0,42,"Digit7",28,"7",55,"VK_7",ct,ct],[0,43,"Digit8",29,"8",56,"VK_8",ct,ct],[0,44,"Digit9",30,"9",57,"VK_9",ct,ct],[0,45,"Digit0",21,"0",48,"VK_0",ct,ct],[1,46,"Enter",3,"Enter",13,"VK_RETURN",ct,ct],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",ct,ct],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",ct,ct],[1,49,"Tab",2,"Tab",9,"VK_TAB",ct,ct],[1,50,"Space",10,"Space",32,"VK_SPACE",ct,ct],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,ct,0,ct,ct,ct],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",ct,ct],[1,64,"F1",59,"F1",112,"VK_F1",ct,ct],[1,65,"F2",60,"F2",113,"VK_F2",ct,ct],[1,66,"F3",61,"F3",114,"VK_F3",ct,ct],[1,67,"F4",62,"F4",115,"VK_F4",ct,ct],[1,68,"F5",63,"F5",116,"VK_F5",ct,ct],[1,69,"F6",64,"F6",117,"VK_F6",ct,ct],[1,70,"F7",65,"F7",118,"VK_F7",ct,ct],[1,71,"F8",66,"F8",119,"VK_F8",ct,ct],[1,72,"F9",67,"F9",120,"VK_F9",ct,ct],[1,73,"F10",68,"F10",121,"VK_F10",ct,ct],[1,74,"F11",69,"F11",122,"VK_F11",ct,ct],[1,75,"F12",70,"F12",123,"VK_F12",ct,ct],[1,76,"PrintScreen",0,ct,0,ct,ct,ct],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",ct,ct],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",ct,ct],[1,79,"Insert",19,"Insert",45,"VK_INSERT",ct,ct],[1,80,"Home",14,"Home",36,"VK_HOME",ct,ct],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",ct,ct],[1,82,"Delete",20,"Delete",46,"VK_DELETE",ct,ct],[1,83,"End",13,"End",35,"VK_END",ct,ct],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",ct,ct],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",ct],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",ct],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",ct],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",ct],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",ct,ct],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",ct,ct],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",ct,ct],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",ct,ct],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",ct,ct],[1,94,"NumpadEnter",3,ct,0,ct,ct,ct],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",ct,ct],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",ct,ct],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",ct,ct],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",ct,ct],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",ct,ct],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",ct,ct],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",ct,ct],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",ct,ct],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",ct,ct],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",ct,ct],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",ct,ct],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",ct,ct],[1,107,"ContextMenu",58,"ContextMenu",93,ct,ct,ct],[1,108,"Power",0,ct,0,ct,ct,ct],[1,109,"NumpadEqual",0,ct,0,ct,ct,ct],[1,110,"F13",71,"F13",124,"VK_F13",ct,ct],[1,111,"F14",72,"F14",125,"VK_F14",ct,ct],[1,112,"F15",73,"F15",126,"VK_F15",ct,ct],[1,113,"F16",74,"F16",127,"VK_F16",ct,ct],[1,114,"F17",75,"F17",128,"VK_F17",ct,ct],[1,115,"F18",76,"F18",129,"VK_F18",ct,ct],[1,116,"F19",77,"F19",130,"VK_F19",ct,ct],[1,117,"F20",78,"F20",0,"VK_F20",ct,ct],[1,118,"F21",79,"F21",0,"VK_F21",ct,ct],[1,119,"F22",80,"F22",0,"VK_F22",ct,ct],[1,120,"F23",81,"F23",0,"VK_F23",ct,ct],[1,121,"F24",82,"F24",0,"VK_F24",ct,ct],[1,122,"Open",0,ct,0,ct,ct,ct],[1,123,"Help",0,ct,0,ct,ct,ct],[1,124,"Select",0,ct,0,ct,ct,ct],[1,125,"Again",0,ct,0,ct,ct,ct],[1,126,"Undo",0,ct,0,ct,ct,ct],[1,127,"Cut",0,ct,0,ct,ct,ct],[1,128,"Copy",0,ct,0,ct,ct,ct],[1,129,"Paste",0,ct,0,ct,ct,ct],[1,130,"Find",0,ct,0,ct,ct,ct],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",ct,ct],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",ct,ct],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",ct,ct],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",ct,ct],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",ct,ct],[1,136,"KanaMode",0,ct,0,ct,ct,ct],[0,137,"IntlYen",0,ct,0,ct,ct,ct],[1,138,"Convert",0,ct,0,ct,ct,ct],[1,139,"NonConvert",0,ct,0,ct,ct,ct],[1,140,"Lang1",0,ct,0,ct,ct,ct],[1,141,"Lang2",0,ct,0,ct,ct,ct],[1,142,"Lang3",0,ct,0,ct,ct,ct],[1,143,"Lang4",0,ct,0,ct,ct,ct],[1,144,"Lang5",0,ct,0,ct,ct,ct],[1,145,"Abort",0,ct,0,ct,ct,ct],[1,146,"Props",0,ct,0,ct,ct,ct],[1,147,"NumpadParenLeft",0,ct,0,ct,ct,ct],[1,148,"NumpadParenRight",0,ct,0,ct,ct,ct],[1,149,"NumpadBackspace",0,ct,0,ct,ct,ct],[1,150,"NumpadMemoryStore",0,ct,0,ct,ct,ct],[1,151,"NumpadMemoryRecall",0,ct,0,ct,ct,ct],[1,152,"NumpadMemoryClear",0,ct,0,ct,ct,ct],[1,153,"NumpadMemoryAdd",0,ct,0,ct,ct,ct],[1,154,"NumpadMemorySubtract",0,ct,0,ct,ct,ct],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",ct,ct],[1,156,"NumpadClearEntry",0,ct,0,ct,ct,ct],[1,0,ct,5,"Ctrl",17,"VK_CONTROL",ct,ct],[1,0,ct,4,"Shift",16,"VK_SHIFT",ct,ct],[1,0,ct,6,"Alt",18,"VK_MENU",ct,ct],[1,0,ct,57,"Meta",91,"VK_COMMAND",ct,ct],[1,157,"ControlLeft",5,ct,0,"VK_LCONTROL",ct,ct],[1,158,"ShiftLeft",4,ct,0,"VK_LSHIFT",ct,ct],[1,159,"AltLeft",6,ct,0,"VK_LMENU",ct,ct],[1,160,"MetaLeft",57,ct,0,"VK_LWIN",ct,ct],[1,161,"ControlRight",5,ct,0,"VK_RCONTROL",ct,ct],[1,162,"ShiftRight",4,ct,0,"VK_RSHIFT",ct,ct],[1,163,"AltRight",6,ct,0,"VK_RMENU",ct,ct],[1,164,"MetaRight",57,ct,0,"VK_RWIN",ct,ct],[1,165,"BrightnessUp",0,ct,0,ct,ct,ct],[1,166,"BrightnessDown",0,ct,0,ct,ct,ct],[1,167,"MediaPlay",0,ct,0,ct,ct,ct],[1,168,"MediaRecord",0,ct,0,ct,ct,ct],[1,169,"MediaFastForward",0,ct,0,ct,ct,ct],[1,170,"MediaRewind",0,ct,0,ct,ct,ct],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",ct,ct],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",ct,ct],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",ct,ct],[1,174,"Eject",0,ct,0,ct,ct,ct],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",ct,ct],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",ct,ct],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",ct,ct],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",ct,ct],[1,179,"LaunchApp1",0,ct,0,"VK_MEDIA_LAUNCH_APP1",ct,ct],[1,180,"SelectTask",0,ct,0,ct,ct,ct],[1,181,"LaunchScreenSaver",0,ct,0,ct,ct,ct],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",ct,ct],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",ct,ct],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",ct,ct],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",ct,ct],[1,186,"BrowserStop",0,ct,0,"VK_BROWSER_STOP",ct,ct],[1,187,"BrowserRefresh",0,ct,0,"VK_BROWSER_REFRESH",ct,ct],[1,188,"BrowserFavorites",0,ct,0,"VK_BROWSER_FAVORITES",ct,ct],[1,189,"ZoomToggle",0,ct,0,ct,ct,ct],[1,190,"MailReply",0,ct,0,ct,ct,ct],[1,191,"MailForward",0,ct,0,ct,ct,ct],[1,192,"MailSend",0,ct,0,ct,ct,ct],[1,0,ct,114,"KeyInComposition",229,ct,ct,ct],[1,0,ct,116,"ABNT_C2",194,"VK_ABNT_C2",ct,ct],[1,0,ct,96,"OEM_8",223,"VK_OEM_8",ct,ct],[1,0,ct,0,ct,0,"VK_KANA",ct,ct],[1,0,ct,0,ct,0,"VK_HANGUL",ct,ct],[1,0,ct,0,ct,0,"VK_JUNJA",ct,ct],[1,0,ct,0,ct,0,"VK_FINAL",ct,ct],[1,0,ct,0,ct,0,"VK_HANJA",ct,ct],[1,0,ct,0,ct,0,"VK_KANJI",ct,ct],[1,0,ct,0,ct,0,"VK_CONVERT",ct,ct],[1,0,ct,0,ct,0,"VK_NONCONVERT",ct,ct],[1,0,ct,0,ct,0,"VK_ACCEPT",ct,ct],[1,0,ct,0,ct,0,"VK_MODECHANGE",ct,ct],[1,0,ct,0,ct,0,"VK_SELECT",ct,ct],[1,0,ct,0,ct,0,"VK_PRINT",ct,ct],[1,0,ct,0,ct,0,"VK_EXECUTE",ct,ct],[1,0,ct,0,ct,0,"VK_SNAPSHOT",ct,ct],[1,0,ct,0,ct,0,"VK_HELP",ct,ct],[1,0,ct,0,ct,0,"VK_APPS",ct,ct],[1,0,ct,0,ct,0,"VK_PROCESSKEY",ct,ct],[1,0,ct,0,ct,0,"VK_PACKET",ct,ct],[1,0,ct,0,ct,0,"VK_DBE_SBCSCHAR",ct,ct],[1,0,ct,0,ct,0,"VK_DBE_DBCSCHAR",ct,ct],[1,0,ct,0,ct,0,"VK_ATTN",ct,ct],[1,0,ct,0,ct,0,"VK_CRSEL",ct,ct],[1,0,ct,0,ct,0,"VK_EXSEL",ct,ct],[1,0,ct,0,ct,0,"VK_EREOF",ct,ct],[1,0,ct,0,ct,0,"VK_PLAY",ct,ct],[1,0,ct,0,ct,0,"VK_ZOOM",ct,ct],[1,0,ct,0,ct,0,"VK_NONAME",ct,ct],[1,0,ct,0,ct,0,"VK_PA1",ct,ct],[1,0,ct,0,ct,0,"VK_OEM_CLEAR",ct,ct]],ot=[],rt=[];for(const ut of nt){const[gt,pt,mt,vt,St,yt,wt,Lt,xt]=ut;if(rt[pt]||(rt[pt]=!0,scanCodeStrToInt[mt]=pt,scanCodeLowerCaseStrToInt[mt.toLowerCase()]=pt,gt&&(IMMUTABLE_CODE_TO_KEY_CODE[pt]=vt)),!ot[vt]){if(ot[vt]=!0,!St)throw new Error(`String representation missing for key code ${vt} around scan code ${mt}`);uiMap.define(vt,St),userSettingsUSMap.define(vt,Lt||St),userSettingsGeneralMap.define(vt,xt||Lt||St)}yt&&(EVENT_KEY_CODE_MAP[yt]=vt)}})();var KeyCodeUtils;(function(ct){function nt(mt){return uiMap.keyCodeToStr(mt)}ct.toString=nt;function ot(mt){return uiMap.strToKeyCode(mt)}ct.fromString=ot;function rt(mt){return userSettingsUSMap.keyCodeToStr(mt)}ct.toUserSettingsUS=rt;function ut(mt){return userSettingsGeneralMap.keyCodeToStr(mt)}ct.toUserSettingsGeneral=ut;function gt(mt){return userSettingsUSMap.strToKeyCode(mt)||userSettingsGeneralMap.strToKeyCode(mt)}ct.fromUserSettings=gt;function pt(mt){if(mt>=98&&mt<=113)return null;switch(mt){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return uiMap.keyCodeToStr(mt)}ct.toElectronAccelerator=pt})(KeyCodeUtils||(KeyCodeUtils={}));function KeyChord(ct,nt){const ot=(nt&65535)<<16>>>0;return(ct|ot)>>>0}let safeProcess;if(typeof globals.vscode<"u"&&typeof globals.vscode.process<"u"){const ct=globals.vscode.process;safeProcess={get platform(){return ct.platform},get arch(){return ct.arch},get env(){return ct.env},cwd(){return ct.cwd()}}}else typeof process<"u"?safeProcess={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:safeProcess={get platform(){return isWindows?"win32":isMacintosh?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const cwd=safeProcess.cwd,env=safeProcess.env,platform=safeProcess.platform,CHAR_UPPERCASE_A=65,CHAR_LOWERCASE_A=97,CHAR_UPPERCASE_Z=90,CHAR_LOWERCASE_Z=122,CHAR_DOT=46,CHAR_FORWARD_SLASH=47,CHAR_BACKWARD_SLASH=92,CHAR_COLON=58,CHAR_QUESTION_MARK=63;class ErrorInvalidArgType extends Error{constructor(nt,ot,rt){let ut;typeof ot=="string"&&ot.indexOf("not ")===0?(ut="must not be",ot=ot.replace(/^not /,"")):ut="must be";const gt=nt.indexOf(".")!==-1?"property":"argument";let pt=`The "${nt}" ${gt} ${ut} of type ${ot}`;pt+=`. Received type ${typeof rt}`,super(pt),this.code="ERR_INVALID_ARG_TYPE"}}function validateObject(ct,nt){if(ct===null||typeof ct!="object")throw new ErrorInvalidArgType(nt,"Object",ct)}function validateString(ct,nt){if(typeof ct!="string")throw new ErrorInvalidArgType(nt,"string",ct)}const platformIsWin32=platform==="win32";function isPathSeparator$1(ct){return ct===CHAR_FORWARD_SLASH||ct===CHAR_BACKWARD_SLASH}function isPosixPathSeparator(ct){return ct===CHAR_FORWARD_SLASH}function isWindowsDeviceRoot(ct){return ct>=CHAR_UPPERCASE_A&&ct<=CHAR_UPPERCASE_Z||ct>=CHAR_LOWERCASE_A&&ct<=CHAR_LOWERCASE_Z}function normalizeString(ct,nt,ot,rt){let ut="",gt=0,pt=-1,mt=0,vt=0;for(let St=0;St<=ct.length;++St){if(St<ct.length)vt=ct.charCodeAt(St);else{if(rt(vt))break;vt=CHAR_FORWARD_SLASH}if(rt(vt)){if(!(pt===St-1||mt===1))if(mt===2){if(ut.length<2||gt!==2||ut.charCodeAt(ut.length-1)!==CHAR_DOT||ut.charCodeAt(ut.length-2)!==CHAR_DOT){if(ut.length>2){const yt=ut.lastIndexOf(ot);yt===-1?(ut="",gt=0):(ut=ut.slice(0,yt),gt=ut.length-1-ut.lastIndexOf(ot)),pt=St,mt=0;continue}else if(ut.length!==0){ut="",gt=0,pt=St,mt=0;continue}}nt&&(ut+=ut.length>0?`${ot}..`:"..",gt=2)}else ut.length>0?ut+=`${ot}${ct.slice(pt+1,St)}`:ut=ct.slice(pt+1,St),gt=St-pt-1;pt=St,mt=0}else vt===CHAR_DOT&&mt!==-1?++mt:mt=-1}return ut}function _format(ct,nt){validateObject(nt,"pathObject");const ot=nt.dir||nt.root,rt=nt.base||`${nt.name||""}${nt.ext||""}`;return ot?ot===nt.root?`${ot}${rt}`:`${ot}${ct}${rt}`:rt}const win32={resolve(...ct){let nt="",ot="",rt=!1;for(let ut=ct.length-1;ut>=-1;ut--){let gt;if(ut>=0){if(gt=ct[ut],validateString(gt,"path"),gt.length===0)continue}else nt.length===0?gt=cwd():(gt=env[`=${nt}`]||cwd(),(gt===void 0||gt.slice(0,2).toLowerCase()!==nt.toLowerCase()&&gt.charCodeAt(2)===CHAR_BACKWARD_SLASH)&&(gt=`${nt}\\`));const pt=gt.length;let mt=0,vt="",St=!1;const yt=gt.charCodeAt(0);if(pt===1)isPathSeparator$1(yt)&&(mt=1,St=!0);else if(isPathSeparator$1(yt))if(St=!0,isPathSeparator$1(gt.charCodeAt(1))){let wt=2,Lt=wt;for(;wt<pt&&!isPathSeparator$1(gt.charCodeAt(wt));)wt++;if(wt<pt&&wt!==Lt){const xt=gt.slice(Lt,wt);for(Lt=wt;wt<pt&&isPathSeparator$1(gt.charCodeAt(wt));)wt++;if(wt<pt&&wt!==Lt){for(Lt=wt;wt<pt&&!isPathSeparator$1(gt.charCodeAt(wt));)wt++;(wt===pt||wt!==Lt)&&(vt=`\\\\${xt}\\${gt.slice(Lt,wt)}`,mt=wt)}}}else mt=1;else isWindowsDeviceRoot(yt)&&gt.charCodeAt(1)===CHAR_COLON&&(vt=gt.slice(0,2),mt=2,pt>2&&isPathSeparator$1(gt.charCodeAt(2))&&(St=!0,mt=3));if(vt.length>0)if(nt.length>0){if(vt.toLowerCase()!==nt.toLowerCase())continue}else nt=vt;if(rt){if(nt.length>0)break}else if(ot=`${gt.slice(mt)}\\${ot}`,rt=St,St&&nt.length>0)break}return ot=normalizeString(ot,!rt,"\\",isPathSeparator$1),rt?`${nt}\\${ot}`:`${nt}${ot}`||"."},normalize(ct){validateString(ct,"path");const nt=ct.length;if(nt===0)return".";let ot=0,rt,ut=!1;const gt=ct.charCodeAt(0);if(nt===1)return isPosixPathSeparator(gt)?"\\":ct;if(isPathSeparator$1(gt))if(ut=!0,isPathSeparator$1(ct.charCodeAt(1))){let mt=2,vt=mt;for(;mt<nt&&!isPathSeparator$1(ct.charCodeAt(mt));)mt++;if(mt<nt&&mt!==vt){const St=ct.slice(vt,mt);for(vt=mt;mt<nt&&isPathSeparator$1(ct.charCodeAt(mt));)mt++;if(mt<nt&&mt!==vt){for(vt=mt;mt<nt&&!isPathSeparator$1(ct.charCodeAt(mt));)mt++;if(mt===nt)return`\\\\${St}\\${ct.slice(vt)}\\`;mt!==vt&&(rt=`\\\\${St}\\${ct.slice(vt,mt)}`,ot=mt)}}}else ot=1;else isWindowsDeviceRoot(gt)&&ct.charCodeAt(1)===CHAR_COLON&&(rt=ct.slice(0,2),ot=2,nt>2&&isPathSeparator$1(ct.charCodeAt(2))&&(ut=!0,ot=3));let pt=ot<nt?normalizeString(ct.slice(ot),!ut,"\\",isPathSeparator$1):"";return pt.length===0&&!ut&&(pt="."),pt.length>0&&isPathSeparator$1(ct.charCodeAt(nt-1))&&(pt+="\\"),rt===void 0?ut?`\\${pt}`:pt:ut?`${rt}\\${pt}`:`${rt}${pt}`},isAbsolute(ct){validateString(ct,"path");const nt=ct.length;if(nt===0)return!1;const ot=ct.charCodeAt(0);return isPathSeparator$1(ot)||nt>2&&isWindowsDeviceRoot(ot)&&ct.charCodeAt(1)===CHAR_COLON&&isPathSeparator$1(ct.charCodeAt(2))},join(...ct){if(ct.length===0)return".";let nt,ot;for(let gt=0;gt<ct.length;++gt){const pt=ct[gt];validateString(pt,"path"),pt.length>0&&(nt===void 0?nt=ot=pt:nt+=`\\${pt}`)}if(nt===void 0)return".";let rt=!0,ut=0;if(typeof ot=="string"&&isPathSeparator$1(ot.charCodeAt(0))){++ut;const gt=ot.length;gt>1&&isPathSeparator$1(ot.charCodeAt(1))&&(++ut,gt>2&&(isPathSeparator$1(ot.charCodeAt(2))?++ut:rt=!1))}if(rt){for(;ut<nt.length&&isPathSeparator$1(nt.charCodeAt(ut));)ut++;ut>=2&&(nt=`\\${nt.slice(ut)}`)}return win32.normalize(nt)},relative(ct,nt){if(validateString(ct,"from"),validateString(nt,"to"),ct===nt)return"";const ot=win32.resolve(ct),rt=win32.resolve(nt);if(ot===rt||(ct=ot.toLowerCase(),nt=rt.toLowerCase(),ct===nt))return"";let ut=0;for(;ut<ct.length&&ct.charCodeAt(ut)===CHAR_BACKWARD_SLASH;)ut++;let gt=ct.length;for(;gt-1>ut&&ct.charCodeAt(gt-1)===CHAR_BACKWARD_SLASH;)gt--;const pt=gt-ut;let mt=0;for(;mt<nt.length&&nt.charCodeAt(mt)===CHAR_BACKWARD_SLASH;)mt++;let vt=nt.length;for(;vt-1>mt&&nt.charCodeAt(vt-1)===CHAR_BACKWARD_SLASH;)vt--;const St=vt-mt,yt=pt<St?pt:St;let wt=-1,Lt=0;for(;Lt<yt;Lt++){const It=ct.charCodeAt(ut+Lt);if(It!==nt.charCodeAt(mt+Lt))break;It===CHAR_BACKWARD_SLASH&&(wt=Lt)}if(Lt!==yt){if(wt===-1)return rt}else{if(St>yt){if(nt.charCodeAt(mt+Lt)===CHAR_BACKWARD_SLASH)return rt.slice(mt+Lt+1);if(Lt===2)return rt.slice(mt+Lt)}pt>yt&&(ct.charCodeAt(ut+Lt)===CHAR_BACKWARD_SLASH?wt=Lt:Lt===2&&(wt=3)),wt===-1&&(wt=0)}let xt="";for(Lt=ut+wt+1;Lt<=gt;++Lt)(Lt===gt||ct.charCodeAt(Lt)===CHAR_BACKWARD_SLASH)&&(xt+=xt.length===0?"..":"\\..");return mt+=wt,xt.length>0?`${xt}${rt.slice(mt,vt)}`:(rt.charCodeAt(mt)===CHAR_BACKWARD_SLASH&&++mt,rt.slice(mt,vt))},toNamespacedPath(ct){if(typeof ct!="string"||ct.length===0)return ct;const nt=win32.resolve(ct);if(nt.length<=2)return ct;if(nt.charCodeAt(0)===CHAR_BACKWARD_SLASH){if(nt.charCodeAt(1)===CHAR_BACKWARD_SLASH){const ot=nt.charCodeAt(2);if(ot!==CHAR_QUESTION_MARK&&ot!==CHAR_DOT)return`\\\\?\\UNC\\${nt.slice(2)}`}}else if(isWindowsDeviceRoot(nt.charCodeAt(0))&&nt.charCodeAt(1)===CHAR_COLON&&nt.charCodeAt(2)===CHAR_BACKWARD_SLASH)return`\\\\?\\${nt}`;return ct},dirname(ct){validateString(ct,"path");const nt=ct.length;if(nt===0)return".";let ot=-1,rt=0;const ut=ct.charCodeAt(0);if(nt===1)return isPathSeparator$1(ut)?ct:".";if(isPathSeparator$1(ut)){if(ot=rt=1,isPathSeparator$1(ct.charCodeAt(1))){let mt=2,vt=mt;for(;mt<nt&&!isPathSeparator$1(ct.charCodeAt(mt));)mt++;if(mt<nt&&mt!==vt){for(vt=mt;mt<nt&&isPathSeparator$1(ct.charCodeAt(mt));)mt++;if(mt<nt&&mt!==vt){for(vt=mt;mt<nt&&!isPathSeparator$1(ct.charCodeAt(mt));)mt++;if(mt===nt)return ct;mt!==vt&&(ot=rt=mt+1)}}}}else isWindowsDeviceRoot(ut)&&ct.charCodeAt(1)===CHAR_COLON&&(ot=nt>2&&isPathSeparator$1(ct.charCodeAt(2))?3:2,rt=ot);let gt=-1,pt=!0;for(let mt=nt-1;mt>=rt;--mt)if(isPathSeparator$1(ct.charCodeAt(mt))){if(!pt){gt=mt;break}}else pt=!1;if(gt===-1){if(ot===-1)return".";gt=ot}return ct.slice(0,gt)},basename(ct,nt){nt!==void 0&&validateString(nt,"ext"),validateString(ct,"path");let ot=0,rt=-1,ut=!0,gt;if(ct.length>=2&&isWindowsDeviceRoot(ct.charCodeAt(0))&&ct.charCodeAt(1)===CHAR_COLON&&(ot=2),nt!==void 0&&nt.length>0&&nt.length<=ct.length){if(nt===ct)return"";let pt=nt.length-1,mt=-1;for(gt=ct.length-1;gt>=ot;--gt){const vt=ct.charCodeAt(gt);if(isPathSeparator$1(vt)){if(!ut){ot=gt+1;break}}else mt===-1&&(ut=!1,mt=gt+1),pt>=0&&(vt===nt.charCodeAt(pt)?--pt===-1&&(rt=gt):(pt=-1,rt=mt))}return ot===rt?rt=mt:rt===-1&&(rt=ct.length),ct.slice(ot,rt)}for(gt=ct.length-1;gt>=ot;--gt)if(isPathSeparator$1(ct.charCodeAt(gt))){if(!ut){ot=gt+1;break}}else rt===-1&&(ut=!1,rt=gt+1);return rt===-1?"":ct.slice(ot,rt)},extname(ct){validateString(ct,"path");let nt=0,ot=-1,rt=0,ut=-1,gt=!0,pt=0;ct.length>=2&&ct.charCodeAt(1)===CHAR_COLON&&isWindowsDeviceRoot(ct.charCodeAt(0))&&(nt=rt=2);for(let mt=ct.length-1;mt>=nt;--mt){const vt=ct.charCodeAt(mt);if(isPathSeparator$1(vt)){if(!gt){rt=mt+1;break}continue}ut===-1&&(gt=!1,ut=mt+1),vt===CHAR_DOT?ot===-1?ot=mt:pt!==1&&(pt=1):ot!==-1&&(pt=-1)}return ot===-1||ut===-1||pt===0||pt===1&&ot===ut-1&&ot===rt+1?"":ct.slice(ot,ut)},format:_format.bind(null,"\\"),parse(ct){validateString(ct,"path");const nt={root:"",dir:"",base:"",ext:"",name:""};if(ct.length===0)return nt;const ot=ct.length;let rt=0,ut=ct.charCodeAt(0);if(ot===1)return isPathSeparator$1(ut)?(nt.root=nt.dir=ct,nt):(nt.base=nt.name=ct,nt);if(isPathSeparator$1(ut)){if(rt=1,isPathSeparator$1(ct.charCodeAt(1))){let wt=2,Lt=wt;for(;wt<ot&&!isPathSeparator$1(ct.charCodeAt(wt));)wt++;if(wt<ot&&wt!==Lt){for(Lt=wt;wt<ot&&isPathSeparator$1(ct.charCodeAt(wt));)wt++;if(wt<ot&&wt!==Lt){for(Lt=wt;wt<ot&&!isPathSeparator$1(ct.charCodeAt(wt));)wt++;wt===ot?rt=wt:wt!==Lt&&(rt=wt+1)}}}}else if(isWindowsDeviceRoot(ut)&&ct.charCodeAt(1)===CHAR_COLON){if(ot<=2)return nt.root=nt.dir=ct,nt;if(rt=2,isPathSeparator$1(ct.charCodeAt(2))){if(ot===3)return nt.root=nt.dir=ct,nt;rt=3}}rt>0&&(nt.root=ct.slice(0,rt));let gt=-1,pt=rt,mt=-1,vt=!0,St=ct.length-1,yt=0;for(;St>=rt;--St){if(ut=ct.charCodeAt(St),isPathSeparator$1(ut)){if(!vt){pt=St+1;break}continue}mt===-1&&(vt=!1,mt=St+1),ut===CHAR_DOT?gt===-1?gt=St:yt!==1&&(yt=1):gt!==-1&&(yt=-1)}return mt!==-1&&(gt===-1||yt===0||yt===1&&gt===mt-1&&gt===pt+1?nt.base=nt.name=ct.slice(pt,mt):(nt.name=ct.slice(pt,gt),nt.base=ct.slice(pt,mt),nt.ext=ct.slice(gt,mt))),pt>0&&pt!==rt?nt.dir=ct.slice(0,pt-1):nt.dir=nt.root,nt},sep:"\\",delimiter:";",win32:null,posix:null},posixCwd=(()=>{if(platformIsWin32){const ct=/\\/g;return()=>{const nt=cwd().replace(ct,"/");return nt.slice(nt.indexOf("/"))}}return()=>cwd()})(),posix={resolve(...ct){let nt="",ot=!1;for(let rt=ct.length-1;rt>=-1&&!ot;rt--){const ut=rt>=0?ct[rt]:posixCwd();validateString(ut,"path"),ut.length!==0&&(nt=`${ut}/${nt}`,ot=ut.charCodeAt(0)===CHAR_FORWARD_SLASH)}return nt=normalizeString(nt,!ot,"/",isPosixPathSeparator),ot?`/${nt}`:nt.length>0?nt:"."},normalize(ct){if(validateString(ct,"path"),ct.length===0)return".";const nt=ct.charCodeAt(0)===CHAR_FORWARD_SLASH,ot=ct.charCodeAt(ct.length-1)===CHAR_FORWARD_SLASH;return ct=normalizeString(ct,!nt,"/",isPosixPathSeparator),ct.length===0?nt?"/":ot?"./":".":(ot&&(ct+="/"),nt?`/${ct}`:ct)},isAbsolute(ct){return validateString(ct,"path"),ct.length>0&&ct.charCodeAt(0)===CHAR_FORWARD_SLASH},join(...ct){if(ct.length===0)return".";let nt;for(let ot=0;ot<ct.length;++ot){const rt=ct[ot];validateString(rt,"path"),rt.length>0&&(nt===void 0?nt=rt:nt+=`/${rt}`)}return nt===void 0?".":posix.normalize(nt)},relative(ct,nt){if(validateString(ct,"from"),validateString(nt,"to"),ct===nt||(ct=posix.resolve(ct),nt=posix.resolve(nt),ct===nt))return"";const ot=1,rt=ct.length,ut=rt-ot,gt=1,pt=nt.length-gt,mt=ut<pt?ut:pt;let vt=-1,St=0;for(;St<mt;St++){const wt=ct.charCodeAt(ot+St);if(wt!==nt.charCodeAt(gt+St))break;wt===CHAR_FORWARD_SLASH&&(vt=St)}if(St===mt)if(pt>mt){if(nt.charCodeAt(gt+St)===CHAR_FORWARD_SLASH)return nt.slice(gt+St+1);if(St===0)return nt.slice(gt+St)}else ut>mt&&(ct.charCodeAt(ot+St)===CHAR_FORWARD_SLASH?vt=St:St===0&&(vt=0));let yt="";for(St=ot+vt+1;St<=rt;++St)(St===rt||ct.charCodeAt(St)===CHAR_FORWARD_SLASH)&&(yt+=yt.length===0?"..":"/..");return`${yt}${nt.slice(gt+vt)}`},toNamespacedPath(ct){return ct},dirname(ct){if(validateString(ct,"path"),ct.length===0)return".";const nt=ct.charCodeAt(0)===CHAR_FORWARD_SLASH;let ot=-1,rt=!0;for(let ut=ct.length-1;ut>=1;--ut)if(ct.charCodeAt(ut)===CHAR_FORWARD_SLASH){if(!rt){ot=ut;break}}else rt=!1;return ot===-1?nt?"/":".":nt&&ot===1?"//":ct.slice(0,ot)},basename(ct,nt){nt!==void 0&&validateString(nt,"ext"),validateString(ct,"path");let ot=0,rt=-1,ut=!0,gt;if(nt!==void 0&&nt.length>0&&nt.length<=ct.length){if(nt===ct)return"";let pt=nt.length-1,mt=-1;for(gt=ct.length-1;gt>=0;--gt){const vt=ct.charCodeAt(gt);if(vt===CHAR_FORWARD_SLASH){if(!ut){ot=gt+1;break}}else mt===-1&&(ut=!1,mt=gt+1),pt>=0&&(vt===nt.charCodeAt(pt)?--pt===-1&&(rt=gt):(pt=-1,rt=mt))}return ot===rt?rt=mt:rt===-1&&(rt=ct.length),ct.slice(ot,rt)}for(gt=ct.length-1;gt>=0;--gt)if(ct.charCodeAt(gt)===CHAR_FORWARD_SLASH){if(!ut){ot=gt+1;break}}else rt===-1&&(ut=!1,rt=gt+1);return rt===-1?"":ct.slice(ot,rt)},extname(ct){validateString(ct,"path");let nt=-1,ot=0,rt=-1,ut=!0,gt=0;for(let pt=ct.length-1;pt>=0;--pt){const mt=ct.charCodeAt(pt);if(mt===CHAR_FORWARD_SLASH){if(!ut){ot=pt+1;break}continue}rt===-1&&(ut=!1,rt=pt+1),mt===CHAR_DOT?nt===-1?nt=pt:gt!==1&&(gt=1):nt!==-1&&(gt=-1)}return nt===-1||rt===-1||gt===0||gt===1&&nt===rt-1&&nt===ot+1?"":ct.slice(nt,rt)},format:_format.bind(null,"/"),parse(ct){validateString(ct,"path");const nt={root:"",dir:"",base:"",ext:"",name:""};if(ct.length===0)return nt;const ot=ct.charCodeAt(0)===CHAR_FORWARD_SLASH;let rt;ot?(nt.root="/",rt=1):rt=0;let ut=-1,gt=0,pt=-1,mt=!0,vt=ct.length-1,St=0;for(;vt>=rt;--vt){const yt=ct.charCodeAt(vt);if(yt===CHAR_FORWARD_SLASH){if(!mt){gt=vt+1;break}continue}pt===-1&&(mt=!1,pt=vt+1),yt===CHAR_DOT?ut===-1?ut=vt:St!==1&&(St=1):ut!==-1&&(St=-1)}if(pt!==-1){const yt=gt===0&&ot?1:gt;ut===-1||St===0||St===1&&ut===pt-1&&ut===gt+1?nt.base=nt.name=ct.slice(yt,pt):(nt.name=ct.slice(yt,ut),nt.base=ct.slice(yt,pt),nt.ext=ct.slice(ut,pt))}return gt>0?nt.dir=ct.slice(0,gt-1):ot&&(nt.dir="/"),nt},sep:"/",delimiter:":",win32:null,posix:null};posix.win32=win32.win32=win32;posix.posix=win32.posix=posix;const normalize=platformIsWin32?win32.normalize:posix.normalize,resolve=platformIsWin32?win32.resolve:posix.resolve,relative=platformIsWin32?win32.relative:posix.relative,dirname$1=platformIsWin32?win32.dirname:posix.dirname,basename$1=platformIsWin32?win32.basename:posix.basename,extname$1=platformIsWin32?win32.extname:posix.extname,sep=platformIsWin32?win32.sep:posix.sep,_schemePattern=/^\w[\w\d+.-]*$/,_singleSlashStart=/^\//,_doubleSlashStart=/^\/\//;function _validateUri(ct,nt){if(!ct.scheme&&nt)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${ct.authority}", path: "${ct.path}", query: "${ct.query}", fragment: "${ct.fragment}"}`);if(ct.scheme&&!_schemePattern.test(ct.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(ct.path){if(ct.authority){if(!_singleSlashStart.test(ct.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(_doubleSlashStart.test(ct.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function _schemeFix(ct,nt){return!ct&&!nt?"file":ct}function _referenceResolution(ct,nt){switch(ct){case"https":case"http":case"file":nt?nt[0]!==_slash&&(nt=_slash+nt):nt=_slash;break}return nt}const _empty="",_slash="/",_regexp=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class URI{static isUri(nt){return nt instanceof URI?!0:nt?typeof nt.authority=="string"&&typeof nt.fragment=="string"&&typeof nt.path=="string"&&typeof nt.query=="string"&&typeof nt.scheme=="string"&&typeof nt.fsPath=="string"&&typeof nt.with=="function"&&typeof nt.toString=="function":!1}constructor(nt,ot,rt,ut,gt,pt=!1){typeof nt=="object"?(this.scheme=nt.scheme||_empty,this.authority=nt.authority||_empty,this.path=nt.path||_empty,this.query=nt.query||_empty,this.fragment=nt.fragment||_empty):(this.scheme=_schemeFix(nt,pt),this.authority=ot||_empty,this.path=_referenceResolution(this.scheme,rt||_empty),this.query=ut||_empty,this.fragment=gt||_empty,_validateUri(this,pt))}get fsPath(){return uriToFsPath(this,!1)}with(nt){if(!nt)return this;let{scheme:ot,authority:rt,path:ut,query:gt,fragment:pt}=nt;return ot===void 0?ot=this.scheme:ot===null&&(ot=_empty),rt===void 0?rt=this.authority:rt===null&&(rt=_empty),ut===void 0?ut=this.path:ut===null&&(ut=_empty),gt===void 0?gt=this.query:gt===null&&(gt=_empty),pt===void 0?pt=this.fragment:pt===null&&(pt=_empty),ot===this.scheme&&rt===this.authority&&ut===this.path&&gt===this.query&&pt===this.fragment?this:new Uri$1(ot,rt,ut,gt,pt)}static parse(nt,ot=!1){const rt=_regexp.exec(nt);return rt?new Uri$1(rt[2]||_empty,percentDecode(rt[4]||_empty),percentDecode(rt[5]||_empty),percentDecode(rt[7]||_empty),percentDecode(rt[9]||_empty),ot):new Uri$1(_empty,_empty,_empty,_empty,_empty)}static file(nt){let ot=_empty;if(isWindows&&(nt=nt.replace(/\\/g,_slash)),nt[0]===_slash&&nt[1]===_slash){const rt=nt.indexOf(_slash,2);rt===-1?(ot=nt.substring(2),nt=_slash):(ot=nt.substring(2,rt),nt=nt.substring(rt)||_slash)}return new Uri$1("file",ot,nt,_empty,_empty)}static from(nt){const ot=new Uri$1(nt.scheme,nt.authority,nt.path,nt.query,nt.fragment);return _validateUri(ot,!0),ot}static joinPath(nt,...ot){if(!nt.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let rt;return isWindows&&nt.scheme==="file"?rt=URI.file(win32.join(uriToFsPath(nt,!0),...ot)).path:rt=posix.join(nt.path,...ot),nt.with({path:rt})}toString(nt=!1){return _asFormatted(this,nt)}toJSON(){return this}static revive(nt){if(nt){if(nt instanceof URI)return nt;{const ot=new Uri$1(nt);return ot._formatted=nt.external,ot._fsPath=nt._sep===_pathSepMarker?nt.fsPath:null,ot}}else return nt}}const _pathSepMarker=isWindows?1:void 0;let Uri$1=class extends URI{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=uriToFsPath(this,!1)),this._fsPath}toString(nt=!1){return nt?_asFormatted(this,!0):(this._formatted||(this._formatted=_asFormatted(this,!1)),this._formatted)}toJSON(){const nt={$mid:1};return this._fsPath&&(nt.fsPath=this._fsPath,nt._sep=_pathSepMarker),this._formatted&&(nt.external=this._formatted),this.path&&(nt.path=this.path),this.scheme&&(nt.scheme=this.scheme),this.authority&&(nt.authority=this.authority),this.query&&(nt.query=this.query),this.fragment&&(nt.fragment=this.fragment),nt}};const encodeTable={[58]:"%3A",[47]:"%2F",[63]:"%3F",[35]:"%23",[91]:"%5B",[93]:"%5D",[64]:"%40",[33]:"%21",[36]:"%24",[38]:"%26",[39]:"%27",[40]:"%28",[41]:"%29",[42]:"%2A",[43]:"%2B",[44]:"%2C",[59]:"%3B",[61]:"%3D",[32]:"%20"};function encodeURIComponentFast(ct,nt,ot){let rt,ut=-1;for(let gt=0;gt<ct.length;gt++){const pt=ct.charCodeAt(gt);if(pt>=97&&pt<=122||pt>=65&&pt<=90||pt>=48&&pt<=57||pt===45||pt===46||pt===95||pt===126||nt&&pt===47||ot&&pt===91||ot&&pt===93||ot&&pt===58)ut!==-1&&(rt+=encodeURIComponent(ct.substring(ut,gt)),ut=-1),rt!==void 0&&(rt+=ct.charAt(gt));else{rt===void 0&&(rt=ct.substr(0,gt));const mt=encodeTable[pt];mt!==void 0?(ut!==-1&&(rt+=encodeURIComponent(ct.substring(ut,gt)),ut=-1),rt+=mt):ut===-1&&(ut=gt)}}return ut!==-1&&(rt+=encodeURIComponent(ct.substring(ut))),rt!==void 0?rt:ct}function encodeURIComponentMinimal(ct){let nt;for(let ot=0;ot<ct.length;ot++){const rt=ct.charCodeAt(ot);rt===35||rt===63?(nt===void 0&&(nt=ct.substr(0,ot)),nt+=encodeTable[rt]):nt!==void 0&&(nt+=ct[ot])}return nt!==void 0?nt:ct}function uriToFsPath(ct,nt){let ot;return ct.authority&&ct.path.length>1&&ct.scheme==="file"?ot=`//${ct.authority}${ct.path}`:ct.path.charCodeAt(0)===47&&(ct.path.charCodeAt(1)>=65&&ct.path.charCodeAt(1)<=90||ct.path.charCodeAt(1)>=97&&ct.path.charCodeAt(1)<=122)&&ct.path.charCodeAt(2)===58?nt?ot=ct.path.substr(1):ot=ct.path[1].toLowerCase()+ct.path.substr(2):ot=ct.path,isWindows&&(ot=ot.replace(/\//g,"\\")),ot}function _asFormatted(ct,nt){const ot=nt?encodeURIComponentMinimal:encodeURIComponentFast;let rt="",{scheme:ut,authority:gt,path:pt,query:mt,fragment:vt}=ct;if(ut&&(rt+=ut,rt+=":"),(gt||ut==="file")&&(rt+=_slash,rt+=_slash),gt){let St=gt.indexOf("@");if(St!==-1){const yt=gt.substr(0,St);gt=gt.substr(St+1),St=yt.lastIndexOf(":"),St===-1?rt+=ot(yt,!1,!1):(rt+=ot(yt.substr(0,St),!1,!1),rt+=":",rt+=ot(yt.substr(St+1),!1,!0)),rt+="@"}gt=gt.toLowerCase(),St=gt.lastIndexOf(":"),St===-1?rt+=ot(gt,!1,!0):(rt+=ot(gt.substr(0,St),!1,!0),rt+=gt.substr(St))}if(pt){if(pt.length>=3&&pt.charCodeAt(0)===47&&pt.charCodeAt(2)===58){const St=pt.charCodeAt(1);St>=65&&St<=90&&(pt=`/${String.fromCharCode(St+32)}:${pt.substr(3)}`)}else if(pt.length>=2&&pt.charCodeAt(1)===58){const St=pt.charCodeAt(0);St>=65&&St<=90&&(pt=`${String.fromCharCode(St+32)}:${pt.substr(2)}`)}rt+=ot(pt,!0,!1)}return mt&&(rt+="?",rt+=ot(mt,!1,!1)),vt&&(rt+="#",rt+=nt?vt:encodeURIComponentFast(vt,!1,!1)),rt}function decodeURIComponentGraceful(ct){try{return decodeURIComponent(ct)}catch{return ct.length>3?ct.substr(0,3)+decodeURIComponentGraceful(ct.substr(3)):ct}}const _rEncodedAsHex=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function percentDecode(ct){return ct.match(_rEncodedAsHex)?ct.replace(_rEncodedAsHex,nt=>decodeURIComponentGraceful(nt)):ct}let Position$1=class go{constructor(nt,ot){this.lineNumber=nt,this.column=ot}with(nt=this.lineNumber,ot=this.column){return nt===this.lineNumber&&ot===this.column?this:new go(nt,ot)}delta(nt=0,ot=0){return this.with(this.lineNumber+nt,this.column+ot)}equals(nt){return go.equals(this,nt)}static equals(nt,ot){return!nt&&!ot?!0:!!nt&&!!ot&&nt.lineNumber===ot.lineNumber&&nt.column===ot.column}isBefore(nt){return go.isBefore(this,nt)}static isBefore(nt,ot){return nt.lineNumber<ot.lineNumber?!0:ot.lineNumber<nt.lineNumber?!1:nt.column<ot.column}isBeforeOrEqual(nt){return go.isBeforeOrEqual(this,nt)}static isBeforeOrEqual(nt,ot){return nt.lineNumber<ot.lineNumber?!0:ot.lineNumber<nt.lineNumber?!1:nt.column<=ot.column}static compare(nt,ot){const rt=nt.lineNumber|0,ut=ot.lineNumber|0;if(rt===ut){const gt=nt.column|0,pt=ot.column|0;return gt-pt}return rt-ut}clone(){return new go(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(nt){return new go(nt.lineNumber,nt.column)}static isIPosition(nt){return nt&&typeof nt.lineNumber=="number"&&typeof nt.column=="number"}},Range$2=class Hn{constructor(nt,ot,rt,ut){nt>rt||nt===rt&&ot>ut?(this.startLineNumber=rt,this.startColumn=ut,this.endLineNumber=nt,this.endColumn=ot):(this.startLineNumber=nt,this.startColumn=ot,this.endLineNumber=rt,this.endColumn=ut)}isEmpty(){return Hn.isEmpty(this)}static isEmpty(nt){return nt.startLineNumber===nt.endLineNumber&&nt.startColumn===nt.endColumn}containsPosition(nt){return Hn.containsPosition(this,nt)}static containsPosition(nt,ot){return!(ot.lineNumber<nt.startLineNumber||ot.lineNumber>nt.endLineNumber||ot.lineNumber===nt.startLineNumber&&ot.column<nt.startColumn||ot.lineNumber===nt.endLineNumber&&ot.column>nt.endColumn)}static strictContainsPosition(nt,ot){return!(ot.lineNumber<nt.startLineNumber||ot.lineNumber>nt.endLineNumber||ot.lineNumber===nt.startLineNumber&&ot.column<=nt.startColumn||ot.lineNumber===nt.endLineNumber&&ot.column>=nt.endColumn)}containsRange(nt){return Hn.containsRange(this,nt)}static containsRange(nt,ot){return!(ot.startLineNumber<nt.startLineNumber||ot.endLineNumber<nt.startLineNumber||ot.startLineNumber>nt.endLineNumber||ot.endLineNumber>nt.endLineNumber||ot.startLineNumber===nt.startLineNumber&&ot.startColumn<nt.startColumn||ot.endLineNumber===nt.endLineNumber&&ot.endColumn>nt.endColumn)}strictContainsRange(nt){return Hn.strictContainsRange(this,nt)}static strictContainsRange(nt,ot){return!(ot.startLineNumber<nt.startLineNumber||ot.endLineNumber<nt.startLineNumber||ot.startLineNumber>nt.endLineNumber||ot.endLineNumber>nt.endLineNumber||ot.startLineNumber===nt.startLineNumber&&ot.startColumn<=nt.startColumn||ot.endLineNumber===nt.endLineNumber&&ot.endColumn>=nt.endColumn)}plusRange(nt){return Hn.plusRange(this,nt)}static plusRange(nt,ot){let rt,ut,gt,pt;return ot.startLineNumber<nt.startLineNumber?(rt=ot.startLineNumber,ut=ot.startColumn):ot.startLineNumber===nt.startLineNumber?(rt=ot.startLineNumber,ut=Math.min(ot.startColumn,nt.startColumn)):(rt=nt.startLineNumber,ut=nt.startColumn),ot.endLineNumber>nt.endLineNumber?(gt=ot.endLineNumber,pt=ot.endColumn):ot.endLineNumber===nt.endLineNumber?(gt=ot.endLineNumber,pt=Math.max(ot.endColumn,nt.endColumn)):(gt=nt.endLineNumber,pt=nt.endColumn),new Hn(rt,ut,gt,pt)}intersectRanges(nt){return Hn.intersectRanges(this,nt)}static intersectRanges(nt,ot){let rt=nt.startLineNumber,ut=nt.startColumn,gt=nt.endLineNumber,pt=nt.endColumn;const mt=ot.startLineNumber,vt=ot.startColumn,St=ot.endLineNumber,yt=ot.endColumn;return rt<mt?(rt=mt,ut=vt):rt===mt&&(ut=Math.max(ut,vt)),gt>St?(gt=St,pt=yt):gt===St&&(pt=Math.min(pt,yt)),rt>gt||rt===gt&&ut>pt?null:new Hn(rt,ut,gt,pt)}equalsRange(nt){return Hn.equalsRange(this,nt)}static equalsRange(nt,ot){return!nt&&!ot?!0:!!nt&&!!ot&&nt.startLineNumber===ot.startLineNumber&&nt.startColumn===ot.startColumn&&nt.endLineNumber===ot.endLineNumber&&nt.endColumn===ot.endColumn}getEndPosition(){return Hn.getEndPosition(this)}static getEndPosition(nt){return new Position$1(nt.endLineNumber,nt.endColumn)}getStartPosition(){return Hn.getStartPosition(this)}static getStartPosition(nt){return new Position$1(nt.startLineNumber,nt.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(nt,ot){return new Hn(this.startLineNumber,this.startColumn,nt,ot)}setStartPosition(nt,ot){return new Hn(nt,ot,this.endLineNumber,this.endColumn)}collapseToStart(){return Hn.collapseToStart(this)}static collapseToStart(nt){return new Hn(nt.startLineNumber,nt.startColumn,nt.startLineNumber,nt.startColumn)}collapseToEnd(){return Hn.collapseToEnd(this)}static collapseToEnd(nt){return new Hn(nt.endLineNumber,nt.endColumn,nt.endLineNumber,nt.endColumn)}delta(nt){return new Hn(this.startLineNumber+nt,this.startColumn,this.endLineNumber+nt,this.endColumn)}static fromPositions(nt,ot=nt){return new Hn(nt.lineNumber,nt.column,ot.lineNumber,ot.column)}static lift(nt){return nt?new Hn(nt.startLineNumber,nt.startColumn,nt.endLineNumber,nt.endColumn):null}static isIRange(nt){return nt&&typeof nt.startLineNumber=="number"&&typeof nt.startColumn=="number"&&typeof nt.endLineNumber=="number"&&typeof nt.endColumn=="number"}static areIntersectingOrTouching(nt,ot){return!(nt.endLineNumber<ot.startLineNumber||nt.endLineNumber===ot.startLineNumber&&nt.endColumn<ot.startColumn||ot.endLineNumber<nt.startLineNumber||ot.endLineNumber===nt.startLineNumber&&ot.endColumn<nt.startColumn)}static areIntersecting(nt,ot){return!(nt.endLineNumber<ot.startLineNumber||nt.endLineNumber===ot.startLineNumber&&nt.endColumn<=ot.startColumn||ot.endLineNumber<nt.startLineNumber||ot.endLineNumber===nt.startLineNumber&&ot.endColumn<=nt.startColumn)}static compareRangesUsingStarts(nt,ot){if(nt&&ot){const gt=nt.startLineNumber|0,pt=ot.startLineNumber|0;if(gt===pt){const mt=nt.startColumn|0,vt=ot.startColumn|0;if(mt===vt){const St=nt.endLineNumber|0,yt=ot.endLineNumber|0;if(St===yt){const wt=nt.endColumn|0,Lt=ot.endColumn|0;return wt-Lt}return St-yt}return mt-vt}return gt-pt}return(nt?1:0)-(ot?1:0)}static compareRangesUsingEnds(nt,ot){return nt.endLineNumber===ot.endLineNumber?nt.endColumn===ot.endColumn?nt.startLineNumber===ot.startLineNumber?nt.startColumn-ot.startColumn:nt.startLineNumber-ot.startLineNumber:nt.endColumn-ot.endColumn:nt.endLineNumber-ot.endLineNumber}static spansMultipleLines(nt){return nt.endLineNumber>nt.startLineNumber}toJSON(){return this}},Selection$1=class no extends Range$2{constructor(nt,ot,rt,ut){super(nt,ot,rt,ut),this.selectionStartLineNumber=nt,this.selectionStartColumn=ot,this.positionLineNumber=rt,this.positionColumn=ut}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(nt){return no.selectionsEqual(this,nt)}static selectionsEqual(nt,ot){return nt.selectionStartLineNumber===ot.selectionStartLineNumber&&nt.selectionStartColumn===ot.selectionStartColumn&&nt.positionLineNumber===ot.positionLineNumber&&nt.positionColumn===ot.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(nt,ot){return this.getDirection()===0?new no(this.startLineNumber,this.startColumn,nt,ot):new no(nt,ot,this.startLineNumber,this.startColumn)}getPosition(){return new Position$1(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new Position$1(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(nt,ot){return this.getDirection()===0?new no(nt,ot,this.endLineNumber,this.endColumn):new no(this.endLineNumber,this.endColumn,nt,ot)}static fromPositions(nt,ot=nt){return new no(nt.lineNumber,nt.column,ot.lineNumber,ot.column)}static fromRange(nt,ot){return ot===0?new no(nt.startLineNumber,nt.startColumn,nt.endLineNumber,nt.endColumn):new no(nt.endLineNumber,nt.endColumn,nt.startLineNumber,nt.startColumn)}static liftSelection(nt){return new no(nt.selectionStartLineNumber,nt.selectionStartColumn,nt.positionLineNumber,nt.positionColumn)}static selectionsArrEqual(nt,ot){if(nt&&!ot||!nt&&ot)return!1;if(!nt&&!ot)return!0;if(nt.length!==ot.length)return!1;for(let rt=0,ut=nt.length;rt<ut;rt++)if(!this.selectionsEqual(nt[rt],ot[rt]))return!1;return!0}static isISelection(nt){return nt&&typeof nt.selectionStartLineNumber=="number"&&typeof nt.selectionStartColumn=="number"&&typeof nt.positionLineNumber=="number"&&typeof nt.positionColumn=="number"}static createWithDirection(nt,ot,rt,ut,gt){return gt===0?new no(nt,ot,rt,ut):new no(rt,ut,nt,ot)}};const _codiconFontCharacters=Object.create(null);function register$1(ct,nt){if(isString$1(nt)){const ot=_codiconFontCharacters[nt];if(ot===void 0)throw new Error(`${ct} references an unknown codicon: ${nt}`);nt=ot}return _codiconFontCharacters[ct]=nt,{id:ct}}function getCodiconFontCharacters(){return _codiconFontCharacters}const Codicon={add:register$1("add",6e4),plus:register$1("plus",6e4),gistNew:register$1("gist-new",6e4),repoCreate:register$1("repo-create",6e4),lightbulb:register$1("lightbulb",60001),lightBulb:register$1("light-bulb",60001),repo:register$1("repo",60002),repoDelete:register$1("repo-delete",60002),gistFork:register$1("gist-fork",60003),repoForked:register$1("repo-forked",60003),gitPullRequest:register$1("git-pull-request",60004),gitPullRequestAbandoned:register$1("git-pull-request-abandoned",60004),recordKeys:register$1("record-keys",60005),keyboard:register$1("keyboard",60005),tag:register$1("tag",60006),tagAdd:register$1("tag-add",60006),tagRemove:register$1("tag-remove",60006),person:register$1("person",60007),personFollow:register$1("person-follow",60007),personOutline:register$1("person-outline",60007),personFilled:register$1("person-filled",60007),gitBranch:register$1("git-branch",60008),gitBranchCreate:register$1("git-branch-create",60008),gitBranchDelete:register$1("git-branch-delete",60008),sourceControl:register$1("source-control",60008),mirror:register$1("mirror",60009),mirrorPublic:register$1("mirror-public",60009),star:register$1("star",60010),starAdd:register$1("star-add",60010),starDelete:register$1("star-delete",60010),starEmpty:register$1("star-empty",60010),comment:register$1("comment",60011),commentAdd:register$1("comment-add",60011),alert:register$1("alert",60012),warning:register$1("warning",60012),search:register$1("search",60013),searchSave:register$1("search-save",60013),logOut:register$1("log-out",60014),signOut:register$1("sign-out",60014),logIn:register$1("log-in",60015),signIn:register$1("sign-in",60015),eye:register$1("eye",60016),eyeUnwatch:register$1("eye-unwatch",60016),eyeWatch:register$1("eye-watch",60016),circleFilled:register$1("circle-filled",60017),primitiveDot:register$1("primitive-dot",60017),closeDirty:register$1("close-dirty",60017),debugBreakpoint:register$1("debug-breakpoint",60017),debugBreakpointDisabled:register$1("debug-breakpoint-disabled",60017),debugHint:register$1("debug-hint",60017),primitiveSquare:register$1("primitive-square",60018),edit:register$1("edit",60019),pencil:register$1("pencil",60019),info:register$1("info",60020),issueOpened:register$1("issue-opened",60020),gistPrivate:register$1("gist-private",60021),gitForkPrivate:register$1("git-fork-private",60021),lock:register$1("lock",60021),mirrorPrivate:register$1("mirror-private",60021),close:register$1("close",60022),removeClose:register$1("remove-close",60022),x:register$1("x",60022),repoSync:register$1("repo-sync",60023),sync:register$1("sync",60023),clone:register$1("clone",60024),desktopDownload:register$1("desktop-download",60024),beaker:register$1("beaker",60025),microscope:register$1("microscope",60025),vm:register$1("vm",60026),deviceDesktop:register$1("device-desktop",60026),file:register$1("file",60027),fileText:register$1("file-text",60027),more:register$1("more",60028),ellipsis:register$1("ellipsis",60028),kebabHorizontal:register$1("kebab-horizontal",60028),mailReply:register$1("mail-reply",60029),reply:register$1("reply",60029),organization:register$1("organization",60030),organizationFilled:register$1("organization-filled",60030),organizationOutline:register$1("organization-outline",60030),newFile:register$1("new-file",60031),fileAdd:register$1("file-add",60031),newFolder:register$1("new-folder",60032),fileDirectoryCreate:register$1("file-directory-create",60032),trash:register$1("trash",60033),trashcan:register$1("trashcan",60033),history:register$1("history",60034),clock:register$1("clock",60034),folder:register$1("folder",60035),fileDirectory:register$1("file-directory",60035),symbolFolder:register$1("symbol-folder",60035),logoGithub:register$1("logo-github",60036),markGithub:register$1("mark-github",60036),github:register$1("github",60036),terminal:register$1("terminal",60037),console:register$1("console",60037),repl:register$1("repl",60037),zap:register$1("zap",60038),symbolEvent:register$1("symbol-event",60038),error:register$1("error",60039),stop:register$1("stop",60039),variable:register$1("variable",60040),symbolVariable:register$1("symbol-variable",60040),array:register$1("array",60042),symbolArray:register$1("symbol-array",60042),symbolModule:register$1("symbol-module",60043),symbolPackage:register$1("symbol-package",60043),symbolNamespace:register$1("symbol-namespace",60043),symbolObject:register$1("symbol-object",60043),symbolMethod:register$1("symbol-method",60044),symbolFunction:register$1("symbol-function",60044),symbolConstructor:register$1("symbol-constructor",60044),symbolBoolean:register$1("symbol-boolean",60047),symbolNull:register$1("symbol-null",60047),symbolNumeric:register$1("symbol-numeric",60048),symbolNumber:register$1("symbol-number",60048),symbolStructure:register$1("symbol-structure",60049),symbolStruct:register$1("symbol-struct",60049),symbolParameter:register$1("symbol-parameter",60050),symbolTypeParameter:register$1("symbol-type-parameter",60050),symbolKey:register$1("symbol-key",60051),symbolText:register$1("symbol-text",60051),symbolReference:register$1("symbol-reference",60052),goToFile:register$1("go-to-file",60052),symbolEnum:register$1("symbol-enum",60053),symbolValue:register$1("symbol-value",60053),symbolRuler:register$1("symbol-ruler",60054),symbolUnit:register$1("symbol-unit",60054),activateBreakpoints:register$1("activate-breakpoints",60055),archive:register$1("archive",60056),arrowBoth:register$1("arrow-both",60057),arrowDown:register$1("arrow-down",60058),arrowLeft:register$1("arrow-left",60059),arrowRight:register$1("arrow-right",60060),arrowSmallDown:register$1("arrow-small-down",60061),arrowSmallLeft:register$1("arrow-small-left",60062),arrowSmallRight:register$1("arrow-small-right",60063),arrowSmallUp:register$1("arrow-small-up",60064),arrowUp:register$1("arrow-up",60065),bell:register$1("bell",60066),bold:register$1("bold",60067),book:register$1("book",60068),bookmark:register$1("bookmark",60069),debugBreakpointConditionalUnverified:register$1("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:register$1("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:register$1("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:register$1("debug-breakpoint-data-unverified",60072),debugBreakpointData:register$1("debug-breakpoint-data",60073),debugBreakpointDataDisabled:register$1("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:register$1("debug-breakpoint-log-unverified",60074),debugBreakpointLog:register$1("debug-breakpoint-log",60075),debugBreakpointLogDisabled:register$1("debug-breakpoint-log-disabled",60075),briefcase:register$1("briefcase",60076),broadcast:register$1("broadcast",60077),browser:register$1("browser",60078),bug:register$1("bug",60079),calendar:register$1("calendar",60080),caseSensitive:register$1("case-sensitive",60081),check:register$1("check",60082),checklist:register$1("checklist",60083),chevronDown:register$1("chevron-down",60084),dropDownButton:register$1("drop-down-button",60084),chevronLeft:register$1("chevron-left",60085),chevronRight:register$1("chevron-right",60086),chevronUp:register$1("chevron-up",60087),chromeClose:register$1("chrome-close",60088),chromeMaximize:register$1("chrome-maximize",60089),chromeMinimize:register$1("chrome-minimize",60090),chromeRestore:register$1("chrome-restore",60091),circle:register$1("circle",60092),circleOutline:register$1("circle-outline",60092),debugBreakpointUnverified:register$1("debug-breakpoint-unverified",60092),circleSlash:register$1("circle-slash",60093),circuitBoard:register$1("circuit-board",60094),clearAll:register$1("clear-all",60095),clippy:register$1("clippy",60096),closeAll:register$1("close-all",60097),cloudDownload:register$1("cloud-download",60098),cloudUpload:register$1("cloud-upload",60099),code:register$1("code",60100),collapseAll:register$1("collapse-all",60101),colorMode:register$1("color-mode",60102),commentDiscussion:register$1("comment-discussion",60103),compareChanges:register$1("compare-changes",60157),creditCard:register$1("credit-card",60105),dash:register$1("dash",60108),dashboard:register$1("dashboard",60109),database:register$1("database",60110),debugContinue:register$1("debug-continue",60111),debugDisconnect:register$1("debug-disconnect",60112),debugPause:register$1("debug-pause",60113),debugRestart:register$1("debug-restart",60114),debugStart:register$1("debug-start",60115),debugStepInto:register$1("debug-step-into",60116),debugStepOut:register$1("debug-step-out",60117),debugStepOver:register$1("debug-step-over",60118),debugStop:register$1("debug-stop",60119),debug:register$1("debug",60120),deviceCameraVideo:register$1("device-camera-video",60121),deviceCamera:register$1("device-camera",60122),deviceMobile:register$1("device-mobile",60123),diffAdded:register$1("diff-added",60124),diffIgnored:register$1("diff-ignored",60125),diffModified:register$1("diff-modified",60126),diffRemoved:register$1("diff-removed",60127),diffRenamed:register$1("diff-renamed",60128),diff:register$1("diff",60129),discard:register$1("discard",60130),editorLayout:register$1("editor-layout",60131),emptyWindow:register$1("empty-window",60132),exclude:register$1("exclude",60133),extensions:register$1("extensions",60134),eyeClosed:register$1("eye-closed",60135),fileBinary:register$1("file-binary",60136),fileCode:register$1("file-code",60137),fileMedia:register$1("file-media",60138),filePdf:register$1("file-pdf",60139),fileSubmodule:register$1("file-submodule",60140),fileSymlinkDirectory:register$1("file-symlink-directory",60141),fileSymlinkFile:register$1("file-symlink-file",60142),fileZip:register$1("file-zip",60143),files:register$1("files",60144),filter:register$1("filter",60145),flame:register$1("flame",60146),foldDown:register$1("fold-down",60147),foldUp:register$1("fold-up",60148),fold:register$1("fold",60149),folderActive:register$1("folder-active",60150),folderOpened:register$1("folder-opened",60151),gear:register$1("gear",60152),gift:register$1("gift",60153),gistSecret:register$1("gist-secret",60154),gist:register$1("gist",60155),gitCommit:register$1("git-commit",60156),gitCompare:register$1("git-compare",60157),gitMerge:register$1("git-merge",60158),githubAction:register$1("github-action",60159),githubAlt:register$1("github-alt",60160),globe:register$1("globe",60161),grabber:register$1("grabber",60162),graph:register$1("graph",60163),gripper:register$1("gripper",60164),heart:register$1("heart",60165),home:register$1("home",60166),horizontalRule:register$1("horizontal-rule",60167),hubot:register$1("hubot",60168),inbox:register$1("inbox",60169),issueClosed:register$1("issue-closed",60324),issueReopened:register$1("issue-reopened",60171),issues:register$1("issues",60172),italic:register$1("italic",60173),jersey:register$1("jersey",60174),json:register$1("json",60175),bracket:register$1("bracket",60175),kebabVertical:register$1("kebab-vertical",60176),key:register$1("key",60177),law:register$1("law",60178),lightbulbAutofix:register$1("lightbulb-autofix",60179),linkExternal:register$1("link-external",60180),link:register$1("link",60181),listOrdered:register$1("list-ordered",60182),listUnordered:register$1("list-unordered",60183),liveShare:register$1("live-share",60184),loading:register$1("loading",60185),location:register$1("location",60186),mailRead:register$1("mail-read",60187),mail:register$1("mail",60188),markdown:register$1("markdown",60189),megaphone:register$1("megaphone",60190),mention:register$1("mention",60191),milestone:register$1("milestone",60192),mortarBoard:register$1("mortar-board",60193),move:register$1("move",60194),multipleWindows:register$1("multiple-windows",60195),mute:register$1("mute",60196),noNewline:register$1("no-newline",60197),note:register$1("note",60198),octoface:register$1("octoface",60199),openPreview:register$1("open-preview",60200),package_:register$1("package",60201),paintcan:register$1("paintcan",60202),pin:register$1("pin",60203),play:register$1("play",60204),run:register$1("run",60204),plug:register$1("plug",60205),preserveCase:register$1("preserve-case",60206),preview:register$1("preview",60207),project:register$1("project",60208),pulse:register$1("pulse",60209),question:register$1("question",60210),quote:register$1("quote",60211),radioTower:register$1("radio-tower",60212),reactions:register$1("reactions",60213),references:register$1("references",60214),refresh:register$1("refresh",60215),regex:register$1("regex",60216),remoteExplorer:register$1("remote-explorer",60217),remote:register$1("remote",60218),remove:register$1("remove",60219),replaceAll:register$1("replace-all",60220),replace:register$1("replace",60221),repoClone:register$1("repo-clone",60222),repoForcePush:register$1("repo-force-push",60223),repoPull:register$1("repo-pull",60224),repoPush:register$1("repo-push",60225),report:register$1("report",60226),requestChanges:register$1("request-changes",60227),rocket:register$1("rocket",60228),rootFolderOpened:register$1("root-folder-opened",60229),rootFolder:register$1("root-folder",60230),rss:register$1("rss",60231),ruby:register$1("ruby",60232),saveAll:register$1("save-all",60233),saveAs:register$1("save-as",60234),save:register$1("save",60235),screenFull:register$1("screen-full",60236),screenNormal:register$1("screen-normal",60237),searchStop:register$1("search-stop",60238),server:register$1("server",60240),settingsGear:register$1("settings-gear",60241),settings:register$1("settings",60242),shield:register$1("shield",60243),smiley:register$1("smiley",60244),sortPrecedence:register$1("sort-precedence",60245),splitHorizontal:register$1("split-horizontal",60246),splitVertical:register$1("split-vertical",60247),squirrel:register$1("squirrel",60248),starFull:register$1("star-full",60249),starHalf:register$1("star-half",60250),symbolClass:register$1("symbol-class",60251),symbolColor:register$1("symbol-color",60252),symbolCustomColor:register$1("symbol-customcolor",60252),symbolConstant:register$1("symbol-constant",60253),symbolEnumMember:register$1("symbol-enum-member",60254),symbolField:register$1("symbol-field",60255),symbolFile:register$1("symbol-file",60256),symbolInterface:register$1("symbol-interface",60257),symbolKeyword:register$1("symbol-keyword",60258),symbolMisc:register$1("symbol-misc",60259),symbolOperator:register$1("symbol-operator",60260),symbolProperty:register$1("symbol-property",60261),wrench:register$1("wrench",60261),wrenchSubaction:register$1("wrench-subaction",60261),symbolSnippet:register$1("symbol-snippet",60262),tasklist:register$1("tasklist",60263),telescope:register$1("telescope",60264),textSize:register$1("text-size",60265),threeBars:register$1("three-bars",60266),thumbsdown:register$1("thumbsdown",60267),thumbsup:register$1("thumbsup",60268),tools:register$1("tools",60269),triangleDown:register$1("triangle-down",60270),triangleLeft:register$1("triangle-left",60271),triangleRight:register$1("triangle-right",60272),triangleUp:register$1("triangle-up",60273),twitter:register$1("twitter",60274),unfold:register$1("unfold",60275),unlock:register$1("unlock",60276),unmute:register$1("unmute",60277),unverified:register$1("unverified",60278),verified:register$1("verified",60279),versions:register$1("versions",60280),vmActive:register$1("vm-active",60281),vmOutline:register$1("vm-outline",60282),vmRunning:register$1("vm-running",60283),watch:register$1("watch",60284),whitespace:register$1("whitespace",60285),wholeWord:register$1("whole-word",60286),window:register$1("window",60287),wordWrap:register$1("word-wrap",60288),zoomIn:register$1("zoom-in",60289),zoomOut:register$1("zoom-out",60290),listFilter:register$1("list-filter",60291),listFlat:register$1("list-flat",60292),listSelection:register$1("list-selection",60293),selection:register$1("selection",60293),listTree:register$1("list-tree",60294),debugBreakpointFunctionUnverified:register$1("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:register$1("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:register$1("debug-breakpoint-function-disabled",60296),debugStackframeActive:register$1("debug-stackframe-active",60297),circleSmallFilled:register$1("circle-small-filled",60298),debugStackframeDot:register$1("debug-stackframe-dot",60298),debugStackframe:register$1("debug-stackframe",60299),debugStackframeFocused:register$1("debug-stackframe-focused",60299),debugBreakpointUnsupported:register$1("debug-breakpoint-unsupported",60300),symbolString:register$1("symbol-string",60301),debugReverseContinue:register$1("debug-reverse-continue",60302),debugStepBack:register$1("debug-step-back",60303),debugRestartFrame:register$1("debug-restart-frame",60304),callIncoming:register$1("call-incoming",60306),callOutgoing:register$1("call-outgoing",60307),menu:register$1("menu",60308),expandAll:register$1("expand-all",60309),feedback:register$1("feedback",60310),groupByRefType:register$1("group-by-ref-type",60311),ungroupByRefType:register$1("ungroup-by-ref-type",60312),account:register$1("account",60313),bellDot:register$1("bell-dot",60314),debugConsole:register$1("debug-console",60315),library:register$1("library",60316),output:register$1("output",60317),runAll:register$1("run-all",60318),syncIgnored:register$1("sync-ignored",60319),pinned:register$1("pinned",60320),githubInverted:register$1("github-inverted",60321),debugAlt:register$1("debug-alt",60305),serverProcess:register$1("server-process",60322),serverEnvironment:register$1("server-environment",60323),pass:register$1("pass",60324),stopCircle:register$1("stop-circle",60325),playCircle:register$1("play-circle",60326),record:register$1("record",60327),debugAltSmall:register$1("debug-alt-small",60328),vmConnect:register$1("vm-connect",60329),cloud:register$1("cloud",60330),merge:register$1("merge",60331),exportIcon:register$1("export",60332),graphLeft:register$1("graph-left",60333),magnet:register$1("magnet",60334),notebook:register$1("notebook",60335),redo:register$1("redo",60336),checkAll:register$1("check-all",60337),pinnedDirty:register$1("pinned-dirty",60338),passFilled:register$1("pass-filled",60339),circleLargeFilled:register$1("circle-large-filled",60340),circleLarge:register$1("circle-large",60341),circleLargeOutline:register$1("circle-large-outline",60341),combine:register$1("combine",60342),gather:register$1("gather",60342),table:register$1("table",60343),variableGroup:register$1("variable-group",60344),typeHierarchy:register$1("type-hierarchy",60345),typeHierarchySub:register$1("type-hierarchy-sub",60346),typeHierarchySuper:register$1("type-hierarchy-super",60347),gitPullRequestCreate:register$1("git-pull-request-create",60348),runAbove:register$1("run-above",60349),runBelow:register$1("run-below",60350),notebookTemplate:register$1("notebook-template",60351),debugRerun:register$1("debug-rerun",60352),workspaceTrusted:register$1("workspace-trusted",60353),workspaceUntrusted:register$1("workspace-untrusted",60354),workspaceUnspecified:register$1("workspace-unspecified",60355),terminalCmd:register$1("terminal-cmd",60356),terminalDebian:register$1("terminal-debian",60357),terminalLinux:register$1("terminal-linux",60358),terminalPowershell:register$1("terminal-powershell",60359),terminalTmux:register$1("terminal-tmux",60360),terminalUbuntu:register$1("terminal-ubuntu",60361),terminalBash:register$1("terminal-bash",60362),arrowSwap:register$1("arrow-swap",60363),copy:register$1("copy",60364),personAdd:register$1("person-add",60365),filterFilled:register$1("filter-filled",60366),wand:register$1("wand",60367),debugLineByLine:register$1("debug-line-by-line",60368),inspect:register$1("inspect",60369),layers:register$1("layers",60370),layersDot:register$1("layers-dot",60371),layersActive:register$1("layers-active",60372),compass:register$1("compass",60373),compassDot:register$1("compass-dot",60374),compassActive:register$1("compass-active",60375),azure:register$1("azure",60376),issueDraft:register$1("issue-draft",60377),gitPullRequestClosed:register$1("git-pull-request-closed",60378),gitPullRequestDraft:register$1("git-pull-request-draft",60379),debugAll:register$1("debug-all",60380),debugCoverage:register$1("debug-coverage",60381),runErrors:register$1("run-errors",60382),folderLibrary:register$1("folder-library",60383),debugContinueSmall:register$1("debug-continue-small",60384),beakerStop:register$1("beaker-stop",60385),graphLine:register$1("graph-line",60386),graphScatter:register$1("graph-scatter",60387),pieChart:register$1("pie-chart",60388),bracketDot:register$1("bracket-dot",60389),bracketError:register$1("bracket-error",60390),lockSmall:register$1("lock-small",60391),azureDevops:register$1("azure-devops",60392),verifiedFilled:register$1("verified-filled",60393),newLine:register$1("newline",60394),layout:register$1("layout",60395),layoutActivitybarLeft:register$1("layout-activitybar-left",60396),layoutActivitybarRight:register$1("layout-activitybar-right",60397),layoutPanelLeft:register$1("layout-panel-left",60398),layoutPanelCenter:register$1("layout-panel-center",60399),layoutPanelJustify:register$1("layout-panel-justify",60400),layoutPanelRight:register$1("layout-panel-right",60401),layoutPanel:register$1("layout-panel",60402),layoutSidebarLeft:register$1("layout-sidebar-left",60403),layoutSidebarRight:register$1("layout-sidebar-right",60404),layoutStatusbar:register$1("layout-statusbar",60405),layoutMenubar:register$1("layout-menubar",60406),layoutCentered:register$1("layout-centered",60407),layoutSidebarRightOff:register$1("layout-sidebar-right-off",60416),layoutPanelOff:register$1("layout-panel-off",60417),layoutSidebarLeftOff:register$1("layout-sidebar-left-off",60418),target:register$1("target",60408),indent:register$1("indent",60409),recordSmall:register$1("record-small",60410),errorSmall:register$1("error-small",60411),arrowCircleDown:register$1("arrow-circle-down",60412),arrowCircleLeft:register$1("arrow-circle-left",60413),arrowCircleRight:register$1("arrow-circle-right",60414),arrowCircleUp:register$1("arrow-circle-up",60415),heartFilled:register$1("heart-filled",60420),map:register$1("map",60421),mapFilled:register$1("map-filled",60422),circleSmall:register$1("circle-small",60423),bellSlash:register$1("bell-slash",60424),bellSlashDot:register$1("bell-slash-dot",60425),commentUnresolved:register$1("comment-unresolved",60426),gitPullRequestGoToChanges:register$1("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:register$1("git-pull-request-new-changes",60428),searchFuzzy:register$1("search-fuzzy",60429),commentDraft:register$1("comment-draft",60430),send:register$1("send",60431),sparkle:register$1("sparkle",60432),insert:register$1("insert",60433),dialogError:register$1("dialog-error","error"),dialogWarning:register$1("dialog-warning","warning"),dialogInfo:register$1("dialog-info","info"),dialogClose:register$1("dialog-close","close"),treeItemExpanded:register$1("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:register$1("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:register$1("tree-filter-on-type-off","list-selection"),treeFilterClear:register$1("tree-filter-clear","close"),treeItemLoading:register$1("tree-item-loading","loading"),menuSelection:register$1("menu-selection","check"),menuSubmenu:register$1("menu-submenu","chevron-right"),menuBarMore:register$1("menubar-more","more"),scrollbarButtonLeft:register$1("scrollbar-button-left","triangle-left"),scrollbarButtonRight:register$1("scrollbar-button-right","triangle-right"),scrollbarButtonUp:register$1("scrollbar-button-up","triangle-up"),scrollbarButtonDown:register$1("scrollbar-button-down","triangle-down"),toolBarMore:register$1("toolbar-more","more"),quickInputBack:register$1("quick-input-back","arrow-left")};var __awaiter$1v=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let TokenizationRegistry$1=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new Emitter$2,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(nt){this._onDidChange.fire({changedLanguages:nt,changedColorMap:!1})}register(nt,ot){return this._tokenizationSupports.set(nt,ot),this.handleChange([nt]),toDisposable(()=>{this._tokenizationSupports.get(nt)===ot&&(this._tokenizationSupports.delete(nt),this.handleChange([nt]))})}get(nt){return this._tokenizationSupports.get(nt)||null}registerFactory(nt,ot){var rt;(rt=this._factories.get(nt))===null||rt===void 0||rt.dispose();const ut=new TokenizationSupportFactoryData(this,nt,ot);return this._factories.set(nt,ut),toDisposable(()=>{const gt=this._factories.get(nt);!gt||gt!==ut||(this._factories.delete(nt),gt.dispose())})}getOrCreate(nt){return __awaiter$1v(this,void 0,void 0,function*(){const ot=this.get(nt);if(ot)return ot;const rt=this._factories.get(nt);return!rt||rt.isResolved?null:(yield rt.resolve(),this.get(nt))})}isResolved(nt){if(this.get(nt))return!0;const rt=this._factories.get(nt);return!!(!rt||rt.isResolved)}setColorMap(nt){this._colorMap=nt,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};class TokenizationSupportFactoryData extends Disposable{get isResolved(){return this._isResolved}constructor(nt,ot,rt){super(),this._registry=nt,this._languageId=ot,this._factory=rt,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}resolve(){return __awaiter$1v(this,void 0,void 0,function*(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise})}_create(){return __awaiter$1v(this,void 0,void 0,function*(){const nt=yield this._factory.tokenizationSupport;this._isResolved=!0,nt&&!this._isDisposed&&this._register(this._registry.register(this._languageId,nt))})}}let Token$2=class{constructor(nt,ot,rt){this.offset=nt,this.type=ot,this.language=rt,this._tokenBrand=void 0}toString(){return"("+this.offset+", "+this.type+")"}};class TokenizationResult{constructor(nt,ot){this.tokens=nt,this.endState=ot,this._tokenizationResultBrand=void 0}}class EncodedTokenizationResult{constructor(nt,ot){this.tokens=nt,this.endState=ot,this._encodedTokenizationResultBrand=void 0}}var CompletionItemKinds;(function(ct){const nt=new Map;nt.set(0,Codicon.symbolMethod),nt.set(1,Codicon.symbolFunction),nt.set(2,Codicon.symbolConstructor),nt.set(3,Codicon.symbolField),nt.set(4,Codicon.symbolVariable),nt.set(5,Codicon.symbolClass),nt.set(6,Codicon.symbolStruct),nt.set(7,Codicon.symbolInterface),nt.set(8,Codicon.symbolModule),nt.set(9,Codicon.symbolProperty),nt.set(10,Codicon.symbolEvent),nt.set(11,Codicon.symbolOperator),nt.set(12,Codicon.symbolUnit),nt.set(13,Codicon.symbolValue),nt.set(15,Codicon.symbolEnum),nt.set(14,Codicon.symbolConstant),nt.set(15,Codicon.symbolEnum),nt.set(16,Codicon.symbolEnumMember),nt.set(17,Codicon.symbolKeyword),nt.set(27,Codicon.symbolSnippet),nt.set(18,Codicon.symbolText),nt.set(19,Codicon.symbolColor),nt.set(20,Codicon.symbolFile),nt.set(21,Codicon.symbolReference),nt.set(22,Codicon.symbolCustomColor),nt.set(23,Codicon.symbolFolder),nt.set(24,Codicon.symbolTypeParameter),nt.set(25,Codicon.account),nt.set(26,Codicon.issues);function ot(gt){let pt=nt.get(gt);return pt||(console.info("No codicon found for CompletionItemKind "+gt),pt=Codicon.symbolProperty),pt}ct.toIcon=ot;const rt=new Map;rt.set("method",0),rt.set("function",1),rt.set("constructor",2),rt.set("field",3),rt.set("variable",4),rt.set("class",5),rt.set("struct",6),rt.set("interface",7),rt.set("module",8),rt.set("property",9),rt.set("event",10),rt.set("operator",11),rt.set("unit",12),rt.set("value",13),rt.set("constant",14),rt.set("enum",15),rt.set("enum-member",16),rt.set("enumMember",16),rt.set("keyword",17),rt.set("snippet",27),rt.set("text",18),rt.set("color",19),rt.set("file",20),rt.set("reference",21),rt.set("customcolor",22),rt.set("folder",23),rt.set("type-parameter",24),rt.set("typeParameter",24),rt.set("account",25),rt.set("issue",26);function ut(gt,pt){let mt=rt.get(gt);return typeof mt>"u"&&!pt&&(mt=9),mt}ct.fromString=ut})(CompletionItemKinds||(CompletionItemKinds={}));var InlineCompletionTriggerKind$1;(function(ct){ct[ct.Automatic=0]="Automatic",ct[ct.Explicit=1]="Explicit"})(InlineCompletionTriggerKind$1||(InlineCompletionTriggerKind$1={}));class SelectedSuggestionInfo{constructor(nt,ot,rt,ut){this.range=nt,this.text=ot,this.completionKind=rt,this.isSnippetText=ut}equals(nt){return Range$2.lift(this.range).equalsRange(nt.range)&&this.text===nt.text&&this.completionKind===nt.completionKind&&this.isSnippetText===nt.isSnippetText}}var SignatureHelpTriggerKind$1;(function(ct){ct[ct.Invoke=1]="Invoke",ct[ct.TriggerCharacter=2]="TriggerCharacter",ct[ct.ContentChange=3]="ContentChange"})(SignatureHelpTriggerKind$1||(SignatureHelpTriggerKind$1={}));var DocumentHighlightKind$1;(function(ct){ct[ct.Text=0]="Text",ct[ct.Read=1]="Read",ct[ct.Write=2]="Write"})(DocumentHighlightKind$1||(DocumentHighlightKind$1={}));function isLocationLink(ct){return ct&&URI.isUri(ct.uri)&&Range$2.isIRange(ct.range)&&(Range$2.isIRange(ct.originSelectionRange)||Range$2.isIRange(ct.targetSelectionRange))}var SymbolKinds;(function(ct){const nt=new Map;nt.set(0,Codicon.symbolFile),nt.set(1,Codicon.symbolModule),nt.set(2,Codicon.symbolNamespace),nt.set(3,Codicon.symbolPackage),nt.set(4,Codicon.symbolClass),nt.set(5,Codicon.symbolMethod),nt.set(6,Codicon.symbolProperty),nt.set(7,Codicon.symbolField),nt.set(8,Codicon.symbolConstructor),nt.set(9,Codicon.symbolEnum),nt.set(10,Codicon.symbolInterface),nt.set(11,Codicon.symbolFunction),nt.set(12,Codicon.symbolVariable),nt.set(13,Codicon.symbolConstant),nt.set(14,Codicon.symbolString),nt.set(15,Codicon.symbolNumber),nt.set(16,Codicon.symbolBoolean),nt.set(17,Codicon.symbolArray),nt.set(18,Codicon.symbolObject),nt.set(19,Codicon.symbolKey),nt.set(20,Codicon.symbolNull),nt.set(21,Codicon.symbolEnumMember),nt.set(22,Codicon.symbolStruct),nt.set(23,Codicon.symbolEvent),nt.set(24,Codicon.symbolOperator),nt.set(25,Codicon.symbolTypeParameter);function ot(rt){let ut=nt.get(rt);return ut||(console.info("No codicon found for SymbolKind "+rt),ut=Codicon.symbolProperty),ut}ct.toIcon=ot})(SymbolKinds||(SymbolKinds={}));class FoldingRangeKind{static fromValue(nt){switch(nt){case"comment":return FoldingRangeKind.Comment;case"imports":return FoldingRangeKind.Imports;case"region":return FoldingRangeKind.Region}return new FoldingRangeKind(nt)}constructor(nt){this.value=nt}}FoldingRangeKind.Comment=new FoldingRangeKind("comment");FoldingRangeKind.Imports=new FoldingRangeKind("imports");FoldingRangeKind.Region=new FoldingRangeKind("region");var Command$1;(function(ct){function nt(ot){return!ot||typeof ot!="object"?!1:typeof ot.id=="string"&&typeof ot.title=="string"}ct.is=nt})(Command$1||(Command$1={}));var InlayHintKind$1;(function(ct){ct[ct.Type=1]="Type",ct[ct.Parameter=2]="Parameter"})(InlayHintKind$1||(InlayHintKind$1={}));class LazyTokenizationSupport{constructor(nt){this.createSupport=nt,this._tokenizationSupport=null}dispose(){this._tokenizationSupport&&this._tokenizationSupport.then(nt=>{nt&&nt.dispose()})}get tokenizationSupport(){return this._tokenizationSupport||(this._tokenizationSupport=this.createSupport()),this._tokenizationSupport}}const TokenizationRegistry=new TokenizationRegistry$1;var AccessibilitySupport;(function(ct){ct[ct.Unknown=0]="Unknown",ct[ct.Disabled=1]="Disabled",ct[ct.Enabled=2]="Enabled"})(AccessibilitySupport||(AccessibilitySupport={}));var CodeActionTriggerType;(function(ct){ct[ct.Invoke=1]="Invoke",ct[ct.Auto=2]="Auto"})(CodeActionTriggerType||(CodeActionTriggerType={}));var CompletionItemInsertTextRule;(function(ct){ct[ct.None=0]="None",ct[ct.KeepWhitespace=1]="KeepWhitespace",ct[ct.InsertAsSnippet=4]="InsertAsSnippet"})(CompletionItemInsertTextRule||(CompletionItemInsertTextRule={}));var CompletionItemKind;(function(ct){ct[ct.Method=0]="Method",ct[ct.Function=1]="Function",ct[ct.Constructor=2]="Constructor",ct[ct.Field=3]="Field",ct[ct.Variable=4]="Variable",ct[ct.Class=5]="Class",ct[ct.Struct=6]="Struct",ct[ct.Interface=7]="Interface",ct[ct.Module=8]="Module",ct[ct.Property=9]="Property",ct[ct.Event=10]="Event",ct[ct.Operator=11]="Operator",ct[ct.Unit=12]="Unit",ct[ct.Value=13]="Value",ct[ct.Constant=14]="Constant",ct[ct.Enum=15]="Enum",ct[ct.EnumMember=16]="EnumMember",ct[ct.Keyword=17]="Keyword",ct[ct.Text=18]="Text",ct[ct.Color=19]="Color",ct[ct.File=20]="File",ct[ct.Reference=21]="Reference",ct[ct.Customcolor=22]="Customcolor",ct[ct.Folder=23]="Folder",ct[ct.TypeParameter=24]="TypeParameter",ct[ct.User=25]="User",ct[ct.Issue=26]="Issue",ct[ct.Snippet=27]="Snippet"})(CompletionItemKind||(CompletionItemKind={}));var CompletionItemTag;(function(ct){ct[ct.Deprecated=1]="Deprecated"})(CompletionItemTag||(CompletionItemTag={}));var CompletionTriggerKind;(function(ct){ct[ct.Invoke=0]="Invoke",ct[ct.TriggerCharacter=1]="TriggerCharacter",ct[ct.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(CompletionTriggerKind||(CompletionTriggerKind={}));var ContentWidgetPositionPreference;(function(ct){ct[ct.EXACT=0]="EXACT",ct[ct.ABOVE=1]="ABOVE",ct[ct.BELOW=2]="BELOW"})(ContentWidgetPositionPreference||(ContentWidgetPositionPreference={}));var CursorChangeReason;(function(ct){ct[ct.NotSet=0]="NotSet",ct[ct.ContentFlush=1]="ContentFlush",ct[ct.RecoverFromMarkers=2]="RecoverFromMarkers",ct[ct.Explicit=3]="Explicit",ct[ct.Paste=4]="Paste",ct[ct.Undo=5]="Undo",ct[ct.Redo=6]="Redo"})(CursorChangeReason||(CursorChangeReason={}));var DefaultEndOfLine;(function(ct){ct[ct.LF=1]="LF",ct[ct.CRLF=2]="CRLF"})(DefaultEndOfLine||(DefaultEndOfLine={}));var DocumentHighlightKind;(function(ct){ct[ct.Text=0]="Text",ct[ct.Read=1]="Read",ct[ct.Write=2]="Write"})(DocumentHighlightKind||(DocumentHighlightKind={}));var EditorAutoIndentStrategy;(function(ct){ct[ct.None=0]="None",ct[ct.Keep=1]="Keep",ct[ct.Brackets=2]="Brackets",ct[ct.Advanced=3]="Advanced",ct[ct.Full=4]="Full"})(EditorAutoIndentStrategy||(EditorAutoIndentStrategy={}));var EditorOption;(function(ct){ct[ct.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",ct[ct.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",ct[ct.accessibilitySupport=2]="accessibilitySupport",ct[ct.accessibilityPageSize=3]="accessibilityPageSize",ct[ct.ariaLabel=4]="ariaLabel",ct[ct.autoClosingBrackets=5]="autoClosingBrackets",ct[ct.screenReaderAnnounceInlineSuggestion=6]="screenReaderAnnounceInlineSuggestion",ct[ct.autoClosingDelete=7]="autoClosingDelete",ct[ct.autoClosingOvertype=8]="autoClosingOvertype",ct[ct.autoClosingQuotes=9]="autoClosingQuotes",ct[ct.autoIndent=10]="autoIndent",ct[ct.automaticLayout=11]="automaticLayout",ct[ct.autoSurround=12]="autoSurround",ct[ct.bracketPairColorization=13]="bracketPairColorization",ct[ct.guides=14]="guides",ct[ct.codeLens=15]="codeLens",ct[ct.codeLensFontFamily=16]="codeLensFontFamily",ct[ct.codeLensFontSize=17]="codeLensFontSize",ct[ct.colorDecorators=18]="colorDecorators",ct[ct.colorDecoratorsLimit=19]="colorDecoratorsLimit",ct[ct.columnSelection=20]="columnSelection",ct[ct.comments=21]="comments",ct[ct.contextmenu=22]="contextmenu",ct[ct.copyWithSyntaxHighlighting=23]="copyWithSyntaxHighlighting",ct[ct.cursorBlinking=24]="cursorBlinking",ct[ct.cursorSmoothCaretAnimation=25]="cursorSmoothCaretAnimation",ct[ct.cursorStyle=26]="cursorStyle",ct[ct.cursorSurroundingLines=27]="cursorSurroundingLines",ct[ct.cursorSurroundingLinesStyle=28]="cursorSurroundingLinesStyle",ct[ct.cursorWidth=29]="cursorWidth",ct[ct.disableLayerHinting=30]="disableLayerHinting",ct[ct.disableMonospaceOptimizations=31]="disableMonospaceOptimizations",ct[ct.domReadOnly=32]="domReadOnly",ct[ct.dragAndDrop=33]="dragAndDrop",ct[ct.dropIntoEditor=34]="dropIntoEditor",ct[ct.emptySelectionClipboard=35]="emptySelectionClipboard",ct[ct.experimentalWhitespaceRendering=36]="experimentalWhitespaceRendering",ct[ct.extraEditorClassName=37]="extraEditorClassName",ct[ct.fastScrollSensitivity=38]="fastScrollSensitivity",ct[ct.find=39]="find",ct[ct.fixedOverflowWidgets=40]="fixedOverflowWidgets",ct[ct.folding=41]="folding",ct[ct.foldingStrategy=42]="foldingStrategy",ct[ct.foldingHighlight=43]="foldingHighlight",ct[ct.foldingImportsByDefault=44]="foldingImportsByDefault",ct[ct.foldingMaximumRegions=45]="foldingMaximumRegions",ct[ct.unfoldOnClickAfterEndOfLine=46]="unfoldOnClickAfterEndOfLine",ct[ct.fontFamily=47]="fontFamily",ct[ct.fontInfo=48]="fontInfo",ct[ct.fontLigatures=49]="fontLigatures",ct[ct.fontSize=50]="fontSize",ct[ct.fontWeight=51]="fontWeight",ct[ct.fontVariations=52]="fontVariations",ct[ct.formatOnPaste=53]="formatOnPaste",ct[ct.formatOnType=54]="formatOnType",ct[ct.glyphMargin=55]="glyphMargin",ct[ct.gotoLocation=56]="gotoLocation",ct[ct.hideCursorInOverviewRuler=57]="hideCursorInOverviewRuler",ct[ct.hover=58]="hover",ct[ct.inDiffEditor=59]="inDiffEditor",ct[ct.inlineSuggest=60]="inlineSuggest",ct[ct.letterSpacing=61]="letterSpacing",ct[ct.lightbulb=62]="lightbulb",ct[ct.lineDecorationsWidth=63]="lineDecorationsWidth",ct[ct.lineHeight=64]="lineHeight",ct[ct.lineNumbers=65]="lineNumbers",ct[ct.lineNumbersMinChars=66]="lineNumbersMinChars",ct[ct.linkedEditing=67]="linkedEditing",ct[ct.links=68]="links",ct[ct.matchBrackets=69]="matchBrackets",ct[ct.minimap=70]="minimap",ct[ct.mouseStyle=71]="mouseStyle",ct[ct.mouseWheelScrollSensitivity=72]="mouseWheelScrollSensitivity",ct[ct.mouseWheelZoom=73]="mouseWheelZoom",ct[ct.multiCursorMergeOverlapping=74]="multiCursorMergeOverlapping",ct[ct.multiCursorModifier=75]="multiCursorModifier",ct[ct.multiCursorPaste=76]="multiCursorPaste",ct[ct.multiCursorLimit=77]="multiCursorLimit",ct[ct.occurrencesHighlight=78]="occurrencesHighlight",ct[ct.overviewRulerBorder=79]="overviewRulerBorder",ct[ct.overviewRulerLanes=80]="overviewRulerLanes",ct[ct.padding=81]="padding",ct[ct.parameterHints=82]="parameterHints",ct[ct.peekWidgetDefaultFocus=83]="peekWidgetDefaultFocus",ct[ct.definitionLinkOpensInPeek=84]="definitionLinkOpensInPeek",ct[ct.quickSuggestions=85]="quickSuggestions",ct[ct.quickSuggestionsDelay=86]="quickSuggestionsDelay",ct[ct.readOnly=87]="readOnly",ct[ct.renameOnType=88]="renameOnType",ct[ct.renderControlCharacters=89]="renderControlCharacters",ct[ct.renderFinalNewline=90]="renderFinalNewline",ct[ct.renderLineHighlight=91]="renderLineHighlight",ct[ct.renderLineHighlightOnlyWhenFocus=92]="renderLineHighlightOnlyWhenFocus",ct[ct.renderValidationDecorations=93]="renderValidationDecorations",ct[ct.renderWhitespace=94]="renderWhitespace",ct[ct.revealHorizontalRightPadding=95]="revealHorizontalRightPadding",ct[ct.roundedSelection=96]="roundedSelection",ct[ct.rulers=97]="rulers",ct[ct.scrollbar=98]="scrollbar",ct[ct.scrollBeyondLastColumn=99]="scrollBeyondLastColumn",ct[ct.scrollBeyondLastLine=100]="scrollBeyondLastLine",ct[ct.scrollPredominantAxis=101]="scrollPredominantAxis",ct[ct.selectionClipboard=102]="selectionClipboard",ct[ct.selectionHighlight=103]="selectionHighlight",ct[ct.selectOnLineNumbers=104]="selectOnLineNumbers",ct[ct.showFoldingControls=105]="showFoldingControls",ct[ct.showUnused=106]="showUnused",ct[ct.snippetSuggestions=107]="snippetSuggestions",ct[ct.smartSelect=108]="smartSelect",ct[ct.smoothScrolling=109]="smoothScrolling",ct[ct.stickyScroll=110]="stickyScroll",ct[ct.stickyTabStops=111]="stickyTabStops",ct[ct.stopRenderingLineAfter=112]="stopRenderingLineAfter",ct[ct.suggest=113]="suggest",ct[ct.suggestFontSize=114]="suggestFontSize",ct[ct.suggestLineHeight=115]="suggestLineHeight",ct[ct.suggestOnTriggerCharacters=116]="suggestOnTriggerCharacters",ct[ct.suggestSelection=117]="suggestSelection",ct[ct.tabCompletion=118]="tabCompletion",ct[ct.tabIndex=119]="tabIndex",ct[ct.unicodeHighlighting=120]="unicodeHighlighting",ct[ct.unusualLineTerminators=121]="unusualLineTerminators",ct[ct.useShadowDOM=122]="useShadowDOM",ct[ct.useTabStops=123]="useTabStops",ct[ct.wordBreak=124]="wordBreak",ct[ct.wordSeparators=125]="wordSeparators",ct[ct.wordWrap=126]="wordWrap",ct[ct.wordWrapBreakAfterCharacters=127]="wordWrapBreakAfterCharacters",ct[ct.wordWrapBreakBeforeCharacters=128]="wordWrapBreakBeforeCharacters",ct[ct.wordWrapColumn=129]="wordWrapColumn",ct[ct.wordWrapOverride1=130]="wordWrapOverride1",ct[ct.wordWrapOverride2=131]="wordWrapOverride2",ct[ct.wrappingIndent=132]="wrappingIndent",ct[ct.wrappingStrategy=133]="wrappingStrategy",ct[ct.showDeprecated=134]="showDeprecated",ct[ct.inlayHints=135]="inlayHints",ct[ct.editorClassName=136]="editorClassName",ct[ct.pixelRatio=137]="pixelRatio",ct[ct.tabFocusMode=138]="tabFocusMode",ct[ct.layoutInfo=139]="layoutInfo",ct[ct.wrappingInfo=140]="wrappingInfo",ct[ct.defaultColorDecorators=141]="defaultColorDecorators"})(EditorOption||(EditorOption={}));var EndOfLinePreference;(function(ct){ct[ct.TextDefined=0]="TextDefined",ct[ct.LF=1]="LF",ct[ct.CRLF=2]="CRLF"})(EndOfLinePreference||(EndOfLinePreference={}));var EndOfLineSequence;(function(ct){ct[ct.LF=0]="LF",ct[ct.CRLF=1]="CRLF"})(EndOfLineSequence||(EndOfLineSequence={}));var GlyphMarginLane$1;(function(ct){ct[ct.Left=1]="Left",ct[ct.Right=2]="Right"})(GlyphMarginLane$1||(GlyphMarginLane$1={}));var IndentAction$1;(function(ct){ct[ct.None=0]="None",ct[ct.Indent=1]="Indent",ct[ct.IndentOutdent=2]="IndentOutdent",ct[ct.Outdent=3]="Outdent"})(IndentAction$1||(IndentAction$1={}));var InjectedTextCursorStops$1;(function(ct){ct[ct.Both=0]="Both",ct[ct.Right=1]="Right",ct[ct.Left=2]="Left",ct[ct.None=3]="None"})(InjectedTextCursorStops$1||(InjectedTextCursorStops$1={}));var InlayHintKind;(function(ct){ct[ct.Type=1]="Type",ct[ct.Parameter=2]="Parameter"})(InlayHintKind||(InlayHintKind={}));var InlineCompletionTriggerKind;(function(ct){ct[ct.Automatic=0]="Automatic",ct[ct.Explicit=1]="Explicit"})(InlineCompletionTriggerKind||(InlineCompletionTriggerKind={}));var KeyCode$1;(function(ct){ct[ct.DependsOnKbLayout=-1]="DependsOnKbLayout",ct[ct.Unknown=0]="Unknown",ct[ct.Backspace=1]="Backspace",ct[ct.Tab=2]="Tab",ct[ct.Enter=3]="Enter",ct[ct.Shift=4]="Shift",ct[ct.Ctrl=5]="Ctrl",ct[ct.Alt=6]="Alt",ct[ct.PauseBreak=7]="PauseBreak",ct[ct.CapsLock=8]="CapsLock",ct[ct.Escape=9]="Escape",ct[ct.Space=10]="Space",ct[ct.PageUp=11]="PageUp",ct[ct.PageDown=12]="PageDown",ct[ct.End=13]="End",ct[ct.Home=14]="Home",ct[ct.LeftArrow=15]="LeftArrow",ct[ct.UpArrow=16]="UpArrow",ct[ct.RightArrow=17]="RightArrow",ct[ct.DownArrow=18]="DownArrow",ct[ct.Insert=19]="Insert",ct[ct.Delete=20]="Delete",ct[ct.Digit0=21]="Digit0",ct[ct.Digit1=22]="Digit1",ct[ct.Digit2=23]="Digit2",ct[ct.Digit3=24]="Digit3",ct[ct.Digit4=25]="Digit4",ct[ct.Digit5=26]="Digit5",ct[ct.Digit6=27]="Digit6",ct[ct.Digit7=28]="Digit7",ct[ct.Digit8=29]="Digit8",ct[ct.Digit9=30]="Digit9",ct[ct.KeyA=31]="KeyA",ct[ct.KeyB=32]="KeyB",ct[ct.KeyC=33]="KeyC",ct[ct.KeyD=34]="KeyD",ct[ct.KeyE=35]="KeyE",ct[ct.KeyF=36]="KeyF",ct[ct.KeyG=37]="KeyG",ct[ct.KeyH=38]="KeyH",ct[ct.KeyI=39]="KeyI",ct[ct.KeyJ=40]="KeyJ",ct[ct.KeyK=41]="KeyK",ct[ct.KeyL=42]="KeyL",ct[ct.KeyM=43]="KeyM",ct[ct.KeyN=44]="KeyN",ct[ct.KeyO=45]="KeyO",ct[ct.KeyP=46]="KeyP",ct[ct.KeyQ=47]="KeyQ",ct[ct.KeyR=48]="KeyR",ct[ct.KeyS=49]="KeyS",ct[ct.KeyT=50]="KeyT",ct[ct.KeyU=51]="KeyU",ct[ct.KeyV=52]="KeyV",ct[ct.KeyW=53]="KeyW",ct[ct.KeyX=54]="KeyX",ct[ct.KeyY=55]="KeyY",ct[ct.KeyZ=56]="KeyZ",ct[ct.Meta=57]="Meta",ct[ct.ContextMenu=58]="ContextMenu",ct[ct.F1=59]="F1",ct[ct.F2=60]="F2",ct[ct.F3=61]="F3",ct[ct.F4=62]="F4",ct[ct.F5=63]="F5",ct[ct.F6=64]="F6",ct[ct.F7=65]="F7",ct[ct.F8=66]="F8",ct[ct.F9=67]="F9",ct[ct.F10=68]="F10",ct[ct.F11=69]="F11",ct[ct.F12=70]="F12",ct[ct.F13=71]="F13",ct[ct.F14=72]="F14",ct[ct.F15=73]="F15",ct[ct.F16=74]="F16",ct[ct.F17=75]="F17",ct[ct.F18=76]="F18",ct[ct.F19=77]="F19",ct[ct.F20=78]="F20",ct[ct.F21=79]="F21",ct[ct.F22=80]="F22",ct[ct.F23=81]="F23",ct[ct.F24=82]="F24",ct[ct.NumLock=83]="NumLock",ct[ct.ScrollLock=84]="ScrollLock",ct[ct.Semicolon=85]="Semicolon",ct[ct.Equal=86]="Equal",ct[ct.Comma=87]="Comma",ct[ct.Minus=88]="Minus",ct[ct.Period=89]="Period",ct[ct.Slash=90]="Slash",ct[ct.Backquote=91]="Backquote",ct[ct.BracketLeft=92]="BracketLeft",ct[ct.Backslash=93]="Backslash",ct[ct.BracketRight=94]="BracketRight",ct[ct.Quote=95]="Quote",ct[ct.OEM_8=96]="OEM_8",ct[ct.IntlBackslash=97]="IntlBackslash",ct[ct.Numpad0=98]="Numpad0",ct[ct.Numpad1=99]="Numpad1",ct[ct.Numpad2=100]="Numpad2",ct[ct.Numpad3=101]="Numpad3",ct[ct.Numpad4=102]="Numpad4",ct[ct.Numpad5=103]="Numpad5",ct[ct.Numpad6=104]="Numpad6",ct[ct.Numpad7=105]="Numpad7",ct[ct.Numpad8=106]="Numpad8",ct[ct.Numpad9=107]="Numpad9",ct[ct.NumpadMultiply=108]="NumpadMultiply",ct[ct.NumpadAdd=109]="NumpadAdd",ct[ct.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",ct[ct.NumpadSubtract=111]="NumpadSubtract",ct[ct.NumpadDecimal=112]="NumpadDecimal",ct[ct.NumpadDivide=113]="NumpadDivide",ct[ct.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",ct[ct.ABNT_C1=115]="ABNT_C1",ct[ct.ABNT_C2=116]="ABNT_C2",ct[ct.AudioVolumeMute=117]="AudioVolumeMute",ct[ct.AudioVolumeUp=118]="AudioVolumeUp",ct[ct.AudioVolumeDown=119]="AudioVolumeDown",ct[ct.BrowserSearch=120]="BrowserSearch",ct[ct.BrowserHome=121]="BrowserHome",ct[ct.BrowserBack=122]="BrowserBack",ct[ct.BrowserForward=123]="BrowserForward",ct[ct.MediaTrackNext=124]="MediaTrackNext",ct[ct.MediaTrackPrevious=125]="MediaTrackPrevious",ct[ct.MediaStop=126]="MediaStop",ct[ct.MediaPlayPause=127]="MediaPlayPause",ct[ct.LaunchMediaPlayer=128]="LaunchMediaPlayer",ct[ct.LaunchMail=129]="LaunchMail",ct[ct.LaunchApp2=130]="LaunchApp2",ct[ct.Clear=131]="Clear",ct[ct.MAX_VALUE=132]="MAX_VALUE"})(KeyCode$1||(KeyCode$1={}));var MarkerSeverity$2;(function(ct){ct[ct.Hint=1]="Hint",ct[ct.Info=2]="Info",ct[ct.Warning=4]="Warning",ct[ct.Error=8]="Error"})(MarkerSeverity$2||(MarkerSeverity$2={}));var MarkerTag$1;(function(ct){ct[ct.Unnecessary=1]="Unnecessary",ct[ct.Deprecated=2]="Deprecated"})(MarkerTag$1||(MarkerTag$1={}));var MinimapPosition$1;(function(ct){ct[ct.Inline=1]="Inline",ct[ct.Gutter=2]="Gutter"})(MinimapPosition$1||(MinimapPosition$1={}));var MouseTargetType;(function(ct){ct[ct.UNKNOWN=0]="UNKNOWN",ct[ct.TEXTAREA=1]="TEXTAREA",ct[ct.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",ct[ct.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",ct[ct.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",ct[ct.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",ct[ct.CONTENT_TEXT=6]="CONTENT_TEXT",ct[ct.CONTENT_EMPTY=7]="CONTENT_EMPTY",ct[ct.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",ct[ct.CONTENT_WIDGET=9]="CONTENT_WIDGET",ct[ct.OVERVIEW_RULER=10]="OVERVIEW_RULER",ct[ct.SCROLLBAR=11]="SCROLLBAR",ct[ct.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",ct[ct.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(MouseTargetType||(MouseTargetType={}));var OverlayWidgetPositionPreference;(function(ct){ct[ct.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",ct[ct.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",ct[ct.TOP_CENTER=2]="TOP_CENTER"})(OverlayWidgetPositionPreference||(OverlayWidgetPositionPreference={}));var OverviewRulerLane$1;(function(ct){ct[ct.Left=1]="Left",ct[ct.Center=2]="Center",ct[ct.Right=4]="Right",ct[ct.Full=7]="Full"})(OverviewRulerLane$1||(OverviewRulerLane$1={}));var PositionAffinity;(function(ct){ct[ct.Left=0]="Left",ct[ct.Right=1]="Right",ct[ct.None=2]="None",ct[ct.LeftOfInjectedText=3]="LeftOfInjectedText",ct[ct.RightOfInjectedText=4]="RightOfInjectedText"})(PositionAffinity||(PositionAffinity={}));var RenderLineNumbersType;(function(ct){ct[ct.Off=0]="Off",ct[ct.On=1]="On",ct[ct.Relative=2]="Relative",ct[ct.Interval=3]="Interval",ct[ct.Custom=4]="Custom"})(RenderLineNumbersType||(RenderLineNumbersType={}));var RenderMinimap;(function(ct){ct[ct.None=0]="None",ct[ct.Text=1]="Text",ct[ct.Blocks=2]="Blocks"})(RenderMinimap||(RenderMinimap={}));var ScrollType;(function(ct){ct[ct.Smooth=0]="Smooth",ct[ct.Immediate=1]="Immediate"})(ScrollType||(ScrollType={}));var ScrollbarVisibility;(function(ct){ct[ct.Auto=1]="Auto",ct[ct.Hidden=2]="Hidden",ct[ct.Visible=3]="Visible"})(ScrollbarVisibility||(ScrollbarVisibility={}));var SelectionDirection$1;(function(ct){ct[ct.LTR=0]="LTR",ct[ct.RTL=1]="RTL"})(SelectionDirection$1||(SelectionDirection$1={}));var SignatureHelpTriggerKind;(function(ct){ct[ct.Invoke=1]="Invoke",ct[ct.TriggerCharacter=2]="TriggerCharacter",ct[ct.ContentChange=3]="ContentChange"})(SignatureHelpTriggerKind||(SignatureHelpTriggerKind={}));var SymbolKind;(function(ct){ct[ct.File=0]="File",ct[ct.Module=1]="Module",ct[ct.Namespace=2]="Namespace",ct[ct.Package=3]="Package",ct[ct.Class=4]="Class",ct[ct.Method=5]="Method",ct[ct.Property=6]="Property",ct[ct.Field=7]="Field",ct[ct.Constructor=8]="Constructor",ct[ct.Enum=9]="Enum",ct[ct.Interface=10]="Interface",ct[ct.Function=11]="Function",ct[ct.Variable=12]="Variable",ct[ct.Constant=13]="Constant",ct[ct.String=14]="String",ct[ct.Number=15]="Number",ct[ct.Boolean=16]="Boolean",ct[ct.Array=17]="Array",ct[ct.Object=18]="Object",ct[ct.Key=19]="Key",ct[ct.Null=20]="Null",ct[ct.EnumMember=21]="EnumMember",ct[ct.Struct=22]="Struct",ct[ct.Event=23]="Event",ct[ct.Operator=24]="Operator",ct[ct.TypeParameter=25]="TypeParameter"})(SymbolKind||(SymbolKind={}));var SymbolTag;(function(ct){ct[ct.Deprecated=1]="Deprecated"})(SymbolTag||(SymbolTag={}));var TextEditorCursorBlinkingStyle;(function(ct){ct[ct.Hidden=0]="Hidden",ct[ct.Blink=1]="Blink",ct[ct.Smooth=2]="Smooth",ct[ct.Phase=3]="Phase",ct[ct.Expand=4]="Expand",ct[ct.Solid=5]="Solid"})(TextEditorCursorBlinkingStyle||(TextEditorCursorBlinkingStyle={}));var TextEditorCursorStyle;(function(ct){ct[ct.Line=1]="Line",ct[ct.Block=2]="Block",ct[ct.Underline=3]="Underline",ct[ct.LineThin=4]="LineThin",ct[ct.BlockOutline=5]="BlockOutline",ct[ct.UnderlineThin=6]="UnderlineThin"})(TextEditorCursorStyle||(TextEditorCursorStyle={}));var TrackedRangeStickiness;(function(ct){ct[ct.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",ct[ct.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",ct[ct.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",ct[ct.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(TrackedRangeStickiness||(TrackedRangeStickiness={}));var WrappingIndent;(function(ct){ct[ct.None=0]="None",ct[ct.Same=1]="Same",ct[ct.Indent=2]="Indent",ct[ct.DeepIndent=3]="DeepIndent"})(WrappingIndent||(WrappingIndent={}));let KeyMod$1=class{static chord(nt,ot){return KeyChord(nt,ot)}};KeyMod$1.CtrlCmd=2048;KeyMod$1.Shift=1024;KeyMod$1.Alt=512;KeyMod$1.WinCtrl=256;function createMonacoBaseAPI(){return{editor:void 0,languages:void 0,CancellationTokenSource:CancellationTokenSource$1,Emitter:Emitter$2,KeyCode:KeyCode$1,KeyMod:KeyMod$1,Position:Position$1,Range:Range$2,Selection:Selection$1,SelectionDirection:SelectionDirection$1,MarkerSeverity:MarkerSeverity$2,MarkerTag:MarkerTag$1,Uri:URI,Token:Token$2}}const standaloneTokens="";class LRUCachedFunction{constructor(nt){this.fn=nt,this.lastCache=void 0,this.lastArgKey=void 0}get(nt){const ot=JSON.stringify(nt);return this.lastArgKey!==ot&&(this.lastArgKey=ot,this.lastCache=this.fn(nt)),this.lastCache}}class CachedFunction{get cachedValues(){return this._map}constructor(nt){this.fn=nt,this._map=new Map}get(nt){if(this._map.has(nt))return this._map.get(nt);const ot=this.fn(nt);return this._map.set(nt,ot),ot}}class Lazy{constructor(nt){this.executor=nt,this._didRun=!1}get value(){if(!this._didRun)try{this._value=this.executor()}catch(nt){this._error=nt}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}var _a$c;function isFalsyOrWhitespace(ct){return!ct||typeof ct!="string"?!0:ct.trim().length===0}const _formatRegexp=/{(\d+)}/g;function format(ct,...nt){return nt.length===0?ct:ct.replace(_formatRegexp,function(ot,rt){const ut=parseInt(rt,10);return isNaN(ut)||ut<0||ut>=nt.length?ot:nt[ut]})}function escape$1(ct){return ct.replace(/[<>&]/g,function(nt){switch(nt){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return nt}})}function escapeRegExpCharacters(ct){return ct.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function trim(ct,nt=" "){const ot=ltrim(ct,nt);return rtrim(ot,nt)}function ltrim(ct,nt){if(!ct||!nt)return ct;const ot=nt.length;if(ot===0||ct.length===0)return ct;let rt=0;for(;ct.indexOf(nt,rt)===rt;)rt=rt+ot;return ct.substring(rt)}function rtrim(ct,nt){if(!ct||!nt)return ct;const ot=nt.length,rt=ct.length;if(ot===0||rt===0)return ct;let ut=rt,gt=-1;for(;gt=ct.lastIndexOf(nt,ut-1),!(gt===-1||gt+ot!==ut);){if(gt===0)return"";ut=gt}return ct.substring(0,ut)}function convertSimple2RegExpPattern(ct){return ct.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function stripWildcards(ct){return ct.replace(/\*/g,"")}function createRegExp(ct,nt,ot={}){if(!ct)throw new Error("Cannot create regex from empty string");nt||(ct=escapeRegExpCharacters(ct)),ot.wholeWord&&(/\B/.test(ct.charAt(0))||(ct="\\b"+ct),/\B/.test(ct.charAt(ct.length-1))||(ct=ct+"\\b"));let rt="";return ot.global&&(rt+="g"),ot.matchCase||(rt+="i"),ot.multiline&&(rt+="m"),ot.unicode&&(rt+="u"),new RegExp(ct,rt)}function regExpLeadsToEndlessLoop(ct){return ct.source==="^"||ct.source==="^$"||ct.source==="$"||ct.source==="^\\s*$"?!1:!!(ct.exec("")&&ct.lastIndex===0)}function regExpFlags(ct){return(ct.global?"g":"")+(ct.ignoreCase?"i":"")+(ct.multiline?"m":"")+(ct.unicode?"u":"")}function splitLines(ct){return ct.split(/\r\n|\r|\n/)}function firstNonWhitespaceIndex(ct){for(let nt=0,ot=ct.length;nt<ot;nt++){const rt=ct.charCodeAt(nt);if(rt!==32&&rt!==9)return nt}return-1}function getLeadingWhitespace(ct,nt=0,ot=ct.length){for(let rt=nt;rt<ot;rt++){const ut=ct.charCodeAt(rt);if(ut!==32&&ut!==9)return ct.substring(nt,rt)}return ct.substring(nt,ot)}function lastNonWhitespaceIndex(ct,nt=ct.length-1){for(let ot=nt;ot>=0;ot--){const rt=ct.charCodeAt(ot);if(rt!==32&&rt!==9)return ot}return-1}function compare(ct,nt){return ct<nt?-1:ct>nt?1:0}function compareSubstring(ct,nt,ot=0,rt=ct.length,ut=0,gt=nt.length){for(;ot<rt&&ut<gt;ot++,ut++){const vt=ct.charCodeAt(ot),St=nt.charCodeAt(ut);if(vt<St)return-1;if(vt>St)return 1}const pt=rt-ot,mt=gt-ut;return pt<mt?-1:pt>mt?1:0}function compareIgnoreCase(ct,nt){return compareSubstringIgnoreCase(ct,nt,0,ct.length,0,nt.length)}function compareSubstringIgnoreCase(ct,nt,ot=0,rt=ct.length,ut=0,gt=nt.length){for(;ot<rt&&ut<gt;ot++,ut++){let vt=ct.charCodeAt(ot),St=nt.charCodeAt(ut);if(vt===St)continue;if(vt>=128||St>=128)return compareSubstring(ct.toLowerCase(),nt.toLowerCase(),ot,rt,ut,gt);isLowerAsciiLetter(vt)&&(vt-=32),isLowerAsciiLetter(St)&&(St-=32);const yt=vt-St;if(yt!==0)return yt}const pt=rt-ot,mt=gt-ut;return pt<mt?-1:pt>mt?1:0}function isAsciiDigit(ct){return ct>=48&&ct<=57}function isLowerAsciiLetter(ct){return ct>=97&&ct<=122}function isUpperAsciiLetter(ct){return ct>=65&&ct<=90}function equalsIgnoreCase(ct,nt){return ct.length===nt.length&&compareSubstringIgnoreCase(ct,nt)===0}function startsWithIgnoreCase(ct,nt){const ot=nt.length;return nt.length>ct.length?!1:compareSubstringIgnoreCase(ct,nt,0,ot)===0}function commonPrefixLength(ct,nt){const ot=Math.min(ct.length,nt.length);let rt;for(rt=0;rt<ot;rt++)if(ct.charCodeAt(rt)!==nt.charCodeAt(rt))return rt;return ot}function commonSuffixLength(ct,nt){const ot=Math.min(ct.length,nt.length);let rt;const ut=ct.length-1,gt=nt.length-1;for(rt=0;rt<ot;rt++)if(ct.charCodeAt(ut-rt)!==nt.charCodeAt(gt-rt))return rt;return ot}function isHighSurrogate(ct){return 55296<=ct&&ct<=56319}function isLowSurrogate(ct){return 56320<=ct&&ct<=57343}function computeCodePoint(ct,nt){return(ct-55296<<10)+(nt-56320)+65536}function getNextCodePoint(ct,nt,ot){const rt=ct.charCodeAt(ot);if(isHighSurrogate(rt)&&ot+1<nt){const ut=ct.charCodeAt(ot+1);if(isLowSurrogate(ut))return computeCodePoint(rt,ut)}return rt}function getPrevCodePoint(ct,nt){const ot=ct.charCodeAt(nt-1);if(isLowSurrogate(ot)&&nt>1){const rt=ct.charCodeAt(nt-2);if(isHighSurrogate(rt))return computeCodePoint(rt,ot)}return ot}class CodePointIterator{get offset(){return this._offset}constructor(nt,ot=0){this._str=nt,this._len=nt.length,this._offset=ot}setOffset(nt){this._offset=nt}prevCodePoint(){const nt=getPrevCodePoint(this._str,this._offset);return this._offset-=nt>=65536?2:1,nt}nextCodePoint(){const nt=getNextCodePoint(this._str,this._len,this._offset);return this._offset+=nt>=65536?2:1,nt}eol(){return this._offset>=this._len}}class GraphemeIterator{get offset(){return this._iterator.offset}constructor(nt,ot=0){this._iterator=new CodePointIterator(nt,ot)}nextGraphemeLength(){const nt=GraphemeBreakTree.getInstance(),ot=this._iterator,rt=ot.offset;let ut=nt.getGraphemeBreakType(ot.nextCodePoint());for(;!ot.eol();){const gt=ot.offset,pt=nt.getGraphemeBreakType(ot.nextCodePoint());if(breakBetweenGraphemeBreakType(ut,pt)){ot.setOffset(gt);break}ut=pt}return ot.offset-rt}prevGraphemeLength(){const nt=GraphemeBreakTree.getInstance(),ot=this._iterator,rt=ot.offset;let ut=nt.getGraphemeBreakType(ot.prevCodePoint());for(;ot.offset>0;){const gt=ot.offset,pt=nt.getGraphemeBreakType(ot.prevCodePoint());if(breakBetweenGraphemeBreakType(pt,ut)){ot.setOffset(gt);break}ut=pt}return rt-ot.offset}eol(){return this._iterator.eol()}}function nextCharLength(ct,nt){return new GraphemeIterator(ct,nt).nextGraphemeLength()}function prevCharLength(ct,nt){return new GraphemeIterator(ct,nt).prevGraphemeLength()}function getCharContainingOffset(ct,nt){nt>0&&isLowSurrogate(ct.charCodeAt(nt))&&nt--;const ot=nt+nextCharLength(ct,nt);return[ot-prevCharLength(ct,ot),ot]}let CONTAINS_RTL;function makeContainsRtl(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function containsRTL(ct){return CONTAINS_RTL||(CONTAINS_RTL=makeContainsRtl()),CONTAINS_RTL.test(ct)}const IS_BASIC_ASCII=/^[\t\n\r\x20-\x7E]*$/;function isBasicASCII(ct){return IS_BASIC_ASCII.test(ct)}const UNUSUAL_LINE_TERMINATORS=/[\u2028\u2029]/;function containsUnusualLineTerminators(ct){return UNUSUAL_LINE_TERMINATORS.test(ct)}function isFullWidthCharacter(ct){return ct>=11904&&ct<=55215||ct>=63744&&ct<=64255||ct>=65281&&ct<=65374}function isEmojiImprecise(ct){return ct>=127462&&ct<=127487||ct===8986||ct===8987||ct===9200||ct===9203||ct>=9728&&ct<=10175||ct===11088||ct===11093||ct>=127744&&ct<=128591||ct>=128640&&ct<=128764||ct>=128992&&ct<=129008||ct>=129280&&ct<=129535||ct>=129648&&ct<=129782}const UTF8_BOM_CHARACTER=String.fromCharCode(65279);function startsWithUTF8BOM(ct){return!!(ct&&ct.length>0&&ct.charCodeAt(0)===65279)}function containsUppercaseCharacter(ct,nt=!1){return ct?(nt&&(ct=ct.replace(/\\./g,"")),ct.toLowerCase()!==ct):!1}function singleLetterHash(ct){return ct=ct%(2*26),ct<26?String.fromCharCode(97+ct):String.fromCharCode(65+ct-26)}function breakBetweenGraphemeBreakType(ct,nt){return ct===0?nt!==5&&nt!==7:ct===2&&nt===3?!1:ct===4||ct===2||ct===3||nt===4||nt===2||nt===3?!0:!(ct===8&&(nt===8||nt===9||nt===11||nt===12)||(ct===11||ct===9)&&(nt===9||nt===10)||(ct===12||ct===10)&&nt===10||nt===5||nt===13||nt===7||ct===1||ct===13&&nt===14||ct===6&&nt===6)}class GraphemeBreakTree{static getInstance(){return GraphemeBreakTree._INSTANCE||(GraphemeBreakTree._INSTANCE=new GraphemeBreakTree),GraphemeBreakTree._INSTANCE}constructor(){this._data=getGraphemeBreakRawData()}getGraphemeBreakType(nt){if(nt<32)return nt===10?3:nt===13?2:4;if(nt<127)return 0;const ot=this._data,rt=ot.length/3;let ut=1;for(;ut<=rt;)if(nt<ot[3*ut])ut=2*ut;else if(nt>ot[3*ut+1])ut=2*ut+1;else return ot[3*ut+2];return 0}}GraphemeBreakTree._INSTANCE=null;function getGraphemeBreakRawData(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function getLeftDeleteOffset(ct,nt){if(ct===0)return 0;const ot=getOffsetBeforeLastEmojiComponent(ct,nt);if(ot!==void 0)return ot;const rt=new CodePointIterator(nt,ct);return rt.prevCodePoint(),rt.offset}function getOffsetBeforeLastEmojiComponent(ct,nt){const ot=new CodePointIterator(nt,ct);let rt=ot.prevCodePoint();for(;isEmojiModifier(rt)||rt===65039||rt===8419;){if(ot.offset===0)return;rt=ot.prevCodePoint()}if(!isEmojiImprecise(rt))return;let ut=ot.offset;return ut>0&&ot.prevCodePoint()===8205&&(ut=ot.offset),ut}function isEmojiModifier(ct){return 127995<=ct&&ct<=127999}const noBreakWhitespace="";class AmbiguousCharacters{static getInstance(nt){return AmbiguousCharacters.cache.get(Array.from(nt))}static getLocales(){return AmbiguousCharacters._locales.value}constructor(nt){this.confusableDictionary=nt}isAmbiguous(nt){return this.confusableDictionary.has(nt)}getPrimaryConfusable(nt){return this.confusableDictionary.get(nt)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}_a$c=AmbiguousCharacters;AmbiguousCharacters.ambiguousCharacterData=new Lazy(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));AmbiguousCharacters.cache=new LRUCachedFunction(ct=>{function nt(St){const yt=new Map;for(let wt=0;wt<St.length;wt+=2)yt.set(St[wt],St[wt+1]);return yt}function ot(St,yt){const wt=new Map(St);for(const[Lt,xt]of yt)wt.set(Lt,xt);return wt}function rt(St,yt){if(!St)return yt;const wt=new Map;for(const[Lt,xt]of St)yt.has(Lt)&&wt.set(Lt,xt);return wt}const ut=_a$c.ambiguousCharacterData.value;let gt=ct.filter(St=>!St.startsWith("_")&&St in ut);gt.length===0&&(gt=["_default"]);let pt;for(const St of gt){const yt=nt(ut[St]);pt=rt(pt,yt)}const mt=nt(ut._common),vt=ot(mt,pt);return new AmbiguousCharacters(vt)});AmbiguousCharacters._locales=new Lazy(()=>Object.keys(AmbiguousCharacters.ambiguousCharacterData.value).filter(ct=>!ct.startsWith("_")));class InvisibleCharacters{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(InvisibleCharacters.getRawData())),this._data}static isInvisibleCharacter(nt){return InvisibleCharacters.getData().has(nt)}static get codePoints(){return InvisibleCharacters.getData()}}InvisibleCharacters._data=void 0;class WindowManager{constructor(){this._zoomFactor=1}getZoomFactor(){return this._zoomFactor}}WindowManager.INSTANCE=new WindowManager;class DevicePixelRatioMonitor extends Disposable{constructor(){super(),this._onDidChange=this._register(new Emitter$2),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(!0),this._mediaQueryList=null,this._handleChange(!1)}_handleChange(nt){var ot;(ot=this._mediaQueryList)===null||ot===void 0||ot.removeEventListener("change",this._listener),this._mediaQueryList=window.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),nt&&this._onDidChange.fire()}}class PixelRatioImpl extends Disposable{get value(){return this._value}constructor(){super(),this._onDidChange=this._register(new Emitter$2),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio();const nt=this._register(new DevicePixelRatioMonitor);this._register(nt.onDidChange(()=>{this._value=this._getPixelRatio(),this._onDidChange.fire(this._value)}))}_getPixelRatio(){const nt=document.createElement("canvas").getContext("2d"),ot=window.devicePixelRatio||1,rt=nt.webkitBackingStorePixelRatio||nt.mozBackingStorePixelRatio||nt.msBackingStorePixelRatio||nt.oBackingStorePixelRatio||nt.backingStorePixelRatio||1;return ot/rt}}class PixelRatioFacade{constructor(){this._pixelRatioMonitor=null}_getOrCreatePixelRatioMonitor(){return this._pixelRatioMonitor||(this._pixelRatioMonitor=new PixelRatioImpl),this._pixelRatioMonitor}get value(){return this._getOrCreatePixelRatioMonitor().value}get onDidChange(){return this._getOrCreatePixelRatioMonitor().onDidChange}}function addMatchMediaChangeListener(ct,nt){typeof ct=="string"&&(ct=window.matchMedia(ct)),ct.addEventListener("change",nt)}const PixelRatio=new PixelRatioFacade;function getZoomFactor(){return WindowManager.INSTANCE.getZoomFactor()}const userAgent=navigator.userAgent,isFirefox=userAgent.indexOf("Firefox")>=0,isWebKit=userAgent.indexOf("AppleWebKit")>=0,isChrome=userAgent.indexOf("Chrome")>=0,isSafari=!isChrome&&userAgent.indexOf("Safari")>=0,isWebkitWebView=!isChrome&&!isSafari&&isWebKit,isElectron=userAgent.indexOf("Electron/")>=0,isAndroid=userAgent.indexOf("Android")>=0;let standalone=!1;if(window.matchMedia){const ct=window.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),nt=window.matchMedia("(display-mode: fullscreen)");standalone=ct.matches,addMatchMediaChangeListener(ct,({matches:ot})=>{standalone&&nt.matches||(standalone=ot)})}function isStandalone(){return standalone}const browser=Object.freeze(Object.defineProperty({__proto__:null,PixelRatio,addMatchMediaChangeListener,getZoomFactor,isAndroid,isChrome,isElectron,isFirefox,isSafari,isStandalone,isWebKit,isWebkitWebView},Symbol.toStringTag,{value:"Module"}));class FastDomNode{constructor(nt){this.domNode=nt,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingLeft="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(nt){const ot=numberAsPixels(nt);this._maxWidth!==ot&&(this._maxWidth=ot,this.domNode.style.maxWidth=this._maxWidth)}setWidth(nt){const ot=numberAsPixels(nt);this._width!==ot&&(this._width=ot,this.domNode.style.width=this._width)}setHeight(nt){const ot=numberAsPixels(nt);this._height!==ot&&(this._height=ot,this.domNode.style.height=this._height)}setTop(nt){const ot=numberAsPixels(nt);this._top!==ot&&(this._top=ot,this.domNode.style.top=this._top)}setLeft(nt){const ot=numberAsPixels(nt);this._left!==ot&&(this._left=ot,this.domNode.style.left=this._left)}setBottom(nt){const ot=numberAsPixels(nt);this._bottom!==ot&&(this._bottom=ot,this.domNode.style.bottom=this._bottom)}setRight(nt){const ot=numberAsPixels(nt);this._right!==ot&&(this._right=ot,this.domNode.style.right=this._right)}setPaddingLeft(nt){const ot=numberAsPixels(nt);this._paddingLeft!==ot&&(this._paddingLeft=ot,this.domNode.style.paddingLeft=this._paddingLeft)}setFontFamily(nt){this._fontFamily!==nt&&(this._fontFamily=nt,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(nt){this._fontWeight!==nt&&(this._fontWeight=nt,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(nt){const ot=numberAsPixels(nt);this._fontSize!==ot&&(this._fontSize=ot,this.domNode.style.fontSize=this._fontSize)}setFontStyle(nt){this._fontStyle!==nt&&(this._fontStyle=nt,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(nt){this._fontFeatureSettings!==nt&&(this._fontFeatureSettings=nt,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(nt){this._fontVariationSettings!==nt&&(this._fontVariationSettings=nt,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(nt){this._textDecoration!==nt&&(this._textDecoration=nt,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(nt){const ot=numberAsPixels(nt);this._lineHeight!==ot&&(this._lineHeight=ot,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(nt){const ot=numberAsPixels(nt);this._letterSpacing!==ot&&(this._letterSpacing=ot,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(nt){this._className!==nt&&(this._className=nt,this.domNode.className=this._className)}toggleClassName(nt,ot){this.domNode.classList.toggle(nt,ot),this._className=this.domNode.className}setDisplay(nt){this._display!==nt&&(this._display=nt,this.domNode.style.display=this._display)}setPosition(nt){this._position!==nt&&(this._position=nt,this.domNode.style.position=this._position)}setVisibility(nt){this._visibility!==nt&&(this._visibility=nt,this.domNode.style.visibility=this._visibility)}setColor(nt){this._color!==nt&&(this._color=nt,this.domNode.style.color=this._color)}setBackgroundColor(nt){this._backgroundColor!==nt&&(this._backgroundColor=nt,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(nt){this._layerHint!==nt&&(this._layerHint=nt,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(nt){this._boxShadow!==nt&&(this._boxShadow=nt,this.domNode.style.boxShadow=nt)}setContain(nt){this._contain!==nt&&(this._contain=nt,this.domNode.style.contain=this._contain)}setAttribute(nt,ot){this.domNode.setAttribute(nt,ot)}removeAttribute(nt){this.domNode.removeAttribute(nt)}appendChild(nt){this.domNode.appendChild(nt.domNode)}removeChild(nt){this.domNode.removeChild(nt.domNode)}}function numberAsPixels(ct){return typeof ct=="number"?`${ct}px`:ct}function createFastDomNode(ct){return new FastDomNode(ct)}function applyFontInfo(ct,nt){ct instanceof FastDomNode?(ct.setFontFamily(nt.getMassagedFontFamily()),ct.setFontWeight(nt.fontWeight),ct.setFontSize(nt.fontSize),ct.setFontFeatureSettings(nt.fontFeatureSettings),ct.setFontVariationSettings(nt.fontVariationSettings),ct.setLineHeight(nt.lineHeight),ct.setLetterSpacing(nt.letterSpacing)):(ct.style.fontFamily=nt.getMassagedFontFamily(),ct.style.fontWeight=nt.fontWeight,ct.style.fontSize=nt.fontSize+"px",ct.style.fontFeatureSettings=nt.fontFeatureSettings,ct.style.fontVariationSettings=nt.fontVariationSettings,ct.style.lineHeight=nt.lineHeight+"px",ct.style.letterSpacing=nt.letterSpacing+"px")}class CharWidthRequest{constructor(nt,ot){this.chr=nt,this.type=ot,this.width=0}fulfill(nt){this.width=nt}}class DomCharWidthReader{constructor(nt,ot){this._bareFontInfo=nt,this._requests=ot,this._container=null,this._testElements=null}read(){this._createDomElements(),document.body.appendChild(this._container),this._readFromDomElements(),document.body.removeChild(this._container),this._container=null,this._testElements=null}_createDomElements(){const nt=document.createElement("div");nt.style.position="absolute",nt.style.top="-50000px",nt.style.width="50000px";const ot=document.createElement("div");applyFontInfo(ot,this._bareFontInfo),nt.appendChild(ot);const rt=document.createElement("div");applyFontInfo(rt,this._bareFontInfo),rt.style.fontWeight="bold",nt.appendChild(rt);const ut=document.createElement("div");applyFontInfo(ut,this._bareFontInfo),ut.style.fontStyle="italic",nt.appendChild(ut);const gt=[];for(const pt of this._requests){let mt;pt.type===0&&(mt=ot),pt.type===2&&(mt=rt),pt.type===1&&(mt=ut),mt.appendChild(document.createElement("br"));const vt=document.createElement("span");DomCharWidthReader._render(vt,pt),mt.appendChild(vt),gt.push(vt)}this._container=nt,this._testElements=gt}static _render(nt,ot){if(ot.chr===" "){let rt="";for(let ut=0;ut<8;ut++)rt+=rt;nt.innerText=rt}else{let rt=ot.chr;for(let ut=0;ut<8;ut++)rt+=rt;nt.textContent=rt}}_readFromDomElements(){for(let nt=0,ot=this._requests.length;nt<ot;nt++){const rt=this._requests[nt],ut=this._testElements[nt];rt.fulfill(ut.offsetWidth/256)}}}function readCharWidths(ct,nt){new DomCharWidthReader(ct,nt).read()}const EditorZoom=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new Emitter$2,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(ct){ct=Math.min(Math.max(-5,ct),20),this._zoomLevel!==ct&&(this._zoomLevel=ct,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},GOLDEN_LINE_HEIGHT_RATIO=isMacintosh?1.5:1.35,MINIMUM_LINE_HEIGHT=8;class BareFontInfo{static createFromValidatedSettings(nt,ot,rt){const ut=nt.get(47),gt=nt.get(51),pt=nt.get(50),mt=nt.get(49),vt=nt.get(52),St=nt.get(64),yt=nt.get(61);return BareFontInfo._create(ut,gt,pt,mt,vt,St,yt,ot,rt)}static _create(nt,ot,rt,ut,gt,pt,mt,vt,St){pt===0?pt=GOLDEN_LINE_HEIGHT_RATIO*rt:pt<MINIMUM_LINE_HEIGHT&&(pt=pt*rt),pt=Math.round(pt),pt<MINIMUM_LINE_HEIGHT&&(pt=MINIMUM_LINE_HEIGHT);const yt=1+(St?0:EditorZoom.getZoomLevel()*.1);return rt*=yt,pt*=yt,gt===EditorFontVariations.TRANSLATE&&(ot==="normal"||ot==="bold"?gt=EditorFontVariations.OFF:(gt=`'wght' ${parseInt(ot,10)}`,ot="normal")),new BareFontInfo({pixelRatio:vt,fontFamily:nt,fontWeight:ot,fontSize:rt,fontFeatureSettings:ut,fontVariationSettings:gt,lineHeight:pt,letterSpacing:mt})}constructor(nt){this._bareFontInfoBrand=void 0,this.pixelRatio=nt.pixelRatio,this.fontFamily=String(nt.fontFamily),this.fontWeight=String(nt.fontWeight),this.fontSize=nt.fontSize,this.fontFeatureSettings=nt.fontFeatureSettings,this.fontVariationSettings=nt.fontVariationSettings,this.lineHeight=nt.lineHeight|0,this.letterSpacing=nt.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const nt=EDITOR_FONT_DEFAULTS.fontFamily,ot=BareFontInfo._wrapInQuotes(this.fontFamily);return nt&&this.fontFamily!==nt?`${ot}, ${nt}`:ot}static _wrapInQuotes(nt){return/[,"']/.test(nt)?nt:/[+ ]/.test(nt)?`"${nt}"`:nt}}const SERIALIZED_FONT_INFO_VERSION=2;class FontInfo extends BareFontInfo{constructor(nt,ot){super(nt),this._editorStylingBrand=void 0,this.version=SERIALIZED_FONT_INFO_VERSION,this.isTrusted=ot,this.isMonospace=nt.isMonospace,this.typicalHalfwidthCharacterWidth=nt.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=nt.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=nt.canUseHalfwidthRightwardsArrow,this.spaceWidth=nt.spaceWidth,this.middotWidth=nt.middotWidth,this.wsmiddotWidth=nt.wsmiddotWidth,this.maxDigitWidth=nt.maxDigitWidth}equals(nt){return this.fontFamily===nt.fontFamily&&this.fontWeight===nt.fontWeight&&this.fontSize===nt.fontSize&&this.fontFeatureSettings===nt.fontFeatureSettings&&this.fontVariationSettings===nt.fontVariationSettings&&this.lineHeight===nt.lineHeight&&this.letterSpacing===nt.letterSpacing&&this.typicalHalfwidthCharacterWidth===nt.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===nt.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===nt.canUseHalfwidthRightwardsArrow&&this.spaceWidth===nt.spaceWidth&&this.middotWidth===nt.middotWidth&&this.wsmiddotWidth===nt.wsmiddotWidth&&this.maxDigitWidth===nt.maxDigitWidth}}class FontMeasurementsImpl extends Disposable{constructor(){super(),this._onDidChange=this._register(new Emitter$2),this.onDidChange=this._onDidChange.event,this._cache=new FontMeasurementsCache,this._evictUntrustedReadingsTimeout=-1}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(window.clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache=new FontMeasurementsCache,this._onDidChange.fire()}_writeToCache(nt,ot){this._cache.put(nt,ot),!ot.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=window.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings()},5e3))}_evictUntrustedReadings(){const nt=this._cache.getValues();let ot=!1;for(const rt of nt)rt.isTrusted||(ot=!0,this._cache.remove(rt));ot&&this._onDidChange.fire()}readFontInfo(nt){if(!this._cache.has(nt)){let ot=this._actualReadFontInfo(nt);(ot.typicalHalfwidthCharacterWidth<=2||ot.typicalFullwidthCharacterWidth<=2||ot.spaceWidth<=2||ot.maxDigitWidth<=2)&&(ot=new FontInfo({pixelRatio:PixelRatio.value,fontFamily:ot.fontFamily,fontWeight:ot.fontWeight,fontSize:ot.fontSize,fontFeatureSettings:ot.fontFeatureSettings,fontVariationSettings:ot.fontVariationSettings,lineHeight:ot.lineHeight,letterSpacing:ot.letterSpacing,isMonospace:ot.isMonospace,typicalHalfwidthCharacterWidth:Math.max(ot.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(ot.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:ot.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(ot.spaceWidth,5),middotWidth:Math.max(ot.middotWidth,5),wsmiddotWidth:Math.max(ot.wsmiddotWidth,5),maxDigitWidth:Math.max(ot.maxDigitWidth,5)},!1)),this._writeToCache(nt,ot)}return this._cache.get(nt)}_createRequest(nt,ot,rt,ut){const gt=new CharWidthRequest(nt,ot);return rt.push(gt),ut==null||ut.push(gt),gt}_actualReadFontInfo(nt){const ot=[],rt=[],ut=this._createRequest("n",0,ot,rt),gt=this._createRequest("",0,ot,null),pt=this._createRequest(" ",0,ot,rt),mt=this._createRequest("0",0,ot,rt),vt=this._createRequest("1",0,ot,rt),St=this._createRequest("2",0,ot,rt),yt=this._createRequest("3",0,ot,rt),wt=this._createRequest("4",0,ot,rt),Lt=this._createRequest("5",0,ot,rt),xt=this._createRequest("6",0,ot,rt),It=this._createRequest("7",0,ot,rt),kt=this._createRequest("8",0,ot,rt),At=this._createRequest("9",0,ot,rt),Tt=this._createRequest("",0,ot,rt),Rt=this._createRequest("",0,ot,null),Nt=this._createRequest("",0,ot,rt),Pt=this._createRequest(String.fromCharCode(11825),0,ot,null),Ft="|/-_ilm%";for(let Yt=0,Zt=Ft.length;Yt<Zt;Yt++)this._createRequest(Ft.charAt(Yt),0,ot,rt),this._createRequest(Ft.charAt(Yt),1,ot,rt),this._createRequest(Ft.charAt(Yt),2,ot,rt);readCharWidths(nt,ot);const Kt=Math.max(mt.width,vt.width,St.width,yt.width,wt.width,Lt.width,xt.width,It.width,kt.width,At.width);let Bt=nt.fontFeatureSettings===EditorFontLigatures.OFF;const Ut=rt[0].width;for(let Yt=1,Zt=rt.length;Bt&&Yt<Zt;Yt++){const Xt=Ut-rt[Yt].width;if(Xt<-.001||Xt>.001){Bt=!1;break}}let qt=!0;return Bt&&Rt.width!==Ut&&(qt=!1),Rt.width>Tt.width&&(qt=!1),new FontInfo({pixelRatio:PixelRatio.value,fontFamily:nt.fontFamily,fontWeight:nt.fontWeight,fontSize:nt.fontSize,fontFeatureSettings:nt.fontFeatureSettings,fontVariationSettings:nt.fontVariationSettings,lineHeight:nt.lineHeight,letterSpacing:nt.letterSpacing,isMonospace:Bt,typicalHalfwidthCharacterWidth:ut.width,typicalFullwidthCharacterWidth:gt.width,canUseHalfwidthRightwardsArrow:qt,spaceWidth:pt.width,middotWidth:Nt.width,wsmiddotWidth:Pt.width,maxDigitWidth:Kt},!0)}}class FontMeasurementsCache{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(nt){const ot=nt.getId();return!!this._values[ot]}get(nt){const ot=nt.getId();return this._values[ot]}put(nt,ot){const rt=nt.getId();this._keys[rt]=nt,this._values[rt]=ot}remove(nt){const ot=nt.getId();delete this._keys[ot],delete this._values[ot]}getValues(){return Object.keys(this._keys).map(nt=>this._values[nt])}}const FontMeasurements=new FontMeasurementsImpl;var _util;(function(ct){ct.serviceIds=new Map,ct.DI_TARGET="$di$target",ct.DI_DEPENDENCIES="$di$dependencies";function nt(ot){return ot[ct.DI_DEPENDENCIES]||[]}ct.getServiceDependencies=nt})(_util||(_util={}));const IInstantiationService=createDecorator("instantiationService");function storeServiceDependency(ct,nt,ot){nt[_util.DI_TARGET]===nt?nt[_util.DI_DEPENDENCIES].push({id:ct,index:ot}):(nt[_util.DI_DEPENDENCIES]=[{id:ct,index:ot}],nt[_util.DI_TARGET]=nt)}function createDecorator(ct){if(_util.serviceIds.has(ct))return _util.serviceIds.get(ct);const nt=function(ot,rt,ut){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");storeServiceDependency(nt,ot,ut)};return nt.toString=()=>ct,_util.serviceIds.set(ct,nt),nt}const ICodeEditorService=createDecorator("codeEditorService");function ok(ct,nt){if(!ct)throw new Error(nt?`Assertion failed (${nt})`:"Assertion Failed")}function assertNever(ct,nt="Unreachable"){throw new Error(nt)}function assertFn(ct){if(!ct()){debugger;ct(),onUnexpectedError(new BugIndicatingError("Assertion Failed"))}}function checkAdjacentItems(ct,nt){let ot=0;for(;ot<ct.length-1;){const rt=ct[ot],ut=ct[ot+1];if(!nt(rt,ut))return!1;ot++}return!0}const IAudioCueService=createDecorator("audioCue");class Sound{static register(nt){return new Sound(nt.fileName)}constructor(nt){this.fileName=nt}}Sound.error=Sound.register({fileName:"error.mp3"});Sound.warning=Sound.register({fileName:"warning.mp3"});Sound.foldedArea=Sound.register({fileName:"foldedAreas.mp3"});Sound.break=Sound.register({fileName:"break.mp3"});Sound.quickFixes=Sound.register({fileName:"quickFixes.mp3"});Sound.taskCompleted=Sound.register({fileName:"taskCompleted.mp3"});Sound.taskFailed=Sound.register({fileName:"taskFailed.mp3"});Sound.terminalBell=Sound.register({fileName:"terminalBell.mp3"});Sound.diffLineInserted=Sound.register({fileName:"diffLineInserted.mp3"});Sound.diffLineDeleted=Sound.register({fileName:"diffLineDeleted.mp3"});Sound.diffLineModified=Sound.register({fileName:"diffLineModified.mp3"});class AudioCue{static register(nt){const ot=new AudioCue(nt.sound,nt.name,nt.settingsKey);return AudioCue._audioCues.add(ot),ot}constructor(nt,ot,rt){this.sound=nt,this.name=ot,this.settingsKey=rt}}AudioCue._audioCues=new Set;AudioCue.error=AudioCue.register({name:localize("audioCues.lineHasError.name","Error on Line"),sound:Sound.error,settingsKey:"audioCues.lineHasError"});AudioCue.warning=AudioCue.register({name:localize("audioCues.lineHasWarning.name","Warning on Line"),sound:Sound.warning,settingsKey:"audioCues.lineHasWarning"});AudioCue.foldedArea=AudioCue.register({name:localize("audioCues.lineHasFoldedArea.name","Folded Area on Line"),sound:Sound.foldedArea,settingsKey:"audioCues.lineHasFoldedArea"});AudioCue.break=AudioCue.register({name:localize("audioCues.lineHasBreakpoint.name","Breakpoint on Line"),sound:Sound.break,settingsKey:"audioCues.lineHasBreakpoint"});AudioCue.inlineSuggestion=AudioCue.register({name:localize("audioCues.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:Sound.quickFixes,settingsKey:"audioCues.lineHasInlineSuggestion"});AudioCue.terminalQuickFix=AudioCue.register({name:localize("audioCues.terminalQuickFix.name","Terminal Quick Fix"),sound:Sound.quickFixes,settingsKey:"audioCues.terminalQuickFix"});AudioCue.onDebugBreak=AudioCue.register({name:localize("audioCues.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:Sound.break,settingsKey:"audioCues.onDebugBreak"});AudioCue.noInlayHints=AudioCue.register({name:localize("audioCues.noInlayHints","No Inlay Hints on Line"),sound:Sound.error,settingsKey:"audioCues.noInlayHints"});AudioCue.taskCompleted=AudioCue.register({name:localize("audioCues.taskCompleted","Task Completed"),sound:Sound.taskCompleted,settingsKey:"audioCues.taskCompleted"});AudioCue.taskFailed=AudioCue.register({name:localize("audioCues.taskFailed","Task Failed"),sound:Sound.taskFailed,settingsKey:"audioCues.taskFailed"});AudioCue.terminalCommandFailed=AudioCue.register({name:localize("audioCues.terminalCommandFailed","Terminal Command Failed"),sound:Sound.error,settingsKey:"audioCues.terminalCommandFailed"});AudioCue.terminalBell=AudioCue.register({name:localize("audioCues.terminalBell","Terminal Bell"),sound:Sound.terminalBell,settingsKey:"audioCues.terminalBell"});AudioCue.notebookCellCompleted=AudioCue.register({name:localize("audioCues.notebookCellCompleted","Notebook Cell Completed"),sound:Sound.taskCompleted,settingsKey:"audioCues.notebookCellCompleted"});AudioCue.notebookCellFailed=AudioCue.register({name:localize("audioCues.notebookCellFailed","Notebook Cell Failed"),sound:Sound.taskFailed,settingsKey:"audioCues.notebookCellFailed"});AudioCue.diffLineInserted=AudioCue.register({name:localize("audioCues.diffLineInserted","Diff Line Inserted"),sound:Sound.diffLineInserted,settingsKey:"audioCues.diffLineInserted"});AudioCue.diffLineDeleted=AudioCue.register({name:localize("audioCues.diffLineDeleted","Diff Line Deleted"),sound:Sound.diffLineDeleted,settingsKey:"audioCues.diffLineDeleted"});AudioCue.diffLineModified=AudioCue.register({name:localize("audioCues.diffLineModified","Diff Line Modified"),sound:Sound.diffLineModified,settingsKey:"audioCues.diffLineModified"});function hintDidYouMean(...ct){switch(ct.length){case 1:return localize("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",ct[0]);case 2:return localize("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",ct[0],ct[1]);case 3:return localize("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",ct[0],ct[1],ct[2]);default:return}}const hintDidYouForgetToOpenOrCloseQuote=localize("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),hintDidYouForgetToEscapeSlash=localize("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");let Scanner$1=class Vo{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(nt){switch(nt.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return nt.isTripleEq?"===":"==";case 4:return nt.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return nt.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return nt.lexeme;case 18:return nt.lexeme;case 19:return nt.lexeme;case 20:return"EOF";default:throw illegalState(`unhandled token type: ${JSON.stringify(nt)}; have you forgotten to add a case?`)}}reset(nt){return this._input=nt,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const ot=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:ot})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const ot=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:ot})}else this._match(126)?this._addToken(9):this._error(hintDidYouMean("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(hintDidYouMean("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(hintDidYouMean("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(nt){return this._isAtEnd()||this._input.charCodeAt(this._current)!==nt?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(nt){this._tokens.push({type:nt,offset:this._start})}_error(nt){const ot=this._start,rt=this._input.substring(this._start,this._current),ut={type:19,offset:this._start,lexeme:rt};this._errors.push({offset:ot,lexeme:rt,additionalInfo:nt}),this._tokens.push(ut)}_string(){this.stringRe.lastIndex=this._start;const nt=this.stringRe.exec(this._input);if(nt){this._current=this._start+nt[0].length;const ot=this._input.substring(this._start,this._current),rt=Vo._keywords.get(ot);rt?this._addToken(rt):this._tokens.push({type:17,lexeme:ot,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(hintDidYouForgetToOpenOrCloseQuote);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let nt=this._current,ot=!1,rt=!1;for(;;){if(nt>=this._input.length){this._current=nt,this._error(hintDidYouForgetToEscapeSlash);return}const gt=this._input.charCodeAt(nt);if(ot)ot=!1;else if(gt===47&&!rt){nt++;break}else gt===91?rt=!0:gt===92?ot=!0:gt===93&&(rt=!1);nt++}for(;nt<this._input.length&&Vo._regexFlags.has(this._input.charCodeAt(nt));)nt++;this._current=nt;const ut=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:ut,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};Scanner$1._regexFlags=new Set(["i","g","s","m","y","u"].map(ct=>ct.charCodeAt(0)));Scanner$1._keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);const CONSTANT_VALUES=new Map;CONSTANT_VALUES.set("false",!1);CONSTANT_VALUES.set("true",!0);CONSTANT_VALUES.set("isMac",isMacintosh);CONSTANT_VALUES.set("isLinux",isLinux);CONSTANT_VALUES.set("isWindows",isWindows);CONSTANT_VALUES.set("isWeb",isWeb);CONSTANT_VALUES.set("isMacNative",isMacintosh&&!isWeb);CONSTANT_VALUES.set("isEdge",isEdge);CONSTANT_VALUES.set("isFirefox",isFirefox$1);CONSTANT_VALUES.set("isChrome",isChrome$1);CONSTANT_VALUES.set("isSafari",isSafari$1);const hasOwnProperty$2=Object.prototype.hasOwnProperty,defaultConfig={regexParsingWithErrorRecovery:!0},errorEmptyString=localize("contextkey.parser.error.emptyString","Empty context key expression"),hintEmptyString=localize("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),errorNoInAfterNot=localize("contextkey.parser.error.noInAfterNot","'in' after 'not'."),errorClosingParenthesis=localize("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),errorUnexpectedToken=localize("contextkey.parser.error.unexpectedToken","Unexpected token"),hintUnexpectedToken=localize("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),errorUnexpectedEOF=localize("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),hintUnexpectedEOF=localize("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?");let Parser$1=class yo{constructor(nt=defaultConfig){this._config=nt,this._scanner=new Scanner$1,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(nt){if(nt===""){this._parsingErrors.push({message:errorEmptyString,offset:0,lexeme:"",additionalInfo:hintEmptyString});return}this._tokens=this._scanner.reset(nt).scan(),this._current=0,this._parsingErrors=[];try{const ot=this._expr();if(!this._isAtEnd()){const rt=this._peek(),ut=rt.type===17?hintUnexpectedToken:void 0;throw this._parsingErrors.push({message:errorUnexpectedToken,offset:rt.offset,lexeme:Scanner$1.getLexeme(rt),additionalInfo:ut}),yo._parseError}return ot}catch(ot){if(ot!==yo._parseError)throw ot;return}}_expr(){return this._or()}_or(){const nt=[this._and()];for(;this._matchOne(16);){const ot=this._and();nt.push(ot)}return nt.length===1?nt[0]:ContextKeyExpr.or(...nt)}_and(){const nt=[this._term()];for(;this._matchOne(15);){const ot=this._term();nt.push(ot)}return nt.length===1?nt[0]:ContextKeyExpr.and(...nt)}_term(){if(this._matchOne(2)){const nt=this._peek();switch(nt.type){case 11:return this._advance(),ContextKeyFalseExpr.INSTANCE;case 12:return this._advance(),ContextKeyTrueExpr.INSTANCE;case 0:{this._advance();const ot=this._expr();return this._consume(1,errorClosingParenthesis),ot==null?void 0:ot.negate()}case 17:return this._advance(),ContextKeyNotExpr.create(nt.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",nt)}}return this._primary()}_primary(){const nt=this._peek();switch(nt.type){case 11:return this._advance(),ContextKeyExpr.true();case 12:return this._advance(),ContextKeyExpr.false();case 0:{this._advance();const ot=this._expr();return this._consume(1,errorClosingParenthesis),ot}case 17:{const ot=nt.lexeme;if(this._advance(),this._matchOne(9)){const ut=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),ut.type!==10)throw this._errExpectedButGot("REGEX",ut);const gt=ut.lexeme,pt=gt.lastIndexOf("/"),mt=pt===gt.length-1?void 0:this._removeFlagsGY(gt.substring(pt+1));let vt;try{vt=new RegExp(gt.substring(1,pt),mt)}catch{throw this._errExpectedButGot("REGEX",ut)}return ContextKeyRegexExpr.create(ot,vt)}switch(ut.type){case 10:case 19:{const gt=[ut.lexeme];this._advance();let pt=this._peek(),mt=0;for(let Lt=0;Lt<ut.lexeme.length;Lt++)ut.lexeme.charCodeAt(Lt)===40?mt++:ut.lexeme.charCodeAt(Lt)===41&&mt--;for(;!this._isAtEnd()&&pt.type!==15&&pt.type!==16;){switch(pt.type){case 0:mt++;break;case 1:mt--;break;case 10:case 18:for(let Lt=0;Lt<pt.lexeme.length;Lt++)pt.lexeme.charCodeAt(Lt)===40?mt++:ut.lexeme.charCodeAt(Lt)===41&&mt--}if(mt<0)break;gt.push(Scanner$1.getLexeme(pt)),this._advance(),pt=this._peek()}const vt=gt.join(""),St=vt.lastIndexOf("/"),yt=St===vt.length-1?void 0:this._removeFlagsGY(vt.substring(St+1));let wt;try{wt=new RegExp(vt.substring(1,St),yt)}catch{throw this._errExpectedButGot("REGEX",ut)}return ContextKeyExpr.regex(ot,wt)}case 18:{const gt=ut.lexeme;this._advance();let pt=null;if(!isFalsyOrWhitespace(gt)){const mt=gt.indexOf("/"),vt=gt.lastIndexOf("/");if(mt!==vt&&mt>=0){const St=gt.slice(mt+1,vt),yt=gt[vt+1]==="i"?"i":"";try{pt=new RegExp(St,yt)}catch{throw this._errExpectedButGot("REGEX",ut)}}}if(pt===null)throw this._errExpectedButGot("REGEX",ut);return ContextKeyRegexExpr.create(ot,pt)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,errorNoInAfterNot);const ut=this._value();return ContextKeyExpr.notIn(ot,ut)}switch(this._peek().type){case 3:{this._advance();const ut=this._value();if(this._previous().type===18)return ContextKeyExpr.equals(ot,ut);switch(ut){case"true":return ContextKeyExpr.has(ot);case"false":return ContextKeyExpr.not(ot);default:return ContextKeyExpr.equals(ot,ut)}}case 4:{this._advance();const ut=this._value();if(this._previous().type===18)return ContextKeyExpr.notEquals(ot,ut);switch(ut){case"true":return ContextKeyExpr.not(ot);case"false":return ContextKeyExpr.has(ot);default:return ContextKeyExpr.notEquals(ot,ut)}}case 5:return this._advance(),ContextKeySmallerExpr.create(ot,this._value());case 6:return this._advance(),ContextKeySmallerEqualsExpr.create(ot,this._value());case 7:return this._advance(),ContextKeyGreaterExpr.create(ot,this._value());case 8:return this._advance(),ContextKeyGreaterEqualsExpr.create(ot,this._value());case 13:return this._advance(),ContextKeyExpr.in(ot,this._value());default:return ContextKeyExpr.has(ot)}}case 20:throw this._parsingErrors.push({message:errorUnexpectedEOF,offset:nt.offset,lexeme:"",additionalInfo:hintUnexpectedEOF}),yo._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const nt=this._peek();switch(nt.type){case 17:case 18:return this._advance(),nt.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(nt){return nt.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(nt){return this._check(nt)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(nt,ot){if(this._check(nt))return this._advance();throw this._errExpectedButGot(ot,this._peek())}_errExpectedButGot(nt,ot,rt){const ut=localize("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,nt,Scanner$1.getLexeme(ot)),gt=ot.offset,pt=Scanner$1.getLexeme(ot);return this._parsingErrors.push({message:ut,offset:gt,lexeme:pt,additionalInfo:rt}),yo._parseError}_check(nt){return this._peek().type===nt}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}};Parser$1._parseError=new Error;class ContextKeyExpr{static false(){return ContextKeyFalseExpr.INSTANCE}static true(){return ContextKeyTrueExpr.INSTANCE}static has(nt){return ContextKeyDefinedExpr.create(nt)}static equals(nt,ot){return ContextKeyEqualsExpr.create(nt,ot)}static notEquals(nt,ot){return ContextKeyNotEqualsExpr.create(nt,ot)}static regex(nt,ot){return ContextKeyRegexExpr.create(nt,ot)}static in(nt,ot){return ContextKeyInExpr.create(nt,ot)}static notIn(nt,ot){return ContextKeyNotInExpr.create(nt,ot)}static not(nt){return ContextKeyNotExpr.create(nt)}static and(...nt){return ContextKeyAndExpr.create(nt,null,!0)}static or(...nt){return ContextKeyOrExpr.create(nt,null,!0)}static deserialize(nt){return nt==null?void 0:this._parser.parse(nt)}}ContextKeyExpr._parser=new Parser$1({regexParsingWithErrorRecovery:!1});function expressionsAreEqualWithConstantSubstitution(ct,nt){const ot=ct?ct.substituteConstants():void 0,rt=nt?nt.substituteConstants():void 0;return!ot&&!rt?!0:!ot||!rt?!1:ot.equals(rt)}function cmp(ct,nt){return ct.cmp(nt)}class ContextKeyFalseExpr{constructor(){this.type=0}cmp(nt){return this.type-nt.type}equals(nt){return nt.type===this.type}substituteConstants(){return this}evaluate(nt){return!1}serialize(){return"false"}keys(){return[]}negate(){return ContextKeyTrueExpr.INSTANCE}}ContextKeyFalseExpr.INSTANCE=new ContextKeyFalseExpr;class ContextKeyTrueExpr{constructor(){this.type=1}cmp(nt){return this.type-nt.type}equals(nt){return nt.type===this.type}substituteConstants(){return this}evaluate(nt){return!0}serialize(){return"true"}keys(){return[]}negate(){return ContextKeyFalseExpr.INSTANCE}}ContextKeyTrueExpr.INSTANCE=new ContextKeyTrueExpr;class ContextKeyDefinedExpr{static create(nt,ot=null){const rt=CONSTANT_VALUES.get(nt);return typeof rt=="boolean"?rt?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE:new ContextKeyDefinedExpr(nt,ot)}constructor(nt,ot){this.key=nt,this.negated=ot,this.type=2}cmp(nt){return nt.type!==this.type?this.type-nt.type:cmp1(this.key,nt.key)}equals(nt){return nt.type===this.type?this.key===nt.key:!1}substituteConstants(){const nt=CONSTANT_VALUES.get(this.key);return typeof nt=="boolean"?nt?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE:this}evaluate(nt){return!!nt.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotExpr.create(this.key,this)),this.negated}}class ContextKeyEqualsExpr{static create(nt,ot,rt=null){if(typeof ot=="boolean")return ot?ContextKeyDefinedExpr.create(nt,rt):ContextKeyNotExpr.create(nt,rt);const ut=CONSTANT_VALUES.get(nt);return typeof ut=="boolean"?ot===(ut?"true":"false")?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE:new ContextKeyEqualsExpr(nt,ot,rt)}constructor(nt,ot,rt){this.key=nt,this.value=ot,this.negated=rt,this.type=4}cmp(nt){return nt.type!==this.type?this.type-nt.type:cmp2(this.key,this.value,nt.key,nt.value)}equals(nt){return nt.type===this.type?this.key===nt.key&&this.value===nt.value:!1}substituteConstants(){const nt=CONSTANT_VALUES.get(this.key);if(typeof nt=="boolean"){const ot=nt?"true":"false";return this.value===ot?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE}return this}evaluate(nt){return nt.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyInExpr{static create(nt,ot){return new ContextKeyInExpr(nt,ot)}constructor(nt,ot){this.key=nt,this.valueKey=ot,this.type=10,this.negated=null}cmp(nt){return nt.type!==this.type?this.type-nt.type:cmp2(this.key,this.valueKey,nt.key,nt.valueKey)}equals(nt){return nt.type===this.type?this.key===nt.key&&this.valueKey===nt.valueKey:!1}substituteConstants(){return this}evaluate(nt){const ot=nt.getValue(this.valueKey),rt=nt.getValue(this.key);return Array.isArray(ot)?ot.includes(rt):typeof rt=="string"&&typeof ot=="object"&&ot!==null?hasOwnProperty$2.call(ot,rt):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=ContextKeyNotInExpr.create(this.key,this.valueKey)),this.negated}}class ContextKeyNotInExpr{static create(nt,ot){return new ContextKeyNotInExpr(nt,ot)}constructor(nt,ot){this.key=nt,this.valueKey=ot,this.type=11,this._negated=ContextKeyInExpr.create(nt,ot)}cmp(nt){return nt.type!==this.type?this.type-nt.type:this._negated.cmp(nt._negated)}equals(nt){return nt.type===this.type?this._negated.equals(nt._negated):!1}substituteConstants(){return this}evaluate(nt){return!this._negated.evaluate(nt)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}negate(){return this._negated}}class ContextKeyNotEqualsExpr{static create(nt,ot,rt=null){if(typeof ot=="boolean")return ot?ContextKeyNotExpr.create(nt,rt):ContextKeyDefinedExpr.create(nt,rt);const ut=CONSTANT_VALUES.get(nt);return typeof ut=="boolean"?ot===(ut?"true":"false")?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE:new ContextKeyNotEqualsExpr(nt,ot,rt)}constructor(nt,ot,rt){this.key=nt,this.value=ot,this.negated=rt,this.type=5}cmp(nt){return nt.type!==this.type?this.type-nt.type:cmp2(this.key,this.value,nt.key,nt.value)}equals(nt){return nt.type===this.type?this.key===nt.key&&this.value===nt.value:!1}substituteConstants(){const nt=CONSTANT_VALUES.get(this.key);if(typeof nt=="boolean"){const ot=nt?"true":"false";return this.value===ot?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE}return this}evaluate(nt){return nt.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyNotExpr{static create(nt,ot=null){const rt=CONSTANT_VALUES.get(nt);return typeof rt=="boolean"?rt?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE:new ContextKeyNotExpr(nt,ot)}constructor(nt,ot){this.key=nt,this.negated=ot,this.type=3}cmp(nt){return nt.type!==this.type?this.type-nt.type:cmp1(this.key,nt.key)}equals(nt){return nt.type===this.type?this.key===nt.key:!1}substituteConstants(){const nt=CONSTANT_VALUES.get(this.key);return typeof nt=="boolean"?nt?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE:this}evaluate(nt){return!nt.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyDefinedExpr.create(this.key,this)),this.negated}}function withFloatOrStr(ct,nt){if(typeof ct=="string"){const ot=parseFloat(ct);isNaN(ot)||(ct=ot)}return typeof ct=="string"||typeof ct=="number"?nt(ct):ContextKeyFalseExpr.INSTANCE}class ContextKeyGreaterExpr{static create(nt,ot,rt=null){return withFloatOrStr(ot,ut=>new ContextKeyGreaterExpr(nt,ut,rt))}constructor(nt,ot,rt){this.key=nt,this.value=ot,this.negated=rt,this.type=12}cmp(nt){return nt.type!==this.type?this.type-nt.type:cmp2(this.key,this.value,nt.key,nt.value)}equals(nt){return nt.type===this.type?this.key===nt.key&&this.value===nt.value:!1}substituteConstants(){return this}evaluate(nt){return typeof this.value=="string"?!1:parseFloat(nt.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeySmallerEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyGreaterEqualsExpr{static create(nt,ot,rt=null){return withFloatOrStr(ot,ut=>new ContextKeyGreaterEqualsExpr(nt,ut,rt))}constructor(nt,ot,rt){this.key=nt,this.value=ot,this.negated=rt,this.type=13}cmp(nt){return nt.type!==this.type?this.type-nt.type:cmp2(this.key,this.value,nt.key,nt.value)}equals(nt){return nt.type===this.type?this.key===nt.key&&this.value===nt.value:!1}substituteConstants(){return this}evaluate(nt){return typeof this.value=="string"?!1:parseFloat(nt.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeySmallerExpr.create(this.key,this.value,this)),this.negated}}class ContextKeySmallerExpr{static create(nt,ot,rt=null){return withFloatOrStr(ot,ut=>new ContextKeySmallerExpr(nt,ut,rt))}constructor(nt,ot,rt){this.key=nt,this.value=ot,this.negated=rt,this.type=14}cmp(nt){return nt.type!==this.type?this.type-nt.type:cmp2(this.key,this.value,nt.key,nt.value)}equals(nt){return nt.type===this.type?this.key===nt.key&&this.value===nt.value:!1}substituteConstants(){return this}evaluate(nt){return typeof this.value=="string"?!1:parseFloat(nt.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyGreaterEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeySmallerEqualsExpr{static create(nt,ot,rt=null){return withFloatOrStr(ot,ut=>new ContextKeySmallerEqualsExpr(nt,ut,rt))}constructor(nt,ot,rt){this.key=nt,this.value=ot,this.negated=rt,this.type=15}cmp(nt){return nt.type!==this.type?this.type-nt.type:cmp2(this.key,this.value,nt.key,nt.value)}equals(nt){return nt.type===this.type?this.key===nt.key&&this.value===nt.value:!1}substituteConstants(){return this}evaluate(nt){return typeof this.value=="string"?!1:parseFloat(nt.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyGreaterExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyRegexExpr{static create(nt,ot){return new ContextKeyRegexExpr(nt,ot)}constructor(nt,ot){this.key=nt,this.regexp=ot,this.type=7,this.negated=null}cmp(nt){if(nt.type!==this.type)return this.type-nt.type;if(this.key<nt.key)return-1;if(this.key>nt.key)return 1;const ot=this.regexp?this.regexp.source:"",rt=nt.regexp?nt.regexp.source:"";return ot<rt?-1:ot>rt?1:0}equals(nt){if(nt.type===this.type){const ot=this.regexp?this.regexp.source:"",rt=nt.regexp?nt.regexp.source:"";return this.key===nt.key&&ot===rt}return!1}substituteConstants(){return this}evaluate(nt){const ot=nt.getValue(this.key);return this.regexp?this.regexp.test(ot):!1}serialize(){const nt=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${nt}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotRegexExpr.create(this)),this.negated}}class ContextKeyNotRegexExpr{static create(nt){return new ContextKeyNotRegexExpr(nt)}constructor(nt){this._actual=nt,this.type=8}cmp(nt){return nt.type!==this.type?this.type-nt.type:this._actual.cmp(nt._actual)}equals(nt){return nt.type===this.type?this._actual.equals(nt._actual):!1}substituteConstants(){return this}evaluate(nt){return!this._actual.evaluate(nt)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}negate(){return this._actual}}function eliminateConstantsInArray(ct){let nt=null;for(let ot=0,rt=ct.length;ot<rt;ot++){const ut=ct[ot].substituteConstants();if(ct[ot]!==ut&&nt===null){nt=[];for(let gt=0;gt<ot;gt++)nt[gt]=ct[gt]}nt!==null&&(nt[ot]=ut)}return nt===null?ct:nt}class ContextKeyAndExpr{static create(nt,ot,rt){return ContextKeyAndExpr._normalizeArr(nt,ot,rt)}constructor(nt,ot){this.expr=nt,this.negated=ot,this.type=6}cmp(nt){if(nt.type!==this.type)return this.type-nt.type;if(this.expr.length<nt.expr.length)return-1;if(this.expr.length>nt.expr.length)return 1;for(let ot=0,rt=this.expr.length;ot<rt;ot++){const ut=cmp(this.expr[ot],nt.expr[ot]);if(ut!==0)return ut}return 0}equals(nt){if(nt.type===this.type){if(this.expr.length!==nt.expr.length)return!1;for(let ot=0,rt=this.expr.length;ot<rt;ot++)if(!this.expr[ot].equals(nt.expr[ot]))return!1;return!0}return!1}substituteConstants(){const nt=eliminateConstantsInArray(this.expr);return nt===this.expr?this:ContextKeyAndExpr.create(nt,this.negated,!1)}evaluate(nt){for(let ot=0,rt=this.expr.length;ot<rt;ot++)if(!this.expr[ot].evaluate(nt))return!1;return!0}static _normalizeArr(nt,ot,rt){const ut=[];let gt=!1;for(const pt of nt)if(pt){if(pt.type===1){gt=!0;continue}if(pt.type===0)return ContextKeyFalseExpr.INSTANCE;if(pt.type===6){ut.push(...pt.expr);continue}ut.push(pt)}if(ut.length===0&&gt)return ContextKeyTrueExpr.INSTANCE;if(ut.length!==0){if(ut.length===1)return ut[0];ut.sort(cmp);for(let pt=1;pt<ut.length;pt++)ut[pt-1].equals(ut[pt])&&(ut.splice(pt,1),pt--);if(ut.length===1)return ut[0];for(;ut.length>1;){const pt=ut[ut.length-1];if(pt.type!==9)break;ut.pop();const mt=ut.pop(),vt=ut.length===0,St=ContextKeyOrExpr.create(pt.expr.map(yt=>ContextKeyAndExpr.create([yt,mt],null,rt)),null,vt);St&&(ut.push(St),ut.sort(cmp))}if(ut.length===1)return ut[0];if(rt){for(let pt=0;pt<ut.length;pt++)for(let mt=pt+1;mt<ut.length;mt++)if(ut[pt].negate().equals(ut[mt]))return ContextKeyFalseExpr.INSTANCE;if(ut.length===1)return ut[0]}return new ContextKeyAndExpr(ut,ot)}}serialize(){return this.expr.map(nt=>nt.serialize()).join(" && ")}keys(){const nt=[];for(const ot of this.expr)nt.push(...ot.keys());return nt}negate(){if(!this.negated){const nt=[];for(const ot of this.expr)nt.push(ot.negate());this.negated=ContextKeyOrExpr.create(nt,this,!0)}return this.negated}}class ContextKeyOrExpr{static create(nt,ot,rt){return ContextKeyOrExpr._normalizeArr(nt,ot,rt)}constructor(nt,ot){this.expr=nt,this.negated=ot,this.type=9}cmp(nt){if(nt.type!==this.type)return this.type-nt.type;if(this.expr.length<nt.expr.length)return-1;if(this.expr.length>nt.expr.length)return 1;for(let ot=0,rt=this.expr.length;ot<rt;ot++){const ut=cmp(this.expr[ot],nt.expr[ot]);if(ut!==0)return ut}return 0}equals(nt){if(nt.type===this.type){if(this.expr.length!==nt.expr.length)return!1;for(let ot=0,rt=this.expr.length;ot<rt;ot++)if(!this.expr[ot].equals(nt.expr[ot]))return!1;return!0}return!1}substituteConstants(){const nt=eliminateConstantsInArray(this.expr);return nt===this.expr?this:ContextKeyOrExpr.create(nt,this.negated,!1)}evaluate(nt){for(let ot=0,rt=this.expr.length;ot<rt;ot++)if(this.expr[ot].evaluate(nt))return!0;return!1}static _normalizeArr(nt,ot,rt){let ut=[],gt=!1;if(nt){for(let pt=0,mt=nt.length;pt<mt;pt++){const vt=nt[pt];if(vt){if(vt.type===0){gt=!0;continue}if(vt.type===1)return ContextKeyTrueExpr.INSTANCE;if(vt.type===9){ut=ut.concat(vt.expr);continue}ut.push(vt)}}if(ut.length===0&&gt)return ContextKeyFalseExpr.INSTANCE;ut.sort(cmp)}if(ut.length!==0){if(ut.length===1)return ut[0];for(let pt=1;pt<ut.length;pt++)ut[pt-1].equals(ut[pt])&&(ut.splice(pt,1),pt--);if(ut.length===1)return ut[0];if(rt){for(let pt=0;pt<ut.length;pt++)for(let mt=pt+1;mt<ut.length;mt++)if(ut[pt].negate().equals(ut[mt]))return ContextKeyTrueExpr.INSTANCE;if(ut.length===1)return ut[0]}return new ContextKeyOrExpr(ut,ot)}}serialize(){return this.expr.map(nt=>nt.serialize()).join(" || ")}keys(){const nt=[];for(const ot of this.expr)nt.push(...ot.keys());return nt}negate(){if(!this.negated){const nt=[];for(const ot of this.expr)nt.push(ot.negate());for(;nt.length>1;){const ot=nt.shift(),rt=nt.shift(),ut=[];for(const gt of getTerminals(ot))for(const pt of getTerminals(rt))ut.push(ContextKeyAndExpr.create([gt,pt],null,!1));nt.unshift(ContextKeyOrExpr.create(ut,null,!1))}this.negated=ContextKeyOrExpr.create(nt,this,!0)}return this.negated}}class RawContextKey extends ContextKeyDefinedExpr{static all(){return RawContextKey._info.values()}constructor(nt,ot,rt){super(nt,null),this._defaultValue=ot,typeof rt=="object"?RawContextKey._info.push(Object.assign(Object.assign({},rt),{key:nt})):rt!==!0&&RawContextKey._info.push({key:nt,description:rt,type:ot!=null?typeof ot:void 0})}bindTo(nt){return nt.createKey(this.key,this._defaultValue)}getValue(nt){return nt.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(nt){return ContextKeyEqualsExpr.create(this.key,nt)}}RawContextKey._info=[];const IContextKeyService=createDecorator("contextKeyService");function cmp1(ct,nt){return ct<nt?-1:ct>nt?1:0}function cmp2(ct,nt,ot,rt){return ct<ot?-1:ct>ot?1:nt<rt?-1:nt>rt?1:0}function implies(ct,nt){if(ct.type===0||nt.type===1)return!0;if(ct.type===9)return nt.type===9?allElementsIncluded(ct.expr,nt.expr):!1;if(nt.type===9){for(const ot of nt.expr)if(implies(ct,ot))return!0;return!1}if(ct.type===6){if(nt.type===6)return allElementsIncluded(nt.expr,ct.expr);for(const ot of ct.expr)if(implies(ot,nt))return!0;return!1}return ct.equals(nt)}function allElementsIncluded(ct,nt){let ot=0,rt=0;for(;ot<ct.length&&rt<nt.length;){const ut=ct[ot].cmp(nt[rt]);if(ut<0)return!1;ut===0&&ot++,rt++}return ot===ct.length}function getTerminals(ct){return ct.type===9?ct.expr:[ct]}const IAccessibilityService=createDecorator("accessibilityService"),CONTEXT_ACCESSIBILITY_MODE_ENABLED=new RawContextKey("accessibilityModeEnabled",!1);var __decorate$26=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1$=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const defaultOptions$2={followsCaret:!0,ignoreCharChanges:!0,alwaysRevealFirst:!0,findResultLoop:!0};let DiffNavigator=class extends Disposable{constructor(nt,ot={},rt,ut,gt){super(),this._audioCueService=rt,this._codeEditorService=ut,this._accessibilityService=gt,this._onDidUpdate=this._register(new Emitter$2),this._editor=nt,this._options=mixin$1(ot,defaultOptions$2,!1),this.disposed=!1,this.nextIdx=-1,this.ranges=[],this.ignoreSelectionChange=!1,this.revealFirst=!!this._options.alwaysRevealFirst,this._register(this._editor.onDidDispose(()=>this.dispose())),this._register(this._editor.onDidUpdateDiff(()=>this._onDiffUpdated())),this._options.followsCaret&&this._register(this._editor.getModifiedEditor().onDidChangeCursorPosition(pt=>{this.ignoreSelectionChange||(this._updateAccessibilityState(pt.position.lineNumber),this.nextIdx=-1)})),this._options.alwaysRevealFirst&&this._register(this._editor.getModifiedEditor().onDidChangeModel(pt=>{this.revealFirst=!0})),this._init()}_init(){this._editor.getLineChanges()}_onDiffUpdated(){this._init(),this._compute(this._editor.getLineChanges()),this.revealFirst&&this._editor.getLineChanges()!==null&&(this.revealFirst=!1,this.nextIdx=-1,this.next(1))}_compute(nt){this.ranges=[],nt&&nt.forEach(ot=>{!this._options.ignoreCharChanges&&ot.charChanges?ot.charChanges.forEach(rt=>{this.ranges.push({rhs:!0,range:new Range$2(rt.modifiedStartLineNumber,rt.modifiedStartColumn,rt.modifiedEndLineNumber,rt.modifiedEndColumn)})}):ot.modifiedEndLineNumber===0?this.ranges.push({rhs:!0,range:new Range$2(ot.modifiedStartLineNumber,1,ot.modifiedStartLineNumber+1,1)}):this.ranges.push({rhs:!0,range:new Range$2(ot.modifiedStartLineNumber,1,ot.modifiedEndLineNumber+1,1)})}),this.ranges.sort((ot,rt)=>Range$2.compareRangesUsingStarts(ot.range,rt.range)),this._onDidUpdate.fire(this)}_initIdx(nt){let ot=!1;const rt=this._editor.getPosition();if(!rt){this.nextIdx=0;return}for(let ut=0,gt=this.ranges.length;ut<gt&&!ot;ut++){const pt=this.ranges[ut].range;rt.isBeforeOrEqual(pt.getStartPosition())&&(this.nextIdx=ut+(nt?0:-1),ot=!0)}ot||(this.nextIdx=nt?0:this.ranges.length-1),this.nextIdx<0&&(this.nextIdx=this.ranges.length-1)}_move(nt,ot){if(ok(!this.disposed,"Illegal State - diff navigator has been disposed"),!this.canNavigate())return;this.nextIdx===-1?this._initIdx(nt):nt?(this.nextIdx+=1,this.nextIdx>=this.ranges.length&&(this.nextIdx=0)):(this.nextIdx-=1,this.nextIdx<0&&(this.nextIdx=this.ranges.length-1));const rt=this.ranges[this.nextIdx];this.ignoreSelectionChange=!0;try{const ut=rt.range.getStartPosition();this._editor.setPosition(ut),this._editor.revealRangeInCenter(rt.range,ot),this._updateAccessibilityState(ut.lineNumber,!0)}finally{this.ignoreSelectionChange=!1}}_updateAccessibilityState(nt,ot){var rt;const ut=(rt=this._editor.getModel())===null||rt===void 0?void 0:rt.modified;if(!ut)return;const gt=ut.getLineDecorations(nt).find(mt=>mt.options.className==="line-insert");if(gt)this._audioCueService.playAudioCue(AudioCue.diffLineModified,!0);else if(ot)this._audioCueService.playAudioCue(AudioCue.diffLineDeleted,!0);else return;const pt=this._codeEditorService.getActiveCodeEditor();ot&&pt&&gt&&this._accessibilityService.isScreenReaderOptimized()&&(pt.setSelection({startLineNumber:nt,startColumn:0,endLineNumber:nt,endColumn:Number.MAX_VALUE}),pt.writeScreenReaderContent("diff-navigation"))}canNavigate(){return this.ranges&&this.ranges.length>0}next(nt=0){this.canNavigateNext()&&this._move(!0,nt)}previous(nt=0){this.canNavigatePrevious()&&this._move(!1,nt)}canNavigateNext(){return this.canNavigateLoop()||this.nextIdx<this.ranges.length-1}canNavigatePrevious(){return this.canNavigateLoop()||this.nextIdx!==0}canNavigateLoop(){return!!this._options.findResultLoop}dispose(){super.dispose(),this.ranges=[],this.disposed=!0}};DiffNavigator=__decorate$26([__param$1$(2,IAudioCueService),__param$1$(3,ICodeEditorService),__param$1$(4,IAccessibilityService)],DiffNavigator);const EditorType={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};var OverviewRulerLane;(function(ct){ct[ct.Left=1]="Left",ct[ct.Center=2]="Center",ct[ct.Right=4]="Right",ct[ct.Full=7]="Full"})(OverviewRulerLane||(OverviewRulerLane={}));var GlyphMarginLane;(function(ct){ct[ct.Left=1]="Left",ct[ct.Right=2]="Right"})(GlyphMarginLane||(GlyphMarginLane={}));var MinimapPosition;(function(ct){ct[ct.Inline=1]="Inline",ct[ct.Gutter=2]="Gutter"})(MinimapPosition||(MinimapPosition={}));var InjectedTextCursorStops;(function(ct){ct[ct.Both=0]="Both",ct[ct.Right=1]="Right",ct[ct.Left=2]="Left",ct[ct.None=3]="None"})(InjectedTextCursorStops||(InjectedTextCursorStops={}));class TextModelResolvedOptions{get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(nt){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,nt.tabSize|0),nt.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,nt.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!nt.insertSpaces,this.defaultEOL=nt.defaultEOL|0,this.trimAutoWhitespace=!!nt.trimAutoWhitespace,this.bracketPairColorizationOptions=nt.bracketPairColorizationOptions}equals(nt){return this.tabSize===nt.tabSize&&this._indentSizeIsTabSize===nt._indentSizeIsTabSize&&this.indentSize===nt.indentSize&&this.insertSpaces===nt.insertSpaces&&this.defaultEOL===nt.defaultEOL&&this.trimAutoWhitespace===nt.trimAutoWhitespace&&equals$1(this.bracketPairColorizationOptions,nt.bracketPairColorizationOptions)}createChangeEvent(nt){return{tabSize:this.tabSize!==nt.tabSize,indentSize:this.indentSize!==nt.indentSize,insertSpaces:this.insertSpaces!==nt.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==nt.trimAutoWhitespace}}}class FindMatch{constructor(nt,ot){this._findMatchBrand=void 0,this.range=nt,this.matches=ot}}function isITextSnapshot(ct){return ct&&typeof ct.read=="function"}class ValidAnnotatedEditOperation{constructor(nt,ot,rt,ut,gt,pt){this.identifier=nt,this.range=ot,this.text=rt,this.forceMoveMarkers=ut,this.isAutoWhitespaceEdit=gt,this._isTracked=pt}}class SearchData{constructor(nt,ot,rt){this.regex=nt,this.wordSeparators=ot,this.simpleSearch=rt}}class ApplyEditsResult{constructor(nt,ot,rt){this.reverseEdits=nt,this.changes=ot,this.trimAutoWhitespaceLineNumbers=rt}}function shouldSynchronizeModel(ct){return!ct.isTooLargeForSyncing()&&!ct.isForSimpleWidget}var IndentAction;(function(ct){ct[ct.None=0]="None",ct[ct.Indent=1]="Indent",ct[ct.IndentOutdent=2]="IndentOutdent",ct[ct.Outdent=3]="Outdent"})(IndentAction||(IndentAction={}));class StandardAutoClosingPairConditional{constructor(nt){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=nt.open,this.close=nt.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(nt.notIn))for(let ot=0,rt=nt.notIn.length;ot<rt;ot++)switch(nt.notIn[ot]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(nt){switch(nt){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(nt,ot){if(nt.getTokenCount()===0)return!0;const rt=nt.findTokenIndexAtOffset(ot-2),ut=nt.getStandardTokenType(rt);return this.isOK(ut)}_findNeutralCharacterInRange(nt,ot){for(let rt=nt;rt<=ot;rt++){const ut=String.fromCharCode(rt);if(!this.open.includes(ut)&&!this.close.includes(ut))return ut}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class AutoClosingPairs{constructor(nt){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const ot of nt)appendEntry(this.autoClosingPairsOpenByStart,ot.open.charAt(0),ot),appendEntry(this.autoClosingPairsOpenByEnd,ot.open.charAt(ot.open.length-1),ot),appendEntry(this.autoClosingPairsCloseByStart,ot.close.charAt(0),ot),appendEntry(this.autoClosingPairsCloseByEnd,ot.close.charAt(ot.close.length-1),ot),ot.close.length===1&&ot.open.length===1&&appendEntry(this.autoClosingPairsCloseSingleChar,ot.close,ot)}}function appendEntry(ct,nt,ot){ct.has(nt)?ct.get(nt).push(ot):ct.set(nt,[ot])}function createScopedLineTokens(ct,nt){const ot=ct.getCount(),rt=ct.findTokenIndexAtOffset(nt),ut=ct.getLanguageId(rt);let gt=rt;for(;gt+1<ot&&ct.getLanguageId(gt+1)===ut;)gt++;let pt=rt;for(;pt>0&&ct.getLanguageId(pt-1)===ut;)pt--;return new ScopedLineTokens(ct,ut,pt,gt+1,ct.getStartOffset(pt),ct.getEndOffset(gt))}class ScopedLineTokens{constructor(nt,ot,rt,ut,gt,pt){this._scopedLineTokensBrand=void 0,this._actual=nt,this.languageId=ot,this._firstTokenIndex=rt,this._lastTokenIndex=ut,this.firstCharOffset=gt,this._lastCharOffset=pt}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getActualLineContentBefore(nt){return this._actual.getLineContent().substring(0,this.firstCharOffset+nt)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(nt){return this._actual.findTokenIndexAtOffset(nt+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(nt){return this._actual.getStandardTokenType(nt+this._firstTokenIndex)}}function ignoreBracketsInToken(ct){return(ct&3)!==0}class CharacterPairSupport{constructor(nt){if(nt.autoClosingPairs?this._autoClosingPairs=nt.autoClosingPairs.map(ot=>new StandardAutoClosingPairConditional(ot)):nt.brackets?this._autoClosingPairs=nt.brackets.map(ot=>new StandardAutoClosingPairConditional({open:ot[0],close:ot[1]})):this._autoClosingPairs=[],nt.__electricCharacterSupport&&nt.__electricCharacterSupport.docComment){const ot=nt.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new StandardAutoClosingPairConditional({open:ot.open,close:ot.close||""}))}this._autoCloseBeforeForQuotes=typeof nt.autoCloseBefore=="string"?nt.autoCloseBefore:CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof nt.autoCloseBefore=="string"?nt.autoCloseBefore:CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=nt.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(nt){return nt?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}}CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;const hasBuffer=typeof Buffer<"u";let textDecoder;class VSBuffer{static wrap(nt){return hasBuffer&&!Buffer.isBuffer(nt)&&(nt=Buffer.from(nt.buffer,nt.byteOffset,nt.byteLength)),new VSBuffer(nt)}constructor(nt){this.buffer=nt,this.byteLength=this.buffer.byteLength}toString(){return hasBuffer?this.buffer.toString():(textDecoder||(textDecoder=new TextDecoder),textDecoder.decode(this.buffer))}}function readUInt16LE(ct,nt){return ct[nt+0]<<0>>>0|ct[nt+1]<<8>>>0}function writeUInt16LE(ct,nt,ot){ct[ot+0]=nt&255,nt=nt>>>8,ct[ot+1]=nt&255}function readUInt32BE(ct,nt){return ct[nt]*Math.pow(2,24)+ct[nt+1]*Math.pow(2,16)+ct[nt+2]*Math.pow(2,8)+ct[nt+3]}function writeUInt32BE(ct,nt,ot){ct[ot+3]=nt,nt=nt>>>8,ct[ot+2]=nt,nt=nt>>>8,ct[ot+1]=nt,nt=nt>>>8,ct[ot]=nt}function readUInt8(ct,nt){return ct[nt]}function writeUInt8(ct,nt,ot){ct[ot]=nt}let _utf16LE_TextDecoder;function getUTF16LE_TextDecoder(){return _utf16LE_TextDecoder||(_utf16LE_TextDecoder=new TextDecoder("UTF-16LE")),_utf16LE_TextDecoder}let _utf16BE_TextDecoder;function getUTF16BE_TextDecoder(){return _utf16BE_TextDecoder||(_utf16BE_TextDecoder=new TextDecoder("UTF-16BE")),_utf16BE_TextDecoder}let _platformTextDecoder;function getPlatformTextDecoder(){return _platformTextDecoder||(_platformTextDecoder=isLittleEndian()?getUTF16LE_TextDecoder():getUTF16BE_TextDecoder()),_platformTextDecoder}function decodeUTF16LE(ct,nt,ot){const rt=new Uint16Array(ct.buffer,nt,ot);return ot>0&&(rt[0]===65279||rt[0]===65534)?compatDecodeUTF16LE(ct,nt,ot):getUTF16LE_TextDecoder().decode(rt)}function compatDecodeUTF16LE(ct,nt,ot){const rt=[];let ut=0;for(let gt=0;gt<ot;gt++){const pt=readUInt16LE(ct,nt);nt+=2,rt[ut++]=String.fromCharCode(pt)}return rt.join("")}class StringBuilder{constructor(nt){this._capacity=nt|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const nt=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return getPlatformTextDecoder().decode(nt)}_flushBuffer(){const nt=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[nt]:this._completedStrings[this._completedStrings.length]=nt}appendCharCode(nt){const ot=this._capacity-this._bufferLength;ot<=1&&(ot===0||isHighSurrogate(nt))&&this._flushBuffer(),this._buffer[this._bufferLength++]=nt}appendASCIICharCode(nt){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=nt}appendString(nt){const ot=nt.length;if(this._bufferLength+ot>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=nt;return}for(let rt=0;rt<ot;rt++)this._buffer[this._bufferLength++]=nt.charCodeAt(rt)}}class RichEditBracket{constructor(nt,ot,rt,ut,gt,pt){this._richEditBracketBrand=void 0,this.languageId=nt,this.index=ot,this.open=rt,this.close=ut,this.forwardRegex=gt,this.reversedRegex=pt,this._openSet=RichEditBracket._toSet(this.open),this._closeSet=RichEditBracket._toSet(this.close)}isOpen(nt){return this._openSet.has(nt)}isClose(nt){return this._closeSet.has(nt)}static _toSet(nt){const ot=new Set;for(const rt of nt)ot.add(rt);return ot}}function groupFuzzyBrackets(ct){const nt=ct.length;ct=ct.map(pt=>[pt[0].toLowerCase(),pt[1].toLowerCase()]);const ot=[];for(let pt=0;pt<nt;pt++)ot[pt]=pt;const rt=(pt,mt)=>{const[vt,St]=pt,[yt,wt]=mt;return vt===yt||vt===wt||St===yt||St===wt},ut=(pt,mt)=>{const vt=Math.min(pt,mt),St=Math.max(pt,mt);for(let yt=0;yt<nt;yt++)ot[yt]===St&&(ot[yt]=vt)};for(let pt=0;pt<nt;pt++){const mt=ct[pt];for(let vt=pt+1;vt<nt;vt++){const St=ct[vt];rt(mt,St)&&ut(ot[pt],ot[vt])}}const gt=[];for(let pt=0;pt<nt;pt++){const mt=[],vt=[];for(let St=0;St<nt;St++)if(ot[St]===pt){const[yt,wt]=ct[St];mt.push(yt),vt.push(wt)}mt.length>0&&gt.push({open:mt,close:vt})}return gt}class RichEditBrackets{constructor(nt,ot){this._richEditBracketsBrand=void 0;const rt=groupFuzzyBrackets(ot);this.brackets=rt.map((ut,gt)=>new RichEditBracket(nt,gt,ut.open,ut.close,getRegexForBracketPair(ut.open,ut.close,rt,gt),getReversedRegexForBracketPair(ut.open,ut.close,rt,gt))),this.forwardRegex=getRegexForBrackets(this.brackets),this.reversedRegex=getReversedRegexForBrackets(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const ut of this.brackets){for(const gt of ut.open)this.textIsBracket[gt]=ut,this.textIsOpenBracket[gt]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,gt.length);for(const gt of ut.close)this.textIsBracket[gt]=ut,this.textIsOpenBracket[gt]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,gt.length)}}}function collectSuperstrings(ct,nt,ot,rt){for(let ut=0,gt=nt.length;ut<gt;ut++){if(ut===ot)continue;const pt=nt[ut];for(const mt of pt.open)mt.indexOf(ct)>=0&&rt.push(mt);for(const mt of pt.close)mt.indexOf(ct)>=0&&rt.push(mt)}}function lengthcmp(ct,nt){return ct.length-nt.length}function unique(ct){if(ct.length<=1)return ct;const nt=[],ot=new Set;for(const rt of ct)ot.has(rt)||(nt.push(rt),ot.add(rt));return nt}function getRegexForBracketPair(ct,nt,ot,rt){let ut=[];ut=ut.concat(ct),ut=ut.concat(nt);for(let gt=0,pt=ut.length;gt<pt;gt++)collectSuperstrings(ut[gt],ot,rt,ut);return ut=unique(ut),ut.sort(lengthcmp),ut.reverse(),createBracketOrRegExp(ut)}function getReversedRegexForBracketPair(ct,nt,ot,rt){let ut=[];ut=ut.concat(ct),ut=ut.concat(nt);for(let gt=0,pt=ut.length;gt<pt;gt++)collectSuperstrings(ut[gt],ot,rt,ut);return ut=unique(ut),ut.sort(lengthcmp),ut.reverse(),createBracketOrRegExp(ut.map(toReversedString))}function getRegexForBrackets(ct){let nt=[];for(const ot of ct){for(const rt of ot.open)nt.push(rt);for(const rt of ot.close)nt.push(rt)}return nt=unique(nt),createBracketOrRegExp(nt)}function getReversedRegexForBrackets(ct){let nt=[];for(const ot of ct){for(const rt of ot.open)nt.push(rt);for(const rt of ot.close)nt.push(rt)}return nt=unique(nt),createBracketOrRegExp(nt.map(toReversedString))}function prepareBracketForRegExp$1(ct){const nt=/^[\w ]+$/.test(ct);return ct=escapeRegExpCharacters(ct),nt?`\\b${ct}\\b`:ct}function createBracketOrRegExp(ct){const nt=`(${ct.map(prepareBracketForRegExp$1).join(")|(")})`;return createRegExp(nt,!0)}const toReversedString=function(){function ct(rt){const ut=new Uint16Array(rt.length);let gt=0;for(let pt=rt.length-1;pt>=0;pt--)ut[gt++]=rt.charCodeAt(pt);return getPlatformTextDecoder().decode(ut)}let nt=null,ot=null;return function(ut){return nt!==ut&&(nt=ut,ot=ct(nt)),ot}}();class BracketsUtils{static _findPrevBracketInText(nt,ot,rt,ut){const gt=rt.match(nt);if(!gt)return null;const pt=rt.length-(gt.index||0),mt=gt[0].length,vt=ut+pt;return new Range$2(ot,vt-mt+1,ot,vt+1)}static findPrevBracketInRange(nt,ot,rt,ut,gt){const mt=toReversedString(rt).substring(rt.length-gt,rt.length-ut);return this._findPrevBracketInText(nt,ot,mt,ut)}static findNextBracketInText(nt,ot,rt,ut){const gt=rt.match(nt);if(!gt)return null;const pt=gt.index||0,mt=gt[0].length;if(mt===0)return null;const vt=ut+pt;return new Range$2(ot,vt+1,ot,vt+1+mt)}static findNextBracketInRange(nt,ot,rt,ut,gt){const pt=rt.substring(ut,gt);return this.findNextBracketInText(nt,ot,pt,ut)}}class BracketElectricCharacterSupport{constructor(nt){this._richEditBrackets=nt}getElectricCharacters(){const nt=[];if(this._richEditBrackets)for(const ot of this._richEditBrackets.brackets)for(const rt of ot.close){const ut=rt.charAt(rt.length-1);nt.push(ut)}return distinct(nt)}onElectricCharacter(nt,ot,rt){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const ut=ot.findTokenIndexAtOffset(rt-1);if(ignoreBracketsInToken(ot.getStandardTokenType(ut)))return null;const gt=this._richEditBrackets.reversedRegex,pt=ot.getLineContent().substring(0,rt-1)+nt,mt=BracketsUtils.findPrevBracketInRange(gt,1,pt,0,pt.length);if(!mt)return null;const vt=pt.substring(mt.startColumn-1,mt.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[vt])return null;const yt=ot.getActualLineContentBefore(mt.startColumn-1);return/^\s*$/.test(yt)?{matchOpenBracket:vt}:null}}function resetGlobalRegex(ct){return ct.global&&(ct.lastIndex=0),!0}class IndentRulesSupport{constructor(nt){this._indentationRules=nt}shouldIncrease(nt){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&resetGlobalRegex(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(nt))}shouldDecrease(nt){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&resetGlobalRegex(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(nt))}shouldIndentNextLine(nt){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&resetGlobalRegex(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(nt))}shouldIgnore(nt){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&resetGlobalRegex(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(nt))}getIndentMetadata(nt){let ot=0;return this.shouldIncrease(nt)&&(ot+=1),this.shouldDecrease(nt)&&(ot+=2),this.shouldIndentNextLine(nt)&&(ot+=4),this.shouldIgnore(nt)&&(ot+=8),ot}}class OnEnterSupport{constructor(nt){nt=nt||{},nt.brackets=nt.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],nt.brackets.forEach(ot=>{const rt=OnEnterSupport._createOpenBracketRegExp(ot[0]),ut=OnEnterSupport._createCloseBracketRegExp(ot[1]);rt&&ut&&this._brackets.push({open:ot[0],openRegExp:rt,close:ot[1],closeRegExp:ut})}),this._regExpRules=nt.onEnterRules||[]}onEnter(nt,ot,rt,ut){if(nt>=3)for(let gt=0,pt=this._regExpRules.length;gt<pt;gt++){const mt=this._regExpRules[gt];if([{reg:mt.beforeText,text:rt},{reg:mt.afterText,text:ut},{reg:mt.previousLineText,text:ot}].every(St=>St.reg?(St.reg.lastIndex=0,St.reg.test(St.text)):!0))return mt.action}if(nt>=2&&rt.length>0&&ut.length>0)for(let gt=0,pt=this._brackets.length;gt<pt;gt++){const mt=this._brackets[gt];if(mt.openRegExp.test(rt)&&mt.closeRegExp.test(ut))return{indentAction:IndentAction.IndentOutdent}}if(nt>=2&&rt.length>0){for(let gt=0,pt=this._brackets.length;gt<pt;gt++)if(this._brackets[gt].openRegExp.test(rt))return{indentAction:IndentAction.Indent}}return null}static _createOpenBracketRegExp(nt){let ot=escapeRegExpCharacters(nt);return/\B/.test(ot.charAt(0))||(ot="\\b"+ot),ot+="\\s*$",OnEnterSupport._safeRegExp(ot)}static _createCloseBracketRegExp(nt){let ot=escapeRegExpCharacters(nt);return/\B/.test(ot.charAt(ot.length-1))||(ot=ot+"\\b"),ot="^\\s*"+ot,OnEnterSupport._safeRegExp(ot)}static _safeRegExp(nt){try{return new RegExp(nt)}catch(ot){return onUnexpectedError(ot),null}}}const IConfigurationService=createDecorator("configurationService");function toValuesTree(ct,nt){const ot=Object.create(null);for(const rt in ct)addToValueTree(ot,rt,ct[rt],nt);return ot}function addToValueTree(ct,nt,ot,rt){const ut=nt.split("."),gt=ut.pop();let pt=ct;for(let mt=0;mt<ut.length;mt++){const vt=ut[mt];let St=pt[vt];switch(typeof St){case"undefined":St=pt[vt]=Object.create(null);break;case"object":break;default:rt(`Ignoring ${nt} as ${ut.slice(0,mt+1).join(".")} is ${JSON.stringify(St)}`);return}pt=St}if(typeof pt=="object"&&pt!==null)try{pt[gt]=ot}catch{rt(`Ignoring ${nt} as ${ut.join(".")} is ${JSON.stringify(pt)}`)}else rt(`Ignoring ${nt} as ${ut.join(".")} is ${JSON.stringify(pt)}`)}function removeFromValueTree(ct,nt){const ot=nt.split(".");doRemoveFromValueTree(ct,ot)}function doRemoveFromValueTree(ct,nt){const ot=nt.shift();if(nt.length===0){delete ct[ot];return}if(Object.keys(ct).indexOf(ot)!==-1){const rt=ct[ot];typeof rt=="object"&&!Array.isArray(rt)&&(doRemoveFromValueTree(rt,nt),Object.keys(rt).length===0&&delete ct[ot])}}function getConfigurationValue(ct,nt,ot){function rt(pt,mt){let vt=pt;for(const St of mt){if(typeof vt!="object"||vt===null)return;vt=vt[St]}return vt}const ut=nt.split("."),gt=rt(ct,ut);return typeof gt>"u"?ot:gt}function getLanguageTagSettingPlainKey(ct){return ct.replace(/[\[\]]/g,"")}const ILanguageService=createDecorator("languageService");class SyncDescriptor{constructor(nt,ot=[],rt=!1){this.ctor=nt,this.staticArguments=ot,this.supportsDelayedInstantiation=rt}}const _registry=[];function registerSingleton(ct,nt,ot){nt instanceof SyncDescriptor||(nt=new SyncDescriptor(nt,[],!!ot)),_registry.push([ct,nt])}function getSingletonServiceDescriptors(){return _registry}class RegistryImpl{constructor(){this.data=new Map}add(nt,ot){ok(isString$1(nt)),ok(isObject$1(ot)),ok(!this.data.has(nt),"There is already an extension with this id"),this.data.set(nt,ot)}as(nt){return this.data.get(nt)||null}}const Registry=new RegistryImpl,Mimes=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),Extensions$9={JSONContribution:"base.contributions.json"};function normalizeId(ct){return ct.length>0&&ct.charAt(ct.length-1)==="#"?ct.substring(0,ct.length-1):ct}class JSONContributionRegistry{constructor(){this._onDidChangeSchema=new Emitter$2,this.schemasById={}}registerSchema(nt,ot){this.schemasById[normalizeId(nt)]=ot,this._onDidChangeSchema.fire(nt)}notifySchemaChanged(nt){this._onDidChangeSchema.fire(nt)}}const jsonContributionRegistry=new JSONContributionRegistry;Registry.add(Extensions$9.JSONContribution,jsonContributionRegistry);const Extensions$8={Configuration:"base.contributions.configuration"},resourceLanguageSettingsSchemaId="vscode://schemas/settings/resourceLanguage",contributionRegistry=Registry.as(Extensions$9.JSONContribution);class ConfigurationRegistry{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new Emitter$2,this._onDidUpdateConfiguration=new Emitter$2,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:localize("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},contributionRegistry.registerSchema(resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(nt,ot=!0){this.registerConfigurations([nt],ot)}registerConfigurations(nt,ot=!0){const rt=new Set;this.doRegisterConfigurations(nt,ot,rt),contributionRegistry.registerSchema(resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:rt})}registerDefaultConfigurations(nt){const ot=new Set;this.doRegisterDefaultConfigurations(nt,ot),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:ot,defaultsOverrides:!0})}doRegisterDefaultConfigurations(nt,ot){var rt;const ut=[];for(const{overrides:gt,source:pt}of nt)for(const mt in gt)if(ot.add(mt),OVERRIDE_PROPERTY_REGEX.test(mt)){const vt=this.configurationDefaultsOverrides.get(mt),St=(rt=vt==null?void 0:vt.valuesSources)!==null&&rt!==void 0?rt:new Map;if(pt)for(const xt of Object.keys(gt[mt]))St.set(xt,pt);const yt=Object.assign(Object.assign({},(vt==null?void 0:vt.value)||{}),gt[mt]);this.configurationDefaultsOverrides.set(mt,{source:pt,value:yt,valuesSources:St});const wt=getLanguageTagSettingPlainKey(mt),Lt={type:"object",default:yt,description:localize("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",wt),$ref:resourceLanguageSettingsSchemaId,defaultDefaultValue:yt,source:isString$1(pt)?void 0:pt,defaultValueSource:pt};ut.push(...overrideIdentifiersFromKey(mt)),this.configurationProperties[mt]=Lt,this.defaultLanguageConfigurationOverridesNode.properties[mt]=Lt}else{this.configurationDefaultsOverrides.set(mt,{value:gt[mt],source:pt});const vt=this.configurationProperties[mt];vt&&(this.updatePropertyDefaultValue(mt,vt),this.updateSchema(mt,vt))}this.doRegisterOverrideIdentifiers(ut)}registerOverrideIdentifiers(nt){this.doRegisterOverrideIdentifiers(nt),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(nt){for(const ot of nt)this.overrideIdentifiers.add(ot);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(nt,ot,rt){nt.forEach(ut=>{this.validateAndRegisterProperties(ut,ot,ut.extensionInfo,ut.restrictedProperties,void 0,rt),this.configurationContributors.push(ut),this.registerJSONConfiguration(ut)})}validateAndRegisterProperties(nt,ot=!0,rt,ut,gt=3,pt){var mt;gt=isUndefinedOrNull(nt.scope)?gt:nt.scope;const vt=nt.properties;if(vt)for(const yt in vt){const wt=vt[yt];if(ot&&validateProperty(yt,wt)){delete vt[yt];continue}if(wt.source=rt,wt.defaultDefaultValue=vt[yt].default,this.updatePropertyDefaultValue(yt,wt),OVERRIDE_PROPERTY_REGEX.test(yt)?wt.scope=void 0:(wt.scope=isUndefinedOrNull(wt.scope)?gt:wt.scope,wt.restricted=isUndefinedOrNull(wt.restricted)?!!(ut!=null&&ut.includes(yt)):wt.restricted),vt[yt].hasOwnProperty("included")&&!vt[yt].included){this.excludedConfigurationProperties[yt]=vt[yt],delete vt[yt];continue}else this.configurationProperties[yt]=vt[yt],!((mt=vt[yt].policy)===null||mt===void 0)&&mt.name&&this.policyConfigurations.set(vt[yt].policy.name,yt);!vt[yt].deprecationMessage&&vt[yt].markdownDeprecationMessage&&(vt[yt].deprecationMessage=vt[yt].markdownDeprecationMessage),pt.add(yt)}const St=nt.allOf;if(St)for(const yt of St)this.validateAndRegisterProperties(yt,ot,rt,ut,gt,pt)}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}registerJSONConfiguration(nt){const ot=rt=>{const ut=rt.properties;if(ut)for(const pt in ut)this.updateSchema(pt,ut[pt]);const gt=rt.allOf;gt==null||gt.forEach(ot)};ot(nt)}updateSchema(nt,ot){switch(ot.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[nt]=ot;break}}updateOverridePropertyPatternKey(){for(const nt of this.overrideIdentifiers.values()){const ot=`[${nt}]`,rt={type:"object",description:localize("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:localize("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:resourceLanguageSettingsSchemaId};this.updatePropertyDefaultValue(ot,rt)}}registerOverridePropertyPatternKey(){localize("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),localize("overrideSettings.errorMessage","This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(nt,ot){const rt=this.configurationDefaultsOverrides.get(nt);let ut=rt==null?void 0:rt.value,gt=rt==null?void 0:rt.source;isUndefined(ut)&&(ut=ot.defaultDefaultValue,gt=void 0),isUndefined(ut)&&(ut=getDefaultValue(ot.type)),ot.default=ut,ot.defaultValueSource=gt}}const OVERRIDE_IDENTIFIER_PATTERN="\\[([^\\]]+)\\]",OVERRIDE_IDENTIFIER_REGEX=new RegExp(OVERRIDE_IDENTIFIER_PATTERN,"g"),OVERRIDE_PROPERTY_PATTERN=`^(${OVERRIDE_IDENTIFIER_PATTERN})+$`,OVERRIDE_PROPERTY_REGEX=new RegExp(OVERRIDE_PROPERTY_PATTERN);function overrideIdentifiersFromKey(ct){const nt=[];if(OVERRIDE_PROPERTY_REGEX.test(ct)){let ot=OVERRIDE_IDENTIFIER_REGEX.exec(ct);for(;ot!=null&&ot.length;){const rt=ot[1].trim();rt&&nt.push(rt),ot=OVERRIDE_IDENTIFIER_REGEX.exec(ct)}}return distinct(nt)}function getDefaultValue(ct){switch(Array.isArray(ct)?ct[0]:ct){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const configurationRegistry$2=new ConfigurationRegistry;Registry.add(Extensions$8.Configuration,configurationRegistry$2);function validateProperty(ct,nt){var ot,rt,ut,gt;return ct.trim()?OVERRIDE_PROPERTY_REGEX.test(ct)?localize("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",ct):configurationRegistry$2.getConfigurationProperties()[ct]!==void 0?localize("config.property.duplicate","Cannot register '{0}'. This property is already registered.",ct):!((ot=nt.policy)===null||ot===void 0)&&ot.name&&configurationRegistry$2.getPolicyConfigurations().get((rt=nt.policy)===null||rt===void 0?void 0:rt.name)!==void 0?localize("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",ct,(ut=nt.policy)===null||ut===void 0?void 0:ut.name,configurationRegistry$2.getPolicyConfigurations().get((gt=nt.policy)===null||gt===void 0?void 0:gt.name)):null:localize("config.property.empty","Cannot register an empty property")}const Extensions$7={ModesRegistry:"editor.modesRegistry"};class EditorModesRegistry{constructor(){this._onDidChangeLanguages=new Emitter$2,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(nt){return this._languages.push(nt),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let ot=0,rt=this._languages.length;ot<rt;ot++)if(this._languages[ot]===nt){this._languages.splice(ot,1);return}}}}getLanguages(){return this._languages}}const ModesRegistry=new EditorModesRegistry;Registry.add(Extensions$7.ModesRegistry,ModesRegistry);const PLAINTEXT_LANGUAGE_ID="plaintext",PLAINTEXT_EXTENSION=".txt";ModesRegistry.registerLanguage({id:PLAINTEXT_LANGUAGE_ID,extensions:[PLAINTEXT_EXTENSION],aliases:[localize("plainText.alias","Plain Text"),"text"],mimetypes:[Mimes.text]});Registry.as(Extensions$8.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);class LanguageBracketsConfiguration{constructor(nt,ot){this.languageId=nt;const rt=ot.brackets?filterValidBrackets(ot.brackets):[],ut=new CachedFunction(mt=>{const vt=new Set;return{info:new OpeningBracketKind(this,mt,vt),closing:vt}}),gt=new CachedFunction(mt=>{const vt=new Set,St=new Set;return{info:new ClosingBracketKind(this,mt,vt,St),opening:vt,openingColorized:St}});for(const[mt,vt]of rt){const St=ut.get(mt),yt=gt.get(vt);St.closing.add(yt.info),yt.opening.add(St.info)}const pt=ot.colorizedBracketPairs?filterValidBrackets(ot.colorizedBracketPairs):rt.filter(mt=>!(mt[0]==="<"&&mt[1]===">"));for(const[mt,vt]of pt){const St=ut.get(mt),yt=gt.get(vt);St.closing.add(yt.info),yt.openingColorized.add(St.info),yt.opening.add(St.info)}this._openingBrackets=new Map([...ut.cachedValues].map(([mt,vt])=>[mt,vt.info])),this._closingBrackets=new Map([...gt.cachedValues].map(([mt,vt])=>[mt,vt.info]))}get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(nt){return this._openingBrackets.get(nt)}getClosingBracketInfo(nt){return this._closingBrackets.get(nt)}getBracketInfo(nt){return this.getOpeningBracketInfo(nt)||this.getClosingBracketInfo(nt)}}function filterValidBrackets(ct){return ct.filter(([nt,ot])=>nt!==""&&ot!=="")}class BracketKindBase{constructor(nt,ot){this.config=nt,this.bracketText=ot}get languageId(){return this.config.languageId}}class OpeningBracketKind extends BracketKindBase{constructor(nt,ot,rt){super(nt,ot),this.openedBrackets=rt,this.isOpeningBracket=!0}}class ClosingBracketKind extends BracketKindBase{constructor(nt,ot,rt,ut){super(nt,ot),this.openingBrackets=rt,this.openingColorizedBrackets=ut,this.isOpeningBracket=!1}closes(nt){return nt.config!==this.config?!1:this.openingBrackets.has(nt)}closesColorized(nt){return nt.config!==this.config?!1:this.openingColorizedBrackets.has(nt)}getOpeningBrackets(){return[...this.openingBrackets]}}var __decorate$25=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1_=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};class LanguageConfigurationServiceChangeEvent{constructor(nt){this.languageId=nt}affects(nt){return this.languageId?this.languageId===nt:!0}}const ILanguageConfigurationService=createDecorator("languageConfigurationService");let LanguageConfigurationService=class extends Disposable{constructor(nt,ot){super(),this.configurationService=nt,this.languageService=ot,this._registry=this._register(new LanguageConfigurationRegistry),this.onDidChangeEmitter=this._register(new Emitter$2),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const rt=new Set(Object.values(customizedLanguageConfigKeys));this._register(this.configurationService.onDidChangeConfiguration(ut=>{const gt=ut.change.keys.some(mt=>rt.has(mt)),pt=ut.change.overrides.filter(([mt,vt])=>vt.some(St=>rt.has(St))).map(([mt])=>mt);if(gt)this.configurations.clear(),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(void 0));else for(const mt of pt)this.languageService.isRegisteredLanguageId(mt)&&(this.configurations.delete(mt),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(mt)))})),this._register(this._registry.onDidChange(ut=>{this.configurations.delete(ut.languageId),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(ut.languageId))}))}register(nt,ot,rt){return this._registry.register(nt,ot,rt)}getLanguageConfiguration(nt){let ot=this.configurations.get(nt);return ot||(ot=computeConfig(nt,this._registry,this.configurationService,this.languageService),this.configurations.set(nt,ot)),ot}};LanguageConfigurationService=__decorate$25([__param$1_(0,IConfigurationService),__param$1_(1,ILanguageService)],LanguageConfigurationService);function computeConfig(ct,nt,ot,rt){let ut=nt.getLanguageConfiguration(ct);if(!ut){if(!rt.isRegisteredLanguageId(ct))return new ResolvedLanguageConfiguration(ct,{});ut=new ResolvedLanguageConfiguration(ct,{})}const gt=getCustomizedLanguageConfig(ut.languageId,ot),pt=combineLanguageConfigurations([ut.underlyingConfig,gt]);return new ResolvedLanguageConfiguration(ut.languageId,pt)}const customizedLanguageConfigKeys={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function getCustomizedLanguageConfig(ct,nt){const ot=nt.getValue(customizedLanguageConfigKeys.brackets,{overrideIdentifier:ct}),rt=nt.getValue(customizedLanguageConfigKeys.colorizedBracketPairs,{overrideIdentifier:ct});return{brackets:validateBracketPairs(ot),colorizedBracketPairs:validateBracketPairs(rt)}}function validateBracketPairs(ct){if(Array.isArray(ct))return ct.map(nt=>{if(!(!Array.isArray(nt)||nt.length!==2))return[nt[0],nt[1]]}).filter(nt=>!!nt)}function getIndentationAtPosition(ct,nt,ot){const rt=ct.getLineContent(nt);let ut=getLeadingWhitespace(rt);return ut.length>ot-1&&(ut=ut.substring(0,ot-1)),ut}function getScopedLineTokens(ct,nt,ot){ct.tokenization.forceTokenization(nt);const rt=ct.tokenization.getLineTokens(nt),ut=typeof ot>"u"?ct.getLineMaxColumn(nt)-1:ot-1;return createScopedLineTokens(rt,ut)}class ComposedLanguageConfiguration{constructor(nt){this.languageId=nt,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(nt,ot){const rt=new LanguageConfigurationContribution(nt,ot,++this._order);return this._entries.push(rt),this._resolved=null,toDisposable(()=>{for(let ut=0;ut<this._entries.length;ut++)if(this._entries[ut]===rt){this._entries.splice(ut,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){const nt=this._resolve();nt&&(this._resolved=new ResolvedLanguageConfiguration(this.languageId,nt))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(LanguageConfigurationContribution.cmp),combineLanguageConfigurations(this._entries.map(nt=>nt.configuration)))}}function combineLanguageConfigurations(ct){let nt={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const ot of ct)nt={comments:ot.comments||nt.comments,brackets:ot.brackets||nt.brackets,wordPattern:ot.wordPattern||nt.wordPattern,indentationRules:ot.indentationRules||nt.indentationRules,onEnterRules:ot.onEnterRules||nt.onEnterRules,autoClosingPairs:ot.autoClosingPairs||nt.autoClosingPairs,surroundingPairs:ot.surroundingPairs||nt.surroundingPairs,autoCloseBefore:ot.autoCloseBefore||nt.autoCloseBefore,folding:ot.folding||nt.folding,colorizedBracketPairs:ot.colorizedBracketPairs||nt.colorizedBracketPairs,__electricCharacterSupport:ot.__electricCharacterSupport||nt.__electricCharacterSupport};return nt}class LanguageConfigurationContribution{constructor(nt,ot,rt){this.configuration=nt,this.priority=ot,this.order=rt}static cmp(nt,ot){return nt.priority===ot.priority?nt.order-ot.order:nt.priority-ot.priority}}class LanguageConfigurationChangeEvent{constructor(nt){this.languageId=nt}}class LanguageConfigurationRegistry extends Disposable{constructor(){super(),this._entries=new Map,this._onDidChange=this._register(new Emitter$2),this.onDidChange=this._onDidChange.event,this._register(this.register(PLAINTEXT_LANGUAGE_ID,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(nt,ot,rt=0){let ut=this._entries.get(nt);ut||(ut=new ComposedLanguageConfiguration(nt),this._entries.set(nt,ut));const gt=ut.register(ot,rt);return this._onDidChange.fire(new LanguageConfigurationChangeEvent(nt)),toDisposable(()=>{gt.dispose(),this._onDidChange.fire(new LanguageConfigurationChangeEvent(nt))})}getLanguageConfiguration(nt){const ot=this._entries.get(nt);return(ot==null?void 0:ot.getResolvedConfiguration())||null}}class ResolvedLanguageConfiguration{constructor(nt,ot){this.languageId=nt,this.underlyingConfig=ot,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new OnEnterSupport(this.underlyingConfig):null,this.comments=ResolvedLanguageConfiguration._handleComments(this.underlyingConfig),this.characterPair=new CharacterPairSupport(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||DEFAULT_WORD_REGEXP,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new IndentRulesSupport(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new LanguageBracketsConfiguration(nt,this.underlyingConfig)}getWordDefinition(){return ensureValidWordDefinition(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new RichEditBrackets(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new BracketElectricCharacterSupport(this.brackets)),this._electricCharacter}onEnter(nt,ot,rt,ut){return this._onEnterSupport?this._onEnterSupport.onEnter(nt,ot,rt,ut):null}getAutoClosingPairs(){return new AutoClosingPairs(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(nt){return this.characterPair.getAutoCloseBeforeSet(nt)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(nt){const ot=nt.comments;if(!ot)return null;const rt={};if(ot.lineComment&&(rt.lineCommentToken=ot.lineComment),ot.blockComment){const[ut,gt]=ot.blockComment;rt.blockCommentStartToken=ut,rt.blockCommentEndToken=gt}return rt}}registerSingleton(ILanguageConfigurationService,LanguageConfigurationService,1);const NullState=new class{clone(){return this}equals(ct){return this===ct}};function nullTokenize(ct,nt){return new TokenizationResult([new Token$2(0,"",ct)],nt)}function nullTokenizeEncoded(ct,nt){const ot=new Uint32Array(2);return ot[0]=0,ot[1]=(ct<<0|0|0|32768|2<<24)>>>0,new EncodedTokenizationResult(ot,nt===null?NullState:nt)}const IModelService=createDecorator("modelService"),MicrotaskDelay=Symbol("MicrotaskDelay");var __awaiter$1u=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},__asyncValues$2=globalThis&&globalThis.__asyncValues||function(ct){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var nt=ct[Symbol.asyncIterator],ot;return nt?nt.call(ct):(ct=typeof __values=="function"?__values(ct):ct[Symbol.iterator](),ot={},rt("next"),rt("throw"),rt("return"),ot[Symbol.asyncIterator]=function(){return this},ot);function rt(gt){ot[gt]=ct[gt]&&function(pt){return new Promise(function(mt,vt){pt=ct[gt](pt),ut(mt,vt,pt.done,pt.value)})}}function ut(gt,pt,mt,vt){Promise.resolve(vt).then(function(St){gt({value:St,done:mt})},pt)}};function isThenable$1(ct){return!!ct&&typeof ct.then=="function"}function createCancelablePromise(ct){const nt=new CancellationTokenSource$1,ot=ct(nt.token),rt=new Promise((ut,gt)=>{const pt=nt.token.onCancellationRequested(()=>{pt.dispose(),nt.dispose(),gt(new CancellationError)});Promise.resolve(ot).then(mt=>{pt.dispose(),nt.dispose(),ut(mt)},mt=>{pt.dispose(),nt.dispose(),gt(mt)})});return new class{cancel(){nt.cancel()}then(ut,gt){return rt.then(ut,gt)}catch(ut){return this.then(void 0,ut)}finally(ut){return rt.finally(ut)}}}function raceCancellation(ct,nt,ot){return new Promise((rt,ut)=>{const gt=nt.onCancellationRequested(()=>{gt.dispose(),rt(ot)});ct.then(rt,ut).finally(()=>gt.dispose())})}class Throttler{constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(nt){if(this.activePromise){if(this.queuedPromiseFactory=nt,!this.queuedPromise){const ot=()=>{this.queuedPromise=null;const rt=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,rt};this.queuedPromise=new Promise(rt=>{this.activePromise.then(ot,ot).then(rt)})}return new Promise((ot,rt)=>{this.queuedPromise.then(ot,rt)})}return this.activePromise=nt(),new Promise((ot,rt)=>{this.activePromise.then(ut=>{this.activePromise=null,ot(ut)},ut=>{this.activePromise=null,rt(ut)})})}}const timeoutDeferred=(ct,nt)=>{let ot=!0;const rt=setTimeout(()=>{ot=!1,nt()},ct);return{isTriggered:()=>ot,dispose:()=>{clearTimeout(rt),ot=!1}}},microtaskDeferred=ct=>{let nt=!0;return queueMicrotask(()=>{nt&&(nt=!1,ct())}),{isTriggered:()=>nt,dispose:()=>{nt=!1}}};class Delayer{constructor(nt){this.defaultDelay=nt,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(nt,ot=this.defaultDelay){this.task=nt,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((ut,gt)=>{this.doResolve=ut,this.doReject=gt}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const ut=this.task;return this.task=null,ut()}}));const rt=()=>{var ut;this.deferred=null,(ut=this.doResolve)===null||ut===void 0||ut.call(this,null)};return this.deferred=ot===MicrotaskDelay?microtaskDeferred(rt):timeoutDeferred(ot,rt),this.completionPromise}isTriggered(){var nt;return!!(!((nt=this.deferred)===null||nt===void 0)&&nt.isTriggered())}cancel(){var nt;this.cancelTimeout(),this.completionPromise&&((nt=this.doReject)===null||nt===void 0||nt.call(this,new CancellationError),this.completionPromise=null)}cancelTimeout(){var nt;(nt=this.deferred)===null||nt===void 0||nt.dispose(),this.deferred=null}dispose(){this.cancel()}}class ThrottledDelayer{constructor(nt){this.delayer=new Delayer(nt),this.throttler=new Throttler}trigger(nt,ot){return this.delayer.trigger(()=>this.throttler.queue(nt),ot)}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose()}}function timeout(ct,nt){return nt?new Promise((ot,rt)=>{const ut=setTimeout(()=>{gt.dispose(),ot()},ct),gt=nt.onCancellationRequested(()=>{clearTimeout(ut),gt.dispose(),rt(new CancellationError)})}):createCancelablePromise(ot=>timeout(ct,ot))}function disposableTimeout(ct,nt=0){const ot=setTimeout(ct,nt);return toDisposable(()=>clearTimeout(ot))}function first(ct,nt=rt=>!!rt,ot=null){let rt=0;const ut=ct.length,gt=()=>{if(rt>=ut)return Promise.resolve(ot);const pt=ct[rt++];return Promise.resolve(pt()).then(vt=>nt(vt)?Promise.resolve(vt):gt())};return gt()}class TimeoutTimer{constructor(nt,ot){this._token=-1,typeof nt=="function"&&typeof ot=="number"&&this.setIfNotSet(nt,ot)}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(nt,ot){this.cancel(),this._token=setTimeout(()=>{this._token=-1,nt()},ot)}setIfNotSet(nt,ot){this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,nt()},ot))}}class IntervalTimer{constructor(){this._token=-1}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearInterval(this._token),this._token=-1)}cancelAndSet(nt,ot){this.cancel(),this._token=setInterval(()=>{nt()},ot)}}class RunOnceScheduler{constructor(nt,ot){this.timeoutToken=-1,this.runner=nt,this.timeout=ot,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(nt=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,nt)}get delay(){return this.timeout}set delay(nt){this.timeout=nt}isScheduled(){return this.timeoutToken!==-1}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){var nt;(nt=this.runner)===null||nt===void 0||nt.call(this)}}let runWhenIdle;(function(){typeof requestIdleCallback!="function"||typeof cancelIdleCallback!="function"?runWhenIdle=ct=>{setTimeout0(()=>{if(nt)return;const ot=Date.now()+15;ct(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,ot-Date.now())}}))});let nt=!1;return{dispose(){nt||(nt=!0)}}}:runWhenIdle=(ct,nt)=>{const ot=requestIdleCallback(ct,typeof nt=="number"?{timeout:nt}:void 0);let rt=!1;return{dispose(){rt||(rt=!0,cancelIdleCallback(ot))}}}})();class IdleValue{constructor(nt){this._didRun=!1,this._executor=()=>{try{this._value=nt()}catch(ot){this._error=ot}finally{this._didRun=!0}},this._handle=runWhenIdle(()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class DeferredPromise{get isRejected(){return this.rejected}get isSettled(){return this.rejected||this.resolved}constructor(){this.rejected=!1,this.resolved=!1,this.p=new Promise((nt,ot)=>{this.completeCallback=nt,this.errorCallback=ot})}complete(nt){return new Promise(ot=>{this.completeCallback(nt),this.resolved=!0,ot()})}cancel(){new Promise(nt=>{this.errorCallback(new CancellationError),this.rejected=!0,nt()})}}var Promises;(function(ct){function nt(rt){return __awaiter$1u(this,void 0,void 0,function*(){let ut;const gt=yield Promise.all(rt.map(pt=>pt.then(mt=>mt,mt=>{ut||(ut=mt)})));if(typeof ut<"u")throw ut;return gt})}ct.settled=nt;function ot(rt){return new Promise((ut,gt)=>__awaiter$1u(this,void 0,void 0,function*(){try{yield rt(ut,gt)}catch(pt){gt(pt)}}))}ct.withAsyncBody=ot})(Promises||(Promises={}));class AsyncIterableObject{static fromArray(nt){return new AsyncIterableObject(ot=>{ot.emitMany(nt)})}static fromPromise(nt){return new AsyncIterableObject(ot=>__awaiter$1u(this,void 0,void 0,function*(){ot.emitMany(yield nt)}))}static fromPromises(nt){return new AsyncIterableObject(ot=>__awaiter$1u(this,void 0,void 0,function*(){yield Promise.all(nt.map(rt=>__awaiter$1u(this,void 0,void 0,function*(){return ot.emitOne(yield rt)})))}))}static merge(nt){return new AsyncIterableObject(ot=>__awaiter$1u(this,void 0,void 0,function*(){yield Promise.all(nt.map(rt=>{var ut,gt,pt;return __awaiter$1u(this,void 0,void 0,function*(){var mt,vt,St,yt;try{for(ut=!0,gt=__asyncValues$2(rt);pt=yield gt.next(),mt=pt.done,!mt;){yt=pt.value,ut=!1;try{const wt=yt;ot.emitOne(wt)}finally{ut=!0}}}catch(wt){vt={error:wt}}finally{try{!ut&&!mt&&(St=gt.return)&&(yield St.call(gt))}finally{if(vt)throw vt.error}}})}))}))}constructor(nt){this._state=0,this._results=[],this._error=null,this._onStateChanged=new Emitter$2,queueMicrotask(()=>__awaiter$1u(this,void 0,void 0,function*(){const ot={emitOne:rt=>this.emitOne(rt),emitMany:rt=>this.emitMany(rt),reject:rt=>this.reject(rt)};try{yield Promise.resolve(nt(ot)),this.resolve()}catch(rt){this.reject(rt)}finally{ot.emitOne=void 0,ot.emitMany=void 0,ot.reject=void 0}}))}[Symbol.asyncIterator](){let nt=0;return{next:()=>__awaiter$1u(this,void 0,void 0,function*(){do{if(this._state===2)throw this._error;if(nt<this._results.length)return{done:!1,value:this._results[nt++]};if(this._state===1)return{done:!0,value:void 0};yield Event.toPromise(this._onStateChanged.event)}while(!0)})}}static map(nt,ot){return new AsyncIterableObject(rt=>__awaiter$1u(this,void 0,void 0,function*(){var ut,gt,pt,mt;try{for(var vt=!0,St=__asyncValues$2(nt),yt;yt=yield St.next(),ut=yt.done,!ut;){mt=yt.value,vt=!1;try{const wt=mt;rt.emitOne(ot(wt))}finally{vt=!0}}}catch(wt){gt={error:wt}}finally{try{!vt&&!ut&&(pt=St.return)&&(yield pt.call(St))}finally{if(gt)throw gt.error}}}))}map(nt){return AsyncIterableObject.map(this,nt)}static filter(nt,ot){return new AsyncIterableObject(rt=>__awaiter$1u(this,void 0,void 0,function*(){var ut,gt,pt,mt;try{for(var vt=!0,St=__asyncValues$2(nt),yt;yt=yield St.next(),ut=yt.done,!ut;){mt=yt.value,vt=!1;try{const wt=mt;ot(wt)&&rt.emitOne(wt)}finally{vt=!0}}}catch(wt){gt={error:wt}}finally{try{!vt&&!ut&&(pt=St.return)&&(yield pt.call(St))}finally{if(gt)throw gt.error}}}))}filter(nt){return AsyncIterableObject.filter(this,nt)}static coalesce(nt){return AsyncIterableObject.filter(nt,ot=>!!ot)}coalesce(){return AsyncIterableObject.coalesce(this)}static toPromise(nt){var ot,rt,ut,gt,pt,mt,vt;return __awaiter$1u(this,void 0,void 0,function*(){const St=[];try{for(ot=!0,rt=__asyncValues$2(nt);ut=yield rt.next(),gt=ut.done,!gt;){vt=ut.value,ot=!1;try{const yt=vt;St.push(yt)}finally{ot=!0}}}catch(yt){pt={error:yt}}finally{try{!ot&&!gt&&(mt=rt.return)&&(yield mt.call(rt))}finally{if(pt)throw pt.error}}return St})}toPromise(){return AsyncIterableObject.toPromise(this)}emitOne(nt){this._state===0&&(this._results.push(nt),this._onStateChanged.fire())}emitMany(nt){this._state===0&&(this._results=this._results.concat(nt),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(nt){this._state===0&&(this._state=2,this._error=nt,this._onStateChanged.fire())}}AsyncIterableObject.EMPTY=AsyncIterableObject.fromArray([]);class CancelableAsyncIterableObject extends AsyncIterableObject{constructor(nt,ot){super(ot),this._source=nt}cancel(){this._source.cancel()}}function createCancelableAsyncIterable(ct){const nt=new CancellationTokenSource$1,ot=ct(nt.token);return new CancelableAsyncIterableObject(nt,rt=>__awaiter$1u(this,void 0,void 0,function*(){var ut,gt,pt,mt;const vt=nt.token.onCancellationRequested(()=>{vt.dispose(),nt.dispose(),rt.reject(new CancellationError)});try{try{for(var St=!0,yt=__asyncValues$2(ot),wt;wt=yield yt.next(),ut=wt.done,!ut;){mt=wt.value,St=!1;try{const Lt=mt;if(nt.token.isCancellationRequested)return;rt.emitOne(Lt)}finally{St=!0}}}catch(Lt){gt={error:Lt}}finally{try{!St&&!ut&&(pt=yt.return)&&(yield pt.call(yt))}finally{if(gt)throw gt.error}}vt.dispose(),nt.dispose()}catch(Lt){vt.dispose(),nt.dispose(),rt.reject(Lt)}}))}const INITIALIZE="$initialize";let webWorkerWarningLogged=!1;function logOnceWebWorkerWarning(ct){isWeb&&(webWorkerWarningLogged||(webWorkerWarningLogged=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(ct.message))}class RequestMessage{constructor(nt,ot,rt,ut){this.vsWorker=nt,this.req=ot,this.method=rt,this.args=ut,this.type=0}}class ReplyMessage{constructor(nt,ot,rt,ut){this.vsWorker=nt,this.seq=ot,this.res=rt,this.err=ut,this.type=1}}class SubscribeEventMessage{constructor(nt,ot,rt,ut){this.vsWorker=nt,this.req=ot,this.eventName=rt,this.arg=ut,this.type=2}}class EventMessage{constructor(nt,ot,rt){this.vsWorker=nt,this.req=ot,this.event=rt,this.type=3}}class UnsubscribeEventMessage{constructor(nt,ot){this.vsWorker=nt,this.req=ot,this.type=4}}class SimpleWorkerProtocol{constructor(nt){this._workerId=-1,this._handler=nt,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(nt){this._workerId=nt}sendMessage(nt,ot){const rt=String(++this._lastSentReq);return new Promise((ut,gt)=>{this._pendingReplies[rt]={resolve:ut,reject:gt},this._send(new RequestMessage(this._workerId,rt,nt,ot))})}listen(nt,ot){let rt=null;const ut=new Emitter$2({onWillAddFirstListener:()=>{rt=String(++this._lastSentReq),this._pendingEmitters.set(rt,ut),this._send(new SubscribeEventMessage(this._workerId,rt,nt,ot))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(rt),this._send(new UnsubscribeEventMessage(this._workerId,rt)),rt=null}});return ut.event}handleMessage(nt){!nt||!nt.vsWorker||this._workerId!==-1&&nt.vsWorker!==this._workerId||this._handleMessage(nt)}_handleMessage(nt){switch(nt.type){case 1:return this._handleReplyMessage(nt);case 0:return this._handleRequestMessage(nt);case 2:return this._handleSubscribeEventMessage(nt);case 3:return this._handleEventMessage(nt);case 4:return this._handleUnsubscribeEventMessage(nt)}}_handleReplyMessage(nt){if(!this._pendingReplies[nt.seq]){console.warn("Got reply to unknown seq");return}const ot=this._pendingReplies[nt.seq];if(delete this._pendingReplies[nt.seq],nt.err){let rt=nt.err;nt.err.$isError&&(rt=new Error,rt.name=nt.err.name,rt.message=nt.err.message,rt.stack=nt.err.stack),ot.reject(rt);return}ot.resolve(nt.res)}_handleRequestMessage(nt){const ot=nt.req;this._handler.handleMessage(nt.method,nt.args).then(ut=>{this._send(new ReplyMessage(this._workerId,ot,ut,void 0))},ut=>{ut.detail instanceof Error&&(ut.detail=transformErrorForSerialization(ut.detail)),this._send(new ReplyMessage(this._workerId,ot,void 0,transformErrorForSerialization(ut)))})}_handleSubscribeEventMessage(nt){const ot=nt.req,rt=this._handler.handleEvent(nt.eventName,nt.arg)(ut=>{this._send(new EventMessage(this._workerId,ot,ut))});this._pendingEvents.set(ot,rt)}_handleEventMessage(nt){if(!this._pendingEmitters.has(nt.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(nt.req).fire(nt.event)}_handleUnsubscribeEventMessage(nt){if(!this._pendingEvents.has(nt.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(nt.req).dispose(),this._pendingEvents.delete(nt.req)}_send(nt){const ot=[];if(nt.type===0)for(let rt=0;rt<nt.args.length;rt++)nt.args[rt]instanceof ArrayBuffer&&ot.push(nt.args[rt]);else nt.type===1&&nt.res instanceof ArrayBuffer&&ot.push(nt.res);this._handler.sendMessage(nt,ot)}}class SimpleWorkerClient extends Disposable{constructor(nt,ot,rt){super();let ut=null;this._worker=this._register(nt.create("vs/base/common/worker/simpleWorker",yt=>{this._protocol.handleMessage(yt)},yt=>{ut==null||ut(yt)})),this._protocol=new SimpleWorkerProtocol({sendMessage:(yt,wt)=>{this._worker.postMessage(yt,wt)},handleMessage:(yt,wt)=>{if(typeof rt[yt]!="function")return Promise.reject(new Error("Missing method "+yt+" on main thread host."));try{return Promise.resolve(rt[yt].apply(rt,wt))}catch(Lt){return Promise.reject(Lt)}},handleEvent:(yt,wt)=>{if(propertyIsDynamicEvent(yt)){const Lt=rt[yt].call(rt,wt);if(typeof Lt!="function")throw new Error(`Missing dynamic event ${yt} on main thread host.`);return Lt}if(propertyIsEvent(yt)){const Lt=rt[yt];if(typeof Lt!="function")throw new Error(`Missing event ${yt} on main thread host.`);return Lt}throw new Error(`Malformed event name ${yt}`)}}),this._protocol.setWorkerId(this._worker.getId());let gt=null;const pt=globalThis.require;typeof pt<"u"&&typeof pt.getConfig=="function"?gt=pt.getConfig():typeof globalThis.requirejs<"u"&&(gt=globalThis.requirejs.s.contexts._.config);const mt=getAllMethodNames(rt);this._onModuleLoaded=this._protocol.sendMessage(INITIALIZE,[this._worker.getId(),JSON.parse(JSON.stringify(gt)),ot,mt]);const vt=(yt,wt)=>this._request(yt,wt),St=(yt,wt)=>this._protocol.listen(yt,wt);this._lazyProxy=new Promise((yt,wt)=>{ut=wt,this._onModuleLoaded.then(Lt=>{yt(createProxyObject(Lt,vt,St))},Lt=>{wt(Lt),this._onError("Worker failed to load "+ot,Lt)})})}getProxyObject(){return this._lazyProxy}_request(nt,ot){return new Promise((rt,ut)=>{this._onModuleLoaded.then(()=>{this._protocol.sendMessage(nt,ot).then(rt,ut)},ut)})}_onError(nt,ot){console.error(nt),console.info(ot)}}function propertyIsEvent(ct){return ct[0]==="o"&&ct[1]==="n"&&isUpperAsciiLetter(ct.charCodeAt(2))}function propertyIsDynamicEvent(ct){return/^onDynamic/.test(ct)&&isUpperAsciiLetter(ct.charCodeAt(9))}function createProxyObject(ct,nt,ot){const rt=pt=>function(){const mt=Array.prototype.slice.call(arguments,0);return nt(pt,mt)},ut=pt=>function(mt){return ot(pt,mt)},gt={};for(const pt of ct){if(propertyIsDynamicEvent(pt)){gt[pt]=ut(pt);continue}if(propertyIsEvent(pt)){gt[pt]=ot(pt,void 0);continue}gt[pt]=rt(pt)}return gt}var _a$b;const ttPolicy$4=(_a$b=window.trustedTypes)===null||_a$b===void 0?void 0:_a$b.createPolicy("defaultWorkerFactory",{createScriptURL:ct=>ct});function getWorker(ct){const nt=globalThis.MonacoEnvironment;if(nt){if(typeof nt.getWorker=="function")return nt.getWorker("workerMain.js",ct);if(typeof nt.getWorkerUrl=="function"){const ot=nt.getWorkerUrl("workerMain.js",ct);return new Worker(ttPolicy$4?ttPolicy$4.createScriptURL(ot):ot,{name:ct})}}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function isPromiseLike(ct){return typeof ct.then=="function"}class WebWorker{constructor(nt,ot,rt,ut,gt){this.id=ot;const pt=getWorker(rt);isPromiseLike(pt)?this.worker=pt:this.worker=Promise.resolve(pt),this.postMessage(nt,[]),this.worker.then(mt=>{mt.onmessage=function(vt){ut(vt.data)},mt.onmessageerror=gt,typeof mt.addEventListener=="function"&&mt.addEventListener("error",gt)})}getId(){return this.id}postMessage(nt,ot){var rt;(rt=this.worker)===null||rt===void 0||rt.then(ut=>ut.postMessage(nt,ot))}dispose(){var nt;(nt=this.worker)===null||nt===void 0||nt.then(ot=>ot.terminate()),this.worker=null}}class DefaultWorkerFactory{constructor(nt){this._label=nt,this._webWorkerFailedBeforeError=!1}create(nt,ot,rt){const ut=++DefaultWorkerFactory.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new WebWorker(nt,ut,this._label||"anonymous"+ut,ot,gt=>{logOnceWebWorkerWarning(gt),this._webWorkerFailedBeforeError=gt,rt(gt)})}}DefaultWorkerFactory.LAST_WORKER_ID=0;class DiffChange{constructor(nt,ot,rt,ut){this.originalStart=nt,this.originalLength=ot,this.modifiedStart=rt,this.modifiedLength=ut}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}function hash(ct){return doHash(ct,0)}function doHash(ct,nt){switch(typeof ct){case"object":return ct===null?numberHash(349,nt):Array.isArray(ct)?arrayHash(ct,nt):objectHash(ct,nt);case"string":return stringHash(ct,nt);case"boolean":return booleanHash(ct,nt);case"number":return numberHash(ct,nt);case"undefined":return numberHash(937,nt);default:return numberHash(617,nt)}}function numberHash(ct,nt){return(nt<<5)-nt+ct|0}function booleanHash(ct,nt){return numberHash(ct?433:863,nt)}function stringHash(ct,nt){nt=numberHash(149417,nt);for(let ot=0,rt=ct.length;ot<rt;ot++)nt=numberHash(ct.charCodeAt(ot),nt);return nt}function arrayHash(ct,nt){return nt=numberHash(104579,nt),ct.reduce((ot,rt)=>doHash(rt,ot),nt)}function objectHash(ct,nt){return nt=numberHash(181387,nt),Object.keys(ct).sort().reduce((ot,rt)=>(ot=stringHash(rt,ot),doHash(ct[rt],ot)),nt)}function leftRotate$2(ct,nt,ot=32){const rt=ot-nt,ut=~((1<<rt)-1);return(ct<<nt|(ut&ct)>>>rt)>>>0}function fill(ct,nt=0,ot=ct.byteLength,rt=0){for(let ut=0;ut<ot;ut++)ct[nt+ut]=rt}function leftPad(ct,nt,ot="0"){for(;ct.length<nt;)ct=ot+ct;return ct}function toHexString(ct,nt=32){return ct instanceof ArrayBuffer?Array.from(new Uint8Array(ct)).map(ot=>ot.toString(16).padStart(2,"0")).join(""):leftPad((ct>>>0).toString(16),nt/4)}class StringSHA1{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(64+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(nt){const ot=nt.length;if(ot===0)return;const rt=this._buff;let ut=this._buffLen,gt=this._leftoverHighSurrogate,pt,mt;for(gt!==0?(pt=gt,mt=-1,gt=0):(pt=nt.charCodeAt(0),mt=0);;){let vt=pt;if(isHighSurrogate(pt))if(mt+1<ot){const St=nt.charCodeAt(mt+1);isLowSurrogate(St)?(mt++,vt=computeCodePoint(pt,St)):vt=65533}else{gt=pt;break}else isLowSurrogate(pt)&&(vt=65533);if(ut=this._push(rt,ut,vt),mt++,mt<ot)pt=nt.charCodeAt(mt);else break}this._buffLen=ut,this._leftoverHighSurrogate=gt}_push(nt,ot,rt){return rt<128?nt[ot++]=rt:rt<2048?(nt[ot++]=192|(rt&1984)>>>6,nt[ot++]=128|(rt&63)>>>0):rt<65536?(nt[ot++]=224|(rt&61440)>>>12,nt[ot++]=128|(rt&4032)>>>6,nt[ot++]=128|(rt&63)>>>0):(nt[ot++]=240|(rt&1835008)>>>18,nt[ot++]=128|(rt&258048)>>>12,nt[ot++]=128|(rt&4032)>>>6,nt[ot++]=128|(rt&63)>>>0),ot>=64&&(this._step(),ot-=64,this._totalLen+=64,nt[0]=nt[64+0],nt[1]=nt[64+1],nt[2]=nt[64+2]),ot}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),toHexString(this._h0)+toHexString(this._h1)+toHexString(this._h2)+toHexString(this._h3)+toHexString(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,fill(this._buff,this._buffLen),this._buffLen>56&&(this._step(),fill(this._buff));const nt=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(nt/4294967296),!1),this._buffDV.setUint32(60,nt%4294967296,!1),this._step()}_step(){const nt=StringSHA1._bigBlock32,ot=this._buffDV;for(let wt=0;wt<64;wt+=4)nt.setUint32(wt,ot.getUint32(wt,!1),!1);for(let wt=64;wt<320;wt+=4)nt.setUint32(wt,leftRotate$2(nt.getUint32(wt-12,!1)^nt.getUint32(wt-32,!1)^nt.getUint32(wt-56,!1)^nt.getUint32(wt-64,!1),1),!1);let rt=this._h0,ut=this._h1,gt=this._h2,pt=this._h3,mt=this._h4,vt,St,yt;for(let wt=0;wt<80;wt++)wt<20?(vt=ut&gt|~ut&pt,St=1518500249):wt<40?(vt=ut^gt^pt,St=1859775393):wt<60?(vt=ut&gt|ut&pt|gt&pt,St=2400959708):(vt=ut^gt^pt,St=3395469782),yt=leftRotate$2(rt,5)+vt+mt+St+nt.getUint32(wt*4,!1)&4294967295,mt=pt,pt=gt,gt=leftRotate$2(ut,30),ut=rt,rt=yt;this._h0=this._h0+rt&4294967295,this._h1=this._h1+ut&4294967295,this._h2=this._h2+gt&4294967295,this._h3=this._h3+pt&4294967295,this._h4=this._h4+mt&4294967295}}StringSHA1._bigBlock32=new DataView(new ArrayBuffer(320));class StringDiffSequence{constructor(nt){this.source=nt}getElements(){const nt=this.source,ot=new Int32Array(nt.length);for(let rt=0,ut=nt.length;rt<ut;rt++)ot[rt]=nt.charCodeAt(rt);return ot}}function stringDiff(ct,nt,ot){return new LcsDiff(new StringDiffSequence(ct),new StringDiffSequence(nt)).ComputeDiff(ot).changes}class Debug{static Assert(nt,ot){if(!nt)throw new Error(ot)}}class MyArray{static Copy(nt,ot,rt,ut,gt){for(let pt=0;pt<gt;pt++)rt[ut+pt]=nt[ot+pt]}static Copy2(nt,ot,rt,ut,gt){for(let pt=0;pt<gt;pt++)rt[ut+pt]=nt[ot+pt]}}class DiffChangeHelper{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new DiffChange(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(nt,ot){this.m_originalStart=Math.min(this.m_originalStart,nt),this.m_modifiedStart=Math.min(this.m_modifiedStart,ot),this.m_originalCount++}AddModifiedElement(nt,ot){this.m_originalStart=Math.min(this.m_originalStart,nt),this.m_modifiedStart=Math.min(this.m_modifiedStart,ot),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class LcsDiff{constructor(nt,ot,rt=null){this.ContinueProcessingPredicate=rt,this._originalSequence=nt,this._modifiedSequence=ot;const[ut,gt,pt]=LcsDiff._getElements(nt),[mt,vt,St]=LcsDiff._getElements(ot);this._hasStrings=pt&&St,this._originalStringElements=ut,this._originalElementsOrHash=gt,this._modifiedStringElements=mt,this._modifiedElementsOrHash=vt,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(nt){return nt.length>0&&typeof nt[0]=="string"}static _getElements(nt){const ot=nt.getElements();if(LcsDiff._isStringArray(ot)){const rt=new Int32Array(ot.length);for(let ut=0,gt=ot.length;ut<gt;ut++)rt[ut]=stringHash(ot[ut],0);return[ot,rt,!0]}return ot instanceof Int32Array?[[],ot,!1]:[[],new Int32Array(ot),!1]}ElementsAreEqual(nt,ot){return this._originalElementsOrHash[nt]!==this._modifiedElementsOrHash[ot]?!1:this._hasStrings?this._originalStringElements[nt]===this._modifiedStringElements[ot]:!0}ElementsAreStrictEqual(nt,ot){if(!this.ElementsAreEqual(nt,ot))return!1;const rt=LcsDiff._getStrictElement(this._originalSequence,nt),ut=LcsDiff._getStrictElement(this._modifiedSequence,ot);return rt===ut}static _getStrictElement(nt,ot){return typeof nt.getStrictElement=="function"?nt.getStrictElement(ot):null}OriginalElementsAreEqual(nt,ot){return this._originalElementsOrHash[nt]!==this._originalElementsOrHash[ot]?!1:this._hasStrings?this._originalStringElements[nt]===this._originalStringElements[ot]:!0}ModifiedElementsAreEqual(nt,ot){return this._modifiedElementsOrHash[nt]!==this._modifiedElementsOrHash[ot]?!1:this._hasStrings?this._modifiedStringElements[nt]===this._modifiedStringElements[ot]:!0}ComputeDiff(nt){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,nt)}_ComputeDiff(nt,ot,rt,ut,gt){const pt=[!1];let mt=this.ComputeDiffRecursive(nt,ot,rt,ut,pt);return gt&&(mt=this.PrettifyChanges(mt)),{quitEarly:pt[0],changes:mt}}ComputeDiffRecursive(nt,ot,rt,ut,gt){for(gt[0]=!1;nt<=ot&&rt<=ut&&this.ElementsAreEqual(nt,rt);)nt++,rt++;for(;ot>=nt&&ut>=rt&&this.ElementsAreEqual(ot,ut);)ot--,ut--;if(nt>ot||rt>ut){let wt;return rt<=ut?(Debug.Assert(nt===ot+1,"originalStart should only be one more than originalEnd"),wt=[new DiffChange(nt,0,rt,ut-rt+1)]):nt<=ot?(Debug.Assert(rt===ut+1,"modifiedStart should only be one more than modifiedEnd"),wt=[new DiffChange(nt,ot-nt+1,rt,0)]):(Debug.Assert(nt===ot+1,"originalStart should only be one more than originalEnd"),Debug.Assert(rt===ut+1,"modifiedStart should only be one more than modifiedEnd"),wt=[]),wt}const pt=[0],mt=[0],vt=this.ComputeRecursionPoint(nt,ot,rt,ut,pt,mt,gt),St=pt[0],yt=mt[0];if(vt!==null)return vt;if(!gt[0]){const wt=this.ComputeDiffRecursive(nt,St,rt,yt,gt);let Lt=[];return gt[0]?Lt=[new DiffChange(St+1,ot-(St+1)+1,yt+1,ut-(yt+1)+1)]:Lt=this.ComputeDiffRecursive(St+1,ot,yt+1,ut,gt),this.ConcatenateChanges(wt,Lt)}return[new DiffChange(nt,ot-nt+1,rt,ut-rt+1)]}WALKTRACE(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt,xt,It,kt,At,Tt,Rt){let Nt=null,Pt=null,Ft=new DiffChangeHelper,Kt=ot,Bt=rt,Ut=xt[0]-At[0]-ut,qt=-1073741824,Yt=this.m_forwardHistory.length-1;do{const Zt=Ut+nt;Zt===Kt||Zt<Bt&&St[Zt-1]<St[Zt+1]?(wt=St[Zt+1],It=wt-Ut-ut,wt<qt&&Ft.MarkNextChange(),qt=wt,Ft.AddModifiedElement(wt+1,It),Ut=Zt+1-nt):(wt=St[Zt-1]+1,It=wt-Ut-ut,wt<qt&&Ft.MarkNextChange(),qt=wt-1,Ft.AddOriginalElement(wt,It+1),Ut=Zt-1-nt),Yt>=0&&(St=this.m_forwardHistory[Yt],nt=St[0],Kt=1,Bt=St.length-1)}while(--Yt>=-1);if(Nt=Ft.getReverseChanges(),Rt[0]){let Zt=xt[0]+1,Xt=At[0]+1;if(Nt!==null&&Nt.length>0){const _i=Nt[Nt.length-1];Zt=Math.max(Zt,_i.getOriginalEnd()),Xt=Math.max(Xt,_i.getModifiedEnd())}Pt=[new DiffChange(Zt,Lt-Zt+1,Xt,kt-Xt+1)]}else{Ft=new DiffChangeHelper,Kt=pt,Bt=mt,Ut=xt[0]-At[0]-vt,qt=1073741824,Yt=Tt?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const Zt=Ut+gt;Zt===Kt||Zt<Bt&&yt[Zt-1]>=yt[Zt+1]?(wt=yt[Zt+1]-1,It=wt-Ut-vt,wt>qt&&Ft.MarkNextChange(),qt=wt+1,Ft.AddOriginalElement(wt+1,It+1),Ut=Zt+1-gt):(wt=yt[Zt-1],It=wt-Ut-vt,wt>qt&&Ft.MarkNextChange(),qt=wt,Ft.AddModifiedElement(wt+1,It+1),Ut=Zt-1-gt),Yt>=0&&(yt=this.m_reverseHistory[Yt],gt=yt[0],Kt=1,Bt=yt.length-1)}while(--Yt>=-1);Pt=Ft.getChanges()}return this.ConcatenateChanges(Nt,Pt)}ComputeRecursionPoint(nt,ot,rt,ut,gt,pt,mt){let vt=0,St=0,yt=0,wt=0,Lt=0,xt=0;nt--,rt--,gt[0]=0,pt[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const It=ot-nt+(ut-rt),kt=It+1,At=new Int32Array(kt),Tt=new Int32Array(kt),Rt=ut-rt,Nt=ot-nt,Pt=nt-rt,Ft=ot-ut,Bt=(Nt-Rt)%2===0;At[Rt]=nt,Tt[Nt]=ot,mt[0]=!1;for(let Ut=1;Ut<=It/2+1;Ut++){let qt=0,Yt=0;yt=this.ClipDiagonalBound(Rt-Ut,Ut,Rt,kt),wt=this.ClipDiagonalBound(Rt+Ut,Ut,Rt,kt);for(let Xt=yt;Xt<=wt;Xt+=2){Xt===yt||Xt<wt&&At[Xt-1]<At[Xt+1]?vt=At[Xt+1]:vt=At[Xt-1]+1,St=vt-(Xt-Rt)-Pt;const _i=vt;for(;vt<ot&&St<ut&&this.ElementsAreEqual(vt+1,St+1);)vt++,St++;if(At[Xt]=vt,vt+St>qt+Yt&&(qt=vt,Yt=St),!Bt&&Math.abs(Xt-Nt)<=Ut-1&&vt>=Tt[Xt])return gt[0]=vt,pt[0]=St,_i<=Tt[Xt]&&1447>0&&Ut<=1447+1?this.WALKTRACE(Rt,yt,wt,Pt,Nt,Lt,xt,Ft,At,Tt,vt,ot,gt,St,ut,pt,Bt,mt):null}const Zt=(qt-nt+(Yt-rt)-Ut)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(qt,Zt))return mt[0]=!0,gt[0]=qt,pt[0]=Yt,Zt>0&&1447>0&&Ut<=1447+1?this.WALKTRACE(Rt,yt,wt,Pt,Nt,Lt,xt,Ft,At,Tt,vt,ot,gt,St,ut,pt,Bt,mt):(nt++,rt++,[new DiffChange(nt,ot-nt+1,rt,ut-rt+1)]);Lt=this.ClipDiagonalBound(Nt-Ut,Ut,Nt,kt),xt=this.ClipDiagonalBound(Nt+Ut,Ut,Nt,kt);for(let Xt=Lt;Xt<=xt;Xt+=2){Xt===Lt||Xt<xt&&Tt[Xt-1]>=Tt[Xt+1]?vt=Tt[Xt+1]-1:vt=Tt[Xt-1],St=vt-(Xt-Nt)-Ft;const _i=vt;for(;vt>nt&&St>rt&&this.ElementsAreEqual(vt,St);)vt--,St--;if(Tt[Xt]=vt,Bt&&Math.abs(Xt-Rt)<=Ut&&vt<=At[Xt])return gt[0]=vt,pt[0]=St,_i>=At[Xt]&&1447>0&&Ut<=1447+1?this.WALKTRACE(Rt,yt,wt,Pt,Nt,Lt,xt,Ft,At,Tt,vt,ot,gt,St,ut,pt,Bt,mt):null}if(Ut<=1447){let Xt=new Int32Array(wt-yt+2);Xt[0]=Rt-yt+1,MyArray.Copy2(At,yt,Xt,1,wt-yt+1),this.m_forwardHistory.push(Xt),Xt=new Int32Array(xt-Lt+2),Xt[0]=Nt-Lt+1,MyArray.Copy2(Tt,Lt,Xt,1,xt-Lt+1),this.m_reverseHistory.push(Xt)}}return this.WALKTRACE(Rt,yt,wt,Pt,Nt,Lt,xt,Ft,At,Tt,vt,ot,gt,St,ut,pt,Bt,mt)}PrettifyChanges(nt){for(let ot=0;ot<nt.length;ot++){const rt=nt[ot],ut=ot<nt.length-1?nt[ot+1].originalStart:this._originalElementsOrHash.length,gt=ot<nt.length-1?nt[ot+1].modifiedStart:this._modifiedElementsOrHash.length,pt=rt.originalLength>0,mt=rt.modifiedLength>0;for(;rt.originalStart+rt.originalLength<ut&&rt.modifiedStart+rt.modifiedLength<gt&&(!pt||this.OriginalElementsAreEqual(rt.originalStart,rt.originalStart+rt.originalLength))&&(!mt||this.ModifiedElementsAreEqual(rt.modifiedStart,rt.modifiedStart+rt.modifiedLength));){const St=this.ElementsAreStrictEqual(rt.originalStart,rt.modifiedStart);if(this.ElementsAreStrictEqual(rt.originalStart+rt.originalLength,rt.modifiedStart+rt.modifiedLength)&&!St)break;rt.originalStart++,rt.modifiedStart++}const vt=[null];if(ot<nt.length-1&&this.ChangesOverlap(nt[ot],nt[ot+1],vt)){nt[ot]=vt[0],nt.splice(ot+1,1),ot--;continue}}for(let ot=nt.length-1;ot>=0;ot--){const rt=nt[ot];let ut=0,gt=0;if(ot>0){const wt=nt[ot-1];ut=wt.originalStart+wt.originalLength,gt=wt.modifiedStart+wt.modifiedLength}const pt=rt.originalLength>0,mt=rt.modifiedLength>0;let vt=0,St=this._boundaryScore(rt.originalStart,rt.originalLength,rt.modifiedStart,rt.modifiedLength);for(let wt=1;;wt++){const Lt=rt.originalStart-wt,xt=rt.modifiedStart-wt;if(Lt<ut||xt<gt||pt&&!this.OriginalElementsAreEqual(Lt,Lt+rt.originalLength)||mt&&!this.ModifiedElementsAreEqual(xt,xt+rt.modifiedLength))break;const kt=(Lt===ut&&xt===gt?5:0)+this._boundaryScore(Lt,rt.originalLength,xt,rt.modifiedLength);kt>St&&(St=kt,vt=wt)}rt.originalStart-=vt,rt.modifiedStart-=vt;const yt=[null];if(ot>0&&this.ChangesOverlap(nt[ot-1],nt[ot],yt)){nt[ot-1]=yt[0],nt.splice(ot,1),ot++;continue}}if(this._hasStrings)for(let ot=1,rt=nt.length;ot<rt;ot++){const ut=nt[ot-1],gt=nt[ot],pt=gt.originalStart-ut.originalStart-ut.originalLength,mt=ut.originalStart,vt=gt.originalStart+gt.originalLength,St=vt-mt,yt=ut.modifiedStart,wt=gt.modifiedStart+gt.modifiedLength,Lt=wt-yt;if(pt<5&&St<20&&Lt<20){const xt=this._findBetterContiguousSequence(mt,St,yt,Lt,pt);if(xt){const[It,kt]=xt;(It!==ut.originalStart+ut.originalLength||kt!==ut.modifiedStart+ut.modifiedLength)&&(ut.originalLength=It-ut.originalStart,ut.modifiedLength=kt-ut.modifiedStart,gt.originalStart=It+pt,gt.modifiedStart=kt+pt,gt.originalLength=vt-gt.originalStart,gt.modifiedLength=wt-gt.modifiedStart)}}}return nt}_findBetterContiguousSequence(nt,ot,rt,ut,gt){if(ot<gt||ut<gt)return null;const pt=nt+ot-gt+1,mt=rt+ut-gt+1;let vt=0,St=0,yt=0;for(let wt=nt;wt<pt;wt++)for(let Lt=rt;Lt<mt;Lt++){const xt=this._contiguousSequenceScore(wt,Lt,gt);xt>0&&xt>vt&&(vt=xt,St=wt,yt=Lt)}return vt>0?[St,yt]:null}_contiguousSequenceScore(nt,ot,rt){let ut=0;for(let gt=0;gt<rt;gt++){if(!this.ElementsAreEqual(nt+gt,ot+gt))return 0;ut+=this._originalStringElements[nt+gt].length}return ut}_OriginalIsBoundary(nt){return nt<=0||nt>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[nt])}_OriginalRegionIsBoundary(nt,ot){if(this._OriginalIsBoundary(nt)||this._OriginalIsBoundary(nt-1))return!0;if(ot>0){const rt=nt+ot;if(this._OriginalIsBoundary(rt-1)||this._OriginalIsBoundary(rt))return!0}return!1}_ModifiedIsBoundary(nt){return nt<=0||nt>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[nt])}_ModifiedRegionIsBoundary(nt,ot){if(this._ModifiedIsBoundary(nt)||this._ModifiedIsBoundary(nt-1))return!0;if(ot>0){const rt=nt+ot;if(this._ModifiedIsBoundary(rt-1)||this._ModifiedIsBoundary(rt))return!0}return!1}_boundaryScore(nt,ot,rt,ut){const gt=this._OriginalRegionIsBoundary(nt,ot)?1:0,pt=this._ModifiedRegionIsBoundary(rt,ut)?1:0;return gt+pt}ConcatenateChanges(nt,ot){const rt=[];if(nt.length===0||ot.length===0)return ot.length>0?ot:nt;if(this.ChangesOverlap(nt[nt.length-1],ot[0],rt)){const ut=new Array(nt.length+ot.length-1);return MyArray.Copy(nt,0,ut,0,nt.length-1),ut[nt.length-1]=rt[0],MyArray.Copy(ot,1,ut,nt.length,ot.length-1),ut}else{const ut=new Array(nt.length+ot.length);return MyArray.Copy(nt,0,ut,0,nt.length),MyArray.Copy(ot,0,ut,nt.length,ot.length),ut}}ChangesOverlap(nt,ot,rt){if(Debug.Assert(nt.originalStart<=ot.originalStart,"Left change is not less than or equal to right change"),Debug.Assert(nt.modifiedStart<=ot.modifiedStart,"Left change is not less than or equal to right change"),nt.originalStart+nt.originalLength>=ot.originalStart||nt.modifiedStart+nt.modifiedLength>=ot.modifiedStart){const ut=nt.originalStart;let gt=nt.originalLength;const pt=nt.modifiedStart;let mt=nt.modifiedLength;return nt.originalStart+nt.originalLength>=ot.originalStart&&(gt=ot.originalStart+ot.originalLength-nt.originalStart),nt.modifiedStart+nt.modifiedLength>=ot.modifiedStart&&(mt=ot.modifiedStart+ot.modifiedLength-nt.modifiedStart),rt[0]=new DiffChange(ut,gt,pt,mt),!0}else return rt[0]=null,!1}ClipDiagonalBound(nt,ot,rt,ut){if(nt>=0&&nt<ut)return nt;const gt=rt,pt=ut-rt-1,mt=ot%2===0;if(nt<0){const vt=gt%2===0;return mt===vt?0:1}else{const vt=pt%2===0;return mt===vt?ut-1:ut-2}}}function toUint8(ct){return ct<0?0:ct>255?255:ct|0}function toUint32(ct){return ct<0?0:ct>4294967295?4294967295:ct|0}class PrefixSumComputer{constructor(nt){this.values=nt,this.prefixSum=new Uint32Array(nt.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(nt,ot){nt=toUint32(nt);const rt=this.values,ut=this.prefixSum,gt=ot.length;return gt===0?!1:(this.values=new Uint32Array(rt.length+gt),this.values.set(rt.subarray(0,nt),0),this.values.set(rt.subarray(nt),nt+gt),this.values.set(ot,nt),nt-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=nt-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(ut.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(nt,ot){return nt=toUint32(nt),ot=toUint32(ot),this.values[nt]===ot?!1:(this.values[nt]=ot,nt-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=nt-1),!0)}removeValues(nt,ot){nt=toUint32(nt),ot=toUint32(ot);const rt=this.values,ut=this.prefixSum;if(nt>=rt.length)return!1;const gt=rt.length-nt;return ot>=gt&&(ot=gt),ot===0?!1:(this.values=new Uint32Array(rt.length-ot),this.values.set(rt.subarray(0,nt),0),this.values.set(rt.subarray(nt+ot),nt),this.prefixSum=new Uint32Array(this.values.length),nt-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=nt-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(ut.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(nt){return nt<0?0:(nt=toUint32(nt),this._getPrefixSum(nt))}_getPrefixSum(nt){if(nt<=this.prefixSumValidIndex[0])return this.prefixSum[nt];let ot=this.prefixSumValidIndex[0]+1;ot===0&&(this.prefixSum[0]=this.values[0],ot++),nt>=this.values.length&&(nt=this.values.length-1);for(let rt=ot;rt<=nt;rt++)this.prefixSum[rt]=this.prefixSum[rt-1]+this.values[rt];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],nt),this.prefixSum[nt]}getIndexOf(nt){nt=Math.floor(nt),this.getTotalSum();let ot=0,rt=this.values.length-1,ut=0,gt=0,pt=0;for(;ot<=rt;)if(ut=ot+(rt-ot)/2|0,gt=this.prefixSum[ut],pt=gt-this.values[ut],nt<pt)rt=ut-1;else if(nt>=gt)ot=ut+1;else break;return new PrefixSumIndexOfResult(ut,nt-pt)}}class ConstantTimePrefixSumComputer{constructor(nt){this._values=nt,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(nt){return this._ensureValid(),nt===0?0:this._prefixSum[nt-1]}getIndexOf(nt){this._ensureValid();const ot=this._indexBySum[nt],rt=ot>0?this._prefixSum[ot-1]:0;return new PrefixSumIndexOfResult(ot,nt-rt)}removeValues(nt,ot){this._values.splice(nt,ot),this._invalidate(nt)}insertValues(nt,ot){this._values=arrayInsert(this._values,nt,ot),this._invalidate(nt)}_invalidate(nt){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,nt-1)}_ensureValid(){if(!this._isValid){for(let nt=this._validEndIndex+1,ot=this._values.length;nt<ot;nt++){const rt=this._values[nt],ut=nt>0?this._prefixSum[nt-1]:0;this._prefixSum[nt]=ut+rt;for(let gt=0;gt<rt;gt++)this._indexBySum[ut+gt]=nt}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(nt,ot){this._values[nt]!==ot&&(this._values[nt]=ot,this._invalidate(nt))}}class PrefixSumIndexOfResult{constructor(nt,ot){this.index=nt,this.remainder=ot,this._prefixSumIndexOfResultBrand=void 0,this.index=nt,this.remainder=ot}}class MirrorTextModel{constructor(nt,ot,rt,ut){this._uri=nt,this._lines=ot,this._eol=rt,this._versionId=ut,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(nt){nt.eol&&nt.eol!==this._eol&&(this._eol=nt.eol,this._lineStarts=null);const ot=nt.changes;for(const rt of ot)this._acceptDeleteRange(rt.range),this._acceptInsertText(new Position$1(rt.range.startLineNumber,rt.range.startColumn),rt.text);this._versionId=nt.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const nt=this._eol.length,ot=this._lines.length,rt=new Uint32Array(ot);for(let ut=0;ut<ot;ut++)rt[ut]=this._lines[ut].length+nt;this._lineStarts=new PrefixSumComputer(rt)}}_setLineText(nt,ot){this._lines[nt]=ot,this._lineStarts&&this._lineStarts.setValue(nt,this._lines[nt].length+this._eol.length)}_acceptDeleteRange(nt){if(nt.startLineNumber===nt.endLineNumber){if(nt.startColumn===nt.endColumn)return;this._setLineText(nt.startLineNumber-1,this._lines[nt.startLineNumber-1].substring(0,nt.startColumn-1)+this._lines[nt.startLineNumber-1].substring(nt.endColumn-1));return}this._setLineText(nt.startLineNumber-1,this._lines[nt.startLineNumber-1].substring(0,nt.startColumn-1)+this._lines[nt.endLineNumber-1].substring(nt.endColumn-1)),this._lines.splice(nt.startLineNumber,nt.endLineNumber-nt.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(nt.startLineNumber,nt.endLineNumber-nt.startLineNumber)}_acceptInsertText(nt,ot){if(ot.length===0)return;const rt=splitLines(ot);if(rt.length===1){this._setLineText(nt.lineNumber-1,this._lines[nt.lineNumber-1].substring(0,nt.column-1)+rt[0]+this._lines[nt.lineNumber-1].substring(nt.column-1));return}rt[rt.length-1]+=this._lines[nt.lineNumber-1].substring(nt.column-1),this._setLineText(nt.lineNumber-1,this._lines[nt.lineNumber-1].substring(0,nt.column-1)+rt[0]);const ut=new Uint32Array(rt.length-1);for(let gt=1;gt<rt.length;gt++)this._lines.splice(nt.lineNumber+gt-1,0,rt[gt]),ut[gt-1]=rt[gt].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(nt.lineNumber,ut)}}class CharacterClassifier{constructor(nt){const ot=toUint8(nt);this._defaultValue=ot,this._asciiMap=CharacterClassifier._createAsciiMap(ot),this._map=new Map}static _createAsciiMap(nt){const ot=new Uint8Array(256);return ot.fill(nt),ot}set(nt,ot){const rt=toUint8(ot);nt>=0&&nt<256?this._asciiMap[nt]=rt:this._map.set(nt,rt)}get(nt){return nt>=0&&nt<256?this._asciiMap[nt]:this._map.get(nt)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class CharacterSet{constructor(){this._actual=new CharacterClassifier(0)}add(nt){this._actual.set(nt,1)}has(nt){return this._actual.get(nt)===1}clear(){return this._actual.clear()}}class Uint8Matrix{constructor(nt,ot,rt){const ut=new Uint8Array(nt*ot);for(let gt=0,pt=nt*ot;gt<pt;gt++)ut[gt]=rt;this._data=ut,this.rows=nt,this.cols=ot}get(nt,ot){return this._data[nt*this.cols+ot]}set(nt,ot,rt){this._data[nt*this.cols+ot]=rt}}class StateMachine{constructor(nt){let ot=0,rt=0;for(let gt=0,pt=nt.length;gt<pt;gt++){const[mt,vt,St]=nt[gt];vt>ot&&(ot=vt),mt>rt&&(rt=mt),St>rt&&(rt=St)}ot++,rt++;const ut=new Uint8Matrix(rt,ot,0);for(let gt=0,pt=nt.length;gt<pt;gt++){const[mt,vt,St]=nt[gt];ut.set(mt,vt,St)}this._states=ut,this._maxCharCode=ot}nextState(nt,ot){return ot<0||ot>=this._maxCharCode?0:this._states.get(nt,ot)}}let _stateMachine=null;function getStateMachine(){return _stateMachine===null&&(_stateMachine=new StateMachine([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),_stateMachine}let _classifier=null;function getClassifier(){if(_classifier===null){_classifier=new CharacterClassifier(0);const ct=` 	<>'"`;for(let ot=0;ot<ct.length;ot++)_classifier.set(ct.charCodeAt(ot),1);const nt=".,;:";for(let ot=0;ot<nt.length;ot++)_classifier.set(nt.charCodeAt(ot),2)}return _classifier}class LinkComputer{static _createLink(nt,ot,rt,ut,gt){let pt=gt-1;do{const mt=ot.charCodeAt(pt);if(nt.get(mt)!==2)break;pt--}while(pt>ut);if(ut>0){const mt=ot.charCodeAt(ut-1),vt=ot.charCodeAt(pt);(mt===40&&vt===41||mt===91&&vt===93||mt===123&&vt===125)&&pt--}return{range:{startLineNumber:rt,startColumn:ut+1,endLineNumber:rt,endColumn:pt+2},url:ot.substring(ut,pt+1)}}static computeLinks(nt,ot=getStateMachine()){const rt=getClassifier(),ut=[];for(let gt=1,pt=nt.getLineCount();gt<=pt;gt++){const mt=nt.getLineContent(gt),vt=mt.length;let St=0,yt=0,wt=0,Lt=1,xt=!1,It=!1,kt=!1,At=!1;for(;St<vt;){let Tt=!1;const Rt=mt.charCodeAt(St);if(Lt===13){let Nt;switch(Rt){case 40:xt=!0,Nt=0;break;case 41:Nt=xt?0:1;break;case 91:kt=!0,It=!0,Nt=0;break;case 93:kt=!1,Nt=It?0:1;break;case 123:At=!0,Nt=0;break;case 125:Nt=At?0:1;break;case 39:case 34:case 96:wt===Rt?Nt=1:wt===39||wt===34||wt===96?Nt=0:Nt=1;break;case 42:Nt=wt===42?1:0;break;case 124:Nt=wt===124?1:0;break;case 32:Nt=kt?0:1;break;default:Nt=rt.get(Rt)}Nt===1&&(ut.push(LinkComputer._createLink(rt,mt,gt,yt,St)),Tt=!0)}else if(Lt===12){let Nt;Rt===91?(It=!0,Nt=0):Nt=rt.get(Rt),Nt===1?Tt=!0:Lt=13}else Lt=ot.nextState(Lt,Rt),Lt===0&&(Tt=!0);Tt&&(Lt=1,xt=!1,It=!1,At=!1,yt=St+1,wt=Rt),St++}Lt===13&&ut.push(LinkComputer._createLink(rt,mt,gt,yt,vt))}return ut}}function computeLinks(ct){return!ct||typeof ct.getLineCount!="function"||typeof ct.getLineContent!="function"?[]:LinkComputer.computeLinks(ct)}class BasicInplaceReplace{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(nt,ot,rt,ut,gt){if(nt&&ot){const pt=this.doNavigateValueSet(ot,gt);if(pt)return{range:nt,value:pt}}if(rt&&ut){const pt=this.doNavigateValueSet(ut,gt);if(pt)return{range:rt,value:pt}}return null}doNavigateValueSet(nt,ot){const rt=this.numberReplace(nt,ot);return rt!==null?rt:this.textReplace(nt,ot)}numberReplace(nt,ot){const rt=Math.pow(10,nt.length-(nt.lastIndexOf(".")+1));let ut=Number(nt);const gt=parseFloat(nt);return!isNaN(ut)&&!isNaN(gt)&&ut===gt?ut===0&&!ot?null:(ut=Math.floor(ut*rt),ut+=ot?rt:-rt,String(ut/rt)):null}textReplace(nt,ot){return this.valueSetsReplace(this._defaultValueSet,nt,ot)}valueSetsReplace(nt,ot,rt){let ut=null;for(let gt=0,pt=nt.length;ut===null&&gt<pt;gt++)ut=this.valueSetReplace(nt[gt],ot,rt);return ut}valueSetReplace(nt,ot,rt){let ut=nt.indexOf(ot);return ut>=0?(ut+=rt?1:-1,ut<0?ut=nt.length-1:ut%=nt.length,nt[ut]):null}}BasicInplaceReplace.INSTANCE=new BasicInplaceReplace;class WordCharacterClassifier extends CharacterClassifier{constructor(nt){super(0);for(let ot=0,rt=nt.length;ot<rt;ot++)this.set(nt.charCodeAt(ot),2);this.set(32,1),this.set(9,1)}}function once(ct){const nt={};return ot=>(nt.hasOwnProperty(ot)||(nt[ot]=ct(ot)),nt[ot])}const getMapForWordSeparators=once(ct=>new WordCharacterClassifier(ct)),LIMIT_FIND_COUNT$1=999;class SearchParams{constructor(nt,ot,rt,ut){this.searchString=nt,this.isRegex=ot,this.matchCase=rt,this.wordSeparators=ut}parseSearchRequest(){if(this.searchString==="")return null;let nt;this.isRegex?nt=isMultilineRegexSource(this.searchString):nt=this.searchString.indexOf(`
`)>=0;let ot=null;try{ot=createRegExp(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:nt,global:!0,unicode:!0})}catch{return null}if(!ot)return null;let rt=!this.isRegex&&!nt;return rt&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(rt=this.matchCase),new SearchData(ot,this.wordSeparators?getMapForWordSeparators(this.wordSeparators):null,rt?this.searchString:null)}}function isMultilineRegexSource(ct){if(!ct||ct.length===0)return!1;for(let nt=0,ot=ct.length;nt<ot;nt++){const rt=ct.charCodeAt(nt);if(rt===10)return!0;if(rt===92){if(nt++,nt>=ot)break;const ut=ct.charCodeAt(nt);if(ut===110||ut===114||ut===87)return!0}}return!1}function createFindMatch(ct,nt,ot){if(!ot)return new FindMatch(ct,null);const rt=[];for(let ut=0,gt=nt.length;ut<gt;ut++)rt[ut]=nt[ut];return new FindMatch(ct,rt)}class LineFeedCounter{constructor(nt){const ot=[];let rt=0;for(let ut=0,gt=nt.length;ut<gt;ut++)nt.charCodeAt(ut)===10&&(ot[rt++]=ut);this._lineFeedsOffsets=ot}findLineFeedCountBeforeOffset(nt){const ot=this._lineFeedsOffsets;let rt=0,ut=ot.length-1;if(ut===-1||nt<=ot[0])return 0;for(;rt<ut;){const gt=rt+((ut-rt)/2>>0);ot[gt]>=nt?ut=gt-1:ot[gt+1]>=nt?(rt=gt,ut=gt):rt=gt+1}return rt+1}}class TextModelSearch{static findMatches(nt,ot,rt,ut,gt){const pt=ot.parseSearchRequest();return pt?pt.regex.multiline?this._doFindMatchesMultiline(nt,rt,new Searcher(pt.wordSeparators,pt.regex),ut,gt):this._doFindMatchesLineByLine(nt,rt,pt,ut,gt):[]}static _getMultilineMatchRange(nt,ot,rt,ut,gt,pt){let mt,vt=0;ut?(vt=ut.findLineFeedCountBeforeOffset(gt),mt=ot+gt+vt):mt=ot+gt;let St;if(ut){const xt=ut.findLineFeedCountBeforeOffset(gt+pt.length)-vt;St=mt+pt.length+xt}else St=mt+pt.length;const yt=nt.getPositionAt(mt),wt=nt.getPositionAt(St);return new Range$2(yt.lineNumber,yt.column,wt.lineNumber,wt.column)}static _doFindMatchesMultiline(nt,ot,rt,ut,gt){const pt=nt.getOffsetAt(ot.getStartPosition()),mt=nt.getValueInRange(ot,1),vt=nt.getEOL()===`\r
`?new LineFeedCounter(mt):null,St=[];let yt=0,wt;for(rt.reset(0);wt=rt.next(mt);)if(St[yt++]=createFindMatch(this._getMultilineMatchRange(nt,pt,mt,vt,wt.index,wt[0]),wt,ut),yt>=gt)return St;return St}static _doFindMatchesLineByLine(nt,ot,rt,ut,gt){const pt=[];let mt=0;if(ot.startLineNumber===ot.endLineNumber){const St=nt.getLineContent(ot.startLineNumber).substring(ot.startColumn-1,ot.endColumn-1);return mt=this._findMatchesInLine(rt,St,ot.startLineNumber,ot.startColumn-1,mt,pt,ut,gt),pt}const vt=nt.getLineContent(ot.startLineNumber).substring(ot.startColumn-1);mt=this._findMatchesInLine(rt,vt,ot.startLineNumber,ot.startColumn-1,mt,pt,ut,gt);for(let St=ot.startLineNumber+1;St<ot.endLineNumber&&mt<gt;St++)mt=this._findMatchesInLine(rt,nt.getLineContent(St),St,0,mt,pt,ut,gt);if(mt<gt){const St=nt.getLineContent(ot.endLineNumber).substring(0,ot.endColumn-1);mt=this._findMatchesInLine(rt,St,ot.endLineNumber,0,mt,pt,ut,gt)}return pt}static _findMatchesInLine(nt,ot,rt,ut,gt,pt,mt,vt){const St=nt.wordSeparators;if(!mt&&nt.simpleSearch){const Lt=nt.simpleSearch,xt=Lt.length,It=ot.length;let kt=-xt;for(;(kt=ot.indexOf(Lt,kt+xt))!==-1;)if((!St||isValidMatch(St,ot,It,kt,xt))&&(pt[gt++]=new FindMatch(new Range$2(rt,kt+1+ut,rt,kt+1+xt+ut),null),gt>=vt))return gt;return gt}const yt=new Searcher(nt.wordSeparators,nt.regex);let wt;yt.reset(0);do if(wt=yt.next(ot),wt&&(pt[gt++]=createFindMatch(new Range$2(rt,wt.index+1+ut,rt,wt.index+1+wt[0].length+ut),wt,mt),gt>=vt))return gt;while(wt);return gt}static findNextMatch(nt,ot,rt,ut){const gt=ot.parseSearchRequest();if(!gt)return null;const pt=new Searcher(gt.wordSeparators,gt.regex);return gt.regex.multiline?this._doFindNextMatchMultiline(nt,rt,pt,ut):this._doFindNextMatchLineByLine(nt,rt,pt,ut)}static _doFindNextMatchMultiline(nt,ot,rt,ut){const gt=new Position$1(ot.lineNumber,1),pt=nt.getOffsetAt(gt),mt=nt.getLineCount(),vt=nt.getValueInRange(new Range$2(gt.lineNumber,gt.column,mt,nt.getLineMaxColumn(mt)),1),St=nt.getEOL()===`\r
`?new LineFeedCounter(vt):null;rt.reset(ot.column-1);const yt=rt.next(vt);return yt?createFindMatch(this._getMultilineMatchRange(nt,pt,vt,St,yt.index,yt[0]),yt,ut):ot.lineNumber!==1||ot.column!==1?this._doFindNextMatchMultiline(nt,new Position$1(1,1),rt,ut):null}static _doFindNextMatchLineByLine(nt,ot,rt,ut){const gt=nt.getLineCount(),pt=ot.lineNumber,mt=nt.getLineContent(pt),vt=this._findFirstMatchInLine(rt,mt,pt,ot.column,ut);if(vt)return vt;for(let St=1;St<=gt;St++){const yt=(pt+St-1)%gt,wt=nt.getLineContent(yt+1),Lt=this._findFirstMatchInLine(rt,wt,yt+1,1,ut);if(Lt)return Lt}return null}static _findFirstMatchInLine(nt,ot,rt,ut,gt){nt.reset(ut-1);const pt=nt.next(ot);return pt?createFindMatch(new Range$2(rt,pt.index+1,rt,pt.index+1+pt[0].length),pt,gt):null}static findPreviousMatch(nt,ot,rt,ut){const gt=ot.parseSearchRequest();if(!gt)return null;const pt=new Searcher(gt.wordSeparators,gt.regex);return gt.regex.multiline?this._doFindPreviousMatchMultiline(nt,rt,pt,ut):this._doFindPreviousMatchLineByLine(nt,rt,pt,ut)}static _doFindPreviousMatchMultiline(nt,ot,rt,ut){const gt=this._doFindMatchesMultiline(nt,new Range$2(1,1,ot.lineNumber,ot.column),rt,ut,10*LIMIT_FIND_COUNT$1);if(gt.length>0)return gt[gt.length-1];const pt=nt.getLineCount();return ot.lineNumber!==pt||ot.column!==nt.getLineMaxColumn(pt)?this._doFindPreviousMatchMultiline(nt,new Position$1(pt,nt.getLineMaxColumn(pt)),rt,ut):null}static _doFindPreviousMatchLineByLine(nt,ot,rt,ut){const gt=nt.getLineCount(),pt=ot.lineNumber,mt=nt.getLineContent(pt).substring(0,ot.column-1),vt=this._findLastMatchInLine(rt,mt,pt,ut);if(vt)return vt;for(let St=1;St<=gt;St++){const yt=(gt+pt-St-1)%gt,wt=nt.getLineContent(yt+1),Lt=this._findLastMatchInLine(rt,wt,yt+1,ut);if(Lt)return Lt}return null}static _findLastMatchInLine(nt,ot,rt,ut){let gt=null,pt;for(nt.reset(0);pt=nt.next(ot);)gt=createFindMatch(new Range$2(rt,pt.index+1,rt,pt.index+1+pt[0].length),pt,ut);return gt}}function leftIsWordBounday(ct,nt,ot,rt,ut){if(rt===0)return!0;const gt=nt.charCodeAt(rt-1);if(ct.get(gt)!==0||gt===13||gt===10)return!0;if(ut>0){const pt=nt.charCodeAt(rt);if(ct.get(pt)!==0)return!0}return!1}function rightIsWordBounday(ct,nt,ot,rt,ut){if(rt+ut===ot)return!0;const gt=nt.charCodeAt(rt+ut);if(ct.get(gt)!==0||gt===13||gt===10)return!0;if(ut>0){const pt=nt.charCodeAt(rt+ut-1);if(ct.get(pt)!==0)return!0}return!1}function isValidMatch(ct,nt,ot,rt,ut){return leftIsWordBounday(ct,nt,ot,rt,ut)&&rightIsWordBounday(ct,nt,ot,rt,ut)}class Searcher{constructor(nt,ot){this._wordSeparators=nt,this._searchRegex=ot,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(nt){this._searchRegex.lastIndex=nt,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(nt){const ot=nt.length;let rt;do{if(this._prevMatchStartIndex+this._prevMatchLength===ot||(rt=this._searchRegex.exec(nt),!rt))return null;const ut=rt.index,gt=rt[0].length;if(ut===this._prevMatchStartIndex&&gt===this._prevMatchLength){if(gt===0){getNextCodePoint(nt,ot,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=ut,this._prevMatchLength=gt,!this._wordSeparators||isValidMatch(this._wordSeparators,nt,ot,ut,gt))return rt}while(rt);return null}}class UnicodeTextModelHighlighter{static computeUnicodeHighlights(nt,ot,rt){const ut=rt?rt.startLineNumber:1,gt=rt?rt.endLineNumber:nt.getLineCount(),pt=new CodePointHighlighter(ot),mt=pt.getCandidateCodePoints();let vt;mt==="allNonBasicAscii"?vt=new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):vt=new RegExp(`${buildRegExpCharClassExpr(Array.from(mt))}`,"g");const St=new Searcher(null,vt),yt=[];let wt=!1,Lt,xt=0,It=0,kt=0;e:for(let At=ut,Tt=gt;At<=Tt;At++){const Rt=nt.getLineContent(At),Nt=Rt.length;St.reset(0);do if(Lt=St.next(Rt),Lt){let Pt=Lt.index,Ft=Lt.index+Lt[0].length;if(Pt>0){const qt=Rt.charCodeAt(Pt-1);isHighSurrogate(qt)&&Pt--}if(Ft+1<Nt){const qt=Rt.charCodeAt(Ft-1);isHighSurrogate(qt)&&Ft++}const Kt=Rt.substring(Pt,Ft);let Bt=getWordAtText(Pt+1,DEFAULT_WORD_REGEXP,Rt,0);Bt&&Bt.endColumn<=Pt+1&&(Bt=null);const Ut=pt.shouldHighlightNonBasicASCII(Kt,Bt?Bt.word:null);if(Ut!==0){Ut===3?xt++:Ut===2?It++:Ut===1?kt++:assertNever();const qt=1e3;if(yt.length>=qt){wt=!0;break e}yt.push(new Range$2(At,Pt+1,At,Ft+1))}}while(Lt)}return{ranges:yt,hasMore:wt,ambiguousCharacterCount:xt,invisibleCharacterCount:It,nonBasicAsciiCharacterCount:kt}}static computeUnicodeHighlightReason(nt,ot){const rt=new CodePointHighlighter(ot);switch(rt.shouldHighlightNonBasicASCII(nt,null)){case 0:return null;case 2:return{kind:1};case 3:{const gt=nt.codePointAt(0),pt=rt.ambiguousCharacters.getPrimaryConfusable(gt),mt=AmbiguousCharacters.getLocales().filter(vt=>!AmbiguousCharacters.getInstance(new Set([...ot.allowedLocales,vt])).isAmbiguous(gt));return{kind:0,confusableWith:String.fromCodePoint(pt),notAmbiguousInLocales:mt}}case 1:return{kind:2}}}}function buildRegExpCharClassExpr(ct,nt){return`[${escapeRegExpCharacters(ct.map(rt=>String.fromCodePoint(rt)).join(""))}]`}class CodePointHighlighter{constructor(nt){this.options=nt,this.allowedCodePoints=new Set(nt.allowedCodePoints),this.ambiguousCharacters=AmbiguousCharacters.getInstance(new Set(nt.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const nt=new Set;if(this.options.invisibleCharacters)for(const ot of InvisibleCharacters.codePoints)isAllowedInvisibleCharacter(String.fromCodePoint(ot))||nt.add(ot);if(this.options.ambiguousCharacters)for(const ot of this.ambiguousCharacters.getConfusableCodePoints())nt.add(ot);for(const ot of this.allowedCodePoints)nt.delete(ot);return nt}shouldHighlightNonBasicASCII(nt,ot){const rt=nt.codePointAt(0);if(this.allowedCodePoints.has(rt))return 0;if(this.options.nonBasicASCII)return 1;let ut=!1,gt=!1;if(ot)for(const pt of ot){const mt=pt.codePointAt(0),vt=isBasicASCII(pt);ut=ut||vt,!vt&&!this.ambiguousCharacters.isAmbiguous(mt)&&!InvisibleCharacters.isInvisibleCharacter(mt)&&(gt=!0)}return!ut&&gt?0:this.options.invisibleCharacters&&!isAllowedInvisibleCharacter(nt)&&InvisibleCharacters.isInvisibleCharacter(rt)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(rt)?3:0}}function isAllowedInvisibleCharacter(ct){return ct===" "||ct===`
`||ct==="	"}class LinesDiff{constructor(nt,ot){this.changes=nt,this.hitTimeout=ot}}class LineRangeMapping{constructor(nt,ot,rt){this.originalRange=nt,this.modifiedRange=ot,this.innerChanges=rt}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}get changedLineCount(){return Math.max(this.originalRange.length,this.modifiedRange.length)}}class RangeMapping{constructor(nt,ot){this.originalRange=nt,this.modifiedRange=ot}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}}let LineRange$1=class wo{static joinMany(nt){if(nt.length===0)return[];let ot=nt[0];for(let rt=1;rt<nt.length;rt++)ot=this.join(ot,nt[rt]);return ot}static join(nt,ot){if(nt.length===0)return ot;if(ot.length===0)return nt;const rt=[];let ut=0,gt=0,pt=null;for(;ut<nt.length||gt<ot.length;){let mt=null;if(ut<nt.length&&gt<ot.length){const vt=nt[ut],St=ot[gt];vt.startLineNumber<St.startLineNumber?(mt=vt,ut++):(mt=St,gt++)}else ut<nt.length?(mt=nt[ut],ut++):(mt=ot[gt],gt++);pt===null?pt=mt:pt.endLineNumberExclusive>=mt.startLineNumber?pt=new wo(pt.startLineNumber,Math.max(pt.endLineNumberExclusive,mt.endLineNumberExclusive)):(rt.push(pt),pt=mt)}return pt!==null&&rt.push(pt),rt}constructor(nt,ot){if(nt>ot)throw new BugIndicatingError(`startLineNumber ${nt} cannot be after endLineNumberExclusive ${ot}`);this.startLineNumber=nt,this.endLineNumberExclusive=ot}contains(nt){return this.startLineNumber<=nt&&nt<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(nt){return new wo(this.startLineNumber+nt,this.endLineNumberExclusive+nt)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(nt){return new wo(Math.min(this.startLineNumber,nt.startLineNumber),Math.max(this.endLineNumberExclusive,nt.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(nt){const ot=Math.max(this.startLineNumber,nt.startLineNumber),rt=Math.min(this.endLineNumberExclusive,nt.endLineNumberExclusive);if(ot<=rt)return new wo(ot,rt)}overlapOrTouch(nt){return this.startLineNumber<=nt.endLineNumberExclusive&&nt.startLineNumber<=this.endLineNumberExclusive}equals(nt){return this.startLineNumber===nt.startLineNumber&&this.endLineNumberExclusive===nt.endLineNumberExclusive}};const MINIMUM_MATCHING_CHARACTER_LENGTH=3;class SmartLinesDiffComputer{computeDiff(nt,ot,rt){var ut;const pt=new DiffComputer(nt,ot,{maxComputationTime:rt.maxComputationTimeMs,shouldIgnoreTrimWhitespace:rt.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),mt=[];let vt=null;for(const St of pt.changes){let yt;St.originalEndLineNumber===0?yt=new LineRange$1(St.originalStartLineNumber+1,St.originalStartLineNumber+1):yt=new LineRange$1(St.originalStartLineNumber,St.originalEndLineNumber+1);let wt;St.modifiedEndLineNumber===0?wt=new LineRange$1(St.modifiedStartLineNumber+1,St.modifiedStartLineNumber+1):wt=new LineRange$1(St.modifiedStartLineNumber,St.modifiedEndLineNumber+1);let Lt=new LineRangeMapping(yt,wt,(ut=St.charChanges)===null||ut===void 0?void 0:ut.map(xt=>new RangeMapping(new Range$2(xt.originalStartLineNumber,xt.originalStartColumn,xt.originalEndLineNumber,xt.originalEndColumn),new Range$2(xt.modifiedStartLineNumber,xt.modifiedStartColumn,xt.modifiedEndLineNumber,xt.modifiedEndColumn))));vt&&(vt.modifiedRange.endLineNumberExclusive===Lt.modifiedRange.startLineNumber||vt.originalRange.endLineNumberExclusive===Lt.originalRange.startLineNumber)&&(Lt=new LineRangeMapping(vt.originalRange.join(Lt.originalRange),vt.modifiedRange.join(Lt.modifiedRange),vt.innerChanges&&Lt.innerChanges?vt.innerChanges.concat(Lt.innerChanges):void 0),mt.pop()),mt.push(Lt),vt=Lt}return assertFn(()=>checkAdjacentItems(mt,(St,yt)=>yt.originalRange.startLineNumber-St.originalRange.endLineNumberExclusive===yt.modifiedRange.startLineNumber-St.modifiedRange.endLineNumberExclusive&&St.originalRange.endLineNumberExclusive<yt.originalRange.startLineNumber&&St.modifiedRange.endLineNumberExclusive<yt.modifiedRange.startLineNumber)),new LinesDiff(mt,pt.quitEarly)}}function computeDiff(ct,nt,ot,rt){return new LcsDiff(ct,nt,ot).ComputeDiff(rt)}let LineSequence$1=class{constructor(nt){const ot=[],rt=[];for(let ut=0,gt=nt.length;ut<gt;ut++)ot[ut]=getFirstNonBlankColumn(nt[ut],1),rt[ut]=getLastNonBlankColumn(nt[ut],1);this.lines=nt,this._startColumns=ot,this._endColumns=rt}getElements(){const nt=[];for(let ot=0,rt=this.lines.length;ot<rt;ot++)nt[ot]=this.lines[ot].substring(this._startColumns[ot]-1,this._endColumns[ot]-1);return nt}getStrictElement(nt){return this.lines[nt]}getStartLineNumber(nt){return nt+1}getEndLineNumber(nt){return nt+1}createCharSequence(nt,ot,rt){const ut=[],gt=[],pt=[];let mt=0;for(let vt=ot;vt<=rt;vt++){const St=this.lines[vt],yt=nt?this._startColumns[vt]:1,wt=nt?this._endColumns[vt]:St.length+1;for(let Lt=yt;Lt<wt;Lt++)ut[mt]=St.charCodeAt(Lt-1),gt[mt]=vt+1,pt[mt]=Lt,mt++;!nt&&vt<rt&&(ut[mt]=10,gt[mt]=vt+1,pt[mt]=St.length+1,mt++)}return new CharSequence(ut,gt,pt)}};class CharSequence{constructor(nt,ot,rt){this._charCodes=nt,this._lineNumbers=ot,this._columns=rt}toString(){return"["+this._charCodes.map((nt,ot)=>(nt===10?"\\n":String.fromCharCode(nt))+`-(${this._lineNumbers[ot]},${this._columns[ot]})`).join(", ")+"]"}_assertIndex(nt,ot){if(nt<0||nt>=ot.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(nt){return nt>0&&nt===this._lineNumbers.length?this.getEndLineNumber(nt-1):(this._assertIndex(nt,this._lineNumbers),this._lineNumbers[nt])}getEndLineNumber(nt){return nt===-1?this.getStartLineNumber(nt+1):(this._assertIndex(nt,this._lineNumbers),this._charCodes[nt]===10?this._lineNumbers[nt]+1:this._lineNumbers[nt])}getStartColumn(nt){return nt>0&&nt===this._columns.length?this.getEndColumn(nt-1):(this._assertIndex(nt,this._columns),this._columns[nt])}getEndColumn(nt){return nt===-1?this.getStartColumn(nt+1):(this._assertIndex(nt,this._columns),this._charCodes[nt]===10?1:this._columns[nt]+1)}}class CharChange{constructor(nt,ot,rt,ut,gt,pt,mt,vt){this.originalStartLineNumber=nt,this.originalStartColumn=ot,this.originalEndLineNumber=rt,this.originalEndColumn=ut,this.modifiedStartLineNumber=gt,this.modifiedStartColumn=pt,this.modifiedEndLineNumber=mt,this.modifiedEndColumn=vt}static createFromDiffChange(nt,ot,rt){const ut=ot.getStartLineNumber(nt.originalStart),gt=ot.getStartColumn(nt.originalStart),pt=ot.getEndLineNumber(nt.originalStart+nt.originalLength-1),mt=ot.getEndColumn(nt.originalStart+nt.originalLength-1),vt=rt.getStartLineNumber(nt.modifiedStart),St=rt.getStartColumn(nt.modifiedStart),yt=rt.getEndLineNumber(nt.modifiedStart+nt.modifiedLength-1),wt=rt.getEndColumn(nt.modifiedStart+nt.modifiedLength-1);return new CharChange(ut,gt,pt,mt,vt,St,yt,wt)}}function postProcessCharChanges(ct){if(ct.length<=1)return ct;const nt=[ct[0]];let ot=nt[0];for(let rt=1,ut=ct.length;rt<ut;rt++){const gt=ct[rt],pt=gt.originalStart-(ot.originalStart+ot.originalLength),mt=gt.modifiedStart-(ot.modifiedStart+ot.modifiedLength);Math.min(pt,mt)<MINIMUM_MATCHING_CHARACTER_LENGTH?(ot.originalLength=gt.originalStart+gt.originalLength-ot.originalStart,ot.modifiedLength=gt.modifiedStart+gt.modifiedLength-ot.modifiedStart):(nt.push(gt),ot=gt)}return nt}class LineChange{constructor(nt,ot,rt,ut,gt){this.originalStartLineNumber=nt,this.originalEndLineNumber=ot,this.modifiedStartLineNumber=rt,this.modifiedEndLineNumber=ut,this.charChanges=gt}static createFromDiffResult(nt,ot,rt,ut,gt,pt,mt){let vt,St,yt,wt,Lt;if(ot.originalLength===0?(vt=rt.getStartLineNumber(ot.originalStart)-1,St=0):(vt=rt.getStartLineNumber(ot.originalStart),St=rt.getEndLineNumber(ot.originalStart+ot.originalLength-1)),ot.modifiedLength===0?(yt=ut.getStartLineNumber(ot.modifiedStart)-1,wt=0):(yt=ut.getStartLineNumber(ot.modifiedStart),wt=ut.getEndLineNumber(ot.modifiedStart+ot.modifiedLength-1)),pt&&ot.originalLength>0&&ot.originalLength<20&&ot.modifiedLength>0&&ot.modifiedLength<20&&gt()){const xt=rt.createCharSequence(nt,ot.originalStart,ot.originalStart+ot.originalLength-1),It=ut.createCharSequence(nt,ot.modifiedStart,ot.modifiedStart+ot.modifiedLength-1);if(xt.getElements().length>0&&It.getElements().length>0){let kt=computeDiff(xt,It,gt,!0).changes;mt&&(kt=postProcessCharChanges(kt)),Lt=[];for(let At=0,Tt=kt.length;At<Tt;At++)Lt.push(CharChange.createFromDiffChange(kt[At],xt,It))}}return new LineChange(vt,St,yt,wt,Lt)}}class DiffComputer{constructor(nt,ot,rt){this.shouldComputeCharChanges=rt.shouldComputeCharChanges,this.shouldPostProcessCharChanges=rt.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=rt.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=rt.shouldMakePrettyDiff,this.originalLines=nt,this.modifiedLines=ot,this.original=new LineSequence$1(nt),this.modified=new LineSequence$1(ot),this.continueLineDiff=createContinueProcessingPredicate(rt.maxComputationTime),this.continueCharDiff=createContinueProcessingPredicate(rt.maxComputationTime===0?0:Math.min(rt.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const nt=computeDiff(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),ot=nt.changes,rt=nt.quitEarly;if(this.shouldIgnoreTrimWhitespace){const mt=[];for(let vt=0,St=ot.length;vt<St;vt++)mt.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace,ot[vt],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:rt,changes:mt}}const ut=[];let gt=0,pt=0;for(let mt=-1,vt=ot.length;mt<vt;mt++){const St=mt+1<vt?ot[mt+1]:null,yt=St?St.originalStart:this.originalLines.length,wt=St?St.modifiedStart:this.modifiedLines.length;for(;gt<yt&&pt<wt;){const Lt=this.originalLines[gt],xt=this.modifiedLines[pt];if(Lt!==xt){{let It=getFirstNonBlankColumn(Lt,1),kt=getFirstNonBlankColumn(xt,1);for(;It>1&&kt>1;){const At=Lt.charCodeAt(It-2),Tt=xt.charCodeAt(kt-2);if(At!==Tt)break;It--,kt--}(It>1||kt>1)&&this._pushTrimWhitespaceCharChange(ut,gt+1,1,It,pt+1,1,kt)}{let It=getLastNonBlankColumn(Lt,1),kt=getLastNonBlankColumn(xt,1);const At=Lt.length+1,Tt=xt.length+1;for(;It<At&&kt<Tt;){const Rt=Lt.charCodeAt(It-1),Nt=Lt.charCodeAt(kt-1);if(Rt!==Nt)break;It++,kt++}(It<At||kt<Tt)&&this._pushTrimWhitespaceCharChange(ut,gt+1,It,At,pt+1,kt,Tt)}}gt++,pt++}St&&(ut.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace,St,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),gt+=St.originalLength,pt+=St.modifiedLength)}return{quitEarly:rt,changes:ut}}_pushTrimWhitespaceCharChange(nt,ot,rt,ut,gt,pt,mt){if(this._mergeTrimWhitespaceCharChange(nt,ot,rt,ut,gt,pt,mt))return;let vt;this.shouldComputeCharChanges&&(vt=[new CharChange(ot,rt,ot,ut,gt,pt,gt,mt)]),nt.push(new LineChange(ot,ot,gt,gt,vt))}_mergeTrimWhitespaceCharChange(nt,ot,rt,ut,gt,pt,mt){const vt=nt.length;if(vt===0)return!1;const St=nt[vt-1];return St.originalEndLineNumber===0||St.modifiedEndLineNumber===0?!1:St.originalEndLineNumber===ot&&St.modifiedEndLineNumber===gt?(this.shouldComputeCharChanges&&St.charChanges&&St.charChanges.push(new CharChange(ot,rt,ot,ut,gt,pt,gt,mt)),!0):St.originalEndLineNumber+1===ot&&St.modifiedEndLineNumber+1===gt?(St.originalEndLineNumber=ot,St.modifiedEndLineNumber=gt,this.shouldComputeCharChanges&&St.charChanges&&St.charChanges.push(new CharChange(ot,rt,ot,ut,gt,pt,gt,mt)),!0):!1}}function getFirstNonBlankColumn(ct,nt){const ot=firstNonWhitespaceIndex(ct);return ot===-1?nt:ot+1}function getLastNonBlankColumn(ct,nt){const ot=lastNonWhitespaceIndex(ct);return ot===-1?nt:ot+2}function createContinueProcessingPredicate(ct){if(ct===0)return()=>!0;const nt=Date.now();return()=>Date.now()-nt<ct}class OffsetRange{static addRange(nt,ot){let rt=0;for(;rt<ot.length&&ot[rt].endExclusive<nt.start;)rt++;let ut=rt;for(;ut<ot.length&&ot[ut].start<=nt.endExclusive;)ut++;if(rt===ut)ot.splice(rt,0,nt);else{const gt=Math.min(nt.start,ot[rt].start),pt=Math.max(nt.endExclusive,ot[ut-1].endExclusive);ot.splice(rt,ut-rt,new OffsetRange(gt,pt))}}static tryCreate(nt,ot){if(!(nt>ot))return new OffsetRange(nt,ot)}constructor(nt,ot){if(this.start=nt,this.endExclusive=ot,nt>ot)throw new BugIndicatingError(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(nt){return new OffsetRange(this.start+nt,this.endExclusive+nt)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(nt){return this.start===nt.start&&this.endExclusive===nt.endExclusive}containsRange(nt){return this.start<=nt.start&&nt.endExclusive<=this.endExclusive}join(nt){return new OffsetRange(Math.min(this.start,nt.start),Math.max(this.endExclusive,nt.endExclusive))}intersect(nt){const ot=Math.max(this.start,nt.start),rt=Math.min(this.endExclusive,nt.endExclusive);if(ot<=rt)return new OffsetRange(ot,rt)}}class DiffAlgorithmResult{static trivial(nt,ot){return new DiffAlgorithmResult([new SequenceDiff(new OffsetRange(0,nt.length),new OffsetRange(0,ot.length))],!1)}static trivialTimedOut(nt,ot){return new DiffAlgorithmResult([new SequenceDiff(new OffsetRange(0,nt.length),new OffsetRange(0,ot.length))],!0)}constructor(nt,ot){this.diffs=nt,this.hitTimeout=ot}}class SequenceDiff{constructor(nt,ot){this.seq1Range=nt,this.seq2Range=ot}reverse(){return new SequenceDiff(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(nt){return new SequenceDiff(this.seq1Range.join(nt.seq1Range),this.seq2Range.join(nt.seq2Range))}}class InfiniteTimeout{isValid(){return!0}}InfiniteTimeout.instance=new InfiniteTimeout;class DateTimeout{constructor(nt){if(this.timeout=nt,this.startTime=Date.now(),this.valid=!0,nt<=0)throw new BugIndicatingError("timeout must be positive")}isValid(){if(!(Date.now()-this.startTime<this.timeout)&&this.valid){this.valid=!1;debugger}return this.valid}}class Array2D{constructor(nt,ot){this.width=nt,this.height=ot,this.array=[],this.array=new Array(nt*ot)}get(nt,ot){return this.array[nt+ot*this.width]}set(nt,ot,rt){this.array[nt+ot*this.width]=rt}}class DynamicProgrammingDiffing{compute(nt,ot,rt=InfiniteTimeout.instance,ut){if(nt.length===0||ot.length===0)return DiffAlgorithmResult.trivial(nt,ot);const gt=new Array2D(nt.length,ot.length),pt=new Array2D(nt.length,ot.length),mt=new Array2D(nt.length,ot.length);for(let It=0;It<nt.length;It++)for(let kt=0;kt<ot.length;kt++){if(!rt.isValid())return DiffAlgorithmResult.trivialTimedOut(nt,ot);const At=It===0?0:gt.get(It-1,kt),Tt=kt===0?0:gt.get(It,kt-1);let Rt;nt.getElement(It)===ot.getElement(kt)?(It===0||kt===0?Rt=0:Rt=gt.get(It-1,kt-1),It>0&&kt>0&&pt.get(It-1,kt-1)===3&&(Rt+=mt.get(It-1,kt-1)),Rt+=ut?ut(It,kt):1):Rt=-1;const Nt=Math.max(At,Tt,Rt);if(Nt===Rt){const Pt=It>0&&kt>0?mt.get(It-1,kt-1):0;mt.set(It,kt,Pt+1),pt.set(It,kt,3)}else Nt===At?(mt.set(It,kt,0),pt.set(It,kt,1)):Nt===Tt&&(mt.set(It,kt,0),pt.set(It,kt,2));gt.set(It,kt,Nt)}const vt=[];let St=nt.length,yt=ot.length;function wt(It,kt){(It+1!==St||kt+1!==yt)&&vt.push(new SequenceDiff(new OffsetRange(It+1,St),new OffsetRange(kt+1,yt))),St=It,yt=kt}let Lt=nt.length-1,xt=ot.length-1;for(;Lt>=0&&xt>=0;)pt.get(Lt,xt)===3?(wt(Lt,xt),Lt--,xt--):pt.get(Lt,xt)===1?Lt--:xt--;return wt(-1,-1),vt.reverse(),new DiffAlgorithmResult(vt,!1)}}function optimizeSequenceDiffs(ct,nt,ot){let rt=ot;return rt=joinSequenceDiffs(ct,nt,rt),rt=shiftSequenceDiffs(ct,nt,rt),rt}function smoothenSequenceDiffs(ct,nt,ot){const rt=[];for(const ut of ot){const gt=rt[rt.length-1];if(!gt){rt.push(ut);continue}ut.seq1Range.start-gt.seq1Range.endExclusive<=2||ut.seq2Range.start-gt.seq2Range.endExclusive<=2?rt[rt.length-1]=new SequenceDiff(gt.seq1Range.join(ut.seq1Range),gt.seq2Range.join(ut.seq2Range)):rt.push(ut)}return rt}function joinSequenceDiffs(ct,nt,ot){const rt=[];ot.length>0&&rt.push(ot[0]);for(let ut=1;ut<ot.length;ut++){const gt=rt[rt.length-1],pt=ot[ut];if(pt.seq1Range.isEmpty){let mt=!0;const vt=pt.seq1Range.start-gt.seq1Range.endExclusive;for(let St=1;St<=vt;St++)if(nt.getElement(pt.seq2Range.start-St)!==nt.getElement(pt.seq2Range.endExclusive-St)){mt=!1;break}if(mt){rt[rt.length-1]=new SequenceDiff(gt.seq1Range,new OffsetRange(gt.seq2Range.start,pt.seq2Range.endExclusive-vt));continue}}rt.push(pt)}return rt}function shiftSequenceDiffs(ct,nt,ot){if(!ct.getBoundaryScore||!nt.getBoundaryScore)return ot;for(let rt=0;rt<ot.length;rt++){const ut=ot[rt];if(ut.seq1Range.isEmpty){const gt=rt>0?ot[rt-1].seq2Range.endExclusive:-1,pt=rt+1<ot.length?ot[rt+1].seq2Range.start:nt.length;ot[rt]=shiftDiffToBetterPosition(ut,ct,nt,pt,gt)}else if(ut.seq2Range.isEmpty){const gt=rt>0?ot[rt-1].seq1Range.endExclusive:-1,pt=rt+1<ot.length?ot[rt+1].seq1Range.start:ct.length;ot[rt]=shiftDiffToBetterPosition(ut.reverse(),nt,ct,pt,gt).reverse()}}return ot}function shiftDiffToBetterPosition(ct,nt,ot,rt,ut){let pt=1;for(;ct.seq2Range.start-pt>ut&&ot.getElement(ct.seq2Range.start-pt)===ot.getElement(ct.seq2Range.endExclusive-pt)&&pt<20;)pt++;pt--;let mt=0;for(;ct.seq2Range.start+mt<rt&&ot.getElement(ct.seq2Range.start+mt)===ot.getElement(ct.seq2Range.endExclusive+mt)&&mt<20;)mt++;if(pt===0&&mt===0)return ct;let vt=0,St=-1;for(let yt=-pt;yt<=mt;yt++){const wt=ct.seq2Range.start+yt,Lt=ct.seq2Range.endExclusive+yt,xt=ct.seq1Range.start+yt,It=nt.getBoundaryScore(xt)+ot.getBoundaryScore(wt)+ot.getBoundaryScore(Lt);It>St&&(St=It,vt=yt)}return vt!==0?new SequenceDiff(ct.seq1Range.delta(vt),ct.seq2Range.delta(vt)):ct}class MyersDiffAlgorithm{compute(nt,ot,rt=InfiniteTimeout.instance){if(nt.length===0||ot.length===0)return DiffAlgorithmResult.trivial(nt,ot);function ut(xt,It){for(;xt<nt.length&&It<ot.length&&nt.getElement(xt)===ot.getElement(It);)xt++,It++;return xt}let gt=0;const pt=new FastInt32Array;pt.set(0,ut(0,0));const mt=new FastArrayNegativeIndices;mt.set(0,pt.get(0)===0?null:new SnakePath(null,0,0,pt.get(0)));let vt=0;e:for(;;)for(gt++,vt=-gt;vt<=gt;vt+=2){if(!rt.isValid())return DiffAlgorithmResult.trivialTimedOut(nt,ot);const xt=vt===gt?-1:pt.get(vt+1),It=vt===-gt?-1:pt.get(vt-1)+1,kt=Math.min(Math.max(xt,It),nt.length),At=kt-vt,Tt=ut(kt,At);pt.set(vt,Tt);const Rt=kt===xt?mt.get(vt+1):mt.get(vt-1);if(mt.set(vt,Tt!==kt?new SnakePath(Rt,kt,At,Tt-kt):Rt),pt.get(vt)===nt.length&&pt.get(vt)-vt===ot.length)break e}let St=mt.get(vt);const yt=[];let wt=nt.length,Lt=ot.length;for(;;){const xt=St?St.x+St.length:0,It=St?St.y+St.length:0;if((xt!==wt||It!==Lt)&&yt.push(new SequenceDiff(new OffsetRange(xt,wt),new OffsetRange(It,Lt))),!St)break;wt=St.x,Lt=St.y,St=St.prev}return yt.reverse(),new DiffAlgorithmResult(yt,!1)}}class SnakePath{constructor(nt,ot,rt,ut){this.prev=nt,this.x=ot,this.y=rt,this.length=ut}}class FastInt32Array{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(nt){return nt<0?(nt=-nt-1,this.negativeArr[nt]):this.positiveArr[nt]}set(nt,ot){if(nt<0){if(nt=-nt-1,nt>=this.negativeArr.length){const rt=this.negativeArr;this.negativeArr=new Int32Array(rt.length*2),this.negativeArr.set(rt)}this.negativeArr[nt]=ot}else{if(nt>=this.positiveArr.length){const rt=this.positiveArr;this.positiveArr=new Int32Array(rt.length*2),this.positiveArr.set(rt)}this.positiveArr[nt]=ot}}}class FastArrayNegativeIndices{constructor(){this.positiveArr=[],this.negativeArr=[]}get(nt){return nt<0?(nt=-nt-1,this.negativeArr[nt]):this.positiveArr[nt]}set(nt,ot){nt<0?(nt=-nt-1,this.negativeArr[nt]=ot):this.positiveArr[nt]=ot}}class StandardLinesDiffComputer{constructor(){this.dynamicProgrammingDiffing=new DynamicProgrammingDiffing,this.myersDiffingAlgorithm=new MyersDiffAlgorithm}computeDiff(nt,ot,rt){const ut=rt.maxComputationTimeMs===0?InfiniteTimeout.instance:new DateTimeout(rt.maxComputationTimeMs),gt=!rt.ignoreTrimWhitespace,pt=new Map;function mt(Pt){let Ft=pt.get(Pt);return Ft===void 0&&(Ft=pt.size,pt.set(Pt,Ft)),Ft}const vt=nt.map(Pt=>mt(Pt.trim())),St=ot.map(Pt=>mt(Pt.trim())),yt=new LineSequence(vt,nt),wt=new LineSequence(St,ot),Lt=(()=>yt.length+wt.length<1500?this.dynamicProgrammingDiffing.compute(yt,wt,ut,(Pt,Ft)=>nt[Pt]===ot[Ft]?ot[Ft].length===0?.1:1+Math.log(1+ot[Ft].length):.99):this.myersDiffingAlgorithm.compute(yt,wt))();let xt=Lt.diffs,It=Lt.hitTimeout;xt=optimizeSequenceDiffs(yt,wt,xt);const kt=[],At=Pt=>{if(gt)for(let Ft=0;Ft<Pt;Ft++){const Kt=Tt+Ft,Bt=Rt+Ft;if(nt[Kt]!==ot[Bt]){const Ut=this.refineDiff(nt,ot,new SequenceDiff(new OffsetRange(Kt,Kt+1),new OffsetRange(Bt,Bt+1)),ut,gt);for(const qt of Ut.mappings)kt.push(qt);Ut.hitTimeout&&(It=!0)}}};let Tt=0,Rt=0;for(const Pt of xt){assertFn(()=>Pt.seq1Range.start-Tt===Pt.seq2Range.start-Rt);const Ft=Pt.seq1Range.start-Tt;At(Ft),Tt=Pt.seq1Range.endExclusive,Rt=Pt.seq2Range.endExclusive;const Kt=this.refineDiff(nt,ot,Pt,ut,gt);Kt.hitTimeout&&(It=!0);for(const Bt of Kt.mappings)kt.push(Bt)}At(nt.length-Tt);const Nt=lineRangeMappingFromRangeMappings(kt,nt,ot);return new LinesDiff(Nt,It)}refineDiff(nt,ot,rt,ut,gt){const pt=new Slice(nt,rt.seq1Range,gt),mt=new Slice(ot,rt.seq2Range,gt),vt=pt.length+mt.length<500?this.dynamicProgrammingDiffing.compute(pt,mt,ut):this.myersDiffingAlgorithm.compute(pt,mt,ut);let St=vt.diffs;return St=optimizeSequenceDiffs(pt,mt,St),St=coverFullWords(pt,mt,St),St=smoothenSequenceDiffs(pt,mt,St),{mappings:St.map(wt=>new RangeMapping(pt.translateRange(wt.seq1Range),mt.translateRange(wt.seq2Range))),hitTimeout:vt.hitTimeout}}}function coverFullWords(ct,nt,ot){const rt=[];let ut;function gt(){if(!ut)return;const mt=ut.s1Range.length-ut.deleted;ut.s2Range.length-ut.added,Math.max(ut.deleted,ut.added)+(ut.count-1)>mt&&rt.push(new SequenceDiff(ut.s1Range,ut.s2Range)),ut=void 0}for(const mt of ot){let vt=function(xt,It){var kt,At,Tt,Rt;if(!ut||!ut.s1Range.containsRange(xt)||!ut.s2Range.containsRange(It))if(ut&&!(ut.s1Range.endExclusive<xt.start&&ut.s2Range.endExclusive<It.start)){const Ft=OffsetRange.tryCreate(ut.s1Range.endExclusive,xt.start),Kt=OffsetRange.tryCreate(ut.s2Range.endExclusive,It.start);ut.deleted+=(kt=Ft==null?void 0:Ft.length)!==null&&kt!==void 0?kt:0,ut.added+=(At=Kt==null?void 0:Kt.length)!==null&&At!==void 0?At:0,ut.s1Range=ut.s1Range.join(xt),ut.s2Range=ut.s2Range.join(It)}else gt(),ut={added:0,deleted:0,count:0,s1Range:xt,s2Range:It};const Nt=xt.intersect(mt.seq1Range),Pt=It.intersect(mt.seq2Range);ut.count++,ut.deleted+=(Tt=Nt==null?void 0:Nt.length)!==null&&Tt!==void 0?Tt:0,ut.added+=(Rt=Pt==null?void 0:Pt.length)!==null&&Rt!==void 0?Rt:0};const St=ct.findWordContaining(mt.seq1Range.start-1),yt=nt.findWordContaining(mt.seq2Range.start-1),wt=ct.findWordContaining(mt.seq1Range.endExclusive),Lt=nt.findWordContaining(mt.seq2Range.endExclusive);St&&wt&&yt&&Lt&&St.equals(wt)&&yt.equals(Lt)?vt(St,yt):(St&&yt&&vt(St,yt),wt&&Lt&&vt(wt,Lt))}return gt(),mergeSequenceDiffs(ot,rt)}function mergeSequenceDiffs(ct,nt){const ot=[];for(;ct.length>0||nt.length>0;){const rt=ct[0],ut=nt[0];let gt;rt&&(!ut||rt.seq1Range.start<ut.seq1Range.start)?gt=ct.shift():gt=nt.shift(),ot.length>0&&ot[ot.length-1].seq1Range.endExclusive>=gt.seq1Range.start?ot[ot.length-1]=ot[ot.length-1].join(gt):ot.push(gt)}return ot}function lineRangeMappingFromRangeMappings(ct,nt,ot){const rt=[];for(const ut of group(ct.map(gt=>getLineRangeMapping(gt,nt,ot)),(gt,pt)=>gt.originalRange.overlapOrTouch(pt.originalRange)||gt.modifiedRange.overlapOrTouch(pt.modifiedRange))){const gt=ut[0],pt=ut[ut.length-1];rt.push(new LineRangeMapping(gt.originalRange.join(pt.originalRange),gt.modifiedRange.join(pt.modifiedRange),ut.map(mt=>mt.innerChanges[0])))}return assertFn(()=>checkAdjacentItems(rt,(ut,gt)=>gt.originalRange.startLineNumber-ut.originalRange.endLineNumberExclusive===gt.modifiedRange.startLineNumber-ut.modifiedRange.endLineNumberExclusive&&ut.originalRange.endLineNumberExclusive<gt.originalRange.startLineNumber&&ut.modifiedRange.endLineNumberExclusive<gt.modifiedRange.startLineNumber)),rt}function getLineRangeMapping(ct,nt,ot){let rt=0,ut=0;ct.modifiedRange.startColumn-1>=ot[ct.modifiedRange.startLineNumber-1].length&&ct.originalRange.startColumn-1>=nt[ct.originalRange.startLineNumber-1].length&&(rt=1),ct.modifiedRange.endColumn===1&&ct.originalRange.endColumn===1&&ct.originalRange.startLineNumber+rt<=ct.originalRange.endLineNumber&&ct.modifiedRange.startLineNumber+rt<=ct.modifiedRange.endLineNumber&&(ut=-1);const gt=new LineRange$1(ct.originalRange.startLineNumber+rt,ct.originalRange.endLineNumber+1+ut),pt=new LineRange$1(ct.modifiedRange.startLineNumber+rt,ct.modifiedRange.endLineNumber+1+ut);return new LineRangeMapping(gt,pt,[ct])}function*group(ct,nt){let ot,rt;for(const ut of ct)rt!==void 0&&nt(rt,ut)?ot.push(ut):(ot&&(yield ot),ot=[ut]),rt=ut;ot&&(yield ot)}class LineSequence{constructor(nt,ot){this.trimmedHash=nt,this.lines=ot}getElement(nt){return this.trimmedHash[nt]}get length(){return this.trimmedHash.length}getBoundaryScore(nt){const ot=nt===0?0:getIndentation(this.lines[nt-1]),rt=nt===this.lines.length?0:getIndentation(this.lines[nt]);return 1e3-(ot+rt)}}function getIndentation(ct){let nt=0;for(;nt<ct.length&&(ct.charCodeAt(nt)===32||ct.charCodeAt(nt)===9);)nt++;return nt}class Slice{constructor(nt,ot,rt){this.lines=nt,this.considerWhitespaceChanges=rt,this.elements=[],this.firstCharOffsetByLineMinusOne=[],this.offsetByLine=[];let ut=!1;ot.start>0&&ot.endExclusive>=nt.length&&(ot=new OffsetRange(ot.start-1,ot.endExclusive),ut=!0),this.lineRange=ot;for(let gt=this.lineRange.start;gt<this.lineRange.endExclusive;gt++){let pt=nt[gt],mt=0;if(ut)mt=pt.length,pt="",ut=!1;else if(!rt){const vt=pt.trimStart();mt=pt.length-vt.length,pt=vt.trimEnd()}this.offsetByLine.push(mt);for(let vt=0;vt<pt.length;vt++)this.elements.push(pt.charCodeAt(vt));gt<nt.length-1&&(this.elements.push(`
`.charCodeAt(0)),this.firstCharOffsetByLineMinusOne[gt-this.lineRange.start]=this.elements.length)}this.offsetByLine.push(0)}toString(){return`Slice: "${this.text}"`}get text(){return[...this.elements].map(nt=>String.fromCharCode(nt)).join("")}getElement(nt){return this.elements[nt]}get length(){return this.elements.length}getBoundaryScore(nt){const ot=getCategory(nt>0?this.elements[nt-1]:-1),rt=getCategory(nt<this.elements.length?this.elements[nt]:-1);if(ot===6&&rt===7)return 0;let ut=0;return ot!==rt&&(ut+=10,rt===1&&(ut+=1)),ut+=getCategoryBoundaryScore(ot),ut+=getCategoryBoundaryScore(rt),ut}translateOffset(nt){if(this.lineRange.isEmpty)return new Position$1(this.lineRange.start+1,1);let ot=0,rt=this.firstCharOffsetByLineMinusOne.length;for(;ot<rt;){const gt=Math.floor((ot+rt)/2);this.firstCharOffsetByLineMinusOne[gt]>nt?rt=gt:ot=gt+1}const ut=ot===0?0:this.firstCharOffsetByLineMinusOne[ot-1];return new Position$1(this.lineRange.start+ot+1,nt-ut+1+this.offsetByLine[ot])}translateRange(nt){return Range$2.fromPositions(this.translateOffset(nt.start),this.translateOffset(nt.endExclusive))}findWordContaining(nt){if(nt<0||nt>=this.elements.length||!isWordChar(this.elements[nt]))return;let ot=nt;for(;ot>0&&isWordChar(this.elements[ot-1]);)ot--;let rt=nt;for(;rt<this.elements.length&&isWordChar(this.elements[rt]);)rt++;return new OffsetRange(ot,rt)}}function isWordChar(ct){return ct>=97&&ct<=122||ct>=65&&ct<=90||ct>=48&&ct<=57}const score$1={[0]:0,[1]:0,[2]:0,[3]:10,[4]:2,[5]:3,[6]:10,[7]:10};function getCategoryBoundaryScore(ct){return score$1[ct]}function getCategory(ct){return ct===10?7:ct===13?6:isSpace(ct)?5:ct>=97&&ct<=122?0:ct>=65&&ct<=90?1:ct>=48&&ct<=57?2:ct===-1?3:4}function isSpace(ct){return ct===32||ct===9}const linesDiffComputers={legacy:new SmartLinesDiffComputer,advanced:new StandardLinesDiffComputer};function roundFloat(ct,nt){const ot=Math.pow(10,nt);return Math.round(ct*ot)/ot}class RGBA{constructor(nt,ot,rt,ut=1){this._rgbaBrand=void 0,this.r=Math.min(255,Math.max(0,nt))|0,this.g=Math.min(255,Math.max(0,ot))|0,this.b=Math.min(255,Math.max(0,rt))|0,this.a=roundFloat(Math.max(Math.min(1,ut),0),3)}static equals(nt,ot){return nt.r===ot.r&&nt.g===ot.g&&nt.b===ot.b&&nt.a===ot.a}}class HSLA{constructor(nt,ot,rt,ut){this._hslaBrand=void 0,this.h=Math.max(Math.min(360,nt),0)|0,this.s=roundFloat(Math.max(Math.min(1,ot),0),3),this.l=roundFloat(Math.max(Math.min(1,rt),0),3),this.a=roundFloat(Math.max(Math.min(1,ut),0),3)}static equals(nt,ot){return nt.h===ot.h&&nt.s===ot.s&&nt.l===ot.l&&nt.a===ot.a}static fromRGBA(nt){const ot=nt.r/255,rt=nt.g/255,ut=nt.b/255,gt=nt.a,pt=Math.max(ot,rt,ut),mt=Math.min(ot,rt,ut);let vt=0,St=0;const yt=(mt+pt)/2,wt=pt-mt;if(wt>0){switch(St=Math.min(yt<=.5?wt/(2*yt):wt/(2-2*yt),1),pt){case ot:vt=(rt-ut)/wt+(rt<ut?6:0);break;case rt:vt=(ut-ot)/wt+2;break;case ut:vt=(ot-rt)/wt+4;break}vt*=60,vt=Math.round(vt)}return new HSLA(vt,St,yt,gt)}static _hue2rgb(nt,ot,rt){return rt<0&&(rt+=1),rt>1&&(rt-=1),rt<1/6?nt+(ot-nt)*6*rt:rt<1/2?ot:rt<2/3?nt+(ot-nt)*(2/3-rt)*6:nt}static toRGBA(nt){const ot=nt.h/360,{s:rt,l:ut,a:gt}=nt;let pt,mt,vt;if(rt===0)pt=mt=vt=ut;else{const St=ut<.5?ut*(1+rt):ut+rt-ut*rt,yt=2*ut-St;pt=HSLA._hue2rgb(yt,St,ot+1/3),mt=HSLA._hue2rgb(yt,St,ot),vt=HSLA._hue2rgb(yt,St,ot-1/3)}return new RGBA(Math.round(pt*255),Math.round(mt*255),Math.round(vt*255),gt)}}class HSVA{constructor(nt,ot,rt,ut){this._hsvaBrand=void 0,this.h=Math.max(Math.min(360,nt),0)|0,this.s=roundFloat(Math.max(Math.min(1,ot),0),3),this.v=roundFloat(Math.max(Math.min(1,rt),0),3),this.a=roundFloat(Math.max(Math.min(1,ut),0),3)}static equals(nt,ot){return nt.h===ot.h&&nt.s===ot.s&&nt.v===ot.v&&nt.a===ot.a}static fromRGBA(nt){const ot=nt.r/255,rt=nt.g/255,ut=nt.b/255,gt=Math.max(ot,rt,ut),pt=Math.min(ot,rt,ut),mt=gt-pt,vt=gt===0?0:mt/gt;let St;return mt===0?St=0:gt===ot?St=((rt-ut)/mt%6+6)%6:gt===rt?St=(ut-ot)/mt+2:St=(ot-rt)/mt+4,new HSVA(Math.round(St*60),vt,gt,nt.a)}static toRGBA(nt){const{h:ot,s:rt,v:ut,a:gt}=nt,pt=ut*rt,mt=pt*(1-Math.abs(ot/60%2-1)),vt=ut-pt;let[St,yt,wt]=[0,0,0];return ot<60?(St=pt,yt=mt):ot<120?(St=mt,yt=pt):ot<180?(yt=pt,wt=mt):ot<240?(yt=mt,wt=pt):ot<300?(St=mt,wt=pt):ot<=360&&(St=pt,wt=mt),St=Math.round((St+vt)*255),yt=Math.round((yt+vt)*255),wt=Math.round((wt+vt)*255),new RGBA(St,yt,wt,gt)}}class Color{static fromHex(nt){return Color.Format.CSS.parseHex(nt)||Color.red}static equals(nt,ot){return!nt&&!ot?!0:!nt||!ot?!1:nt.equals(ot)}get hsla(){return this._hsla?this._hsla:HSLA.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:HSVA.fromRGBA(this.rgba)}constructor(nt){if(nt)if(nt instanceof RGBA)this.rgba=nt;else if(nt instanceof HSLA)this._hsla=nt,this.rgba=HSLA.toRGBA(nt);else if(nt instanceof HSVA)this._hsva=nt,this.rgba=HSVA.toRGBA(nt);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(nt){return!!nt&&RGBA.equals(this.rgba,nt.rgba)&&HSLA.equals(this.hsla,nt.hsla)&&HSVA.equals(this.hsva,nt.hsva)}getRelativeLuminance(){const nt=Color._relativeLuminanceForComponent(this.rgba.r),ot=Color._relativeLuminanceForComponent(this.rgba.g),rt=Color._relativeLuminanceForComponent(this.rgba.b),ut=.2126*nt+.7152*ot+.0722*rt;return roundFloat(ut,4)}static _relativeLuminanceForComponent(nt){const ot=nt/255;return ot<=.03928?ot/12.92:Math.pow((ot+.055)/1.055,2.4)}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(nt){const ot=this.getRelativeLuminance(),rt=nt.getRelativeLuminance();return ot>rt}isDarkerThan(nt){const ot=this.getRelativeLuminance(),rt=nt.getRelativeLuminance();return ot<rt}lighten(nt){return new Color(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*nt,this.hsla.a))}darken(nt){return new Color(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*nt,this.hsla.a))}transparent(nt){const{r:ot,g:rt,b:ut,a:gt}=this.rgba;return new Color(new RGBA(ot,rt,ut,gt*nt))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new Color(new RGBA(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}makeOpaque(nt){if(this.isOpaque()||nt.rgba.a!==1)return this;const{r:ot,g:rt,b:ut,a:gt}=this.rgba;return new Color(new RGBA(nt.rgba.r-gt*(nt.rgba.r-ot),nt.rgba.g-gt*(nt.rgba.g-rt),nt.rgba.b-gt*(nt.rgba.b-ut),1))}toString(){return this._toString||(this._toString=Color.Format.CSS.format(this)),this._toString}static getLighterColor(nt,ot,rt){if(nt.isLighterThan(ot))return nt;rt=rt||.5;const ut=nt.getRelativeLuminance(),gt=ot.getRelativeLuminance();return rt=rt*(gt-ut)/gt,nt.lighten(rt)}static getDarkerColor(nt,ot,rt){if(nt.isDarkerThan(ot))return nt;rt=rt||.5;const ut=nt.getRelativeLuminance(),gt=ot.getRelativeLuminance();return rt=rt*(ut-gt)/ut,nt.darken(rt)}}Color.white=new Color(new RGBA(255,255,255,1));Color.black=new Color(new RGBA(0,0,0,1));Color.red=new Color(new RGBA(255,0,0,1));Color.blue=new Color(new RGBA(0,0,255,1));Color.green=new Color(new RGBA(0,255,0,1));Color.cyan=new Color(new RGBA(0,255,255,1));Color.lightgrey=new Color(new RGBA(211,211,211,1));Color.transparent=new Color(new RGBA(0,0,0,0));(function(ct){(function(nt){(function(ot){function rt(xt){return xt.rgba.a===1?`rgb(${xt.rgba.r}, ${xt.rgba.g}, ${xt.rgba.b})`:ct.Format.CSS.formatRGBA(xt)}ot.formatRGB=rt;function ut(xt){return`rgba(${xt.rgba.r}, ${xt.rgba.g}, ${xt.rgba.b}, ${+xt.rgba.a.toFixed(2)})`}ot.formatRGBA=ut;function gt(xt){return xt.hsla.a===1?`hsl(${xt.hsla.h}, ${(xt.hsla.s*100).toFixed(2)}%, ${(xt.hsla.l*100).toFixed(2)}%)`:ct.Format.CSS.formatHSLA(xt)}ot.formatHSL=gt;function pt(xt){return`hsla(${xt.hsla.h}, ${(xt.hsla.s*100).toFixed(2)}%, ${(xt.hsla.l*100).toFixed(2)}%, ${xt.hsla.a.toFixed(2)})`}ot.formatHSLA=pt;function mt(xt){const It=xt.toString(16);return It.length!==2?"0"+It:It}function vt(xt){return`#${mt(xt.rgba.r)}${mt(xt.rgba.g)}${mt(xt.rgba.b)}`}ot.formatHex=vt;function St(xt,It=!1){return It&&xt.rgba.a===1?ct.Format.CSS.formatHex(xt):`#${mt(xt.rgba.r)}${mt(xt.rgba.g)}${mt(xt.rgba.b)}${mt(Math.round(xt.rgba.a*255))}`}ot.formatHexA=St;function yt(xt){return xt.isOpaque()?ct.Format.CSS.formatHex(xt):ct.Format.CSS.formatRGBA(xt)}ot.format=yt;function wt(xt){const It=xt.length;if(It===0||xt.charCodeAt(0)!==35)return null;if(It===7){const kt=16*Lt(xt.charCodeAt(1))+Lt(xt.charCodeAt(2)),At=16*Lt(xt.charCodeAt(3))+Lt(xt.charCodeAt(4)),Tt=16*Lt(xt.charCodeAt(5))+Lt(xt.charCodeAt(6));return new ct(new RGBA(kt,At,Tt,1))}if(It===9){const kt=16*Lt(xt.charCodeAt(1))+Lt(xt.charCodeAt(2)),At=16*Lt(xt.charCodeAt(3))+Lt(xt.charCodeAt(4)),Tt=16*Lt(xt.charCodeAt(5))+Lt(xt.charCodeAt(6)),Rt=16*Lt(xt.charCodeAt(7))+Lt(xt.charCodeAt(8));return new ct(new RGBA(kt,At,Tt,Rt/255))}if(It===4){const kt=Lt(xt.charCodeAt(1)),At=Lt(xt.charCodeAt(2)),Tt=Lt(xt.charCodeAt(3));return new ct(new RGBA(16*kt+kt,16*At+At,16*Tt+Tt))}if(It===5){const kt=Lt(xt.charCodeAt(1)),At=Lt(xt.charCodeAt(2)),Tt=Lt(xt.charCodeAt(3)),Rt=Lt(xt.charCodeAt(4));return new ct(new RGBA(16*kt+kt,16*At+At,16*Tt+Tt,(16*Rt+Rt)/255))}return null}ot.parseHex=wt;function Lt(xt){switch(xt){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(nt.CSS||(nt.CSS={}))})(ct.Format||(ct.Format={}))})(Color||(Color={}));function _parseCaptureGroups(ct){const nt=[];for(const ot of ct){const rt=Number(ot);(rt||rt===0&&ot.replace(/\s/g,"")!=="")&&nt.push(rt)}return nt}function _toIColor(ct,nt,ot,rt){return{red:ct/255,blue:ot/255,green:nt/255,alpha:rt}}function _findRange(ct,nt){const ot=nt.index,rt=nt[0].length;if(!ot)return;const ut=ct.positionAt(ot);return{startLineNumber:ut.lineNumber,startColumn:ut.column,endLineNumber:ut.lineNumber,endColumn:ut.column+rt}}function _findHexColorInformation(ct,nt){if(!ct)return;const ot=Color.Format.CSS.parseHex(nt);if(ot)return{range:ct,color:_toIColor(ot.rgba.r,ot.rgba.g,ot.rgba.b,ot.rgba.a)}}function _findRGBColorInformation(ct,nt,ot){if(!ct||nt.length!==1)return;const ut=nt[0].values(),gt=_parseCaptureGroups(ut);return{range:ct,color:_toIColor(gt[0],gt[1],gt[2],ot?gt[3]:1)}}function _findHSLColorInformation(ct,nt,ot){if(!ct||nt.length!==1)return;const ut=nt[0].values(),gt=_parseCaptureGroups(ut),pt=new Color(new HSLA(gt[0],gt[1]/100,gt[2]/100,ot?gt[3]:1));return{range:ct,color:_toIColor(pt.rgba.r,pt.rgba.g,pt.rgba.b,pt.rgba.a)}}function _findMatches(ct,nt){return typeof ct=="string"?[...ct.matchAll(nt)]:ct.findMatches(nt)}function computeColors(ct){const nt=[],rt=_findMatches(ct,/\b(rgb|rgba|hsl|hsla)(\([0-9\s,.\%]*\))|(#)([A-Fa-f0-9]{6})\b|(#)([A-Fa-f0-9]{8})\b/gm);if(rt.length>0)for(const ut of rt){const gt=ut.filter(St=>St!==void 0),pt=gt[1],mt=gt[2];if(!mt)continue;let vt;if(pt==="rgb"){const St=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;vt=_findRGBColorInformation(_findRange(ct,ut),_findMatches(mt,St),!1)}else if(pt==="rgba"){const St=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;vt=_findRGBColorInformation(_findRange(ct,ut),_findMatches(mt,St),!0)}else if(pt==="hsl"){const St=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;vt=_findHSLColorInformation(_findRange(ct,ut),_findMatches(mt,St),!1)}else if(pt==="hsla"){const St=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;vt=_findHSLColorInformation(_findRange(ct,ut),_findMatches(mt,St),!0)}else pt==="#"&&(vt=_findHexColorInformation(_findRange(ct,ut),pt+mt));vt&&nt.push(vt)}return nt}function computeDefaultDocumentColors(ct){return!ct||typeof ct.getValue!="function"||typeof ct.positionAt!="function"?[]:computeColors(ct)}var __awaiter$1t=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class MirrorModel extends MirrorTextModel{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(nt){const ot=[];for(let rt=0;rt<this._lines.length;rt++){const ut=this._lines[rt],gt=this.offsetAt(new Position$1(rt+1,1)),pt=ut.matchAll(nt);for(const mt of pt)(mt.index||mt.index===0)&&(mt.index=mt.index+gt),ot.push(mt)}return ot}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(nt){return this._lines[nt-1]}getWordAtPosition(nt,ot){const rt=getWordAtText(nt.column,ensureValidWordDefinition(ot),this._lines[nt.lineNumber-1],0);return rt?new Range$2(nt.lineNumber,rt.startColumn,nt.lineNumber,rt.endColumn):null}words(nt){const ot=this._lines,rt=this._wordenize.bind(this);let ut=0,gt="",pt=0,mt=[];return{*[Symbol.iterator](){for(;;)if(pt<mt.length){const vt=gt.substring(mt[pt].start,mt[pt].end);pt+=1,yield vt}else if(ut<ot.length)gt=ot[ut],mt=rt(gt,nt),pt=0,ut+=1;else break}}}getLineWords(nt,ot){const rt=this._lines[nt-1],ut=this._wordenize(rt,ot),gt=[];for(const pt of ut)gt.push({word:rt.substring(pt.start,pt.end),startColumn:pt.start+1,endColumn:pt.end+1});return gt}_wordenize(nt,ot){const rt=[];let ut;for(ot.lastIndex=0;(ut=ot.exec(nt))&&ut[0].length!==0;)rt.push({start:ut.index,end:ut.index+ut[0].length});return rt}getValueInRange(nt){if(nt=this._validateRange(nt),nt.startLineNumber===nt.endLineNumber)return this._lines[nt.startLineNumber-1].substring(nt.startColumn-1,nt.endColumn-1);const ot=this._eol,rt=nt.startLineNumber-1,ut=nt.endLineNumber-1,gt=[];gt.push(this._lines[rt].substring(nt.startColumn-1));for(let pt=rt+1;pt<ut;pt++)gt.push(this._lines[pt]);return gt.push(this._lines[ut].substring(0,nt.endColumn-1)),gt.join(ot)}offsetAt(nt){return nt=this._validatePosition(nt),this._ensureLineStarts(),this._lineStarts.getPrefixSum(nt.lineNumber-2)+(nt.column-1)}positionAt(nt){nt=Math.floor(nt),nt=Math.max(0,nt),this._ensureLineStarts();const ot=this._lineStarts.getIndexOf(nt),rt=this._lines[ot.index].length;return{lineNumber:1+ot.index,column:1+Math.min(ot.remainder,rt)}}_validateRange(nt){const ot=this._validatePosition({lineNumber:nt.startLineNumber,column:nt.startColumn}),rt=this._validatePosition({lineNumber:nt.endLineNumber,column:nt.endColumn});return ot.lineNumber!==nt.startLineNumber||ot.column!==nt.startColumn||rt.lineNumber!==nt.endLineNumber||rt.column!==nt.endColumn?{startLineNumber:ot.lineNumber,startColumn:ot.column,endLineNumber:rt.lineNumber,endColumn:rt.column}:nt}_validatePosition(nt){if(!Position$1.isIPosition(nt))throw new Error("bad position");let{lineNumber:ot,column:rt}=nt,ut=!1;if(ot<1)ot=1,rt=1,ut=!0;else if(ot>this._lines.length)ot=this._lines.length,rt=this._lines[ot-1].length+1,ut=!0;else{const gt=this._lines[ot-1].length+1;rt<1?(rt=1,ut=!0):rt>gt&&(rt=gt,ut=!0)}return ut?{lineNumber:ot,column:rt}:nt}}class EditorSimpleWorker{constructor(nt,ot){this._host=nt,this._models=Object.create(null),this._foreignModuleFactory=ot,this._foreignModule=null}dispose(){this._models=Object.create(null)}_getModel(nt){return this._models[nt]}_getModels(){const nt=[];return Object.keys(this._models).forEach(ot=>nt.push(this._models[ot])),nt}acceptNewModel(nt){this._models[nt.url]=new MirrorModel(URI.parse(nt.url),nt.lines,nt.EOL,nt.versionId)}acceptModelChanged(nt,ot){if(!this._models[nt])return;this._models[nt].onEvents(ot)}acceptRemovedModel(nt){this._models[nt]&&delete this._models[nt]}computeUnicodeHighlights(nt,ot,rt){return __awaiter$1t(this,void 0,void 0,function*(){const ut=this._getModel(nt);return ut?UnicodeTextModelHighlighter.computeUnicodeHighlights(ut,ot,rt):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}})}computeDiff(nt,ot,rt,ut){return __awaiter$1t(this,void 0,void 0,function*(){const gt=this._getModel(nt),pt=this._getModel(ot);return!gt||!pt?null:EditorSimpleWorker.computeDiff(gt,pt,rt,ut)})}static computeDiff(nt,ot,rt,ut){const gt=ut==="advanced"?linesDiffComputers.advanced:linesDiffComputers.legacy,pt=nt.getLinesContent(),mt=ot.getLinesContent(),vt=gt.computeDiff(pt,mt,rt);return{identical:vt.changes.length>0?!1:this._modelsAreIdentical(nt,ot),quitEarly:vt.hitTimeout,changes:vt.changes.map(yt=>{var wt;return[yt.originalRange.startLineNumber,yt.originalRange.endLineNumberExclusive,yt.modifiedRange.startLineNumber,yt.modifiedRange.endLineNumberExclusive,(wt=yt.innerChanges)===null||wt===void 0?void 0:wt.map(Lt=>[Lt.originalRange.startLineNumber,Lt.originalRange.startColumn,Lt.originalRange.endLineNumber,Lt.originalRange.endColumn,Lt.modifiedRange.startLineNumber,Lt.modifiedRange.startColumn,Lt.modifiedRange.endLineNumber,Lt.modifiedRange.endColumn])]})}}static _modelsAreIdentical(nt,ot){const rt=nt.getLineCount(),ut=ot.getLineCount();if(rt!==ut)return!1;for(let gt=1;gt<=rt;gt++){const pt=nt.getLineContent(gt),mt=ot.getLineContent(gt);if(pt!==mt)return!1}return!0}computeMoreMinimalEdits(nt,ot,rt){return __awaiter$1t(this,void 0,void 0,function*(){const ut=this._getModel(nt);if(!ut)return ot;const gt=[];let pt;ot=ot.slice(0).sort((mt,vt)=>{if(mt.range&&vt.range)return Range$2.compareRangesUsingStarts(mt.range,vt.range);const St=mt.range?0:1,yt=vt.range?0:1;return St-yt});for(let{range:mt,text:vt,eol:St}of ot){if(typeof St=="number"&&(pt=St),Range$2.isEmpty(mt)&&!vt)continue;const yt=ut.getValueInRange(mt);if(vt=vt.replace(/\r\n|\n|\r/g,ut.eol),yt===vt)continue;if(Math.max(vt.length,yt.length)>EditorSimpleWorker._diffLimit){gt.push({range:mt,text:vt});continue}const wt=stringDiff(yt,vt,rt),Lt=ut.offsetAt(Range$2.lift(mt).getStartPosition());for(const xt of wt){const It=ut.positionAt(Lt+xt.originalStart),kt=ut.positionAt(Lt+xt.originalStart+xt.originalLength),At={text:vt.substr(xt.modifiedStart,xt.modifiedLength),range:{startLineNumber:It.lineNumber,startColumn:It.column,endLineNumber:kt.lineNumber,endColumn:kt.column}};ut.getValueInRange(At.range)!==At.text&&gt.push(At)}}return typeof pt=="number"&&gt.push({eol:pt,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),gt})}computeLinks(nt){return __awaiter$1t(this,void 0,void 0,function*(){const ot=this._getModel(nt);return ot?computeLinks(ot):null})}computeDefaultDocumentColors(nt){return __awaiter$1t(this,void 0,void 0,function*(){const ot=this._getModel(nt);return ot?computeDefaultDocumentColors(ot):null})}textualSuggest(nt,ot,rt,ut){return __awaiter$1t(this,void 0,void 0,function*(){const gt=new StopWatch(!0),pt=new RegExp(rt,ut),mt=new Set;e:for(const vt of nt){const St=this._getModel(vt);if(St){for(const yt of St.words(pt))if(!(yt===ot||!isNaN(Number(yt)))&&(mt.add(yt),mt.size>EditorSimpleWorker._suggestionsLimit))break e}}return{words:Array.from(mt),duration:gt.elapsed()}})}computeWordRanges(nt,ot,rt,ut){return __awaiter$1t(this,void 0,void 0,function*(){const gt=this._getModel(nt);if(!gt)return Object.create(null);const pt=new RegExp(rt,ut),mt=Object.create(null);for(let vt=ot.startLineNumber;vt<ot.endLineNumber;vt++){const St=gt.getLineWords(vt,pt);for(const yt of St){if(!isNaN(Number(yt.word)))continue;let wt=mt[yt.word];wt||(wt=[],mt[yt.word]=wt),wt.push({startLineNumber:vt,startColumn:yt.startColumn,endLineNumber:vt,endColumn:yt.endColumn})}}return mt})}navigateValueSet(nt,ot,rt,ut,gt){return __awaiter$1t(this,void 0,void 0,function*(){const pt=this._getModel(nt);if(!pt)return null;const mt=new RegExp(ut,gt);ot.startColumn===ot.endColumn&&(ot={startLineNumber:ot.startLineNumber,startColumn:ot.startColumn,endLineNumber:ot.endLineNumber,endColumn:ot.endColumn+1});const vt=pt.getValueInRange(ot),St=pt.getWordAtPosition({lineNumber:ot.startLineNumber,column:ot.startColumn},mt);if(!St)return null;const yt=pt.getValueInRange(St);return BasicInplaceReplace.INSTANCE.navigateValueSet(ot,vt,St,yt,rt)})}loadForeignModule(nt,ot,rt){const pt={host:createProxyObject$1(rt,(mt,vt)=>this._host.fhr(mt,vt)),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(pt,ot),Promise.resolve(getAllMethodNames(this._foreignModule))):Promise.reject(new Error("Unexpected usage"))}fmr(nt,ot){if(!this._foreignModule||typeof this._foreignModule[nt]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+nt));try{return Promise.resolve(this._foreignModule[nt].apply(this._foreignModule,ot))}catch(rt){return Promise.reject(rt)}}}EditorSimpleWorker._diffLimit=1e5;EditorSimpleWorker._suggestionsLimit=1e4;typeof importScripts=="function"&&(globalThis.monaco=createMonacoBaseAPI());const ITextResourceConfigurationService=createDecorator("textResourceConfigurationService"),ITextResourcePropertiesService=createDecorator("textResourcePropertiesService"),ILogService=createDecorator("logService");var LogLevel;(function(ct){ct[ct.Off=0]="Off",ct[ct.Trace=1]="Trace",ct[ct.Debug=2]="Debug",ct[ct.Info=3]="Info",ct[ct.Warning=4]="Warning",ct[ct.Error=5]="Error"})(LogLevel||(LogLevel={}));const DEFAULT_LOG_LEVEL=LogLevel.Info;class AbstractLogger extends Disposable{constructor(){super(...arguments),this.level=DEFAULT_LOG_LEVEL,this._onDidChangeLogLevel=this._register(new Emitter$2),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(nt){this.level!==nt&&(this.level=nt,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(nt){return this.level!==LogLevel.Off&&this.level<=nt}}class ConsoleLogger extends AbstractLogger{constructor(nt=DEFAULT_LOG_LEVEL,ot=!0){super(),this.useColors=ot,this.setLevel(nt)}trace(nt,...ot){this.checkLogLevel(LogLevel.Trace)&&(this.useColors?console.log("%cTRACE","color: #888",nt,...ot):console.log(nt,...ot))}debug(nt,...ot){this.checkLogLevel(LogLevel.Debug)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",nt,...ot):console.log(nt,...ot))}info(nt,...ot){this.checkLogLevel(LogLevel.Info)&&(this.useColors?console.log("%c INFO","color: #33f",nt,...ot):console.log(nt,...ot))}error(nt,...ot){this.checkLogLevel(LogLevel.Error)&&(this.useColors?console.log("%c  ERR","color: #f33",nt,...ot):console.error(nt,...ot))}dispose(){}}class MultiplexLogger extends AbstractLogger{constructor(nt){super(),this.loggers=nt,nt.length&&this.setLevel(nt[0].getLevel())}setLevel(nt){for(const ot of this.loggers)ot.setLevel(nt);super.setLevel(nt)}trace(nt,...ot){for(const rt of this.loggers)rt.trace(nt,...ot)}debug(nt,...ot){for(const rt of this.loggers)rt.debug(nt,...ot)}info(nt,...ot){for(const rt of this.loggers)rt.info(nt,...ot)}error(nt,...ot){for(const rt of this.loggers)rt.error(nt,...ot)}dispose(){for(const nt of this.loggers)nt.dispose()}}function LogLevelToString(ct){switch(ct){case LogLevel.Trace:return"trace";case LogLevel.Debug:return"debug";case LogLevel.Info:return"info";case LogLevel.Warning:return"warn";case LogLevel.Error:return"error";case LogLevel.Off:return"off"}}new RawContextKey("logLevel",LogLevelToString(LogLevel.Info));const ILanguageFeaturesService=createDecorator("ILanguageFeaturesService");var __decorate$24=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1Z=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$1s=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const STOP_SYNC_MODEL_DELTA_TIME_MS=60*1e3,STOP_WORKER_DELTA_TIME_MS=5*60*1e3;function canSyncModel(ct,nt){const ot=ct.getModel(nt);return!(!ot||ot.isTooLargeForSyncing())}let EditorWorkerService=class extends Disposable{constructor(nt,ot,rt,ut,gt){super(),this._modelService=nt,this._workerManager=this._register(new WorkerManager(this._modelService,ut)),this._logService=rt,this._register(gt.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:(pt,mt)=>canSyncModel(this._modelService,pt.uri)?this._workerManager.withWorker().then(vt=>vt.computeLinks(pt.uri)).then(vt=>vt&&{links:vt}):Promise.resolve({links:[]})})),this._register(gt.completionProvider.register("*",new WordBasedCompletionItemProvider(this._workerManager,ot,this._modelService,ut)))}dispose(){super.dispose()}canComputeUnicodeHighlights(nt){return canSyncModel(this._modelService,nt)}computedUnicodeHighlights(nt,ot,rt){return this._workerManager.withWorker().then(ut=>ut.computedUnicodeHighlights(nt,ot,rt))}computeDiff(nt,ot,rt,ut){return __awaiter$1s(this,void 0,void 0,function*(){const gt=yield this._workerManager.withWorker().then(mt=>mt.computeDiff(nt,ot,rt,ut));return gt?{identical:gt.identical,quitEarly:gt.quitEarly,changes:gt.changes.map(mt=>{var vt;return new LineRangeMapping(new LineRange$1(mt[0],mt[1]),new LineRange$1(mt[2],mt[3]),(vt=mt[4])===null||vt===void 0?void 0:vt.map(St=>new RangeMapping(new Range$2(St[0],St[1],St[2],St[3]),new Range$2(St[4],St[5],St[6],St[7]))))})}:null})}computeMoreMinimalEdits(nt,ot,rt=!1){if(isNonEmptyArray(ot)){if(!canSyncModel(this._modelService,nt))return Promise.resolve(ot);const ut=StopWatch.create(!0),gt=this._workerManager.withWorker().then(pt=>pt.computeMoreMinimalEdits(nt,ot,rt));return gt.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",nt.toString(!0),ut.elapsed())),Promise.race([gt,timeout(1e3).then(()=>ot)])}else return Promise.resolve(void 0)}canNavigateValueSet(nt){return canSyncModel(this._modelService,nt)}navigateValueSet(nt,ot,rt){return this._workerManager.withWorker().then(ut=>ut.navigateValueSet(nt,ot,rt))}canComputeWordRanges(nt){return canSyncModel(this._modelService,nt)}computeWordRanges(nt,ot){return this._workerManager.withWorker().then(rt=>rt.computeWordRanges(nt,ot))}};EditorWorkerService=__decorate$24([__param$1Z(0,IModelService),__param$1Z(1,ITextResourceConfigurationService),__param$1Z(2,ILogService),__param$1Z(3,ILanguageConfigurationService),__param$1Z(4,ILanguageFeaturesService)],EditorWorkerService);class WordBasedCompletionItemProvider{constructor(nt,ot,rt,ut){this.languageConfigurationService=ut,this._debugDisplayName="wordbasedCompletions",this._workerManager=nt,this._configurationService=ot,this._modelService=rt}provideCompletionItems(nt,ot){return __awaiter$1s(this,void 0,void 0,function*(){const rt=this._configurationService.getValue(nt.uri,ot,"editor");if(!rt.wordBasedSuggestions)return;const ut=[];if(rt.wordBasedSuggestionsMode==="currentDocument")canSyncModel(this._modelService,nt.uri)&&ut.push(nt.uri);else for(const wt of this._modelService.getModels())canSyncModel(this._modelService,wt.uri)&&(wt===nt?ut.unshift(wt.uri):(rt.wordBasedSuggestionsMode==="allDocuments"||wt.getLanguageId()===nt.getLanguageId())&&ut.push(wt.uri));if(ut.length===0)return;const gt=this.languageConfigurationService.getLanguageConfiguration(nt.getLanguageId()).getWordDefinition(),pt=nt.getWordAtPosition(ot),mt=pt?new Range$2(ot.lineNumber,pt.startColumn,ot.lineNumber,pt.endColumn):Range$2.fromPositions(ot),vt=mt.setEndPosition(ot.lineNumber,ot.column),yt=yield(yield this._workerManager.withWorker()).textualSuggest(ut,pt==null?void 0:pt.word,gt);if(yt)return{duration:yt.duration,suggestions:yt.words.map(wt=>({kind:18,label:wt,insertText:wt,range:{insert:vt,replace:mt}}))}})}}class WorkerManager extends Disposable{constructor(nt,ot){super(),this.languageConfigurationService=ot,this._modelService=nt,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new IntervalTimer).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(STOP_WORKER_DELTA_TIME_MS/2)),this._register(this._modelService.onModelRemoved(ut=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>STOP_WORKER_DELTA_TIME_MS&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new EditorWorkerClient(this._modelService,!1,"editorWorkerService",this.languageConfigurationService)),Promise.resolve(this._editorWorkerClient)}}class EditorModelManager extends Disposable{constructor(nt,ot,rt){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=nt,this._modelService=ot,!rt){const ut=new IntervalTimer;ut.cancelAndSet(()=>this._checkStopModelSync(),Math.round(STOP_SYNC_MODEL_DELTA_TIME_MS/2)),this._register(ut)}}dispose(){for(const nt in this._syncedModels)dispose(this._syncedModels[nt]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(nt,ot){for(const rt of nt){const ut=rt.toString();this._syncedModels[ut]||this._beginModelSync(rt,ot),this._syncedModels[ut]&&(this._syncedModelsLastUsedTime[ut]=new Date().getTime())}}_checkStopModelSync(){const nt=new Date().getTime(),ot=[];for(const rt in this._syncedModelsLastUsedTime)nt-this._syncedModelsLastUsedTime[rt]>STOP_SYNC_MODEL_DELTA_TIME_MS&&ot.push(rt);for(const rt of ot)this._stopModelSync(rt)}_beginModelSync(nt,ot){const rt=this._modelService.getModel(nt);if(!rt||!ot&&rt.isTooLargeForSyncing())return;const ut=nt.toString();this._proxy.acceptNewModel({url:rt.uri.toString(),lines:rt.getLinesContent(),EOL:rt.getEOL(),versionId:rt.getVersionId()});const gt=new DisposableStore;gt.add(rt.onDidChangeContent(pt=>{this._proxy.acceptModelChanged(ut.toString(),pt)})),gt.add(rt.onWillDispose(()=>{this._stopModelSync(ut)})),gt.add(toDisposable(()=>{this._proxy.acceptRemovedModel(ut)})),this._syncedModels[ut]=gt}_stopModelSync(nt){const ot=this._syncedModels[nt];delete this._syncedModels[nt],delete this._syncedModelsLastUsedTime[nt],dispose(ot)}}class SynchronousWorkerClient{constructor(nt){this._instance=nt,this._proxyObj=Promise.resolve(this._instance)}dispose(){this._instance.dispose()}getProxyObject(){return this._proxyObj}}class EditorWorkerHost{constructor(nt){this._workerClient=nt}fhr(nt,ot){return this._workerClient.fhr(nt,ot)}}class EditorWorkerClient extends Disposable{constructor(nt,ot,rt,ut){super(),this.languageConfigurationService=ut,this._disposed=!1,this._modelService=nt,this._keepIdleModels=ot,this._workerFactory=new DefaultWorkerFactory(rt),this._worker=null,this._modelManager=null}fhr(nt,ot){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(new SimpleWorkerClient(this._workerFactory,"vs/editor/common/services/editorSimpleWorker",new EditorWorkerHost(this)))}catch(nt){logOnceWebWorkerWarning(nt),this._worker=new SynchronousWorkerClient(new EditorSimpleWorker(new EditorWorkerHost(this),null))}return this._worker}_getProxy(){return this._getOrCreateWorker().getProxyObject().then(void 0,nt=>(logOnceWebWorkerWarning(nt),this._worker=new SynchronousWorkerClient(new EditorSimpleWorker(new EditorWorkerHost(this),null)),this._getOrCreateWorker().getProxyObject()))}_getOrCreateModelManager(nt){return this._modelManager||(this._modelManager=this._register(new EditorModelManager(nt,this._modelService,this._keepIdleModels))),this._modelManager}_withSyncedResources(nt,ot=!1){return __awaiter$1s(this,void 0,void 0,function*(){return this._disposed?Promise.reject(canceled()):this._getProxy().then(rt=>(this._getOrCreateModelManager(rt).ensureSyncedResources(nt,ot),rt))})}computedUnicodeHighlights(nt,ot,rt){return this._withSyncedResources([nt]).then(ut=>ut.computeUnicodeHighlights(nt.toString(),ot,rt))}computeDiff(nt,ot,rt,ut){return this._withSyncedResources([nt,ot],!0).then(gt=>gt.computeDiff(nt.toString(),ot.toString(),rt,ut))}computeMoreMinimalEdits(nt,ot,rt){return this._withSyncedResources([nt]).then(ut=>ut.computeMoreMinimalEdits(nt.toString(),ot,rt))}computeLinks(nt){return this._withSyncedResources([nt]).then(ot=>ot.computeLinks(nt.toString()))}computeDefaultDocumentColors(nt){return this._withSyncedResources([nt]).then(ot=>ot.computeDefaultDocumentColors(nt.toString()))}textualSuggest(nt,ot,rt){return __awaiter$1s(this,void 0,void 0,function*(){const ut=yield this._withSyncedResources(nt),gt=rt.source,pt=regExpFlags(rt);return ut.textualSuggest(nt.map(mt=>mt.toString()),ot,gt,pt)})}computeWordRanges(nt,ot){return this._withSyncedResources([nt]).then(rt=>{const ut=this._modelService.getModel(nt);if(!ut)return Promise.resolve(null);const gt=this.languageConfigurationService.getLanguageConfiguration(ut.getLanguageId()).getWordDefinition(),pt=gt.source,mt=regExpFlags(gt);return rt.computeWordRanges(nt.toString(),ot,pt,mt)})}navigateValueSet(nt,ot,rt){return this._withSyncedResources([nt]).then(ut=>{const gt=this._modelService.getModel(nt);if(!gt)return null;const pt=this.languageConfigurationService.getLanguageConfiguration(gt.getLanguageId()).getWordDefinition(),mt=pt.source,vt=regExpFlags(pt);return ut.navigateValueSet(nt.toString(),ot,rt,mt,vt)})}dispose(){super.dispose(),this._disposed=!0}}function createWebWorker$1(ct,nt,ot){return new MonacoWebWorkerImpl(ct,nt,ot)}class MonacoWebWorkerImpl extends EditorWorkerClient{constructor(nt,ot,rt){super(nt,rt.keepIdleModels||!1,rt.label,ot),this._foreignModuleId=rt.moduleId,this._foreignModuleCreateData=rt.createData||null,this._foreignModuleHost=rt.host||null,this._foreignProxy=null}fhr(nt,ot){if(!this._foreignModuleHost||typeof this._foreignModuleHost[nt]!="function")return Promise.reject(new Error("Missing method "+nt+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[nt].apply(this._foreignModuleHost,ot))}catch(rt){return Promise.reject(rt)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then(nt=>{const ot=this._foreignModuleHost?getAllMethodNames(this._foreignModuleHost):[];return nt.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,ot).then(rt=>{this._foreignModuleCreateData=null;const ut=(mt,vt)=>nt.fmr(mt,vt),gt=(mt,vt)=>function(){const St=Array.prototype.slice.call(arguments,0);return vt(mt,St)},pt={};for(const mt of rt)pt[mt]=gt(mt,ut);return pt})})),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(nt){return this._withSyncedResources(nt).then(ot=>this.getProxy())}}class TokenMetadata{static getLanguageId(nt){return(nt&255)>>>0}static getTokenType(nt){return(nt&768)>>>8}static containsBalancedBrackets(nt){return(nt&1024)!==0}static getFontStyle(nt){return(nt&30720)>>>11}static getForeground(nt){return(nt&16744448)>>>15}static getBackground(nt){return(nt&4278190080)>>>24}static getClassNameFromMetadata(nt){let rt="mtk"+this.getForeground(nt);const ut=this.getFontStyle(nt);return ut&1&&(rt+=" mtki"),ut&2&&(rt+=" mtkb"),ut&4&&(rt+=" mtku"),ut&8&&(rt+=" mtks"),rt}static getInlineStyleFromMetadata(nt,ot){const rt=this.getForeground(nt),ut=this.getFontStyle(nt);let gt=`color: ${ot[rt]};`;ut&1&&(gt+="font-style: italic;"),ut&2&&(gt+="font-weight: bold;");let pt="";return ut&4&&(pt+=" underline"),ut&8&&(pt+=" line-through"),pt&&(gt+=`text-decoration:${pt};`),gt}static getPresentationFromMetadata(nt){const ot=this.getForeground(nt),rt=this.getFontStyle(nt);return{foreground:ot,italic:!!(rt&1),bold:!!(rt&2),underline:!!(rt&4),strikethrough:!!(rt&8)}}}class LineTokens{static createEmpty(nt,ot){const rt=LineTokens.defaultTokenMetadata,ut=new Uint32Array(2);return ut[0]=nt.length,ut[1]=rt,new LineTokens(ut,nt,ot)}constructor(nt,ot,rt){this._lineTokensBrand=void 0,this._tokens=nt,this._tokensCount=this._tokens.length>>>1,this._text=ot,this._languageIdCodec=rt}equals(nt){return nt instanceof LineTokens?this.slicedEquals(nt,0,this._tokensCount):!1}slicedEquals(nt,ot,rt){if(this._text!==nt._text||this._tokensCount!==nt._tokensCount)return!1;const ut=ot<<1,gt=ut+(rt<<1);for(let pt=ut;pt<gt;pt++)if(this._tokens[pt]!==nt._tokens[pt])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(nt){return nt>0?this._tokens[nt-1<<1]:0}getMetadata(nt){return this._tokens[(nt<<1)+1]}getLanguageId(nt){const ot=this._tokens[(nt<<1)+1],rt=TokenMetadata.getLanguageId(ot);return this._languageIdCodec.decodeLanguageId(rt)}getStandardTokenType(nt){const ot=this._tokens[(nt<<1)+1];return TokenMetadata.getTokenType(ot)}getForeground(nt){const ot=this._tokens[(nt<<1)+1];return TokenMetadata.getForeground(ot)}getClassName(nt){const ot=this._tokens[(nt<<1)+1];return TokenMetadata.getClassNameFromMetadata(ot)}getInlineStyle(nt,ot){const rt=this._tokens[(nt<<1)+1];return TokenMetadata.getInlineStyleFromMetadata(rt,ot)}getPresentation(nt){const ot=this._tokens[(nt<<1)+1];return TokenMetadata.getPresentationFromMetadata(ot)}getEndOffset(nt){return this._tokens[nt<<1]}findTokenIndexAtOffset(nt){return LineTokens.findIndexInTokensArray(this._tokens,nt)}inflate(){return this}sliceAndInflate(nt,ot,rt){return new SliceLineTokens(this,nt,ot,rt)}static convertToEndOffset(nt,ot){const ut=(nt.length>>>1)-1;for(let gt=0;gt<ut;gt++)nt[gt<<1]=nt[gt+1<<1];nt[ut<<1]=ot}static findIndexInTokensArray(nt,ot){if(nt.length<=2)return 0;let rt=0,ut=(nt.length>>>1)-1;for(;rt<ut;){const gt=rt+Math.floor((ut-rt)/2),pt=nt[gt<<1];if(pt===ot)return gt+1;pt<ot?rt=gt+1:pt>ot&&(ut=gt)}return rt}withInserted(nt){if(nt.length===0)return this;let ot=0,rt=0,ut="";const gt=new Array;let pt=0;for(;;){const mt=ot<this._tokensCount?this._tokens[ot<<1]:-1,vt=rt<nt.length?nt[rt]:null;if(mt!==-1&&(vt===null||mt<=vt.offset)){ut+=this._text.substring(pt,mt);const St=this._tokens[(ot<<1)+1];gt.push(ut.length,St),ot++,pt=mt}else if(vt){if(vt.offset>pt){ut+=this._text.substring(pt,vt.offset);const St=this._tokens[(ot<<1)+1];gt.push(ut.length,St),pt=vt.offset}ut+=vt.text,gt.push(ut.length,vt.tokenMetadata),rt++}else break}return new LineTokens(new Uint32Array(gt),ut,this._languageIdCodec)}}LineTokens.defaultTokenMetadata=(32768|2<<24)>>>0;class SliceLineTokens{constructor(nt,ot,rt,ut){this._source=nt,this._startOffset=ot,this._endOffset=rt,this._deltaOffset=ut,this._firstTokenIndex=nt.findTokenIndexAtOffset(ot),this._tokensCount=0;for(let gt=this._firstTokenIndex,pt=nt.getCount();gt<pt&&!(nt.getStartOffset(gt)>=rt);gt++)this._tokensCount++}getMetadata(nt){return this._source.getMetadata(this._firstTokenIndex+nt)}getLanguageId(nt){return this._source.getLanguageId(this._firstTokenIndex+nt)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(nt){return nt instanceof SliceLineTokens?this._startOffset===nt._startOffset&&this._endOffset===nt._endOffset&&this._deltaOffset===nt._deltaOffset&&this._source.slicedEquals(nt._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getForeground(nt){return this._source.getForeground(this._firstTokenIndex+nt)}getEndOffset(nt){const ot=this._source.getEndOffset(this._firstTokenIndex+nt);return Math.min(this._endOffset,ot)-this._startOffset+this._deltaOffset}getClassName(nt){return this._source.getClassName(this._firstTokenIndex+nt)}getInlineStyle(nt,ot){return this._source.getInlineStyle(this._firstTokenIndex+nt,ot)}getPresentation(nt){return this._source.getPresentation(this._firstTokenIndex+nt)}findTokenIndexAtOffset(nt){return this._source.findTokenIndexAtOffset(nt+this._startOffset-this._deltaOffset)-this._firstTokenIndex}}class LineDecoration{constructor(nt,ot,rt,ut){this.startColumn=nt,this.endColumn=ot,this.className=rt,this.type=ut,this._lineDecorationBrand=void 0}static _equals(nt,ot){return nt.startColumn===ot.startColumn&&nt.endColumn===ot.endColumn&&nt.className===ot.className&&nt.type===ot.type}static equalsArr(nt,ot){const rt=nt.length,ut=ot.length;if(rt!==ut)return!1;for(let gt=0;gt<rt;gt++)if(!LineDecoration._equals(nt[gt],ot[gt]))return!1;return!0}static extractWrapped(nt,ot,rt){if(nt.length===0)return nt;const ut=ot+1,gt=rt+1,pt=rt-ot,mt=[];let vt=0;for(const St of nt)St.endColumn<=ut||St.startColumn>=gt||(mt[vt++]=new LineDecoration(Math.max(1,St.startColumn-ut+1),Math.min(pt+1,St.endColumn-ut+1),St.className,St.type));return mt}static filter(nt,ot,rt,ut){if(nt.length===0)return[];const gt=[];let pt=0;for(let mt=0,vt=nt.length;mt<vt;mt++){const St=nt[mt],yt=St.range;if(yt.endLineNumber<ot||yt.startLineNumber>ot||yt.isEmpty()&&(St.type===0||St.type===3))continue;const wt=yt.startLineNumber===ot?yt.startColumn:rt,Lt=yt.endLineNumber===ot?yt.endColumn:ut;gt[pt++]=new LineDecoration(wt,Lt,St.inlineClassName,St.type)}return gt}static _typeCompare(nt,ot){const rt=[2,0,1,3];return rt[nt]-rt[ot]}static compare(nt,ot){if(nt.startColumn!==ot.startColumn)return nt.startColumn-ot.startColumn;if(nt.endColumn!==ot.endColumn)return nt.endColumn-ot.endColumn;const rt=LineDecoration._typeCompare(nt.type,ot.type);return rt!==0?rt:nt.className!==ot.className?nt.className<ot.className?-1:1:0}}class DecorationSegment{constructor(nt,ot,rt,ut){this.startOffset=nt,this.endOffset=ot,this.className=rt,this.metadata=ut}}class Stack{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(nt){let ot=0;for(let rt=0,ut=nt.length;rt<ut;rt++)ot|=nt[rt];return ot}consumeLowerThan(nt,ot,rt){for(;this.count>0&&this.stopOffsets[0]<nt;){let ut=0;for(;ut+1<this.count&&this.stopOffsets[ut]===this.stopOffsets[ut+1];)ut++;rt.push(new DecorationSegment(ot,this.stopOffsets[ut],this.classNames.join(" "),Stack._metadata(this.metadata))),ot=this.stopOffsets[ut]+1,this.stopOffsets.splice(0,ut+1),this.classNames.splice(0,ut+1),this.metadata.splice(0,ut+1),this.count-=ut+1}return this.count>0&&ot<nt&&(rt.push(new DecorationSegment(ot,nt-1,this.classNames.join(" "),Stack._metadata(this.metadata))),ot=nt),ot}insert(nt,ot,rt){if(this.count===0||this.stopOffsets[this.count-1]<=nt)this.stopOffsets.push(nt),this.classNames.push(ot),this.metadata.push(rt);else for(let ut=0;ut<this.count;ut++)if(this.stopOffsets[ut]>=nt){this.stopOffsets.splice(ut,0,nt),this.classNames.splice(ut,0,ot),this.metadata.splice(ut,0,rt);break}this.count++}}class LineDecorationsNormalizer{static normalize(nt,ot){if(ot.length===0)return[];const rt=[],ut=new Stack;let gt=0;for(let pt=0,mt=ot.length;pt<mt;pt++){const vt=ot[pt];let St=vt.startColumn,yt=vt.endColumn;const wt=vt.className,Lt=vt.type===1?2:vt.type===2?4:0;if(St>1){const kt=nt.charCodeAt(St-2);isHighSurrogate(kt)&&St--}if(yt>1){const kt=nt.charCodeAt(yt-2);isHighSurrogate(kt)&&yt--}const xt=St-1,It=yt-2;gt=ut.consumeLowerThan(xt,gt,rt),ut.count===0&&(gt=xt),ut.insert(It,wt,Lt)}return ut.consumeLowerThan(1073741824,gt,rt),rt}}class LinePart{constructor(nt,ot,rt,ut){this.endIndex=nt,this.type=ot,this.metadata=rt,this.containsRTL=ut,this._linePartBrand=void 0}isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}}class LineRange{constructor(nt,ot){this.startOffset=nt,this.endOffset=ot}equals(nt){return this.startOffset===nt.startOffset&&this.endOffset===nt.endOffset}}class RenderLineInput{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt,xt,It,kt,At,Tt,Rt,Nt){this.useMonospaceOptimizations=nt,this.canUseHalfwidthRightwardsArrow=ot,this.lineContent=rt,this.continuesWithWrappedLine=ut,this.isBasicASCII=gt,this.containsRTL=pt,this.fauxIndentLength=mt,this.lineTokens=vt,this.lineDecorations=St.sort(LineDecoration.compare),this.tabSize=yt,this.startVisibleColumn=wt,this.spaceWidth=Lt,this.stopRenderingLineAfter=kt,this.renderWhitespace=At==="all"?4:At==="boundary"?1:At==="selection"?2:At==="trailing"?3:0,this.renderControlCharacters=Tt,this.fontLigatures=Rt,this.selectionsOnLine=Nt&&Nt.sort((Kt,Bt)=>Kt.startOffset<Bt.startOffset?-1:1);const Pt=Math.abs(It-Lt),Ft=Math.abs(xt-Lt);Pt<Ft?(this.renderSpaceWidth=It,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=xt,this.renderSpaceCharCode=183)}sameSelection(nt){if(this.selectionsOnLine===null)return nt===null;if(nt===null||nt.length!==this.selectionsOnLine.length)return!1;for(let ot=0;ot<this.selectionsOnLine.length;ot++)if(!this.selectionsOnLine[ot].equals(nt[ot]))return!1;return!0}equals(nt){return this.useMonospaceOptimizations===nt.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===nt.canUseHalfwidthRightwardsArrow&&this.lineContent===nt.lineContent&&this.continuesWithWrappedLine===nt.continuesWithWrappedLine&&this.isBasicASCII===nt.isBasicASCII&&this.containsRTL===nt.containsRTL&&this.fauxIndentLength===nt.fauxIndentLength&&this.tabSize===nt.tabSize&&this.startVisibleColumn===nt.startVisibleColumn&&this.spaceWidth===nt.spaceWidth&&this.renderSpaceWidth===nt.renderSpaceWidth&&this.renderSpaceCharCode===nt.renderSpaceCharCode&&this.stopRenderingLineAfter===nt.stopRenderingLineAfter&&this.renderWhitespace===nt.renderWhitespace&&this.renderControlCharacters===nt.renderControlCharacters&&this.fontLigatures===nt.fontLigatures&&LineDecoration.equalsArr(this.lineDecorations,nt.lineDecorations)&&this.lineTokens.equals(nt.lineTokens)&&this.sameSelection(nt.selectionsOnLine)}}class DomPosition{constructor(nt,ot){this.partIndex=nt,this.charIndex=ot}}class CharacterMapping{static getPartIndex(nt){return(nt&4294901760)>>>16}static getCharIndex(nt){return(nt&65535)>>>0}constructor(nt,ot){this.length=nt,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(nt,ot,rt,ut){const gt=(ot<<16|rt<<0)>>>0;this._data[nt-1]=gt,this._horizontalOffset[nt-1]=ut}getHorizontalOffset(nt){return this._horizontalOffset.length===0?0:this._horizontalOffset[nt-1]}charOffsetToPartData(nt){return this.length===0?0:nt<0?this._data[0]:nt>=this.length?this._data[this.length-1]:this._data[nt]}getDomPosition(nt){const ot=this.charOffsetToPartData(nt-1),rt=CharacterMapping.getPartIndex(ot),ut=CharacterMapping.getCharIndex(ot);return new DomPosition(rt,ut)}getColumn(nt,ot){return this.partDataToCharOffset(nt.partIndex,ot,nt.charIndex)+1}partDataToCharOffset(nt,ot,rt){if(this.length===0)return 0;const ut=(nt<<16|rt<<0)>>>0;let gt=0,pt=this.length-1;for(;gt+1<pt;){const kt=gt+pt>>>1,At=this._data[kt];if(At===ut)return kt;At>ut?pt=kt:gt=kt}if(gt===pt)return gt;const mt=this._data[gt],vt=this._data[pt];if(mt===ut)return gt;if(vt===ut)return pt;const St=CharacterMapping.getPartIndex(mt),yt=CharacterMapping.getCharIndex(mt),wt=CharacterMapping.getPartIndex(vt);let Lt;St!==wt?Lt=ot:Lt=CharacterMapping.getCharIndex(vt);const xt=rt-yt,It=Lt-rt;return xt<=It?gt:pt}}class RenderLineOutput{constructor(nt,ot,rt){this._renderLineOutputBrand=void 0,this.characterMapping=nt,this.containsRTL=ot,this.containsForeignElements=rt}}function renderViewLine(ct,nt){if(ct.lineContent.length===0){if(ct.lineDecorations.length>0){nt.appendString("<span>");let ot=0,rt=0,ut=0;for(const pt of ct.lineDecorations)(pt.type===1||pt.type===2)&&(nt.appendString('<span class="'),nt.appendString(pt.className),nt.appendString('"></span>'),pt.type===1&&(ut|=1,ot++),pt.type===2&&(ut|=2,rt++));nt.appendString("</span>");const gt=new CharacterMapping(1,ot+rt);return gt.setColumnInfo(1,ot,0,0),new RenderLineOutput(gt,!1,ut)}return nt.appendString("<span><span></span></span>"),new RenderLineOutput(new CharacterMapping(0,0),!1,0)}return _renderLine(resolveRenderLineInput(ct),nt)}class RenderLineOutput2{constructor(nt,ot,rt,ut){this.characterMapping=nt,this.html=ot,this.containsRTL=rt,this.containsForeignElements=ut}}function renderViewLine2(ct){const nt=new StringBuilder(1e4),ot=renderViewLine(ct,nt);return new RenderLineOutput2(ot.characterMapping,nt.build(),ot.containsRTL,ot.containsForeignElements)}class ResolvedRenderLineInput{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt,xt,It,kt,At){this.fontIsMonospace=nt,this.canUseHalfwidthRightwardsArrow=ot,this.lineContent=rt,this.len=ut,this.isOverflowing=gt,this.overflowingCharCount=pt,this.parts=mt,this.containsForeignElements=vt,this.fauxIndentLength=St,this.tabSize=yt,this.startVisibleColumn=wt,this.containsRTL=Lt,this.spaceWidth=xt,this.renderSpaceCharCode=It,this.renderWhitespace=kt,this.renderControlCharacters=At}}function resolveRenderLineInput(ct){const nt=ct.lineContent;let ot,rt,ut;ct.stopRenderingLineAfter!==-1&&ct.stopRenderingLineAfter<nt.length?(ot=!0,rt=nt.length-ct.stopRenderingLineAfter,ut=ct.stopRenderingLineAfter):(ot=!1,rt=0,ut=nt.length);let gt=transformAndRemoveOverflowing(nt,ct.containsRTL,ct.lineTokens,ct.fauxIndentLength,ut);ct.renderControlCharacters&&!ct.isBasicASCII&&(gt=extractControlCharacters(nt,gt)),(ct.renderWhitespace===4||ct.renderWhitespace===1||ct.renderWhitespace===2&&ct.selectionsOnLine||ct.renderWhitespace===3&&!ct.continuesWithWrappedLine)&&(gt=_applyRenderWhitespace(ct,nt,ut,gt));let pt=0;if(ct.lineDecorations.length>0){for(let mt=0,vt=ct.lineDecorations.length;mt<vt;mt++){const St=ct.lineDecorations[mt];St.type===3||St.type===1?pt|=1:St.type===2&&(pt|=2)}gt=_applyInlineDecorations(nt,ut,gt,ct.lineDecorations)}return ct.containsRTL||(gt=splitLargeTokens(nt,gt,!ct.isBasicASCII||ct.fontLigatures)),new ResolvedRenderLineInput(ct.useMonospaceOptimizations,ct.canUseHalfwidthRightwardsArrow,nt,ut,ot,rt,gt,pt,ct.fauxIndentLength,ct.tabSize,ct.startVisibleColumn,ct.containsRTL,ct.spaceWidth,ct.renderSpaceCharCode,ct.renderWhitespace,ct.renderControlCharacters)}function transformAndRemoveOverflowing(ct,nt,ot,rt,ut){const gt=[];let pt=0;rt>0&&(gt[pt++]=new LinePart(rt,"",0,!1));let mt=rt;for(let vt=0,St=ot.getCount();vt<St;vt++){const yt=ot.getEndOffset(vt);if(yt<=rt)continue;const wt=ot.getClassName(vt);if(yt>=ut){const xt=nt?containsRTL(ct.substring(mt,ut)):!1;gt[pt++]=new LinePart(ut,wt,0,xt);break}const Lt=nt?containsRTL(ct.substring(mt,yt)):!1;gt[pt++]=new LinePart(yt,wt,0,Lt),mt=yt}return gt}function splitLargeTokens(ct,nt,ot){let rt=0;const ut=[];let gt=0;if(ot)for(let pt=0,mt=nt.length;pt<mt;pt++){const vt=nt[pt],St=vt.endIndex;if(rt+50<St){const yt=vt.type,wt=vt.metadata,Lt=vt.containsRTL;let xt=-1,It=rt;for(let kt=rt;kt<St;kt++)ct.charCodeAt(kt)===32&&(xt=kt),xt!==-1&&kt-It>=50&&(ut[gt++]=new LinePart(xt+1,yt,wt,Lt),It=xt+1,xt=-1);It!==St&&(ut[gt++]=new LinePart(St,yt,wt,Lt))}else ut[gt++]=vt;rt=St}else for(let pt=0,mt=nt.length;pt<mt;pt++){const vt=nt[pt],St=vt.endIndex,yt=St-rt;if(yt>50){const wt=vt.type,Lt=vt.metadata,xt=vt.containsRTL,It=Math.ceil(yt/50);for(let kt=1;kt<It;kt++){const At=rt+kt*50;ut[gt++]=new LinePart(At,wt,Lt,xt)}ut[gt++]=new LinePart(St,wt,Lt,xt)}else ut[gt++]=vt;rt=St}return ut}function isControlCharacter(ct){return ct<32?ct!==9:ct===127||ct>=8234&&ct<=8238||ct>=8294&&ct<=8297||ct>=8206&&ct<=8207||ct===1564}function extractControlCharacters(ct,nt){const ot=[];let rt=new LinePart(0,"",0,!1),ut=0;for(const gt of nt){const pt=gt.endIndex;for(;ut<pt;ut++){const mt=ct.charCodeAt(ut);isControlCharacter(mt)&&(ut>rt.endIndex&&(rt=new LinePart(ut,gt.type,gt.metadata,gt.containsRTL),ot.push(rt)),rt=new LinePart(ut+1,"mtkcontrol",gt.metadata,!1),ot.push(rt))}ut>rt.endIndex&&(rt=new LinePart(pt,gt.type,gt.metadata,gt.containsRTL),ot.push(rt))}return ot}function _applyRenderWhitespace(ct,nt,ot,rt){const ut=ct.continuesWithWrappedLine,gt=ct.fauxIndentLength,pt=ct.tabSize,mt=ct.startVisibleColumn,vt=ct.useMonospaceOptimizations,St=ct.selectionsOnLine,yt=ct.renderWhitespace===1,wt=ct.renderWhitespace===3,Lt=ct.renderSpaceWidth!==ct.spaceWidth,xt=[];let It=0,kt=0,At=rt[kt].type,Tt=rt[kt].containsRTL,Rt=rt[kt].endIndex;const Nt=rt.length;let Pt=!1,Ft=firstNonWhitespaceIndex(nt),Kt;Ft===-1?(Pt=!0,Ft=ot,Kt=ot):Kt=lastNonWhitespaceIndex(nt);let Bt=!1,Ut=0,qt=St&&St[Ut],Yt=mt%pt;for(let Xt=gt;Xt<ot;Xt++){const _i=nt.charCodeAt(Xt);qt&&Xt>=qt.endOffset&&(Ut++,qt=St&&St[Ut]);let nn;if(Xt<Ft||Xt>Kt)nn=!0;else if(_i===9)nn=!0;else if(_i===32)if(yt)if(Bt)nn=!0;else{const rn=Xt+1<ot?nt.charCodeAt(Xt+1):0;nn=rn===32||rn===9}else nn=!0;else nn=!1;if(nn&&St&&(nn=!!qt&&qt.startOffset<=Xt&&qt.endOffset>Xt),nn&&wt&&(nn=Pt||Xt>Kt),nn&&Tt&&Xt>=Ft&&Xt<=Kt&&(nn=!1),Bt){if(!nn||!vt&&Yt>=pt){if(Lt){const rn=It>0?xt[It-1].endIndex:gt;for(let dn=rn+1;dn<=Xt;dn++)xt[It++]=new LinePart(dn,"mtkw",1,!1)}else xt[It++]=new LinePart(Xt,"mtkw",1,!1);Yt=Yt%pt}}else(Xt===Rt||nn&&Xt>gt)&&(xt[It++]=new LinePart(Xt,At,0,Tt),Yt=Yt%pt);for(_i===9?Yt=pt:isFullWidthCharacter(_i)?Yt+=2:Yt++,Bt=nn;Xt===Rt&&(kt++,kt<Nt);)At=rt[kt].type,Tt=rt[kt].containsRTL,Rt=rt[kt].endIndex}let Zt=!1;if(Bt)if(ut&&yt){const Xt=ot>0?nt.charCodeAt(ot-1):0,_i=ot>1?nt.charCodeAt(ot-2):0;Xt===32&&_i!==32&&_i!==9||(Zt=!0)}else Zt=!0;if(Zt)if(Lt){const Xt=It>0?xt[It-1].endIndex:gt;for(let _i=Xt+1;_i<=ot;_i++)xt[It++]=new LinePart(_i,"mtkw",1,!1)}else xt[It++]=new LinePart(ot,"mtkw",1,!1);else xt[It++]=new LinePart(ot,At,0,Tt);return xt}function _applyInlineDecorations(ct,nt,ot,rt){rt.sort(LineDecoration.compare);const ut=LineDecorationsNormalizer.normalize(ct,rt),gt=ut.length;let pt=0;const mt=[];let vt=0,St=0;for(let wt=0,Lt=ot.length;wt<Lt;wt++){const xt=ot[wt],It=xt.endIndex,kt=xt.type,At=xt.metadata,Tt=xt.containsRTL;for(;pt<gt&&ut[pt].startOffset<It;){const Rt=ut[pt];if(Rt.startOffset>St&&(St=Rt.startOffset,mt[vt++]=new LinePart(St,kt,At,Tt)),Rt.endOffset+1<=It)St=Rt.endOffset+1,mt[vt++]=new LinePart(St,kt+" "+Rt.className,At|Rt.metadata,Tt),pt++;else{St=It,mt[vt++]=new LinePart(St,kt+" "+Rt.className,At|Rt.metadata,Tt);break}}It>St&&(St=It,mt[vt++]=new LinePart(St,kt,At,Tt))}const yt=ot[ot.length-1].endIndex;if(pt<gt&&ut[pt].startOffset===yt)for(;pt<gt&&ut[pt].startOffset===yt;){const wt=ut[pt];mt[vt++]=new LinePart(St,wt.className,wt.metadata,!1),pt++}return mt}function _renderLine(ct,nt){const ot=ct.fontIsMonospace,rt=ct.canUseHalfwidthRightwardsArrow,ut=ct.containsForeignElements,gt=ct.lineContent,pt=ct.len,mt=ct.isOverflowing,vt=ct.overflowingCharCount,St=ct.parts,yt=ct.fauxIndentLength,wt=ct.tabSize,Lt=ct.startVisibleColumn,xt=ct.containsRTL,It=ct.spaceWidth,kt=ct.renderSpaceCharCode,At=ct.renderWhitespace,Tt=ct.renderControlCharacters,Rt=new CharacterMapping(pt+1,St.length);let Nt=!1,Pt=0,Ft=Lt,Kt=0,Bt=0,Ut=0;xt?nt.appendString('<span dir="ltr">'):nt.appendString("<span>");for(let qt=0,Yt=St.length;qt<Yt;qt++){const Zt=St[qt],Xt=Zt.endIndex,_i=Zt.type,nn=Zt.containsRTL,rn=At!==0&&Zt.isWhitespace(),dn=rn&&!ot&&(_i==="mtkw"||!ut),bn=Pt===Xt&&Zt.isPseudoAfter();if(Kt=0,nt.appendString("<span "),nn&&nt.appendString('style="unicode-bidi:isolate" '),nt.appendString('class="'),nt.appendString(dn?"mtkz":_i),nt.appendASCIICharCode(34),rn){let un=0;{let an=Pt,Cn=Ft;for(;an<Xt;an++){const hn=(gt.charCodeAt(an)===9?wt-Cn%wt:1)|0;un+=hn,an>=yt&&(Cn+=hn)}}for(dn&&(nt.appendString(' style="width:'),nt.appendString(String(It*un)),nt.appendString('px"')),nt.appendASCIICharCode(62);Pt<Xt;Pt++){Rt.setColumnInfo(Pt+1,qt-Ut,Kt,Bt),Ut=0;const an=gt.charCodeAt(Pt);let Cn,_n;if(an===9){Cn=wt-Ft%wt|0,_n=Cn,!rt||_n>1?nt.appendCharCode(8594):nt.appendCharCode(65515);for(let hn=2;hn<=_n;hn++)nt.appendCharCode(160)}else Cn=2,_n=1,nt.appendCharCode(kt),nt.appendCharCode(8204);Kt+=Cn,Bt+=_n,Pt>=yt&&(Ft+=_n)}}else for(nt.appendASCIICharCode(62);Pt<Xt;Pt++){Rt.setColumnInfo(Pt+1,qt-Ut,Kt,Bt),Ut=0;const un=gt.charCodeAt(Pt);let an=1,Cn=1;switch(un){case 9:an=wt-Ft%wt,Cn=an;for(let _n=1;_n<=an;_n++)nt.appendCharCode(160);break;case 32:nt.appendCharCode(160);break;case 60:nt.appendString("&lt;");break;case 62:nt.appendString("&gt;");break;case 38:nt.appendString("&amp;");break;case 0:Tt?nt.appendCharCode(9216):nt.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:nt.appendCharCode(65533);break;default:isFullWidthCharacter(un)&&Cn++,Tt&&un<32?nt.appendCharCode(9216+un):Tt&&un===127?nt.appendCharCode(9249):Tt&&isControlCharacter(un)?(nt.appendString("[U+"),nt.appendString(to4CharHex(un)),nt.appendString("]"),an=8,Cn=an):nt.appendCharCode(un)}Kt+=an,Bt+=Cn,Pt>=yt&&(Ft+=Cn)}bn?Ut++:Ut=0,Pt>=pt&&!Nt&&Zt.isPseudoAfter()&&(Nt=!0,Rt.setColumnInfo(Pt+1,qt,Kt,Bt)),nt.appendString("</span>")}return Nt||Rt.setColumnInfo(pt+1,St.length-1,Kt,Bt),mt&&(nt.appendString('<span class="mtkoverflow">'),nt.appendString(localize("showMore","Show more ({0})",renderOverflowingCharCount(vt))),nt.appendString("</span>")),nt.appendString("</span>"),new RenderLineOutput(Rt,xt,ut)}function to4CharHex(ct){return ct.toString(16).toUpperCase().padStart(4,"0")}function renderOverflowingCharCount(ct){return ct<1024?localize("overflow.chars","{0} chars",ct):ct<1024*1024?`${(ct/1024).toFixed(1)} KB`:`${(ct/1024/1024).toFixed(1)} MB`}class Viewport{constructor(nt,ot,rt,ut){this._viewportBrand=void 0,this.top=nt|0,this.left=ot|0,this.width=rt|0,this.height=ut|0}}class MinimapLinesRenderingData{constructor(nt,ot){this.tabSize=nt,this.data=ot}}class ViewLineData{constructor(nt,ot,rt,ut,gt,pt,mt){this._viewLineDataBrand=void 0,this.content=nt,this.continuesWithWrappedLine=ot,this.minColumn=rt,this.maxColumn=ut,this.startVisibleColumn=gt,this.tokens=pt,this.inlineDecorations=mt}}class ViewLineRenderingData{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt){this.minColumn=nt,this.maxColumn=ot,this.content=rt,this.continuesWithWrappedLine=ut,this.isBasicASCII=ViewLineRenderingData.isBasicASCII(rt,pt),this.containsRTL=ViewLineRenderingData.containsRTL(rt,this.isBasicASCII,gt),this.tokens=mt,this.inlineDecorations=vt,this.tabSize=St,this.startVisibleColumn=yt}static isBasicASCII(nt,ot){return ot?isBasicASCII(nt):!0}static containsRTL(nt,ot,rt){return!ot&&rt?containsRTL(nt):!1}}class InlineDecoration{constructor(nt,ot,rt){this.range=nt,this.inlineClassName=ot,this.type=rt}}class SingleLineInlineDecoration{constructor(nt,ot,rt,ut){this.startOffset=nt,this.endOffset=ot,this.inlineClassName=rt,this.inlineClassNameAffectsLetterSpacing=ut}toInlineDecoration(nt){return new InlineDecoration(new Range$2(nt,this.startOffset+1,nt,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class ViewModelDecoration{constructor(nt,ot){this._viewModelDecorationBrand=void 0,this.range=nt,this.options=ot}}class OverviewRulerDecorationsGroup{constructor(nt,ot,rt){this.color=nt,this.zIndex=ot,this.data=rt}static cmp(nt,ot){return nt.zIndex===ot.zIndex?nt.color<ot.color?-1:nt.color>ot.color?1:0:nt.zIndex-ot.zIndex}}function isFuzzyActionArr(ct){return Array.isArray(ct)}function isFuzzyAction(ct){return!isFuzzyActionArr(ct)}function isString(ct){return typeof ct=="string"}function isIAction(ct){return!isString(ct)}function empty$1(ct){return!ct}function fixCase(ct,nt){return ct.ignoreCase&&nt?nt.toLowerCase():nt}function sanitize$1(ct){return ct.replace(/[&<>'"_]/g,"-")}function log(ct,nt){console.log(`${ct.languageId}: ${nt}`)}function createError(ct,nt){return new Error(`${ct.languageId}: ${nt}`)}function substituteMatches(ct,nt,ot,rt,ut){const gt=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let pt=null;return nt.replace(gt,function(mt,vt,St,yt,wt,Lt,xt,It,kt){return empty$1(St)?empty$1(yt)?!empty$1(wt)&&wt<rt.length?fixCase(ct,rt[wt]):!empty$1(xt)&&ct&&typeof ct[xt]=="string"?ct[xt]:(pt===null&&(pt=ut.split("."),pt.unshift(ut)),!empty$1(Lt)&&Lt<pt.length?fixCase(ct,pt[Lt]):""):fixCase(ct,ot):"$"})}function findRules(ct,nt){let ot=nt;for(;ot&&ot.length>0;){const rt=ct.tokenizer[ot];if(rt)return rt;const ut=ot.lastIndexOf(".");ut<0?ot=null:ot=ot.substr(0,ut)}return null}function stateExists(ct,nt){let ot=nt;for(;ot&&ot.length>0;){if(ct.stateNames[ot])return!0;const ut=ot.lastIndexOf(".");ut<0?ot=null:ot=ot.substr(0,ut)}return!1}var __decorate$23=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1Y=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const CACHE_STACK_DEPTH=5;class MonarchStackElementFactory{static create(nt,ot){return this._INSTANCE.create(nt,ot)}constructor(nt){this._maxCacheDepth=nt,this._entries=Object.create(null)}create(nt,ot){if(nt!==null&&nt.depth>=this._maxCacheDepth)return new MonarchStackElement(nt,ot);let rt=MonarchStackElement.getStackElementId(nt);rt.length>0&&(rt+="|"),rt+=ot;let ut=this._entries[rt];return ut||(ut=new MonarchStackElement(nt,ot),this._entries[rt]=ut,ut)}}MonarchStackElementFactory._INSTANCE=new MonarchStackElementFactory(CACHE_STACK_DEPTH);class MonarchStackElement{constructor(nt,ot){this.parent=nt,this.state=ot,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(nt){let ot="";for(;nt!==null;)ot.length>0&&(ot+="|"),ot+=nt.state,nt=nt.parent;return ot}static _equals(nt,ot){for(;nt!==null&&ot!==null;){if(nt===ot)return!0;if(nt.state!==ot.state)return!1;nt=nt.parent,ot=ot.parent}return nt===null&&ot===null}equals(nt){return MonarchStackElement._equals(this,nt)}push(nt){return MonarchStackElementFactory.create(this,nt)}pop(){return this.parent}popall(){let nt=this;for(;nt.parent;)nt=nt.parent;return nt}switchTo(nt){return MonarchStackElementFactory.create(this.parent,nt)}}class EmbeddedLanguageData{constructor(nt,ot){this.languageId=nt,this.state=ot}equals(nt){return this.languageId===nt.languageId&&this.state.equals(nt.state)}clone(){return this.state.clone()===this.state?this:new EmbeddedLanguageData(this.languageId,this.state)}}class MonarchLineStateFactory{static create(nt,ot){return this._INSTANCE.create(nt,ot)}constructor(nt){this._maxCacheDepth=nt,this._entries=Object.create(null)}create(nt,ot){if(ot!==null)return new MonarchLineState(nt,ot);if(nt!==null&&nt.depth>=this._maxCacheDepth)return new MonarchLineState(nt,ot);const rt=MonarchStackElement.getStackElementId(nt);let ut=this._entries[rt];return ut||(ut=new MonarchLineState(nt,null),this._entries[rt]=ut,ut)}}MonarchLineStateFactory._INSTANCE=new MonarchLineStateFactory(CACHE_STACK_DEPTH);class MonarchLineState{constructor(nt,ot){this.stack=nt,this.embeddedLanguageData=ot}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:MonarchLineStateFactory.create(this.stack,this.embeddedLanguageData)}equals(nt){return!(nt instanceof MonarchLineState)||!this.stack.equals(nt.stack)?!1:this.embeddedLanguageData===null&&nt.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||nt.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(nt.embeddedLanguageData)}}class MonarchClassicTokensCollector{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(nt){this._languageId=nt}emit(nt,ot){this._lastTokenType===ot&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=ot,this._lastTokenLanguage=this._languageId,this._tokens.push(new Token$2(nt,ot,this._languageId)))}nestedLanguageTokenize(nt,ot,rt,ut){const gt=rt.languageId,pt=rt.state,mt=TokenizationRegistry.get(gt);if(!mt)return this.enterLanguage(gt),this.emit(ut,""),pt;const vt=mt.tokenize(nt,ot,pt);if(ut!==0)for(const St of vt.tokens)this._tokens.push(new Token$2(St.offset+ut,St.type,St.language));else this._tokens=this._tokens.concat(vt.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,vt.endState}finalize(nt){return new TokenizationResult(this._tokens,nt)}}class MonarchModernTokensCollector{constructor(nt,ot){this._languageService=nt,this._theme=ot,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(nt){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(nt)}emit(nt,ot){const rt=this._theme.match(this._currentLanguageId,ot)|1024;this._lastTokenMetadata!==rt&&(this._lastTokenMetadata=rt,this._tokens.push(nt),this._tokens.push(rt))}static _merge(nt,ot,rt){const ut=nt!==null?nt.length:0,gt=ot.length,pt=rt!==null?rt.length:0;if(ut===0&&gt===0&&pt===0)return new Uint32Array(0);if(ut===0&&gt===0)return rt;if(gt===0&&pt===0)return nt;const mt=new Uint32Array(ut+gt+pt);nt!==null&&mt.set(nt);for(let vt=0;vt<gt;vt++)mt[ut+vt]=ot[vt];return rt!==null&&mt.set(rt,ut+gt),mt}nestedLanguageTokenize(nt,ot,rt,ut){const gt=rt.languageId,pt=rt.state,mt=TokenizationRegistry.get(gt);if(!mt)return this.enterLanguage(gt),this.emit(ut,""),pt;const vt=mt.tokenizeEncoded(nt,ot,pt);if(ut!==0)for(let St=0,yt=vt.tokens.length;St<yt;St+=2)vt.tokens[St]+=ut;return this._prependTokens=MonarchModernTokensCollector._merge(this._prependTokens,this._tokens,vt.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,vt.endState}finalize(nt){return new EncodedTokenizationResult(MonarchModernTokensCollector._merge(this._prependTokens,this._tokens,null),nt)}}let MonarchTokenizer=class rr{constructor(nt,ot,rt,ut,gt){this._configurationService=gt,this._languageService=nt,this._standaloneThemeService=ot,this._languageId=rt,this._lexer=ut,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let pt=!1;this._tokenizationRegistryListener=TokenizationRegistry.onDidChange(mt=>{if(pt)return;let vt=!1;for(let St=0,yt=mt.changedLanguages.length;St<yt;St++){const wt=mt.changedLanguages[St];if(this._embeddedLanguages[wt]){vt=!0;break}}vt&&(pt=!0,TokenizationRegistry.handleChange([this._languageId]),pt=!1)}),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._configurationService.onDidChangeConfiguration(mt=>{mt.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))})}dispose(){this._tokenizationRegistryListener.dispose()}getLoadStatus(){const nt=[];for(const ot in this._embeddedLanguages){const rt=TokenizationRegistry.get(ot);if(rt){if(rt instanceof rr){const ut=rt.getLoadStatus();ut.loaded===!1&&nt.push(ut.promise)}continue}TokenizationRegistry.isResolved(ot)||nt.push(TokenizationRegistry.getOrCreate(ot))}return nt.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(nt).then(ot=>{})}}getInitialState(){const nt=MonarchStackElementFactory.create(null,this._lexer.start);return MonarchLineStateFactory.create(nt,null)}tokenize(nt,ot,rt){if(nt.length>=this._maxTokenizationLineLength)return nullTokenize(this._languageId,rt);const ut=new MonarchClassicTokensCollector,gt=this._tokenize(nt,ot,rt,ut);return ut.finalize(gt)}tokenizeEncoded(nt,ot,rt){if(nt.length>=this._maxTokenizationLineLength)return nullTokenizeEncoded(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),rt);const ut=new MonarchModernTokensCollector(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),gt=this._tokenize(nt,ot,rt,ut);return ut.finalize(gt)}_tokenize(nt,ot,rt,ut){return rt.embeddedLanguageData?this._nestedTokenize(nt,ot,rt,0,ut):this._myTokenize(nt,ot,rt,0,ut)}_findLeavingNestedLanguageOffset(nt,ot){let rt=this._lexer.tokenizer[ot.stack.state];if(!rt&&(rt=findRules(this._lexer,ot.stack.state),!rt))throw createError(this._lexer,"tokenizer state is not defined: "+ot.stack.state);let ut=-1,gt=!1;for(const pt of rt){if(!isIAction(pt.action)||pt.action.nextEmbedded!=="@pop")continue;gt=!0;let mt=pt.regex;const vt=pt.regex.source;if(vt.substr(0,4)==="^(?:"&&vt.substr(vt.length-1,1)===")"){const yt=(mt.ignoreCase?"i":"")+(mt.unicode?"u":"");mt=new RegExp(vt.substr(4,vt.length-5),yt)}const St=nt.search(mt);St===-1||St!==0&&pt.matchOnlyAtLineStart||(ut===-1||St<ut)&&(ut=St)}if(!gt)throw createError(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+ot.stack.state);return ut}_nestedTokenize(nt,ot,rt,ut,gt){const pt=this._findLeavingNestedLanguageOffset(nt,rt);if(pt===-1){const St=gt.nestedLanguageTokenize(nt,ot,rt.embeddedLanguageData,ut);return MonarchLineStateFactory.create(rt.stack,new EmbeddedLanguageData(rt.embeddedLanguageData.languageId,St))}const mt=nt.substring(0,pt);mt.length>0&&gt.nestedLanguageTokenize(mt,!1,rt.embeddedLanguageData,ut);const vt=nt.substring(pt);return this._myTokenize(vt,ot,rt,ut+pt,gt)}_safeRuleName(nt){return nt?nt.name:"(unknown)"}_myTokenize(nt,ot,rt,ut,gt){gt.enterLanguage(this._languageId);const pt=nt.length,mt=ot&&this._lexer.includeLF?nt+`
`:nt,vt=mt.length;let St=rt.embeddedLanguageData,yt=rt.stack,wt=0,Lt=null,xt=!0;for(;xt||wt<vt;){const It=wt,kt=yt.depth,At=Lt?Lt.groups.length:0,Tt=yt.state;let Rt=null,Nt=null,Pt=null,Ft=null,Kt=null;if(Lt){Rt=Lt.matches;const qt=Lt.groups.shift();Nt=qt.matched,Pt=qt.action,Ft=Lt.rule,Lt.groups.length===0&&(Lt=null)}else{if(!xt&&wt>=vt)break;xt=!1;let qt=this._lexer.tokenizer[Tt];if(!qt&&(qt=findRules(this._lexer,Tt),!qt))throw createError(this._lexer,"tokenizer state is not defined: "+Tt);const Yt=mt.substr(wt);for(const Zt of qt)if((wt===0||!Zt.matchOnlyAtLineStart)&&(Rt=Yt.match(Zt.regex),Rt)){Nt=Rt[0],Pt=Zt.action;break}}if(Rt||(Rt=[""],Nt=""),Pt||(wt<vt&&(Rt=[mt.charAt(wt)],Nt=Rt[0]),Pt=this._lexer.defaultToken),Nt===null)break;for(wt+=Nt.length;isFuzzyAction(Pt)&&isIAction(Pt)&&Pt.test;)Pt=Pt.test(Nt,Rt,Tt,wt===vt);let Bt=null;if(typeof Pt=="string"||Array.isArray(Pt))Bt=Pt;else if(Pt.group)Bt=Pt.group;else if(Pt.token!==null&&Pt.token!==void 0){if(Pt.tokenSubst?Bt=substituteMatches(this._lexer,Pt.token,Nt,Rt,Tt):Bt=Pt.token,Pt.nextEmbedded)if(Pt.nextEmbedded==="@pop"){if(!St)throw createError(this._lexer,"cannot pop embedded language if not inside one");St=null}else{if(St)throw createError(this._lexer,"cannot enter embedded language from within an embedded language");Kt=substituteMatches(this._lexer,Pt.nextEmbedded,Nt,Rt,Tt)}if(Pt.goBack&&(wt=Math.max(0,wt-Pt.goBack)),Pt.switchTo&&typeof Pt.switchTo=="string"){let qt=substituteMatches(this._lexer,Pt.switchTo,Nt,Rt,Tt);if(qt[0]==="@"&&(qt=qt.substr(1)),findRules(this._lexer,qt))yt=yt.switchTo(qt);else throw createError(this._lexer,"trying to switch to a state '"+qt+"' that is undefined in rule: "+this._safeRuleName(Ft))}else{if(Pt.transform&&typeof Pt.transform=="function")throw createError(this._lexer,"action.transform not supported");if(Pt.next)if(Pt.next==="@push"){if(yt.depth>=this._lexer.maxStack)throw createError(this._lexer,"maximum tokenizer stack size reached: ["+yt.state+","+yt.parent.state+",...]");yt=yt.push(Tt)}else if(Pt.next==="@pop"){if(yt.depth<=1)throw createError(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(Ft));yt=yt.pop()}else if(Pt.next==="@popall")yt=yt.popall();else{let qt=substituteMatches(this._lexer,Pt.next,Nt,Rt,Tt);if(qt[0]==="@"&&(qt=qt.substr(1)),findRules(this._lexer,qt))yt=yt.push(qt);else throw createError(this._lexer,"trying to set a next state '"+qt+"' that is undefined in rule: "+this._safeRuleName(Ft))}}Pt.log&&typeof Pt.log=="string"&&log(this._lexer,this._lexer.languageId+": "+substituteMatches(this._lexer,Pt.log,Nt,Rt,Tt))}if(Bt===null)throw createError(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(Ft));const Ut=qt=>{const Yt=this._languageService.getLanguageIdByLanguageName(qt)||this._languageService.getLanguageIdByMimeType(qt)||qt,Zt=this._getNestedEmbeddedLanguageData(Yt);if(wt<vt){const Xt=nt.substr(wt);return this._nestedTokenize(Xt,ot,MonarchLineStateFactory.create(yt,Zt),ut+wt,gt)}else return MonarchLineStateFactory.create(yt,Zt)};if(Array.isArray(Bt)){if(Lt&&Lt.groups.length>0)throw createError(this._lexer,"groups cannot be nested: "+this._safeRuleName(Ft));if(Rt.length!==Bt.length+1)throw createError(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(Ft));let qt=0;for(let Yt=1;Yt<Rt.length;Yt++)qt+=Rt[Yt].length;if(qt!==Nt.length)throw createError(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(Ft));Lt={rule:Ft,matches:Rt,groups:[]};for(let Yt=0;Yt<Bt.length;Yt++)Lt.groups[Yt]={action:Bt[Yt],matched:Rt[Yt+1]};wt-=Nt.length;continue}else{if(Bt==="@rematch"&&(wt-=Nt.length,Nt="",Rt=null,Bt="",Kt!==null))return Ut(Kt);if(Nt.length===0){if(vt===0||kt!==yt.depth||Tt!==yt.state||(Lt?Lt.groups.length:0)!==At)continue;throw createError(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(Ft))}let qt=null;if(isString(Bt)&&Bt.indexOf("@brackets")===0){const Yt=Bt.substr(9),Zt=findBracket(this._lexer,Nt);if(!Zt)throw createError(this._lexer,"@brackets token returned but no bracket defined as: "+Nt);qt=sanitize$1(Zt.token+Yt)}else{const Yt=Bt===""?"":Bt+this._lexer.tokenPostfix;qt=sanitize$1(Yt)}It<pt&&gt.emit(It+ut,qt)}if(Kt!==null)return Ut(Kt)}return MonarchLineStateFactory.create(yt,St)}_getNestedEmbeddedLanguageData(nt){if(!this._languageService.isRegisteredLanguageId(nt))return new EmbeddedLanguageData(nt,NullState);nt!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(nt),TokenizationRegistry.getOrCreate(nt),this._embeddedLanguages[nt]=!0);const ot=TokenizationRegistry.get(nt);return ot?new EmbeddedLanguageData(nt,ot.getInitialState()):new EmbeddedLanguageData(nt,NullState)}};MonarchTokenizer=__decorate$23([__param$1Y(4,IConfigurationService)],MonarchTokenizer);function findBracket(ct,nt){if(!nt)return null;nt=fixCase(ct,nt);const ot=ct.brackets;for(const rt of ot){if(rt.open===nt)return{token:rt.token,bracketType:1};if(rt.close===nt)return{token:rt.token,bracketType:-1}}return null}var __awaiter$1r=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},_a$a;const ttPolicy$3=(_a$a=window.trustedTypes)===null||_a$a===void 0?void 0:_a$a.createPolicy("standaloneColorizer",{createHTML:ct=>ct});class Colorizer{static colorizeElement(nt,ot,rt,ut){ut=ut||{};const gt=ut.theme||"vs",pt=ut.mimeType||rt.getAttribute("lang")||rt.getAttribute("data-lang");if(!pt)return console.error("Mode not detected"),Promise.resolve();const mt=ot.getLanguageIdByMimeType(pt)||pt;nt.setTheme(gt);const vt=rt.firstChild?rt.firstChild.nodeValue:"";rt.className+=" "+gt;const St=yt=>{var wt;const Lt=(wt=ttPolicy$3==null?void 0:ttPolicy$3.createHTML(yt))!==null&&wt!==void 0?wt:yt;rt.innerHTML=Lt};return this.colorize(ot,vt||"",mt,ut).then(St,yt=>console.error(yt))}static colorize(nt,ot,rt,ut){return __awaiter$1r(this,void 0,void 0,function*(){const gt=nt.languageIdCodec;let pt=4;ut&&typeof ut.tabSize=="number"&&(pt=ut.tabSize),startsWithUTF8BOM(ot)&&(ot=ot.substr(1));const mt=splitLines(ot);if(!nt.isRegisteredLanguageId(rt))return _fakeColorize(mt,pt,gt);const vt=yield TokenizationRegistry.getOrCreate(rt);return vt?_colorize(mt,pt,vt,gt):_fakeColorize(mt,pt,gt)})}static colorizeLine(nt,ot,rt,ut,gt=4){const pt=ViewLineRenderingData.isBasicASCII(nt,ot),mt=ViewLineRenderingData.containsRTL(nt,pt,rt);return renderViewLine2(new RenderLineInput(!1,!0,nt,!1,pt,mt,0,ut,[],gt,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(nt,ot,rt=4){const ut=nt.getLineContent(ot);nt.tokenization.forceTokenization(ot);const pt=nt.tokenization.getLineTokens(ot).inflate();return this.colorizeLine(ut,nt.mightContainNonBasicASCII(),nt.mightContainRTL(),pt,rt)}}function _colorize(ct,nt,ot,rt){return new Promise((ut,gt)=>{const pt=()=>{const mt=_actualColorize(ct,nt,ot,rt);if(ot instanceof MonarchTokenizer){const vt=ot.getLoadStatus();if(vt.loaded===!1){vt.promise.then(pt,gt);return}}ut(mt)};pt()})}function _fakeColorize(ct,nt,ot){let rt=[];const gt=new Uint32Array(2);gt[0]=0,gt[1]=33587200;for(let pt=0,mt=ct.length;pt<mt;pt++){const vt=ct[pt];gt[0]=vt.length;const St=new LineTokens(gt,vt,ot),yt=ViewLineRenderingData.isBasicASCII(vt,!0),wt=ViewLineRenderingData.containsRTL(vt,yt,!0),Lt=renderViewLine2(new RenderLineInput(!1,!0,vt,!1,yt,wt,0,St,[],nt,0,0,0,0,-1,"none",!1,!1,null));rt=rt.concat(Lt.html),rt.push("<br/>")}return rt.join("")}function _actualColorize(ct,nt,ot,rt){let ut=[],gt=ot.getInitialState();for(let pt=0,mt=ct.length;pt<mt;pt++){const vt=ct[pt],St=ot.tokenizeEncoded(vt,!0,gt);LineTokens.convertToEndOffset(St.tokens,vt.length);const yt=new LineTokens(St.tokens,vt,rt),wt=ViewLineRenderingData.isBasicASCII(vt,!0),Lt=ViewLineRenderingData.containsRTL(vt,wt,!0),xt=renderViewLine2(new RenderLineInput(!1,!0,vt,!1,wt,Lt,0,yt.inflate(),[],nt,0,0,0,0,-1,"none",!1,!1,null));ut=ut.concat(xt.html),ut.push("<br/>"),gt=St.endState}return ut.join("")}const BrowserFeatures={clipboard:{writeText:isNative||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:isNative||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:(()=>isNative||isStandalone()?0:navigator.keyboard||isSafari?1:2)(),touch:"ontouchstart"in window||navigator.maxTouchPoints>0,pointerEvents:window.PointerEvent&&("ontouchstart"in window||window.navigator.maxTouchPoints>0||navigator.maxTouchPoints>0)};function decodeKeybinding(ct,nt){if(typeof ct=="number"){if(ct===0)return null;const ot=(ct&65535)>>>0,rt=(ct&4294901760)>>>16;return rt!==0?new Keybinding([createSimpleKeybinding(ot,nt),createSimpleKeybinding(rt,nt)]):new Keybinding([createSimpleKeybinding(ot,nt)])}else{const ot=[];for(let rt=0;rt<ct.length;rt++)ot.push(createSimpleKeybinding(ct[rt],nt));return new Keybinding(ot)}}function createSimpleKeybinding(ct,nt){const ot=!!(ct&2048),rt=!!(ct&256),ut=nt===2?rt:ot,gt=!!(ct&1024),pt=!!(ct&512),mt=nt===2?ot:rt,vt=ct&255;return new KeyCodeChord(ut,gt,pt,mt,vt)}class KeyCodeChord{constructor(nt,ot,rt,ut,gt){this.ctrlKey=nt,this.shiftKey=ot,this.altKey=rt,this.metaKey=ut,this.keyCode=gt}equals(nt){return nt instanceof KeyCodeChord&&this.ctrlKey===nt.ctrlKey&&this.shiftKey===nt.shiftKey&&this.altKey===nt.altKey&&this.metaKey===nt.metaKey&&this.keyCode===nt.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class Keybinding{constructor(nt){if(nt.length===0)throw illegalArgument("chords");this.chords=nt}}class ResolvedChord{constructor(nt,ot,rt,ut,gt,pt){this.ctrlKey=nt,this.shiftKey=ot,this.altKey=rt,this.metaKey=ut,this.keyLabel=gt,this.keyAriaLabel=pt}}class ResolvedKeybinding{}function extractKeyCode(ct){if(ct.charCode){const ot=String.fromCharCode(ct.charCode).toUpperCase();return KeyCodeUtils.fromString(ot)}const nt=ct.keyCode;if(nt===3)return 7;if(isFirefox)switch(nt){case 59:return 85;case 60:if(isLinux)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(isMacintosh)return 57;break}else if(isWebKit){if(isMacintosh&&nt===93)return 57;if(!isMacintosh&&nt===92)return 57}return EVENT_KEY_CODE_MAP[nt]||0}const ctrlKeyMod$1=isMacintosh?256:2048,altKeyMod=512,shiftKeyMod=1024,metaKeyMod=isMacintosh?2048:256;class StandardKeyboardEvent{constructor(nt){this._standardKeyboardEventBrand=!0;const ot=nt;this.browserEvent=ot,this.target=ot.target,this.ctrlKey=ot.ctrlKey,this.shiftKey=ot.shiftKey,this.altKey=ot.altKey,this.metaKey=ot.metaKey,this.altGraphKey=ot.getModifierState("AltGraph"),this.keyCode=extractKeyCode(ot),this.code=ot.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(nt){return this._asKeybinding===nt}_computeKeybinding(){let nt=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(nt=this.keyCode);let ot=0;return this.ctrlKey&&(ot|=ctrlKeyMod$1),this.altKey&&(ot|=altKeyMod),this.shiftKey&&(ot|=shiftKeyMod),this.metaKey&&(ot|=metaKeyMod),ot|=nt,ot}_computeKeyCodeChord(){let nt=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(nt=this.keyCode),new KeyCodeChord(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,nt)}}let hasDifferentOriginAncestorFlag=!1,sameOriginWindowChainCache=null;function getParentWindowIfSameOrigin(ct){if(!ct.parent||ct.parent===ct)return null;try{const nt=ct.location,ot=ct.parent.location;if(nt.origin!=="null"&&ot.origin!=="null"&&nt.origin!==ot.origin)return hasDifferentOriginAncestorFlag=!0,null}catch{return hasDifferentOriginAncestorFlag=!0,null}return ct.parent}class IframeUtils{static getSameOriginWindowChain(){if(!sameOriginWindowChainCache){sameOriginWindowChainCache=[];let nt=window,ot;do ot=getParentWindowIfSameOrigin(nt),ot?sameOriginWindowChainCache.push({window:nt,iframeElement:nt.frameElement||null}):sameOriginWindowChainCache.push({window:nt,iframeElement:null}),nt=ot;while(nt)}return sameOriginWindowChainCache.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(nt,ot){if(!ot||nt===ot)return{top:0,left:0};let rt=0,ut=0;const gt=this.getSameOriginWindowChain();for(const pt of gt){if(rt+=pt.window.scrollY,ut+=pt.window.scrollX,pt.window===ot||!pt.iframeElement)break;const mt=pt.iframeElement.getBoundingClientRect();rt+=mt.top,ut+=mt.left}return{top:rt,left:ut}}}class StandardMouseEvent{constructor(nt){this.timestamp=Date.now(),this.browserEvent=nt,this.leftButton=nt.button===0,this.middleButton=nt.button===1,this.rightButton=nt.button===2,this.buttons=nt.buttons,this.target=nt.target,this.detail=nt.detail||1,nt.type==="dblclick"&&(this.detail=2),this.ctrlKey=nt.ctrlKey,this.shiftKey=nt.shiftKey,this.altKey=nt.altKey,this.metaKey=nt.metaKey,typeof nt.pageX=="number"?(this.posx=nt.pageX,this.posy=nt.pageY):(this.posx=nt.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.posy=nt.clientY+document.body.scrollTop+document.documentElement.scrollTop);const ot=IframeUtils.getPositionOfChildWindowRelativeToAncestorWindow(window,nt.view);this.posx-=ot.left,this.posy-=ot.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class StandardWheelEvent{constructor(nt,ot=0,rt=0){if(this.browserEvent=nt||null,this.target=nt?nt.target||nt.targetNode||nt.srcElement:null,this.deltaY=rt,this.deltaX=ot,nt){const ut=nt,gt=nt;if(typeof ut.wheelDeltaY<"u")this.deltaY=ut.wheelDeltaY/120;else if(typeof gt.VERTICAL_AXIS<"u"&&gt.axis===gt.VERTICAL_AXIS)this.deltaY=-gt.detail/3;else if(nt.type==="wheel"){const pt=nt;pt.deltaMode===pt.DOM_DELTA_LINE?isFirefox&&!isMacintosh?this.deltaY=-nt.deltaY/3:this.deltaY=-nt.deltaY:this.deltaY=-nt.deltaY/40}if(typeof ut.wheelDeltaX<"u")isSafari&&isWindows?this.deltaX=-(ut.wheelDeltaX/120):this.deltaX=ut.wheelDeltaX/120;else if(typeof gt.HORIZONTAL_AXIS<"u"&&gt.axis===gt.HORIZONTAL_AXIS)this.deltaX=-nt.detail/3;else if(nt.type==="wheel"){const pt=nt;pt.deltaMode===pt.DOM_DELTA_LINE?isFirefox&&!isMacintosh?this.deltaX=-nt.deltaX/3:this.deltaX=-nt.deltaX:this.deltaX=-nt.deltaX/40}this.deltaY===0&&this.deltaX===0&&nt.wheelDelta&&(this.deltaY=nt.wheelDelta/120)}}preventDefault(){var nt;(nt=this.browserEvent)===null||nt===void 0||nt.preventDefault()}stopPropagation(){var nt;(nt=this.browserEvent)===null||nt===void 0||nt.stopPropagation()}}/*! @license DOMPurify 2.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.1/LICENSE */function _toConsumableArray(ct){if(Array.isArray(ct)){for(var nt=0,ot=Array(ct.length);nt<ct.length;nt++)ot[nt]=ct[nt];return ot}else return Array.from(ct)}var hasOwnProperty$1=Object.hasOwnProperty,setPrototypeOf=Object.setPrototypeOf,isFrozen=Object.isFrozen,getPrototypeOf=Object.getPrototypeOf,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,freeze$1=Object.freeze,seal=Object.seal,create$1=Object.create,_ref=typeof Reflect<"u"&&Reflect,apply=_ref.apply,construct=_ref.construct;apply||(apply=function(nt,ot,rt){return nt.apply(ot,rt)});freeze$1||(freeze$1=function(nt){return nt});seal||(seal=function(nt){return nt});construct||(construct=function(nt,ot){return new(Function.prototype.bind.apply(nt,[null].concat(_toConsumableArray(ot))))});var arrayForEach=unapply(Array.prototype.forEach),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),stringToLowerCase=unapply(String.prototype.toLowerCase),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(ct){return function(nt){for(var ot=arguments.length,rt=Array(ot>1?ot-1:0),ut=1;ut<ot;ut++)rt[ut-1]=arguments[ut];return apply(ct,nt,rt)}}function unconstruct(ct){return function(){for(var nt=arguments.length,ot=Array(nt),rt=0;rt<nt;rt++)ot[rt]=arguments[rt];return construct(ct,ot)}}function addToSet(ct,nt){setPrototypeOf&&setPrototypeOf(ct,null);for(var ot=nt.length;ot--;){var rt=nt[ot];if(typeof rt=="string"){var ut=stringToLowerCase(rt);ut!==rt&&(isFrozen(nt)||(nt[ot]=ut),rt=ut)}ct[rt]=!0}return ct}function clone(ct){var nt=create$1(null),ot=void 0;for(ot in ct)apply(hasOwnProperty$1,ct,[ot])&&(nt[ot]=ct[ot]);return nt}function lookupGetter(ct,nt){for(;ct!==null;){var ot=getOwnPropertyDescriptor(ct,nt);if(ot){if(ot.get)return unapply(ot.get);if(typeof ot.value=="function")return unapply(ot.value)}ct=getPrototypeOf(ct)}function rt(ut){return console.warn("fallback value for",ut),null}return rt}var html=freeze$1(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg=freeze$1(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze$1(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze$1(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl=freeze$1(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),mathMlDisallowed=freeze$1(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze$1(["#text"]),html$1=freeze$1(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),svg$1=freeze$1(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl$1=freeze$1(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze$1(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\s\S]*|[\s\S]*\}\}/gm),ERB_EXPR=seal(/<%[\s\S]*|[\s\S]*%>/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ct){return typeof ct}:function(ct){return ct&&typeof Symbol=="function"&&ct.constructor===Symbol&&ct!==Symbol.prototype?"symbol":typeof ct};function _toConsumableArray$1(ct){if(Array.isArray(ct)){for(var nt=0,ot=Array(ct.length);nt<ct.length;nt++)ot[nt]=ct[nt];return ot}else return Array.from(ct)}var getGlobal=function(){return typeof window>"u"?null:window},_createTrustedTypesPolicy=function(nt,ot){if((typeof nt>"u"?"undefined":_typeof(nt))!=="object"||typeof nt.createPolicy!="function")return null;var rt=null,ut="data-tt-policy-suffix";ot.currentScript&&ot.currentScript.hasAttribute(ut)&&(rt=ot.currentScript.getAttribute(ut));var gt="dompurify"+(rt?"#"+rt:"");try{return nt.createPolicy(gt,{createHTML:function(mt){return mt}})}catch{return console.warn("TrustedTypes policy "+gt+" could not be created."),null}};function createDOMPurify(){var ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal(),nt=function(cn){return createDOMPurify(cn)};if(nt.version="2.3.1",nt.removed=[],!ct||!ct.document||ct.document.nodeType!==9)return nt.isSupported=!1,nt;var ot=ct.document,rt=ct.document,ut=ct.DocumentFragment,gt=ct.HTMLTemplateElement,pt=ct.Node,mt=ct.Element,vt=ct.NodeFilter,St=ct.NamedNodeMap,yt=St===void 0?ct.NamedNodeMap||ct.MozNamedAttrMap:St,wt=ct.Text,Lt=ct.Comment,xt=ct.DOMParser,It=ct.trustedTypes,kt=mt.prototype,At=lookupGetter(kt,"cloneNode"),Tt=lookupGetter(kt,"nextSibling"),Rt=lookupGetter(kt,"childNodes"),Nt=lookupGetter(kt,"parentNode");if(typeof gt=="function"){var Pt=rt.createElement("template");Pt.content&&Pt.content.ownerDocument&&(rt=Pt.content.ownerDocument)}var Ft=_createTrustedTypesPolicy(It,ot),Kt=Ft&&xn?Ft.createHTML(""):"",Bt=rt,Ut=Bt.implementation,qt=Bt.createNodeIterator,Yt=Bt.createDocumentFragment,Zt=Bt.getElementsByTagName,Xt=ot.importNode,_i={};try{_i=clone(rt).documentMode?rt.documentMode:{}}catch{}var nn={};nt.isSupported=typeof Nt=="function"&&Ut&&typeof Ut.createHTMLDocument<"u"&&_i!==9;var rn=MUSTACHE_EXPR,dn=ERB_EXPR,bn=DATA_ATTR,un=ARIA_ATTR,an=IS_SCRIPT_OR_DATA,Cn=ATTR_WHITESPACE,_n=IS_ALLOWED_URI,hn=null,pn=addToSet({},[].concat(_toConsumableArray$1(html),_toConsumableArray$1(svg),_toConsumableArray$1(svgFilters),_toConsumableArray$1(mathMl),_toConsumableArray$1(text))),yn=null,Mn=addToSet({},[].concat(_toConsumableArray$1(html$1),_toConsumableArray$1(svg$1),_toConsumableArray$1(mathMl$1),_toConsumableArray$1(xml))),Nn=null,Wn=null,Jn=!0,Xn=!0,Un=!1,In=!1,jn=!1,Gn=!1,qn=!1,ln=!1,fn=!1,Sn=!0,xn=!1,tn=!0,$t=!0,zt=!1,jt={},Gt=null,Qt=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Jt=null,en=addToSet({},["audio","video","img","source","image","track"]),sn=null,gn=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),mn="http://www.w3.org/1998/Math/MathML",vn="http://www.w3.org/2000/svg",En="http://www.w3.org/1999/xhtml",Dn=En,An=!1,Rn=null,Ln=rt.createElement("form"),Pn=function(cn){Rn&&Rn===cn||((!cn||(typeof cn>"u"?"undefined":_typeof(cn))!=="object")&&(cn={}),cn=clone(cn),hn="ALLOWED_TAGS"in cn?addToSet({},cn.ALLOWED_TAGS):pn,yn="ALLOWED_ATTR"in cn?addToSet({},cn.ALLOWED_ATTR):Mn,sn="ADD_URI_SAFE_ATTR"in cn?addToSet(clone(gn),cn.ADD_URI_SAFE_ATTR):gn,Jt="ADD_DATA_URI_TAGS"in cn?addToSet(clone(en),cn.ADD_DATA_URI_TAGS):en,Gt="FORBID_CONTENTS"in cn?addToSet({},cn.FORBID_CONTENTS):Qt,Nn="FORBID_TAGS"in cn?addToSet({},cn.FORBID_TAGS):{},Wn="FORBID_ATTR"in cn?addToSet({},cn.FORBID_ATTR):{},jt="USE_PROFILES"in cn?cn.USE_PROFILES:!1,Jn=cn.ALLOW_ARIA_ATTR!==!1,Xn=cn.ALLOW_DATA_ATTR!==!1,Un=cn.ALLOW_UNKNOWN_PROTOCOLS||!1,In=cn.SAFE_FOR_TEMPLATES||!1,jn=cn.WHOLE_DOCUMENT||!1,ln=cn.RETURN_DOM||!1,fn=cn.RETURN_DOM_FRAGMENT||!1,Sn=cn.RETURN_DOM_IMPORT!==!1,xn=cn.RETURN_TRUSTED_TYPE||!1,qn=cn.FORCE_BODY||!1,tn=cn.SANITIZE_DOM!==!1,$t=cn.KEEP_CONTENT!==!1,zt=cn.IN_PLACE||!1,_n=cn.ALLOWED_URI_REGEXP||_n,Dn=cn.NAMESPACE||En,In&&(Xn=!1),fn&&(ln=!0),jt&&(hn=addToSet({},[].concat(_toConsumableArray$1(text))),yn=[],jt.html===!0&&(addToSet(hn,html),addToSet(yn,html$1)),jt.svg===!0&&(addToSet(hn,svg),addToSet(yn,svg$1),addToSet(yn,xml)),jt.svgFilters===!0&&(addToSet(hn,svgFilters),addToSet(yn,svg$1),addToSet(yn,xml)),jt.mathMl===!0&&(addToSet(hn,mathMl),addToSet(yn,mathMl$1),addToSet(yn,xml))),cn.ADD_TAGS&&(hn===pn&&(hn=clone(hn)),addToSet(hn,cn.ADD_TAGS)),cn.ADD_ATTR&&(yn===Mn&&(yn=clone(yn)),addToSet(yn,cn.ADD_ATTR)),cn.ADD_URI_SAFE_ATTR&&addToSet(sn,cn.ADD_URI_SAFE_ATTR),cn.FORBID_CONTENTS&&(Gt===Qt&&(Gt=clone(Gt)),addToSet(Gt,cn.FORBID_CONTENTS)),$t&&(hn["#text"]=!0),jn&&addToSet(hn,["html","head","body"]),hn.table&&(addToSet(hn,["tbody"]),delete Nn.tbody),freeze$1&&freeze$1(cn),Rn=cn)},On=addToSet({},["mi","mo","mn","ms","mtext"]),to=addToSet({},["foreignobject","desc","title","annotation-xml"]),Fn=addToSet({},svg);addToSet(Fn,svgFilters),addToSet(Fn,svgDisallowed);var zn=addToSet({},mathMl);addToSet(zn,mathMlDisallowed);var lo=function(cn){var wn=Nt(cn);(!wn||!wn.tagName)&&(wn={namespaceURI:En,tagName:"template"});var kn=stringToLowerCase(cn.tagName),Bn=stringToLowerCase(wn.tagName);if(cn.namespaceURI===vn)return wn.namespaceURI===En?kn==="svg":wn.namespaceURI===mn?kn==="svg"&&(Bn==="annotation-xml"||On[Bn]):!!Fn[kn];if(cn.namespaceURI===mn)return wn.namespaceURI===En?kn==="math":wn.namespaceURI===vn?kn==="math"&&to[Bn]:!!zn[kn];if(cn.namespaceURI===En){if(wn.namespaceURI===vn&&!to[Bn]||wn.namespaceURI===mn&&!On[Bn])return!1;var Yn=addToSet({},["title","style","font","a","script"]);return!zn[kn]&&(Yn[kn]||!Fn[kn])}return!1},eo=function(cn){arrayPush(nt.removed,{element:cn});try{cn.parentNode.removeChild(cn)}catch{try{cn.outerHTML=Kt}catch{cn.remove()}}},oo=function(cn,wn){try{arrayPush(nt.removed,{attribute:wn.getAttributeNode(cn),from:wn})}catch{arrayPush(nt.removed,{attribute:null,from:wn})}if(wn.removeAttribute(cn),cn==="is"&&!yn[cn])if(ln||fn)try{eo(wn)}catch{}else try{wn.setAttribute(cn,"")}catch{}},ao=function(cn){var wn=void 0,kn=void 0;if(qn)cn="<remove></remove>"+cn;else{var Bn=stringMatch(cn,/^[\r\n\t ]+/);kn=Bn&&Bn[0]}var Yn=Ft?Ft.createHTML(cn):cn;if(Dn===En)try{wn=new xt().parseFromString(Yn,"text/html")}catch{}if(!wn||!wn.documentElement){wn=Ut.createDocument(Dn,"template",null);try{wn.documentElement.innerHTML=An?"":Yn}catch{}}var Qn=wn.body||wn.documentElement;return cn&&kn&&Qn.insertBefore(rt.createTextNode(kn),Qn.childNodes[0]||null),Dn===En?Zt.call(wn,jn?"html":"body")[0]:jn?wn.documentElement:Qn},co=function(cn){return qt.call(cn.ownerDocument||cn,cn,vt.SHOW_ELEMENT|vt.SHOW_COMMENT|vt.SHOW_TEXT,null,!1)},uo=function(cn){return cn instanceof wt||cn instanceof Lt?!1:typeof cn.nodeName!="string"||typeof cn.textContent!="string"||typeof cn.removeChild!="function"||!(cn.attributes instanceof yt)||typeof cn.removeAttribute!="function"||typeof cn.setAttribute!="function"||typeof cn.namespaceURI!="string"||typeof cn.insertBefore!="function"},ho=function(cn){return(typeof pt>"u"?"undefined":_typeof(pt))==="object"?cn instanceof pt:cn&&(typeof cn>"u"?"undefined":_typeof(cn))==="object"&&typeof cn.nodeType=="number"&&typeof cn.nodeName=="string"},io=function(cn,wn,kn){nn[cn]&&arrayForEach(nn[cn],function(Bn){Bn.call(nt,wn,kn,Rn)})},ko=function(cn){var wn=void 0;if(io("beforeSanitizeElements",cn,null),uo(cn)||stringMatch(cn.nodeName,/[\u0080-\uFFFF]/))return eo(cn),!0;var kn=stringToLowerCase(cn.nodeName);if(io("uponSanitizeElement",cn,{tagName:kn,allowedTags:hn}),!ho(cn.firstElementChild)&&(!ho(cn.content)||!ho(cn.content.firstElementChild))&&regExpTest(/<[/\w]/g,cn.innerHTML)&&regExpTest(/<[/\w]/g,cn.textContent)||kn==="select"&&regExpTest(/<template/i,cn.innerHTML))return eo(cn),!0;if(!hn[kn]||Nn[kn]){if($t&&!Gt[kn]){var Bn=Nt(cn)||cn.parentNode,Yn=Rt(cn)||cn.childNodes;if(Yn&&Bn)for(var Qn=Yn.length,Zn=Qn-1;Zn>=0;--Zn)Bn.insertBefore(At(Yn[Zn],!0),Tt(cn))}return eo(cn),!0}return cn instanceof mt&&!lo(cn)||(kn==="noscript"||kn==="noembed")&&regExpTest(/<\/no(script|embed)/i,cn.innerHTML)?(eo(cn),!0):(In&&cn.nodeType===3&&(wn=cn.textContent,wn=stringReplace(wn,rn," "),wn=stringReplace(wn,dn," "),cn.textContent!==wn&&(arrayPush(nt.removed,{element:cn.cloneNode()}),cn.textContent=wn)),io("afterSanitizeElements",cn,null),!1)},bo=function(cn,wn,kn){if(tn&&(wn==="id"||wn==="name")&&(kn in rt||kn in Ln))return!1;if(!(Xn&&!Wn[wn]&&regExpTest(bn,wn))){if(!(Jn&&regExpTest(un,wn))){if(!yn[wn]||Wn[wn])return!1;if(!sn[wn]){if(!regExpTest(_n,stringReplace(kn,Cn,""))){if(!((wn==="src"||wn==="xlink:href"||wn==="href")&&cn!=="script"&&stringIndexOf(kn,"data:")===0&&Jt[cn])){if(!(Un&&!regExpTest(an,stringReplace(kn,Cn,"")))){if(kn)return!1}}}}}}return!0},To=function(cn){var wn=void 0,kn=void 0,Bn=void 0,Yn=void 0;io("beforeSanitizeAttributes",cn,null);var Qn=cn.attributes;if(Qn){var Zn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:yn};for(Yn=Qn.length;Yn--;){wn=Qn[Yn];var so=wn,So=so.name,nr=so.namespaceURI;if(kn=stringTrim(wn.value),Bn=stringToLowerCase(So),Zn.attrName=Bn,Zn.attrValue=kn,Zn.keepAttr=!0,Zn.forceKeepAttr=void 0,io("uponSanitizeAttribute",cn,Zn),kn=Zn.attrValue,!Zn.forceKeepAttr&&(oo(So,cn),!!Zn.keepAttr)){if(regExpTest(/\/>/i,kn)){oo(So,cn);continue}In&&(kn=stringReplace(kn,rn," "),kn=stringReplace(kn,dn," "));var Hr=cn.nodeName.toLowerCase();if(bo(Hr,Bn,kn))try{nr?cn.setAttributeNS(nr,So,kn):cn.setAttribute(So,kn),arrayPop(nt.removed)}catch{}}}io("afterSanitizeAttributes",cn,null)}},Ro=function Tn(cn){var wn=void 0,kn=co(cn);for(io("beforeSanitizeShadowDOM",cn,null);wn=kn.nextNode();)io("uponSanitizeShadowNode",wn,null),!ko(wn)&&(wn.content instanceof ut&&Tn(wn.content),To(wn));io("afterSanitizeShadowDOM",cn,null)};return nt.sanitize=function(Tn,cn){var wn=void 0,kn=void 0,Bn=void 0,Yn=void 0,Qn=void 0;if(An=!Tn,An&&(Tn="<!-->"),typeof Tn!="string"&&!ho(Tn)){if(typeof Tn.toString!="function")throw typeErrorCreate("toString is not a function");if(Tn=Tn.toString(),typeof Tn!="string")throw typeErrorCreate("dirty is not a string, aborting")}if(!nt.isSupported){if(_typeof(ct.toStaticHTML)==="object"||typeof ct.toStaticHTML=="function"){if(typeof Tn=="string")return ct.toStaticHTML(Tn);if(ho(Tn))return ct.toStaticHTML(Tn.outerHTML)}return Tn}if(Gn||Pn(cn),nt.removed=[],typeof Tn=="string"&&(zt=!1),!zt)if(Tn instanceof pt)wn=ao("<!---->"),kn=wn.ownerDocument.importNode(Tn,!0),kn.nodeType===1&&kn.nodeName==="BODY"||kn.nodeName==="HTML"?wn=kn:wn.appendChild(kn);else{if(!ln&&!In&&!jn&&Tn.indexOf("<")===-1)return Ft&&xn?Ft.createHTML(Tn):Tn;if(wn=ao(Tn),!wn)return ln?null:Kt}wn&&qn&&eo(wn.firstChild);for(var Zn=co(zt?Tn:wn);Bn=Zn.nextNode();)Bn.nodeType===3&&Bn===Yn||ko(Bn)||(Bn.content instanceof ut&&Ro(Bn.content),To(Bn),Yn=Bn);if(Yn=null,zt)return Tn;if(ln){if(fn)for(Qn=Yt.call(wn.ownerDocument);wn.firstChild;)Qn.appendChild(wn.firstChild);else Qn=wn;return Sn&&(Qn=Xt.call(ot,Qn,!0)),Qn}var so=jn?wn.outerHTML:wn.innerHTML;return In&&(so=stringReplace(so,rn," "),so=stringReplace(so,dn," ")),Ft&&xn?Ft.createHTML(so):so},nt.setConfig=function(Tn){Pn(Tn),Gn=!0},nt.clearConfig=function(){Rn=null,Gn=!1},nt.isValidAttribute=function(Tn,cn,wn){Rn||Pn({});var kn=stringToLowerCase(Tn),Bn=stringToLowerCase(cn);return bo(kn,Bn,wn)},nt.addHook=function(Tn,cn){typeof cn=="function"&&(nn[Tn]=nn[Tn]||[],arrayPush(nn[Tn],cn))},nt.removeHook=function(Tn){nn[Tn]&&arrayPop(nn[Tn])},nt.removeHooks=function(Tn){nn[Tn]&&(nn[Tn]=[])},nt.removeAllHooks=function(){nn={}},nt}var purify=createDOMPurify();purify.version;purify.isSupported;const sanitize=purify.sanitize;purify.setConfig;purify.clearConfig;purify.isValidAttribute;const addHook=purify.addHook,removeHook=purify.removeHook;purify.removeHooks;purify.removeAllHooks;var Schemas;(function(ct){ct.inMemory="inmemory",ct.vscode="vscode",ct.internal="private",ct.walkThrough="walkThrough",ct.walkThroughSnippet="walkThroughSnippet",ct.http="http",ct.https="https",ct.file="file",ct.mailto="mailto",ct.untitled="untitled",ct.data="data",ct.command="command",ct.vscodeRemote="vscode-remote",ct.vscodeRemoteResource="vscode-remote-resource",ct.vscodeUserData="vscode-userdata",ct.vscodeCustomEditor="vscode-custom-editor",ct.vscodeNotebookCell="vscode-notebook-cell",ct.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",ct.vscodeNotebookCellOutput="vscode-notebook-cell-output",ct.vscodeInteractive="vscode-interactive",ct.vscodeInteractiveInput="vscode-interactive-input",ct.vscodeSettings="vscode-settings",ct.vscodeWorkspaceTrust="vscode-workspace-trust",ct.vscodeTerminal="vscode-terminal",ct.vscodeInteractiveSesssion="vscode-chat-editor",ct.webviewPanel="webview-panel",ct.vscodeWebview="vscode-webview",ct.extension="extension",ct.vscodeFileResource="vscode-file",ct.tmp="tmp",ct.vsls="vsls",ct.vscodeSourceControl="vscode-scm"})(Schemas||(Schemas={}));const connectionTokenQueryName="tkn";class RemoteAuthoritiesImpl{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._remoteResourcesPath=`/${Schemas.vscodeRemoteResource}`}setPreferredWebSchema(nt){this._preferredWebSchema=nt}rewrite(nt){if(this._delegate)try{return this._delegate(nt)}catch(mt){return onUnexpectedError(mt),nt}const ot=nt.authority;let rt=this._hosts[ot];rt&&rt.indexOf(":")!==-1&&rt.indexOf("[")===-1&&(rt=`[${rt}]`);const ut=this._ports[ot],gt=this._connectionTokens[ot];let pt=`path=${encodeURIComponent(nt.path)}`;return typeof gt=="string"&&(pt+=`&${connectionTokenQueryName}=${encodeURIComponent(gt)}`),URI.from({scheme:isWeb?this._preferredWebSchema:Schemas.vscodeRemoteResource,authority:`${rt}:${ut}`,path:this._remoteResourcesPath,query:pt})}}const RemoteAuthorities=new RemoteAuthoritiesImpl;class FileAccessImpl{uriToBrowserUri(nt){return nt.scheme===Schemas.vscodeRemote?RemoteAuthorities.rewrite(nt):nt.scheme===Schemas.file&&(isNative||isWebWorker&&globals.origin===`${Schemas.vscodeFileResource}://${FileAccessImpl.FALLBACK_AUTHORITY}`)?nt.with({scheme:Schemas.vscodeFileResource,authority:nt.authority||FileAccessImpl.FALLBACK_AUTHORITY,query:null,fragment:null}):nt}}FileAccessImpl.FALLBACK_AUTHORITY="vscode-app";const FileAccess=new FileAccessImpl;var COI;(function(ct){const nt=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);ct.CoopAndCoep=Object.freeze(nt.get("3"));const ot="vscode-coi";function rt(gt){let pt;typeof gt=="string"?pt=new URL(gt).searchParams:gt instanceof URL?pt=gt.searchParams:URI.isUri(gt)&&(pt=new URL(gt.toString(!0)).searchParams);const mt=pt==null?void 0:pt.get(ot);if(mt)return nt.get(mt)}ct.getHeadersFromQuery=rt;function ut(gt,pt,mt){if(!globalThis.crossOriginIsolated)return;const vt=pt&&mt?"3":mt?"2":"1";gt instanceof URLSearchParams?gt.set(ot,vt):gt[ot]=vt}ct.addSearchParam=ut})(COI||(COI={}));function clearNode(ct){for(;ct.firstChild;)ct.firstChild.remove()}function isInDOM(ct){var nt;return(nt=ct==null?void 0:ct.isConnected)!==null&&nt!==void 0?nt:!1}class DomListener{constructor(nt,ot,rt,ut){this._node=nt,this._type=ot,this._handler=rt,this._options=ut||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function addDisposableListener(ct,nt,ot,rt){return new DomListener(ct,nt,ot,rt)}function _wrapAsStandardMouseEvent(ct){return function(nt){return ct(new StandardMouseEvent(nt))}}function _wrapAsStandardKeyboardEvent(ct){return function(nt){return ct(new StandardKeyboardEvent(nt))}}const addStandardDisposableListener=function(nt,ot,rt,ut){let gt=rt;return ot==="click"||ot==="mousedown"?gt=_wrapAsStandardMouseEvent(rt):(ot==="keydown"||ot==="keypress"||ot==="keyup")&&(gt=_wrapAsStandardKeyboardEvent(rt)),addDisposableListener(nt,ot,gt,ut)},addStandardDisposableGenericMouseDownListener=function(nt,ot,rt){const ut=_wrapAsStandardMouseEvent(ot);return addDisposableGenericMouseDownListener(nt,ut,rt)};function addDisposableGenericMouseDownListener(ct,nt,ot){return addDisposableListener(ct,isIOS&&BrowserFeatures.pointerEvents?EventType$1.POINTER_DOWN:EventType$1.MOUSE_DOWN,nt,ot)}let runAtThisOrScheduleAtNextAnimationFrame,scheduleAtNextAnimationFrame;class AnimationFrameQueueItem{constructor(nt,ot=0){this._runner=nt,this.priority=ot,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(nt){onUnexpectedError(nt)}}static sort(nt,ot){return ot.priority-nt.priority}}(function(){let ct=[],nt=null,ot=!1,rt=!1;const ut=()=>{for(ot=!1,nt=ct,ct=[],rt=!0;nt.length>0;)nt.sort(AnimationFrameQueueItem.sort),nt.shift().execute();rt=!1};scheduleAtNextAnimationFrame=(gt,pt=0)=>{const mt=new AnimationFrameQueueItem(gt,pt);return ct.push(mt),ot||(ot=!0,requestAnimationFrame(ut)),mt},runAtThisOrScheduleAtNextAnimationFrame=(gt,pt)=>{if(rt){const mt=new AnimationFrameQueueItem(gt,pt);return nt.push(mt),mt}else return scheduleAtNextAnimationFrame(gt,pt)}})();function getComputedStyle$1(ct){return document.defaultView.getComputedStyle(ct,null)}function getClientArea(ct){if(ct!==document.body)return new Dimension(ct.clientWidth,ct.clientHeight);if(isIOS&&window.visualViewport)return new Dimension(window.visualViewport.width,window.visualViewport.height);if(window.innerWidth&&window.innerHeight)return new Dimension(window.innerWidth,window.innerHeight);if(document.body&&document.body.clientWidth&&document.body.clientHeight)return new Dimension(document.body.clientWidth,document.body.clientHeight);if(document.documentElement&&document.documentElement.clientWidth&&document.documentElement.clientHeight)return new Dimension(document.documentElement.clientWidth,document.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class SizeUtils{static convertToPixels(nt,ot){return parseFloat(ot)||0}static getDimension(nt,ot,rt){const ut=getComputedStyle$1(nt),gt=ut?ut.getPropertyValue(ot):"0";return SizeUtils.convertToPixels(nt,gt)}static getBorderLeftWidth(nt){return SizeUtils.getDimension(nt,"border-left-width","borderLeftWidth")}static getBorderRightWidth(nt){return SizeUtils.getDimension(nt,"border-right-width","borderRightWidth")}static getBorderTopWidth(nt){return SizeUtils.getDimension(nt,"border-top-width","borderTopWidth")}static getBorderBottomWidth(nt){return SizeUtils.getDimension(nt,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(nt){return SizeUtils.getDimension(nt,"padding-left","paddingLeft")}static getPaddingRight(nt){return SizeUtils.getDimension(nt,"padding-right","paddingRight")}static getPaddingTop(nt){return SizeUtils.getDimension(nt,"padding-top","paddingTop")}static getPaddingBottom(nt){return SizeUtils.getDimension(nt,"padding-bottom","paddingBottom")}static getMarginLeft(nt){return SizeUtils.getDimension(nt,"margin-left","marginLeft")}static getMarginTop(nt){return SizeUtils.getDimension(nt,"margin-top","marginTop")}static getMarginRight(nt){return SizeUtils.getDimension(nt,"margin-right","marginRight")}static getMarginBottom(nt){return SizeUtils.getDimension(nt,"margin-bottom","marginBottom")}}class Dimension{constructor(nt,ot){this.width=nt,this.height=ot}with(nt=this.width,ot=this.height){return nt!==this.width||ot!==this.height?new Dimension(nt,ot):this}static is(nt){return typeof nt=="object"&&typeof nt.height=="number"&&typeof nt.width=="number"}static lift(nt){return nt instanceof Dimension?nt:new Dimension(nt.width,nt.height)}static equals(nt,ot){return nt===ot?!0:!nt||!ot?!1:nt.width===ot.width&&nt.height===ot.height}}Dimension.None=new Dimension(0,0);function getTopLeftOffset(ct){let nt=ct.offsetParent,ot=ct.offsetTop,rt=ct.offsetLeft;for(;(ct=ct.parentNode)!==null&&ct!==document.body&&ct!==document.documentElement;){ot-=ct.scrollTop;const ut=isShadowRoot(ct)?null:getComputedStyle$1(ct);ut&&(rt-=ut.direction!=="rtl"?ct.scrollLeft:-ct.scrollLeft),ct===nt&&(rt+=SizeUtils.getBorderLeftWidth(ct),ot+=SizeUtils.getBorderTopWidth(ct),ot+=ct.offsetTop,rt+=ct.offsetLeft,nt=ct.offsetParent)}return{left:rt,top:ot}}function size(ct,nt,ot){typeof nt=="number"&&(ct.style.width=`${nt}px`),typeof ot=="number"&&(ct.style.height=`${ot}px`)}function getDomNodePagePosition(ct){const nt=ct.getBoundingClientRect();return{left:nt.left+window.scrollX,top:nt.top+window.scrollY,width:nt.width,height:nt.height}}function getDomNodeZoomLevel(ct){let nt=ct,ot=1;do{const rt=getComputedStyle$1(nt).zoom;rt!=null&&rt!=="1"&&(ot*=rt),nt=nt.parentElement}while(nt!==null&&nt!==document.documentElement);return ot}function getTotalWidth(ct){const nt=SizeUtils.getMarginLeft(ct)+SizeUtils.getMarginRight(ct);return ct.offsetWidth+nt}function getContentWidth(ct){const nt=SizeUtils.getBorderLeftWidth(ct)+SizeUtils.getBorderRightWidth(ct),ot=SizeUtils.getPaddingLeft(ct)+SizeUtils.getPaddingRight(ct);return ct.offsetWidth-nt-ot}function getContentHeight(ct){const nt=SizeUtils.getBorderTopWidth(ct)+SizeUtils.getBorderBottomWidth(ct),ot=SizeUtils.getPaddingTop(ct)+SizeUtils.getPaddingBottom(ct);return ct.offsetHeight-nt-ot}function getTotalHeight(ct){const nt=SizeUtils.getMarginTop(ct)+SizeUtils.getMarginBottom(ct);return ct.offsetHeight+nt}function isAncestor$1(ct,nt){for(;ct;){if(ct===nt)return!0;ct=ct.parentNode}return!1}function findParentWithClass(ct,nt,ot){for(;ct&&ct.nodeType===ct.ELEMENT_NODE;){if(ct.classList.contains(nt))return ct;if(ot){if(typeof ot=="string"){if(ct.classList.contains(ot))return null}else if(ct===ot)return null}ct=ct.parentNode}return null}function hasParentWithClass(ct,nt,ot){return!!findParentWithClass(ct,nt,ot)}function isShadowRoot(ct){return ct&&!!ct.host&&!!ct.mode}function isInShadowDOM(ct){return!!getShadowRoot(ct)}function getShadowRoot(ct){for(;ct.parentNode;){if(ct===document.body)return null;ct=ct.parentNode}return isShadowRoot(ct)?ct:null}function getActiveElement(){let ct=document.activeElement;for(;ct!=null&&ct.shadowRoot;)ct=ct.shadowRoot.activeElement;return ct}function createStyleSheet(ct=document.getElementsByTagName("head")[0],nt){const ot=document.createElement("style");return ot.type="text/css",ot.media="screen",nt==null||nt(ot),ct.appendChild(ot),ot}let _sharedStyleSheet=null;function getSharedStyleSheet(){return _sharedStyleSheet||(_sharedStyleSheet=createStyleSheet()),_sharedStyleSheet}function getDynamicStyleSheetRules(ct){var nt,ot;return!((nt=ct==null?void 0:ct.sheet)===null||nt===void 0)&&nt.rules?ct.sheet.rules:!((ot=ct==null?void 0:ct.sheet)===null||ot===void 0)&&ot.cssRules?ct.sheet.cssRules:[]}function createCSSRule(ct,nt,ot=getSharedStyleSheet()){!ot||!nt||ot.sheet.insertRule(ct+"{"+nt+"}",0)}function removeCSSRulesContainingSelector(ct,nt=getSharedStyleSheet()){if(!nt)return;const ot=getDynamicStyleSheetRules(nt),rt=[];for(let ut=0;ut<ot.length;ut++)ot[ut].selectorText.indexOf(ct)!==-1&&rt.push(ut);for(let ut=rt.length-1;ut>=0;ut--)nt.sheet.deleteRule(rt[ut])}function isHTMLElement(ct){return typeof HTMLElement=="object"?ct instanceof HTMLElement:ct&&typeof ct=="object"&&ct.nodeType===1&&typeof ct.nodeName=="string"}const EventType$1={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:isWebKit?"webkitAnimationStart":"animationstart",ANIMATION_END:isWebKit?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:isWebKit?"webkitAnimationIteration":"animationiteration"};function isEventLike(ct){const nt=ct;return!!(nt&&typeof nt.preventDefault=="function"&&typeof nt.stopPropagation=="function")}const EventHelper={stop:(ct,nt)=>(ct.preventDefault(),nt&&ct.stopPropagation(),ct)};function saveParentsScrollTop(ct){const nt=[];for(let ot=0;ct&&ct.nodeType===ct.ELEMENT_NODE;ot++)nt[ot]=ct.scrollTop,ct=ct.parentNode;return nt}function restoreParentsScrollTop(ct,nt){for(let ot=0;ct&&ct.nodeType===ct.ELEMENT_NODE;ot++)ct.scrollTop!==nt[ot]&&(ct.scrollTop=nt[ot]),ct=ct.parentNode}class FocusTracker extends Disposable{static hasFocusWithin(nt){const ot=getShadowRoot(nt),rt=ot?ot.activeElement:document.activeElement;return isAncestor$1(rt,nt)}constructor(nt){super(),this._onDidFocus=this._register(new Emitter$2),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new Emitter$2),this.onDidBlur=this._onDidBlur.event;let ot=FocusTracker.hasFocusWithin(nt),rt=!1;const ut=()=>{rt=!1,ot||(ot=!0,this._onDidFocus.fire())},gt=()=>{ot&&(rt=!0,window.setTimeout(()=>{rt&&(rt=!1,ot=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{FocusTracker.hasFocusWithin(nt)!==ot&&(ot?gt():ut())},this._register(addDisposableListener(nt,EventType$1.FOCUS,ut,!0)),this._register(addDisposableListener(nt,EventType$1.BLUR,gt,!0)),this._register(addDisposableListener(nt,EventType$1.FOCUS_IN,()=>this._refreshStateHandler())),this._register(addDisposableListener(nt,EventType$1.FOCUS_OUT,()=>this._refreshStateHandler()))}}function trackFocus(ct){return new FocusTracker(ct)}function append$1(ct,...nt){if(ct.append(...nt),nt.length===1&&typeof nt[0]!="string")return nt[0]}function prepend$1(ct,nt){return ct.insertBefore(nt,ct.firstChild),nt}function reset(ct,...nt){ct.innerText="",append$1(ct,...nt)}const SELECTOR_REGEX=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var Namespace;(function(ct){ct.HTML="http://www.w3.org/1999/xhtml",ct.SVG="http://www.w3.org/2000/svg"})(Namespace||(Namespace={}));function _$(ct,nt,ot,...rt){const ut=SELECTOR_REGEX.exec(nt);if(!ut)throw new Error("Bad use of emmet");const gt=ut[1]||"div";let pt;return ct!==Namespace.HTML?pt=document.createElementNS(ct,gt):pt=document.createElement(gt),ut[3]&&(pt.id=ut[3]),ut[4]&&(pt.className=ut[4].replace(/\./g," ").trim()),ot&&Object.entries(ot).forEach(([mt,vt])=>{typeof vt>"u"||(/^on\w+$/.test(mt)?pt[mt]=vt:mt==="selected"?vt&&pt.setAttribute(mt,"true"):pt.setAttribute(mt,vt))}),pt.append(...rt),pt}function $$d(ct,nt,...ot){return _$(Namespace.HTML,ct,nt,...ot)}$$d.SVG=function(ct,nt,...ot){return _$(Namespace.SVG,ct,nt,...ot)};function setVisibility(ct,...nt){ct?show(...nt):hide(...nt)}function show(...ct){for(const nt of ct)nt.style.display="",nt.removeAttribute("aria-hidden")}function hide(...ct){for(const nt of ct)nt.style.display="none",nt.setAttribute("aria-hidden","true")}function computeScreenAwareSize(ct){const nt=window.devicePixelRatio*ct;return Math.max(1,Math.floor(nt))/window.devicePixelRatio}function windowOpenNoOpener(ct){window.open(ct,"_blank","noopener")}function animate(ct){const nt=()=>{ct(),ot=scheduleAtNextAnimationFrame(nt)};let ot=scheduleAtNextAnimationFrame(nt);return toDisposable(()=>ot.dispose())}RemoteAuthorities.setPreferredWebSchema(/^https:/.test(window.location.href)?"https":"http");function asCSSUrl(ct){return ct?`url('${FileAccess.uriToBrowserUri(ct).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function asCSSPropertyValue(ct){return`'${ct.replace(/'/g,"%27")}'`}function asCssValueWithDefault(ct,nt){if(ct!==void 0){const ot=ct.match(/^\s*var\((.+)\)$/);if(ot){const rt=ot[1].split(",",2);return rt.length===2&&(nt=asCssValueWithDefault(rt[1].trim(),nt)),`var(${rt[0]}, ${nt})`}return ct}return nt}function hookDomPurifyHrefAndSrcSanitizer(ct,nt=!1){const ot=document.createElement("a");return addHook("afterSanitizeAttributes",rt=>{for(const ut of["href","src"])if(rt.hasAttribute(ut)){const gt=rt.getAttribute(ut);if(ut==="href"&&gt.startsWith("#"))continue;if(ot.href=gt,!ct.includes(ot.protocol.replace(/:$/,""))){if(nt&&ut==="src"&&ot.href.startsWith("data:"))continue;rt.removeAttribute(ut)}}}),toDisposable(()=>{removeHook("afterSanitizeAttributes")})}const basicMarkupHtmlTags=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]);class ModifierKeyEmitter extends Emitter$2{constructor(){super(),this._subscriptions=new DisposableStore,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(addDisposableListener(window,"keydown",nt=>{if(nt.defaultPrevented)return;const ot=new StandardKeyboardEvent(nt);if(!(ot.keyCode===6&&nt.repeat)){if(nt.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(nt.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(nt.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(nt.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(ot.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=nt.altKey,this._keyStatus.ctrlKey=nt.ctrlKey,this._keyStatus.metaKey=nt.metaKey,this._keyStatus.shiftKey=nt.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=nt,this.fire(this._keyStatus))}},!0)),this._subscriptions.add(addDisposableListener(window,"keyup",nt=>{nt.defaultPrevented||(!nt.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!nt.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!nt.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!nt.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=nt.altKey,this._keyStatus.ctrlKey=nt.ctrlKey,this._keyStatus.metaKey=nt.metaKey,this._keyStatus.shiftKey=nt.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=nt,this.fire(this._keyStatus)))},!0)),this._subscriptions.add(addDisposableListener(document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),this._subscriptions.add(addDisposableListener(document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),this._subscriptions.add(addDisposableListener(document.body,"mousemove",nt=>{nt.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),this._subscriptions.add(addDisposableListener(window,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return ModifierKeyEmitter.instance||(ModifierKeyEmitter.instance=new ModifierKeyEmitter),ModifierKeyEmitter.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}class DragAndDropObserver extends Disposable{constructor(nt,ot){super(),this.element=nt,this.callbacks=ot,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this._register(addDisposableListener(this.element,EventType$1.DRAG_ENTER,nt=>{this.counter++,this.dragStartTime=nt.timeStamp,this.callbacks.onDragEnter(nt)})),this._register(addDisposableListener(this.element,EventType$1.DRAG_OVER,nt=>{var ot,rt;nt.preventDefault(),(rt=(ot=this.callbacks).onDragOver)===null||rt===void 0||rt.call(ot,nt,nt.timeStamp-this.dragStartTime)})),this._register(addDisposableListener(this.element,EventType$1.DRAG_LEAVE,nt=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave(nt))})),this._register(addDisposableListener(this.element,EventType$1.DRAG_END,nt=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd(nt)})),this._register(addDisposableListener(this.element,EventType$1.DROP,nt=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop(nt)}))}}const H_REGEX=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function h(ct,...nt){let ot,rt;Array.isArray(nt[0])?(ot={},rt=nt[0]):(ot=nt[0]||{},rt=nt[1]);const ut=H_REGEX.exec(ct);if(!ut||!ut.groups)throw new Error("Bad use of h");const gt=ut.groups.tag||"div",pt=document.createElement(gt);ut.groups.id&&(pt.id=ut.groups.id);const mt=[];if(ut.groups.class)for(const St of ut.groups.class.split("."))St!==""&&mt.push(St);if(ot.className!==void 0)for(const St of ot.className.split("."))St!==""&&mt.push(St);mt.length>0&&(pt.className=mt.join(" "));const vt={};if(ut.groups.name&&(vt[ut.groups.name]=pt),rt)for(const St of rt)St instanceof HTMLElement?pt.appendChild(St):typeof St=="string"?pt.append(St):(Object.assign(vt,St),pt.appendChild(St.root));for(const[St,yt]of Object.entries(ot))if(St!=="className")if(St==="style")for(const[wt,Lt]of Object.entries(yt))pt.style.setProperty(camelCaseToHyphenCase(wt),typeof Lt=="number"?Lt+"px":""+Lt);else St==="tabIndex"?pt.tabIndex=yt:pt.setAttribute(camelCaseToHyphenCase(St),yt.toString());return vt.root=pt,vt}function camelCaseToHyphenCase(ct){return ct.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}const aria="",MAX_MESSAGE_LENGTH=2e4;let ariaContainer,alertContainer,alertContainer2,statusContainer,statusContainer2;function setARIAContainer(ct){ariaContainer=document.createElement("div"),ariaContainer.className="monaco-aria-container";const nt=()=>{const rt=document.createElement("div");return rt.className="monaco-alert",rt.setAttribute("role","alert"),rt.setAttribute("aria-atomic","true"),ariaContainer.appendChild(rt),rt};alertContainer=nt(),alertContainer2=nt();const ot=()=>{const rt=document.createElement("div");return rt.className="monaco-status",rt.setAttribute("role","complementary"),rt.setAttribute("aria-live","polite"),rt.setAttribute("aria-atomic","true"),ariaContainer.appendChild(rt),rt};statusContainer=ot(),statusContainer2=ot(),ct.appendChild(ariaContainer)}function alert(ct){ariaContainer&&(alertContainer.textContent!==ct?(clearNode(alertContainer2),insertMessage(alertContainer,ct)):(clearNode(alertContainer),insertMessage(alertContainer2,ct)))}function status(ct){ariaContainer&&(isMacintosh?alert(ct):statusContainer.textContent!==ct?(clearNode(statusContainer2),insertMessage(statusContainer,ct)):(clearNode(statusContainer),insertMessage(statusContainer2,ct)))}function insertMessage(ct,nt){clearNode(ct),nt.length>MAX_MESSAGE_LENGTH&&(nt=nt.substr(0,MAX_MESSAGE_LENGTH)),ct.textContent=nt,ct.style.visibility="hidden",ct.style.visibility="visible"}const IMarkerDecorationsService=createDecorator("markerDecorationsService"),ITextModelService=createDecorator("textModelService");var __awaiter$1q=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class Action extends Disposable{constructor(nt,ot="",rt="",ut=!0,gt){super(),this._onDidChange=this._register(new Emitter$2),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=nt,this._label=ot,this._cssClass=rt,this._enabled=ut,this._actionCallback=gt}get id(){return this._id}get label(){return this._label}set label(nt){this._setLabel(nt)}_setLabel(nt){this._label!==nt&&(this._label=nt,this._onDidChange.fire({label:nt}))}get tooltip(){return this._tooltip||""}set tooltip(nt){this._setTooltip(nt)}_setTooltip(nt){this._tooltip!==nt&&(this._tooltip=nt,this._onDidChange.fire({tooltip:nt}))}get class(){return this._cssClass}set class(nt){this._setClass(nt)}_setClass(nt){this._cssClass!==nt&&(this._cssClass=nt,this._onDidChange.fire({class:nt}))}get enabled(){return this._enabled}set enabled(nt){this._setEnabled(nt)}_setEnabled(nt){this._enabled!==nt&&(this._enabled=nt,this._onDidChange.fire({enabled:nt}))}get checked(){return this._checked}set checked(nt){this._setChecked(nt)}_setChecked(nt){this._checked!==nt&&(this._checked=nt,this._onDidChange.fire({checked:nt}))}run(nt,ot){return __awaiter$1q(this,void 0,void 0,function*(){this._actionCallback&&(yield this._actionCallback(nt))})}}class ActionRunner extends Disposable{constructor(){super(...arguments),this._onWillRun=this._register(new Emitter$2),this.onWillRun=this._onWillRun.event,this._onDidRun=this._register(new Emitter$2),this.onDidRun=this._onDidRun.event}run(nt,ot){return __awaiter$1q(this,void 0,void 0,function*(){if(!nt.enabled)return;this._onWillRun.fire({action:nt});let rt;try{yield this.runAction(nt,ot)}catch(ut){rt=ut}this._onDidRun.fire({action:nt,error:rt})})}runAction(nt,ot){return __awaiter$1q(this,void 0,void 0,function*(){yield nt.run(ot)})}}class Separator{constructor(){this.id=Separator.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...nt){let ot=[];for(const rt of nt)rt.length&&(ot.length?ot=[...ot,new Separator,...rt]:ot=rt);return ot}run(){return __awaiter$1q(this,void 0,void 0,function*(){})}}Separator.ID="vs.actions.separator";class SubmenuAction{get actions(){return this._actions}constructor(nt,ot,rt,ut){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=nt,this.label=ot,this.class=ut,this._actions=rt}run(){return __awaiter$1q(this,void 0,void 0,function*(){})}}class EmptySubmenuAction extends Action{constructor(){super(EmptySubmenuAction.ID,localize("submenu.empty","(empty)"),void 0,!1)}}EmptySubmenuAction.ID="vs.actions.empty";function toAction(ct){var nt,ot;return{id:ct.id,label:ct.label,class:void 0,enabled:(nt=ct.enabled)!==null&&nt!==void 0?nt:!0,checked:(ot=ct.checked)!==null&&ot!==void 0?ot:!1,run:()=>__awaiter$1q(this,void 0,void 0,function*(){return ct.run()}),tooltip:ct.label}}var ThemeColor;(function(ct){function nt(ot){return ot&&typeof ot=="object"&&typeof ot.id=="string"}ct.isThemeColor=nt})(ThemeColor||(ThemeColor={}));var ThemeIcon;(function(ct){ct.iconNameSegment="[A-Za-z0-9]+",ct.iconNameExpression="[A-Za-z0-9-]+",ct.iconModifierExpression="~[A-Za-z]+",ct.iconNameCharacter="[A-Za-z0-9~-]";const nt=new RegExp(`^(${ct.iconNameExpression})(${ct.iconModifierExpression})?$`);function ot(Lt){const xt=nt.exec(Lt.id);if(!xt)return ot(Codicon.error);const[,It,kt]=xt,At=["codicon","codicon-"+It];return kt&&At.push("codicon-modifier-"+kt.substring(1)),At}ct.asClassNameArray=ot;function rt(Lt){return ot(Lt).join(" ")}ct.asClassName=rt;function ut(Lt){return"."+ot(Lt).join(".")}ct.asCSSSelector=ut;function gt(Lt){return Lt&&typeof Lt=="object"&&typeof Lt.id=="string"&&(typeof Lt.color>"u"||ThemeColor.isThemeColor(Lt.color))}ct.isThemeIcon=gt;const pt=new RegExp(`^\\$\\((${ct.iconNameExpression}(?:${ct.iconModifierExpression})?)\\)$`);function mt(Lt){const xt=pt.exec(Lt);if(!xt)return;const[,It]=xt;return{id:It}}ct.fromString=mt;function vt(Lt){return{id:Lt}}ct.fromId=vt;function St(Lt,xt){let It=Lt.id;const kt=It.lastIndexOf("~");return kt!==-1&&(It=It.substring(0,kt)),xt&&(It=`${It}~${xt}`),{id:It}}ct.modify=St;function yt(Lt){const xt=Lt.id.lastIndexOf("~");if(xt!==-1)return Lt.id.substring(xt+1)}ct.getModifier=yt;function wt(Lt,xt){var It,kt;return Lt.id===xt.id&&((It=Lt.color)===null||It===void 0?void 0:It.id)===((kt=xt.color)===null||kt===void 0?void 0:kt.id)}ct.isEqual=wt})(ThemeIcon||(ThemeIcon={}));const ICommandService=createDecorator("commandService"),CommandsRegistry=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new Emitter$2,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(ct,nt){if(!ct)throw new Error("invalid command");if(typeof ct=="string"){if(!nt)throw new Error("invalid command");return this.registerCommand({id:ct,handler:nt})}if(ct.description){const pt=[];for(const vt of ct.description.args)pt.push(vt.constraint);const mt=ct.handler;ct.handler=function(vt,...St){return validateConstraints(St,pt),mt(vt,...St)}}const{id:ot}=ct;let rt=this._commands.get(ot);rt||(rt=new LinkedList,this._commands.set(ot,rt));const ut=rt.unshift(ct),gt=toDisposable(()=>{ut();const pt=this._commands.get(ot);pt!=null&&pt.isEmpty()&&this._commands.delete(ot)});return this._onDidRegisterCommand.fire(ot),gt}registerCommandAlias(ct,nt){return CommandsRegistry.registerCommand(ct,(ot,...rt)=>ot.get(ICommandService).executeCommand(nt,...rt))}getCommand(ct){const nt=this._commands.get(ct);if(!(!nt||nt.isEmpty()))return Iterable.first(nt)}getCommands(){const ct=new Map;for(const nt of this._commands.keys()){const ot=this.getCommand(nt);ot&&ct.set(nt,ot)}return ct}};CommandsRegistry.registerCommand("noop",()=>{});class KeybindingsRegistryImpl{constructor(){this._coreKeybindings=new LinkedList,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(nt){if(OS===1){if(nt&&nt.win)return nt.win}else if(OS===2){if(nt&&nt.mac)return nt.mac}else if(nt&&nt.linux)return nt.linux;return nt}registerKeybindingRule(nt){const ot=KeybindingsRegistryImpl.bindToCurrentPlatform(nt),rt=new DisposableStore;if(ot&&ot.primary){const ut=decodeKeybinding(ot.primary,OS);ut&&rt.add(this._registerDefaultKeybinding(ut,nt.id,nt.args,nt.weight,0,nt.when))}if(ot&&Array.isArray(ot.secondary))for(let ut=0,gt=ot.secondary.length;ut<gt;ut++){const pt=ot.secondary[ut],mt=decodeKeybinding(pt,OS);mt&&rt.add(this._registerDefaultKeybinding(mt,nt.id,nt.args,nt.weight,-ut-1,nt.when))}return rt}registerCommandAndKeybindingRule(nt){return combinedDisposable(this.registerKeybindingRule(nt),CommandsRegistry.registerCommand(nt))}_registerDefaultKeybinding(nt,ot,rt,ut,gt,pt){const mt=this._coreKeybindings.push({keybinding:nt,command:ot,commandArgs:rt,when:pt,weight1:ut,weight2:gt,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,toDisposable(()=>{mt(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(sorter)),this._cachedMergedKeybindings.slice(0)}}const KeybindingsRegistry=new KeybindingsRegistryImpl,Extensions$6={EditorModes:"platform.keybindingsRegistry"};Registry.add(Extensions$6.EditorModes,KeybindingsRegistry);function sorter(ct,nt){if(ct.weight1!==nt.weight1)return ct.weight1-nt.weight1;if(ct.command&&nt.command){if(ct.command<nt.command)return-1;if(ct.command>nt.command)return 1}return ct.weight2-nt.weight2}var __decorate$22=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1X=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__rest=globalThis&&globalThis.__rest||function(ct,nt){var ot={};for(var rt in ct)Object.prototype.hasOwnProperty.call(ct,rt)&&nt.indexOf(rt)<0&&(ot[rt]=ct[rt]);if(ct!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ut=0,rt=Object.getOwnPropertySymbols(ct);ut<rt.length;ut++)nt.indexOf(rt[ut])<0&&Object.prototype.propertyIsEnumerable.call(ct,rt[ut])&&(ot[rt[ut]]=ct[rt[ut]]);return ot};function isIMenuItem(ct){return ct.command!==void 0}function isISubmenuItem(ct){return ct.submenu!==void 0}class MenuId{constructor(nt){if(MenuId._instances.has(nt))throw new TypeError(`MenuId with identifier '${nt}' already exists. Use MenuId.for(ident) or a unique identifier`);MenuId._instances.set(nt,this),this.id=nt}}MenuId._instances=new Map;MenuId.CommandPalette=new MenuId("CommandPalette");MenuId.DebugBreakpointsContext=new MenuId("DebugBreakpointsContext");MenuId.DebugCallStackContext=new MenuId("DebugCallStackContext");MenuId.DebugConsoleContext=new MenuId("DebugConsoleContext");MenuId.DebugVariablesContext=new MenuId("DebugVariablesContext");MenuId.DebugWatchContext=new MenuId("DebugWatchContext");MenuId.DebugToolBar=new MenuId("DebugToolBar");MenuId.DebugToolBarStop=new MenuId("DebugToolBarStop");MenuId.EditorContext=new MenuId("EditorContext");MenuId.SimpleEditorContext=new MenuId("SimpleEditorContext");MenuId.EditorContent=new MenuId("EditorContent");MenuId.EditorLineNumberContext=new MenuId("EditorLineNumberContext");MenuId.EditorContextCopy=new MenuId("EditorContextCopy");MenuId.EditorContextPeek=new MenuId("EditorContextPeek");MenuId.EditorContextShare=new MenuId("EditorContextShare");MenuId.EditorTitle=new MenuId("EditorTitle");MenuId.EditorTitleRun=new MenuId("EditorTitleRun");MenuId.EditorTitleContext=new MenuId("EditorTitleContext");MenuId.EditorTitleContextShare=new MenuId("EditorTitleContextShare");MenuId.EmptyEditorGroup=new MenuId("EmptyEditorGroup");MenuId.EmptyEditorGroupContext=new MenuId("EmptyEditorGroupContext");MenuId.EditorTabsBarContext=new MenuId("EditorTabsBarContext");MenuId.ExplorerContext=new MenuId("ExplorerContext");MenuId.ExplorerContextShare=new MenuId("ExplorerContextShare");MenuId.ExtensionContext=new MenuId("ExtensionContext");MenuId.GlobalActivity=new MenuId("GlobalActivity");MenuId.CommandCenter=new MenuId("CommandCenter");MenuId.LayoutControlMenuSubmenu=new MenuId("LayoutControlMenuSubmenu");MenuId.LayoutControlMenu=new MenuId("LayoutControlMenu");MenuId.MenubarMainMenu=new MenuId("MenubarMainMenu");MenuId.MenubarAppearanceMenu=new MenuId("MenubarAppearanceMenu");MenuId.MenubarDebugMenu=new MenuId("MenubarDebugMenu");MenuId.MenubarEditMenu=new MenuId("MenubarEditMenu");MenuId.MenubarCopy=new MenuId("MenubarCopy");MenuId.MenubarFileMenu=new MenuId("MenubarFileMenu");MenuId.MenubarGoMenu=new MenuId("MenubarGoMenu");MenuId.MenubarHelpMenu=new MenuId("MenubarHelpMenu");MenuId.MenubarLayoutMenu=new MenuId("MenubarLayoutMenu");MenuId.MenubarNewBreakpointMenu=new MenuId("MenubarNewBreakpointMenu");MenuId.PanelAlignmentMenu=new MenuId("PanelAlignmentMenu");MenuId.PanelPositionMenu=new MenuId("PanelPositionMenu");MenuId.MenubarPreferencesMenu=new MenuId("MenubarPreferencesMenu");MenuId.MenubarRecentMenu=new MenuId("MenubarRecentMenu");MenuId.MenubarSelectionMenu=new MenuId("MenubarSelectionMenu");MenuId.MenubarShare=new MenuId("MenubarShare");MenuId.MenubarSwitchEditorMenu=new MenuId("MenubarSwitchEditorMenu");MenuId.MenubarSwitchGroupMenu=new MenuId("MenubarSwitchGroupMenu");MenuId.MenubarTerminalMenu=new MenuId("MenubarTerminalMenu");MenuId.MenubarViewMenu=new MenuId("MenubarViewMenu");MenuId.MenubarHomeMenu=new MenuId("MenubarHomeMenu");MenuId.OpenEditorsContext=new MenuId("OpenEditorsContext");MenuId.ProblemsPanelContext=new MenuId("ProblemsPanelContext");MenuId.SCMChangeContext=new MenuId("SCMChangeContext");MenuId.SCMResourceContext=new MenuId("SCMResourceContext");MenuId.SCMResourceFolderContext=new MenuId("SCMResourceFolderContext");MenuId.SCMResourceGroupContext=new MenuId("SCMResourceGroupContext");MenuId.SCMSourceControl=new MenuId("SCMSourceControl");MenuId.SCMTitle=new MenuId("SCMTitle");MenuId.SearchContext=new MenuId("SearchContext");MenuId.SearchActionMenu=new MenuId("SearchActionContext");MenuId.StatusBarWindowIndicatorMenu=new MenuId("StatusBarWindowIndicatorMenu");MenuId.StatusBarRemoteIndicatorMenu=new MenuId("StatusBarRemoteIndicatorMenu");MenuId.StickyScrollContext=new MenuId("StickyScrollContext");MenuId.TestItem=new MenuId("TestItem");MenuId.TestItemGutter=new MenuId("TestItemGutter");MenuId.TestPeekElement=new MenuId("TestPeekElement");MenuId.TestPeekTitle=new MenuId("TestPeekTitle");MenuId.TouchBarContext=new MenuId("TouchBarContext");MenuId.TitleBarContext=new MenuId("TitleBarContext");MenuId.TitleBarTitleContext=new MenuId("TitleBarTitleContext");MenuId.TunnelContext=new MenuId("TunnelContext");MenuId.TunnelPrivacy=new MenuId("TunnelPrivacy");MenuId.TunnelProtocol=new MenuId("TunnelProtocol");MenuId.TunnelPortInline=new MenuId("TunnelInline");MenuId.TunnelTitle=new MenuId("TunnelTitle");MenuId.TunnelLocalAddressInline=new MenuId("TunnelLocalAddressInline");MenuId.TunnelOriginInline=new MenuId("TunnelOriginInline");MenuId.ViewItemContext=new MenuId("ViewItemContext");MenuId.ViewContainerTitle=new MenuId("ViewContainerTitle");MenuId.ViewContainerTitleContext=new MenuId("ViewContainerTitleContext");MenuId.ViewTitle=new MenuId("ViewTitle");MenuId.ViewTitleContext=new MenuId("ViewTitleContext");MenuId.CommentEditorActions=new MenuId("CommentEditorActions");MenuId.CommentThreadTitle=new MenuId("CommentThreadTitle");MenuId.CommentThreadActions=new MenuId("CommentThreadActions");MenuId.CommentThreadAdditionalActions=new MenuId("CommentThreadAdditionalActions");MenuId.CommentThreadTitleContext=new MenuId("CommentThreadTitleContext");MenuId.CommentThreadCommentContext=new MenuId("CommentThreadCommentContext");MenuId.CommentTitle=new MenuId("CommentTitle");MenuId.CommentActions=new MenuId("CommentActions");MenuId.InteractiveToolbar=new MenuId("InteractiveToolbar");MenuId.InteractiveCellTitle=new MenuId("InteractiveCellTitle");MenuId.InteractiveCellDelete=new MenuId("InteractiveCellDelete");MenuId.InteractiveCellExecute=new MenuId("InteractiveCellExecute");MenuId.InteractiveInputExecute=new MenuId("InteractiveInputExecute");MenuId.NotebookToolbar=new MenuId("NotebookToolbar");MenuId.NotebookCellTitle=new MenuId("NotebookCellTitle");MenuId.NotebookCellDelete=new MenuId("NotebookCellDelete");MenuId.NotebookCellInsert=new MenuId("NotebookCellInsert");MenuId.NotebookCellBetween=new MenuId("NotebookCellBetween");MenuId.NotebookCellListTop=new MenuId("NotebookCellTop");MenuId.NotebookCellExecute=new MenuId("NotebookCellExecute");MenuId.NotebookCellExecutePrimary=new MenuId("NotebookCellExecutePrimary");MenuId.NotebookDiffCellInputTitle=new MenuId("NotebookDiffCellInputTitle");MenuId.NotebookDiffCellMetadataTitle=new MenuId("NotebookDiffCellMetadataTitle");MenuId.NotebookDiffCellOutputsTitle=new MenuId("NotebookDiffCellOutputsTitle");MenuId.NotebookOutputToolbar=new MenuId("NotebookOutputToolbar");MenuId.NotebookEditorLayoutConfigure=new MenuId("NotebookEditorLayoutConfigure");MenuId.NotebookKernelSource=new MenuId("NotebookKernelSource");MenuId.BulkEditTitle=new MenuId("BulkEditTitle");MenuId.BulkEditContext=new MenuId("BulkEditContext");MenuId.TimelineItemContext=new MenuId("TimelineItemContext");MenuId.TimelineTitle=new MenuId("TimelineTitle");MenuId.TimelineTitleContext=new MenuId("TimelineTitleContext");MenuId.TimelineFilterSubMenu=new MenuId("TimelineFilterSubMenu");MenuId.AccountsContext=new MenuId("AccountsContext");MenuId.PanelTitle=new MenuId("PanelTitle");MenuId.AuxiliaryBarTitle=new MenuId("AuxiliaryBarTitle");MenuId.TerminalInstanceContext=new MenuId("TerminalInstanceContext");MenuId.TerminalEditorInstanceContext=new MenuId("TerminalEditorInstanceContext");MenuId.TerminalNewDropdownContext=new MenuId("TerminalNewDropdownContext");MenuId.TerminalTabContext=new MenuId("TerminalTabContext");MenuId.TerminalTabEmptyAreaContext=new MenuId("TerminalTabEmptyAreaContext");MenuId.TerminalInlineTabContext=new MenuId("TerminalInlineTabContext");MenuId.WebviewContext=new MenuId("WebviewContext");MenuId.InlineCompletionsActions=new MenuId("InlineCompletionsActions");MenuId.NewFile=new MenuId("NewFile");MenuId.MergeInput1Toolbar=new MenuId("MergeToolbar1Toolbar");MenuId.MergeInput2Toolbar=new MenuId("MergeToolbar2Toolbar");MenuId.MergeBaseToolbar=new MenuId("MergeBaseToolbar");MenuId.MergeInputResultToolbar=new MenuId("MergeToolbarResultToolbar");MenuId.InlineSuggestionToolbar=new MenuId("InlineSuggestionToolbar");MenuId.InteractiveSessionContext=new MenuId("InteractiveSessionContext");MenuId.InteractiveSessionCodeBlock=new MenuId("InteractiveSessionCodeblock");MenuId.InteractiveSessionTitle=new MenuId("InteractiveSessionTitle");MenuId.InteractiveSessionExecute=new MenuId("InteractiveSessionExecute");const IMenuService=createDecorator("menuService");class MenuRegistryChangeEvent{static for(nt){let ot=this._all.get(nt);return ot||(ot=new MenuRegistryChangeEvent(nt),this._all.set(nt,ot)),ot}static merge(nt){const ot=new Set;for(const rt of nt)rt instanceof MenuRegistryChangeEvent&&ot.add(rt.id);return ot}constructor(nt){this.id=nt,this.has=ot=>ot===nt}}MenuRegistryChangeEvent._all=new Map;const MenuRegistry=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new MicrotaskEmitter({merge:MenuRegistryChangeEvent.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(ct){return this._commands.set(ct.id,ct),this._onDidChangeMenu.fire(MenuRegistryChangeEvent.for(MenuId.CommandPalette)),toDisposable(()=>{this._commands.delete(ct.id)&&this._onDidChangeMenu.fire(MenuRegistryChangeEvent.for(MenuId.CommandPalette))})}getCommand(ct){return this._commands.get(ct)}getCommands(){const ct=new Map;return this._commands.forEach((nt,ot)=>ct.set(ot,nt)),ct}appendMenuItem(ct,nt){let ot=this._menuItems.get(ct);ot||(ot=new LinkedList,this._menuItems.set(ct,ot));const rt=ot.push(nt);return this._onDidChangeMenu.fire(MenuRegistryChangeEvent.for(ct)),toDisposable(rt)}appendMenuItems(ct){const nt=new DisposableStore;for(const{id:ot,item:rt}of ct)nt.add(this.appendMenuItem(ot,rt));return nt}getMenuItems(ct){let nt;return this._menuItems.has(ct)?nt=[...this._menuItems.get(ct)]:nt=[],ct===MenuId.CommandPalette&&this._appendImplicitItems(nt),nt}_appendImplicitItems(ct){const nt=new Set;for(const ot of ct)isIMenuItem(ot)&&(nt.add(ot.command.id),ot.alt&&nt.add(ot.alt.id));this._commands.forEach((ot,rt)=>{nt.has(rt)||ct.push({command:ot})})}};class SubmenuItemAction extends SubmenuAction{constructor(nt,ot,rt){super(`submenuitem.${nt.submenu.id}`,typeof nt.title=="string"?nt.title:nt.title.value,rt,"submenu"),this.item=nt,this.hideActions=ot}}let MenuItemAction=class zo{static label(nt,ot){return ot!=null&&ot.renderShortTitle&&nt.shortTitle?typeof nt.shortTitle=="string"?nt.shortTitle:nt.shortTitle.value:typeof nt.title=="string"?nt.title:nt.title.value}constructor(nt,ot,rt,ut,gt,pt){var mt,vt;this.hideActions=ut,this._commandService=pt,this.id=nt.id,this.label=zo.label(nt,rt),this.tooltip=(vt=typeof nt.tooltip=="string"?nt.tooltip:(mt=nt.tooltip)===null||mt===void 0?void 0:mt.value)!==null&&vt!==void 0?vt:"",this.enabled=!nt.precondition||gt.contextMatchesRules(nt.precondition),this.checked=void 0;let St;if(nt.toggled){const yt=nt.toggled.condition?nt.toggled:{condition:nt.toggled};this.checked=gt.contextMatchesRules(yt.condition),this.checked&&yt.tooltip&&(this.tooltip=typeof yt.tooltip=="string"?yt.tooltip:yt.tooltip.value),this.checked&&ThemeIcon.isThemeIcon(yt.icon)&&(St=yt.icon),yt.title&&(this.label=typeof yt.title=="string"?yt.title:yt.title.value)}St||(St=ThemeIcon.isThemeIcon(nt.icon)?nt.icon:void 0),this.item=nt,this.alt=ot?new zo(ot,void 0,rt,ut,gt,pt):void 0,this._options=rt,this.class=St&&ThemeIcon.asClassName(St)}run(...nt){var ot,rt;let ut=[];return!((ot=this._options)===null||ot===void 0)&&ot.arg&&(ut=[...ut,this._options.arg]),!((rt=this._options)===null||rt===void 0)&&rt.shouldForwardArgs&&(ut=[...ut,...nt]),this._commandService.executeCommand(this.id,...ut)}};MenuItemAction=__decorate$22([__param$1X(4,IContextKeyService),__param$1X(5,ICommandService)],MenuItemAction);class Action2{constructor(nt){this.desc=nt}}function registerAction2(ct){const nt=new DisposableStore,ot=new ct,rt=ot.desc,{f1:ut,menu:gt,keybinding:pt,description:mt}=rt,vt=__rest(rt,["f1","menu","keybinding","description"]);if(nt.add(CommandsRegistry.registerCommand({id:vt.id,handler:(St,...yt)=>ot.run(St,...yt),description:mt})),Array.isArray(gt))for(const St of gt)nt.add(MenuRegistry.appendMenuItem(St.id,Object.assign({command:Object.assign(Object.assign({},vt),{precondition:St.precondition===null?void 0:vt.precondition})},St)));else gt&&nt.add(MenuRegistry.appendMenuItem(gt.id,Object.assign({command:Object.assign(Object.assign({},vt),{precondition:gt.precondition===null?void 0:vt.precondition})},gt)));if(ut&&(nt.add(MenuRegistry.appendMenuItem(MenuId.CommandPalette,{command:vt,when:vt.precondition})),nt.add(MenuRegistry.addCommand(vt))),Array.isArray(pt))for(const St of pt)nt.add(KeybindingsRegistry.registerKeybindingRule(Object.assign(Object.assign({},St),{id:vt.id,when:vt.precondition?ContextKeyExpr.and(vt.precondition,St.when):St.when})));else pt&&nt.add(KeybindingsRegistry.registerKeybindingRule(Object.assign(Object.assign({},pt),{id:vt.id,when:vt.precondition?ContextKeyExpr.and(vt.precondition,pt.when):pt.when})));return nt}const ITelemetryService=createDecorator("telemetryService");class Command{constructor(nt){this.id=nt.id,this.precondition=nt.precondition,this._kbOpts=nt.kbOpts,this._menuOpts=nt.menuOpts,this._description=nt.description}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const nt=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const ot of nt){let rt=ot.kbExpr;this.precondition&&(rt?rt=ContextKeyExpr.and(rt,this.precondition):rt=this.precondition);const ut={id:this.id,weight:ot.weight,args:ot.args,when:rt,primary:ot.primary,secondary:ot.secondary,win:ot.win,linux:ot.linux,mac:ot.mac};KeybindingsRegistry.registerKeybindingRule(ut)}}CommandsRegistry.registerCommand({id:this.id,handler:(nt,ot)=>this.runCommand(nt,ot),description:this._description})}_registerMenuItem(nt){MenuRegistry.appendMenuItem(nt.menuId,{group:nt.group,command:{id:this.id,title:nt.title,icon:nt.icon,precondition:this.precondition},when:nt.when,order:nt.order})}}class MultiCommand extends Command{constructor(){super(...arguments),this._implementations=[]}addImplementation(nt,ot,rt){return this._implementations.push({priority:nt,name:ot,implementation:rt}),this._implementations.sort((ut,gt)=>gt.priority-ut.priority),{dispose:()=>{for(let ut=0;ut<this._implementations.length;ut++)if(this._implementations[ut].implementation===rt){this._implementations.splice(ut,1);return}}}}runCommand(nt,ot){const rt=nt.get(ILogService);rt.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const ut of this._implementations){const gt=ut.implementation(nt,ot);if(gt)return rt.trace(`Command '${this.id}' was handled by '${ut.name}'.`),typeof gt=="boolean"?void 0:gt}rt.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class ProxyCommand extends Command{constructor(nt,ot){super(ot),this.command=nt}runCommand(nt,ot){return this.command.runCommand(nt,ot)}}class EditorCommand extends Command{static bindToContribution(nt){return class extends EditorCommand{constructor(rt){super(rt),this._callback=rt.handler}runEditorCommand(rt,ut,gt){const pt=nt(ut);pt&&this._callback(pt,gt)}}}static runEditorCommand(nt,ot,rt,ut){const gt=nt.get(ICodeEditorService),pt=gt.getFocusedCodeEditor()||gt.getActiveCodeEditor();if(pt)return pt.invokeWithinContext(mt=>{if(mt.get(IContextKeyService).contextMatchesRules(withNullAsUndefined(rt)))return ut(mt,pt,ot)})}runCommand(nt,ot){return EditorCommand.runEditorCommand(nt,ot,this.precondition,(rt,ut,gt)=>this.runEditorCommand(rt,ut,gt))}}class EditorAction extends EditorCommand{static convertOptions(nt){let ot;Array.isArray(nt.menuOpts)?ot=nt.menuOpts:nt.menuOpts?ot=[nt.menuOpts]:ot=[];function rt(ut){return ut.menuId||(ut.menuId=MenuId.EditorContext),ut.title||(ut.title=nt.label),ut.when=ContextKeyExpr.and(nt.precondition,ut.when),ut}return Array.isArray(nt.contextMenuOpts)?ot.push(...nt.contextMenuOpts.map(rt)):nt.contextMenuOpts&&ot.push(rt(nt.contextMenuOpts)),nt.menuOpts=ot,nt}constructor(nt){super(EditorAction.convertOptions(nt)),this.label=nt.label,this.alias=nt.alias}runEditorCommand(nt,ot,rt){return this.reportTelemetry(nt,ot),this.run(nt,ot,rt||{})}reportTelemetry(nt,ot){nt.get(ITelemetryService).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}class MultiEditorAction extends EditorAction{constructor(){super(...arguments),this._implementations=[]}addImplementation(nt,ot){return this._implementations.push([nt,ot]),this._implementations.sort((rt,ut)=>ut[0]-rt[0]),{dispose:()=>{for(let rt=0;rt<this._implementations.length;rt++)if(this._implementations[rt][1]===ot){this._implementations.splice(rt,1);return}}}}run(nt,ot,rt){for(const ut of this._implementations){const gt=ut[1](nt,ot,rt);if(gt)return typeof gt=="boolean"?void 0:gt}}}class EditorAction2 extends Action2{run(nt,...ot){const rt=nt.get(ICodeEditorService),ut=rt.getFocusedCodeEditor()||rt.getActiveCodeEditor();if(ut)return ut.invokeWithinContext(gt=>{if(gt.get(IContextKeyService).contextMatchesRules(withNullAsUndefined(this.desc.precondition)))return this.runEditorCommand(gt,ut,...ot)})}}function registerModelAndPositionCommand(ct,nt){CommandsRegistry.registerCommand(ct,function(ot,...rt){const ut=ot.get(IInstantiationService),[gt,pt]=rt;assertType(URI.isUri(gt)),assertType(Position$1.isIPosition(pt));const mt=ot.get(IModelService).getModel(gt);if(mt){const vt=Position$1.lift(pt);return ut.invokeFunction(nt,mt,vt,...rt.slice(2))}return ot.get(ITextModelService).createModelReference(gt).then(vt=>new Promise((St,yt)=>{try{const wt=ut.invokeFunction(nt,vt.object.textEditorModel,Position$1.lift(pt),rt.slice(2));St(wt)}catch(wt){yt(wt)}}).finally(()=>{vt.dispose()}))})}function registerEditorCommand(ct){return EditorContributionRegistry.INSTANCE.registerEditorCommand(ct),ct}function registerEditorAction(ct){const nt=new ct;return EditorContributionRegistry.INSTANCE.registerEditorAction(nt),nt}function registerMultiEditorAction(ct){return EditorContributionRegistry.INSTANCE.registerEditorAction(ct),ct}function registerInstantiatedEditorAction(ct){EditorContributionRegistry.INSTANCE.registerEditorAction(ct)}function registerEditorContribution(ct,nt,ot){EditorContributionRegistry.INSTANCE.registerEditorContribution(ct,nt,ot)}var EditorExtensionsRegistry;(function(ct){function nt(pt){return EditorContributionRegistry.INSTANCE.getEditorCommand(pt)}ct.getEditorCommand=nt;function ot(){return EditorContributionRegistry.INSTANCE.getEditorActions()}ct.getEditorActions=ot;function rt(){return EditorContributionRegistry.INSTANCE.getEditorContributions()}ct.getEditorContributions=rt;function ut(pt){return EditorContributionRegistry.INSTANCE.getEditorContributions().filter(mt=>pt.indexOf(mt.id)>=0)}ct.getSomeEditorContributions=ut;function gt(){return EditorContributionRegistry.INSTANCE.getDiffEditorContributions()}ct.getDiffEditorContributions=gt})(EditorExtensionsRegistry||(EditorExtensionsRegistry={}));const Extensions$5={EditorCommonContributions:"editor.contributions"};class EditorContributionRegistry{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(nt,ot,rt){this.editorContributions.push({id:nt,ctor:ot,instantiation:rt})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(nt){nt.register(),this.editorActions.push(nt)}getEditorActions(){return this.editorActions}registerEditorCommand(nt){nt.register(),this.editorCommands[nt.id]=nt}getEditorCommand(nt){return this.editorCommands[nt]||null}}EditorContributionRegistry.INSTANCE=new EditorContributionRegistry;Registry.add(Extensions$5.EditorCommonContributions,EditorContributionRegistry.INSTANCE);function registerCommand$3(ct){return ct.register(),ct}const UndoCommand=registerCommand$3(new MultiCommand({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"1_do",title:localize({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:MenuId.CommandPalette,group:"",title:localize("undo","Undo"),order:1}]}));registerCommand$3(new ProxyCommand(UndoCommand,{id:"default:undo",precondition:void 0}));const RedoCommand=registerCommand$3(new MultiCommand({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"1_do",title:localize({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:MenuId.CommandPalette,group:"",title:localize("redo","Redo"),order:1}]}));registerCommand$3(new ProxyCommand(RedoCommand,{id:"default:redo",precondition:void 0}));const SelectAllCommand=registerCommand$3(new MultiCommand({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:MenuId.MenubarSelectionMenu,group:"1_basic",title:localize({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:MenuId.CommandPalette,group:"",title:localize("selectAll","Select All"),order:1}]}));var __decorate$21=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1W=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let MarkerDecorationsContribution=class{constructor(nt,ot){}dispose(){}};MarkerDecorationsContribution.ID="editor.contrib.markerDecorations";MarkerDecorationsContribution=__decorate$21([__param$1W(1,IMarkerDecorationsService)],MarkerDecorationsContribution);registerEditorContribution(MarkerDecorationsContribution.ID,MarkerDecorationsContribution,0);const editor$1="";class ElementSizeObserver extends Disposable{constructor(nt,ot){super(),this._onDidChange=this._register(new Emitter$2),this.onDidChange=this._onDidChange.event,this._referenceDomElement=nt,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,ot)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){!this._resizeObserver&&this._referenceDomElement&&(this._resizeObserver=new ResizeObserver(nt=>{nt&&nt[0]&&nt[0].contentRect?this.observe({width:nt[0].contentRect.width,height:nt[0].contentRect.height}):this.observe()}),this._resizeObserver.observe(this._referenceDomElement))}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(nt){this.measureReferenceDomElement(!0,nt)}measureReferenceDomElement(nt,ot){let rt=0,ut=0;ot?(rt=ot.width,ut=ot.height):this._referenceDomElement&&(rt=this._referenceDomElement.clientWidth,ut=this._referenceDomElement.clientHeight),rt=Math.max(5,rt),ut=Math.max(5,ut),(this._width!==rt||this._height!==ut)&&(this._width=rt,this._height=ut,nt&&this._onDidChange.fire())}}class EditorSettingMigration{constructor(nt,ot){this.key=nt,this.migrate=ot}apply(nt){const ot=EditorSettingMigration._read(nt,this.key),rt=gt=>EditorSettingMigration._read(nt,gt),ut=(gt,pt)=>EditorSettingMigration._write(nt,gt,pt);this.migrate(ot,rt,ut)}static _read(nt,ot){if(typeof nt>"u")return;const rt=ot.indexOf(".");if(rt>=0){const ut=ot.substring(0,rt);return this._read(nt[ut],ot.substring(rt+1))}return nt[ot]}static _write(nt,ot,rt){const ut=ot.indexOf(".");if(ut>=0){const gt=ot.substring(0,ut);nt[gt]=nt[gt]||{},this._write(nt[gt],ot.substring(ut+1),rt);return}nt[ot]=rt}}EditorSettingMigration.items=[];function registerEditorSettingMigration(ct,nt){EditorSettingMigration.items.push(new EditorSettingMigration(ct,nt))}function registerSimpleEditorSettingMigration(ct,nt){registerEditorSettingMigration(ct,(ot,rt,ut)=>{if(typeof ot<"u"){for(const[gt,pt]of nt)if(ot===gt){ut(ct,pt);return}}})}function migrateOptions(ct){EditorSettingMigration.items.forEach(nt=>nt.apply(ct))}registerSimpleEditorSettingMigration("wordWrap",[[!0,"on"],[!1,"off"]]);registerSimpleEditorSettingMigration("lineNumbers",[[!0,"on"],[!1,"off"]]);registerSimpleEditorSettingMigration("cursorBlinking",[["visible","solid"]]);registerSimpleEditorSettingMigration("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);registerSimpleEditorSettingMigration("renderLineHighlight",[[!0,"line"],[!1,"none"]]);registerSimpleEditorSettingMigration("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);registerSimpleEditorSettingMigration("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);registerSimpleEditorSettingMigration("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);registerSimpleEditorSettingMigration("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);registerSimpleEditorSettingMigration("autoIndent",[[!1,"advanced"],[!0,"full"]]);registerSimpleEditorSettingMigration("matchBrackets",[[!0,"always"],[!1,"never"]]);registerSimpleEditorSettingMigration("renderFinalNewline",[[!0,"on"],[!1,"off"]]);registerSimpleEditorSettingMigration("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);registerEditorSettingMigration("autoClosingBrackets",(ct,nt,ot)=>{ct===!1&&(ot("autoClosingBrackets","never"),typeof nt("autoClosingQuotes")>"u"&&ot("autoClosingQuotes","never"),typeof nt("autoSurround")>"u"&&ot("autoSurround","never"))});registerEditorSettingMigration("renderIndentGuides",(ct,nt,ot)=>{typeof ct<"u"&&(ot("renderIndentGuides",void 0),typeof nt("guides.indentation")>"u"&&ot("guides.indentation",!!ct))});registerEditorSettingMigration("highlightActiveIndentGuide",(ct,nt,ot)=>{typeof ct<"u"&&(ot("highlightActiveIndentGuide",void 0),typeof nt("guides.highlightActiveIndentation")>"u"&&ot("guides.highlightActiveIndentation",!!ct))});const suggestFilteredTypesMapping={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};registerEditorSettingMigration("suggest.filteredTypes",(ct,nt,ot)=>{if(ct&&typeof ct=="object"){for(const rt of Object.entries(suggestFilteredTypesMapping))ct[rt[0]]===!1&&typeof nt(`suggest.${rt[1]}`)>"u"&&ot(`suggest.${rt[1]}`,!1);ot("suggest.filteredTypes",void 0)}});registerEditorSettingMigration("quickSuggestions",(ct,nt,ot)=>{if(typeof ct=="boolean"){const rt=ct?"on":"off";ot("quickSuggestions",{comments:rt,strings:rt,other:rt})}});registerEditorSettingMigration("experimental.stickyScroll.enabled",(ct,nt,ot)=>{typeof ct=="boolean"&&(ot("experimental.stickyScroll.enabled",void 0),typeof nt("stickyScroll.enabled")>"u"&&ot("stickyScroll.enabled",ct))});registerEditorSettingMigration("experimental.stickyScroll.maxLineCount",(ct,nt,ot)=>{typeof ct=="number"&&(ot("experimental.stickyScroll.maxLineCount",void 0),typeof nt("stickyScroll.maxLineCount")>"u"&&ot("stickyScroll.maxLineCount",ct))});class TabFocusImpl{constructor(){this._tabFocusTerminal=!1,this._tabFocusEditor=!1,this._onDidChangeTabFocus=new Emitter$2,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(nt){return nt==="terminalFocus"?this._tabFocusTerminal:this._tabFocusEditor}setTabFocusMode(nt,ot){ot==="terminalFocus"?this._tabFocusTerminal=nt:this._tabFocusEditor=nt,this._onDidChangeTabFocus.fire()}}const TabFocus=new TabFocusImpl;var __decorate$20=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1V=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let EditorConfiguration=class extends Disposable{constructor(nt,ot,rt,ut){super(),this._accessibilityService=ut,this._onDidChange=this._register(new Emitter$2),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new Emitter$2),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._glyphMarginDecorationLaneCount=1,this._computeOptionsMemory=new ComputeOptionsMemory,this.isSimpleWidget=nt,this._containerObserver=this._register(new ElementSizeObserver(rt,ot.dimension)),this._rawOptions=deepCloneAndMigrateOptions(ot),this._validatedOptions=EditorOptionsUtil.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(11)&&this._containerObserver.startObserving(),this._register(EditorZoom.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(TabFocus.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(FontMeasurements.onDidChange(()=>this._recomputeOptions())),this._register(PixelRatio.onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_recomputeOptions(){const nt=this._computeOptions(),ot=EditorOptionsUtil.checkEquals(this.options,nt);ot!==null&&(this.options=nt,this._onDidChangeFast.fire(ot),this._onDidChange.fire(ot))}_computeOptions(){const nt=this._readEnvConfiguration(),ot=BareFontInfo.createFromValidatedSettings(this._validatedOptions,nt.pixelRatio,this.isSimpleWidget),rt=this._readFontInfo(ot),ut={memory:this._computeOptionsMemory,outerWidth:nt.outerWidth,outerHeight:nt.outerHeight-this._reservedHeight,fontInfo:rt,extraEditorClassName:nt.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:nt.emptySelectionClipboard,pixelRatio:nt.pixelRatio,tabFocusMode:TabFocus.getTabFocusMode("editorFocus"),accessibilitySupport:nt.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return EditorOptionsUtil.computeOptions(this._validatedOptions,ut)}_readEnvConfiguration(){return{extraEditorClassName:getExtraEditorClassName(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:isWebKit||isFirefox,pixelRatio:PixelRatio.value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(nt){return FontMeasurements.readFontInfo(nt)}getRawOptions(){return this._rawOptions}updateOptions(nt){const ot=deepCloneAndMigrateOptions(nt);EditorOptionsUtil.applyUpdate(this._rawOptions,ot)&&(this._validatedOptions=EditorOptionsUtil.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(nt){this._containerObserver.observe(nt)}setIsDominatedByLongLines(nt){this._isDominatedByLongLines!==nt&&(this._isDominatedByLongLines=nt,this._recomputeOptions())}setModelLineCount(nt){const ot=digitCount(nt);this._lineNumbersDigitCount!==ot&&(this._lineNumbersDigitCount=ot,this._recomputeOptions())}setViewLineCount(nt){this._viewLineCount!==nt&&(this._viewLineCount=nt,this._recomputeOptions())}setReservedHeight(nt){this._reservedHeight!==nt&&(this._reservedHeight=nt,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(nt){this._glyphMarginDecorationLaneCount!==nt&&(this._glyphMarginDecorationLaneCount=nt,this._recomputeOptions())}};EditorConfiguration=__decorate$20([__param$1V(3,IAccessibilityService)],EditorConfiguration);function digitCount(ct){let nt=0;for(;ct;)ct=Math.floor(ct/10),nt++;return nt||1}function getExtraEditorClassName(){let ct="";return!isSafari&&!isWebkitWebView&&(ct+="no-user-select "),isSafari&&(ct+="no-minimap-shadow ",ct+="enable-user-select "),isMacintosh&&(ct+="mac "),ct}class ValidatedEditorOptions{constructor(){this._values=[]}_read(nt){return this._values[nt]}get(nt){return this._values[nt]}_write(nt,ot){this._values[nt]=ot}}class ComputedEditorOptions{constructor(){this._values=[]}_read(nt){if(nt>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[nt]}get(nt){return this._read(nt)}_write(nt,ot){this._values[nt]=ot}}class EditorOptionsUtil{static validateOptions(nt){const ot=new ValidatedEditorOptions;for(const rt of editorOptionsRegistry){const ut=rt.name==="_never_"?void 0:nt[rt.name];ot._write(rt.id,rt.validate(ut))}return ot}static computeOptions(nt,ot){const rt=new ComputedEditorOptions;for(const ut of editorOptionsRegistry)rt._write(ut.id,ut.compute(ot,rt,nt._read(ut.id)));return rt}static _deepEquals(nt,ot){if(typeof nt!="object"||typeof ot!="object"||!nt||!ot)return nt===ot;if(Array.isArray(nt)||Array.isArray(ot))return Array.isArray(nt)&&Array.isArray(ot)?equals$2(nt,ot):!1;if(Object.keys(nt).length!==Object.keys(ot).length)return!1;for(const rt in nt)if(!EditorOptionsUtil._deepEquals(nt[rt],ot[rt]))return!1;return!0}static checkEquals(nt,ot){const rt=[];let ut=!1;for(const gt of editorOptionsRegistry){const pt=!EditorOptionsUtil._deepEquals(nt._read(gt.id),ot._read(gt.id));rt[gt.id]=pt,pt&&(ut=!0)}return ut?new ConfigurationChangedEvent(rt):null}static applyUpdate(nt,ot){let rt=!1;for(const ut of editorOptionsRegistry)if(ot.hasOwnProperty(ut.name)){const gt=ut.applyUpdate(nt[ut.name],ot[ut.name]);nt[ut.name]=gt.newValue,rt=rt||gt.didChange}return rt}}function deepCloneAndMigrateOptions(ct){const nt=deepClone(ct);return migrateOptions(nt),nt}function memoize(ct,nt,ot){let rt=null,ut=null;if(typeof ot.value=="function"?(rt="value",ut=ot.value,ut.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof ot.get=="function"&&(rt="get",ut=ot.get),!ut)throw new Error("not supported");const gt=`$memoize$${nt}`;ot[rt]=function(...pt){return this.hasOwnProperty(gt)||Object.defineProperty(this,gt,{configurable:!1,enumerable:!1,writable:!1,value:ut.apply(this,pt)}),this[gt]}}var __decorate$1$=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},EventType;(function(ct){ct.Tap="-monaco-gesturetap",ct.Change="-monaco-gesturechange",ct.Start="-monaco-gesturestart",ct.End="-monaco-gesturesend",ct.Contextmenu="-monaco-gesturecontextmenu"})(EventType||(EventType={}));class Gesture extends Disposable{constructor(){super(),this.dispatched=!1,this.targets=new LinkedList,this.ignoreTargets=new LinkedList,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(addDisposableListener(document,"touchstart",nt=>this.onTouchStart(nt),{passive:!1})),this._register(addDisposableListener(document,"touchend",nt=>this.onTouchEnd(nt))),this._register(addDisposableListener(document,"touchmove",nt=>this.onTouchMove(nt),{passive:!1}))}static addTarget(nt){if(!Gesture.isTouchDevice())return Disposable.None;Gesture.INSTANCE||(Gesture.INSTANCE=new Gesture);const ot=Gesture.INSTANCE.targets.push(nt);return toDisposable(ot)}static ignoreTarget(nt){if(!Gesture.isTouchDevice())return Disposable.None;Gesture.INSTANCE||(Gesture.INSTANCE=new Gesture);const ot=Gesture.INSTANCE.ignoreTargets.push(nt);return toDisposable(ot)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(nt){const ot=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let rt=0,ut=nt.targetTouches.length;rt<ut;rt++){const gt=nt.targetTouches.item(rt);this.activeTouches[gt.identifier]={id:gt.identifier,initialTarget:gt.target,initialTimeStamp:ot,initialPageX:gt.pageX,initialPageY:gt.pageY,rollingTimestamps:[ot],rollingPageX:[gt.pageX],rollingPageY:[gt.pageY]};const pt=this.newGestureEvent(EventType.Start,gt.target);pt.pageX=gt.pageX,pt.pageY=gt.pageY,this.dispatchEvent(pt)}this.dispatched&&(nt.preventDefault(),nt.stopPropagation(),this.dispatched=!1)}onTouchEnd(nt){const ot=Date.now(),rt=Object.keys(this.activeTouches).length;for(let ut=0,gt=nt.changedTouches.length;ut<gt;ut++){const pt=nt.changedTouches.item(ut);if(!this.activeTouches.hasOwnProperty(String(pt.identifier))){console.warn("move of an UNKNOWN touch",pt);continue}const mt=this.activeTouches[pt.identifier],vt=Date.now()-mt.initialTimeStamp;if(vt<Gesture.HOLD_DELAY&&Math.abs(mt.initialPageX-tail(mt.rollingPageX))<30&&Math.abs(mt.initialPageY-tail(mt.rollingPageY))<30){const St=this.newGestureEvent(EventType.Tap,mt.initialTarget);St.pageX=tail(mt.rollingPageX),St.pageY=tail(mt.rollingPageY),this.dispatchEvent(St)}else if(vt>=Gesture.HOLD_DELAY&&Math.abs(mt.initialPageX-tail(mt.rollingPageX))<30&&Math.abs(mt.initialPageY-tail(mt.rollingPageY))<30){const St=this.newGestureEvent(EventType.Contextmenu,mt.initialTarget);St.pageX=tail(mt.rollingPageX),St.pageY=tail(mt.rollingPageY),this.dispatchEvent(St)}else if(rt===1){const St=tail(mt.rollingPageX),yt=tail(mt.rollingPageY),wt=tail(mt.rollingTimestamps)-mt.rollingTimestamps[0],Lt=St-mt.rollingPageX[0],xt=yt-mt.rollingPageY[0],It=[...this.targets].filter(kt=>mt.initialTarget instanceof Node&&kt.contains(mt.initialTarget));this.inertia(It,ot,Math.abs(Lt)/wt,Lt>0?1:-1,St,Math.abs(xt)/wt,xt>0?1:-1,yt)}this.dispatchEvent(this.newGestureEvent(EventType.End,mt.initialTarget)),delete this.activeTouches[pt.identifier]}this.dispatched&&(nt.preventDefault(),nt.stopPropagation(),this.dispatched=!1)}newGestureEvent(nt,ot){const rt=document.createEvent("CustomEvent");return rt.initEvent(nt,!1,!0),rt.initialTarget=ot,rt.tapCount=0,rt}dispatchEvent(nt){if(nt.type===EventType.Tap){const ot=new Date().getTime();let rt=0;ot-this._lastSetTapCountTime>Gesture.CLEAR_TAP_COUNT_TIME?rt=1:rt=2,this._lastSetTapCountTime=ot,nt.tapCount=rt}else(nt.type===EventType.Change||nt.type===EventType.Contextmenu)&&(this._lastSetTapCountTime=0);if(nt.initialTarget instanceof Node){for(const ot of this.ignoreTargets)if(ot.contains(nt.initialTarget))return;for(const ot of this.targets)ot.contains(nt.initialTarget)&&(ot.dispatchEvent(nt),this.dispatched=!0)}}inertia(nt,ot,rt,ut,gt,pt,mt,vt){this.handle=scheduleAtNextAnimationFrame(()=>{const St=Date.now(),yt=St-ot;let wt=0,Lt=0,xt=!0;rt+=Gesture.SCROLL_FRICTION*yt,pt+=Gesture.SCROLL_FRICTION*yt,rt>0&&(xt=!1,wt=ut*rt*yt),pt>0&&(xt=!1,Lt=mt*pt*yt);const It=this.newGestureEvent(EventType.Change);It.translationX=wt,It.translationY=Lt,nt.forEach(kt=>kt.dispatchEvent(It)),xt||this.inertia(nt,St,rt,ut,gt+wt,pt,mt,vt+Lt)})}onTouchMove(nt){const ot=Date.now();for(let rt=0,ut=nt.changedTouches.length;rt<ut;rt++){const gt=nt.changedTouches.item(rt);if(!this.activeTouches.hasOwnProperty(String(gt.identifier))){console.warn("end of an UNKNOWN touch",gt);continue}const pt=this.activeTouches[gt.identifier],mt=this.newGestureEvent(EventType.Change,pt.initialTarget);mt.translationX=gt.pageX-tail(pt.rollingPageX),mt.translationY=gt.pageY-tail(pt.rollingPageY),mt.pageX=gt.pageX,mt.pageY=gt.pageY,this.dispatchEvent(mt),pt.rollingPageX.length>3&&(pt.rollingPageX.shift(),pt.rollingPageY.shift(),pt.rollingTimestamps.shift()),pt.rollingPageX.push(gt.pageX),pt.rollingPageY.push(gt.pageY),pt.rollingTimestamps.push(ot)}this.dispatched&&(nt.preventDefault(),nt.stopPropagation(),this.dispatched=!1)}}Gesture.SCROLL_FRICTION=-.005;Gesture.HOLD_DELAY=700;Gesture.CLEAR_TAP_COUNT_TIME=400;__decorate$1$([memoize],Gesture,"isTouchDevice",null);class GlobalPointerMoveMonitor{constructor(){this._hooks=new DisposableStore,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(nt,ot){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const rt=this._onStopCallback;this._onStopCallback=null,nt&&rt&&rt(ot)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(nt,ot,rt,ut,gt){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=ut,this._onStopCallback=gt;let pt=nt;try{nt.setPointerCapture(ot),this._hooks.add(toDisposable(()=>{try{nt.releasePointerCapture(ot)}catch{}}))}catch{pt=window}this._hooks.add(addDisposableListener(pt,EventType$1.POINTER_MOVE,mt=>{if(mt.buttons!==rt){this.stopMonitoring(!0);return}mt.preventDefault(),this._pointerMoveCallback(mt)})),this._hooks.add(addDisposableListener(pt,EventType$1.POINTER_UP,mt=>this.stopMonitoring(!0)))}}function asCssVariableName(ct){return`--vscode-${ct.replace(/\./g,"-")}`}function asCssVariable(ct){return`var(${asCssVariableName(ct)})`}function asCssVariableWithDefault(ct,nt){return`var(${asCssVariableName(ct)}, ${nt})`}const Extensions$4={ColorContribution:"base.contributions.colors"};class ColorRegistry{constructor(){this._onDidChangeSchema=new Emitter$2,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(nt,ot,rt,ut=!1,gt){const pt={id:nt,description:rt,defaults:ot,needsTransparency:ut,deprecationMessage:gt};this.colorsById[nt]=pt;const mt={type:"string",description:rt,format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return gt&&(mt.deprecationMessage=gt),this.colorSchema.properties[nt]=mt,this.colorReferenceSchema.enum.push(nt),this.colorReferenceSchema.enumDescriptions.push(rt),this._onDidChangeSchema.fire(),nt}getColors(){return Object.keys(this.colorsById).map(nt=>this.colorsById[nt])}resolveDefaultColor(nt,ot){const rt=this.colorsById[nt];if(rt&&rt.defaults){const ut=rt.defaults[ot.type];return resolveColorValue(ut,ot)}}getColorSchema(){return this.colorSchema}toString(){const nt=(ot,rt)=>{const ut=ot.indexOf(".")===-1?0:1,gt=rt.indexOf(".")===-1?0:1;return ut!==gt?ut-gt:ot.localeCompare(rt)};return Object.keys(this.colorsById).sort(nt).map(ot=>`- \`${ot}\`: ${this.colorsById[ot].description}`).join(`
`)}}const colorRegistry$1=new ColorRegistry;Registry.add(Extensions$4.ColorContribution,colorRegistry$1);function registerColor(ct,nt,ot,rt,ut){return colorRegistry$1.registerColor(ct,nt,ot,rt,ut)}const foreground=registerColor("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},localize("foreground","Overall foreground color. This color is only used if not overridden by a component."));registerColor("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},localize("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component."));const errorForeground=registerColor("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},localize("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component."));registerColor("descriptionForeground",{light:"#717171",dark:transparent(foreground,.7),hcDark:transparent(foreground,.7),hcLight:transparent(foreground,.7)},localize("descriptionForeground","Foreground color for description text providing additional information, for example for a label."));const iconForeground=registerColor("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},localize("iconForeground","The default color for icons in the workbench.")),focusBorder=registerColor("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},localize("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),contrastBorder=registerColor("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},localize("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),activeContrastBorder=registerColor("contrastActiveBorder",{light:null,dark:null,hcDark:focusBorder,hcLight:focusBorder},localize("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast."));registerColor("selection.background",{light:null,dark:null,hcDark:null,hcLight:null},localize("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor."));registerColor("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:Color.black,hcLight:"#292929"},localize("textSeparatorForeground","Color for text separators."));const textLinkForeground=registerColor("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#3794FF",hcLight:"#0F4A85"},localize("textLinkForeground","Foreground color for links in text."));registerColor("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#3794FF",hcLight:"#0F4A85"},localize("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover."));registerColor("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#D7BA7D",hcLight:"#292929"},localize("textPreformatForeground","Foreground color for preformatted text segments."));registerColor("textBlockQuote.background",{light:"#7f7f7f1a",dark:"#7f7f7f1a",hcDark:null,hcLight:"#F2F2F2"},localize("textBlockQuoteBackground","Background color for block quotes in text."));registerColor("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:Color.white,hcLight:"#292929"},localize("textBlockQuoteBorder","Border color for block quotes in text."));registerColor("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:Color.black,hcLight:"#F2F2F2"},localize("textCodeBlockBackground","Background color for code blocks in text."));const widgetShadow=registerColor("widget.shadow",{dark:transparent(Color.black,.36),light:transparent(Color.black,.16),hcDark:null,hcLight:null},localize("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),widgetBorder=registerColor("widget.border",{dark:null,light:null,hcDark:contrastBorder,hcLight:contrastBorder},localize("widgetBorder","Border color of widgets such as find/replace inside the editor.")),inputBackground=registerColor("input.background",{dark:"#3C3C3C",light:Color.white,hcDark:Color.black,hcLight:Color.white},localize("inputBoxBackground","Input box background.")),inputForeground=registerColor("input.foreground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("inputBoxForeground","Input box foreground.")),inputBorder=registerColor("input.border",{dark:null,light:null,hcDark:contrastBorder,hcLight:contrastBorder},localize("inputBoxBorder","Input box border.")),inputActiveOptionBorder=registerColor("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:contrastBorder,hcLight:contrastBorder},localize("inputBoxActiveOptionBorder","Border color of activated options in input fields."));registerColor("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},localize("inputOption.hoverBackground","Background color of activated options in input fields."));const inputActiveOptionBackground=registerColor("inputOption.activeBackground",{dark:transparent(focusBorder,.4),light:transparent(focusBorder,.2),hcDark:Color.transparent,hcLight:Color.transparent},localize("inputOption.activeBackground","Background hover color of options in input fields.")),inputActiveOptionForeground=registerColor("inputOption.activeForeground",{dark:Color.white,light:Color.black,hcDark:foreground,hcLight:foreground},localize("inputOption.activeForeground","Foreground color of activated options in input fields."));registerColor("input.placeholderForeground",{light:transparent(foreground,.5),dark:transparent(foreground,.5),hcDark:transparent(foreground,.7),hcLight:transparent(foreground,.7)},localize("inputPlaceholderForeground","Input box foreground color for placeholder text."));const inputValidationInfoBackground=registerColor("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:Color.black,hcLight:Color.white},localize("inputValidationInfoBackground","Input validation background color for information severity.")),inputValidationInfoForeground=registerColor("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:foreground},localize("inputValidationInfoForeground","Input validation foreground color for information severity.")),inputValidationInfoBorder=registerColor("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:contrastBorder,hcLight:contrastBorder},localize("inputValidationInfoBorder","Input validation border color for information severity.")),inputValidationWarningBackground=registerColor("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:Color.black,hcLight:Color.white},localize("inputValidationWarningBackground","Input validation background color for warning severity.")),inputValidationWarningForeground=registerColor("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:foreground},localize("inputValidationWarningForeground","Input validation foreground color for warning severity.")),inputValidationWarningBorder=registerColor("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:contrastBorder,hcLight:contrastBorder},localize("inputValidationWarningBorder","Input validation border color for warning severity.")),inputValidationErrorBackground=registerColor("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:Color.black,hcLight:Color.white},localize("inputValidationErrorBackground","Input validation background color for error severity.")),inputValidationErrorForeground=registerColor("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:foreground},localize("inputValidationErrorForeground","Input validation foreground color for error severity.")),inputValidationErrorBorder=registerColor("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:contrastBorder,hcLight:contrastBorder},localize("inputValidationErrorBorder","Input validation border color for error severity.")),selectBackground=registerColor("dropdown.background",{dark:"#3C3C3C",light:Color.white,hcDark:Color.black,hcLight:Color.white},localize("dropdownBackground","Dropdown background.")),selectListBackground=registerColor("dropdown.listBackground",{dark:null,light:null,hcDark:Color.black,hcLight:Color.white},localize("dropdownListBackground","Dropdown list background.")),selectForeground=registerColor("dropdown.foreground",{dark:"#F0F0F0",light:foreground,hcDark:Color.white,hcLight:foreground},localize("dropdownForeground","Dropdown foreground.")),selectBorder=registerColor("dropdown.border",{dark:selectBackground,light:"#CECECE",hcDark:contrastBorder,hcLight:contrastBorder},localize("dropdownBorder","Dropdown border.")),buttonForeground=registerColor("button.foreground",{dark:Color.white,light:Color.white,hcDark:Color.white,hcLight:Color.white},localize("buttonForeground","Button foreground color.")),buttonSeparator=registerColor("button.separator",{dark:transparent(buttonForeground,.4),light:transparent(buttonForeground,.4),hcDark:transparent(buttonForeground,.4),hcLight:transparent(buttonForeground,.4)},localize("buttonSeparator","Button separator color.")),buttonBackground=registerColor("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},localize("buttonBackground","Button background color.")),buttonHoverBackground=registerColor("button.hoverBackground",{dark:lighten(buttonBackground,.2),light:darken(buttonBackground,.2),hcDark:buttonBackground,hcLight:buttonBackground},localize("buttonHoverBackground","Button background color when hovering.")),buttonBorder=registerColor("button.border",{dark:contrastBorder,light:contrastBorder,hcDark:contrastBorder,hcLight:contrastBorder},localize("buttonBorder","Button border color.")),buttonSecondaryForeground=registerColor("button.secondaryForeground",{dark:Color.white,light:Color.white,hcDark:Color.white,hcLight:foreground},localize("buttonSecondaryForeground","Secondary button foreground color.")),buttonSecondaryBackground=registerColor("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:Color.white},localize("buttonSecondaryBackground","Secondary button background color.")),buttonSecondaryHoverBackground=registerColor("button.secondaryHoverBackground",{dark:lighten(buttonSecondaryBackground,.2),light:darken(buttonSecondaryBackground,.2),hcDark:null,hcLight:null},localize("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),badgeBackground=registerColor("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:Color.black,hcLight:"#0F4A85"},localize("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),badgeForeground=registerColor("badge.foreground",{dark:Color.white,light:"#333",hcDark:Color.white,hcLight:Color.white},localize("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),scrollbarShadow=registerColor("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},localize("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),scrollbarSliderBackground=registerColor("scrollbarSlider.background",{dark:Color.fromHex("#797979").transparent(.4),light:Color.fromHex("#646464").transparent(.4),hcDark:transparent(contrastBorder,.6),hcLight:transparent(contrastBorder,.4)},localize("scrollbarSliderBackground","Scrollbar slider background color.")),scrollbarSliderHoverBackground=registerColor("scrollbarSlider.hoverBackground",{dark:Color.fromHex("#646464").transparent(.7),light:Color.fromHex("#646464").transparent(.7),hcDark:transparent(contrastBorder,.8),hcLight:transparent(contrastBorder,.8)},localize("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),scrollbarSliderActiveBackground=registerColor("scrollbarSlider.activeBackground",{dark:Color.fromHex("#BFBFBF").transparent(.4),light:Color.fromHex("#000000").transparent(.6),hcDark:contrastBorder,hcLight:contrastBorder},localize("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),progressBarBackground=registerColor("progressBar.background",{dark:Color.fromHex("#0E70C0"),light:Color.fromHex("#0E70C0"),hcDark:contrastBorder,hcLight:contrastBorder},localize("progressBarBackground","Background color of the progress bar that can show for long running operations."));registerColor("editorError.background",{dark:null,light:null,hcDark:null,hcLight:null},localize("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const editorErrorForeground=registerColor("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},localize("editorError.foreground","Foreground color of error squigglies in the editor.")),editorErrorBorder=registerColor("editorError.border",{dark:null,light:null,hcDark:Color.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},localize("errorBorder","If set, color of double underlines for errors in the editor."));registerColor("editorWarning.background",{dark:null,light:null,hcDark:null,hcLight:null},localize("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const editorWarningForeground=registerColor("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},localize("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),editorWarningBorder=registerColor("editorWarning.border",{dark:null,light:null,hcDark:Color.fromHex("#FFCC00").transparent(.8),hcLight:Color.fromHex("#FFCC00").transparent(.8)},localize("warningBorder","If set, color of double underlines for warnings in the editor."));registerColor("editorInfo.background",{dark:null,light:null,hcDark:null,hcLight:null},localize("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const editorInfoForeground=registerColor("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},localize("editorInfo.foreground","Foreground color of info squigglies in the editor.")),editorInfoBorder=registerColor("editorInfo.border",{dark:null,light:null,hcDark:Color.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},localize("infoBorder","If set, color of double underlines for infos in the editor.")),editorHintForeground=registerColor("editorHint.foreground",{dark:Color.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},localize("editorHint.foreground","Foreground color of hint squigglies in the editor."));registerColor("editorHint.border",{dark:null,light:null,hcDark:Color.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},localize("hintBorder","If set, color of double underlines for hints in the editor."));registerColor("sash.hoverBorder",{dark:focusBorder,light:focusBorder,hcDark:focusBorder,hcLight:focusBorder},localize("sashActiveBorder","Border color of active sashes."));const editorBackground=registerColor("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:Color.black,hcLight:Color.white},localize("editorBackground","Editor background color.")),editorForeground=registerColor("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:Color.white,hcLight:foreground},localize("editorForeground","Editor default foreground color."));registerColor("editorStickyScroll.background",{light:editorBackground,dark:editorBackground,hcDark:editorBackground,hcLight:editorBackground},localize("editorStickyScrollBackground","Sticky scroll background color for the editor"));registerColor("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:Color.fromHex("#0F4A85").transparent(.1)},localize("editorStickyScrollHoverBackground","Sticky scroll on hover background color for the editor"));const editorWidgetBackground=registerColor("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:Color.white},localize("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),editorWidgetForeground=registerColor("editorWidget.foreground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),editorWidgetBorder=registerColor("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:contrastBorder,hcLight:contrastBorder},localize("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),editorWidgetResizeBorder=registerColor("editorWidget.resizeBorder",{light:null,dark:null,hcDark:null,hcLight:null},localize("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),quickInputBackground=registerColor("quickInput.background",{dark:editorWidgetBackground,light:editorWidgetBackground,hcDark:editorWidgetBackground,hcLight:editorWidgetBackground},localize("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),quickInputForeground=registerColor("quickInput.foreground",{dark:editorWidgetForeground,light:editorWidgetForeground,hcDark:editorWidgetForeground,hcLight:editorWidgetForeground},localize("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),quickInputTitleBackground=registerColor("quickInputTitle.background",{dark:new Color(new RGBA(255,255,255,.105)),light:new Color(new RGBA(0,0,0,.06)),hcDark:"#000000",hcLight:Color.white},localize("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),pickerGroupForeground=registerColor("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:Color.white,hcLight:"#0F4A85"},localize("pickerGroupForeground","Quick picker color for grouping labels.")),pickerGroupBorder=registerColor("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:Color.white,hcLight:"#0F4A85"},localize("pickerGroupBorder","Quick picker color for grouping borders.")),keybindingLabelBackground=registerColor("keybindingLabel.background",{dark:new Color(new RGBA(128,128,128,.17)),light:new Color(new RGBA(221,221,221,.4)),hcDark:Color.transparent,hcLight:Color.transparent},localize("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),keybindingLabelForeground=registerColor("keybindingLabel.foreground",{dark:Color.fromHex("#CCCCCC"),light:Color.fromHex("#555555"),hcDark:Color.white,hcLight:foreground},localize("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),keybindingLabelBorder=registerColor("keybindingLabel.border",{dark:new Color(new RGBA(51,51,51,.6)),light:new Color(new RGBA(204,204,204,.4)),hcDark:new Color(new RGBA(111,195,223)),hcLight:contrastBorder},localize("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),keybindingLabelBottomBorder=registerColor("keybindingLabel.bottomBorder",{dark:new Color(new RGBA(68,68,68,.6)),light:new Color(new RGBA(187,187,187,.4)),hcDark:new Color(new RGBA(111,195,223)),hcLight:foreground},localize("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),editorSelectionBackground=registerColor("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},localize("editorSelectionBackground","Color of the editor selection.")),editorSelectionForeground=registerColor("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:Color.white},localize("editorSelectionForeground","Color of the selected text for high contrast.")),editorInactiveSelection=registerColor("editor.inactiveSelectionBackground",{light:transparent(editorSelectionBackground,.5),dark:transparent(editorSelectionBackground,.5),hcDark:transparent(editorSelectionBackground,.7),hcLight:transparent(editorSelectionBackground,.5)},localize("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),editorSelectionHighlight=registerColor("editor.selectionHighlightBackground",{light:lessProminent(editorSelectionBackground,editorBackground,.3,.6),dark:lessProminent(editorSelectionBackground,editorBackground,.3,.6),hcDark:null,hcLight:null},localize("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("editorSelectionHighlightBorder","Border color for regions with the same content as the selection."));const editorFindMatch=registerColor("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},localize("editorFindMatch","Color of the current search match.")),editorFindMatchHighlight=registerColor("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},localize("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),editorFindRangeHighlight=registerColor("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},localize("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),editorFindMatchBorder=registerColor("editor.findMatchBorder",{light:null,dark:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("editorFindMatchBorder","Border color of the current search match.")),editorFindMatchHighlightBorder=registerColor("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("findMatchHighlightBorder","Border color of the other search matches.")),editorFindRangeHighlightBorder=registerColor("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:transparent(activeContrastBorder,.4),hcLight:transparent(activeContrastBorder,.4)},localize("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("searchEditor.findMatchBackground",{light:transparent(editorFindMatchHighlight,.66),dark:transparent(editorFindMatchHighlight,.66),hcDark:editorFindMatchHighlight,hcLight:editorFindMatchHighlight},localize("searchEditor.queryMatch","Color of the Search Editor query matches."));registerColor("searchEditor.findMatchBorder",{light:transparent(editorFindMatchHighlightBorder,.66),dark:transparent(editorFindMatchHighlightBorder,.66),hcDark:editorFindMatchHighlightBorder,hcLight:editorFindMatchHighlightBorder},localize("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));registerColor("search.resultsInfoForeground",{light:foreground,dark:transparent(foreground,.65),hcDark:foreground,hcLight:foreground},localize("search.resultsInfoForeground","Color of the text in the search viewlet's completion message."));registerColor("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},localize("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0);const editorHoverBackground=registerColor("editorHoverWidget.background",{light:editorWidgetBackground,dark:editorWidgetBackground,hcDark:editorWidgetBackground,hcLight:editorWidgetBackground},localize("hoverBackground","Background color of the editor hover."));registerColor("editorHoverWidget.foreground",{light:editorWidgetForeground,dark:editorWidgetForeground,hcDark:editorWidgetForeground,hcLight:editorWidgetForeground},localize("hoverForeground","Foreground color of the editor hover."));const editorHoverBorder=registerColor("editorHoverWidget.border",{light:editorWidgetBorder,dark:editorWidgetBorder,hcDark:editorWidgetBorder,hcLight:editorWidgetBorder},localize("hoverBorder","Border color of the editor hover."));registerColor("editorHoverWidget.statusBarBackground",{dark:lighten(editorHoverBackground,.2),light:darken(editorHoverBackground,.05),hcDark:editorWidgetBackground,hcLight:editorWidgetBackground},localize("statusBarBackground","Background color of the editor hover status bar."));const editorActiveLinkForeground=registerColor("editorLink.activeForeground",{dark:"#4E94CE",light:Color.blue,hcDark:Color.cyan,hcLight:"#292929"},localize("activeLinkForeground","Color of active links.")),editorInlayHintForeground=registerColor("editorInlayHint.foreground",{dark:badgeForeground,light:badgeForeground,hcDark:Color.black,hcLight:badgeForeground},localize("editorInlayHintForeground","Foreground color of inline hints")),editorInlayHintBackground=registerColor("editorInlayHint.background",{dark:transparent(badgeBackground,.8),light:transparent(badgeBackground,.6),hcDark:"#f38518",hcLight:badgeBackground},localize("editorInlayHintBackground","Background color of inline hints")),editorInlayHintTypeForeground=registerColor("editorInlayHint.typeForeground",{dark:editorInlayHintForeground,light:editorInlayHintForeground,hcDark:editorInlayHintForeground,hcLight:editorInlayHintForeground},localize("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),editorInlayHintTypeBackground=registerColor("editorInlayHint.typeBackground",{dark:editorInlayHintBackground,light:editorInlayHintBackground,hcDark:editorInlayHintBackground,hcLight:editorInlayHintBackground},localize("editorInlayHintBackgroundTypes","Background color of inline hints for types")),editorInlayHintParameterForeground=registerColor("editorInlayHint.parameterForeground",{dark:editorInlayHintForeground,light:editorInlayHintForeground,hcDark:editorInlayHintForeground,hcLight:editorInlayHintForeground},localize("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),editorInlayHintParameterBackground=registerColor("editorInlayHint.parameterBackground",{dark:editorInlayHintBackground,light:editorInlayHintBackground,hcDark:editorInlayHintBackground,hcLight:editorInlayHintBackground},localize("editorInlayHintBackgroundParameter","Background color of inline hints for parameters"));registerColor("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},localize("editorLightBulbForeground","The color used for the lightbulb actions icon."));registerColor("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},localize("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon."));const defaultInsertColor=new Color(new RGBA(155,185,85,.2)),defaultRemoveColor=new Color(new RGBA(255,0,0,.2)),diffInserted=registerColor("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},localize("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),diffRemoved=registerColor("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},localize("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("diffEditor.insertedLineBackground",{dark:defaultInsertColor,light:defaultInsertColor,hcDark:null,hcLight:null},localize("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("diffEditor.removedLineBackground",{dark:defaultRemoveColor,light:defaultRemoveColor,hcDark:null,hcLight:null},localize("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("diffEditorGutter.insertedLineBackground",{dark:null,light:null,hcDark:null,hcLight:null},localize("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted."));registerColor("diffEditorGutter.removedLineBackground",{dark:null,light:null,hcDark:null,hcLight:null},localize("diffEditorRemovedLineGutter","Background color for the margin where lines got removed."));const diffOverviewRulerInserted=registerColor("diffEditorOverview.insertedForeground",{dark:null,light:null,hcDark:null,hcLight:null},localize("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),diffOverviewRulerRemoved=registerColor("diffEditorOverview.removedForeground",{dark:null,light:null,hcDark:null,hcLight:null},localize("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content."));registerColor("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},localize("diffEditorInsertedOutline","Outline color for the text that got inserted."));registerColor("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},localize("diffEditorRemovedOutline","Outline color for text that got removed."));registerColor("diffEditor.border",{dark:null,light:null,hcDark:contrastBorder,hcLight:contrastBorder},localize("diffEditorBorder","Border color between the two text editors."));const diffDiagonalFill=registerColor("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},localize("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),listFocusBackground=registerColor("list.focusBackground",{dark:null,light:null,hcDark:null,hcLight:null},localize("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listFocusForeground=registerColor("list.focusForeground",{dark:null,light:null,hcDark:null,hcLight:null},localize("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listFocusOutline=registerColor("list.focusOutline",{dark:focusBorder,light:focusBorder,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listFocusAndSelectionOutline=registerColor("list.focusAndSelectionOutline",{dark:null,light:null,hcDark:null,hcLight:null},localize("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),listActiveSelectionBackground=registerColor("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:Color.fromHex("#0F4A85").transparent(.1)},localize("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listActiveSelectionForeground=registerColor("list.activeSelectionForeground",{dark:Color.white,light:Color.white,hcDark:null,hcLight:null},localize("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listActiveSelectionIconForeground=registerColor("list.activeSelectionIconForeground",{dark:null,light:null,hcDark:null,hcLight:null},localize("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listInactiveSelectionBackground=registerColor("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:Color.fromHex("#0F4A85").transparent(.1)},localize("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveSelectionForeground=registerColor("list.inactiveSelectionForeground",{dark:null,light:null,hcDark:null,hcLight:null},localize("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveSelectionIconForeground=registerColor("list.inactiveSelectionIconForeground",{dark:null,light:null,hcDark:null,hcLight:null},localize("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveFocusBackground=registerColor("list.inactiveFocusBackground",{dark:null,light:null,hcDark:null,hcLight:null},localize("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveFocusOutline=registerColor("list.inactiveFocusOutline",{dark:null,light:null,hcDark:null,hcLight:null},localize("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listHoverBackground=registerColor("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:Color.white.transparent(.1),hcLight:Color.fromHex("#0F4A85").transparent(.1)},localize("listHoverBackground","List/Tree background when hovering over items using the mouse.")),listHoverForeground=registerColor("list.hoverForeground",{dark:null,light:null,hcDark:null,hcLight:null},localize("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),listDropBackground=registerColor("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},localize("listDropBackground","List/Tree drag and drop background when moving items around using the mouse.")),listHighlightForeground=registerColor("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:focusBorder,hcLight:focusBorder},localize("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),listFocusHighlightForeground=registerColor("list.focusHighlightForeground",{dark:listHighlightForeground,light:ifDefinedThenElse(listActiveSelectionBackground,listHighlightForeground,"#BBE7FF"),hcDark:listHighlightForeground,hcLight:listHighlightForeground},localize("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));registerColor("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},localize("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer."));registerColor("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},localize("listErrorForeground","Foreground color of list items containing errors."));registerColor("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},localize("listWarningForeground","Foreground color of list items containing warnings."));const listFilterWidgetBackground=registerColor("listFilterWidget.background",{light:darken(editorWidgetBackground,0),dark:lighten(editorWidgetBackground,0),hcDark:editorWidgetBackground,hcLight:editorWidgetBackground},localize("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),listFilterWidgetOutline=registerColor("listFilterWidget.outline",{dark:Color.transparent,light:Color.transparent,hcDark:"#f38518",hcLight:"#007ACC"},localize("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),listFilterWidgetNoMatchesOutline=registerColor("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:contrastBorder,hcLight:contrastBorder},localize("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),listFilterWidgetShadow=registerColor("listFilterWidget.shadow",{dark:widgetShadow,light:widgetShadow,hcDark:widgetShadow,hcLight:widgetShadow},localize("listFilterWidgetShadow","Shadown color of the type filter widget in lists and trees."));registerColor("list.filterMatchBackground",{dark:editorFindMatchHighlight,light:editorFindMatchHighlight,hcDark:null,hcLight:null},localize("listFilterMatchHighlight","Background color of the filtered match."));registerColor("list.filterMatchBorder",{dark:editorFindMatchHighlightBorder,light:editorFindMatchHighlightBorder,hcDark:contrastBorder,hcLight:activeContrastBorder},localize("listFilterMatchHighlightBorder","Border color of the filtered match."));const treeIndentGuidesStroke=registerColor("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},localize("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),treeInactiveIndentGuidesStroke=registerColor("tree.inactiveIndentGuidesStroke",{dark:transparent(treeIndentGuidesStroke,.4),light:transparent(treeIndentGuidesStroke,.4),hcDark:transparent(treeIndentGuidesStroke,.4),hcLight:transparent(treeIndentGuidesStroke,.4)},localize("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),tableColumnsBorder=registerColor("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},localize("tableColumnsBorder","Table border color between columns.")),tableOddRowsBackgroundColor=registerColor("tree.tableOddRowsBackground",{dark:transparent(foreground,.04),light:transparent(foreground,.04),hcDark:null,hcLight:null},localize("tableOddRowsBackgroundColor","Background color for odd table rows."));registerColor("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},localize("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized. "));const checkboxBackground=registerColor("checkbox.background",{dark:selectBackground,light:selectBackground,hcDark:selectBackground,hcLight:selectBackground},localize("checkbox.background","Background color of checkbox widget."));registerColor("checkbox.selectBackground",{dark:editorWidgetBackground,light:editorWidgetBackground,hcDark:editorWidgetBackground,hcLight:editorWidgetBackground},localize("checkbox.select.background","Background color of checkbox widget when the element it's in is selected."));const checkboxForeground=registerColor("checkbox.foreground",{dark:selectForeground,light:selectForeground,hcDark:selectForeground,hcLight:selectForeground},localize("checkbox.foreground","Foreground color of checkbox widget.")),checkboxBorder=registerColor("checkbox.border",{dark:selectBorder,light:selectBorder,hcDark:selectBorder,hcLight:selectBorder},localize("checkbox.border","Border color of checkbox widget."));registerColor("checkbox.selectBorder",{dark:iconForeground,light:iconForeground,hcDark:iconForeground,hcLight:iconForeground},localize("checkbox.select.border","Border color of checkbox widget when the element it's in is selected."));const _deprecatedQuickInputListFocusBackground=registerColor("quickInput.list.focusBackground",{dark:null,light:null,hcDark:null,hcLight:null},"",void 0,localize("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),quickInputListFocusForeground=registerColor("quickInputList.focusForeground",{dark:listActiveSelectionForeground,light:listActiveSelectionForeground,hcDark:listActiveSelectionForeground,hcLight:listActiveSelectionForeground},localize("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),quickInputListFocusIconForeground=registerColor("quickInputList.focusIconForeground",{dark:listActiveSelectionIconForeground,light:listActiveSelectionIconForeground,hcDark:listActiveSelectionIconForeground,hcLight:listActiveSelectionIconForeground},localize("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),quickInputListFocusBackground=registerColor("quickInputList.focusBackground",{dark:oneOf(_deprecatedQuickInputListFocusBackground,listActiveSelectionBackground),light:oneOf(_deprecatedQuickInputListFocusBackground,listActiveSelectionBackground),hcDark:null,hcLight:null},localize("quickInput.listFocusBackground","Quick picker background color for the focused item.")),menuBorder=registerColor("menu.border",{dark:null,light:null,hcDark:contrastBorder,hcLight:contrastBorder},localize("menuBorder","Border color of menus.")),menuForeground=registerColor("menu.foreground",{dark:selectForeground,light:selectForeground,hcDark:selectForeground,hcLight:selectForeground},localize("menuForeground","Foreground color of menu items.")),menuBackground=registerColor("menu.background",{dark:selectBackground,light:selectBackground,hcDark:selectBackground,hcLight:selectBackground},localize("menuBackground","Background color of menu items.")),menuSelectionForeground=registerColor("menu.selectionForeground",{dark:listActiveSelectionForeground,light:listActiveSelectionForeground,hcDark:listActiveSelectionForeground,hcLight:listActiveSelectionForeground},localize("menuSelectionForeground","Foreground color of the selected menu item in menus.")),menuSelectionBackground=registerColor("menu.selectionBackground",{dark:listActiveSelectionBackground,light:listActiveSelectionBackground,hcDark:listActiveSelectionBackground,hcLight:listActiveSelectionBackground},localize("menuSelectionBackground","Background color of the selected menu item in menus.")),menuSelectionBorder=registerColor("menu.selectionBorder",{dark:null,light:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("menuSelectionBorder","Border color of the selected menu item in menus.")),menuSeparatorBackground=registerColor("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:contrastBorder,hcLight:contrastBorder},localize("menuSeparatorBackground","Color of a separator menu item in menus.")),toolbarHoverBackground=registerColor("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},localize("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse"));registerColor("toolbar.hoverOutline",{dark:null,light:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse"));registerColor("toolbar.activeBackground",{dark:lighten(toolbarHoverBackground,.1),light:darken(toolbarHoverBackground,.1),hcDark:null,hcLight:null},localize("toolbarActiveBackground","Toolbar background when holding the mouse over actions"));registerColor("editor.snippetTabstopHighlightBackground",{dark:new Color(new RGBA(124,124,124,.3)),light:new Color(new RGBA(10,50,100,.2)),hcDark:new Color(new RGBA(124,124,124,.3)),hcLight:new Color(new RGBA(10,50,100,.2))},localize("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop."));registerColor("editor.snippetTabstopHighlightBorder",{dark:null,light:null,hcDark:null,hcLight:null},localize("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop."));registerColor("editor.snippetFinalTabstopHighlightBackground",{dark:null,light:null,hcDark:null,hcLight:null},localize("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet."));registerColor("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new Color(new RGBA(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},localize("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet."));const breadcrumbsForeground=registerColor("breadcrumb.foreground",{light:transparent(foreground,.8),dark:transparent(foreground,.8),hcDark:transparent(foreground,.8),hcLight:transparent(foreground,.8)},localize("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),breadcrumbsBackground=registerColor("breadcrumb.background",{light:editorBackground,dark:editorBackground,hcDark:editorBackground,hcLight:editorBackground},localize("breadcrumbsBackground","Background color of breadcrumb items.")),breadcrumbsFocusForeground=registerColor("breadcrumb.focusForeground",{light:darken(foreground,.2),dark:lighten(foreground,.1),hcDark:lighten(foreground,.1),hcLight:lighten(foreground,.1)},localize("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),breadcrumbsActiveSelectionForeground=registerColor("breadcrumb.activeSelectionForeground",{light:darken(foreground,.2),dark:lighten(foreground,.1),hcDark:lighten(foreground,.1),hcLight:lighten(foreground,.1)},localize("breadcrumbsSelectedForeground","Color of selected breadcrumb items."));registerColor("breadcrumbPicker.background",{light:editorWidgetBackground,dark:editorWidgetBackground,hcDark:editorWidgetBackground,hcLight:editorWidgetBackground},localize("breadcrumbsSelectedBackground","Background color of breadcrumb item picker."));const headerTransparency=.5,currentBaseColor=Color.fromHex("#40C8AE").transparent(headerTransparency),incomingBaseColor=Color.fromHex("#40A6FF").transparent(headerTransparency),commonBaseColor=Color.fromHex("#606060").transparent(.4),contentTransparency=.4,rulerTransparency=1,mergeCurrentHeaderBackground=registerColor("merge.currentHeaderBackground",{dark:currentBaseColor,light:currentBaseColor,hcDark:null,hcLight:null},localize("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("merge.currentContentBackground",{dark:transparent(mergeCurrentHeaderBackground,contentTransparency),light:transparent(mergeCurrentHeaderBackground,contentTransparency),hcDark:transparent(mergeCurrentHeaderBackground,contentTransparency),hcLight:transparent(mergeCurrentHeaderBackground,contentTransparency)},localize("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const mergeIncomingHeaderBackground=registerColor("merge.incomingHeaderBackground",{dark:incomingBaseColor,light:incomingBaseColor,hcDark:null,hcLight:null},localize("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("merge.incomingContentBackground",{dark:transparent(mergeIncomingHeaderBackground,contentTransparency),light:transparent(mergeIncomingHeaderBackground,contentTransparency),hcDark:transparent(mergeIncomingHeaderBackground,contentTransparency),hcLight:transparent(mergeIncomingHeaderBackground,contentTransparency)},localize("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const mergeCommonHeaderBackground=registerColor("merge.commonHeaderBackground",{dark:commonBaseColor,light:commonBaseColor,hcDark:null,hcLight:null},localize("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("merge.commonContentBackground",{dark:transparent(mergeCommonHeaderBackground,contentTransparency),light:transparent(mergeCommonHeaderBackground,contentTransparency),hcDark:transparent(mergeCommonHeaderBackground,contentTransparency),hcLight:transparent(mergeCommonHeaderBackground,contentTransparency)},localize("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const mergeBorder=registerColor("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},localize("mergeBorder","Border color on headers and the splitter in inline merge-conflicts."));registerColor("editorOverviewRuler.currentContentForeground",{dark:transparent(mergeCurrentHeaderBackground,rulerTransparency),light:transparent(mergeCurrentHeaderBackground,rulerTransparency),hcDark:mergeBorder,hcLight:mergeBorder},localize("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts."));registerColor("editorOverviewRuler.incomingContentForeground",{dark:transparent(mergeIncomingHeaderBackground,rulerTransparency),light:transparent(mergeIncomingHeaderBackground,rulerTransparency),hcDark:mergeBorder,hcLight:mergeBorder},localize("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts."));registerColor("editorOverviewRuler.commonContentForeground",{dark:transparent(mergeCommonHeaderBackground,rulerTransparency),light:transparent(mergeCommonHeaderBackground,rulerTransparency),hcDark:mergeBorder,hcLight:mergeBorder},localize("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts."));const overviewRulerFindMatchForeground=registerColor("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:""},localize("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),overviewRulerSelectionHighlightForeground=registerColor("editorOverviewRuler.selectionHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hcDark:"#A0A0A0CC",hcLight:"#A0A0A0CC"},localize("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),minimapFindMatch=registerColor("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},localize("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),minimapSelectionOccurrenceHighlight=registerColor("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},localize("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),minimapSelection=registerColor("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},localize("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),minimapError=registerColor("minimap.errorHighlight",{dark:new Color(new RGBA(255,18,18,.7)),light:new Color(new RGBA(255,18,18,.7)),hcDark:new Color(new RGBA(255,50,50,1)),hcLight:"#B5200D"},localize("minimapError","Minimap marker color for errors.")),minimapWarning=registerColor("minimap.warningHighlight",{dark:editorWarningForeground,light:editorWarningForeground,hcDark:editorWarningBorder,hcLight:editorWarningBorder},localize("overviewRuleWarning","Minimap marker color for warnings.")),minimapBackground=registerColor("minimap.background",{dark:null,light:null,hcDark:null,hcLight:null},localize("minimapBackground","Minimap background color.")),minimapForegroundOpacity=registerColor("minimap.foregroundOpacity",{dark:Color.fromHex("#000f"),light:Color.fromHex("#000f"),hcDark:Color.fromHex("#000f"),hcLight:Color.fromHex("#000f")},localize("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.'));registerColor("minimapSlider.background",{light:transparent(scrollbarSliderBackground,.5),dark:transparent(scrollbarSliderBackground,.5),hcDark:transparent(scrollbarSliderBackground,.5),hcLight:transparent(scrollbarSliderBackground,.5)},localize("minimapSliderBackground","Minimap slider background color."));registerColor("minimapSlider.hoverBackground",{light:transparent(scrollbarSliderHoverBackground,.5),dark:transparent(scrollbarSliderHoverBackground,.5),hcDark:transparent(scrollbarSliderHoverBackground,.5),hcLight:transparent(scrollbarSliderHoverBackground,.5)},localize("minimapSliderHoverBackground","Minimap slider background color when hovering."));registerColor("minimapSlider.activeBackground",{light:transparent(scrollbarSliderActiveBackground,.5),dark:transparent(scrollbarSliderActiveBackground,.5),hcDark:transparent(scrollbarSliderActiveBackground,.5),hcLight:transparent(scrollbarSliderActiveBackground,.5)},localize("minimapSliderActiveBackground","Minimap slider background color when clicked on."));const problemsErrorIconForeground=registerColor("problemsErrorIcon.foreground",{dark:editorErrorForeground,light:editorErrorForeground,hcDark:editorErrorForeground,hcLight:editorErrorForeground},localize("problemsErrorIconForeground","The color used for the problems error icon.")),problemsWarningIconForeground=registerColor("problemsWarningIcon.foreground",{dark:editorWarningForeground,light:editorWarningForeground,hcDark:editorWarningForeground,hcLight:editorWarningForeground},localize("problemsWarningIconForeground","The color used for the problems warning icon.")),problemsInfoIconForeground=registerColor("problemsInfoIcon.foreground",{dark:editorInfoForeground,light:editorInfoForeground,hcDark:editorInfoForeground,hcLight:editorInfoForeground},localize("problemsInfoIconForeground","The color used for the problems info icon."));registerColor("charts.foreground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("chartsForeground","The foreground color used in charts."));registerColor("charts.lines",{dark:transparent(foreground,.5),light:transparent(foreground,.5),hcDark:transparent(foreground,.5),hcLight:transparent(foreground,.5)},localize("chartsLines","The color used for horizontal lines in charts."));registerColor("charts.red",{dark:editorErrorForeground,light:editorErrorForeground,hcDark:editorErrorForeground,hcLight:editorErrorForeground},localize("chartsRed","The red color used in chart visualizations."));registerColor("charts.blue",{dark:editorInfoForeground,light:editorInfoForeground,hcDark:editorInfoForeground,hcLight:editorInfoForeground},localize("chartsBlue","The blue color used in chart visualizations."));registerColor("charts.yellow",{dark:editorWarningForeground,light:editorWarningForeground,hcDark:editorWarningForeground,hcLight:editorWarningForeground},localize("chartsYellow","The yellow color used in chart visualizations."));registerColor("charts.orange",{dark:minimapFindMatch,light:minimapFindMatch,hcDark:minimapFindMatch,hcLight:minimapFindMatch},localize("chartsOrange","The orange color used in chart visualizations."));registerColor("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},localize("chartsGreen","The green color used in chart visualizations."));registerColor("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},localize("chartsPurple","The purple color used in chart visualizations."));function executeTransform(ct,nt){var ot,rt,ut,gt;switch(ct.op){case 0:return(ot=resolveColorValue(ct.value,nt))===null||ot===void 0?void 0:ot.darken(ct.factor);case 1:return(rt=resolveColorValue(ct.value,nt))===null||rt===void 0?void 0:rt.lighten(ct.factor);case 2:return(ut=resolveColorValue(ct.value,nt))===null||ut===void 0?void 0:ut.transparent(ct.factor);case 3:{const pt=resolveColorValue(ct.background,nt);return pt?(gt=resolveColorValue(ct.value,nt))===null||gt===void 0?void 0:gt.makeOpaque(pt):resolveColorValue(ct.value,nt)}case 4:for(const pt of ct.values){const mt=resolveColorValue(pt,nt);if(mt)return mt}return;case 6:return resolveColorValue(nt.defines(ct.if)?ct.then:ct.else,nt);case 5:{const pt=resolveColorValue(ct.value,nt);if(!pt)return;const mt=resolveColorValue(ct.background,nt);return mt?pt.isDarkerThan(mt)?Color.getLighterColor(pt,mt,ct.factor).transparent(ct.transparency):Color.getDarkerColor(pt,mt,ct.factor).transparent(ct.transparency):pt.transparent(ct.factor*ct.transparency)}default:throw assertNever()}}function darken(ct,nt){return{op:0,value:ct,factor:nt}}function lighten(ct,nt){return{op:1,value:ct,factor:nt}}function transparent(ct,nt){return{op:2,value:ct,factor:nt}}function oneOf(...ct){return{op:4,values:ct}}function ifDefinedThenElse(ct,nt,ot){return{op:6,if:ct,then:nt,else:ot}}function lessProminent(ct,nt,ot,rt){return{op:5,value:ct,background:nt,factor:ot,transparency:rt}}function resolveColorValue(ct,nt){if(ct!==null){if(typeof ct=="string")return ct[0]==="#"?Color.fromHex(ct):nt.getColor(ct);if(ct instanceof Color)return ct;if(typeof ct=="object")return executeTransform(ct,nt)}}const workbenchColorsSchemaId="vscode://schemas/workbench-colors",schemaRegistry$1=Registry.as(Extensions$9.JSONContribution);schemaRegistry$1.registerSchema(workbenchColorsSchemaId,colorRegistry$1.getColorSchema());const delayer$1=new RunOnceScheduler(()=>schemaRegistry$1.notifySchemaChanged(workbenchColorsSchemaId),200);colorRegistry$1.onDidChangeSchema(()=>{delayer$1.isScheduled()||delayer$1.schedule()});class PageCoordinates{constructor(nt,ot){this.x=nt,this.y=ot,this._pageCoordinatesBrand=void 0}toClientCoordinates(){return new ClientCoordinates(this.x-window.scrollX,this.y-window.scrollY)}}class ClientCoordinates{constructor(nt,ot){this.clientX=nt,this.clientY=ot,this._clientCoordinatesBrand=void 0}toPageCoordinates(){return new PageCoordinates(this.clientX+window.scrollX,this.clientY+window.scrollY)}}class EditorPagePosition{constructor(nt,ot,rt,ut){this.x=nt,this.y=ot,this.width=rt,this.height=ut,this._editorPagePositionBrand=void 0}}class CoordinatesRelativeToEditor{constructor(nt,ot){this.x=nt,this.y=ot,this._positionRelativeToEditorBrand=void 0}}function createEditorPagePosition(ct){const nt=getDomNodePagePosition(ct);return new EditorPagePosition(nt.left,nt.top,nt.width,nt.height)}function createCoordinatesRelativeToEditor(ct,nt,ot){const rt=nt.width/ct.offsetWidth,ut=nt.height/ct.offsetHeight,gt=(ot.x-nt.x)/rt,pt=(ot.y-nt.y)/ut;return new CoordinatesRelativeToEditor(gt,pt)}class EditorMouseEvent extends StandardMouseEvent{constructor(nt,ot,rt){super(nt),this._editorMouseEventBrand=void 0,this.isFromPointerCapture=ot,this.pos=new PageCoordinates(this.posx,this.posy),this.editorPos=createEditorPagePosition(rt),this.relativePos=createCoordinatesRelativeToEditor(rt,this.editorPos,this.pos)}}class EditorMouseEventFactory{constructor(nt){this._editorViewDomNode=nt}_create(nt){return new EditorMouseEvent(nt,!1,this._editorViewDomNode)}onContextMenu(nt,ot){return addDisposableListener(nt,"contextmenu",rt=>{ot(this._create(rt))})}onMouseUp(nt,ot){return addDisposableListener(nt,"mouseup",rt=>{ot(this._create(rt))})}onMouseDown(nt,ot){return addDisposableListener(nt,EventType$1.MOUSE_DOWN,rt=>{ot(this._create(rt))})}onPointerDown(nt,ot){return addDisposableListener(nt,EventType$1.POINTER_DOWN,rt=>{ot(this._create(rt),rt.pointerId)})}onMouseLeave(nt,ot){return addDisposableListener(nt,EventType$1.MOUSE_LEAVE,rt=>{ot(this._create(rt))})}onMouseMove(nt,ot){return addDisposableListener(nt,"mousemove",rt=>ot(this._create(rt)))}}class EditorPointerEventFactory{constructor(nt){this._editorViewDomNode=nt}_create(nt){return new EditorMouseEvent(nt,!1,this._editorViewDomNode)}onPointerUp(nt,ot){return addDisposableListener(nt,"pointerup",rt=>{ot(this._create(rt))})}onPointerDown(nt,ot){return addDisposableListener(nt,EventType$1.POINTER_DOWN,rt=>{ot(this._create(rt),rt.pointerId)})}onPointerLeave(nt,ot){return addDisposableListener(nt,EventType$1.POINTER_LEAVE,rt=>{ot(this._create(rt))})}onPointerMove(nt,ot){return addDisposableListener(nt,"pointermove",rt=>ot(this._create(rt)))}}class GlobalEditorPointerMoveMonitor extends Disposable{constructor(nt){super(),this._editorViewDomNode=nt,this._globalPointerMoveMonitor=this._register(new GlobalPointerMoveMonitor),this._keydownListener=null}startMonitoring(nt,ot,rt,ut,gt){this._keydownListener=addStandardDisposableListener(document,"keydown",pt=>{pt.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,pt.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(nt,ot,rt,pt=>{ut(new EditorMouseEvent(pt,!0,this._editorViewDomNode))},pt=>{this._keydownListener.dispose(),gt(pt)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}class DynamicCssRules{constructor(nt){this._editor=nt,this._instanceId=++DynamicCssRules._idPool,this._counter=0,this._rules=new Map,this._garbageCollectionScheduler=new RunOnceScheduler(()=>this.garbageCollect(),1e3)}createClassNameRef(nt){const ot=this.getOrCreateRule(nt);return ot.increaseRefCount(),{className:ot.className,dispose:()=>{ot.decreaseRefCount(),this._garbageCollectionScheduler.schedule()}}}getOrCreateRule(nt){const ot=this.computeUniqueKey(nt);let rt=this._rules.get(ot);if(!rt){const ut=this._counter++;rt=new RefCountedCssRule(ot,`dyn-rule-${this._instanceId}-${ut}`,isInShadowDOM(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,nt),this._rules.set(ot,rt)}return rt}computeUniqueKey(nt){return JSON.stringify(nt)}garbageCollect(){for(const nt of this._rules.values())nt.hasReferences()||(this._rules.delete(nt.key),nt.dispose())}}DynamicCssRules._idPool=0;class RefCountedCssRule{constructor(nt,ot,rt,ut){this.key=nt,this.className=ot,this.properties=ut,this._referenceCount=0,this._styleElement=createStyleSheet(rt),this._styleElement.textContent=this.getCssText(this.className,this.properties)}getCssText(nt,ot){let rt=`.${nt} {`;for(const ut in ot){const gt=ot[ut];let pt;typeof gt=="object"?pt=asCssVariable(gt.id):pt=gt;const mt=camelToDashes(ut);rt+=`
	${mt}: ${pt};`}return rt+=`
}`,rt}dispose(){this._styleElement.remove()}increaseRefCount(){this._referenceCount++}decreaseRefCount(){this._referenceCount--}hasReferences(){return this._referenceCount>0}}function camelToDashes(ct){return ct.replace(/(^[A-Z])/,([nt])=>nt.toLowerCase()).replace(/([A-Z])/g,([nt])=>`-${nt.toLowerCase()}`)}class ViewEventHandler extends Disposable{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(nt){return!1}onCompositionEnd(nt){return!1}onConfigurationChanged(nt){return!1}onCursorStateChanged(nt){return!1}onDecorationsChanged(nt){return!1}onFlushed(nt){return!1}onFocusChanged(nt){return!1}onLanguageConfigurationChanged(nt){return!1}onLineMappingChanged(nt){return!1}onLinesChanged(nt){return!1}onLinesDeleted(nt){return!1}onLinesInserted(nt){return!1}onRevealRangeRequest(nt){return!1}onScrollChanged(nt){return!1}onThemeChanged(nt){return!1}onTokensChanged(nt){return!1}onTokensColorsChanged(nt){return!1}onZonesChanged(nt){return!1}handleEvents(nt){let ot=!1;for(let rt=0,ut=nt.length;rt<ut;rt++){const gt=nt[rt];switch(gt.type){case 0:this.onCompositionStart(gt)&&(ot=!0);break;case 1:this.onCompositionEnd(gt)&&(ot=!0);break;case 2:this.onConfigurationChanged(gt)&&(ot=!0);break;case 3:this.onCursorStateChanged(gt)&&(ot=!0);break;case 4:this.onDecorationsChanged(gt)&&(ot=!0);break;case 5:this.onFlushed(gt)&&(ot=!0);break;case 6:this.onFocusChanged(gt)&&(ot=!0);break;case 7:this.onLanguageConfigurationChanged(gt)&&(ot=!0);break;case 8:this.onLineMappingChanged(gt)&&(ot=!0);break;case 9:this.onLinesChanged(gt)&&(ot=!0);break;case 10:this.onLinesDeleted(gt)&&(ot=!0);break;case 11:this.onLinesInserted(gt)&&(ot=!0);break;case 12:this.onRevealRangeRequest(gt)&&(ot=!0);break;case 13:this.onScrollChanged(gt)&&(ot=!0);break;case 15:this.onTokensChanged(gt)&&(ot=!0);break;case 14:this.onThemeChanged(gt)&&(ot=!0);break;case 16:this.onTokensColorsChanged(gt)&&(ot=!0);break;case 17:this.onZonesChanged(gt)&&(ot=!0);break;default:console.info("View received unknown event: "),console.info(gt)}}ot&&(this._shouldRender=!0)}}class ViewPart extends ViewEventHandler{constructor(nt){super(),this._context=nt,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class PartFingerprints{static write(nt,ot){nt.setAttribute("data-mprt",String(ot))}static read(nt){const ot=nt.getAttribute("data-mprt");return ot===null?0:parseInt(ot,10)}static collect(nt,ot){const rt=[];let ut=0;for(;nt&&nt!==document.body&&nt!==ot;)nt.nodeType===nt.ELEMENT_NODE&&(rt[ut++]=this.read(nt)),nt=nt.parentElement;const gt=new Uint8Array(ut);for(let pt=0;pt<ut;pt++)gt[pt]=rt[ut-pt-1];return gt}}class RestrictedRenderingContext{constructor(nt,ot){this._restrictedRenderingContextBrand=void 0,this._viewLayout=nt,this.viewportData=ot,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const rt=this._viewLayout.getCurrentViewport();this.scrollTop=rt.top,this.scrollLeft=rt.left,this.viewportWidth=rt.width,this.viewportHeight=rt.height}getScrolledTopFromAbsoluteTop(nt){return nt-this.scrollTop}getVerticalOffsetForLineNumber(nt,ot){return this._viewLayout.getVerticalOffsetForLineNumber(nt,ot)}getVerticalOffsetAfterLineNumber(nt,ot){return this._viewLayout.getVerticalOffsetAfterLineNumber(nt,ot)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class RenderingContext extends RestrictedRenderingContext{constructor(nt,ot,rt){super(nt,ot),this._renderingContextBrand=void 0,this._viewLines=rt}linesVisibleRangesForRange(nt,ot){return this._viewLines.linesVisibleRangesForRange(nt,ot)}visibleRangeForPosition(nt){return this._viewLines.visibleRangeForPosition(nt)}}class LineVisibleRanges{constructor(nt,ot,rt){this.outsideRenderedLine=nt,this.lineNumber=ot,this.ranges=rt}}class HorizontalRange{static from(nt){const ot=new Array(nt.length);for(let rt=0,ut=nt.length;rt<ut;rt++){const gt=nt[rt];ot[rt]=new HorizontalRange(gt.left,gt.width)}return ot}constructor(nt,ot){this._horizontalRangeBrand=void 0,this.left=Math.round(nt),this.width=Math.round(ot)}toString(){return`[${this.left},${this.width}]`}}class FloatHorizontalRange{constructor(nt,ot){this._floatHorizontalRangeBrand=void 0,this.left=nt,this.width=ot}toString(){return`[${this.left},${this.width}]`}static compare(nt,ot){return nt.left-ot.left}}class HorizontalPosition{constructor(nt,ot){this.outsideRenderedLine=nt,this.originalLeft=ot,this.left=Math.round(this.originalLeft)}}class VisibleRanges{constructor(nt,ot){this.outsideRenderedLine=nt,this.ranges=ot}}class RangeUtil{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(nt,ot){nt.selectNodeContents(ot)}static _readClientRects(nt,ot,rt,ut,gt){const pt=this._createRange();try{return pt.setStart(nt,ot),pt.setEnd(rt,ut),pt.getClientRects()}catch{return null}finally{this._detachRange(pt,gt)}}static _mergeAdjacentRanges(nt){if(nt.length===1)return nt;nt.sort(FloatHorizontalRange.compare);const ot=[];let rt=0,ut=nt[0];for(let gt=1,pt=nt.length;gt<pt;gt++){const mt=nt[gt];ut.left+ut.width+.9>=mt.left?ut.width=Math.max(ut.width,mt.left+mt.width-ut.left):(ot[rt++]=ut,ut=mt)}return ot[rt++]=ut,ot}static _createHorizontalRangesFromClientRects(nt,ot,rt){if(!nt||nt.length===0)return null;const ut=[];for(let gt=0,pt=nt.length;gt<pt;gt++){const mt=nt[gt];ut[gt]=new FloatHorizontalRange(Math.max(0,(mt.left-ot)/rt),mt.width/rt)}return this._mergeAdjacentRanges(ut)}static readHorizontalRanges(nt,ot,rt,ut,gt,pt){const vt=nt.children.length-1;if(0>vt)return null;if(ot=Math.min(vt,Math.max(0,ot)),ut=Math.min(vt,Math.max(0,ut)),ot===ut&&rt===gt&&rt===0&&!nt.children[ot].firstChild){const Lt=nt.children[ot].getClientRects();return pt.markDidDomLayout(),this._createHorizontalRangesFromClientRects(Lt,pt.clientRectDeltaLeft,pt.clientRectScale)}ot!==ut&&ut>0&&gt===0&&(ut--,gt=1073741824);let St=nt.children[ot].firstChild,yt=nt.children[ut].firstChild;if((!St||!yt)&&(!St&&rt===0&&ot>0&&(St=nt.children[ot-1].firstChild,rt=1073741824),!yt&&gt===0&&ut>0&&(yt=nt.children[ut-1].firstChild,gt=1073741824)),!St||!yt)return null;rt=Math.min(St.textContent.length,Math.max(0,rt)),gt=Math.min(yt.textContent.length,Math.max(0,gt));const wt=this._readClientRects(St,rt,yt,gt,pt.endNode);return pt.markDidDomLayout(),this._createHorizontalRangesFromClientRects(wt,pt.clientRectDeltaLeft,pt.clientRectScale)}}var ColorScheme;(function(ct){ct.DARK="dark",ct.LIGHT="light",ct.HIGH_CONTRAST_DARK="hcDark",ct.HIGH_CONTRAST_LIGHT="hcLight"})(ColorScheme||(ColorScheme={}));function isHighContrast(ct){return ct===ColorScheme.HIGH_CONTRAST_DARK||ct===ColorScheme.HIGH_CONTRAST_LIGHT}function isDark(ct){return ct===ColorScheme.DARK||ct===ColorScheme.HIGH_CONTRAST_DARK}const canUseFastRenderedViewLine=function(){return isNative?!0:!(isLinux||isFirefox||isSafari)}();let monospaceAssumptionsAreValid=!0;class ViewLineOptions{constructor(nt,ot){this.themeType=ot;const rt=nt.options,ut=rt.get(48);rt.get(36)==="off"?this.renderWhitespace=rt.get(94):this.renderWhitespace="none",this.renderControlCharacters=rt.get(89),this.spaceWidth=ut.spaceWidth,this.middotWidth=ut.middotWidth,this.wsmiddotWidth=ut.wsmiddotWidth,this.useMonospaceOptimizations=ut.isMonospace&&!rt.get(31),this.canUseHalfwidthRightwardsArrow=ut.canUseHalfwidthRightwardsArrow,this.lineHeight=rt.get(64),this.stopRenderingLineAfter=rt.get(112),this.fontLigatures=rt.get(49)}equals(nt){return this.themeType===nt.themeType&&this.renderWhitespace===nt.renderWhitespace&&this.renderControlCharacters===nt.renderControlCharacters&&this.spaceWidth===nt.spaceWidth&&this.middotWidth===nt.middotWidth&&this.wsmiddotWidth===nt.wsmiddotWidth&&this.useMonospaceOptimizations===nt.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===nt.canUseHalfwidthRightwardsArrow&&this.lineHeight===nt.lineHeight&&this.stopRenderingLineAfter===nt.stopRenderingLineAfter&&this.fontLigatures===nt.fontLigatures}}class ViewLine{constructor(nt){this._options=nt,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(nt){if(this._renderedViewLine)this._renderedViewLine.domNode=createFastDomNode(nt);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(nt){this._isMaybeInvalid=!0,this._options=nt}onSelectionChanged(){return isHighContrast(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(nt,ot,rt,ut){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const gt=rt.getViewLineRenderingData(nt),pt=this._options,mt=LineDecoration.filter(gt.inlineDecorations,nt,gt.minColumn,gt.maxColumn);let vt=null;if(isHighContrast(pt.themeType)||this._options.renderWhitespace==="selection"){const Lt=rt.selections;for(const xt of Lt){if(xt.endLineNumber<nt||xt.startLineNumber>nt)continue;const It=xt.startLineNumber===nt?xt.startColumn:gt.minColumn,kt=xt.endLineNumber===nt?xt.endColumn:gt.maxColumn;It<kt&&(isHighContrast(pt.themeType)&&mt.push(new LineDecoration(It,kt,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(vt||(vt=[]),vt.push(new LineRange(It-1,kt-1))))}}const St=new RenderLineInput(pt.useMonospaceOptimizations,pt.canUseHalfwidthRightwardsArrow,gt.content,gt.continuesWithWrappedLine,gt.isBasicASCII,gt.containsRTL,gt.minColumn-1,gt.tokens,mt,gt.tabSize,gt.startVisibleColumn,pt.spaceWidth,pt.middotWidth,pt.wsmiddotWidth,pt.stopRenderingLineAfter,pt.renderWhitespace,pt.renderControlCharacters,pt.fontLigatures!==EditorFontLigatures.OFF,vt);if(this._renderedViewLine&&this._renderedViewLine.input.equals(St))return!1;ut.appendString('<div style="top:'),ut.appendString(String(ot)),ut.appendString("px;height:"),ut.appendString(String(this._options.lineHeight)),ut.appendString('px;" class="'),ut.appendString(ViewLine.CLASS_NAME),ut.appendString('">');const yt=renderViewLine(St,ut);ut.appendString("</div>");let wt=null;return monospaceAssumptionsAreValid&&canUseFastRenderedViewLine&&gt.isBasicASCII&&pt.useMonospaceOptimizations&&yt.containsForeignElements===0&&(wt=new FastRenderedViewLine(this._renderedViewLine?this._renderedViewLine.domNode:null,St,yt.characterMapping)),wt||(wt=createRenderedLine(this._renderedViewLine?this._renderedViewLine.domNode:null,St,yt.characterMapping,yt.containsRTL,yt.containsForeignElements)),this._renderedViewLine=wt,!0}layoutLine(nt,ot){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(ot),this._renderedViewLine.domNode.setHeight(this._options.lineHeight))}getWidth(nt){return this._renderedViewLine?this._renderedViewLine.getWidth(nt):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof FastRenderedViewLine:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof FastRenderedViewLine?this._renderedViewLine.monospaceAssumptionsAreValid():monospaceAssumptionsAreValid}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof FastRenderedViewLine&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(nt,ot,rt,ut){if(!this._renderedViewLine)return null;ot=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,ot)),rt=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,rt));const gt=this._renderedViewLine.input.stopRenderingLineAfter;if(gt!==-1&&ot>gt+1&&rt>gt+1)return new VisibleRanges(!0,[new FloatHorizontalRange(this.getWidth(ut),0)]);gt!==-1&&ot>gt+1&&(ot=gt+1),gt!==-1&&rt>gt+1&&(rt=gt+1);const pt=this._renderedViewLine.getVisibleRangesForRange(nt,ot,rt,ut);return pt&&pt.length>0?new VisibleRanges(!1,pt):null}getColumnOfNodeOffset(nt,ot,rt){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(nt,ot,rt):1}}ViewLine.CLASS_NAME="view-line";class FastRenderedViewLine{constructor(nt,ot,rt){this._cachedWidth=-1,this.domNode=nt,this.input=ot;const ut=Math.floor(ot.lineContent.length/300);if(ut>0){this._keyColumnPixelOffsetCache=new Float32Array(ut);for(let gt=0;gt<ut;gt++)this._keyColumnPixelOffsetCache[gt]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=rt,this._charWidth=ot.spaceWidth}getWidth(nt){if(!this.domNode||this.input.lineContent.length<300){const ot=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*ot)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,nt==null||nt.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return monospaceAssumptionsAreValid;if(this.input.lineContent.length<300){const nt=this.getWidth(null),ot=this.domNode.domNode.firstChild.offsetWidth;Math.abs(nt-ot)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),monospaceAssumptionsAreValid=!1)}return monospaceAssumptionsAreValid}toSlowRenderedLine(){return createRenderedLine(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(nt,ot,rt,ut){const gt=this._getColumnPixelOffset(nt,ot,ut),pt=this._getColumnPixelOffset(nt,rt,ut);return[new FloatHorizontalRange(gt,pt-gt)]}_getColumnPixelOffset(nt,ot,rt){if(ot<=300){const St=this._characterMapping.getHorizontalOffset(ot);return this._charWidth*St}const ut=Math.floor((ot-1)/300)-1,gt=(ut+1)*300+1;let pt=-1;if(this._keyColumnPixelOffsetCache&&(pt=this._keyColumnPixelOffsetCache[ut],pt===-1&&(pt=this._actualReadPixelOffset(nt,gt,rt),this._keyColumnPixelOffsetCache[ut]=pt)),pt===-1){const St=this._characterMapping.getHorizontalOffset(ot);return this._charWidth*St}const mt=this._characterMapping.getHorizontalOffset(gt),vt=this._characterMapping.getHorizontalOffset(ot);return pt+this._charWidth*(vt-mt)}_getReadingTarget(nt){return nt.domNode.firstChild}_actualReadPixelOffset(nt,ot,rt){if(!this.domNode)return-1;const ut=this._characterMapping.getDomPosition(ot),gt=RangeUtil.readHorizontalRanges(this._getReadingTarget(this.domNode),ut.partIndex,ut.charIndex,ut.partIndex,ut.charIndex,rt);return!gt||gt.length===0?-1:gt[0].left}getColumnOfNodeOffset(nt,ot,rt){const ut=ot.textContent.length;let gt=-1;for(;ot;)ot=ot.previousSibling,gt++;return this._characterMapping.getColumn(new DomPosition(gt,rt),ut)}}class RenderedViewLine{constructor(nt,ot,rt,ut,gt){if(this.domNode=nt,this.input=ot,this._characterMapping=rt,this._isWhitespaceOnly=/^\s*$/.test(ot.lineContent),this._containsForeignElements=gt,this._cachedWidth=-1,this._pixelOffsetCache=null,!ut||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let pt=0,mt=this._characterMapping.length;pt<=mt;pt++)this._pixelOffsetCache[pt]=-1}}_getReadingTarget(nt){return nt.domNode.firstChild}getWidth(nt){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,nt==null||nt.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(nt,ot,rt,ut){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const gt=this._readPixelOffset(this.domNode,nt,ot,ut);if(gt===-1)return null;const pt=this._readPixelOffset(this.domNode,nt,rt,ut);return pt===-1?null:[new FloatHorizontalRange(gt,pt-gt)]}return this._readVisibleRangesForRange(this.domNode,nt,ot,rt,ut)}_readVisibleRangesForRange(nt,ot,rt,ut,gt){if(rt===ut){const pt=this._readPixelOffset(nt,ot,rt,gt);return pt===-1?null:[new FloatHorizontalRange(pt,0)]}else return this._readRawVisibleRangesForRange(nt,rt,ut,gt)}_readPixelOffset(nt,ot,rt,ut){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(ut);const gt=this._getReadingTarget(nt);return gt.firstChild?(ut.markDidDomLayout(),gt.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){const gt=this._pixelOffsetCache[rt];if(gt!==-1)return gt;const pt=this._actualReadPixelOffset(nt,ot,rt,ut);return this._pixelOffsetCache[rt]=pt,pt}return this._actualReadPixelOffset(nt,ot,rt,ut)}_actualReadPixelOffset(nt,ot,rt,ut){if(this._characterMapping.length===0){const vt=RangeUtil.readHorizontalRanges(this._getReadingTarget(nt),0,0,0,0,ut);return!vt||vt.length===0?-1:vt[0].left}if(rt===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(ut);const gt=this._characterMapping.getDomPosition(rt),pt=RangeUtil.readHorizontalRanges(this._getReadingTarget(nt),gt.partIndex,gt.charIndex,gt.partIndex,gt.charIndex,ut);if(!pt||pt.length===0)return-1;const mt=pt[0].left;if(this.input.isBasicASCII){const vt=this._characterMapping.getHorizontalOffset(rt),St=Math.round(this.input.spaceWidth*vt);if(Math.abs(St-mt)<=1)return St}return mt}_readRawVisibleRangesForRange(nt,ot,rt,ut){if(ot===1&&rt===this._characterMapping.length)return[new FloatHorizontalRange(0,this.getWidth(ut))];const gt=this._characterMapping.getDomPosition(ot),pt=this._characterMapping.getDomPosition(rt);return RangeUtil.readHorizontalRanges(this._getReadingTarget(nt),gt.partIndex,gt.charIndex,pt.partIndex,pt.charIndex,ut)}getColumnOfNodeOffset(nt,ot,rt){const ut=ot.textContent.length;let gt=-1;for(;ot;)ot=ot.previousSibling,gt++;return this._characterMapping.getColumn(new DomPosition(gt,rt),ut)}}class WebKitRenderedViewLine extends RenderedViewLine{_readVisibleRangesForRange(nt,ot,rt,ut,gt){const pt=super._readVisibleRangesForRange(nt,ot,rt,ut,gt);if(!pt||pt.length===0||rt===ut||rt===1&&ut===this._characterMapping.length)return pt;if(!this.input.containsRTL){const mt=this._readPixelOffset(nt,ot,ut,gt);if(mt!==-1){const vt=pt[pt.length-1];vt.left<mt&&(vt.width=mt-vt.left)}}return pt}}const createRenderedLine=function(){return isWebKit?createWebKitRenderedLine:createNormalRenderedLine}();function createWebKitRenderedLine(ct,nt,ot,rt,ut){return new WebKitRenderedViewLine(ct,nt,ot,rt,ut)}function createNormalRenderedLine(ct,nt,ot,rt,ut){return new RenderedViewLine(ct,nt,ot,rt,ut)}class CursorColumns{static _nextVisibleColumn(nt,ot,rt){return nt===9?CursorColumns.nextRenderTabStop(ot,rt):isFullWidthCharacter(nt)||isEmojiImprecise(nt)?ot+2:ot+1}static visibleColumnFromColumn(nt,ot,rt){const ut=Math.min(ot-1,nt.length),gt=nt.substring(0,ut),pt=new GraphemeIterator(gt);let mt=0;for(;!pt.eol();){const vt=getNextCodePoint(gt,ut,pt.offset);pt.nextGraphemeLength(),mt=this._nextVisibleColumn(vt,mt,rt)}return mt}static columnFromVisibleColumn(nt,ot,rt){if(ot<=0)return 1;const ut=nt.length,gt=new GraphemeIterator(nt);let pt=0,mt=1;for(;!gt.eol();){const vt=getNextCodePoint(nt,ut,gt.offset);gt.nextGraphemeLength();const St=this._nextVisibleColumn(vt,pt,rt),yt=gt.offset+1;if(St>=ot){const wt=ot-pt;return St-ot<wt?yt:mt}pt=St,mt=yt}return ut+1}static nextRenderTabStop(nt,ot){return nt+ot-nt%ot}static nextIndentTabStop(nt,ot){return nt+ot-nt%ot}static prevRenderTabStop(nt,ot){return Math.max(0,nt-1-(nt-1)%ot)}static prevIndentTabStop(nt,ot){return Math.max(0,nt-1-(nt-1)%ot)}}class AtomicTabMoveOperations{static whitespaceVisibleColumn(nt,ot,rt){const ut=nt.length;let gt=0,pt=-1,mt=-1;for(let vt=0;vt<ut;vt++){if(vt===ot)return[pt,mt,gt];switch(gt%rt===0&&(pt=vt,mt=gt),nt.charCodeAt(vt)){case 32:gt+=1;break;case 9:gt=CursorColumns.nextRenderTabStop(gt,rt);break;default:return[-1,-1,-1]}}return ot===ut?[pt,mt,gt]:[-1,-1,-1]}static atomicPosition(nt,ot,rt,ut){const gt=nt.length,[pt,mt,vt]=AtomicTabMoveOperations.whitespaceVisibleColumn(nt,ot,rt);if(vt===-1)return-1;let St;switch(ut){case 0:St=!0;break;case 1:St=!1;break;case 2:if(vt%rt===0)return ot;St=vt%rt<=rt/2;break}if(St){if(pt===-1)return-1;let Lt=mt;for(let xt=pt;xt<gt;++xt){if(Lt===mt+rt)return pt;switch(nt.charCodeAt(xt)){case 32:Lt+=1;break;case 9:Lt=CursorColumns.nextRenderTabStop(Lt,rt);break;default:return-1}}return Lt===mt+rt?pt:-1}const yt=CursorColumns.nextRenderTabStop(vt,rt);let wt=vt;for(let Lt=ot;Lt<gt;Lt++){if(wt===yt)return Lt;switch(nt.charCodeAt(Lt)){case 32:wt+=1;break;case 9:wt=CursorColumns.nextRenderTabStop(wt,rt);break;default:return-1}}return wt===yt?gt:-1}}class UnknownHitTestResult{constructor(nt=null){this.hitTarget=nt,this.type=0}}class ContentHitTestResult{constructor(nt,ot,rt){this.position=nt,this.spanNode=ot,this.injectedText=rt,this.type=1}}var HitTestResult;(function(ct){function nt(ot,rt,ut){const gt=ot.getPositionFromDOMInfo(rt,ut);return gt?new ContentHitTestResult(gt,rt,null):new UnknownHitTestResult(rt)}ct.createFromDOMInfo=nt})(HitTestResult||(HitTestResult={}));class PointerHandlerLastRenderData{constructor(nt,ot){this.lastViewCursorsRenderData=nt,this.lastTextareaPosition=ot}}class MouseTarget{static _deduceRage(nt,ot=null){return!ot&&nt?new Range$2(nt.lineNumber,nt.column,nt.lineNumber,nt.column):ot??null}static createUnknown(nt,ot,rt){return{type:0,element:nt,mouseColumn:ot,position:rt,range:this._deduceRage(rt)}}static createTextarea(nt,ot){return{type:1,element:nt,mouseColumn:ot,position:null,range:null}}static createMargin(nt,ot,rt,ut,gt,pt){return{type:nt,element:ot,mouseColumn:rt,position:ut,range:gt,detail:pt}}static createViewZone(nt,ot,rt,ut,gt){return{type:nt,element:ot,mouseColumn:rt,position:ut,range:this._deduceRage(ut),detail:gt}}static createContentText(nt,ot,rt,ut,gt){return{type:6,element:nt,mouseColumn:ot,position:rt,range:this._deduceRage(rt,ut),detail:gt}}static createContentEmpty(nt,ot,rt,ut){return{type:7,element:nt,mouseColumn:ot,position:rt,range:this._deduceRage(rt),detail:ut}}static createContentWidget(nt,ot,rt){return{type:9,element:nt,mouseColumn:ot,position:null,range:null,detail:rt}}static createScrollbar(nt,ot,rt){return{type:11,element:nt,mouseColumn:ot,position:rt,range:this._deduceRage(rt)}}static createOverlayWidget(nt,ot,rt){return{type:12,element:nt,mouseColumn:ot,position:null,range:null,detail:rt}}static createOutsideEditor(nt,ot,rt,ut){return{type:13,element:null,mouseColumn:nt,position:ot,range:this._deduceRage(ot),outsidePosition:rt,outsideDistance:ut}}static _typeToString(nt){return nt===1?"TEXTAREA":nt===2?"GUTTER_GLYPH_MARGIN":nt===3?"GUTTER_LINE_NUMBERS":nt===4?"GUTTER_LINE_DECORATIONS":nt===5?"GUTTER_VIEW_ZONE":nt===6?"CONTENT_TEXT":nt===7?"CONTENT_EMPTY":nt===8?"CONTENT_VIEW_ZONE":nt===9?"CONTENT_WIDGET":nt===10?"OVERVIEW_RULER":nt===11?"SCROLLBAR":nt===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(nt){return this._typeToString(nt.type)+": "+nt.position+" - "+nt.range+" - "+JSON.stringify(nt.detail)}}class ElementPath{static isTextArea(nt){return nt.length===2&&nt[0]===3&&nt[1]===6}static isChildOfViewLines(nt){return nt.length>=4&&nt[0]===3&&nt[3]===7}static isStrictChildOfViewLines(nt){return nt.length>4&&nt[0]===3&&nt[3]===7}static isChildOfScrollableElement(nt){return nt.length>=2&&nt[0]===3&&nt[1]===5}static isChildOfMinimap(nt){return nt.length>=2&&nt[0]===3&&nt[1]===8}static isChildOfContentWidgets(nt){return nt.length>=4&&nt[0]===3&&nt[3]===1}static isChildOfOverflowingContentWidgets(nt){return nt.length>=1&&nt[0]===2}static isChildOfOverlayWidgets(nt){return nt.length>=2&&nt[0]===3&&nt[1]===4}}class HitTestContext{constructor(nt,ot,rt){this.viewModel=nt.viewModel;const ut=nt.configuration.options;this.layoutInfo=ut.get(139),this.viewDomNode=ot.viewDomNode,this.lineHeight=ut.get(64),this.stickyTabStops=ut.get(111),this.typicalHalfwidthCharacterWidth=ut.get(48).typicalHalfwidthCharacterWidth,this.lastRenderData=rt,this._context=nt,this._viewHelper=ot}getZoneAtCoord(nt){return HitTestContext.getZoneAtCoord(this._context,nt)}static getZoneAtCoord(nt,ot){const rt=nt.viewLayout.getWhitespaceAtVerticalOffset(ot);if(rt){const ut=rt.verticalOffset+rt.height/2,gt=nt.viewModel.getLineCount();let pt=null,mt,vt=null;return rt.afterLineNumber!==gt&&(vt=new Position$1(rt.afterLineNumber+1,1)),rt.afterLineNumber>0&&(pt=new Position$1(rt.afterLineNumber,nt.viewModel.getLineMaxColumn(rt.afterLineNumber))),vt===null?mt=pt:pt===null?mt=vt:ot<ut?mt=pt:mt=vt,{viewZoneId:rt.id,afterLineNumber:rt.afterLineNumber,positionBefore:pt,positionAfter:vt,position:mt}}return null}getFullLineRangeAtCoord(nt){if(this._context.viewLayout.isAfterLines(nt)){const ut=this._context.viewModel.getLineCount(),gt=this._context.viewModel.getLineMaxColumn(ut);return{range:new Range$2(ut,gt,ut,gt),isAfterLines:!0}}const ot=this._context.viewLayout.getLineNumberAtVerticalOffset(nt),rt=this._context.viewModel.getLineMaxColumn(ot);return{range:new Range$2(ot,1,ot,rt),isAfterLines:!1}}getLineNumberAtVerticalOffset(nt){return this._context.viewLayout.getLineNumberAtVerticalOffset(nt)}isAfterLines(nt){return this._context.viewLayout.isAfterLines(nt)}isInTopPadding(nt){return this._context.viewLayout.isInTopPadding(nt)}isInBottomPadding(nt){return this._context.viewLayout.isInBottomPadding(nt)}getVerticalOffsetForLineNumber(nt){return this._context.viewLayout.getVerticalOffsetForLineNumber(nt)}findAttribute(nt,ot){return HitTestContext._findAttribute(nt,ot,this._viewHelper.viewDomNode)}static _findAttribute(nt,ot,rt){for(;nt&&nt!==document.body;){if(nt.hasAttribute&&nt.hasAttribute(ot))return nt.getAttribute(ot);if(nt===rt)return null;nt=nt.parentNode}return null}getLineWidth(nt){return this._viewHelper.getLineWidth(nt)}visibleRangeForPosition(nt,ot){return this._viewHelper.visibleRangeForPosition(nt,ot)}getPositionFromDOMInfo(nt,ot){return this._viewHelper.getPositionFromDOMInfo(nt,ot)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class BareHitTestRequest{constructor(nt,ot,rt,ut){this.editorPos=ot,this.pos=rt,this.relativePos=ut,this.mouseVerticalOffset=Math.max(0,nt.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=nt.getCurrentScrollLeft()+this.relativePos.x-nt.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<nt.layoutInfo.contentLeft&&this.relativePos.x>=nt.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,MouseTargetFactory._getMouseColumn(this.mouseContentHorizontalOffset,nt.typicalHalfwidthCharacterWidth))}}class HitTestRequest extends BareHitTestRequest{constructor(nt,ot,rt,ut,gt){super(nt,ot,rt,ut),this._ctx=nt,gt?(this.target=gt,this.targetPath=PartFingerprints.collect(gt,nt.viewDomNode)):(this.target=null,this.targetPath=new Uint8Array(0))}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}_getMouseColumn(nt=null){return nt&&nt.column<this._ctx.viewModel.getLineMaxColumn(nt.lineNumber)?CursorColumns.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(nt.lineNumber),nt.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(nt=null){return MouseTarget.createUnknown(this.target,this._getMouseColumn(nt),nt)}fulfillTextarea(){return MouseTarget.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(nt,ot,rt,ut){return MouseTarget.createMargin(nt,this.target,this._getMouseColumn(ot),ot,rt,ut)}fulfillViewZone(nt,ot,rt){return MouseTarget.createViewZone(nt,this.target,this._getMouseColumn(ot),ot,rt)}fulfillContentText(nt,ot,rt){return MouseTarget.createContentText(this.target,this._getMouseColumn(nt),nt,ot,rt)}fulfillContentEmpty(nt,ot){return MouseTarget.createContentEmpty(this.target,this._getMouseColumn(nt),nt,ot)}fulfillContentWidget(nt){return MouseTarget.createContentWidget(this.target,this._getMouseColumn(),nt)}fulfillScrollbar(nt){return MouseTarget.createScrollbar(this.target,this._getMouseColumn(nt),nt)}fulfillOverlayWidget(nt){return MouseTarget.createOverlayWidget(this.target,this._getMouseColumn(),nt)}withTarget(nt){return new HitTestRequest(this._ctx,this.editorPos,this.pos,this.relativePos,nt)}}const EMPTY_CONTENT_AFTER_LINES={isAfterLines:!0};function createEmptyContentDataInLines(ct){return{isAfterLines:!1,horizontalDistanceToText:ct}}class MouseTargetFactory{constructor(nt,ot){this._context=nt,this._viewHelper=ot}mouseTargetIsWidget(nt){const ot=nt.target,rt=PartFingerprints.collect(ot,this._viewHelper.viewDomNode);return!!(ElementPath.isChildOfContentWidgets(rt)||ElementPath.isChildOfOverflowingContentWidgets(rt)||ElementPath.isChildOfOverlayWidgets(rt))}createMouseTarget(nt,ot,rt,ut,gt){const pt=new HitTestContext(this._context,this._viewHelper,nt),mt=new HitTestRequest(pt,ot,rt,ut,gt);try{const vt=MouseTargetFactory._createMouseTarget(pt,mt,!1);if(vt.type===6&&pt.stickyTabStops&&vt.position!==null){const St=MouseTargetFactory._snapToSoftTabBoundary(vt.position,pt.viewModel),yt=Range$2.fromPositions(St,St).plusRange(vt.range);return mt.fulfillContentText(St,yt,vt.detail)}return vt}catch{return mt.fulfillUnknown()}}static _createMouseTarget(nt,ot,rt){if(ot.target===null){if(rt)return ot.fulfillUnknown();const pt=MouseTargetFactory._doHitTest(nt,ot);return pt.type===1?MouseTargetFactory.createMouseTargetFromHitTestPosition(nt,ot,pt.spanNode,pt.position,pt.injectedText):this._createMouseTarget(nt,ot.withTarget(pt.hitTarget),!0)}const ut=ot;let gt=null;return gt=gt||MouseTargetFactory._hitTestContentWidget(nt,ut),gt=gt||MouseTargetFactory._hitTestOverlayWidget(nt,ut),gt=gt||MouseTargetFactory._hitTestMinimap(nt,ut),gt=gt||MouseTargetFactory._hitTestScrollbarSlider(nt,ut),gt=gt||MouseTargetFactory._hitTestViewZone(nt,ut),gt=gt||MouseTargetFactory._hitTestMargin(nt,ut),gt=gt||MouseTargetFactory._hitTestViewCursor(nt,ut),gt=gt||MouseTargetFactory._hitTestTextArea(nt,ut),gt=gt||MouseTargetFactory._hitTestViewLines(nt,ut,rt),gt=gt||MouseTargetFactory._hitTestScrollbar(nt,ut),gt||ot.fulfillUnknown()}static _hitTestContentWidget(nt,ot){if(ElementPath.isChildOfContentWidgets(ot.targetPath)||ElementPath.isChildOfOverflowingContentWidgets(ot.targetPath)){const rt=nt.findAttribute(ot.target,"widgetId");return rt?ot.fulfillContentWidget(rt):ot.fulfillUnknown()}return null}static _hitTestOverlayWidget(nt,ot){if(ElementPath.isChildOfOverlayWidgets(ot.targetPath)){const rt=nt.findAttribute(ot.target,"widgetId");return rt?ot.fulfillOverlayWidget(rt):ot.fulfillUnknown()}return null}static _hitTestViewCursor(nt,ot){if(ot.target){const rt=nt.lastRenderData.lastViewCursorsRenderData;for(const ut of rt)if(ot.target===ut.domNode)return ot.fulfillContentText(ut.position,null,{mightBeForeignElement:!1,injectedText:null})}if(ot.isInContentArea){const rt=nt.lastRenderData.lastViewCursorsRenderData,ut=ot.mouseContentHorizontalOffset,gt=ot.mouseVerticalOffset;for(const pt of rt){if(ut<pt.contentLeft||ut>pt.contentLeft+pt.width)continue;const mt=nt.getVerticalOffsetForLineNumber(pt.position.lineNumber);if(mt<=gt&&gt<=mt+pt.height)return ot.fulfillContentText(pt.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(nt,ot){const rt=nt.getZoneAtCoord(ot.mouseVerticalOffset);if(rt){const ut=ot.isInContentArea?8:5;return ot.fulfillViewZone(ut,rt.position,rt)}return null}static _hitTestTextArea(nt,ot){return ElementPath.isTextArea(ot.targetPath)?nt.lastRenderData.lastTextareaPosition?ot.fulfillContentText(nt.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):ot.fulfillTextarea():null}static _hitTestMargin(nt,ot){if(ot.isInMarginArea){const rt=nt.getFullLineRangeAtCoord(ot.mouseVerticalOffset),ut=rt.range.getStartPosition();let gt=Math.abs(ot.relativePos.x);const pt={isAfterLines:rt.isAfterLines,glyphMarginLeft:nt.layoutInfo.glyphMarginLeft,glyphMarginWidth:nt.layoutInfo.glyphMarginWidth,lineNumbersWidth:nt.layoutInfo.lineNumbersWidth,offsetX:gt};return gt-=nt.layoutInfo.glyphMarginLeft,gt<=nt.layoutInfo.glyphMarginWidth?ot.fulfillMargin(2,ut,rt.range,pt):(gt-=nt.layoutInfo.glyphMarginWidth,gt<=nt.layoutInfo.lineNumbersWidth?ot.fulfillMargin(3,ut,rt.range,pt):(gt-=nt.layoutInfo.lineNumbersWidth,ot.fulfillMargin(4,ut,rt.range,pt)))}return null}static _hitTestViewLines(nt,ot,rt){if(!ElementPath.isChildOfViewLines(ot.targetPath))return null;if(nt.isInTopPadding(ot.mouseVerticalOffset))return ot.fulfillContentEmpty(new Position$1(1,1),EMPTY_CONTENT_AFTER_LINES);if(nt.isAfterLines(ot.mouseVerticalOffset)||nt.isInBottomPadding(ot.mouseVerticalOffset)){const gt=nt.viewModel.getLineCount(),pt=nt.viewModel.getLineMaxColumn(gt);return ot.fulfillContentEmpty(new Position$1(gt,pt),EMPTY_CONTENT_AFTER_LINES)}if(rt){if(ElementPath.isStrictChildOfViewLines(ot.targetPath)){const gt=nt.getLineNumberAtVerticalOffset(ot.mouseVerticalOffset);if(nt.viewModel.getLineLength(gt)===0){const mt=nt.getLineWidth(gt),vt=createEmptyContentDataInLines(ot.mouseContentHorizontalOffset-mt);return ot.fulfillContentEmpty(new Position$1(gt,1),vt)}const pt=nt.getLineWidth(gt);if(ot.mouseContentHorizontalOffset>=pt){const mt=createEmptyContentDataInLines(ot.mouseContentHorizontalOffset-pt),vt=new Position$1(gt,nt.viewModel.getLineMaxColumn(gt));return ot.fulfillContentEmpty(vt,mt)}}return ot.fulfillUnknown()}const ut=MouseTargetFactory._doHitTest(nt,ot);return ut.type===1?MouseTargetFactory.createMouseTargetFromHitTestPosition(nt,ot,ut.spanNode,ut.position,ut.injectedText):this._createMouseTarget(nt,ot.withTarget(ut.hitTarget),!0)}static _hitTestMinimap(nt,ot){if(ElementPath.isChildOfMinimap(ot.targetPath)){const rt=nt.getLineNumberAtVerticalOffset(ot.mouseVerticalOffset),ut=nt.viewModel.getLineMaxColumn(rt);return ot.fulfillScrollbar(new Position$1(rt,ut))}return null}static _hitTestScrollbarSlider(nt,ot){if(ElementPath.isChildOfScrollableElement(ot.targetPath)&&ot.target&&ot.target.nodeType===1){const rt=ot.target.className;if(rt&&/\b(slider|scrollbar)\b/.test(rt)){const ut=nt.getLineNumberAtVerticalOffset(ot.mouseVerticalOffset),gt=nt.viewModel.getLineMaxColumn(ut);return ot.fulfillScrollbar(new Position$1(ut,gt))}}return null}static _hitTestScrollbar(nt,ot){if(ElementPath.isChildOfScrollableElement(ot.targetPath)){const rt=nt.getLineNumberAtVerticalOffset(ot.mouseVerticalOffset),ut=nt.viewModel.getLineMaxColumn(rt);return ot.fulfillScrollbar(new Position$1(rt,ut))}return null}getMouseColumn(nt){const ot=this._context.configuration.options,rt=ot.get(139),ut=this._context.viewLayout.getCurrentScrollLeft()+nt.x-rt.contentLeft;return MouseTargetFactory._getMouseColumn(ut,ot.get(48).typicalHalfwidthCharacterWidth)}static _getMouseColumn(nt,ot){return nt<0?1:Math.round(nt/ot)+1}static createMouseTargetFromHitTestPosition(nt,ot,rt,ut,gt){const pt=ut.lineNumber,mt=ut.column,vt=nt.getLineWidth(pt);if(ot.mouseContentHorizontalOffset>vt){const Tt=createEmptyContentDataInLines(ot.mouseContentHorizontalOffset-vt);return ot.fulfillContentEmpty(ut,Tt)}const St=nt.visibleRangeForPosition(pt,mt);if(!St)return ot.fulfillUnknown(ut);const yt=St.left;if(Math.abs(ot.mouseContentHorizontalOffset-yt)<1)return ot.fulfillContentText(ut,null,{mightBeForeignElement:!!gt,injectedText:gt});const wt=[];if(wt.push({offset:St.left,column:mt}),mt>1){const Tt=nt.visibleRangeForPosition(pt,mt-1);Tt&&wt.push({offset:Tt.left,column:mt-1})}const Lt=nt.viewModel.getLineMaxColumn(pt);if(mt<Lt){const Tt=nt.visibleRangeForPosition(pt,mt+1);Tt&&wt.push({offset:Tt.left,column:mt+1})}wt.sort((Tt,Rt)=>Tt.offset-Rt.offset);const xt=ot.pos.toClientCoordinates(),It=rt.getBoundingClientRect(),kt=It.left<=xt.clientX&&xt.clientX<=It.right;let At=null;for(let Tt=1;Tt<wt.length;Tt++){const Rt=wt[Tt-1],Nt=wt[Tt];if(Rt.offset<=ot.mouseContentHorizontalOffset&&ot.mouseContentHorizontalOffset<=Nt.offset){At=new Range$2(pt,Rt.column,pt,Nt.column);const Pt=Math.abs(Rt.offset-ot.mouseContentHorizontalOffset),Ft=Math.abs(Nt.offset-ot.mouseContentHorizontalOffset);ut=Pt<Ft?new Position$1(pt,Rt.column):new Position$1(pt,Nt.column);break}}return ot.fulfillContentText(ut,At,{mightBeForeignElement:!kt||!!gt,injectedText:gt})}static _doHitTestWithCaretRangeFromPoint(nt,ot){const rt=nt.getLineNumberAtVerticalOffset(ot.mouseVerticalOffset),ut=nt.getVerticalOffsetForLineNumber(rt),gt=ut+nt.lineHeight;if(!(rt===nt.viewModel.getLineCount()&&ot.mouseVerticalOffset>gt)){const mt=Math.floor((ut+gt)/2);let vt=ot.pos.y+(mt-ot.mouseVerticalOffset);vt<=ot.editorPos.y&&(vt=ot.editorPos.y+1),vt>=ot.editorPos.y+ot.editorPos.height&&(vt=ot.editorPos.y+ot.editorPos.height-1);const St=new PageCoordinates(ot.pos.x,vt),yt=this._actualDoHitTestWithCaretRangeFromPoint(nt,St.toClientCoordinates());if(yt.type===1)return yt}return this._actualDoHitTestWithCaretRangeFromPoint(nt,ot.pos.toClientCoordinates())}static _actualDoHitTestWithCaretRangeFromPoint(nt,ot){const rt=getShadowRoot(nt.viewDomNode);let ut;if(rt?typeof rt.caretRangeFromPoint>"u"?ut=shadowCaretRangeFromPoint(rt,ot.clientX,ot.clientY):ut=rt.caretRangeFromPoint(ot.clientX,ot.clientY):ut=document.caretRangeFromPoint(ot.clientX,ot.clientY),!ut||!ut.startContainer)return new UnknownHitTestResult;const gt=ut.startContainer;if(gt.nodeType===gt.TEXT_NODE){const pt=gt.parentNode,mt=pt?pt.parentNode:null,vt=mt?mt.parentNode:null;return(vt&&vt.nodeType===vt.ELEMENT_NODE?vt.className:null)===ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(nt,pt,ut.startOffset):new UnknownHitTestResult(gt.parentNode)}else if(gt.nodeType===gt.ELEMENT_NODE){const pt=gt.parentNode,mt=pt?pt.parentNode:null;return(mt&&mt.nodeType===mt.ELEMENT_NODE?mt.className:null)===ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(nt,gt,gt.textContent.length):new UnknownHitTestResult(gt)}return new UnknownHitTestResult}static _doHitTestWithCaretPositionFromPoint(nt,ot){const rt=document.caretPositionFromPoint(ot.clientX,ot.clientY);if(rt.offsetNode.nodeType===rt.offsetNode.TEXT_NODE){const ut=rt.offsetNode.parentNode,gt=ut?ut.parentNode:null,pt=gt?gt.parentNode:null;return(pt&&pt.nodeType===pt.ELEMENT_NODE?pt.className:null)===ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(nt,rt.offsetNode.parentNode,rt.offset):new UnknownHitTestResult(rt.offsetNode.parentNode)}if(rt.offsetNode.nodeType===rt.offsetNode.ELEMENT_NODE){const ut=rt.offsetNode.parentNode,gt=ut&&ut.nodeType===ut.ELEMENT_NODE?ut.className:null,pt=ut?ut.parentNode:null,mt=pt&&pt.nodeType===pt.ELEMENT_NODE?pt.className:null;if(gt===ViewLine.CLASS_NAME){const vt=rt.offsetNode.childNodes[Math.min(rt.offset,rt.offsetNode.childNodes.length-1)];if(vt)return HitTestResult.createFromDOMInfo(nt,vt,0)}else if(mt===ViewLine.CLASS_NAME)return HitTestResult.createFromDOMInfo(nt,rt.offsetNode,0)}return new UnknownHitTestResult(rt.offsetNode)}static _snapToSoftTabBoundary(nt,ot){const rt=ot.getLineContent(nt.lineNumber),{tabSize:ut}=ot.model.getOptions(),gt=AtomicTabMoveOperations.atomicPosition(rt,nt.column-1,ut,2);return gt!==-1?new Position$1(nt.lineNumber,gt+1):nt}static _doHitTest(nt,ot){let rt=new UnknownHitTestResult;if(typeof document.caretRangeFromPoint=="function"?rt=this._doHitTestWithCaretRangeFromPoint(nt,ot):document.caretPositionFromPoint&&(rt=this._doHitTestWithCaretPositionFromPoint(nt,ot.pos.toClientCoordinates())),rt.type===1){const ut=nt.viewModel.getInjectedTextAt(rt.position),gt=nt.viewModel.normalizePosition(rt.position,2);(ut||!gt.equals(rt.position))&&(rt=new ContentHitTestResult(gt,rt.spanNode,ut))}return rt}}function shadowCaretRangeFromPoint(ct,nt,ot){const rt=document.createRange();let ut=ct.elementFromPoint(nt,ot);if(ut!==null){for(;ut&&ut.firstChild&&ut.firstChild.nodeType!==ut.firstChild.TEXT_NODE&&ut.lastChild&&ut.lastChild.firstChild;)ut=ut.lastChild;const gt=ut.getBoundingClientRect(),pt=window.getComputedStyle(ut,null).getPropertyValue("font-style"),mt=window.getComputedStyle(ut,null).getPropertyValue("font-variant"),vt=window.getComputedStyle(ut,null).getPropertyValue("font-weight"),St=window.getComputedStyle(ut,null).getPropertyValue("font-size"),yt=window.getComputedStyle(ut,null).getPropertyValue("line-height"),wt=window.getComputedStyle(ut,null).getPropertyValue("font-family"),Lt=`${pt} ${mt} ${vt} ${St}/${yt} ${wt}`,xt=ut.innerText;let It=gt.left,kt=0,At;if(nt>gt.left+gt.width)kt=xt.length;else{const Tt=CharWidthReader.getInstance();for(let Rt=0;Rt<xt.length+1;Rt++){if(At=Tt.getCharWidth(xt.charAt(Rt),Lt)/2,It+=At,nt<It){kt=Rt;break}It+=At}}rt.setStart(ut.firstChild,kt),rt.setEnd(ut.firstChild,kt)}return rt}class CharWidthReader{static getInstance(){return CharWidthReader._INSTANCE||(CharWidthReader._INSTANCE=new CharWidthReader),CharWidthReader._INSTANCE}constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(nt,ot){const rt=nt+ot;if(this._cache[rt])return this._cache[rt];const ut=this._canvas.getContext("2d");ut.font=ot;const pt=ut.measureText(nt).width;return this._cache[rt]=pt,pt}}CharWidthReader._INSTANCE=null;let Widget$1=class extends Disposable{onclick(nt,ot){this._register(addDisposableListener(nt,EventType$1.CLICK,rt=>ot(new StandardMouseEvent(rt))))}onmousedown(nt,ot){this._register(addDisposableListener(nt,EventType$1.MOUSE_DOWN,rt=>ot(new StandardMouseEvent(rt))))}onmouseover(nt,ot){this._register(addDisposableListener(nt,EventType$1.MOUSE_OVER,rt=>ot(new StandardMouseEvent(rt))))}onmouseleave(nt,ot){this._register(addDisposableListener(nt,EventType$1.MOUSE_LEAVE,rt=>ot(new StandardMouseEvent(rt))))}onkeydown(nt,ot){this._register(addDisposableListener(nt,EventType$1.KEY_DOWN,rt=>ot(new StandardKeyboardEvent(rt))))}onkeyup(nt,ot){this._register(addDisposableListener(nt,EventType$1.KEY_UP,rt=>ot(new StandardKeyboardEvent(rt))))}oninput(nt,ot){this._register(addDisposableListener(nt,EventType$1.INPUT,ot))}onblur(nt,ot){this._register(addDisposableListener(nt,EventType$1.BLUR,ot))}onfocus(nt,ot){this._register(addDisposableListener(nt,EventType$1.FOCUS,ot))}ignoreGesture(nt){return Gesture.ignoreTarget(nt)}};const ARROW_IMG_SIZE=11;class ScrollbarArrow extends Widget$1{constructor(nt){super(),this._onActivate=nt.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=nt.bgWidth+"px",this.bgDomNode.style.height=nt.bgHeight+"px",typeof nt.top<"u"&&(this.bgDomNode.style.top="0px"),typeof nt.left<"u"&&(this.bgDomNode.style.left="0px"),typeof nt.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof nt.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=nt.className,this.domNode.classList.add(...ThemeIcon.asClassNameArray(nt.icon)),this.domNode.style.position="absolute",this.domNode.style.width=ARROW_IMG_SIZE+"px",this.domNode.style.height=ARROW_IMG_SIZE+"px",typeof nt.top<"u"&&(this.domNode.style.top=nt.top+"px"),typeof nt.left<"u"&&(this.domNode.style.left=nt.left+"px"),typeof nt.bottom<"u"&&(this.domNode.style.bottom=nt.bottom+"px"),typeof nt.right<"u"&&(this.domNode.style.right=nt.right+"px"),this._pointerMoveMonitor=this._register(new GlobalPointerMoveMonitor),this._register(addStandardDisposableListener(this.bgDomNode,EventType$1.POINTER_DOWN,ot=>this._arrowPointerDown(ot))),this._register(addStandardDisposableListener(this.domNode,EventType$1.POINTER_DOWN,ot=>this._arrowPointerDown(ot))),this._pointerdownRepeatTimer=this._register(new IntervalTimer),this._pointerdownScheduleRepeatTimer=this._register(new TimeoutTimer)}_arrowPointerDown(nt){if(!nt.target||!(nt.target instanceof Element))return;const ot=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24)};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(ot,200),this._pointerMoveMonitor.startMonitoring(nt.target,nt.pointerId,nt.buttons,rt=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),nt.preventDefault()}}class ScrollbarVisibilityController extends Disposable{constructor(nt,ot,rt){super(),this._visibility=nt,this._visibleClassName=ot,this._invisibleClassName=rt,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new TimeoutTimer)}setVisibility(nt){this._visibility!==nt&&(this._visibility=nt,this._updateShouldBeVisible())}setShouldBeVisible(nt){this._rawShouldBeVisible=nt,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){const nt=this._applyVisibilitySetting();this._shouldBeVisible!==nt&&(this._shouldBeVisible=nt,this.ensureVisibility())}setIsNeeded(nt){this._isNeeded!==nt&&(this._isNeeded=nt,this.ensureVisibility())}setDomNode(nt){this._domNode=nt,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{var nt;(nt=this._domNode)===null||nt===void 0||nt.setClassName(this._visibleClassName)},0))}_hide(nt){var ot;this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,(ot=this._domNode)===null||ot===void 0||ot.setClassName(this._invisibleClassName+(nt?" fade":"")))}}const POINTER_DRAG_RESET_DISTANCE$1=140;class AbstractScrollbar extends Widget$1{constructor(nt){super(),this._lazyRender=nt.lazyRender,this._host=nt.host,this._scrollable=nt.scrollable,this._scrollByPage=nt.scrollByPage,this._scrollbarState=nt.scrollbarState,this._visibilityController=this._register(new ScrollbarVisibilityController(nt.visibility,"visible scrollbar "+nt.extraScrollbarClassName,"invisible scrollbar "+nt.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new GlobalPointerMoveMonitor),this._shouldRender=!0,this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(addDisposableListener(this.domNode.domNode,EventType$1.POINTER_DOWN,ot=>this._domNodePointerDown(ot)))}_createArrow(nt){const ot=this._register(new ScrollbarArrow(nt));this.domNode.domNode.appendChild(ot.bgDomNode),this.domNode.domNode.appendChild(ot.domNode)}_createSlider(nt,ot,rt,ut){this.slider=createFastDomNode(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(nt),this.slider.setLeft(ot),typeof rt=="number"&&this.slider.setWidth(rt),typeof ut=="number"&&this.slider.setHeight(ut),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(addDisposableListener(this.slider.domNode,EventType$1.POINTER_DOWN,gt=>{gt.button===0&&(gt.preventDefault(),this._sliderPointerDown(gt))})),this.onclick(this.slider.domNode,gt=>{gt.leftButton&&gt.stopPropagation()})}_onElementSize(nt){return this._scrollbarState.setVisibleSize(nt)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(nt){return this._scrollbarState.setScrollSize(nt)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(nt){return this._scrollbarState.setScrollPosition(nt)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(nt){nt.target===this.domNode.domNode&&this._onPointerDown(nt)}delegatePointerDown(nt){const ot=this.domNode.domNode.getClientRects()[0].top,rt=ot+this._scrollbarState.getSliderPosition(),ut=ot+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),gt=this._sliderPointerPosition(nt);rt<=gt&&gt<=ut?nt.button===0&&(nt.preventDefault(),this._sliderPointerDown(nt)):this._onPointerDown(nt)}_onPointerDown(nt){let ot,rt;if(nt.target===this.domNode.domNode&&typeof nt.offsetX=="number"&&typeof nt.offsetY=="number")ot=nt.offsetX,rt=nt.offsetY;else{const gt=getDomNodePagePosition(this.domNode.domNode);ot=nt.pageX-gt.left,rt=nt.pageY-gt.top}const ut=this._pointerDownRelativePosition(ot,rt);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(ut):this._scrollbarState.getDesiredScrollPositionFromOffset(ut)),nt.button===0&&(nt.preventDefault(),this._sliderPointerDown(nt))}_sliderPointerDown(nt){if(!nt.target||!(nt.target instanceof Element))return;const ot=this._sliderPointerPosition(nt),rt=this._sliderOrthogonalPointerPosition(nt),ut=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(nt.target,nt.pointerId,nt.buttons,gt=>{const pt=this._sliderOrthogonalPointerPosition(gt),mt=Math.abs(pt-rt);if(isWindows&&mt>POINTER_DRAG_RESET_DISTANCE$1){this._setDesiredScrollPositionNow(ut.getScrollPosition());return}const St=this._sliderPointerPosition(gt)-ot;this._setDesiredScrollPositionNow(ut.getDesiredScrollPositionFromDelta(St))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(nt){const ot={};this.writeScrollPosition(ot,nt),this._scrollable.setScrollPositionNow(ot)}updateScrollbarSize(nt){this._updateScrollbarSize(nt),this._scrollbarState.setScrollbarSize(nt),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const MINIMUM_SLIDER_SIZE=20;class ScrollbarState{constructor(nt,ot,rt,ut,gt,pt){this._scrollbarSize=Math.round(ot),this._oppositeScrollbarSize=Math.round(rt),this._arrowSize=Math.round(nt),this._visibleSize=ut,this._scrollSize=gt,this._scrollPosition=pt,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new ScrollbarState(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(nt){const ot=Math.round(nt);return this._visibleSize!==ot?(this._visibleSize=ot,this._refreshComputedValues(),!0):!1}setScrollSize(nt){const ot=Math.round(nt);return this._scrollSize!==ot?(this._scrollSize=ot,this._refreshComputedValues(),!0):!1}setScrollPosition(nt){const ot=Math.round(nt);return this._scrollPosition!==ot?(this._scrollPosition=ot,this._refreshComputedValues(),!0):!1}setScrollbarSize(nt){this._scrollbarSize=Math.round(nt)}setOppositeScrollbarSize(nt){this._oppositeScrollbarSize=Math.round(nt)}static _computeValues(nt,ot,rt,ut,gt){const pt=Math.max(0,rt-nt),mt=Math.max(0,pt-2*ot),vt=ut>0&&ut>rt;if(!vt)return{computedAvailableSize:Math.round(pt),computedIsNeeded:vt,computedSliderSize:Math.round(mt),computedSliderRatio:0,computedSliderPosition:0};const St=Math.round(Math.max(MINIMUM_SLIDER_SIZE,Math.floor(rt*mt/ut))),yt=(mt-St)/(ut-rt),wt=gt*yt;return{computedAvailableSize:Math.round(pt),computedIsNeeded:vt,computedSliderSize:Math.round(St),computedSliderRatio:yt,computedSliderPosition:Math.round(wt)}}_refreshComputedValues(){const nt=ScrollbarState._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=nt.computedAvailableSize,this._computedIsNeeded=nt.computedIsNeeded,this._computedSliderSize=nt.computedSliderSize,this._computedSliderRatio=nt.computedSliderRatio,this._computedSliderPosition=nt.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(nt){if(!this._computedIsNeeded)return 0;const ot=nt-this._arrowSize-this._computedSliderSize/2;return Math.round(ot/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(nt){if(!this._computedIsNeeded)return 0;const ot=nt-this._arrowSize;let rt=this._scrollPosition;return ot<this._computedSliderPosition?rt-=this._visibleSize:rt+=this._visibleSize,rt}getDesiredScrollPositionFromDelta(nt){if(!this._computedIsNeeded)return 0;const ot=this._computedSliderPosition+nt;return Math.round(ot/this._computedSliderRatio)}}class HorizontalScrollbar extends AbstractScrollbar{constructor(nt,ot,rt){const ut=nt.getScrollDimensions(),gt=nt.getCurrentScrollPosition();if(super({lazyRender:ot.lazyRender,host:rt,scrollbarState:new ScrollbarState(ot.horizontalHasArrows?ot.arrowSize:0,ot.horizontal===2?0:ot.horizontalScrollbarSize,ot.vertical===2?0:ot.verticalScrollbarSize,ut.width,ut.scrollWidth,gt.scrollLeft),visibility:ot.horizontal,extraScrollbarClassName:"horizontal",scrollable:nt,scrollByPage:ot.scrollByPage}),ot.horizontalHasArrows){const pt=(ot.arrowSize-ARROW_IMG_SIZE)/2,mt=(ot.horizontalScrollbarSize-ARROW_IMG_SIZE)/2;this._createArrow({className:"scra",icon:Codicon.scrollbarButtonLeft,top:mt,left:pt,bottom:void 0,right:void 0,bgWidth:ot.arrowSize,bgHeight:ot.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,1,0))}),this._createArrow({className:"scra",icon:Codicon.scrollbarButtonRight,top:mt,left:void 0,bottom:void 0,right:pt,bgWidth:ot.arrowSize,bgHeight:ot.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,-1,0))})}this._createSlider(Math.floor((ot.horizontalScrollbarSize-ot.horizontalSliderSize)/2),0,void 0,ot.horizontalSliderSize)}_updateSlider(nt,ot){this.slider.setWidth(nt),this.slider.setLeft(ot)}_renderDomNode(nt,ot){this.domNode.setWidth(nt),this.domNode.setHeight(ot),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(nt){return this._shouldRender=this._onElementScrollSize(nt.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(nt.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(nt.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(nt,ot){return nt}_sliderPointerPosition(nt){return nt.pageX}_sliderOrthogonalPointerPosition(nt){return nt.pageY}_updateScrollbarSize(nt){this.slider.setHeight(nt)}writeScrollPosition(nt,ot){nt.scrollLeft=ot}updateOptions(nt){this.updateScrollbarSize(nt.horizontal===2?0:nt.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(nt.vertical===2?0:nt.verticalScrollbarSize),this._visibilityController.setVisibility(nt.horizontal),this._scrollByPage=nt.scrollByPage}}class VerticalScrollbar extends AbstractScrollbar{constructor(nt,ot,rt){const ut=nt.getScrollDimensions(),gt=nt.getCurrentScrollPosition();if(super({lazyRender:ot.lazyRender,host:rt,scrollbarState:new ScrollbarState(ot.verticalHasArrows?ot.arrowSize:0,ot.vertical===2?0:ot.verticalScrollbarSize,0,ut.height,ut.scrollHeight,gt.scrollTop),visibility:ot.vertical,extraScrollbarClassName:"vertical",scrollable:nt,scrollByPage:ot.scrollByPage}),ot.verticalHasArrows){const pt=(ot.arrowSize-ARROW_IMG_SIZE)/2,mt=(ot.verticalScrollbarSize-ARROW_IMG_SIZE)/2;this._createArrow({className:"scra",icon:Codicon.scrollbarButtonUp,top:pt,left:mt,bottom:void 0,right:void 0,bgWidth:ot.verticalScrollbarSize,bgHeight:ot.arrowSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,0,1))}),this._createArrow({className:"scra",icon:Codicon.scrollbarButtonDown,top:void 0,left:mt,bottom:pt,right:void 0,bgWidth:ot.verticalScrollbarSize,bgHeight:ot.arrowSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,0,-1))})}this._createSlider(0,Math.floor((ot.verticalScrollbarSize-ot.verticalSliderSize)/2),ot.verticalSliderSize,void 0)}_updateSlider(nt,ot){this.slider.setHeight(nt),this.slider.setTop(ot)}_renderDomNode(nt,ot){this.domNode.setWidth(ot),this.domNode.setHeight(nt),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(nt){return this._shouldRender=this._onElementScrollSize(nt.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(nt.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(nt.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(nt,ot){return ot}_sliderPointerPosition(nt){return nt.pageY}_sliderOrthogonalPointerPosition(nt){return nt.pageX}_updateScrollbarSize(nt){this.slider.setWidth(nt)}writeScrollPosition(nt,ot){nt.scrollTop=ot}updateOptions(nt){this.updateScrollbarSize(nt.vertical===2?0:nt.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(nt.vertical),this._scrollByPage=nt.scrollByPage}}class ScrollState{constructor(nt,ot,rt,ut,gt,pt,mt){this._forceIntegerValues=nt,this._scrollStateBrand=void 0,this._forceIntegerValues&&(ot=ot|0,rt=rt|0,ut=ut|0,gt=gt|0,pt=pt|0,mt=mt|0),this.rawScrollLeft=ut,this.rawScrollTop=mt,ot<0&&(ot=0),ut+ot>rt&&(ut=rt-ot),ut<0&&(ut=0),gt<0&&(gt=0),mt+gt>pt&&(mt=pt-gt),mt<0&&(mt=0),this.width=ot,this.scrollWidth=rt,this.scrollLeft=ut,this.height=gt,this.scrollHeight=pt,this.scrollTop=mt}equals(nt){return this.rawScrollLeft===nt.rawScrollLeft&&this.rawScrollTop===nt.rawScrollTop&&this.width===nt.width&&this.scrollWidth===nt.scrollWidth&&this.scrollLeft===nt.scrollLeft&&this.height===nt.height&&this.scrollHeight===nt.scrollHeight&&this.scrollTop===nt.scrollTop}withScrollDimensions(nt,ot){return new ScrollState(this._forceIntegerValues,typeof nt.width<"u"?nt.width:this.width,typeof nt.scrollWidth<"u"?nt.scrollWidth:this.scrollWidth,ot?this.rawScrollLeft:this.scrollLeft,typeof nt.height<"u"?nt.height:this.height,typeof nt.scrollHeight<"u"?nt.scrollHeight:this.scrollHeight,ot?this.rawScrollTop:this.scrollTop)}withScrollPosition(nt){return new ScrollState(this._forceIntegerValues,this.width,this.scrollWidth,typeof nt.scrollLeft<"u"?nt.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof nt.scrollTop<"u"?nt.scrollTop:this.rawScrollTop)}createScrollEvent(nt,ot){const rt=this.width!==nt.width,ut=this.scrollWidth!==nt.scrollWidth,gt=this.scrollLeft!==nt.scrollLeft,pt=this.height!==nt.height,mt=this.scrollHeight!==nt.scrollHeight,vt=this.scrollTop!==nt.scrollTop;return{inSmoothScrolling:ot,oldWidth:nt.width,oldScrollWidth:nt.scrollWidth,oldScrollLeft:nt.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:nt.height,oldScrollHeight:nt.scrollHeight,oldScrollTop:nt.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:rt,scrollWidthChanged:ut,scrollLeftChanged:gt,heightChanged:pt,scrollHeightChanged:mt,scrollTopChanged:vt}}}class Scrollable extends Disposable{constructor(nt){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new Emitter$2),this.onScroll=this._onScroll.event,this._smoothScrollDuration=nt.smoothScrollDuration,this._scheduleAtNextAnimationFrame=nt.scheduleAtNextAnimationFrame,this._state=new ScrollState(nt.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(nt){this._smoothScrollDuration=nt}validateScrollPosition(nt){return this._state.withScrollPosition(nt)}getScrollDimensions(){return this._state}setScrollDimensions(nt,ot){var rt;const ut=this._state.withScrollDimensions(nt,ot);this._setState(ut,!!this._smoothScrolling),(rt=this._smoothScrolling)===null||rt===void 0||rt.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(nt){const ot=this._state.withScrollPosition(nt);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(ot,!1)}setScrollPositionSmooth(nt,ot){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(nt);if(this._smoothScrolling){nt={scrollLeft:typeof nt.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:nt.scrollLeft,scrollTop:typeof nt.scrollTop>"u"?this._smoothScrolling.to.scrollTop:nt.scrollTop};const rt=this._state.withScrollPosition(nt);if(this._smoothScrolling.to.scrollLeft===rt.scrollLeft&&this._smoothScrolling.to.scrollTop===rt.scrollTop)return;let ut;ot?ut=new SmoothScrollingOperation(this._smoothScrolling.from,rt,this._smoothScrolling.startTime,this._smoothScrolling.duration):ut=this._smoothScrolling.combine(this._state,rt,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=ut}else{const rt=this._state.withScrollPosition(nt);this._smoothScrolling=SmoothScrollingOperation.start(this._state,rt,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;const nt=this._smoothScrolling.tick(),ot=this._state.withScrollPosition(nt);if(this._setState(ot,!0),!!this._smoothScrolling){if(nt.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(nt,ot){const rt=this._state;rt.equals(nt)||(this._state=nt,this._onScroll.fire(this._state.createScrollEvent(rt,ot)))}}class SmoothScrollingUpdate{constructor(nt,ot,rt){this.scrollLeft=nt,this.scrollTop=ot,this.isDone=rt}}function createEaseOutCubic(ct,nt){const ot=nt-ct;return function(rt){return ct+ot*easeOutCubic(rt)}}function createComposed(ct,nt,ot){return function(rt){return rt<ot?ct(rt/ot):nt((rt-ot)/(1-ot))}}class SmoothScrollingOperation{constructor(nt,ot,rt,ut){this.from=nt,this.to=ot,this.duration=ut,this.startTime=rt,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(nt,ot,rt){if(Math.abs(nt-ot)>2.5*rt){let gt,pt;return nt<ot?(gt=nt+.75*rt,pt=ot-.75*rt):(gt=nt-.75*rt,pt=ot+.75*rt),createComposed(createEaseOutCubic(nt,gt),createEaseOutCubic(pt,ot),.33)}return createEaseOutCubic(nt,ot)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(nt){this.to=nt.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(nt){const ot=(nt-this.startTime)/this.duration;if(ot<1){const rt=this.scrollLeft(ot),ut=this.scrollTop(ot);return new SmoothScrollingUpdate(rt,ut,!1)}return new SmoothScrollingUpdate(this.to.scrollLeft,this.to.scrollTop,!0)}combine(nt,ot,rt){return SmoothScrollingOperation.start(nt,ot,rt)}static start(nt,ot,rt){rt=rt+10;const ut=Date.now()-10;return new SmoothScrollingOperation(nt,ot,ut,rt)}}function easeInCubic(ct){return Math.pow(ct,3)}function easeOutCubic(ct){return 1-easeInCubic(1-ct)}const scrollbars="",HIDE_TIMEOUT=500,SCROLL_WHEEL_SENSITIVITY=50;class MouseWheelClassifierItem{constructor(nt,ot,rt){this.timestamp=nt,this.deltaX=ot,this.deltaY=rt,this.score=0}}class MouseWheelClassifier{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let nt=1,ot=0,rt=1,ut=this._rear;do{const gt=ut===this._front?nt:Math.pow(2,-rt);if(nt-=gt,ot+=this._memory[ut].score*gt,ut===this._front)break;ut=(this._capacity+ut-1)%this._capacity,rt++}while(!0);return ot<=.5}acceptStandardWheelEvent(nt){const ot=window.devicePixelRatio/getZoomFactor();isWindows||isLinux?this.accept(Date.now(),nt.deltaX/ot,nt.deltaY/ot):this.accept(Date.now(),nt.deltaX,nt.deltaY)}accept(nt,ot,rt){const ut=new MouseWheelClassifierItem(nt,ot,rt);ut.score=this._computeScore(ut),this._front===-1&&this._rear===-1?(this._memory[0]=ut,this._front=0,this._rear=0):(this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=ut)}_computeScore(nt){if(Math.abs(nt.deltaX)>0&&Math.abs(nt.deltaY)>0)return 1;let ot=.5;return this._front===-1&&this._rear===-1||this._memory[this._rear],(!this._isAlmostInt(nt.deltaX)||!this._isAlmostInt(nt.deltaY))&&(ot+=.25),Math.min(Math.max(ot,0),1)}_isAlmostInt(nt){return Math.abs(Math.round(nt)-nt)<.01}}MouseWheelClassifier.INSTANCE=new MouseWheelClassifier;class AbstractScrollableElement extends Widget$1{get options(){return this._options}constructor(nt,ot,rt){super(),this._onScroll=this._register(new Emitter$2),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new Emitter$2),nt.style.overflow="hidden",this._options=resolveOptions$1(ot),this._scrollable=rt,this._register(this._scrollable.onScroll(gt=>{this._onWillScroll.fire(gt),this._onDidScroll(gt),this._onScroll.fire(gt)}));const ut={onMouseWheel:gt=>this._onMouseWheel(gt),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new VerticalScrollbar(this._scrollable,this._options,ut)),this._horizontalScrollbar=this._register(new HorizontalScrollbar(this._scrollable,this._options,ut)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(nt),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=createFastDomNode(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=createFastDomNode(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=createFastDomNode(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,gt=>this._onMouseOver(gt)),this.onmouseleave(this._listenOnDomNode,gt=>this._onMouseLeave(gt)),this._hideTimeout=this._register(new TimeoutTimer),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=dispose(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(nt){this._verticalScrollbar.delegatePointerDown(nt)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(nt){this._scrollable.setScrollDimensions(nt,!1)}updateClassName(nt){this._options.className=nt,isMacintosh&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(nt){typeof nt.handleMouseWheel<"u"&&(this._options.handleMouseWheel=nt.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof nt.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=nt.mouseWheelScrollSensitivity),typeof nt.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=nt.fastScrollSensitivity),typeof nt.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=nt.scrollPredominantAxis),typeof nt.horizontal<"u"&&(this._options.horizontal=nt.horizontal),typeof nt.vertical<"u"&&(this._options.vertical=nt.vertical),typeof nt.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=nt.horizontalScrollbarSize),typeof nt.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=nt.verticalScrollbarSize),typeof nt.scrollByPage<"u"&&(this._options.scrollByPage=nt.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}delegateScrollFromMouseWheelEvent(nt){this._onMouseWheel(new StandardWheelEvent(nt))}_setListeningToMouseWheel(nt){if(this._mouseWheelToDispose.length>0!==nt&&(this._mouseWheelToDispose=dispose(this._mouseWheelToDispose),nt)){const rt=ut=>{this._onMouseWheel(new StandardWheelEvent(ut))};this._mouseWheelToDispose.push(addDisposableListener(this._listenOnDomNode,EventType$1.MOUSE_WHEEL,rt,{passive:!1}))}}_onMouseWheel(nt){const ot=MouseWheelClassifier.INSTANCE;ot.acceptStandardWheelEvent(nt);let rt=!1;if(nt.deltaY||nt.deltaX){let gt=nt.deltaY*this._options.mouseWheelScrollSensitivity,pt=nt.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(Math.abs(gt)>=Math.abs(pt)?pt=0:gt=0),this._options.flipAxes&&([gt,pt]=[pt,gt]);const mt=!isMacintosh&&nt.browserEvent&&nt.browserEvent.shiftKey;(this._options.scrollYToX||mt)&&!pt&&(pt=gt,gt=0),nt.browserEvent&&nt.browserEvent.altKey&&(pt=pt*this._options.fastScrollSensitivity,gt=gt*this._options.fastScrollSensitivity);const vt=this._scrollable.getFutureScrollPosition();let St={};if(gt){const yt=SCROLL_WHEEL_SENSITIVITY*gt,wt=vt.scrollTop-(yt<0?Math.floor(yt):Math.ceil(yt));this._verticalScrollbar.writeScrollPosition(St,wt)}if(pt){const yt=SCROLL_WHEEL_SENSITIVITY*pt,wt=vt.scrollLeft-(yt<0?Math.floor(yt):Math.ceil(yt));this._horizontalScrollbar.writeScrollPosition(St,wt)}St=this._scrollable.validateScrollPosition(St),(vt.scrollLeft!==St.scrollLeft||vt.scrollTop!==St.scrollTop)&&(this._options.mouseWheelSmoothScroll&&ot.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(St):this._scrollable.setScrollPositionNow(St),rt=!0)}let ut=rt;!ut&&this._options.alwaysConsumeMouseWheel&&(ut=!0),!ut&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(ut=!0),ut&&(nt.preventDefault(),nt.stopPropagation())}_onDidScroll(nt){this._shouldRender=this._horizontalScrollbar.onDidScroll(nt)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(nt)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const nt=this._scrollable.getCurrentScrollPosition(),ot=nt.scrollTop>0,rt=nt.scrollLeft>0,ut=rt?" left":"",gt=ot?" top":"",pt=rt||ot?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${ut}`),this._topShadowDomNode.setClassName(`shadow${gt}`),this._topLeftShadowDomNode.setClassName(`shadow${pt}${gt}${ut}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(nt){this._mouseIsOver=!1,this._hide()}_onMouseOver(nt){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),HIDE_TIMEOUT)}}class ScrollableElement extends AbstractScrollableElement{constructor(nt,ot){ot=ot||{},ot.mouseWheelSmoothScroll=!1;const rt=new Scrollable({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:ut=>scheduleAtNextAnimationFrame(ut)});super(nt,ot,rt),this._register(rt)}setScrollPosition(nt){this._scrollable.setScrollPositionNow(nt)}}class SmoothScrollableElement extends AbstractScrollableElement{constructor(nt,ot,rt){super(nt,ot,rt)}setScrollPosition(nt){nt.reuseAnimation?this._scrollable.setScrollPositionSmooth(nt,nt.reuseAnimation):this._scrollable.setScrollPositionNow(nt)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class DomScrollableElement extends AbstractScrollableElement{constructor(nt,ot){ot=ot||{},ot.mouseWheelSmoothScroll=!1;const rt=new Scrollable({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:ut=>scheduleAtNextAnimationFrame(ut)});super(nt,ot,rt),this._register(rt),this._element=nt,this.onScroll(ut=>{ut.scrollTopChanged&&(this._element.scrollTop=ut.scrollTop),ut.scrollLeftChanged&&(this._element.scrollLeft=ut.scrollLeft)}),this.scanDomNode()}setScrollPosition(nt){this._scrollable.setScrollPositionNow(nt)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function resolveOptions$1(ct){const nt={lazyRender:typeof ct.lazyRender<"u"?ct.lazyRender:!1,className:typeof ct.className<"u"?ct.className:"",useShadows:typeof ct.useShadows<"u"?ct.useShadows:!0,handleMouseWheel:typeof ct.handleMouseWheel<"u"?ct.handleMouseWheel:!0,flipAxes:typeof ct.flipAxes<"u"?ct.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof ct.consumeMouseWheelIfScrollbarIsNeeded<"u"?ct.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof ct.alwaysConsumeMouseWheel<"u"?ct.alwaysConsumeMouseWheel:!1,scrollYToX:typeof ct.scrollYToX<"u"?ct.scrollYToX:!1,mouseWheelScrollSensitivity:typeof ct.mouseWheelScrollSensitivity<"u"?ct.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof ct.fastScrollSensitivity<"u"?ct.fastScrollSensitivity:5,scrollPredominantAxis:typeof ct.scrollPredominantAxis<"u"?ct.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof ct.mouseWheelSmoothScroll<"u"?ct.mouseWheelSmoothScroll:!0,arrowSize:typeof ct.arrowSize<"u"?ct.arrowSize:11,listenOnDomNode:typeof ct.listenOnDomNode<"u"?ct.listenOnDomNode:null,horizontal:typeof ct.horizontal<"u"?ct.horizontal:1,horizontalScrollbarSize:typeof ct.horizontalScrollbarSize<"u"?ct.horizontalScrollbarSize:10,horizontalSliderSize:typeof ct.horizontalSliderSize<"u"?ct.horizontalSliderSize:0,horizontalHasArrows:typeof ct.horizontalHasArrows<"u"?ct.horizontalHasArrows:!1,vertical:typeof ct.vertical<"u"?ct.vertical:1,verticalScrollbarSize:typeof ct.verticalScrollbarSize<"u"?ct.verticalScrollbarSize:10,verticalHasArrows:typeof ct.verticalHasArrows<"u"?ct.verticalHasArrows:!1,verticalSliderSize:typeof ct.verticalSliderSize<"u"?ct.verticalSliderSize:0,scrollByPage:typeof ct.scrollByPage<"u"?ct.scrollByPage:!1};return nt.horizontalSliderSize=typeof ct.horizontalSliderSize<"u"?ct.horizontalSliderSize:nt.horizontalScrollbarSize,nt.verticalSliderSize=typeof ct.verticalSliderSize<"u"?ct.verticalSliderSize:nt.verticalScrollbarSize,isMacintosh&&(nt.className+=" mac"),nt}class MouseHandler extends ViewEventHandler{constructor(nt,ot,rt){super(),this._mouseLeaveMonitor=null,this._context=nt,this.viewController=ot,this.viewHelper=rt,this.mouseTargetFactory=new MouseTargetFactory(this._context,rt),this._mouseDownOperation=this._register(new MouseDownOperation(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(pt,mt)=>this._createMouseTarget(pt,mt),pt=>this._getMouseColumn(pt))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(139).height;const ut=new EditorMouseEventFactory(this.viewHelper.viewDomNode);this._register(ut.onContextMenu(this.viewHelper.viewDomNode,pt=>this._onContextMenu(pt,!0))),this._register(ut.onMouseMove(this.viewHelper.viewDomNode,pt=>{this._onMouseMove(pt),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=addDisposableListener(document,"mousemove",mt=>{this.viewHelper.viewDomNode.contains(mt.target)||this._onMouseLeave(new EditorMouseEvent(mt,!1,this.viewHelper.viewDomNode))}))})),this._register(ut.onMouseUp(this.viewHelper.viewDomNode,pt=>this._onMouseUp(pt))),this._register(ut.onMouseLeave(this.viewHelper.viewDomNode,pt=>this._onMouseLeave(pt)));let gt=0;this._register(ut.onPointerDown(this.viewHelper.viewDomNode,(pt,mt)=>{gt=mt})),this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType$1.POINTER_UP,pt=>{this._mouseDownOperation.onPointerUp()})),this._register(ut.onMouseDown(this.viewHelper.viewDomNode,pt=>this._onMouseDown(pt,gt))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){const nt=MouseWheelClassifier.INSTANCE;let ot=0,rt=EditorZoom.getZoomLevel(),ut=!1,gt=0;const pt=vt=>{if(this.viewController.emitMouseWheel(vt),!this._context.configuration.options.get(73))return;const St=new StandardWheelEvent(vt);if(nt.acceptStandardWheelEvent(St),nt.isPhysicalMouseWheel()){if(mt(vt)){const yt=EditorZoom.getZoomLevel(),wt=St.deltaY>0?1:-1;EditorZoom.setZoomLevel(yt+wt),St.preventDefault(),St.stopPropagation()}}else Date.now()-ot>50&&(rt=EditorZoom.getZoomLevel(),ut=mt(vt),gt=0),ot=Date.now(),gt+=St.deltaY,ut&&(EditorZoom.setZoomLevel(rt+gt/5),St.preventDefault(),St.stopPropagation())};this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType$1.MOUSE_WHEEL,pt,{capture:!0,passive:!1}));function mt(vt){return isMacintosh?(vt.metaKey||vt.ctrlKey)&&!vt.shiftKey&&!vt.altKey:vt.ctrlKey&&!vt.metaKey&&!vt.shiftKey&&!vt.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(nt){if(nt.hasChanged(139)){const ot=this._context.configuration.options.get(139).height;this._height!==ot&&(this._height=ot,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(nt){return this._mouseDownOperation.onCursorStateChanged(nt),!1}onFocusChanged(nt){return!1}getTargetAtClientPoint(nt,ot){const ut=new ClientCoordinates(nt,ot).toPageCoordinates(),gt=createEditorPagePosition(this.viewHelper.viewDomNode);if(ut.y<gt.y||ut.y>gt.y+gt.height||ut.x<gt.x||ut.x>gt.x+gt.width)return null;const pt=createCoordinatesRelativeToEditor(this.viewHelper.viewDomNode,gt,ut);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),gt,ut,pt,null)}_createMouseTarget(nt,ot){let rt=nt.target;if(!this.viewHelper.viewDomNode.contains(rt)){const ut=getShadowRoot(this.viewHelper.viewDomNode);ut&&(rt=ut.elementsFromPoint(nt.posx,nt.posy).find(gt=>this.viewHelper.viewDomNode.contains(gt)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),nt.editorPos,nt.pos,nt.relativePos,ot?rt:null)}_getMouseColumn(nt){return this.mouseTargetFactory.getMouseColumn(nt.relativePos)}_onContextMenu(nt,ot){this.viewController.emitContextMenu({event:nt,target:this._createMouseTarget(nt,ot)})}_onMouseMove(nt){this.mouseTargetFactory.mouseTargetIsWidget(nt)||nt.preventDefault(),!(this._mouseDownOperation.isActive()||nt.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:nt,target:this._createMouseTarget(nt,!0)})}_onMouseLeave(nt){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:nt,target:null})}_onMouseUp(nt){this.viewController.emitMouseUp({event:nt,target:this._createMouseTarget(nt,!0)})}_onMouseDown(nt,ot){const rt=this._createMouseTarget(nt,!0),ut=rt.type===6||rt.type===7,gt=rt.type===2||rt.type===3||rt.type===4,pt=rt.type===3,mt=this._context.configuration.options.get(104),vt=rt.type===8||rt.type===5,St=rt.type===9;let yt=nt.leftButton||nt.middleButton;isMacintosh&&nt.leftButton&&nt.ctrlKey&&(yt=!1);const wt=()=>{nt.preventDefault(),this.viewHelper.focusTextArea()};if(yt&&(ut||pt&&mt))wt(),this._mouseDownOperation.start(rt.type,nt,ot);else if(gt)nt.preventDefault();else if(vt){const Lt=rt.detail;yt&&this.viewHelper.shouldSuppressMouseDownOnViewZone(Lt.viewZoneId)&&(wt(),this._mouseDownOperation.start(rt.type,nt,ot),nt.preventDefault())}else St&&this.viewHelper.shouldSuppressMouseDownOnWidget(rt.detail)&&(wt(),nt.preventDefault());this.viewController.emitMouseDown({event:nt,target:rt})}}class MouseDownOperation extends Disposable{constructor(nt,ot,rt,ut,gt,pt){super(),this._context=nt,this._viewController=ot,this._viewHelper=rt,this._mouseTargetFactory=ut,this._createMouseTarget=gt,this._getMouseColumn=pt,this._mouseMoveMonitor=this._register(new GlobalEditorPointerMoveMonitor(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new TopBottomDragScrolling(this._context,this._viewHelper,this._mouseTargetFactory,(mt,vt,St)=>this._dispatchMouse(mt,vt,St))),this._mouseState=new MouseDownState,this._currentSelection=new Selection$1(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(nt){this._lastMouseEvent=nt,this._mouseState.setModifiers(nt);const ot=this._findMousePosition(nt,!1);ot&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:nt,target:ot}):ot.type===13&&(ot.outsidePosition==="above"||ot.outsidePosition==="below")?this._topBottomDragScrolling.start(ot,nt):(this._topBottomDragScrolling.stop(),this._dispatchMouse(ot,!0,1)))}start(nt,ot,rt){this._lastMouseEvent=ot,this._mouseState.setStartedOnLineNumbers(nt===3),this._mouseState.setStartButtons(ot),this._mouseState.setModifiers(ot);const ut=this._findMousePosition(ot,!0);if(!ut||!ut.position)return;this._mouseState.trySetCount(ot.detail,ut.position),ot.detail=this._mouseState.count;const gt=this._context.configuration.options;if(!gt.get(87)&&gt.get(33)&&!gt.get(20)&&!this._mouseState.altKey&&ot.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&ut.type===6&&ut.position&&this._currentSelection.containsPosition(ut.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,rt,ot.buttons,pt=>this._onMouseDownThenMove(pt),pt=>{const mt=this._findMousePosition(this._lastMouseEvent,!1);pt&&pt instanceof KeyboardEvent?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:mt?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(ut,ot.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,rt,ot.buttons,pt=>this._onMouseDownThenMove(pt),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(nt){this._currentSelection=nt.selections[0]}_getPositionOutsideEditor(nt){const ot=nt.editorPos,rt=this._context.viewModel,ut=this._context.viewLayout,gt=this._getMouseColumn(nt);if(nt.posy<ot.y){const mt=ot.y-nt.posy,vt=Math.max(ut.getCurrentScrollTop()-mt,0),St=HitTestContext.getZoneAtCoord(this._context,vt);if(St){const wt=this._helpPositionJumpOverViewZone(St);if(wt)return MouseTarget.createOutsideEditor(gt,wt,"above",mt)}const yt=ut.getLineNumberAtVerticalOffset(vt);return MouseTarget.createOutsideEditor(gt,new Position$1(yt,1),"above",mt)}if(nt.posy>ot.y+ot.height){const mt=nt.posy-ot.y-ot.height,vt=ut.getCurrentScrollTop()+nt.relativePos.y,St=HitTestContext.getZoneAtCoord(this._context,vt);if(St){const wt=this._helpPositionJumpOverViewZone(St);if(wt)return MouseTarget.createOutsideEditor(gt,wt,"below",mt)}const yt=ut.getLineNumberAtVerticalOffset(vt);return MouseTarget.createOutsideEditor(gt,new Position$1(yt,rt.getLineMaxColumn(yt)),"below",mt)}const pt=ut.getLineNumberAtVerticalOffset(ut.getCurrentScrollTop()+nt.relativePos.y);if(nt.posx<ot.x){const mt=ot.x-nt.posx;return MouseTarget.createOutsideEditor(gt,new Position$1(pt,1),"left",mt)}if(nt.posx>ot.x+ot.width){const mt=nt.posx-ot.x-ot.width;return MouseTarget.createOutsideEditor(gt,new Position$1(pt,rt.getLineMaxColumn(pt)),"right",mt)}return null}_findMousePosition(nt,ot){const rt=this._getPositionOutsideEditor(nt);if(rt)return rt;const ut=this._createMouseTarget(nt,ot);if(!ut.position)return null;if(ut.type===8||ut.type===5){const pt=this._helpPositionJumpOverViewZone(ut.detail);if(pt)return MouseTarget.createViewZone(ut.type,ut.element,ut.mouseColumn,pt,ut.detail)}return ut}_helpPositionJumpOverViewZone(nt){const ot=new Position$1(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),rt=nt.positionBefore,ut=nt.positionAfter;return rt&&ut?rt.isBefore(ot)?rt:ut:null}_dispatchMouse(nt,ot,rt){nt.position&&this._viewController.dispatchMouse({position:nt.position,mouseColumn:nt.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:rt,inSelectionMode:ot,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:nt.type===6&&nt.detail.injectedText!==null})}}class TopBottomDragScrolling extends Disposable{constructor(nt,ot,rt,ut){super(),this._context=nt,this._viewHelper=ot,this._mouseTargetFactory=rt,this._dispatchMouse=ut,this._operation=null}dispose(){super.dispose(),this.stop()}start(nt,ot){this._operation?this._operation.setPosition(nt,ot):this._operation=new TopBottomDragScrollingOperation(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,nt,ot)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}}class TopBottomDragScrollingOperation extends Disposable{constructor(nt,ot,rt,ut,gt,pt){super(),this._context=nt,this._viewHelper=ot,this._mouseTargetFactory=rt,this._dispatchMouse=ut,this._position=gt,this._mouseEvent=pt,this._lastTime=Date.now(),this._animationFrameDisposable=scheduleAtNextAnimationFrame(()=>this._execute())}dispose(){this._animationFrameDisposable.dispose()}setPosition(nt,ot){this._position=nt,this._mouseEvent=ot}_tick(){const nt=Date.now(),ot=nt-this._lastTime;return this._lastTime=nt,ot}_getScrollSpeed(){const nt=this._context.configuration.options.get(64),ot=this._context.configuration.options.get(139).height/nt,rt=this._position.outsideDistance/nt;return rt<=1.5?Math.max(30,ot*(1+rt)):rt<=3?Math.max(60,ot*(2+rt)):Math.max(200,ot*(7+rt))}_execute(){const nt=this._context.configuration.options.get(64),ot=this._getScrollSpeed(),rt=this._tick(),ut=ot*(rt/1e3)*nt,gt=this._position.outsidePosition==="above"?-ut:ut;this._context.viewModel.viewLayout.deltaScrollNow(0,gt),this._viewHelper.renderNow();const pt=this._context.viewLayout.getLinesViewportData(),mt=this._position.outsidePosition==="above"?pt.startLineNumber:pt.endLineNumber;let vt;{const St=createEditorPagePosition(this._viewHelper.viewDomNode),yt=this._context.configuration.options.get(139).horizontalScrollbarHeight,wt=new PageCoordinates(this._mouseEvent.pos.x,St.y+St.height-yt-.1),Lt=createCoordinatesRelativeToEditor(this._viewHelper.viewDomNode,St,wt);vt=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),St,wt,Lt,null)}(!vt.position||vt.position.lineNumber!==mt)&&(this._position.outsidePosition==="above"?vt=MouseTarget.createOutsideEditor(this._position.mouseColumn,new Position$1(mt,1),"above",this._position.outsideDistance):vt=MouseTarget.createOutsideEditor(this._position.mouseColumn,new Position$1(mt,this._context.viewModel.getLineMaxColumn(mt)),"below",this._position.outsideDistance)),this._dispatchMouse(vt,!0,2),this._animationFrameDisposable=scheduleAtNextAnimationFrame(()=>this._execute())}}class MouseDownState{get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(nt){this._altKey=nt.altKey,this._ctrlKey=nt.ctrlKey,this._metaKey=nt.metaKey,this._shiftKey=nt.shiftKey}setStartButtons(nt){this._leftButton=nt.leftButton,this._middleButton=nt.middleButton}setStartedOnLineNumbers(nt){this._startedOnLineNumbers=nt}trySetCount(nt,ot){const rt=new Date().getTime();rt-this._lastSetMouseDownCountTime>MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME&&(nt=1),this._lastSetMouseDownCountTime=rt,nt>this._lastMouseDownCount+1&&(nt=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(ot)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=ot,this._lastMouseDownCount=Math.min(nt,this._lastMouseDownPositionEqualCount)}}MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME=400;class DomEmitter{get event(){return this.emitter.event}constructor(nt,ot,rt){const ut=gt=>this.emitter.fire(gt);this.emitter=new Emitter$2({onWillAddFirstListener:()=>nt.addEventListener(ot,ut,rt),onDidRemoveLastListener:()=>nt.removeEventListener(ot,ut,rt)})}dispose(){this.emitter.dispose()}}var inputLatency;(function(ct){const nt={total:0,min:Number.MAX_VALUE,max:0},ot=Object.assign({},nt),rt=Object.assign({},nt),ut=Object.assign({},nt);let gt=0;const pt={keydown:0,input:0,render:0};function mt(){Tt(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),pt.keydown=1,queueMicrotask(vt)}ct.onKeyDown=mt;function vt(){pt.keydown===1&&(performance.mark("keydown/end"),pt.keydown=2)}function St(){performance.mark("input/start"),pt.input=1,At()}ct.onBeforeInput=St;function yt(){pt.input===0&&St(),queueMicrotask(wt)}ct.onInput=yt;function wt(){pt.input===1&&(performance.mark("input/end"),pt.input=2)}function Lt(){Tt()}ct.onKeyUp=Lt;function xt(){Tt()}ct.onSelectionChange=xt;function It(){pt.keydown===2&&pt.input===2&&pt.render===0&&(performance.mark("render/start"),pt.render=1,queueMicrotask(kt),At())}ct.onRenderStart=It;function kt(){pt.render===1&&(performance.mark("render/end"),pt.render=2)}function At(){setTimeout(Tt)}function Tt(){pt.keydown===2&&pt.input===2&&pt.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),Rt("keydown",nt),Rt("input",ot),Rt("render",rt),Rt("inputlatency",ut),gt++,Nt())}function Rt(Bt,Ut){const qt=performance.getEntriesByName(Bt)[0].duration;Ut.total+=qt,Ut.min=Math.min(Ut.min,qt),Ut.max=Math.max(Ut.max,qt)}function Nt(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),pt.keydown=0,pt.input=0,pt.render=0}function Pt(){if(gt===0)return;const Bt={keydown:Ft(nt),input:Ft(ot),render:Ft(rt),total:Ft(ut),sampleCount:gt};return Kt(nt),Kt(ot),Kt(rt),Kt(ut),gt=0,Bt}ct.getAndClearMeasurements=Pt;function Ft(Bt){return{average:Bt.total/gt,max:Bt.max,min:Bt.min}}function Kt(Bt){Bt.total=0,Bt.min=Number.MAX_VALUE,Bt.max=0}})(inputLatency||(inputLatency={}));class TextAreaState{constructor(nt,ot,rt,ut,gt){this.value=nt,this.selectionStart=ot,this.selectionEnd=rt,this.selection=ut,this.newlineCountBeforeSelection=gt}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(nt,ot){const rt=nt.getValue(),ut=nt.getSelectionStart(),gt=nt.getSelectionEnd();let pt;if(ot){const mt=rt.substring(0,ut),vt=ot.value.substring(0,ot.selectionStart);mt===vt&&(pt=ot.newlineCountBeforeSelection)}return new TextAreaState(rt,ut,gt,null,pt)}collapseSelection(){return this.selectionStart===this.value.length?this:new TextAreaState(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(nt,ot,rt){ot.setValue(nt,this.value),rt&&ot.setSelectionRange(nt,this.selectionStart,this.selectionEnd)}deduceEditorPosition(nt){var ot,rt,ut,gt,pt,mt,vt,St;if(nt<=this.selectionStart){const Lt=this.value.substring(nt,this.selectionStart);return this._finishDeduceEditorPosition((rt=(ot=this.selection)===null||ot===void 0?void 0:ot.getStartPosition())!==null&&rt!==void 0?rt:null,Lt,-1)}if(nt>=this.selectionEnd){const Lt=this.value.substring(this.selectionEnd,nt);return this._finishDeduceEditorPosition((gt=(ut=this.selection)===null||ut===void 0?void 0:ut.getEndPosition())!==null&&gt!==void 0?gt:null,Lt,1)}const yt=this.value.substring(this.selectionStart,nt);if(yt.indexOf(String.fromCharCode(8230))===-1)return this._finishDeduceEditorPosition((mt=(pt=this.selection)===null||pt===void 0?void 0:pt.getStartPosition())!==null&&mt!==void 0?mt:null,yt,1);const wt=this.value.substring(nt,this.selectionEnd);return this._finishDeduceEditorPosition((St=(vt=this.selection)===null||vt===void 0?void 0:vt.getEndPosition())!==null&&St!==void 0?St:null,wt,-1)}_finishDeduceEditorPosition(nt,ot,rt){let ut=0,gt=-1;for(;(gt=ot.indexOf(`
`,gt+1))!==-1;)ut++;return[nt,rt*ot.length,ut]}static deduceInput(nt,ot,rt){if(!nt)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const ut=Math.min(commonPrefixLength(nt.value,ot.value),nt.selectionStart,ot.selectionStart),gt=Math.min(commonSuffixLength(nt.value,ot.value),nt.value.length-nt.selectionEnd,ot.value.length-ot.selectionEnd);nt.value.substring(ut,nt.value.length-gt);const pt=ot.value.substring(ut,ot.value.length-gt),mt=nt.selectionStart-ut,vt=nt.selectionEnd-ut,St=ot.selectionStart-ut,yt=ot.selectionEnd-ut;if(St===yt){const Lt=nt.selectionStart-ut;return{text:pt,replacePrevCharCnt:Lt,replaceNextCharCnt:0,positionDelta:0}}const wt=vt-mt;return{text:pt,replacePrevCharCnt:wt,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(nt,ot){if(!nt)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(nt.value===ot.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:ot.selectionEnd-nt.selectionEnd};const rt=Math.min(commonPrefixLength(nt.value,ot.value),nt.selectionEnd),ut=Math.min(commonSuffixLength(nt.value,ot.value),nt.value.length-nt.selectionEnd),gt=nt.value.substring(rt,nt.value.length-ut),pt=ot.value.substring(rt,ot.value.length-ut);nt.selectionStart-rt;const mt=nt.selectionEnd-rt;ot.selectionStart-rt;const vt=ot.selectionEnd-rt;return{text:pt,replacePrevCharCnt:mt,replaceNextCharCnt:gt.length-mt,positionDelta:vt-pt.length}}}TextAreaState.EMPTY=new TextAreaState("",0,0,null,void 0);class PagedScreenReaderStrategy{static _getPageOfLine(nt,ot){return Math.floor((nt-1)/ot)}static _getRangeForPage(nt,ot){const rt=nt*ot,ut=rt+1,gt=rt+ot;return new Range$2(ut,1,gt+1,1)}static fromEditorSelection(nt,ot,rt,ut){const pt=PagedScreenReaderStrategy._getPageOfLine(ot.startLineNumber,rt),mt=PagedScreenReaderStrategy._getRangeForPage(pt,rt),vt=PagedScreenReaderStrategy._getPageOfLine(ot.endLineNumber,rt),St=PagedScreenReaderStrategy._getRangeForPage(vt,rt);let yt=mt.intersectRanges(new Range$2(1,1,ot.startLineNumber,ot.startColumn));if(ut&&nt.getValueLengthInRange(yt,1)>500){const Tt=nt.modifyPosition(yt.getEndPosition(),-500);yt=Range$2.fromPositions(Tt,yt.getEndPosition())}const wt=nt.getValueInRange(yt,1),Lt=nt.getLineCount(),xt=nt.getLineMaxColumn(Lt);let It=St.intersectRanges(new Range$2(ot.endLineNumber,ot.endColumn,Lt,xt));if(ut&&nt.getValueLengthInRange(It,1)>500){const Tt=nt.modifyPosition(It.getStartPosition(),500);It=Range$2.fromPositions(It.getStartPosition(),Tt)}const kt=nt.getValueInRange(It,1);let At;if(pt===vt||pt+1===vt)At=nt.getValueInRange(ot,1);else{const Tt=mt.intersectRanges(ot),Rt=St.intersectRanges(ot);At=nt.getValueInRange(Tt,1)+String.fromCharCode(8230)+nt.getValueInRange(Rt,1)}return ut&&At.length>2*500&&(At=At.substring(0,500)+String.fromCharCode(8230)+At.substring(At.length-500,At.length)),new TextAreaState(wt+At+kt,wt.length,wt.length+At.length,ot,yt.endLineNumber-yt.startLineNumber)}}var TextAreaSyntethicEvents;(function(ct){ct.Tap="-monaco-textarea-synthetic-tap"})(TextAreaSyntethicEvents||(TextAreaSyntethicEvents={}));const CopyOptions={forceCopyWithSyntaxHighlighting:!1};class InMemoryClipboardMetadataManager{constructor(){this._lastState=null}set(nt,ot){this._lastState={lastCopiedValue:nt,data:ot}}get(nt){return this._lastState&&this._lastState.lastCopiedValue===nt?this._lastState.data:(this._lastState=null,null)}}InMemoryClipboardMetadataManager.INSTANCE=new InMemoryClipboardMetadataManager;class CompositionContext{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(nt){nt=nt||"";const ot={text:nt,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=nt.length,ot}}class TextAreaInput extends Disposable{get textAreaState(){return this._textAreaState}constructor(nt,ot,rt,ut){super(),this._host=nt,this._textArea=ot,this._OS=rt,this._browser=ut,this._onFocus=this._register(new Emitter$2),this.onFocus=this._onFocus.event,this._onBlur=this._register(new Emitter$2),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new Emitter$2),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new Emitter$2),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new Emitter$2),this.onCut=this._onCut.event,this._onPaste=this._register(new Emitter$2),this.onPaste=this._onPaste.event,this._onType=this._register(new Emitter$2),this.onType=this._onType.event,this._onCompositionStart=this._register(new Emitter$2),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new Emitter$2),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new Emitter$2),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new Emitter$2),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncTriggerCut=this._register(new RunOnceScheduler(()=>this._onCut.fire(),0)),this._asyncFocusGainWriteScreenReaderContent=this._register(new RunOnceScheduler(()=>this.writeScreenReaderContent("asyncFocusGain"),0)),this._textAreaState=TextAreaState.EMPTY,this._selectionChangeListener=null,this.writeScreenReaderContent("ctor"),this._hasFocus=!1,this._currentComposition=null;let gt=null;this._register(this._textArea.onKeyDown(pt=>{const mt=new StandardKeyboardEvent(pt);(mt.keyCode===114||this._currentComposition&&mt.keyCode===1)&&mt.stopPropagation(),mt.equals(9)&&mt.preventDefault(),gt=mt,this._onKeyDown.fire(mt)})),this._register(this._textArea.onKeyUp(pt=>{const mt=new StandardKeyboardEvent(pt);this._onKeyUp.fire(mt)})),this._register(this._textArea.onCompositionStart(pt=>{const mt=new CompositionContext;if(this._currentComposition){this._currentComposition=mt;return}if(this._currentComposition=mt,this._OS===2&&gt&&gt.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===pt.data&&(gt.code==="ArrowRight"||gt.code==="ArrowLeft")){mt.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:pt.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:pt.data});return}this._onCompositionStart.fire({data:pt.data})})),this._register(this._textArea.onCompositionUpdate(pt=>{const mt=this._currentComposition;if(!mt)return;if(this._browser.isAndroid){const St=TextAreaState.readFromTextArea(this._textArea,this._textAreaState),yt=TextAreaState.deduceAndroidCompositionInput(this._textAreaState,St);this._textAreaState=St,this._onType.fire(yt),this._onCompositionUpdate.fire(pt);return}const vt=mt.handleCompositionUpdate(pt.data);this._textAreaState=TextAreaState.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(vt),this._onCompositionUpdate.fire(pt)})),this._register(this._textArea.onCompositionEnd(pt=>{const mt=this._currentComposition;if(!mt)return;if(this._currentComposition=null,this._browser.isAndroid){const St=TextAreaState.readFromTextArea(this._textArea,this._textAreaState),yt=TextAreaState.deduceAndroidCompositionInput(this._textAreaState,St);this._textAreaState=St,this._onType.fire(yt),this._onCompositionEnd.fire();return}const vt=mt.handleCompositionUpdate(pt.data);this._textAreaState=TextAreaState.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(vt),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(pt=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const mt=TextAreaState.readFromTextArea(this._textArea,this._textAreaState),vt=TextAreaState.deduceInput(this._textAreaState,mt,this._OS===2);vt.replacePrevCharCnt===0&&vt.text.length===1&&(isHighSurrogate(vt.text.charCodeAt(0))||vt.text.charCodeAt(0)===127)||(this._textAreaState=mt,(vt.text!==""||vt.replacePrevCharCnt!==0||vt.replaceNextCharCnt!==0||vt.positionDelta!==0)&&this._onType.fire(vt))})),this._register(this._textArea.onCut(pt=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(pt),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(pt=>{this._ensureClipboardGetsEditorSelection(pt)})),this._register(this._textArea.onPaste(pt=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),pt.preventDefault(),!pt.clipboardData)return;let[mt,vt]=ClipboardEventUtils.getTextData(pt.clipboardData);mt&&(vt=vt||InMemoryClipboardMetadataManager.INSTANCE.get(mt),this._onPaste.fire({text:mt,metadata:vt}))})),this._register(this._textArea.onFocus(()=>{const pt=this._hasFocus;this._setHasFocus(!0),this._browser.isSafari&&!pt&&this._hasFocus&&this._asyncFocusGainWriteScreenReaderContent.schedule()})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeScreenReaderContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeScreenReaderContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_installSelectionChangeListener(){let nt=0;return addDisposableListener(document,"selectionchange",ot=>{if(inputLatency.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;const rt=Date.now(),ut=rt-nt;if(nt=rt,ut<5)return;const gt=rt-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),gt<100||!this._textAreaState.selection)return;const pt=this._textArea.getValue();if(this._textAreaState.value!==pt)return;const mt=this._textArea.getSelectionStart(),vt=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===mt&&this._textAreaState.selectionEnd===vt)return;const St=this._textAreaState.deduceEditorPosition(mt),yt=this._host.deduceModelPosition(St[0],St[1],St[2]),wt=this._textAreaState.deduceEditorPosition(vt),Lt=this._host.deduceModelPosition(wt[0],wt[1],wt[2]),xt=new Selection$1(yt.lineNumber,yt.column,Lt.lineNumber,Lt.column);this._onSelectionChangeRequest.fire(xt)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(nt){this._hasFocus!==nt&&(this._hasFocus=nt,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeScreenReaderContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(nt,ot){this._hasFocus||(ot=ot.collapseSelection()),ot.writeToTextArea(nt,this._textArea,this._hasFocus),this._textAreaState=ot}writeScreenReaderContent(nt){this._currentComposition||this._setAndWriteTextAreaState(nt,this._host.getScreenReaderContent())}_ensureClipboardGetsEditorSelection(nt){const ot=this._host.getDataToCopy(),rt={version:1,isFromEmptySelection:ot.isFromEmptySelection,multicursorText:ot.multicursorText,mode:ot.mode};InMemoryClipboardMetadataManager.INSTANCE.set(this._browser.isFirefox?ot.text.replace(/\r\n/g,`
`):ot.text,rt),nt.preventDefault(),nt.clipboardData&&ClipboardEventUtils.setTextData(nt.clipboardData,ot.text,ot.html,rt)}}class ClipboardEventUtils{static getTextData(nt){const ot=nt.getData(Mimes.text);let rt=null;const ut=nt.getData("vscode-editor-data");if(typeof ut=="string")try{rt=JSON.parse(ut),rt.version!==1&&(rt=null)}catch{}return ot.length===0&&rt===null&&nt.files.length>0?[Array.prototype.slice.call(nt.files,0).map(pt=>pt.name).join(`
`),null]:[ot,rt]}static setTextData(nt,ot,rt,ut){nt.setData(Mimes.text,ot),typeof rt=="string"&&nt.setData("text/html",rt),nt.setData("vscode-editor-data",JSON.stringify(ut))}}class TextAreaWrapper extends Disposable{constructor(nt){super(),this._actual=nt,this.onKeyDown=this._register(new DomEmitter(this._actual,"keydown")).event,this.onKeyUp=this._register(new DomEmitter(this._actual,"keyup")).event,this.onCompositionStart=this._register(new DomEmitter(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(new DomEmitter(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(new DomEmitter(this._actual,"compositionend")).event,this.onBeforeInput=this._register(new DomEmitter(this._actual,"beforeinput")).event,this.onInput=this._register(new DomEmitter(this._actual,"input")).event,this.onCut=this._register(new DomEmitter(this._actual,"cut")).event,this.onCopy=this._register(new DomEmitter(this._actual,"copy")).event,this.onPaste=this._register(new DomEmitter(this._actual,"paste")).event,this.onFocus=this._register(new DomEmitter(this._actual,"focus")).event,this.onBlur=this._register(new DomEmitter(this._actual,"blur")).event,this._onSyntheticTap=this._register(new Emitter$2),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>inputLatency.onKeyDown())),this._register(this.onBeforeInput(()=>inputLatency.onBeforeInput())),this._register(this.onInput(()=>inputLatency.onInput())),this._register(this.onKeyUp(()=>inputLatency.onKeyUp())),this._register(addDisposableListener(this._actual,TextAreaSyntethicEvents.Tap,()=>this._onSyntheticTap.fire()))}hasFocus(){const nt=getShadowRoot(this._actual);return nt?nt.activeElement===this._actual:isInDOM(this._actual)?document.activeElement===this._actual:!1}setIgnoreSelectionChangeTime(nt){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(nt,ot){const rt=this._actual;rt.value!==ot&&(this.setIgnoreSelectionChangeTime("setValue"),rt.value=ot)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(nt,ot,rt){const ut=this._actual;let gt=null;const pt=getShadowRoot(ut);pt?gt=pt.activeElement:gt=document.activeElement;const mt=gt===ut,vt=ut.selectionStart,St=ut.selectionEnd;if(mt&&vt===ot&&St===rt){isFirefox&&window.parent!==window&&ut.focus();return}if(mt){this.setIgnoreSelectionChangeTime("setSelectionRange"),ut.setSelectionRange(ot,rt),isFirefox&&window.parent!==window&&ut.focus();return}try{const yt=saveParentsScrollTop(ut);this.setIgnoreSelectionChangeTime("setSelectionRange"),ut.focus(),ut.setSelectionRange(ot,rt),restoreParentsScrollTop(ut,yt)}catch{}}}class PointerEventHandler extends MouseHandler{constructor(nt,ot,rt){super(nt,ot,rt),this._register(Gesture.addTarget(this.viewHelper.linesContentDomNode)),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Tap,gt=>this.onTap(gt))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Change,gt=>this.onChange(gt))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Contextmenu,gt=>this._onContextMenu(new EditorMouseEvent(gt,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(addDisposableListener(this.viewHelper.linesContentDomNode,"pointerdown",gt=>{const pt=gt.pointerType;if(pt==="mouse"){this._lastPointerType="mouse";return}else pt==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const ut=new EditorPointerEventFactory(this.viewHelper.viewDomNode);this._register(ut.onPointerMove(this.viewHelper.viewDomNode,gt=>this._onMouseMove(gt))),this._register(ut.onPointerUp(this.viewHelper.viewDomNode,gt=>this._onMouseUp(gt))),this._register(ut.onPointerLeave(this.viewHelper.viewDomNode,gt=>this._onMouseLeave(gt))),this._register(ut.onPointerDown(this.viewHelper.viewDomNode,(gt,pt)=>this._onMouseDown(gt,pt)))}onTap(nt){if(!nt.initialTarget||!this.viewHelper.linesContentDomNode.contains(nt.initialTarget))return;nt.preventDefault(),this.viewHelper.focusTextArea();const ot=this._createMouseTarget(new EditorMouseEvent(nt,!1,this.viewHelper.viewDomNode),!1);ot.position&&this.viewController.dispatchMouse({position:ot.position,mouseColumn:ot.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:nt.tapCount,inSelectionMode:!1,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:ot.type===6&&ot.detail.injectedText!==null})}onChange(nt){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-nt.translationX,-nt.translationY)}_onMouseDown(nt,ot){nt.browserEvent.pointerType!=="touch"&&super._onMouseDown(nt,ot)}}class TouchHandler extends MouseHandler{constructor(nt,ot,rt){super(nt,ot,rt),this._register(Gesture.addTarget(this.viewHelper.linesContentDomNode)),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Tap,ut=>this.onTap(ut))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Change,ut=>this.onChange(ut))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Contextmenu,ut=>this._onContextMenu(new EditorMouseEvent(ut,!1,this.viewHelper.viewDomNode),!1)))}onTap(nt){nt.preventDefault(),this.viewHelper.focusTextArea();const ot=this._createMouseTarget(new EditorMouseEvent(nt,!1,this.viewHelper.viewDomNode),!1);if(ot.position){const rt=document.createEvent("CustomEvent");rt.initEvent(TextAreaSyntethicEvents.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(rt),this.viewController.moveTo(ot.position,1)}}onChange(nt){this._context.viewModel.viewLayout.deltaScrollNow(-nt.translationX,-nt.translationY)}}class PointerHandler extends Disposable{constructor(nt,ot,rt){super(),isIOS&&BrowserFeatures.pointerEvents?this.handler=this._register(new PointerEventHandler(nt,ot,rt)):window.TouchEvent?this.handler=this._register(new TouchHandler(nt,ot,rt)):this.handler=this._register(new MouseHandler(nt,ot,rt))}getTargetAtClientPoint(nt,ot){return this.handler.getTargetAtClientPoint(nt,ot)}}const textAreaHandler="",lineNumbers="";class DynamicViewOverlay extends ViewEventHandler{}const IThemeService=createDecorator("themeService");function themeColorFromId(ct){return{id:ct}}function getThemeTypeSelector(ct){switch(ct){case ColorScheme.DARK:return"vs-dark";case ColorScheme.HIGH_CONTRAST_DARK:return"hc-black";case ColorScheme.HIGH_CONTRAST_LIGHT:return"hc-light";default:return"vs"}}const Extensions$3={ThemingContribution:"base.contributions.theming"};class ThemingRegistry{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new Emitter$2}onColorThemeChange(nt){return this.themingParticipants.push(nt),this.onThemingParticipantAddedEmitter.fire(nt),toDisposable(()=>{const ot=this.themingParticipants.indexOf(nt);this.themingParticipants.splice(ot,1)})}getThemingParticipants(){return this.themingParticipants}}const themingRegistry$1=new ThemingRegistry;Registry.add(Extensions$3.ThemingContribution,themingRegistry$1);function registerThemingParticipant(ct){return themingRegistry$1.onColorThemeChange(ct)}class Themable extends Disposable{constructor(nt){super(),this.themeService=nt,this.theme=nt.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(ot=>this.onThemeChange(ot)))}onThemeChange(nt){this.theme=nt,this.updateStyles()}updateStyles(){}}const editorLineHighlight=registerColor("editor.lineHighlightBackground",{dark:null,light:null,hcDark:null,hcLight:null},localize("lineHighlight","Background color for the highlight of line at the cursor position.")),editorLineHighlightBorder=registerColor("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:contrastBorder},localize("lineHighlightBorderBox","Background color for the border around the line at the cursor position."));registerColor("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},localize("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("rangeHighlightBorder","Background color of the border around highlighted ranges."),!0);registerColor("editor.symbolHighlightBackground",{dark:editorFindMatchHighlight,light:editorFindMatchHighlight,hcDark:null,hcLight:null},localize("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("symbolHighlightBorder","Background color of the border around highlighted symbols."),!0);const editorCursorForeground=registerColor("editorCursor.foreground",{dark:"#AEAFAD",light:Color.black,hcDark:Color.white,hcLight:"#0F4A85"},localize("caret","Color of the editor cursor.")),editorCursorBackground=registerColor("editorCursor.background",null,localize("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),editorWhitespaces=registerColor("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},localize("editorWhitespaces","Color of whitespace characters in the editor.")),editorIndentGuides=registerColor("editorIndentGuide.background",{dark:editorWhitespaces,light:editorWhitespaces,hcDark:editorWhitespaces,hcLight:editorWhitespaces},localize("editorIndentGuides","Color of the editor indentation guides.")),editorActiveIndentGuides=registerColor("editorIndentGuide.activeBackground",{dark:editorWhitespaces,light:editorWhitespaces,hcDark:editorWhitespaces,hcLight:editorWhitespaces},localize("editorActiveIndentGuide","Color of the active editor indentation guides.")),editorLineNumbers=registerColor("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:Color.white,hcLight:"#292929"},localize("editorLineNumbers","Color of editor line numbers.")),deprecatedEditorActiveLineNumber=registerColor("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("editorActiveLineNumber","Color of editor active line number"),!1,localize("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead."));registerColor("editorLineNumber.activeForeground",{dark:deprecatedEditorActiveLineNumber,light:deprecatedEditorActiveLineNumber,hcDark:deprecatedEditorActiveLineNumber,hcLight:deprecatedEditorActiveLineNumber},localize("editorActiveLineNumber","Color of editor active line number"));const editorDimmedLineNumber=registerColor("editorLineNumber.dimmedForeground",{dark:null,light:null,hcDark:null,hcLight:null},localize("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed."));registerColor("editorRuler.foreground",{dark:"#5A5A5A",light:Color.lightgrey,hcDark:Color.white,hcLight:"#292929"},localize("editorRuler","Color of the editor rulers."));registerColor("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},localize("editorCodeLensForeground","Foreground color of editor CodeLens"));registerColor("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},localize("editorBracketMatchBackground","Background color behind matching brackets"));registerColor("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:contrastBorder,hcLight:contrastBorder},localize("editorBracketMatchBorder","Color for matching brackets boxes"));const editorOverviewRulerBorder=registerColor("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},localize("editorOverviewRulerBorder","Color of the overview ruler border.")),editorOverviewRulerBackground=registerColor("editorOverviewRuler.background",null,localize("editorOverviewRulerBackground","Background color of the editor overview ruler."));registerColor("editorGutter.background",{dark:editorBackground,light:editorBackground,hcDark:editorBackground,hcLight:editorBackground},localize("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers."));registerColor("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:Color.fromHex("#fff").transparent(.8),hcLight:contrastBorder},localize("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor."));const editorUnnecessaryCodeOpacity=registerColor("editorUnnecessaryCode.opacity",{dark:Color.fromHex("#000a"),light:Color.fromHex("#0007"),hcDark:null,hcLight:null},localize("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`));registerColor("editorGhostText.border",{dark:null,light:null,hcDark:Color.fromHex("#fff").transparent(.8),hcLight:Color.fromHex("#292929").transparent(.8)},localize("editorGhostTextBorder","Border color of ghost text in the editor."));registerColor("editorGhostText.foreground",{dark:Color.fromHex("#ffffff56"),light:Color.fromHex("#0007"),hcDark:null,hcLight:null},localize("editorGhostTextForeground","Foreground color of the ghost text in the editor."));registerColor("editorGhostText.background",{dark:null,light:null,hcDark:null,hcLight:null},localize("editorGhostTextBackground","Background color of the ghost text in the editor."));const rulerRangeDefault=new Color(new RGBA(0,122,204,.6)),overviewRulerRangeHighlight=registerColor("editorOverviewRuler.rangeHighlightForeground",{dark:rulerRangeDefault,light:rulerRangeDefault,hcDark:rulerRangeDefault,hcLight:rulerRangeDefault},localize("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),overviewRulerError=registerColor("editorOverviewRuler.errorForeground",{dark:new Color(new RGBA(255,18,18,.7)),light:new Color(new RGBA(255,18,18,.7)),hcDark:new Color(new RGBA(255,50,50,1)),hcLight:"#B5200D"},localize("overviewRuleError","Overview ruler marker color for errors.")),overviewRulerWarning=registerColor("editorOverviewRuler.warningForeground",{dark:editorWarningForeground,light:editorWarningForeground,hcDark:editorWarningBorder,hcLight:editorWarningBorder},localize("overviewRuleWarning","Overview ruler marker color for warnings.")),overviewRulerInfo=registerColor("editorOverviewRuler.infoForeground",{dark:editorInfoForeground,light:editorInfoForeground,hcDark:editorInfoBorder,hcLight:editorInfoBorder},localize("overviewRuleInfo","Overview ruler marker color for infos.")),editorBracketHighlightingForeground1=registerColor("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},localize("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground2=registerColor("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},localize("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground3=registerColor("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},localize("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground4=registerColor("editorBracketHighlight.foreground4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground5=registerColor("editorBracketHighlight.foreground5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground6=registerColor("editorBracketHighlight.foreground6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),editorBracketHighlightingUnexpectedBracketForeground=registerColor("editorBracketHighlight.unexpectedBracket.foreground",{dark:new Color(new RGBA(255,18,18,.8)),light:new Color(new RGBA(255,18,18,.8)),hcDark:new Color(new RGBA(255,50,50,1)),hcLight:""},localize("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),editorBracketPairGuideBackground1=registerColor("editorBracketPairGuide.background1",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground2=registerColor("editorBracketPairGuide.background2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground3=registerColor("editorBracketPairGuide.background3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground4=registerColor("editorBracketPairGuide.background4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground5=registerColor("editorBracketPairGuide.background5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground6=registerColor("editorBracketPairGuide.background6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground1=registerColor("editorBracketPairGuide.activeBackground1",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground2=registerColor("editorBracketPairGuide.activeBackground2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground3=registerColor("editorBracketPairGuide.activeBackground3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground4=registerColor("editorBracketPairGuide.activeBackground4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground5=registerColor("editorBracketPairGuide.activeBackground5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground6=registerColor("editorBracketPairGuide.activeBackground6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},localize("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));registerColor("editorUnicodeHighlight.border",{dark:"#BD9B03",light:"#CEA33D",hcDark:"#ff0000",hcLight:"#CEA33D"},localize("editorUnicodeHighlight.border","Border color used to highlight unicode characters."));registerColor("editorUnicodeHighlight.background",{dark:"#bd9b0326",light:"#cea33d14",hcDark:"#00000000",hcLight:"#cea33d14"},localize("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));registerThemingParticipant((ct,nt)=>{const ot=ct.getColor(editorBackground),rt=ct.getColor(editorLineHighlight),ut=rt&&!rt.isTransparent()?rt:ot;ut&&nt.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${ut}; }`)});class LineNumbersOverlay extends DynamicViewOverlay{constructor(nt){super(),this._context=nt,this._readConfig(),this._lastCursorModelPosition=new Position$1(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const nt=this._context.configuration.options;this._lineHeight=nt.get(64);const ot=nt.get(65);this._renderLineNumbers=ot.renderType,this._renderCustomLineNumbers=ot.renderFn,this._renderFinalNewline=nt.get(90);const rt=nt.get(139);this._lineNumbersLeft=rt.lineNumbersLeft,this._lineNumbersWidth=rt.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(nt){return this._readConfig(),!0}onCursorStateChanged(nt){const ot=nt.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(ot);let rt=!1;return this._activeLineNumber!==ot.lineNumber&&(this._activeLineNumber=ot.lineNumber,rt=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(rt=!0),rt}onFlushed(nt){return!0}onLinesChanged(nt){return!0}onLinesDeleted(nt){return!0}onLinesInserted(nt){return!0}onScrollChanged(nt){return nt.scrollTopChanged}onZonesChanged(nt){return!0}_getLineRenderLineNumber(nt){const ot=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(nt,1));if(ot.column!==1)return"";const rt=ot.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(rt);if(this._renderLineNumbers===2){const ut=Math.abs(this._lastCursorModelPosition.lineNumber-rt);return ut===0?'<span class="relative-current-line-number">'+rt+"</span>":String(ut)}return this._renderLineNumbers===3?this._lastCursorModelPosition.lineNumber===rt||rt%10===0?String(rt):"":String(rt)}prepareRender(nt){if(this._renderLineNumbers===0){this._renderResult=null;return}const ot=isLinux?this._lineHeight%2===0?" lh-even":" lh-odd":"",rt=nt.visibleRange.startLineNumber,ut=nt.visibleRange.endLineNumber,gt=this._context.viewModel.getLineCount(),pt=[];for(let mt=rt;mt<=ut;mt++){const vt=mt-rt,St=this._getLineRenderLineNumber(mt);if(!St){pt[vt]="";continue}let yt="";if(mt===gt&&this._context.viewModel.getLineLength(mt)===0){if(this._renderFinalNewline==="off"){pt[vt]="";continue}this._renderFinalNewline==="dimmed"&&(yt=" dimmed-line-number")}mt===this._activeLineNumber&&(yt=" active-line-number"),pt[vt]=`<div class="${LineNumbersOverlay.CLASS_NAME}${ot}${yt}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${St}</div>`}this._renderResult=pt}render(nt,ot){if(!this._renderResult)return"";const rt=ot-nt;return rt<0||rt>=this._renderResult.length?"":this._renderResult[rt]}}LineNumbersOverlay.CLASS_NAME="line-numbers";registerThemingParticipant((ct,nt)=>{const ot=ct.getColor(editorLineNumbers),rt=ct.getColor(editorDimmedLineNumber);rt?nt.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${rt}; }`):ot&&nt.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${ot.transparent(.4)}; }`)});const margin="";class Margin extends ViewPart{constructor(nt){super(nt);const ot=this._context.configuration.options,rt=ot.get(139);this._canUseLayerHinting=!ot.get(30),this._contentLeft=rt.contentLeft,this._glyphMarginLeft=rt.glyphMarginLeft,this._glyphMarginWidth=rt.glyphMarginWidth,this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setClassName(Margin.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=createFastDomNode(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(Margin.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(nt){const ot=this._context.configuration.options,rt=ot.get(139);return this._canUseLayerHinting=!ot.get(30),this._contentLeft=rt.contentLeft,this._glyphMarginLeft=rt.glyphMarginLeft,this._glyphMarginWidth=rt.glyphMarginWidth,!0}onScrollChanged(nt){return super.onScrollChanged(nt)||nt.scrollTopChanged}prepareRender(nt){}render(nt){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const ot=nt.scrollTop-nt.bigNumbersDelta;this._domNode.setTop(-ot);const rt=Math.min(nt.scrollHeight,1e6);this._domNode.setHeight(rt),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(rt)}}Margin.CLASS_NAME="glyph-margin";Margin.OUTER_CLASS_NAME="margin";const mouseCursor="",MOUSE_CURSOR_TEXT_CSS_CLASS_NAME="monaco-mouse-cursor-text";class IMEImpl{constructor(){this._onDidChange=new Emitter$2,this.onDidChange=this._onDidChange.event,this._enabled=!0}get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}}const IME=new IMEImpl;class VisibleTextAreaData{constructor(nt,ot,rt,ut,gt){this._context=nt,this.modelLineNumber=ot,this.distanceToModelLineStart=rt,this.widthOfHiddenLineTextBefore=ut,this.distanceToModelLineEnd=gt,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(nt){const ot=new Position$1(this.modelLineNumber,this.distanceToModelLineStart+1),rt=new Position$1(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(ot),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(rt),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=nt.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=nt.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(nt){return this._previousPresentation||(nt?this._previousPresentation=nt:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const canUseZeroSizeTextarea=isFirefox;class TextAreaHandler extends ViewPart{constructor(nt,ot,rt){super(nt),this._primaryCursorPosition=new Position$1(1,1),this._primaryCursorVisibleRange=null,this._viewController=ot,this._visibleRangeProvider=rt,this._scrollLeft=0,this._scrollTop=0;const ut=this._context.configuration.options,gt=ut.get(139);this._setAccessibilityOptions(ut),this._contentLeft=gt.contentLeft,this._contentWidth=gt.contentWidth,this._contentHeight=gt.height,this._fontInfo=ut.get(48),this._lineHeight=ut.get(64),this._emptySelectionClipboard=ut.get(35),this._copyWithSyntaxHighlighting=ut.get(23),this._visibleTextArea=null,this._selections=[new Selection$1(1,1,1,1)],this._modelSelections=[new Selection$1(1,1,1,1)],this._lastRenderPosition=null,this.textArea=createFastDomNode(document.createElement("textarea")),PartFingerprints.write(this.textArea,6),this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:pt}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${pt*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(ut)),this.textArea.setAttribute("tabindex",String(ut.get(119))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",localize("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this._ensureReadOnlyAttribute(),this.textAreaCover=createFastDomNode(document.createElement("div")),this.textAreaCover.setPosition("absolute");const mt={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:yt=>this._context.viewModel.getLineMaxColumn(yt),getValueInRange:(yt,wt)=>this._context.viewModel.getValueInRange(yt,wt),getValueLengthInRange:(yt,wt)=>this._context.viewModel.getValueLengthInRange(yt,wt),modifyPosition:(yt,wt)=>this._context.viewModel.modifyPosition(yt,wt)},vt={getDataToCopy:()=>{const yt=this._context.viewModel.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,isWindows),wt=this._context.viewModel.model.getEOL(),Lt=this._emptySelectionClipboard&&this._modelSelections.length===1&&this._modelSelections[0].isEmpty(),xt=Array.isArray(yt)?yt:null,It=Array.isArray(yt)?yt.join(wt):yt;let kt,At=null;if(CopyOptions.forceCopyWithSyntaxHighlighting||this._copyWithSyntaxHighlighting&&It.length<65536){const Tt=this._context.viewModel.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);Tt&&(kt=Tt.html,At=Tt.mode)}return{isFromEmptySelection:Lt,multicursorText:xt,text:It,html:kt,mode:At}},getScreenReaderContent:()=>{if(this._accessibilitySupport===1){const yt=this._selections[0];if(isMacintosh&&yt.isEmpty()){const Lt=yt.getStartPosition();let xt=this._getWordBeforePosition(Lt);if(xt.length===0&&(xt=this._getCharacterBeforePosition(Lt)),xt.length>0)return new TextAreaState(xt,xt.length,xt.length,Range$2.fromPositions(Lt),0)}const wt=500;if(isMacintosh&&!yt.isEmpty()&&mt.getValueLengthInRange(yt,0)<wt){const Lt=mt.getValueInRange(yt,0);return new TextAreaState(Lt,0,Lt.length,yt,0)}if(isSafari&&!yt.isEmpty()){const Lt="vscode-placeholder";return new TextAreaState(Lt,0,Lt.length,null,void 0)}return TextAreaState.EMPTY}if(isAndroid){const yt=this._selections[0];if(yt.isEmpty()){const wt=yt.getStartPosition(),[Lt,xt]=this._getAndroidWordAtPosition(wt);if(Lt.length>0)return new TextAreaState(Lt,xt,xt,Range$2.fromPositions(wt),0)}return TextAreaState.EMPTY}return PagedScreenReaderStrategy.fromEditorSelection(mt,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0)},deduceModelPosition:(yt,wt,Lt)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(yt,wt,Lt)},St=this._register(new TextAreaWrapper(this.textArea.domNode));this._textAreaInput=this._register(new TextAreaInput(vt,St,OS,browser)),this._register(this._textAreaInput.onKeyDown(yt=>{this._viewController.emitKeyDown(yt)})),this._register(this._textAreaInput.onKeyUp(yt=>{this._viewController.emitKeyUp(yt)})),this._register(this._textAreaInput.onPaste(yt=>{let wt=!1,Lt=null,xt=null;yt.metadata&&(wt=this._emptySelectionClipboard&&!!yt.metadata.isFromEmptySelection,Lt=typeof yt.metadata.multicursorText<"u"?yt.metadata.multicursorText:null,xt=yt.metadata.mode),this._viewController.paste(yt.text,wt,Lt,xt)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(yt=>{yt.replacePrevCharCnt||yt.replaceNextCharCnt||yt.positionDelta?this._viewController.compositionType(yt.text,yt.replacePrevCharCnt,yt.replaceNextCharCnt,yt.positionDelta):this._viewController.type(yt.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(yt=>{this._viewController.setSelection(yt)})),this._register(this._textAreaInput.onCompositionStart(yt=>{const wt=this.textArea.domNode,Lt=this._modelSelections[0],{distanceToModelLineStart:xt,widthOfHiddenTextBefore:It}=(()=>{const At=wt.value.substring(0,Math.min(wt.selectionStart,wt.selectionEnd)),Tt=At.lastIndexOf(`
`),Rt=At.substring(Tt+1),Nt=Rt.lastIndexOf("	"),Pt=Rt.length-Nt-1,Ft=Lt.getStartPosition(),Kt=Math.min(Ft.column-1,Pt),Bt=Ft.column-1-Kt,Ut=Rt.substring(0,Rt.length-Kt),{tabSize:qt}=this._context.viewModel.model.getOptions(),Yt=measureText(Ut,this._fontInfo,qt);return{distanceToModelLineStart:Bt,widthOfHiddenTextBefore:Yt}})(),{distanceToModelLineEnd:kt}=(()=>{const At=wt.value.substring(Math.max(wt.selectionStart,wt.selectionEnd)),Tt=At.indexOf(`
`),Rt=Tt===-1?At:At.substring(0,Tt),Nt=Rt.indexOf("	"),Pt=Nt===-1?Rt.length:Rt.length-Nt-1,Ft=Lt.getEndPosition(),Kt=Math.min(this._context.viewModel.model.getLineMaxColumn(Ft.lineNumber)-Ft.column,Pt);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(Ft.lineNumber)-Ft.column-Kt}})();this._context.viewModel.revealRange("keyboard",!0,Range$2.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new VisibleTextAreaData(this._context,Lt.startLineNumber,xt,It,kt),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(yt=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(IME.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}writeScreenReaderContent(nt){this._textAreaInput.writeScreenReaderContent(nt)}dispose(){super.dispose()}_getAndroidWordAtPosition(nt){const ot='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',rt=this._context.viewModel.getLineContent(nt.lineNumber),ut=getMapForWordSeparators(ot);let gt=!0,pt=nt.column,mt=!0,vt=nt.column,St=0;for(;St<50&&(gt||mt);){if(gt&&pt<=1&&(gt=!1),gt){const yt=rt.charCodeAt(pt-2);ut.get(yt)!==0?gt=!1:pt--}if(mt&&vt>rt.length&&(mt=!1),mt){const yt=rt.charCodeAt(vt-1);ut.get(yt)!==0?mt=!1:vt++}St++}return[rt.substring(pt-1,vt-1),nt.column-pt]}_getWordBeforePosition(nt){const ot=this._context.viewModel.getLineContent(nt.lineNumber),rt=getMapForWordSeparators(this._context.configuration.options.get(125));let ut=nt.column,gt=0;for(;ut>1;){const pt=ot.charCodeAt(ut-2);if(rt.get(pt)!==0||gt>50)return ot.substring(ut-1,nt.column-1);gt++,ut--}return ot.substring(0,nt.column-1)}_getCharacterBeforePosition(nt){if(nt.column>1){const rt=this._context.viewModel.getLineContent(nt.lineNumber).charAt(nt.column-2);if(!isHighSurrogate(rt.charCodeAt(0)))return rt}return""}_getAriaLabel(nt){return nt.get(2)===1?localize("accessibilityOffAriaLabel","The editor is not accessible at this time. Press {0} for options.",isLinux?"Shift+Alt+F1":"Alt+F1"):nt.get(4)}_setAccessibilityOptions(nt){this._accessibilitySupport=nt.get(2);const ot=nt.get(3);this._accessibilitySupport===2&&ot===EditorOptions.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=ot;const ut=nt.get(139).wrappingColumn;if(ut!==-1&&this._accessibilitySupport!==1){const gt=nt.get(48);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(ut*gt.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=canUseZeroSizeTextarea?0:1}onConfigurationChanged(nt){const ot=this._context.configuration.options,rt=ot.get(139);this._setAccessibilityOptions(ot),this._contentLeft=rt.contentLeft,this._contentWidth=rt.contentWidth,this._contentHeight=rt.height,this._fontInfo=ot.get(48),this._lineHeight=ot.get(64),this._emptySelectionClipboard=ot.get(35),this._copyWithSyntaxHighlighting=ot.get(23),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:ut}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${ut*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",this._getAriaLabel(ot)),this.textArea.setAttribute("tabindex",String(ot.get(119))),(nt.hasChanged(32)||nt.hasChanged(87))&&this._ensureReadOnlyAttribute(),nt.hasChanged(2)&&this._textAreaInput.writeScreenReaderContent("strategy changed"),!0}onCursorStateChanged(nt){return this._selections=nt.selections.slice(0),this._modelSelections=nt.modelSelections.slice(0),this._textAreaInput.writeScreenReaderContent("selection changed"),!0}onDecorationsChanged(nt){return!0}onFlushed(nt){return!0}onLinesChanged(nt){return!0}onLinesDeleted(nt){return!0}onLinesInserted(nt){return!0}onScrollChanged(nt){return this._scrollLeft=nt.scrollLeft,this._scrollTop=nt.scrollTop,!0}onZonesChanged(nt){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(nt){nt.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",nt.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),nt.role&&this.textArea.setAttribute("role",nt.role)}_ensureReadOnlyAttribute(){const nt=this._context.configuration.options;!IME.enabled||nt.get(32)&&nt.get(87)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}prepareRender(nt){var ot;this._primaryCursorPosition=new Position$1(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=nt.visibleRangeForPosition(this._primaryCursorPosition),(ot=this._visibleTextArea)===null||ot===void 0||ot.prepareRender(nt)}render(nt){this._textAreaInput.writeScreenReaderContent("render"),this._render()}_render(){var nt;if(this._visibleTextArea){const ut=this._visibleTextArea.visibleTextareaStart,gt=this._visibleTextArea.visibleTextareaEnd,pt=this._visibleTextArea.startPosition,mt=this._visibleTextArea.endPosition;if(pt&&mt&&ut&&gt&&gt.left>=this._scrollLeft&&ut.left<=this._scrollLeft+this._contentWidth){const vt=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,St=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let yt=this._visibleTextArea.widthOfHiddenLineTextBefore,wt=this._contentLeft+ut.left-this._scrollLeft,Lt=gt.left-ut.left+1;if(wt<this._contentLeft){const Rt=this._contentLeft-wt;wt+=Rt,yt+=Rt,Lt-=Rt}Lt>this._contentWidth&&(Lt=this._contentWidth);const xt=this._context.viewModel.getViewLineData(pt.lineNumber),It=xt.tokens.findTokenIndexAtOffset(pt.column-1),kt=xt.tokens.findTokenIndexAtOffset(mt.column-1),At=It===kt,Tt=this._visibleTextArea.definePresentation(At?xt.tokens.getPresentation(It):null);this.textArea.domNode.scrollTop=St*this._lineHeight,this.textArea.domNode.scrollLeft=yt,this._doRender({lastRenderPosition:null,top:vt,left:wt,width:Lt,height:this._lineHeight,useCover:!1,color:(TokenizationRegistry.getColorMap()||[])[Tt.foreground],italic:Tt.italic,bold:Tt.bold,underline:Tt.underline,strikethrough:Tt.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const ot=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(ot<this._contentLeft||ot>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const rt=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(rt<0||rt>this._contentHeight){this._renderAtTopLeft();return}if(isMacintosh){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:rt,left:this._textAreaWrapping?this._contentLeft:ot,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const ut=(nt=this._textAreaInput.textAreaState.newlineCountBeforeSelection)!==null&&nt!==void 0?nt:this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=ut*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:rt,left:this._textAreaWrapping?this._contentLeft:ot,width:this._textAreaWidth,height:canUseZeroSizeTextarea?0:1,useCover:!1})}_newlinecount(nt){let ot=0,rt=-1;do{if(rt=nt.indexOf(`
`,rt+1),rt===-1)break;ot++}while(!0);return ot}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:canUseZeroSizeTextarea?0:1,useCover:!0})}_doRender(nt){this._lastRenderPosition=nt.lastRenderPosition;const ot=this.textArea,rt=this.textAreaCover;applyFontInfo(ot,this._fontInfo),ot.setTop(nt.top),ot.setLeft(nt.left),ot.setWidth(nt.width),ot.setHeight(nt.height),ot.setColor(nt.color?Color.Format.CSS.formatHex(nt.color):""),ot.setFontStyle(nt.italic?"italic":""),nt.bold&&ot.setFontWeight("bold"),ot.setTextDecoration(`${nt.underline?" underline":""}${nt.strikethrough?" line-through":""}`),rt.setTop(nt.useCover?nt.top:0),rt.setLeft(nt.useCover?nt.left:0),rt.setWidth(nt.useCover?nt.width:0),rt.setHeight(nt.useCover?nt.height:0);const ut=this._context.configuration.options;ut.get(55)?rt.setClassName("monaco-editor-background textAreaCover "+Margin.OUTER_CLASS_NAME):ut.get(65).renderType!==0?rt.setClassName("monaco-editor-background textAreaCover "+LineNumbersOverlay.CLASS_NAME):rt.setClassName("monaco-editor-background textAreaCover")}}function measureText(ct,nt,ot){if(ct.length===0)return 0;const rt=document.createElement("div");rt.style.position="absolute",rt.style.top="-50000px",rt.style.width="50000px";const ut=document.createElement("span");applyFontInfo(ut,nt),ut.style.whiteSpace="pre",ut.style.tabSize=`${ot*nt.spaceWidth}px`,ut.append(ct),rt.appendChild(ut),document.body.appendChild(rt);const gt=ut.offsetWidth;return document.body.removeChild(rt),gt}function _normalizeIndentationFromWhitespace(ct,nt,ot){let rt=0;for(let gt=0;gt<ct.length;gt++)ct.charAt(gt)==="	"?rt=CursorColumns.nextIndentTabStop(rt,nt):rt++;let ut="";if(!ot){const gt=Math.floor(rt/nt);rt=rt%nt;for(let pt=0;pt<gt;pt++)ut+="	"}for(let gt=0;gt<rt;gt++)ut+=" ";return ut}function normalizeIndentation(ct,nt,ot){let rt=firstNonWhitespaceIndex(ct);return rt===-1&&(rt=ct.length),_normalizeIndentationFromWhitespace(ct.substring(0,rt),nt,ot)+ct.substring(rt)}const autoCloseAlways=()=>!0,autoCloseNever=()=>!1,autoCloseBeforeWhitespace=ct=>ct===" "||ct==="	";class CursorConfiguration{static shouldRecreate(nt){return nt.hasChanged(139)||nt.hasChanged(125)||nt.hasChanged(35)||nt.hasChanged(74)||nt.hasChanged(76)||nt.hasChanged(77)||nt.hasChanged(5)||nt.hasChanged(9)||nt.hasChanged(7)||nt.hasChanged(8)||nt.hasChanged(12)||nt.hasChanged(123)||nt.hasChanged(48)||nt.hasChanged(87)}constructor(nt,ot,rt,ut){this.languageConfigurationService=ut,this._cursorMoveConfigurationBrand=void 0,this._languageId=nt;const gt=rt.options,pt=gt.get(139),mt=gt.get(48);this.readOnly=gt.get(87),this.tabSize=ot.tabSize,this.indentSize=ot.indentSize,this.insertSpaces=ot.insertSpaces,this.stickyTabStops=gt.get(111),this.lineHeight=mt.lineHeight,this.typicalHalfwidthCharacterWidth=mt.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(pt.height/this.lineHeight)-2),this.useTabStops=gt.get(123),this.wordSeparators=gt.get(125),this.emptySelectionClipboard=gt.get(35),this.copyWithSyntaxHighlighting=gt.get(23),this.multiCursorMergeOverlapping=gt.get(74),this.multiCursorPaste=gt.get(76),this.multiCursorLimit=gt.get(77),this.autoClosingBrackets=gt.get(5),this.autoClosingQuotes=gt.get(9),this.autoClosingDelete=gt.get(7),this.autoClosingOvertype=gt.get(8),this.autoSurround=gt.get(12),this.autoIndent=gt.get(10),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(nt,this.autoClosingQuotes,!0),bracket:this._getShouldAutoClose(nt,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(nt).getAutoClosingPairs();const vt=this.languageConfigurationService.getLanguageConfiguration(nt).getSurroundingPairs();if(vt)for(const St of vt)this.surroundingPairs[St.open]=St.close}get electricChars(){var nt;if(!this._electricChars){this._electricChars={};const ot=(nt=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter)===null||nt===void 0?void 0:nt.getElectricCharacters();if(ot)for(const rt of ot)this._electricChars[rt]=!0}return this._electricChars}onElectricCharacter(nt,ot,rt){const ut=createScopedLineTokens(ot,rt-1),gt=this.languageConfigurationService.getLanguageConfiguration(ut.languageId).electricCharacter;return gt?gt.onElectricCharacter(nt,ut,rt-ut.firstCharOffset):null}normalizeIndentation(nt){return normalizeIndentation(nt,this.indentSize,this.insertSpaces)}_getShouldAutoClose(nt,ot,rt){switch(ot){case"beforeWhitespace":return autoCloseBeforeWhitespace;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(nt,rt);case"always":return autoCloseAlways;case"never":return autoCloseNever}}_getLanguageDefinedShouldAutoClose(nt,ot){const rt=this.languageConfigurationService.getLanguageConfiguration(nt).getAutoCloseBeforeSet(ot);return ut=>rt.indexOf(ut)!==-1}visibleColumnFromColumn(nt,ot){return CursorColumns.visibleColumnFromColumn(nt.getLineContent(ot.lineNumber),ot.column,this.tabSize)}columnFromVisibleColumn(nt,ot,rt){const ut=CursorColumns.columnFromVisibleColumn(nt.getLineContent(ot),rt,this.tabSize),gt=nt.getLineMinColumn(ot);if(ut<gt)return gt;const pt=nt.getLineMaxColumn(ot);return ut>pt?pt:ut}}let CursorState$1=class sr{static fromModelState(nt){return new PartialModelCursorState(nt)}static fromViewState(nt){return new PartialViewCursorState(nt)}static fromModelSelection(nt){const ot=Selection$1.liftSelection(nt),rt=new SingleCursorState(Range$2.fromPositions(ot.getSelectionStart()),0,0,ot.getPosition(),0);return sr.fromModelState(rt)}static fromModelSelections(nt){const ot=[];for(let rt=0,ut=nt.length;rt<ut;rt++)ot[rt]=this.fromModelSelection(nt[rt]);return ot}constructor(nt,ot){this._cursorStateBrand=void 0,this.modelState=nt,this.viewState=ot}equals(nt){return this.viewState.equals(nt.viewState)&&this.modelState.equals(nt.modelState)}};class PartialModelCursorState{constructor(nt){this.modelState=nt,this.viewState=null}}class PartialViewCursorState{constructor(nt){this.modelState=null,this.viewState=nt}}class SingleCursorState{constructor(nt,ot,rt,ut,gt){this.selectionStart=nt,this.selectionStartKind=ot,this.selectionStartLeftoverVisibleColumns=rt,this.position=ut,this.leftoverVisibleColumns=gt,this._singleCursorStateBrand=void 0,this.selection=SingleCursorState._computeSelection(this.selectionStart,this.position)}equals(nt){return this.selectionStartLeftoverVisibleColumns===nt.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===nt.leftoverVisibleColumns&&this.selectionStartKind===nt.selectionStartKind&&this.position.equals(nt.position)&&this.selectionStart.equalsRange(nt.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(nt,ot,rt,ut){return nt?new SingleCursorState(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new Position$1(ot,rt),ut):new SingleCursorState(new Range$2(ot,rt,ot,rt),0,ut,new Position$1(ot,rt),ut)}static _computeSelection(nt,ot){return nt.isEmpty()||!ot.isBeforeOrEqual(nt.getStartPosition())?Selection$1.fromPositions(nt.getStartPosition(),ot):Selection$1.fromPositions(nt.getEndPosition(),ot)}}class EditOperationResult{constructor(nt,ot,rt){this._editOperationResultBrand=void 0,this.type=nt,this.commands=ot,this.shouldPushStackElementBefore=rt.shouldPushStackElementBefore,this.shouldPushStackElementAfter=rt.shouldPushStackElementAfter}}function isQuote(ct){return ct==="'"||ct==='"'||ct==="`"}class ColumnSelection{static columnSelect(nt,ot,rt,ut,gt,pt){const mt=Math.abs(gt-rt)+1,vt=rt>gt,St=ut>pt,yt=ut<pt,wt=[];for(let Lt=0;Lt<mt;Lt++){const xt=rt+(vt?-Lt:Lt),It=nt.columnFromVisibleColumn(ot,xt,ut),kt=nt.columnFromVisibleColumn(ot,xt,pt),At=nt.visibleColumnFromColumn(ot,new Position$1(xt,It)),Tt=nt.visibleColumnFromColumn(ot,new Position$1(xt,kt));yt&&(At>pt||Tt<ut)||St&&(Tt>ut||At<pt)||wt.push(new SingleCursorState(new Range$2(xt,It,xt,It),0,0,new Position$1(xt,kt),0))}if(wt.length===0)for(let Lt=0;Lt<mt;Lt++){const xt=rt+(vt?-Lt:Lt),It=ot.getLineMaxColumn(xt);wt.push(new SingleCursorState(new Range$2(xt,It,xt,It),0,0,new Position$1(xt,It),0))}return{viewStates:wt,reversed:vt,fromLineNumber:rt,fromVisualColumn:ut,toLineNumber:gt,toVisualColumn:pt}}static columnSelectLeft(nt,ot,rt){let ut=rt.toViewVisualColumn;return ut>0&&ut--,ColumnSelection.columnSelect(nt,ot,rt.fromViewLineNumber,rt.fromViewVisualColumn,rt.toViewLineNumber,ut)}static columnSelectRight(nt,ot,rt){let ut=0;const gt=Math.min(rt.fromViewLineNumber,rt.toViewLineNumber),pt=Math.max(rt.fromViewLineNumber,rt.toViewLineNumber);for(let vt=gt;vt<=pt;vt++){const St=ot.getLineMaxColumn(vt),yt=nt.visibleColumnFromColumn(ot,new Position$1(vt,St));ut=Math.max(ut,yt)}let mt=rt.toViewVisualColumn;return mt<ut&&mt++,this.columnSelect(nt,ot,rt.fromViewLineNumber,rt.fromViewVisualColumn,rt.toViewLineNumber,mt)}static columnSelectUp(nt,ot,rt,ut){const gt=ut?nt.pageSize:1,pt=Math.max(1,rt.toViewLineNumber-gt);return this.columnSelect(nt,ot,rt.fromViewLineNumber,rt.fromViewVisualColumn,pt,rt.toViewVisualColumn)}static columnSelectDown(nt,ot,rt,ut){const gt=ut?nt.pageSize:1,pt=Math.min(ot.getLineCount(),rt.toViewLineNumber+gt);return this.columnSelect(nt,ot,rt.fromViewLineNumber,rt.fromViewVisualColumn,pt,rt.toViewVisualColumn)}}class ReplaceCommand{constructor(nt,ot,rt=!1){this._range=nt,this._text=ot,this.insertsAutoWhitespace=rt}getEditOperations(nt,ot){ot.addTrackedEditOperation(this._range,this._text)}computeCursorState(nt,ot){const ut=ot.getInverseEditOperations()[0].range;return Selection$1.fromPositions(ut.getEndPosition())}}class ReplaceCommandThatSelectsText{constructor(nt,ot){this._range=nt,this._text=ot}getEditOperations(nt,ot){ot.addTrackedEditOperation(this._range,this._text)}computeCursorState(nt,ot){const ut=ot.getInverseEditOperations()[0].range;return Selection$1.fromRange(ut,0)}}class ReplaceCommandWithoutChangingPosition{constructor(nt,ot,rt=!1){this._range=nt,this._text=ot,this.insertsAutoWhitespace=rt}getEditOperations(nt,ot){ot.addTrackedEditOperation(this._range,this._text)}computeCursorState(nt,ot){const ut=ot.getInverseEditOperations()[0].range;return Selection$1.fromPositions(ut.getStartPosition())}}class ReplaceCommandWithOffsetCursorState{constructor(nt,ot,rt,ut,gt=!1){this._range=nt,this._text=ot,this._columnDeltaOffset=ut,this._lineNumberDeltaOffset=rt,this.insertsAutoWhitespace=gt}getEditOperations(nt,ot){ot.addTrackedEditOperation(this._range,this._text)}computeCursorState(nt,ot){const ut=ot.getInverseEditOperations()[0].range;return Selection$1.fromPositions(ut.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class ReplaceCommandThatPreservesSelection{constructor(nt,ot,rt,ut=!1){this._range=nt,this._text=ot,this._initialSelection=rt,this._forceMoveMarkers=ut,this._selectionId=null}getEditOperations(nt,ot){ot.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=ot.trackSelection(this._initialSelection)}computeCursorState(nt,ot){return ot.getTrackedSelection(this._selectionId)}}class CursorPosition{constructor(nt,ot,rt){this._cursorPositionBrand=void 0,this.lineNumber=nt,this.column=ot,this.leftoverVisibleColumns=rt}}class MoveOperations{static leftPosition(nt,ot){if(ot.column>nt.getLineMinColumn(ot.lineNumber))return ot.delta(void 0,-prevCharLength(nt.getLineContent(ot.lineNumber),ot.column-1));if(ot.lineNumber>1){const rt=ot.lineNumber-1;return new Position$1(rt,nt.getLineMaxColumn(rt))}else return ot}static leftPositionAtomicSoftTabs(nt,ot,rt){if(ot.column<=nt.getLineIndentColumn(ot.lineNumber)){const ut=nt.getLineMinColumn(ot.lineNumber),gt=nt.getLineContent(ot.lineNumber),pt=AtomicTabMoveOperations.atomicPosition(gt,ot.column-1,rt,0);if(pt!==-1&&pt+1>=ut)return new Position$1(ot.lineNumber,pt+1)}return this.leftPosition(nt,ot)}static left(nt,ot,rt){const ut=nt.stickyTabStops?MoveOperations.leftPositionAtomicSoftTabs(ot,rt,nt.tabSize):MoveOperations.leftPosition(ot,rt);return new CursorPosition(ut.lineNumber,ut.column,0)}static moveLeft(nt,ot,rt,ut,gt){let pt,mt;if(rt.hasSelection()&&!ut)pt=rt.selection.startLineNumber,mt=rt.selection.startColumn;else{const vt=rt.position.delta(void 0,-(gt-1)),St=ot.normalizePosition(MoveOperations.clipPositionColumn(vt,ot),0),yt=MoveOperations.left(nt,ot,St);pt=yt.lineNumber,mt=yt.column}return rt.move(ut,pt,mt,0)}static clipPositionColumn(nt,ot){return new Position$1(nt.lineNumber,MoveOperations.clipRange(nt.column,ot.getLineMinColumn(nt.lineNumber),ot.getLineMaxColumn(nt.lineNumber)))}static clipRange(nt,ot,rt){return nt<ot?ot:nt>rt?rt:nt}static rightPosition(nt,ot,rt){return rt<nt.getLineMaxColumn(ot)?rt=rt+nextCharLength(nt.getLineContent(ot),rt-1):ot<nt.getLineCount()&&(ot=ot+1,rt=nt.getLineMinColumn(ot)),new Position$1(ot,rt)}static rightPositionAtomicSoftTabs(nt,ot,rt,ut,gt){if(rt<nt.getLineIndentColumn(ot)){const pt=nt.getLineContent(ot),mt=AtomicTabMoveOperations.atomicPosition(pt,rt-1,ut,1);if(mt!==-1)return new Position$1(ot,mt+1)}return this.rightPosition(nt,ot,rt)}static right(nt,ot,rt){const ut=nt.stickyTabStops?MoveOperations.rightPositionAtomicSoftTabs(ot,rt.lineNumber,rt.column,nt.tabSize,nt.indentSize):MoveOperations.rightPosition(ot,rt.lineNumber,rt.column);return new CursorPosition(ut.lineNumber,ut.column,0)}static moveRight(nt,ot,rt,ut,gt){let pt,mt;if(rt.hasSelection()&&!ut)pt=rt.selection.endLineNumber,mt=rt.selection.endColumn;else{const vt=rt.position.delta(void 0,gt-1),St=ot.normalizePosition(MoveOperations.clipPositionColumn(vt,ot),1),yt=MoveOperations.right(nt,ot,St);pt=yt.lineNumber,mt=yt.column}return rt.move(ut,pt,mt,0)}static vertical(nt,ot,rt,ut,gt,pt,mt,vt){const St=CursorColumns.visibleColumnFromColumn(ot.getLineContent(rt),ut,nt.tabSize)+gt,yt=ot.getLineCount(),wt=rt===1&&ut===1,Lt=rt===yt&&ut===ot.getLineMaxColumn(rt),xt=pt<rt?wt:Lt;if(rt=pt,rt<1?(rt=1,mt?ut=ot.getLineMinColumn(rt):ut=Math.min(ot.getLineMaxColumn(rt),ut)):rt>yt?(rt=yt,mt?ut=ot.getLineMaxColumn(rt):ut=Math.min(ot.getLineMaxColumn(rt),ut)):ut=nt.columnFromVisibleColumn(ot,rt,St),xt?gt=0:gt=St-CursorColumns.visibleColumnFromColumn(ot.getLineContent(rt),ut,nt.tabSize),vt!==void 0){const It=new Position$1(rt,ut),kt=ot.normalizePosition(It,vt);gt=gt+(ut-kt.column),rt=kt.lineNumber,ut=kt.column}return new CursorPosition(rt,ut,gt)}static down(nt,ot,rt,ut,gt,pt,mt){return this.vertical(nt,ot,rt,ut,gt,rt+pt,mt,4)}static moveDown(nt,ot,rt,ut,gt){let pt,mt;rt.hasSelection()&&!ut?(pt=rt.selection.endLineNumber,mt=rt.selection.endColumn):(pt=rt.position.lineNumber,mt=rt.position.column);const vt=MoveOperations.down(nt,ot,pt,mt,rt.leftoverVisibleColumns,gt,!0);return rt.move(ut,vt.lineNumber,vt.column,vt.leftoverVisibleColumns)}static translateDown(nt,ot,rt){const ut=rt.selection,gt=MoveOperations.down(nt,ot,ut.selectionStartLineNumber,ut.selectionStartColumn,rt.selectionStartLeftoverVisibleColumns,1,!1),pt=MoveOperations.down(nt,ot,ut.positionLineNumber,ut.positionColumn,rt.leftoverVisibleColumns,1,!1);return new SingleCursorState(new Range$2(gt.lineNumber,gt.column,gt.lineNumber,gt.column),0,gt.leftoverVisibleColumns,new Position$1(pt.lineNumber,pt.column),pt.leftoverVisibleColumns)}static up(nt,ot,rt,ut,gt,pt,mt){return this.vertical(nt,ot,rt,ut,gt,rt-pt,mt,3)}static moveUp(nt,ot,rt,ut,gt){let pt,mt;rt.hasSelection()&&!ut?(pt=rt.selection.startLineNumber,mt=rt.selection.startColumn):(pt=rt.position.lineNumber,mt=rt.position.column);const vt=MoveOperations.up(nt,ot,pt,mt,rt.leftoverVisibleColumns,gt,!0);return rt.move(ut,vt.lineNumber,vt.column,vt.leftoverVisibleColumns)}static translateUp(nt,ot,rt){const ut=rt.selection,gt=MoveOperations.up(nt,ot,ut.selectionStartLineNumber,ut.selectionStartColumn,rt.selectionStartLeftoverVisibleColumns,1,!1),pt=MoveOperations.up(nt,ot,ut.positionLineNumber,ut.positionColumn,rt.leftoverVisibleColumns,1,!1);return new SingleCursorState(new Range$2(gt.lineNumber,gt.column,gt.lineNumber,gt.column),0,gt.leftoverVisibleColumns,new Position$1(pt.lineNumber,pt.column),pt.leftoverVisibleColumns)}static _isBlankLine(nt,ot){return nt.getLineFirstNonWhitespaceColumn(ot)===0}static moveToPrevBlankLine(nt,ot,rt,ut){let gt=rt.position.lineNumber;for(;gt>1&&this._isBlankLine(ot,gt);)gt--;for(;gt>1&&!this._isBlankLine(ot,gt);)gt--;return rt.move(ut,gt,ot.getLineMinColumn(gt),0)}static moveToNextBlankLine(nt,ot,rt,ut){const gt=ot.getLineCount();let pt=rt.position.lineNumber;for(;pt<gt&&this._isBlankLine(ot,pt);)pt++;for(;pt<gt&&!this._isBlankLine(ot,pt);)pt++;return rt.move(ut,pt,ot.getLineMinColumn(pt),0)}static moveToBeginningOfLine(nt,ot,rt,ut){const gt=rt.position.lineNumber,pt=ot.getLineMinColumn(gt),mt=ot.getLineFirstNonWhitespaceColumn(gt)||pt;let vt;return rt.position.column===mt?vt=pt:vt=mt,rt.move(ut,gt,vt,0)}static moveToEndOfLine(nt,ot,rt,ut,gt){const pt=rt.position.lineNumber,mt=ot.getLineMaxColumn(pt);return rt.move(ut,pt,mt,gt?1073741824-mt:0)}static moveToBeginningOfBuffer(nt,ot,rt,ut){return rt.move(ut,1,1,0)}static moveToEndOfBuffer(nt,ot,rt,ut){const gt=ot.getLineCount(),pt=ot.getLineMaxColumn(gt);return rt.move(ut,gt,pt,0)}}class DeleteOperations{static deleteRight(nt,ot,rt,ut){const gt=[];let pt=nt!==3;for(let mt=0,vt=ut.length;mt<vt;mt++){const St=ut[mt];let yt=St;if(yt.isEmpty()){const wt=St.getPosition(),Lt=MoveOperations.right(ot,rt,wt);yt=new Range$2(Lt.lineNumber,Lt.column,wt.lineNumber,wt.column)}if(yt.isEmpty()){gt[mt]=null;continue}yt.startLineNumber!==yt.endLineNumber&&(pt=!0),gt[mt]=new ReplaceCommand(yt,"")}return[pt,gt]}static isAutoClosingPairDelete(nt,ot,rt,ut,gt,pt,mt){if(ot==="never"&&rt==="never"||nt==="never")return!1;for(let vt=0,St=pt.length;vt<St;vt++){const yt=pt[vt],wt=yt.getPosition();if(!yt.isEmpty())return!1;const Lt=gt.getLineContent(wt.lineNumber);if(wt.column<2||wt.column>=Lt.length+1)return!1;const xt=Lt.charAt(wt.column-2),It=ut.get(xt);if(!It)return!1;if(isQuote(xt)){if(rt==="never")return!1}else if(ot==="never")return!1;const kt=Lt.charAt(wt.column-1);let At=!1;for(const Tt of It)Tt.open===xt&&Tt.close===kt&&(At=!0);if(!At)return!1;if(nt==="auto"){let Tt=!1;for(let Rt=0,Nt=mt.length;Rt<Nt;Rt++){const Pt=mt[Rt];if(wt.lineNumber===Pt.startLineNumber&&wt.column===Pt.startColumn){Tt=!0;break}}if(!Tt)return!1}}return!0}static _runAutoClosingPairDelete(nt,ot,rt){const ut=[];for(let gt=0,pt=rt.length;gt<pt;gt++){const mt=rt[gt].getPosition(),vt=new Range$2(mt.lineNumber,mt.column-1,mt.lineNumber,mt.column+1);ut[gt]=new ReplaceCommand(vt,"")}return[!0,ut]}static deleteLeft(nt,ot,rt,ut,gt){if(this.isAutoClosingPairDelete(ot.autoClosingDelete,ot.autoClosingBrackets,ot.autoClosingQuotes,ot.autoClosingPairs.autoClosingPairsOpenByEnd,rt,ut,gt))return this._runAutoClosingPairDelete(ot,rt,ut);const pt=[];let mt=nt!==2;for(let vt=0,St=ut.length;vt<St;vt++){const yt=DeleteOperations.getDeleteRange(ut[vt],rt,ot);if(yt.isEmpty()){pt[vt]=null;continue}yt.startLineNumber!==yt.endLineNumber&&(mt=!0),pt[vt]=new ReplaceCommand(yt,"")}return[mt,pt]}static getDeleteRange(nt,ot,rt){if(!nt.isEmpty())return nt;const ut=nt.getPosition();if(rt.useTabStops&&ut.column>1){const gt=ot.getLineContent(ut.lineNumber),pt=firstNonWhitespaceIndex(gt),mt=pt===-1?gt.length+1:pt+1;if(ut.column<=mt){const vt=rt.visibleColumnFromColumn(ot,ut),St=CursorColumns.prevIndentTabStop(vt,rt.indentSize),yt=rt.columnFromVisibleColumn(ot,ut.lineNumber,St);return new Range$2(ut.lineNumber,yt,ut.lineNumber,ut.column)}}return Range$2.fromPositions(DeleteOperations.getPositionAfterDeleteLeft(ut,ot),ut)}static getPositionAfterDeleteLeft(nt,ot){if(nt.column>1){const rt=getLeftDeleteOffset(nt.column-1,ot.getLineContent(nt.lineNumber));return nt.with(void 0,rt+1)}else if(nt.lineNumber>1){const rt=nt.lineNumber-1;return new Position$1(rt,ot.getLineMaxColumn(rt))}else return nt}static cut(nt,ot,rt){const ut=[];let gt=null;rt.sort((pt,mt)=>Position$1.compare(pt.getStartPosition(),mt.getEndPosition()));for(let pt=0,mt=rt.length;pt<mt;pt++){const vt=rt[pt];if(vt.isEmpty())if(nt.emptySelectionClipboard){const St=vt.getPosition();let yt,wt,Lt,xt;St.lineNumber<ot.getLineCount()?(yt=St.lineNumber,wt=1,Lt=St.lineNumber+1,xt=1):St.lineNumber>1&&(gt==null?void 0:gt.endLineNumber)!==St.lineNumber?(yt=St.lineNumber-1,wt=ot.getLineMaxColumn(St.lineNumber-1),Lt=St.lineNumber,xt=ot.getLineMaxColumn(St.lineNumber)):(yt=St.lineNumber,wt=1,Lt=St.lineNumber,xt=ot.getLineMaxColumn(St.lineNumber));const It=new Range$2(yt,wt,Lt,xt);gt=It,It.isEmpty()?ut[pt]=null:ut[pt]=new ReplaceCommand(It,"")}else ut[pt]=null;else ut[pt]=new ReplaceCommand(vt,"")}return new EditOperationResult(0,ut,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class WordOperations{static _createWord(nt,ot,rt,ut,gt){return{start:ut,end:gt,wordType:ot,nextCharClass:rt}}static _findPreviousWordOnLine(nt,ot,rt){const ut=ot.getLineContent(rt.lineNumber);return this._doFindPreviousWordOnLine(ut,nt,rt)}static _doFindPreviousWordOnLine(nt,ot,rt){let ut=0;for(let gt=rt.column-2;gt>=0;gt--){const pt=nt.charCodeAt(gt),mt=ot.get(pt);if(mt===0){if(ut===2)return this._createWord(nt,ut,mt,gt+1,this._findEndOfWord(nt,ot,ut,gt+1));ut=1}else if(mt===2){if(ut===1)return this._createWord(nt,ut,mt,gt+1,this._findEndOfWord(nt,ot,ut,gt+1));ut=2}else if(mt===1&&ut!==0)return this._createWord(nt,ut,mt,gt+1,this._findEndOfWord(nt,ot,ut,gt+1))}return ut!==0?this._createWord(nt,ut,1,0,this._findEndOfWord(nt,ot,ut,0)):null}static _findEndOfWord(nt,ot,rt,ut){const gt=nt.length;for(let pt=ut;pt<gt;pt++){const mt=nt.charCodeAt(pt),vt=ot.get(mt);if(vt===1||rt===1&&vt===2||rt===2&&vt===0)return pt}return gt}static _findNextWordOnLine(nt,ot,rt){const ut=ot.getLineContent(rt.lineNumber);return this._doFindNextWordOnLine(ut,nt,rt)}static _doFindNextWordOnLine(nt,ot,rt){let ut=0;const gt=nt.length;for(let pt=rt.column-1;pt<gt;pt++){const mt=nt.charCodeAt(pt),vt=ot.get(mt);if(vt===0){if(ut===2)return this._createWord(nt,ut,vt,this._findStartOfWord(nt,ot,ut,pt-1),pt);ut=1}else if(vt===2){if(ut===1)return this._createWord(nt,ut,vt,this._findStartOfWord(nt,ot,ut,pt-1),pt);ut=2}else if(vt===1&&ut!==0)return this._createWord(nt,ut,vt,this._findStartOfWord(nt,ot,ut,pt-1),pt)}return ut!==0?this._createWord(nt,ut,1,this._findStartOfWord(nt,ot,ut,gt-1),gt):null}static _findStartOfWord(nt,ot,rt,ut){for(let gt=ut;gt>=0;gt--){const pt=nt.charCodeAt(gt),mt=ot.get(pt);if(mt===1||rt===1&&mt===2||rt===2&&mt===0)return gt+1}return 0}static moveWordLeft(nt,ot,rt,ut){let gt=rt.lineNumber,pt=rt.column;pt===1&&gt>1&&(gt=gt-1,pt=ot.getLineMaxColumn(gt));let mt=WordOperations._findPreviousWordOnLine(nt,ot,new Position$1(gt,pt));if(ut===0)return new Position$1(gt,mt?mt.start+1:1);if(ut===1)return mt&&mt.wordType===2&&mt.end-mt.start===1&&mt.nextCharClass===0&&(mt=WordOperations._findPreviousWordOnLine(nt,ot,new Position$1(gt,mt.start+1))),new Position$1(gt,mt?mt.start+1:1);if(ut===3){for(;mt&&mt.wordType===2;)mt=WordOperations._findPreviousWordOnLine(nt,ot,new Position$1(gt,mt.start+1));return new Position$1(gt,mt?mt.start+1:1)}return mt&&pt<=mt.end+1&&(mt=WordOperations._findPreviousWordOnLine(nt,ot,new Position$1(gt,mt.start+1))),new Position$1(gt,mt?mt.end+1:1)}static _moveWordPartLeft(nt,ot){const rt=ot.lineNumber,ut=nt.getLineMaxColumn(rt);if(ot.column===1)return rt>1?new Position$1(rt-1,nt.getLineMaxColumn(rt-1)):ot;const gt=nt.getLineContent(rt);for(let pt=ot.column-1;pt>1;pt--){const mt=gt.charCodeAt(pt-2),vt=gt.charCodeAt(pt-1);if(mt===95&&vt!==95)return new Position$1(rt,pt);if(mt===45&&vt!==45)return new Position$1(rt,pt);if((isLowerAsciiLetter(mt)||isAsciiDigit(mt))&&isUpperAsciiLetter(vt))return new Position$1(rt,pt);if(isUpperAsciiLetter(mt)&&isUpperAsciiLetter(vt)&&pt+1<ut){const St=gt.charCodeAt(pt);if(isLowerAsciiLetter(St)||isAsciiDigit(St))return new Position$1(rt,pt)}}return new Position$1(rt,1)}static moveWordRight(nt,ot,rt,ut){let gt=rt.lineNumber,pt=rt.column,mt=!1;pt===ot.getLineMaxColumn(gt)&&gt<ot.getLineCount()&&(mt=!0,gt=gt+1,pt=1);let vt=WordOperations._findNextWordOnLine(nt,ot,new Position$1(gt,pt));if(ut===2)vt&&vt.wordType===2&&vt.end-vt.start===1&&vt.nextCharClass===0&&(vt=WordOperations._findNextWordOnLine(nt,ot,new Position$1(gt,vt.end+1))),vt?pt=vt.end+1:pt=ot.getLineMaxColumn(gt);else if(ut===3){for(mt&&(pt=0);vt&&(vt.wordType===2||vt.start+1<=pt);)vt=WordOperations._findNextWordOnLine(nt,ot,new Position$1(gt,vt.end+1));vt?pt=vt.start+1:pt=ot.getLineMaxColumn(gt)}else vt&&!mt&&pt>=vt.start+1&&(vt=WordOperations._findNextWordOnLine(nt,ot,new Position$1(gt,vt.end+1))),vt?pt=vt.start+1:pt=ot.getLineMaxColumn(gt);return new Position$1(gt,pt)}static _moveWordPartRight(nt,ot){const rt=ot.lineNumber,ut=nt.getLineMaxColumn(rt);if(ot.column===ut)return rt<nt.getLineCount()?new Position$1(rt+1,1):ot;const gt=nt.getLineContent(rt);for(let pt=ot.column+1;pt<ut;pt++){const mt=gt.charCodeAt(pt-2),vt=gt.charCodeAt(pt-1);if(mt!==95&&vt===95)return new Position$1(rt,pt);if(mt!==45&&vt===45)return new Position$1(rt,pt);if((isLowerAsciiLetter(mt)||isAsciiDigit(mt))&&isUpperAsciiLetter(vt))return new Position$1(rt,pt);if(isUpperAsciiLetter(mt)&&isUpperAsciiLetter(vt)&&pt+1<ut){const St=gt.charCodeAt(pt);if(isLowerAsciiLetter(St)||isAsciiDigit(St))return new Position$1(rt,pt)}}return new Position$1(rt,ut)}static _deleteWordLeftWhitespace(nt,ot){const rt=nt.getLineContent(ot.lineNumber),ut=ot.column-2,gt=lastNonWhitespaceIndex(rt,ut);return gt+1<ut?new Range$2(ot.lineNumber,gt+2,ot.lineNumber,ot.column):null}static deleteWordLeft(nt,ot){const rt=nt.wordSeparators,ut=nt.model,gt=nt.selection,pt=nt.whitespaceHeuristics;if(!gt.isEmpty())return gt;if(DeleteOperations.isAutoClosingPairDelete(nt.autoClosingDelete,nt.autoClosingBrackets,nt.autoClosingQuotes,nt.autoClosingPairs.autoClosingPairsOpenByEnd,nt.model,[nt.selection],nt.autoClosedCharacters)){const wt=nt.selection.getPosition();return new Range$2(wt.lineNumber,wt.column-1,wt.lineNumber,wt.column+1)}const mt=new Position$1(gt.positionLineNumber,gt.positionColumn);let vt=mt.lineNumber,St=mt.column;if(vt===1&&St===1)return null;if(pt){const wt=this._deleteWordLeftWhitespace(ut,mt);if(wt)return wt}let yt=WordOperations._findPreviousWordOnLine(rt,ut,mt);return ot===0?yt?St=yt.start+1:St>1?St=1:(vt--,St=ut.getLineMaxColumn(vt)):(yt&&St<=yt.end+1&&(yt=WordOperations._findPreviousWordOnLine(rt,ut,new Position$1(vt,yt.start+1))),yt?St=yt.end+1:St>1?St=1:(vt--,St=ut.getLineMaxColumn(vt))),new Range$2(vt,St,mt.lineNumber,mt.column)}static deleteInsideWord(nt,ot,rt){if(!rt.isEmpty())return rt;const ut=new Position$1(rt.positionLineNumber,rt.positionColumn),gt=this._deleteInsideWordWhitespace(ot,ut);return gt||this._deleteInsideWordDetermineDeleteRange(nt,ot,ut)}static _charAtIsWhitespace(nt,ot){const rt=nt.charCodeAt(ot);return rt===32||rt===9}static _deleteInsideWordWhitespace(nt,ot){const rt=nt.getLineContent(ot.lineNumber),ut=rt.length;if(ut===0)return null;let gt=Math.max(ot.column-2,0);if(!this._charAtIsWhitespace(rt,gt))return null;let pt=Math.min(ot.column-1,ut-1);if(!this._charAtIsWhitespace(rt,pt))return null;for(;gt>0&&this._charAtIsWhitespace(rt,gt-1);)gt--;for(;pt+1<ut&&this._charAtIsWhitespace(rt,pt+1);)pt++;return new Range$2(ot.lineNumber,gt+1,ot.lineNumber,pt+2)}static _deleteInsideWordDetermineDeleteRange(nt,ot,rt){const ut=ot.getLineContent(rt.lineNumber),gt=ut.length;if(gt===0)return rt.lineNumber>1?new Range$2(rt.lineNumber-1,ot.getLineMaxColumn(rt.lineNumber-1),rt.lineNumber,1):rt.lineNumber<ot.getLineCount()?new Range$2(rt.lineNumber,1,rt.lineNumber+1,1):new Range$2(rt.lineNumber,1,rt.lineNumber,1);const pt=wt=>wt.start+1<=rt.column&&rt.column<=wt.end+1,mt=(wt,Lt)=>(wt=Math.min(wt,rt.column),Lt=Math.max(Lt,rt.column),new Range$2(rt.lineNumber,wt,rt.lineNumber,Lt)),vt=wt=>{let Lt=wt.start+1,xt=wt.end+1,It=!1;for(;xt-1<gt&&this._charAtIsWhitespace(ut,xt-1);)It=!0,xt++;if(!It)for(;Lt>1&&this._charAtIsWhitespace(ut,Lt-2);)Lt--;return mt(Lt,xt)},St=WordOperations._findPreviousWordOnLine(nt,ot,rt);if(St&&pt(St))return vt(St);const yt=WordOperations._findNextWordOnLine(nt,ot,rt);return yt&&pt(yt)?vt(yt):St&&yt?mt(St.end+1,yt.start+1):St?mt(St.start+1,St.end+1):yt?mt(yt.start+1,yt.end+1):mt(1,gt+1)}static _deleteWordPartLeft(nt,ot){if(!ot.isEmpty())return ot;const rt=ot.getPosition(),ut=WordOperations._moveWordPartLeft(nt,rt);return new Range$2(rt.lineNumber,rt.column,ut.lineNumber,ut.column)}static _findFirstNonWhitespaceChar(nt,ot){const rt=nt.length;for(let ut=ot;ut<rt;ut++){const gt=nt.charAt(ut);if(gt!==" "&&gt!=="	")return ut}return rt}static _deleteWordRightWhitespace(nt,ot){const rt=nt.getLineContent(ot.lineNumber),ut=ot.column-1,gt=this._findFirstNonWhitespaceChar(rt,ut);return ut+1<gt?new Range$2(ot.lineNumber,ot.column,ot.lineNumber,gt+1):null}static deleteWordRight(nt,ot){const rt=nt.wordSeparators,ut=nt.model,gt=nt.selection,pt=nt.whitespaceHeuristics;if(!gt.isEmpty())return gt;const mt=new Position$1(gt.positionLineNumber,gt.positionColumn);let vt=mt.lineNumber,St=mt.column;const yt=ut.getLineCount(),wt=ut.getLineMaxColumn(vt);if(vt===yt&&St===wt)return null;if(pt){const xt=this._deleteWordRightWhitespace(ut,mt);if(xt)return xt}let Lt=WordOperations._findNextWordOnLine(rt,ut,mt);return ot===2?Lt?St=Lt.end+1:St<wt||vt===yt?St=wt:(vt++,Lt=WordOperations._findNextWordOnLine(rt,ut,new Position$1(vt,1)),Lt?St=Lt.start+1:St=ut.getLineMaxColumn(vt)):(Lt&&St>=Lt.start+1&&(Lt=WordOperations._findNextWordOnLine(rt,ut,new Position$1(vt,Lt.end+1))),Lt?St=Lt.start+1:St<wt||vt===yt?St=wt:(vt++,Lt=WordOperations._findNextWordOnLine(rt,ut,new Position$1(vt,1)),Lt?St=Lt.start+1:St=ut.getLineMaxColumn(vt))),new Range$2(vt,St,mt.lineNumber,mt.column)}static _deleteWordPartRight(nt,ot){if(!ot.isEmpty())return ot;const rt=ot.getPosition(),ut=WordOperations._moveWordPartRight(nt,rt);return new Range$2(rt.lineNumber,rt.column,ut.lineNumber,ut.column)}static _createWordAtPosition(nt,ot,rt){const ut=new Range$2(ot,rt.start+1,ot,rt.end+1);return{word:nt.getValueInRange(ut),startColumn:ut.startColumn,endColumn:ut.endColumn}}static getWordAtPosition(nt,ot,rt){const ut=getMapForWordSeparators(ot),gt=WordOperations._findPreviousWordOnLine(ut,nt,rt);if(gt&&gt.wordType===1&&gt.start<=rt.column-1&&rt.column-1<=gt.end)return WordOperations._createWordAtPosition(nt,rt.lineNumber,gt);const pt=WordOperations._findNextWordOnLine(ut,nt,rt);return pt&&pt.wordType===1&&pt.start<=rt.column-1&&rt.column-1<=pt.end?WordOperations._createWordAtPosition(nt,rt.lineNumber,pt):null}static word(nt,ot,rt,ut,gt){const pt=getMapForWordSeparators(nt.wordSeparators),mt=WordOperations._findPreviousWordOnLine(pt,ot,gt),vt=WordOperations._findNextWordOnLine(pt,ot,gt);if(!ut){let xt,It;return mt&&mt.wordType===1&&mt.start<=gt.column-1&&gt.column-1<=mt.end?(xt=mt.start+1,It=mt.end+1):vt&&vt.wordType===1&&vt.start<=gt.column-1&&gt.column-1<=vt.end?(xt=vt.start+1,It=vt.end+1):(mt?xt=mt.end+1:xt=1,vt?It=vt.start+1:It=ot.getLineMaxColumn(gt.lineNumber)),new SingleCursorState(new Range$2(gt.lineNumber,xt,gt.lineNumber,It),1,0,new Position$1(gt.lineNumber,It),0)}let St,yt;mt&&mt.wordType===1&&mt.start<gt.column-1&&gt.column-1<mt.end?(St=mt.start+1,yt=mt.end+1):vt&&vt.wordType===1&&vt.start<gt.column-1&&gt.column-1<vt.end?(St=vt.start+1,yt=vt.end+1):(St=gt.column,yt=gt.column);const wt=gt.lineNumber;let Lt;if(rt.selectionStart.containsPosition(gt))Lt=rt.selectionStart.endColumn;else if(gt.isBeforeOrEqual(rt.selectionStart.getStartPosition())){Lt=St;const xt=new Position$1(wt,Lt);rt.selectionStart.containsPosition(xt)&&(Lt=rt.selectionStart.endColumn)}else{Lt=yt;const xt=new Position$1(wt,Lt);rt.selectionStart.containsPosition(xt)&&(Lt=rt.selectionStart.startColumn)}return rt.move(!0,wt,Lt,0)}}class WordPartOperations extends WordOperations{static deleteWordPartLeft(nt){const ot=enforceDefined([WordOperations.deleteWordLeft(nt,0),WordOperations.deleteWordLeft(nt,2),WordOperations._deleteWordPartLeft(nt.model,nt.selection)]);return ot.sort(Range$2.compareRangesUsingEnds),ot[2]}static deleteWordPartRight(nt){const ot=enforceDefined([WordOperations.deleteWordRight(nt,0),WordOperations.deleteWordRight(nt,2),WordOperations._deleteWordPartRight(nt.model,nt.selection)]);return ot.sort(Range$2.compareRangesUsingStarts),ot[0]}static moveWordPartLeft(nt,ot,rt){const ut=enforceDefined([WordOperations.moveWordLeft(nt,ot,rt,0),WordOperations.moveWordLeft(nt,ot,rt,2),WordOperations._moveWordPartLeft(ot,rt)]);return ut.sort(Position$1.compare),ut[2]}static moveWordPartRight(nt,ot,rt){const ut=enforceDefined([WordOperations.moveWordRight(nt,ot,rt,0),WordOperations.moveWordRight(nt,ot,rt,2),WordOperations._moveWordPartRight(ot,rt)]);return ut.sort(Position$1.compare),ut[0]}}function enforceDefined(ct){return ct.filter(nt=>!!nt)}class CursorMoveCommands{static addCursorDown(nt,ot,rt){const ut=[];let gt=0;for(let pt=0,mt=ot.length;pt<mt;pt++){const vt=ot[pt];ut[gt++]=new CursorState$1(vt.modelState,vt.viewState),rt?ut[gt++]=CursorState$1.fromModelState(MoveOperations.translateDown(nt.cursorConfig,nt.model,vt.modelState)):ut[gt++]=CursorState$1.fromViewState(MoveOperations.translateDown(nt.cursorConfig,nt,vt.viewState))}return ut}static addCursorUp(nt,ot,rt){const ut=[];let gt=0;for(let pt=0,mt=ot.length;pt<mt;pt++){const vt=ot[pt];ut[gt++]=new CursorState$1(vt.modelState,vt.viewState),rt?ut[gt++]=CursorState$1.fromModelState(MoveOperations.translateUp(nt.cursorConfig,nt.model,vt.modelState)):ut[gt++]=CursorState$1.fromViewState(MoveOperations.translateUp(nt.cursorConfig,nt,vt.viewState))}return ut}static moveToBeginningOfLine(nt,ot,rt){const ut=[];for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt];ut[gt]=this._moveToLineStart(nt,mt,rt)}return ut}static _moveToLineStart(nt,ot,rt){const ut=ot.viewState.position.column,gt=ot.modelState.position.column,pt=ut===gt,mt=ot.viewState.position.lineNumber,vt=nt.getLineFirstNonWhitespaceColumn(mt);return!pt&&!(ut===vt)?this._moveToLineStartByView(nt,ot,rt):this._moveToLineStartByModel(nt,ot,rt)}static _moveToLineStartByView(nt,ot,rt){return CursorState$1.fromViewState(MoveOperations.moveToBeginningOfLine(nt.cursorConfig,nt,ot.viewState,rt))}static _moveToLineStartByModel(nt,ot,rt){return CursorState$1.fromModelState(MoveOperations.moveToBeginningOfLine(nt.cursorConfig,nt.model,ot.modelState,rt))}static moveToEndOfLine(nt,ot,rt,ut){const gt=[];for(let pt=0,mt=ot.length;pt<mt;pt++){const vt=ot[pt];gt[pt]=this._moveToLineEnd(nt,vt,rt,ut)}return gt}static _moveToLineEnd(nt,ot,rt,ut){const gt=ot.viewState.position,pt=nt.getLineMaxColumn(gt.lineNumber),mt=gt.column===pt,vt=ot.modelState.position,St=nt.model.getLineMaxColumn(vt.lineNumber),yt=pt-gt.column===St-vt.column;return mt||yt?this._moveToLineEndByModel(nt,ot,rt,ut):this._moveToLineEndByView(nt,ot,rt,ut)}static _moveToLineEndByView(nt,ot,rt,ut){return CursorState$1.fromViewState(MoveOperations.moveToEndOfLine(nt.cursorConfig,nt,ot.viewState,rt,ut))}static _moveToLineEndByModel(nt,ot,rt,ut){return CursorState$1.fromModelState(MoveOperations.moveToEndOfLine(nt.cursorConfig,nt.model,ot.modelState,rt,ut))}static expandLineSelection(nt,ot){const rt=[];for(let ut=0,gt=ot.length;ut<gt;ut++){const pt=ot[ut],mt=pt.modelState.selection.startLineNumber,vt=nt.model.getLineCount();let St=pt.modelState.selection.endLineNumber,yt;St===vt?yt=nt.model.getLineMaxColumn(vt):(St++,yt=1),rt[ut]=CursorState$1.fromModelState(new SingleCursorState(new Range$2(mt,1,mt,1),0,0,new Position$1(St,yt),0))}return rt}static moveToBeginningOfBuffer(nt,ot,rt){const ut=[];for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt];ut[gt]=CursorState$1.fromModelState(MoveOperations.moveToBeginningOfBuffer(nt.cursorConfig,nt.model,mt.modelState,rt))}return ut}static moveToEndOfBuffer(nt,ot,rt){const ut=[];for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt];ut[gt]=CursorState$1.fromModelState(MoveOperations.moveToEndOfBuffer(nt.cursorConfig,nt.model,mt.modelState,rt))}return ut}static selectAll(nt,ot){const rt=nt.model.getLineCount(),ut=nt.model.getLineMaxColumn(rt);return CursorState$1.fromModelState(new SingleCursorState(new Range$2(1,1,1,1),0,0,new Position$1(rt,ut),0))}static line(nt,ot,rt,ut,gt){const pt=nt.model.validatePosition(ut),mt=gt?nt.coordinatesConverter.validateViewPosition(new Position$1(gt.lineNumber,gt.column),pt):nt.coordinatesConverter.convertModelPositionToViewPosition(pt);if(!rt){const St=nt.model.getLineCount();let yt=pt.lineNumber+1,wt=1;return yt>St&&(yt=St,wt=nt.model.getLineMaxColumn(yt)),CursorState$1.fromModelState(new SingleCursorState(new Range$2(pt.lineNumber,1,yt,wt),2,0,new Position$1(yt,wt),0))}const vt=ot.modelState.selectionStart.getStartPosition().lineNumber;if(pt.lineNumber<vt)return CursorState$1.fromViewState(ot.viewState.move(!0,mt.lineNumber,1,0));if(pt.lineNumber>vt){const St=nt.getLineCount();let yt=mt.lineNumber+1,wt=1;return yt>St&&(yt=St,wt=nt.getLineMaxColumn(yt)),CursorState$1.fromViewState(ot.viewState.move(!0,yt,wt,0))}else{const St=ot.modelState.selectionStart.getEndPosition();return CursorState$1.fromModelState(ot.modelState.move(!0,St.lineNumber,St.column,0))}}static word(nt,ot,rt,ut){const gt=nt.model.validatePosition(ut);return CursorState$1.fromModelState(WordOperations.word(nt.cursorConfig,nt.model,ot.modelState,rt,gt))}static cancelSelection(nt,ot){if(!ot.modelState.hasSelection())return new CursorState$1(ot.modelState,ot.viewState);const rt=ot.viewState.position.lineNumber,ut=ot.viewState.position.column;return CursorState$1.fromViewState(new SingleCursorState(new Range$2(rt,ut,rt,ut),0,0,new Position$1(rt,ut),0))}static moveTo(nt,ot,rt,ut,gt){if(rt){if(ot.modelState.selectionStartKind===1)return this.word(nt,ot,rt,ut);if(ot.modelState.selectionStartKind===2)return this.line(nt,ot,rt,ut,gt)}const pt=nt.model.validatePosition(ut),mt=gt?nt.coordinatesConverter.validateViewPosition(new Position$1(gt.lineNumber,gt.column),pt):nt.coordinatesConverter.convertModelPositionToViewPosition(pt);return CursorState$1.fromViewState(ot.viewState.move(rt,mt.lineNumber,mt.column,0))}static simpleMove(nt,ot,rt,ut,gt,pt){switch(rt){case 0:return pt===4?this._moveHalfLineLeft(nt,ot,ut):this._moveLeft(nt,ot,ut,gt);case 1:return pt===4?this._moveHalfLineRight(nt,ot,ut):this._moveRight(nt,ot,ut,gt);case 2:return pt===2?this._moveUpByViewLines(nt,ot,ut,gt):this._moveUpByModelLines(nt,ot,ut,gt);case 3:return pt===2?this._moveDownByViewLines(nt,ot,ut,gt):this._moveDownByModelLines(nt,ot,ut,gt);case 4:return pt===2?ot.map(mt=>CursorState$1.fromViewState(MoveOperations.moveToPrevBlankLine(nt.cursorConfig,nt,mt.viewState,ut))):ot.map(mt=>CursorState$1.fromModelState(MoveOperations.moveToPrevBlankLine(nt.cursorConfig,nt.model,mt.modelState,ut)));case 5:return pt===2?ot.map(mt=>CursorState$1.fromViewState(MoveOperations.moveToNextBlankLine(nt.cursorConfig,nt,mt.viewState,ut))):ot.map(mt=>CursorState$1.fromModelState(MoveOperations.moveToNextBlankLine(nt.cursorConfig,nt.model,mt.modelState,ut)));case 6:return this._moveToViewMinColumn(nt,ot,ut);case 7:return this._moveToViewFirstNonWhitespaceColumn(nt,ot,ut);case 8:return this._moveToViewCenterColumn(nt,ot,ut);case 9:return this._moveToViewMaxColumn(nt,ot,ut);case 10:return this._moveToViewLastNonWhitespaceColumn(nt,ot,ut);default:return null}}static viewportMove(nt,ot,rt,ut,gt){const pt=nt.getCompletelyVisibleViewRange(),mt=nt.coordinatesConverter.convertViewRangeToModelRange(pt);switch(rt){case 11:{const vt=this._firstLineNumberInRange(nt.model,mt,gt),St=nt.model.getLineFirstNonWhitespaceColumn(vt);return[this._moveToModelPosition(nt,ot[0],ut,vt,St)]}case 13:{const vt=this._lastLineNumberInRange(nt.model,mt,gt),St=nt.model.getLineFirstNonWhitespaceColumn(vt);return[this._moveToModelPosition(nt,ot[0],ut,vt,St)]}case 12:{const vt=Math.round((mt.startLineNumber+mt.endLineNumber)/2),St=nt.model.getLineFirstNonWhitespaceColumn(vt);return[this._moveToModelPosition(nt,ot[0],ut,vt,St)]}case 14:{const vt=[];for(let St=0,yt=ot.length;St<yt;St++){const wt=ot[St];vt[St]=this.findPositionInViewportIfOutside(nt,wt,pt,ut)}return vt}default:return null}}static findPositionInViewportIfOutside(nt,ot,rt,ut){const gt=ot.viewState.position.lineNumber;if(rt.startLineNumber<=gt&&gt<=rt.endLineNumber-1)return new CursorState$1(ot.modelState,ot.viewState);{let pt;gt>rt.endLineNumber-1?pt=rt.endLineNumber-1:gt<rt.startLineNumber?pt=rt.startLineNumber:pt=gt;const mt=MoveOperations.vertical(nt.cursorConfig,nt,gt,ot.viewState.position.column,ot.viewState.leftoverVisibleColumns,pt,!1);return CursorState$1.fromViewState(ot.viewState.move(ut,mt.lineNumber,mt.column,mt.leftoverVisibleColumns))}}static _firstLineNumberInRange(nt,ot,rt){let ut=ot.startLineNumber;return ot.startColumn!==nt.getLineMinColumn(ut)&&ut++,Math.min(ot.endLineNumber,ut+rt-1)}static _lastLineNumberInRange(nt,ot,rt){let ut=ot.startLineNumber;return ot.startColumn!==nt.getLineMinColumn(ut)&&ut++,Math.max(ut,ot.endLineNumber-rt+1)}static _moveLeft(nt,ot,rt,ut){return ot.map(gt=>CursorState$1.fromViewState(MoveOperations.moveLeft(nt.cursorConfig,nt,gt.viewState,rt,ut)))}static _moveHalfLineLeft(nt,ot,rt){const ut=[];for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt],vt=mt.viewState.position.lineNumber,St=Math.round(nt.getLineContent(vt).length/2);ut[gt]=CursorState$1.fromViewState(MoveOperations.moveLeft(nt.cursorConfig,nt,mt.viewState,rt,St))}return ut}static _moveRight(nt,ot,rt,ut){return ot.map(gt=>CursorState$1.fromViewState(MoveOperations.moveRight(nt.cursorConfig,nt,gt.viewState,rt,ut)))}static _moveHalfLineRight(nt,ot,rt){const ut=[];for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt],vt=mt.viewState.position.lineNumber,St=Math.round(nt.getLineContent(vt).length/2);ut[gt]=CursorState$1.fromViewState(MoveOperations.moveRight(nt.cursorConfig,nt,mt.viewState,rt,St))}return ut}static _moveDownByViewLines(nt,ot,rt,ut){const gt=[];for(let pt=0,mt=ot.length;pt<mt;pt++){const vt=ot[pt];gt[pt]=CursorState$1.fromViewState(MoveOperations.moveDown(nt.cursorConfig,nt,vt.viewState,rt,ut))}return gt}static _moveDownByModelLines(nt,ot,rt,ut){const gt=[];for(let pt=0,mt=ot.length;pt<mt;pt++){const vt=ot[pt];gt[pt]=CursorState$1.fromModelState(MoveOperations.moveDown(nt.cursorConfig,nt.model,vt.modelState,rt,ut))}return gt}static _moveUpByViewLines(nt,ot,rt,ut){const gt=[];for(let pt=0,mt=ot.length;pt<mt;pt++){const vt=ot[pt];gt[pt]=CursorState$1.fromViewState(MoveOperations.moveUp(nt.cursorConfig,nt,vt.viewState,rt,ut))}return gt}static _moveUpByModelLines(nt,ot,rt,ut){const gt=[];for(let pt=0,mt=ot.length;pt<mt;pt++){const vt=ot[pt];gt[pt]=CursorState$1.fromModelState(MoveOperations.moveUp(nt.cursorConfig,nt.model,vt.modelState,rt,ut))}return gt}static _moveToViewPosition(nt,ot,rt,ut,gt){return CursorState$1.fromViewState(ot.viewState.move(rt,ut,gt,0))}static _moveToModelPosition(nt,ot,rt,ut,gt){return CursorState$1.fromModelState(ot.modelState.move(rt,ut,gt,0))}static _moveToViewMinColumn(nt,ot,rt){const ut=[];for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt],vt=mt.viewState.position.lineNumber,St=nt.getLineMinColumn(vt);ut[gt]=this._moveToViewPosition(nt,mt,rt,vt,St)}return ut}static _moveToViewFirstNonWhitespaceColumn(nt,ot,rt){const ut=[];for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt],vt=mt.viewState.position.lineNumber,St=nt.getLineFirstNonWhitespaceColumn(vt);ut[gt]=this._moveToViewPosition(nt,mt,rt,vt,St)}return ut}static _moveToViewCenterColumn(nt,ot,rt){const ut=[];for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt],vt=mt.viewState.position.lineNumber,St=Math.round((nt.getLineMaxColumn(vt)+nt.getLineMinColumn(vt))/2);ut[gt]=this._moveToViewPosition(nt,mt,rt,vt,St)}return ut}static _moveToViewMaxColumn(nt,ot,rt){const ut=[];for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt],vt=mt.viewState.position.lineNumber,St=nt.getLineMaxColumn(vt);ut[gt]=this._moveToViewPosition(nt,mt,rt,vt,St)}return ut}static _moveToViewLastNonWhitespaceColumn(nt,ot,rt){const ut=[];for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt],vt=mt.viewState.position.lineNumber,St=nt.getLineLastNonWhitespaceColumn(vt);ut[gt]=this._moveToViewPosition(nt,mt,rt,vt,St)}return ut}}var CursorMove;(function(ct){const nt=function(rt){if(!isObject$1(rt))return!1;const ut=rt;return!(!isString$1(ut.to)||!isUndefined(ut.select)&&!isBoolean(ut.select)||!isUndefined(ut.by)&&!isString$1(ut.by)||!isUndefined(ut.value)&&!isNumber$1(ut.value))};ct.description={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:nt,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},ct.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},ct.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function ot(rt){if(!rt.to)return null;let ut;switch(rt.to){case ct.RawDirection.Left:ut=0;break;case ct.RawDirection.Right:ut=1;break;case ct.RawDirection.Up:ut=2;break;case ct.RawDirection.Down:ut=3;break;case ct.RawDirection.PrevBlankLine:ut=4;break;case ct.RawDirection.NextBlankLine:ut=5;break;case ct.RawDirection.WrappedLineStart:ut=6;break;case ct.RawDirection.WrappedLineFirstNonWhitespaceCharacter:ut=7;break;case ct.RawDirection.WrappedLineColumnCenter:ut=8;break;case ct.RawDirection.WrappedLineEnd:ut=9;break;case ct.RawDirection.WrappedLineLastNonWhitespaceCharacter:ut=10;break;case ct.RawDirection.ViewPortTop:ut=11;break;case ct.RawDirection.ViewPortBottom:ut=13;break;case ct.RawDirection.ViewPortCenter:ut=12;break;case ct.RawDirection.ViewPortIfOutside:ut=14;break;default:return null}let gt=0;switch(rt.by){case ct.RawUnit.Line:gt=1;break;case ct.RawUnit.WrappedLine:gt=2;break;case ct.RawUnit.Character:gt=3;break;case ct.RawUnit.HalfLine:gt=4;break}return{direction:ut,unit:gt,select:!!rt.select,value:rt.value||1}}ct.parse=ot})(CursorMove||(CursorMove={}));function getEnterAction(ct,nt,ot,rt){const ut=getScopedLineTokens(nt,ot.startLineNumber,ot.startColumn),gt=rt.getLanguageConfiguration(ut.languageId);if(!gt)return null;const pt=ut.getLineContent(),mt=pt.substr(0,ot.startColumn-1-ut.firstCharOffset);let vt;ot.isEmpty()?vt=pt.substr(ot.startColumn-1-ut.firstCharOffset):vt=getScopedLineTokens(nt,ot.endLineNumber,ot.endColumn).getLineContent().substr(ot.endColumn-1-ut.firstCharOffset);let St="";if(ot.startLineNumber>1&&ut.firstCharOffset===0){const kt=getScopedLineTokens(nt,ot.startLineNumber-1);kt.languageId===ut.languageId&&(St=kt.getLineContent())}const yt=gt.onEnter(ct,St,mt,vt);if(!yt)return null;const wt=yt.indentAction;let Lt=yt.appendText;const xt=yt.removeText||0;Lt?wt===IndentAction.Indent&&(Lt="	"+Lt):wt===IndentAction.Indent||wt===IndentAction.IndentOutdent?Lt="	":Lt="";let It=getIndentationAtPosition(nt,ot.startLineNumber,ot.startColumn);return xt&&(It=It.substring(0,It.length-xt)),{indentAction:wt,appendText:Lt,removeText:xt,indentation:It}}var __decorate$1_=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1U=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const repeatCache=Object.create(null);function cachedStringRepeat(ct,nt){if(nt<=0)return"";repeatCache[ct]||(repeatCache[ct]=["",ct]);const ot=repeatCache[ct];for(let rt=ot.length;rt<=nt;rt++)ot[rt]=ot[rt-1]+ct;return ot[nt]}let ShiftCommand=class Ho{static unshiftIndent(nt,ot,rt,ut,gt){const pt=CursorColumns.visibleColumnFromColumn(nt,ot,rt);if(gt){const mt=cachedStringRepeat(" ",ut),St=CursorColumns.prevIndentTabStop(pt,ut)/ut;return cachedStringRepeat(mt,St)}else{const mt="	",St=CursorColumns.prevRenderTabStop(pt,rt)/rt;return cachedStringRepeat(mt,St)}}static shiftIndent(nt,ot,rt,ut,gt){const pt=CursorColumns.visibleColumnFromColumn(nt,ot,rt);if(gt){const mt=cachedStringRepeat(" ",ut),St=CursorColumns.nextIndentTabStop(pt,ut)/ut;return cachedStringRepeat(mt,St)}else{const mt="	",St=CursorColumns.nextRenderTabStop(pt,rt)/rt;return cachedStringRepeat(mt,St)}}constructor(nt,ot,rt){this._languageConfigurationService=rt,this._opts=ot,this._selection=nt,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(nt,ot,rt){this._useLastEditRangeForCursorEndPosition?nt.addTrackedEditOperation(ot,rt):nt.addEditOperation(ot,rt)}getEditOperations(nt,ot){const rt=this._selection.startLineNumber;let ut=this._selection.endLineNumber;this._selection.endColumn===1&&rt!==ut&&(ut=ut-1);const{tabSize:gt,indentSize:pt,insertSpaces:mt}=this._opts,vt=rt===ut;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(nt.getLineContent(rt))&&(this._useLastEditRangeForCursorEndPosition=!0);let St=0,yt=0;for(let wt=rt;wt<=ut;wt++,St=yt){yt=0;const Lt=nt.getLineContent(wt);let xt=firstNonWhitespaceIndex(Lt);if(this._opts.isUnshift&&(Lt.length===0||xt===0)||!vt&&!this._opts.isUnshift&&Lt.length===0)continue;if(xt===-1&&(xt=Lt.length),wt>1&&CursorColumns.visibleColumnFromColumn(Lt,xt+1,gt)%pt!==0&&nt.tokenization.isCheapToTokenize(wt-1)){const At=getEnterAction(this._opts.autoIndent,nt,new Range$2(wt-1,nt.getLineMaxColumn(wt-1),wt-1,nt.getLineMaxColumn(wt-1)),this._languageConfigurationService);if(At){if(yt=St,At.appendText)for(let Tt=0,Rt=At.appendText.length;Tt<Rt&&yt<pt&&At.appendText.charCodeAt(Tt)===32;Tt++)yt++;At.removeText&&(yt=Math.max(0,yt-At.removeText));for(let Tt=0;Tt<yt&&!(xt===0||Lt.charCodeAt(xt-1)!==32);Tt++)xt--}}if(this._opts.isUnshift&&xt===0)continue;let It;this._opts.isUnshift?It=Ho.unshiftIndent(Lt,xt+1,gt,pt,mt):It=Ho.shiftIndent(Lt,xt+1,gt,pt,mt),this._addEditOperation(ot,new Range$2(wt,1,wt,xt+1),It),wt===rt&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=xt+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&nt.getLineLength(rt)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const St=mt?cachedStringRepeat(" ",pt):"	";for(let yt=rt;yt<=ut;yt++){const wt=nt.getLineContent(yt);let Lt=firstNonWhitespaceIndex(wt);if(!(this._opts.isUnshift&&(wt.length===0||Lt===0))&&!(!vt&&!this._opts.isUnshift&&wt.length===0)&&(Lt===-1&&(Lt=wt.length),!(this._opts.isUnshift&&Lt===0)))if(this._opts.isUnshift){Lt=Math.min(Lt,pt);for(let xt=0;xt<Lt;xt++)if(wt.charCodeAt(xt)===9){Lt=xt+1;break}this._addEditOperation(ot,new Range$2(yt,1,yt,Lt+1),"")}else this._addEditOperation(ot,new Range$2(yt,1,yt,1),St),yt===rt&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=ot.trackSelection(this._selection)}computeCursorState(nt,ot){if(this._useLastEditRangeForCursorEndPosition){const ut=ot.getInverseEditOperations()[0];return new Selection$1(ut.range.endLineNumber,ut.range.endColumn,ut.range.endLineNumber,ut.range.endColumn)}const rt=ot.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const ut=this._selection.startColumn;return rt.startColumn<=ut?rt:rt.getDirection()===0?new Selection$1(rt.startLineNumber,ut,rt.endLineNumber,rt.endColumn):new Selection$1(rt.endLineNumber,rt.endColumn,rt.startLineNumber,ut)}return rt}};ShiftCommand=__decorate$1_([__param$1U(2,ILanguageConfigurationService)],ShiftCommand);class SurroundSelectionCommand{constructor(nt,ot,rt){this._range=nt,this._charBeforeSelection=ot,this._charAfterSelection=rt}getEditOperations(nt,ot){ot.addTrackedEditOperation(new Range$2(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),ot.addTrackedEditOperation(new Range$2(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(nt,ot){const rt=ot.getInverseEditOperations(),ut=rt[0].range,gt=rt[1].range;return new Selection$1(ut.endLineNumber,ut.endColumn,gt.endLineNumber,gt.endColumn-this._charAfterSelection.length)}}class CompositionSurroundSelectionCommand{constructor(nt,ot,rt){this._position=nt,this._text=ot,this._charAfter=rt}getEditOperations(nt,ot){ot.addTrackedEditOperation(new Range$2(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(nt,ot){const ut=ot.getInverseEditOperations()[0].range;return new Selection$1(ut.endLineNumber,ut.startColumn,ut.endLineNumber,ut.endColumn-this._charAfter.length)}}function getPrecedingValidLine(ct,nt,ot){const rt=ct.tokenization.getLanguageIdAtPosition(nt,0);if(nt>1){let ut,gt=-1;for(ut=nt-1;ut>=1;ut--){if(ct.tokenization.getLanguageIdAtPosition(ut,0)!==rt)return gt;const pt=ct.getLineContent(ut);if(ot.shouldIgnore(pt)||/^\s+$/.test(pt)||pt===""){gt=ut;continue}return ut}}return-1}function getInheritIndentForLine(ct,nt,ot,rt=!0,ut){if(ct<4)return null;const gt=ut.getLanguageConfiguration(nt.tokenization.getLanguageId()).indentRulesSupport;if(!gt)return null;if(ot<=1)return{indentation:"",action:null};for(let vt=ot-1;vt>0&&nt.getLineContent(vt)==="";vt--)if(vt===1)return{indentation:"",action:null};const pt=getPrecedingValidLine(nt,ot,gt);if(pt<0)return null;if(pt<1)return{indentation:"",action:null};const mt=nt.getLineContent(pt);if(gt.shouldIncrease(mt)||gt.shouldIndentNextLine(mt))return{indentation:getLeadingWhitespace(mt),action:IndentAction.Indent,line:pt};if(gt.shouldDecrease(mt))return{indentation:getLeadingWhitespace(mt),action:null,line:pt};{if(pt===1)return{indentation:getLeadingWhitespace(nt.getLineContent(pt)),action:null,line:pt};const vt=pt-1,St=gt.getIndentMetadata(nt.getLineContent(vt));if(!(St&3)&&St&4){let yt=0;for(let wt=vt-1;wt>0;wt--)if(!gt.shouldIndentNextLine(nt.getLineContent(wt))){yt=wt;break}return{indentation:getLeadingWhitespace(nt.getLineContent(yt+1)),action:null,line:yt+1}}if(rt)return{indentation:getLeadingWhitespace(nt.getLineContent(pt)),action:null,line:pt};for(let yt=pt;yt>0;yt--){const wt=nt.getLineContent(yt);if(gt.shouldIncrease(wt))return{indentation:getLeadingWhitespace(wt),action:IndentAction.Indent,line:yt};if(gt.shouldIndentNextLine(wt)){let Lt=0;for(let xt=yt-1;xt>0;xt--)if(!gt.shouldIndentNextLine(nt.getLineContent(yt))){Lt=xt;break}return{indentation:getLeadingWhitespace(nt.getLineContent(Lt+1)),action:null,line:Lt+1}}else if(gt.shouldDecrease(wt))return{indentation:getLeadingWhitespace(wt),action:null,line:yt}}return{indentation:getLeadingWhitespace(nt.getLineContent(1)),action:null,line:1}}}function getGoodIndentForLine(ct,nt,ot,rt,ut,gt){if(ct<4)return null;const pt=gt.getLanguageConfiguration(ot);if(!pt)return null;const mt=gt.getLanguageConfiguration(ot).indentRulesSupport;if(!mt)return null;const vt=getInheritIndentForLine(ct,nt,rt,void 0,gt),St=nt.getLineContent(rt);if(vt){const yt=vt.line;if(yt!==void 0){let wt=!0;for(let Lt=yt;Lt<rt-1;Lt++)if(!/^\s*$/.test(nt.getLineContent(Lt))){wt=!1;break}if(wt){const Lt=pt.onEnter(ct,"",nt.getLineContent(yt),"");if(Lt){let xt=getLeadingWhitespace(nt.getLineContent(yt));return Lt.removeText&&(xt=xt.substring(0,xt.length-Lt.removeText)),Lt.indentAction===IndentAction.Indent||Lt.indentAction===IndentAction.IndentOutdent?xt=ut.shiftIndent(xt):Lt.indentAction===IndentAction.Outdent&&(xt=ut.unshiftIndent(xt)),mt.shouldDecrease(St)&&(xt=ut.unshiftIndent(xt)),Lt.appendText&&(xt+=Lt.appendText),getLeadingWhitespace(xt)}}}return mt.shouldDecrease(St)?vt.action===IndentAction.Indent?vt.indentation:ut.unshiftIndent(vt.indentation):vt.action===IndentAction.Indent?ut.shiftIndent(vt.indentation):vt.indentation}return null}function getIndentForEnter(ct,nt,ot,rt,ut){if(ct<4)return null;nt.tokenization.forceTokenization(ot.startLineNumber);const gt=nt.tokenization.getLineTokens(ot.startLineNumber),pt=createScopedLineTokens(gt,ot.startColumn-1),mt=pt.getLineContent();let vt=!1,St;pt.firstCharOffset>0&&gt.getLanguageId(0)!==pt.languageId?(vt=!0,St=mt.substr(0,ot.startColumn-1-pt.firstCharOffset)):St=gt.getLineContent().substring(0,ot.startColumn-1);let yt;ot.isEmpty()?yt=mt.substr(ot.startColumn-1-pt.firstCharOffset):yt=getScopedLineTokens(nt,ot.endLineNumber,ot.endColumn).getLineContent().substr(ot.endColumn-1-pt.firstCharOffset);const wt=ut.getLanguageConfiguration(pt.languageId).indentRulesSupport;if(!wt)return null;const Lt=St,xt=getLeadingWhitespace(St),It={tokenization:{getLineTokens:Rt=>nt.tokenization.getLineTokens(Rt),getLanguageId:()=>nt.getLanguageId(),getLanguageIdAtPosition:(Rt,Nt)=>nt.getLanguageIdAtPosition(Rt,Nt)},getLineContent:Rt=>Rt===ot.startLineNumber?Lt:nt.getLineContent(Rt)},kt=getLeadingWhitespace(gt.getLineContent()),At=getInheritIndentForLine(ct,It,ot.startLineNumber+1,void 0,ut);if(!At){const Rt=vt?kt:xt;return{beforeEnter:Rt,afterEnter:Rt}}let Tt=vt?kt:At.indentation;return At.action===IndentAction.Indent&&(Tt=rt.shiftIndent(Tt)),wt.shouldDecrease(yt)&&(Tt=rt.unshiftIndent(Tt)),{beforeEnter:vt?kt:xt,afterEnter:Tt}}function getIndentActionForType(ct,nt,ot,rt,ut,gt){if(ct<4)return null;const pt=getScopedLineTokens(nt,ot.startLineNumber,ot.startColumn);if(pt.firstCharOffset)return null;const mt=gt.getLanguageConfiguration(pt.languageId).indentRulesSupport;if(!mt)return null;const vt=pt.getLineContent(),St=vt.substr(0,ot.startColumn-1-pt.firstCharOffset);let yt;if(ot.isEmpty()?yt=vt.substr(ot.startColumn-1-pt.firstCharOffset):yt=getScopedLineTokens(nt,ot.endLineNumber,ot.endColumn).getLineContent().substr(ot.endColumn-1-pt.firstCharOffset),!mt.shouldDecrease(St+yt)&&mt.shouldDecrease(St+rt+yt)){const wt=getInheritIndentForLine(ct,nt,ot.startLineNumber,!1,gt);if(!wt)return null;let Lt=wt.indentation;return wt.action!==IndentAction.Indent&&(Lt=ut.unshiftIndent(Lt)),Lt}return null}function getIndentMetadata(ct,nt,ot){const rt=ot.getLanguageConfiguration(ct.getLanguageId()).indentRulesSupport;return!rt||nt<1||nt>ct.getLineCount()?null:rt.getIndentMetadata(ct.getLineContent(nt))}class TypeOperations{static indent(nt,ot,rt){if(ot===null||rt===null)return[];const ut=[];for(let gt=0,pt=rt.length;gt<pt;gt++)ut[gt]=new ShiftCommand(rt[gt],{isUnshift:!1,tabSize:nt.tabSize,indentSize:nt.indentSize,insertSpaces:nt.insertSpaces,useTabStops:nt.useTabStops,autoIndent:nt.autoIndent},nt.languageConfigurationService);return ut}static outdent(nt,ot,rt){const ut=[];for(let gt=0,pt=rt.length;gt<pt;gt++)ut[gt]=new ShiftCommand(rt[gt],{isUnshift:!0,tabSize:nt.tabSize,indentSize:nt.indentSize,insertSpaces:nt.insertSpaces,useTabStops:nt.useTabStops,autoIndent:nt.autoIndent},nt.languageConfigurationService);return ut}static shiftIndent(nt,ot,rt){return rt=rt||1,ShiftCommand.shiftIndent(ot,ot.length+rt,nt.tabSize,nt.indentSize,nt.insertSpaces)}static unshiftIndent(nt,ot,rt){return rt=rt||1,ShiftCommand.unshiftIndent(ot,ot.length+rt,nt.tabSize,nt.indentSize,nt.insertSpaces)}static _distributedPaste(nt,ot,rt,ut){const gt=[];for(let pt=0,mt=rt.length;pt<mt;pt++)gt[pt]=new ReplaceCommand(rt[pt],ut[pt]);return new EditOperationResult(0,gt,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(nt,ot,rt,ut,gt){const pt=[];for(let mt=0,vt=rt.length;mt<vt;mt++){const St=rt[mt],yt=St.getPosition();if(gt&&!St.isEmpty()&&(gt=!1),gt&&ut.indexOf(`
`)!==ut.length-1&&(gt=!1),gt){const wt=new Range$2(yt.lineNumber,1,yt.lineNumber,1);pt[mt]=new ReplaceCommandThatPreservesSelection(wt,ut,St,!0)}else pt[mt]=new ReplaceCommand(St,ut)}return new EditOperationResult(0,pt,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _distributePasteToCursors(nt,ot,rt,ut,gt){if(ut||ot.length===1)return null;if(gt&&gt.length===ot.length)return gt;if(nt.multiCursorPaste==="spread"){rt.charCodeAt(rt.length-1)===10&&(rt=rt.substr(0,rt.length-1)),rt.charCodeAt(rt.length-1)===13&&(rt=rt.substr(0,rt.length-1));const pt=splitLines(rt);if(pt.length===ot.length)return pt}return null}static paste(nt,ot,rt,ut,gt,pt){const mt=this._distributePasteToCursors(nt,rt,ut,gt,pt);return mt?(rt=rt.sort(Range$2.compareRangesUsingStarts),this._distributedPaste(nt,ot,rt,mt)):this._simplePaste(nt,ot,rt,ut,gt)}static _goodIndentForLine(nt,ot,rt){let ut=null,gt="";const pt=getInheritIndentForLine(nt.autoIndent,ot,rt,!1,nt.languageConfigurationService);if(pt)ut=pt.action,gt=pt.indentation;else if(rt>1){let mt;for(mt=rt-1;mt>=1;mt--){const yt=ot.getLineContent(mt);if(lastNonWhitespaceIndex(yt)>=0)break}if(mt<1)return null;const vt=ot.getLineMaxColumn(mt),St=getEnterAction(nt.autoIndent,ot,new Range$2(mt,vt,mt,vt),nt.languageConfigurationService);St&&(gt=St.indentation+St.appendText)}return ut&&(ut===IndentAction.Indent&&(gt=TypeOperations.shiftIndent(nt,gt)),ut===IndentAction.Outdent&&(gt=TypeOperations.unshiftIndent(nt,gt)),gt=nt.normalizeIndentation(gt)),gt||null}static _replaceJumpToNextIndent(nt,ot,rt,ut){let gt="";const pt=rt.getStartPosition();if(nt.insertSpaces){const mt=nt.visibleColumnFromColumn(ot,pt),vt=nt.indentSize,St=vt-mt%vt;for(let yt=0;yt<St;yt++)gt+=" "}else gt="	";return new ReplaceCommand(rt,gt,ut)}static tab(nt,ot,rt){const ut=[];for(let gt=0,pt=rt.length;gt<pt;gt++){const mt=rt[gt];if(mt.isEmpty()){const vt=ot.getLineContent(mt.startLineNumber);if(/^\s*$/.test(vt)&&ot.tokenization.isCheapToTokenize(mt.startLineNumber)){let St=this._goodIndentForLine(nt,ot,mt.startLineNumber);St=St||"	";const yt=nt.normalizeIndentation(St);if(!vt.startsWith(yt)){ut[gt]=new ReplaceCommand(new Range$2(mt.startLineNumber,1,mt.startLineNumber,vt.length+1),yt,!0);continue}}ut[gt]=this._replaceJumpToNextIndent(nt,ot,mt,!0)}else{if(mt.startLineNumber===mt.endLineNumber){const vt=ot.getLineMaxColumn(mt.startLineNumber);if(mt.startColumn!==1||mt.endColumn!==vt){ut[gt]=this._replaceJumpToNextIndent(nt,ot,mt,!1);continue}}ut[gt]=new ShiftCommand(mt,{isUnshift:!1,tabSize:nt.tabSize,indentSize:nt.indentSize,insertSpaces:nt.insertSpaces,useTabStops:nt.useTabStops,autoIndent:nt.autoIndent},nt.languageConfigurationService)}}return ut}static compositionType(nt,ot,rt,ut,gt,pt,mt,vt){const St=ut.map(yt=>this._compositionType(rt,yt,gt,pt,mt,vt));return new EditOperationResult(4,St,{shouldPushStackElementBefore:shouldPushStackElementBetween(nt,4),shouldPushStackElementAfter:!1})}static _compositionType(nt,ot,rt,ut,gt,pt){if(!ot.isEmpty())return null;const mt=ot.getPosition(),vt=Math.max(1,mt.column-ut),St=Math.min(nt.getLineMaxColumn(mt.lineNumber),mt.column+gt),yt=new Range$2(mt.lineNumber,vt,mt.lineNumber,St);return nt.getValueInRange(yt)===rt&&pt===0?null:new ReplaceCommandWithOffsetCursorState(yt,rt,0,pt)}static _typeCommand(nt,ot,rt){return rt?new ReplaceCommandWithoutChangingPosition(nt,ot,!0):new ReplaceCommand(nt,ot,!0)}static _enter(nt,ot,rt,ut){if(nt.autoIndent===0)return TypeOperations._typeCommand(ut,`
`,rt);if(!ot.tokenization.isCheapToTokenize(ut.getStartPosition().lineNumber)||nt.autoIndent===1){const vt=ot.getLineContent(ut.startLineNumber),St=getLeadingWhitespace(vt).substring(0,ut.startColumn-1);return TypeOperations._typeCommand(ut,`
`+nt.normalizeIndentation(St),rt)}const gt=getEnterAction(nt.autoIndent,ot,ut,nt.languageConfigurationService);if(gt){if(gt.indentAction===IndentAction.None)return TypeOperations._typeCommand(ut,`
`+nt.normalizeIndentation(gt.indentation+gt.appendText),rt);if(gt.indentAction===IndentAction.Indent)return TypeOperations._typeCommand(ut,`
`+nt.normalizeIndentation(gt.indentation+gt.appendText),rt);if(gt.indentAction===IndentAction.IndentOutdent){const vt=nt.normalizeIndentation(gt.indentation),St=nt.normalizeIndentation(gt.indentation+gt.appendText),yt=`
`+St+`
`+vt;return rt?new ReplaceCommandWithoutChangingPosition(ut,yt,!0):new ReplaceCommandWithOffsetCursorState(ut,yt,-1,St.length-vt.length,!0)}else if(gt.indentAction===IndentAction.Outdent){const vt=TypeOperations.unshiftIndent(nt,gt.indentation);return TypeOperations._typeCommand(ut,`
`+nt.normalizeIndentation(vt+gt.appendText),rt)}}const pt=ot.getLineContent(ut.startLineNumber),mt=getLeadingWhitespace(pt).substring(0,ut.startColumn-1);if(nt.autoIndent>=4){const vt=getIndentForEnter(nt.autoIndent,ot,ut,{unshiftIndent:St=>TypeOperations.unshiftIndent(nt,St),shiftIndent:St=>TypeOperations.shiftIndent(nt,St),normalizeIndentation:St=>nt.normalizeIndentation(St)},nt.languageConfigurationService);if(vt){let St=nt.visibleColumnFromColumn(ot,ut.getEndPosition());const yt=ut.endColumn,wt=ot.getLineContent(ut.endLineNumber),Lt=firstNonWhitespaceIndex(wt);if(Lt>=0?ut=ut.setEndPosition(ut.endLineNumber,Math.max(ut.endColumn,Lt+1)):ut=ut.setEndPosition(ut.endLineNumber,ot.getLineMaxColumn(ut.endLineNumber)),rt)return new ReplaceCommandWithoutChangingPosition(ut,`
`+nt.normalizeIndentation(vt.afterEnter),!0);{let xt=0;return yt<=Lt+1&&(nt.insertSpaces||(St=Math.ceil(St/nt.indentSize)),xt=Math.min(St+1-nt.normalizeIndentation(vt.afterEnter).length-1,0)),new ReplaceCommandWithOffsetCursorState(ut,`
`+nt.normalizeIndentation(vt.afterEnter),0,xt,!0)}}}return TypeOperations._typeCommand(ut,`
`+nt.normalizeIndentation(mt),rt)}static _isAutoIndentType(nt,ot,rt){if(nt.autoIndent<4)return!1;for(let ut=0,gt=rt.length;ut<gt;ut++)if(!ot.tokenization.isCheapToTokenize(rt[ut].getEndPosition().lineNumber))return!1;return!0}static _runAutoIndentType(nt,ot,rt,ut){const gt=getIndentationAtPosition(ot,rt.startLineNumber,rt.startColumn),pt=getIndentActionForType(nt.autoIndent,ot,rt,ut,{shiftIndent:mt=>TypeOperations.shiftIndent(nt,mt),unshiftIndent:mt=>TypeOperations.unshiftIndent(nt,mt)},nt.languageConfigurationService);if(pt===null)return null;if(pt!==nt.normalizeIndentation(gt)){const mt=ot.getLineFirstNonWhitespaceColumn(rt.startLineNumber);return mt===0?TypeOperations._typeCommand(new Range$2(rt.startLineNumber,1,rt.endLineNumber,rt.endColumn),nt.normalizeIndentation(pt)+ut,!1):TypeOperations._typeCommand(new Range$2(rt.startLineNumber,1,rt.endLineNumber,rt.endColumn),nt.normalizeIndentation(pt)+ot.getLineContent(rt.startLineNumber).substring(mt-1,rt.startColumn-1)+ut,!1)}return null}static _isAutoClosingOvertype(nt,ot,rt,ut,gt){if(nt.autoClosingOvertype==="never"||!nt.autoClosingPairs.autoClosingPairsCloseSingleChar.has(gt))return!1;for(let pt=0,mt=rt.length;pt<mt;pt++){const vt=rt[pt];if(!vt.isEmpty())return!1;const St=vt.getPosition(),yt=ot.getLineContent(St.lineNumber);if(yt.charAt(St.column-1)!==gt)return!1;const Lt=isQuote(gt);if((St.column>2?yt.charCodeAt(St.column-2):0)===92&&Lt)return!1;if(nt.autoClosingOvertype==="auto"){let It=!1;for(let kt=0,At=ut.length;kt<At;kt++){const Tt=ut[kt];if(St.lineNumber===Tt.startLineNumber&&St.column===Tt.startColumn){It=!0;break}}if(!It)return!1}}return!0}static _runAutoClosingOvertype(nt,ot,rt,ut,gt){const pt=[];for(let mt=0,vt=ut.length;mt<vt;mt++){const yt=ut[mt].getPosition(),wt=new Range$2(yt.lineNumber,yt.column,yt.lineNumber,yt.column+1);pt[mt]=new ReplaceCommand(wt,gt)}return new EditOperationResult(4,pt,{shouldPushStackElementBefore:shouldPushStackElementBetween(nt,4),shouldPushStackElementAfter:!1})}static _isBeforeClosingBrace(nt,ot){const rt=ot.charAt(0),ut=nt.autoClosingPairs.autoClosingPairsOpenByStart.get(rt)||[],gt=nt.autoClosingPairs.autoClosingPairsCloseByStart.get(rt)||[],pt=ut.some(vt=>ot.startsWith(vt.open)),mt=gt.some(vt=>ot.startsWith(vt.close));return!pt&&mt}static _findAutoClosingPairOpen(nt,ot,rt,ut){const gt=nt.autoClosingPairs.autoClosingPairsOpenByEnd.get(ut);if(!gt)return null;let pt=null;for(const mt of gt)if(pt===null||mt.open.length>pt.open.length){let vt=!0;for(const St of rt)if(ot.getValueInRange(new Range$2(St.lineNumber,St.column-mt.open.length+1,St.lineNumber,St.column))+ut!==mt.open){vt=!1;break}vt&&(pt=mt)}return pt}static _findContainedAutoClosingPair(nt,ot){if(ot.open.length<=1)return null;const rt=ot.close.charAt(ot.close.length-1),ut=nt.autoClosingPairs.autoClosingPairsCloseByEnd.get(rt)||[];let gt=null;for(const pt of ut)pt.open!==ot.open&&ot.open.includes(pt.open)&&ot.close.endsWith(pt.close)&&(!gt||pt.open.length>gt.open.length)&&(gt=pt);return gt}static _getAutoClosingPairClose(nt,ot,rt,ut,gt){const pt=isQuote(ut),mt=pt?nt.autoClosingQuotes:nt.autoClosingBrackets,vt=pt?nt.shouldAutoCloseBefore.quote:nt.shouldAutoCloseBefore.bracket;if(mt==="never")return null;for(const It of rt)if(!It.isEmpty())return null;const St=rt.map(It=>{const kt=It.getPosition();return gt?{lineNumber:kt.lineNumber,beforeColumn:kt.column-ut.length,afterColumn:kt.column}:{lineNumber:kt.lineNumber,beforeColumn:kt.column,afterColumn:kt.column}}),yt=this._findAutoClosingPairOpen(nt,ot,St.map(It=>new Position$1(It.lineNumber,It.beforeColumn)),ut);if(!yt)return null;const wt=this._findContainedAutoClosingPair(nt,yt),Lt=wt?wt.close:"";let xt=!0;for(const It of St){const{lineNumber:kt,beforeColumn:At,afterColumn:Tt}=It,Rt=ot.getLineContent(kt),Nt=Rt.substring(0,At-1),Pt=Rt.substring(Tt-1);if(Pt.startsWith(Lt)||(xt=!1),Pt.length>0){const Ut=Pt.charAt(0);if(!TypeOperations._isBeforeClosingBrace(nt,Pt)&&!vt(Ut))return null}if(yt.open.length===1&&(ut==="'"||ut==='"')&&mt!=="always"){const Ut=getMapForWordSeparators(nt.wordSeparators);if(Nt.length>0){const qt=Nt.charCodeAt(Nt.length-1);if(Ut.get(qt)===0)return null}}if(!ot.tokenization.isCheapToTokenize(kt))return null;ot.tokenization.forceTokenization(kt);const Ft=ot.tokenization.getLineTokens(kt),Kt=createScopedLineTokens(Ft,At-1);if(!yt.shouldAutoClose(Kt,At-Kt.firstCharOffset))return null;const Bt=yt.findNeutralCharacter();if(Bt){const Ut=ot.tokenization.getTokenTypeIfInsertingCharacter(kt,At,Bt);if(!yt.isOK(Ut))return null}}return xt?yt.close.substring(0,yt.close.length-Lt.length):yt.close}static _runAutoClosingOpenCharType(nt,ot,rt,ut,gt,pt,mt){const vt=[];for(let St=0,yt=ut.length;St<yt;St++){const wt=ut[St];vt[St]=new TypeWithAutoClosingCommand(wt,gt,!pt,mt)}return new EditOperationResult(4,vt,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static _shouldSurroundChar(nt,ot){return isQuote(ot)?nt.autoSurround==="quotes"||nt.autoSurround==="languageDefined":nt.autoSurround==="brackets"||nt.autoSurround==="languageDefined"}static _isSurroundSelectionType(nt,ot,rt,ut){if(!TypeOperations._shouldSurroundChar(nt,ut)||!nt.surroundingPairs.hasOwnProperty(ut))return!1;const gt=isQuote(ut);for(const pt of rt){if(pt.isEmpty())return!1;let mt=!0;for(let vt=pt.startLineNumber;vt<=pt.endLineNumber;vt++){const St=ot.getLineContent(vt),yt=vt===pt.startLineNumber?pt.startColumn-1:0,wt=vt===pt.endLineNumber?pt.endColumn-1:St.length,Lt=St.substring(yt,wt);if(/[^ \t]/.test(Lt)){mt=!1;break}}if(mt)return!1;if(gt&&pt.startLineNumber===pt.endLineNumber&&pt.startColumn+1===pt.endColumn){const vt=ot.getValueInRange(pt);if(isQuote(vt))return!1}}return!0}static _runSurroundSelectionType(nt,ot,rt,ut,gt){const pt=[];for(let mt=0,vt=ut.length;mt<vt;mt++){const St=ut[mt],yt=ot.surroundingPairs[gt];pt[mt]=new SurroundSelectionCommand(St,gt,yt)}return new EditOperationResult(0,pt,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isTypeInterceptorElectricChar(nt,ot,rt){return!!(rt.length===1&&ot.tokenization.isCheapToTokenize(rt[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(nt,ot,rt,ut,gt){if(!ot.electricChars.hasOwnProperty(gt)||!ut.isEmpty())return null;const pt=ut.getPosition();rt.tokenization.forceTokenization(pt.lineNumber);const mt=rt.tokenization.getLineTokens(pt.lineNumber);let vt;try{vt=ot.onElectricCharacter(gt,mt,pt.column)}catch(St){return onUnexpectedError(St),null}if(!vt)return null;if(vt.matchOpenBracket){const St=(mt.getLineContent()+gt).lastIndexOf(vt.matchOpenBracket)+1,yt=rt.bracketPairs.findMatchingBracketUp(vt.matchOpenBracket,{lineNumber:pt.lineNumber,column:St},500);if(yt){if(yt.startLineNumber===pt.lineNumber)return null;const wt=rt.getLineContent(yt.startLineNumber),Lt=getLeadingWhitespace(wt),xt=ot.normalizeIndentation(Lt),It=rt.getLineContent(pt.lineNumber),kt=rt.getLineFirstNonWhitespaceColumn(pt.lineNumber)||pt.column,At=It.substring(kt-1,pt.column-1),Tt=xt+At+gt,Rt=new Range$2(pt.lineNumber,1,pt.lineNumber,pt.column),Nt=new ReplaceCommand(Rt,Tt);return new EditOperationResult(getTypingOperation(Tt,nt),[Nt],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}static compositionEndWithInterceptors(nt,ot,rt,ut,gt,pt){if(!ut)return null;let mt=null;for(const wt of ut)if(mt===null)mt=wt.insertedText;else if(mt!==wt.insertedText)return null;if(!mt||mt.length!==1)return null;const vt=mt;let St=!1;for(const wt of ut)if(wt.deletedText.length!==0){St=!0;break}if(St){if(!TypeOperations._shouldSurroundChar(ot,vt)||!ot.surroundingPairs.hasOwnProperty(vt))return null;const wt=isQuote(vt);for(const It of ut)if(It.deletedSelectionStart!==0||It.deletedSelectionEnd!==It.deletedText.length||/^[ \t]+$/.test(It.deletedText)||wt&&isQuote(It.deletedText))return null;const Lt=[];for(const It of gt){if(!It.isEmpty())return null;Lt.push(It.getPosition())}if(Lt.length!==ut.length)return null;const xt=[];for(let It=0,kt=Lt.length;It<kt;It++)xt.push(new CompositionSurroundSelectionCommand(Lt[It],ut[It].deletedText,ot.surroundingPairs[vt]));return new EditOperationResult(4,xt,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(this._isAutoClosingOvertype(ot,rt,gt,pt,vt)){const wt=gt.map(Lt=>new ReplaceCommand(new Range$2(Lt.positionLineNumber,Lt.positionColumn,Lt.positionLineNumber,Lt.positionColumn+1),"",!1));return new EditOperationResult(4,wt,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const yt=this._getAutoClosingPairClose(ot,rt,gt,vt,!0);return yt!==null?this._runAutoClosingOpenCharType(nt,ot,rt,gt,vt,!0,yt):null}static typeWithInterceptors(nt,ot,rt,ut,gt,pt,mt){if(!nt&&mt===`
`){const yt=[];for(let wt=0,Lt=gt.length;wt<Lt;wt++)yt[wt]=TypeOperations._enter(rt,ut,!1,gt[wt]);return new EditOperationResult(4,yt,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!nt&&this._isAutoIndentType(rt,ut,gt)){const yt=[];let wt=!1;for(let Lt=0,xt=gt.length;Lt<xt;Lt++)if(yt[Lt]=this._runAutoIndentType(rt,ut,gt[Lt],mt),!yt[Lt]){wt=!0;break}if(!wt)return new EditOperationResult(4,yt,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(this._isAutoClosingOvertype(rt,ut,gt,pt,mt))return this._runAutoClosingOvertype(ot,rt,ut,gt,mt);if(!nt){const yt=this._getAutoClosingPairClose(rt,ut,gt,mt,!1);if(yt)return this._runAutoClosingOpenCharType(ot,rt,ut,gt,mt,!1,yt)}if(!nt&&this._isSurroundSelectionType(rt,ut,gt,mt))return this._runSurroundSelectionType(ot,rt,ut,gt,mt);if(!nt&&this._isTypeInterceptorElectricChar(rt,ut,gt)){const yt=this._typeInterceptorElectricChar(ot,rt,ut,gt[0],mt);if(yt)return yt}const vt=[];for(let yt=0,wt=gt.length;yt<wt;yt++)vt[yt]=new ReplaceCommand(gt[yt],mt);const St=getTypingOperation(mt,ot);return new EditOperationResult(St,vt,{shouldPushStackElementBefore:shouldPushStackElementBetween(ot,St),shouldPushStackElementAfter:!1})}static typeWithoutInterceptors(nt,ot,rt,ut,gt){const pt=[];for(let vt=0,St=ut.length;vt<St;vt++)pt[vt]=new ReplaceCommand(ut[vt],gt);const mt=getTypingOperation(gt,nt);return new EditOperationResult(mt,pt,{shouldPushStackElementBefore:shouldPushStackElementBetween(nt,mt),shouldPushStackElementAfter:!1})}static lineInsertBefore(nt,ot,rt){if(ot===null||rt===null)return[];const ut=[];for(let gt=0,pt=rt.length;gt<pt;gt++){let mt=rt[gt].positionLineNumber;if(mt===1)ut[gt]=new ReplaceCommandWithoutChangingPosition(new Range$2(1,1,1,1),`
`);else{mt--;const vt=ot.getLineMaxColumn(mt);ut[gt]=this._enter(nt,ot,!1,new Range$2(mt,vt,mt,vt))}}return ut}static lineInsertAfter(nt,ot,rt){if(ot===null||rt===null)return[];const ut=[];for(let gt=0,pt=rt.length;gt<pt;gt++){const mt=rt[gt].positionLineNumber,vt=ot.getLineMaxColumn(mt);ut[gt]=this._enter(nt,ot,!1,new Range$2(mt,vt,mt,vt))}return ut}static lineBreakInsert(nt,ot,rt){const ut=[];for(let gt=0,pt=rt.length;gt<pt;gt++)ut[gt]=this._enter(nt,ot,!0,rt[gt]);return ut}}class TypeWithAutoClosingCommand extends ReplaceCommandWithOffsetCursorState{constructor(nt,ot,rt,ut){super(nt,(rt?ot:"")+ut,0,-ut.length),this._openCharacter=ot,this._closeCharacter=ut,this.closeCharacterRange=null,this.enclosingRange=null}computeCursorState(nt,ot){const ut=ot.getInverseEditOperations()[0].range;return this.closeCharacterRange=new Range$2(ut.startLineNumber,ut.endColumn-this._closeCharacter.length,ut.endLineNumber,ut.endColumn),this.enclosingRange=new Range$2(ut.startLineNumber,ut.endColumn-this._openCharacter.length-this._closeCharacter.length,ut.endLineNumber,ut.endColumn),super.computeCursorState(nt,ot)}}class CompositionOutcome{constructor(nt,ot,rt,ut,gt,pt){this.deletedText=nt,this.deletedSelectionStart=ot,this.deletedSelectionEnd=rt,this.insertedText=ut,this.insertedSelectionStart=gt,this.insertedSelectionEnd=pt}}function getTypingOperation(ct,nt){return ct===" "?nt===5||nt===6?6:5:4}function shouldPushStackElementBetween(ct,nt){return isTypingOperation(ct)&&!isTypingOperation(nt)?!0:ct===5?!1:normalizeOperationType(ct)!==normalizeOperationType(nt)}function normalizeOperationType(ct){return ct===6||ct===5?"space":ct}function isTypingOperation(ct){return ct===4||ct===5||ct===6}var EditorContextKeys;(function(ct){ct.editorSimpleInput=new RawContextKey("editorSimpleInput",!1,!0),ct.editorTextFocus=new RawContextKey("editorTextFocus",!1,localize("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),ct.focus=new RawContextKey("editorFocus",!1,localize("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),ct.textInputFocus=new RawContextKey("textInputFocus",!1,localize("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),ct.readOnly=new RawContextKey("editorReadonly",!1,localize("editorReadonly","Whether the editor is read only")),ct.inDiffEditor=new RawContextKey("inDiffEditor",!1,localize("inDiffEditor","Whether the context is a diff editor")),ct.columnSelection=new RawContextKey("editorColumnSelection",!1,localize("editorColumnSelection","Whether `editor.columnSelection` is enabled")),ct.writable=ct.readOnly.toNegated(),ct.hasNonEmptySelection=new RawContextKey("editorHasSelection",!1,localize("editorHasSelection","Whether the editor has text selected")),ct.hasOnlyEmptySelection=ct.hasNonEmptySelection.toNegated(),ct.hasMultipleSelections=new RawContextKey("editorHasMultipleSelections",!1,localize("editorHasMultipleSelections","Whether the editor has multiple selections")),ct.hasSingleSelection=ct.hasMultipleSelections.toNegated(),ct.tabMovesFocus=new RawContextKey("editorTabMovesFocus",!1,localize("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),ct.tabDoesNotMoveFocus=ct.tabMovesFocus.toNegated(),ct.isInWalkThroughSnippet=new RawContextKey("isInEmbeddedEditor",!1,!0),ct.canUndo=new RawContextKey("canUndo",!1,!0),ct.canRedo=new RawContextKey("canRedo",!1,!0),ct.hoverVisible=new RawContextKey("editorHoverVisible",!1,localize("editorHoverVisible","Whether the editor hover is visible")),ct.hoverFocused=new RawContextKey("editorHoverFocused",!1,localize("editorHoverFocused","Whether the editor hover is focused")),ct.stickyScrollFocused=new RawContextKey("stickyScrollFocused",!1,localize("stickyScrollFocused","Whether the sticky scroll is focused")),ct.stickyScrollVisible=new RawContextKey("stickyScrollVisible",!1,localize("stickyScrollVisible","Whether the sticky scroll is visible")),ct.standaloneColorPickerVisible=new RawContextKey("standaloneColorPickerVisible",!1,localize("standaloneColorPickerVisible","Whether the standalone color picker is visible")),ct.standaloneColorPickerFocused=new RawContextKey("standaloneColorPickerFocused",!1,localize("standaloneColorPickerFocused","Whether the standalone color picker is focused")),ct.inCompositeEditor=new RawContextKey("inCompositeEditor",void 0,localize("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),ct.notInCompositeEditor=ct.inCompositeEditor.toNegated(),ct.languageId=new RawContextKey("editorLangId","",localize("editorLangId","The language identifier of the editor")),ct.hasCompletionItemProvider=new RawContextKey("editorHasCompletionItemProvider",!1,localize("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),ct.hasCodeActionsProvider=new RawContextKey("editorHasCodeActionsProvider",!1,localize("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),ct.hasCodeLensProvider=new RawContextKey("editorHasCodeLensProvider",!1,localize("editorHasCodeLensProvider","Whether the editor has a code lens provider")),ct.hasDefinitionProvider=new RawContextKey("editorHasDefinitionProvider",!1,localize("editorHasDefinitionProvider","Whether the editor has a definition provider")),ct.hasDeclarationProvider=new RawContextKey("editorHasDeclarationProvider",!1,localize("editorHasDeclarationProvider","Whether the editor has a declaration provider")),ct.hasImplementationProvider=new RawContextKey("editorHasImplementationProvider",!1,localize("editorHasImplementationProvider","Whether the editor has an implementation provider")),ct.hasTypeDefinitionProvider=new RawContextKey("editorHasTypeDefinitionProvider",!1,localize("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),ct.hasHoverProvider=new RawContextKey("editorHasHoverProvider",!1,localize("editorHasHoverProvider","Whether the editor has a hover provider")),ct.hasDocumentHighlightProvider=new RawContextKey("editorHasDocumentHighlightProvider",!1,localize("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),ct.hasDocumentSymbolProvider=new RawContextKey("editorHasDocumentSymbolProvider",!1,localize("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),ct.hasReferenceProvider=new RawContextKey("editorHasReferenceProvider",!1,localize("editorHasReferenceProvider","Whether the editor has a reference provider")),ct.hasRenameProvider=new RawContextKey("editorHasRenameProvider",!1,localize("editorHasRenameProvider","Whether the editor has a rename provider")),ct.hasSignatureHelpProvider=new RawContextKey("editorHasSignatureHelpProvider",!1,localize("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),ct.hasInlayHintsProvider=new RawContextKey("editorHasInlayHintsProvider",!1,localize("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),ct.hasDocumentFormattingProvider=new RawContextKey("editorHasDocumentFormattingProvider",!1,localize("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),ct.hasDocumentSelectionFormattingProvider=new RawContextKey("editorHasDocumentSelectionFormattingProvider",!1,localize("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),ct.hasMultipleDocumentFormattingProvider=new RawContextKey("editorHasMultipleDocumentFormattingProvider",!1,localize("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),ct.hasMultipleDocumentSelectionFormattingProvider=new RawContextKey("editorHasMultipleDocumentSelectionFormattingProvider",!1,localize("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))})(EditorContextKeys||(EditorContextKeys={}));const CORE_WEIGHT=0;class CoreEditorCommand extends EditorCommand{runEditorCommand(nt,ot,rt){const ut=ot._getViewModel();ut&&this.runCoreEditorCommand(ut,rt||{})}}var EditorScroll_;(function(ct){const nt=function(rt){if(!isObject$1(rt))return!1;const ut=rt;return!(!isString$1(ut.to)||!isUndefined(ut.by)&&!isString$1(ut.by)||!isUndefined(ut.value)&&!isNumber$1(ut.value)||!isUndefined(ut.revealCursor)&&!isBoolean(ut.revealCursor))};ct.description={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:nt,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},ct.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},ct.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function ot(rt){let ut;switch(rt.to){case ct.RawDirection.Up:ut=1;break;case ct.RawDirection.Right:ut=2;break;case ct.RawDirection.Down:ut=3;break;case ct.RawDirection.Left:ut=4;break;default:return null}let gt;switch(rt.by){case ct.RawUnit.Line:gt=1;break;case ct.RawUnit.WrappedLine:gt=2;break;case ct.RawUnit.Page:gt=3;break;case ct.RawUnit.HalfPage:gt=4;break;case ct.RawUnit.Editor:gt=5;break;case ct.RawUnit.Column:gt=6;break;default:gt=2}const pt=Math.floor(rt.value||1),mt=!!rt.revealCursor;return{direction:ut,unit:gt,value:pt,revealCursor:mt,select:!!rt.select}}ct.parse=ot})(EditorScroll_||(EditorScroll_={}));var RevealLine_;(function(ct){const nt=function(ot){if(!isObject$1(ot))return!1;const rt=ot;return!(!isNumber$1(rt.lineNumber)&&!isString$1(rt.lineNumber)||!isUndefined(rt.at)&&!isString$1(rt.at))};ct.description={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:nt,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},ct.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(RevealLine_||(RevealLine_={}));class EditorOrNativeTextInputCommand{constructor(nt){nt.addImplementation(1e4,"code-editor",(ot,rt)=>{const ut=ot.get(ICodeEditorService).getFocusedCodeEditor();return ut&&ut.hasTextFocus()?this._runEditorCommand(ot,ut,rt):!1}),nt.addImplementation(1e3,"generic-dom-input-textarea",(ot,rt)=>{const ut=document.activeElement;return ut&&["input","textarea"].indexOf(ut.tagName.toLowerCase())>=0?(this.runDOMCommand(),!0):!1}),nt.addImplementation(0,"generic-dom",(ot,rt)=>{const ut=ot.get(ICodeEditorService).getActiveCodeEditor();return ut?(ut.focus(),this._runEditorCommand(ot,ut,rt)):!1})}_runEditorCommand(nt,ot,rt){const ut=this.runEditorCommand(nt,ot,rt);return ut||!0}}var CoreNavigationCommands;(function(ct){class nt extends CoreEditorCommand{constructor(Rt){super(Rt),this._inSelectionMode=Rt.inSelectionMode}runCoreEditorCommand(Rt,Nt){if(!Nt.position)return;Rt.model.pushStackElement(),Rt.setCursorStates(Nt.source,3,[CursorMoveCommands.moveTo(Rt,Rt.getPrimaryCursorState(),this._inSelectionMode,Nt.position,Nt.viewPosition)])&&Nt.revealType!==2&&Rt.revealPrimaryCursor(Nt.source,!0,!0)}}ct.MoveTo=registerEditorCommand(new nt({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),ct.MoveToSelect=registerEditorCommand(new nt({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class ot extends CoreEditorCommand{runCoreEditorCommand(Rt,Nt){Rt.model.pushStackElement();const Pt=this._getColumnSelectResult(Rt,Rt.getPrimaryCursorState(),Rt.getCursorColumnSelectData(),Nt);Pt!==null&&(Rt.setCursorStates(Nt.source,3,Pt.viewStates.map(Ft=>CursorState$1.fromViewState(Ft))),Rt.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:Pt.fromLineNumber,fromViewVisualColumn:Pt.fromVisualColumn,toViewLineNumber:Pt.toLineNumber,toViewVisualColumn:Pt.toVisualColumn}),Pt.reversed?Rt.revealTopMostCursor(Nt.source):Rt.revealBottomMostCursor(Nt.source))}}ct.ColumnSelect=registerEditorCommand(new class extends ot{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(Tt,Rt,Nt,Pt){if(typeof Pt.position>"u"||typeof Pt.viewPosition>"u"||typeof Pt.mouseColumn>"u")return null;const Ft=Tt.model.validatePosition(Pt.position),Kt=Tt.coordinatesConverter.validateViewPosition(new Position$1(Pt.viewPosition.lineNumber,Pt.viewPosition.column),Ft),Bt=Pt.doColumnSelect?Nt.fromViewLineNumber:Kt.lineNumber,Ut=Pt.doColumnSelect?Nt.fromViewVisualColumn:Pt.mouseColumn-1;return ColumnSelection.columnSelect(Tt.cursorConfig,Tt,Bt,Ut,Kt.lineNumber,Pt.mouseColumn-1)}}),ct.CursorColumnSelectLeft=registerEditorCommand(new class extends ot{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(Tt,Rt,Nt,Pt){return ColumnSelection.columnSelectLeft(Tt.cursorConfig,Tt,Nt)}}),ct.CursorColumnSelectRight=registerEditorCommand(new class extends ot{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(Tt,Rt,Nt,Pt){return ColumnSelection.columnSelectRight(Tt.cursorConfig,Tt,Nt)}});class rt extends ot{constructor(Rt){super(Rt),this._isPaged=Rt.isPaged}_getColumnSelectResult(Rt,Nt,Pt,Ft){return ColumnSelection.columnSelectUp(Rt.cursorConfig,Rt,Pt,this._isPaged)}}ct.CursorColumnSelectUp=registerEditorCommand(new rt({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3600,linux:{primary:0}}})),ct.CursorColumnSelectPageUp=registerEditorCommand(new rt({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3595,linux:{primary:0}}}));class ut extends ot{constructor(Rt){super(Rt),this._isPaged=Rt.isPaged}_getColumnSelectResult(Rt,Nt,Pt,Ft){return ColumnSelection.columnSelectDown(Rt.cursorConfig,Rt,Pt,this._isPaged)}}ct.CursorColumnSelectDown=registerEditorCommand(new ut({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3602,linux:{primary:0}}})),ct.CursorColumnSelectPageDown=registerEditorCommand(new ut({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3596,linux:{primary:0}}}));class gt extends CoreEditorCommand{constructor(){super({id:"cursorMove",precondition:void 0,description:CursorMove.description})}runCoreEditorCommand(Rt,Nt){const Pt=CursorMove.parse(Nt);Pt&&this._runCursorMove(Rt,Nt.source,Pt)}_runCursorMove(Rt,Nt,Pt){Rt.model.pushStackElement(),Rt.setCursorStates(Nt,3,gt._move(Rt,Rt.getCursorStates(),Pt)),Rt.revealPrimaryCursor(Nt,!0)}static _move(Rt,Nt,Pt){const Ft=Pt.select,Kt=Pt.value;switch(Pt.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return CursorMoveCommands.simpleMove(Rt,Nt,Pt.direction,Ft,Kt,Pt.unit);case 11:case 13:case 12:case 14:return CursorMoveCommands.viewportMove(Rt,Nt,Pt.direction,Ft,Kt);default:return null}}}ct.CursorMoveImpl=gt,ct.CursorMove=registerEditorCommand(new gt);class pt extends CoreEditorCommand{constructor(Rt){super(Rt),this._staticArgs=Rt.args}runCoreEditorCommand(Rt,Nt){let Pt=this._staticArgs;this._staticArgs.value===-1&&(Pt={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:Nt.pageSize||Rt.cursorConfig.pageSize}),Rt.model.pushStackElement(),Rt.setCursorStates(Nt.source,3,CursorMoveCommands.simpleMove(Rt,Rt.getCursorStates(),Pt.direction,Pt.select,Pt.value,Pt.unit)),Rt.revealPrimaryCursor(Nt.source,!0)}}ct.CursorLeft=registerEditorCommand(new pt({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),ct.CursorLeftSelect=registerEditorCommand(new pt({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1039}})),ct.CursorRight=registerEditorCommand(new pt({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),ct.CursorRightSelect=registerEditorCommand(new pt({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1041}})),ct.CursorUp=registerEditorCommand(new pt({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),ct.CursorUpSelect=registerEditorCommand(new pt({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),ct.CursorPageUp=registerEditorCommand(new pt({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:11}})),ct.CursorPageUpSelect=registerEditorCommand(new pt({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1035}})),ct.CursorDown=registerEditorCommand(new pt({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),ct.CursorDownSelect=registerEditorCommand(new pt({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),ct.CursorPageDown=registerEditorCommand(new pt({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:12}})),ct.CursorPageDownSelect=registerEditorCommand(new pt({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1036}})),ct.CreateCursor=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(Tt,Rt){if(!Rt.position)return;let Nt;Rt.wholeLine?Nt=CursorMoveCommands.line(Tt,Tt.getPrimaryCursorState(),!1,Rt.position,Rt.viewPosition):Nt=CursorMoveCommands.moveTo(Tt,Tt.getPrimaryCursorState(),!1,Rt.position,Rt.viewPosition);const Pt=Tt.getCursorStates();if(Pt.length>1){const Ft=Nt.modelState?Nt.modelState.position:null,Kt=Nt.viewState?Nt.viewState.position:null;for(let Bt=0,Ut=Pt.length;Bt<Ut;Bt++){const qt=Pt[Bt];if(!(Ft&&!qt.modelState.selection.containsPosition(Ft))&&!(Kt&&!qt.viewState.selection.containsPosition(Kt))){Pt.splice(Bt,1),Tt.model.pushStackElement(),Tt.setCursorStates(Rt.source,3,Pt);return}}}Pt.push(Nt),Tt.model.pushStackElement(),Tt.setCursorStates(Rt.source,3,Pt)}}),ct.LastCursorMoveToSelect=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(Tt,Rt){if(!Rt.position)return;const Nt=Tt.getLastAddedCursorIndex(),Pt=Tt.getCursorStates(),Ft=Pt.slice(0);Ft[Nt]=CursorMoveCommands.moveTo(Tt,Pt[Nt],!0,Rt.position,Rt.viewPosition),Tt.model.pushStackElement(),Tt.setCursorStates(Rt.source,3,Ft)}});class mt extends CoreEditorCommand{constructor(Rt){super(Rt),this._inSelectionMode=Rt.inSelectionMode}runCoreEditorCommand(Rt,Nt){Rt.model.pushStackElement(),Rt.setCursorStates(Nt.source,3,CursorMoveCommands.moveToBeginningOfLine(Rt,Rt.getCursorStates(),this._inSelectionMode)),Rt.revealPrimaryCursor(Nt.source,!0)}}ct.CursorHome=registerEditorCommand(new mt({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),ct.CursorHomeSelect=registerEditorCommand(new mt({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class vt extends CoreEditorCommand{constructor(Rt){super(Rt),this._inSelectionMode=Rt.inSelectionMode}runCoreEditorCommand(Rt,Nt){Rt.model.pushStackElement(),Rt.setCursorStates(Nt.source,3,this._exec(Rt.getCursorStates())),Rt.revealPrimaryCursor(Nt.source,!0)}_exec(Rt){const Nt=[];for(let Pt=0,Ft=Rt.length;Pt<Ft;Pt++){const Kt=Rt[Pt],Bt=Kt.modelState.position.lineNumber;Nt[Pt]=CursorState$1.fromModelState(Kt.modelState.move(this._inSelectionMode,Bt,1,0))}return Nt}}ct.CursorLineStart=registerEditorCommand(new vt({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:287}}})),ct.CursorLineStartSelect=registerEditorCommand(new vt({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:1311}}}));class St extends CoreEditorCommand{constructor(Rt){super(Rt),this._inSelectionMode=Rt.inSelectionMode}runCoreEditorCommand(Rt,Nt){Rt.model.pushStackElement(),Rt.setCursorStates(Nt.source,3,CursorMoveCommands.moveToEndOfLine(Rt,Rt.getCursorStates(),this._inSelectionMode,Nt.sticky||!1)),Rt.revealPrimaryCursor(Nt.source,!0)}}ct.CursorEnd=registerEditorCommand(new St({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},description:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:localize("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),ct.CursorEndSelect=registerEditorCommand(new St({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},description:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:localize("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class yt extends CoreEditorCommand{constructor(Rt){super(Rt),this._inSelectionMode=Rt.inSelectionMode}runCoreEditorCommand(Rt,Nt){Rt.model.pushStackElement(),Rt.setCursorStates(Nt.source,3,this._exec(Rt,Rt.getCursorStates())),Rt.revealPrimaryCursor(Nt.source,!0)}_exec(Rt,Nt){const Pt=[];for(let Ft=0,Kt=Nt.length;Ft<Kt;Ft++){const Bt=Nt[Ft],Ut=Bt.modelState.position.lineNumber,qt=Rt.model.getLineMaxColumn(Ut);Pt[Ft]=CursorState$1.fromModelState(Bt.modelState.move(this._inSelectionMode,Ut,qt,0))}return Pt}}ct.CursorLineEnd=registerEditorCommand(new yt({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:291}}})),ct.CursorLineEndSelect=registerEditorCommand(new yt({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:1315}}}));class wt extends CoreEditorCommand{constructor(Rt){super(Rt),this._inSelectionMode=Rt.inSelectionMode}runCoreEditorCommand(Rt,Nt){Rt.model.pushStackElement(),Rt.setCursorStates(Nt.source,3,CursorMoveCommands.moveToBeginningOfBuffer(Rt,Rt.getCursorStates(),this._inSelectionMode)),Rt.revealPrimaryCursor(Nt.source,!0)}}ct.CursorTop=registerEditorCommand(new wt({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2062,mac:{primary:2064}}})),ct.CursorTopSelect=registerEditorCommand(new wt({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3086,mac:{primary:3088}}}));class Lt extends CoreEditorCommand{constructor(Rt){super(Rt),this._inSelectionMode=Rt.inSelectionMode}runCoreEditorCommand(Rt,Nt){Rt.model.pushStackElement(),Rt.setCursorStates(Nt.source,3,CursorMoveCommands.moveToEndOfBuffer(Rt,Rt.getCursorStates(),this._inSelectionMode)),Rt.revealPrimaryCursor(Nt.source,!0)}}ct.CursorBottom=registerEditorCommand(new Lt({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2061,mac:{primary:2066}}})),ct.CursorBottomSelect=registerEditorCommand(new Lt({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3085,mac:{primary:3090}}}));class xt extends CoreEditorCommand{constructor(){super({id:"editorScroll",precondition:void 0,description:EditorScroll_.description})}determineScrollMethod(Rt){const Nt=[6],Pt=[1,2,3,4,5,6],Ft=[4,2],Kt=[1,3];return Nt.includes(Rt.unit)&&Ft.includes(Rt.direction)?this._runHorizontalEditorScroll.bind(this):Pt.includes(Rt.unit)&&Kt.includes(Rt.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(Rt,Nt){const Pt=EditorScroll_.parse(Nt);if(!Pt)return;const Ft=this.determineScrollMethod(Pt);Ft&&Ft(Rt,Nt.source,Pt)}_runVerticalEditorScroll(Rt,Nt,Pt){const Ft=this._computeDesiredScrollTop(Rt,Pt);if(Pt.revealCursor){const Kt=Rt.getCompletelyVisibleViewRangeAtScrollTop(Ft);Rt.setCursorStates(Nt,3,[CursorMoveCommands.findPositionInViewportIfOutside(Rt,Rt.getPrimaryCursorState(),Kt,Pt.select)])}Rt.viewLayout.setScrollPosition({scrollTop:Ft},0)}_computeDesiredScrollTop(Rt,Nt){if(Nt.unit===1){const Kt=Rt.viewLayout.getFutureViewport(),Bt=Rt.getCompletelyVisibleViewRangeAtScrollTop(Kt.top),Ut=Rt.coordinatesConverter.convertViewRangeToModelRange(Bt);let qt;Nt.direction===1?qt=Math.max(1,Ut.startLineNumber-Nt.value):qt=Math.min(Rt.model.getLineCount(),Ut.startLineNumber+Nt.value);const Yt=Rt.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(qt,1));return Rt.viewLayout.getVerticalOffsetForLineNumber(Yt.lineNumber)}if(Nt.unit===5){let Kt=0;return Nt.direction===3&&(Kt=Rt.model.getLineCount()-Rt.cursorConfig.pageSize),Rt.viewLayout.getVerticalOffsetForLineNumber(Kt)}let Pt;Nt.unit===3?Pt=Rt.cursorConfig.pageSize*Nt.value:Nt.unit===4?Pt=Math.round(Rt.cursorConfig.pageSize/2)*Nt.value:Pt=Nt.value;const Ft=(Nt.direction===1?-1:1)*Pt;return Rt.viewLayout.getCurrentScrollTop()+Ft*Rt.cursorConfig.lineHeight}_runHorizontalEditorScroll(Rt,Nt,Pt){const Ft=this._computeDesiredScrollLeft(Rt,Pt);Rt.viewLayout.setScrollPosition({scrollLeft:Ft},0)}_computeDesiredScrollLeft(Rt,Nt){const Pt=(Nt.direction===4?-1:1)*Nt.value;return Rt.viewLayout.getCurrentScrollLeft()+Pt*Rt.cursorConfig.typicalHalfwidthCharacterWidth}}ct.EditorScrollImpl=xt,ct.EditorScroll=registerEditorCommand(new xt),ct.ScrollLineUp=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(Tt,Rt){ct.EditorScroll.runCoreEditorCommand(Tt,{to:EditorScroll_.RawDirection.Up,by:EditorScroll_.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:Rt.source})}}),ct.ScrollPageUp=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(Tt,Rt){ct.EditorScroll.runCoreEditorCommand(Tt,{to:EditorScroll_.RawDirection.Up,by:EditorScroll_.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:Rt.source})}}),ct.ScrollEditorTop=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus}})}runCoreEditorCommand(Tt,Rt){ct.EditorScroll.runCoreEditorCommand(Tt,{to:EditorScroll_.RawDirection.Up,by:EditorScroll_.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:Rt.source})}}),ct.ScrollLineDown=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(Tt,Rt){ct.EditorScroll.runCoreEditorCommand(Tt,{to:EditorScroll_.RawDirection.Down,by:EditorScroll_.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:Rt.source})}}),ct.ScrollPageDown=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(Tt,Rt){ct.EditorScroll.runCoreEditorCommand(Tt,{to:EditorScroll_.RawDirection.Down,by:EditorScroll_.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:Rt.source})}}),ct.ScrollEditorBottom=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus}})}runCoreEditorCommand(Tt,Rt){ct.EditorScroll.runCoreEditorCommand(Tt,{to:EditorScroll_.RawDirection.Down,by:EditorScroll_.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:Rt.source})}}),ct.ScrollLeft=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus}})}runCoreEditorCommand(Tt,Rt){ct.EditorScroll.runCoreEditorCommand(Tt,{to:EditorScroll_.RawDirection.Left,by:EditorScroll_.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:Rt.source})}}),ct.ScrollRight=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus}})}runCoreEditorCommand(Tt,Rt){ct.EditorScroll.runCoreEditorCommand(Tt,{to:EditorScroll_.RawDirection.Right,by:EditorScroll_.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:Rt.source})}});class It extends CoreEditorCommand{constructor(Rt){super(Rt),this._inSelectionMode=Rt.inSelectionMode}runCoreEditorCommand(Rt,Nt){Nt.position&&(Rt.model.pushStackElement(),Rt.setCursorStates(Nt.source,3,[CursorMoveCommands.word(Rt,Rt.getPrimaryCursorState(),this._inSelectionMode,Nt.position)]),Nt.revealType!==2&&Rt.revealPrimaryCursor(Nt.source,!0,!0))}}ct.WordSelect=registerEditorCommand(new It({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),ct.WordSelectDrag=registerEditorCommand(new It({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),ct.LastCursorWordSelect=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(Tt,Rt){if(!Rt.position)return;const Nt=Tt.getLastAddedCursorIndex(),Pt=Tt.getCursorStates(),Ft=Pt.slice(0),Kt=Pt[Nt];Ft[Nt]=CursorMoveCommands.word(Tt,Kt,Kt.modelState.hasSelection(),Rt.position),Tt.model.pushStackElement(),Tt.setCursorStates(Rt.source,3,Ft)}});class kt extends CoreEditorCommand{constructor(Rt){super(Rt),this._inSelectionMode=Rt.inSelectionMode}runCoreEditorCommand(Rt,Nt){Nt.position&&(Rt.model.pushStackElement(),Rt.setCursorStates(Nt.source,3,[CursorMoveCommands.line(Rt,Rt.getPrimaryCursorState(),this._inSelectionMode,Nt.position,Nt.viewPosition)]),Nt.revealType!==2&&Rt.revealPrimaryCursor(Nt.source,!1,!0))}}ct.LineSelect=registerEditorCommand(new kt({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),ct.LineSelectDrag=registerEditorCommand(new kt({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class At extends CoreEditorCommand{constructor(Rt){super(Rt),this._inSelectionMode=Rt.inSelectionMode}runCoreEditorCommand(Rt,Nt){if(!Nt.position)return;const Pt=Rt.getLastAddedCursorIndex(),Ft=Rt.getCursorStates(),Kt=Ft.slice(0);Kt[Pt]=CursorMoveCommands.line(Rt,Ft[Pt],this._inSelectionMode,Nt.position,Nt.viewPosition),Rt.model.pushStackElement(),Rt.setCursorStates(Nt.source,3,Kt)}}ct.LastCursorLineSelect=registerEditorCommand(new At({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),ct.LastCursorLineSelectDrag=registerEditorCommand(new At({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),ct.CancelSelection=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"cancelSelection",precondition:EditorContextKeys.hasNonEmptySelection,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(Tt,Rt){Tt.model.pushStackElement(),Tt.setCursorStates(Rt.source,3,[CursorMoveCommands.cancelSelection(Tt,Tt.getPrimaryCursorState())]),Tt.revealPrimaryCursor(Rt.source,!0)}}),ct.RemoveSecondaryCursors=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"removeSecondaryCursors",precondition:EditorContextKeys.hasMultipleSelections,kbOpts:{weight:CORE_WEIGHT+1,kbExpr:EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(Tt,Rt){Tt.model.pushStackElement(),Tt.setCursorStates(Rt.source,3,[Tt.getPrimaryCursorState()]),Tt.revealPrimaryCursor(Rt.source,!0),status(localize("removedCursor","Removed secondary cursors"))}}),ct.RevealLine=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"revealLine",precondition:void 0,description:RevealLine_.description})}runCoreEditorCommand(Tt,Rt){const Nt=Rt,Pt=Nt.lineNumber||0;let Ft=typeof Pt=="number"?Pt+1:parseInt(Pt)+1;Ft<1&&(Ft=1);const Kt=Tt.model.getLineCount();Ft>Kt&&(Ft=Kt);const Bt=new Range$2(Ft,1,Ft,Tt.model.getLineMaxColumn(Ft));let Ut=0;if(Nt.at)switch(Nt.at){case RevealLine_.RawAtArgument.Top:Ut=3;break;case RevealLine_.RawAtArgument.Center:Ut=1;break;case RevealLine_.RawAtArgument.Bottom:Ut=4;break}const qt=Tt.coordinatesConverter.convertModelRangeToViewRange(Bt);Tt.revealRange(Rt.source,!1,qt,Ut,0)}}),ct.SelectAll=new class extends EditorOrNativeTextInputCommand{constructor(){super(SelectAllCommand)}runDOMCommand(){isFirefox&&(document.activeElement.focus(),document.activeElement.select()),document.execCommand("selectAll")}runEditorCommand(Tt,Rt,Nt){const Pt=Rt._getViewModel();Pt&&this.runCoreEditorCommand(Pt,Nt)}runCoreEditorCommand(Tt,Rt){Tt.model.pushStackElement(),Tt.setCursorStates("keyboard",3,[CursorMoveCommands.selectAll(Tt,Tt.getPrimaryCursorState())])}},ct.SetSelection=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(Tt,Rt){Rt.selection&&(Tt.model.pushStackElement(),Tt.setCursorStates(Rt.source,3,[CursorState$1.fromModelSelection(Rt.selection)]))}})})(CoreNavigationCommands||(CoreNavigationCommands={}));const columnSelectionCondition=ContextKeyExpr.and(EditorContextKeys.textInputFocus,EditorContextKeys.columnSelection);function registerColumnSelection(ct,nt){KeybindingsRegistry.registerKeybindingRule({id:ct,primary:nt,when:columnSelectionCondition,weight:CORE_WEIGHT+1})}registerColumnSelection(CoreNavigationCommands.CursorColumnSelectLeft.id,1039);registerColumnSelection(CoreNavigationCommands.CursorColumnSelectRight.id,1041);registerColumnSelection(CoreNavigationCommands.CursorColumnSelectUp.id,1040);registerColumnSelection(CoreNavigationCommands.CursorColumnSelectPageUp.id,1035);registerColumnSelection(CoreNavigationCommands.CursorColumnSelectDown.id,1042);registerColumnSelection(CoreNavigationCommands.CursorColumnSelectPageDown.id,1036);function registerCommand$2(ct){return ct.register(),ct}var CoreEditingCommands;(function(ct){class nt extends EditorCommand{runEditorCommand(rt,ut,gt){const pt=ut._getViewModel();pt&&this.runCoreEditingCommand(ut,pt,gt||{})}}ct.CoreEditingCommand=nt,ct.LineBreakInsert=registerEditorCommand(new class extends nt{constructor(){super({id:"lineBreakInsert",precondition:EditorContextKeys.writable,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(ot,rt,ut){ot.pushUndoStop(),ot.executeCommands(this.id,TypeOperations.lineBreakInsert(rt.cursorConfig,rt.model,rt.getCursorStates().map(gt=>gt.modelState.selection)))}}),ct.Outdent=registerEditorCommand(new class extends nt{constructor(){super({id:"outdent",precondition:EditorContextKeys.writable,kbOpts:{weight:CORE_WEIGHT,kbExpr:ContextKeyExpr.and(EditorContextKeys.editorTextFocus,EditorContextKeys.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(ot,rt,ut){ot.pushUndoStop(),ot.executeCommands(this.id,TypeOperations.outdent(rt.cursorConfig,rt.model,rt.getCursorStates().map(gt=>gt.modelState.selection))),ot.pushUndoStop()}}),ct.Tab=registerEditorCommand(new class extends nt{constructor(){super({id:"tab",precondition:EditorContextKeys.writable,kbOpts:{weight:CORE_WEIGHT,kbExpr:ContextKeyExpr.and(EditorContextKeys.editorTextFocus,EditorContextKeys.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(ot,rt,ut){ot.pushUndoStop(),ot.executeCommands(this.id,TypeOperations.tab(rt.cursorConfig,rt.model,rt.getCursorStates().map(gt=>gt.modelState.selection))),ot.pushUndoStop()}}),ct.DeleteLeft=registerEditorCommand(new class extends nt{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(ot,rt,ut){const[gt,pt]=DeleteOperations.deleteLeft(rt.getPrevEditOperationType(),rt.cursorConfig,rt.model,rt.getCursorStates().map(mt=>mt.modelState.selection),rt.getCursorAutoClosedCharacters());gt&&ot.pushUndoStop(),ot.executeCommands(this.id,pt),rt.setPrevEditOperationType(2)}}),ct.DeleteRight=registerEditorCommand(new class extends nt{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(ot,rt,ut){const[gt,pt]=DeleteOperations.deleteRight(rt.getPrevEditOperationType(),rt.cursorConfig,rt.model,rt.getCursorStates().map(mt=>mt.modelState.selection));gt&&ot.pushUndoStop(),ot.executeCommands(this.id,pt),rt.setPrevEditOperationType(3)}}),ct.Undo=new class extends EditorOrNativeTextInputCommand{constructor(){super(UndoCommand)}runDOMCommand(){document.execCommand("undo")}runEditorCommand(ot,rt,ut){if(!(!rt.hasModel()||rt.getOption(87)===!0))return rt.getModel().undo()}},ct.Redo=new class extends EditorOrNativeTextInputCommand{constructor(){super(RedoCommand)}runDOMCommand(){document.execCommand("redo")}runEditorCommand(ot,rt,ut){if(!(!rt.hasModel()||rt.getOption(87)===!0))return rt.getModel().redo()}}})(CoreEditingCommands||(CoreEditingCommands={}));class EditorHandlerCommand extends Command{constructor(nt,ot,rt){super({id:nt,precondition:void 0,description:rt}),this._handlerId=ot}runCommand(nt,ot){const rt=nt.get(ICodeEditorService).getFocusedCodeEditor();rt&&rt.trigger("keyboard",this._handlerId,ot)}}function registerOverwritableCommand(ct,nt){registerCommand$2(new EditorHandlerCommand("default:"+ct,ct)),registerCommand$2(new EditorHandlerCommand(ct,ct,nt))}registerOverwritableCommand("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});registerOverwritableCommand("replacePreviousChar");registerOverwritableCommand("compositionType");registerOverwritableCommand("compositionStart");registerOverwritableCommand("compositionEnd");registerOverwritableCommand("paste");registerOverwritableCommand("cut");class ViewController{constructor(nt,ot,rt,ut){this.configuration=nt,this.viewModel=ot,this.userInputEvents=rt,this.commandDelegate=ut}paste(nt,ot,rt,ut){this.commandDelegate.paste(nt,ot,rt,ut)}type(nt){this.commandDelegate.type(nt)}compositionType(nt,ot,rt,ut){this.commandDelegate.compositionType(nt,ot,rt,ut)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(nt){CoreNavigationCommands.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:nt})}_validateViewColumn(nt){const ot=this.viewModel.getLineMinColumn(nt.lineNumber);return nt.column<ot?new Position$1(nt.lineNumber,ot):nt}_hasMulticursorModifier(nt){switch(this.configuration.options.get(75)){case"altKey":return nt.altKey;case"ctrlKey":return nt.ctrlKey;case"metaKey":return nt.metaKey;default:return!1}}_hasNonMulticursorModifier(nt){switch(this.configuration.options.get(75)){case"altKey":return nt.ctrlKey||nt.metaKey;case"ctrlKey":return nt.altKey||nt.metaKey;case"metaKey":return nt.ctrlKey||nt.altKey;default:return!1}}dispatchMouse(nt){const ot=this.configuration.options,rt=isLinux&&ot.get(102),ut=ot.get(20);nt.middleButton&&!rt?this._columnSelect(nt.position,nt.mouseColumn,nt.inSelectionMode):nt.startedOnLineNumbers?this._hasMulticursorModifier(nt)?nt.inSelectionMode?this._lastCursorLineSelect(nt.position,nt.revealType):this._createCursor(nt.position,!0):nt.inSelectionMode?this._lineSelectDrag(nt.position,nt.revealType):this._lineSelect(nt.position,nt.revealType):nt.mouseDownCount>=4?this._selectAll():nt.mouseDownCount===3?this._hasMulticursorModifier(nt)?nt.inSelectionMode?this._lastCursorLineSelectDrag(nt.position,nt.revealType):this._lastCursorLineSelect(nt.position,nt.revealType):nt.inSelectionMode?this._lineSelectDrag(nt.position,nt.revealType):this._lineSelect(nt.position,nt.revealType):nt.mouseDownCount===2?nt.onInjectedText||(this._hasMulticursorModifier(nt)?this._lastCursorWordSelect(nt.position,nt.revealType):nt.inSelectionMode?this._wordSelectDrag(nt.position,nt.revealType):this._wordSelect(nt.position,nt.revealType)):this._hasMulticursorModifier(nt)?this._hasNonMulticursorModifier(nt)||(nt.shiftKey?this._columnSelect(nt.position,nt.mouseColumn,!0):nt.inSelectionMode?this._lastCursorMoveToSelect(nt.position,nt.revealType):this._createCursor(nt.position,!1)):nt.inSelectionMode?nt.altKey?this._columnSelect(nt.position,nt.mouseColumn,!0):ut?this._columnSelect(nt.position,nt.mouseColumn,!0):this._moveToSelect(nt.position,nt.revealType):this.moveTo(nt.position,nt.revealType)}_usualArgs(nt,ot){return nt=this._validateViewColumn(nt),{source:"mouse",position:this._convertViewToModelPosition(nt),viewPosition:nt,revealType:ot}}moveTo(nt,ot){CoreNavigationCommands.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(nt,ot))}_moveToSelect(nt,ot){CoreNavigationCommands.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(nt,ot))}_columnSelect(nt,ot,rt){nt=this._validateViewColumn(nt),CoreNavigationCommands.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(nt),viewPosition:nt,mouseColumn:ot,doColumnSelect:rt})}_createCursor(nt,ot){nt=this._validateViewColumn(nt),CoreNavigationCommands.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(nt),viewPosition:nt,wholeLine:ot})}_lastCursorMoveToSelect(nt,ot){CoreNavigationCommands.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(nt,ot))}_wordSelect(nt,ot){CoreNavigationCommands.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(nt,ot))}_wordSelectDrag(nt,ot){CoreNavigationCommands.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(nt,ot))}_lastCursorWordSelect(nt,ot){CoreNavigationCommands.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(nt,ot))}_lineSelect(nt,ot){CoreNavigationCommands.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(nt,ot))}_lineSelectDrag(nt,ot){CoreNavigationCommands.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(nt,ot))}_lastCursorLineSelect(nt,ot){CoreNavigationCommands.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(nt,ot))}_lastCursorLineSelectDrag(nt,ot){CoreNavigationCommands.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(nt,ot))}_selectAll(){CoreNavigationCommands.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(nt){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(nt)}emitKeyDown(nt){this.userInputEvents.emitKeyDown(nt)}emitKeyUp(nt){this.userInputEvents.emitKeyUp(nt)}emitContextMenu(nt){this.userInputEvents.emitContextMenu(nt)}emitMouseMove(nt){this.userInputEvents.emitMouseMove(nt)}emitMouseLeave(nt){this.userInputEvents.emitMouseLeave(nt)}emitMouseUp(nt){this.userInputEvents.emitMouseUp(nt)}emitMouseDown(nt){this.userInputEvents.emitMouseDown(nt)}emitMouseDrag(nt){this.userInputEvents.emitMouseDrag(nt)}emitMouseDrop(nt){this.userInputEvents.emitMouseDrop(nt)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(nt){this.userInputEvents.emitMouseWheel(nt)}}class ViewUserInputEvents{constructor(nt){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=nt}emitKeyDown(nt){var ot;(ot=this.onKeyDown)===null||ot===void 0||ot.call(this,nt)}emitKeyUp(nt){var ot;(ot=this.onKeyUp)===null||ot===void 0||ot.call(this,nt)}emitContextMenu(nt){var ot;(ot=this.onContextMenu)===null||ot===void 0||ot.call(this,this._convertViewToModelMouseEvent(nt))}emitMouseMove(nt){var ot;(ot=this.onMouseMove)===null||ot===void 0||ot.call(this,this._convertViewToModelMouseEvent(nt))}emitMouseLeave(nt){var ot;(ot=this.onMouseLeave)===null||ot===void 0||ot.call(this,this._convertViewToModelMouseEvent(nt))}emitMouseDown(nt){var ot;(ot=this.onMouseDown)===null||ot===void 0||ot.call(this,this._convertViewToModelMouseEvent(nt))}emitMouseUp(nt){var ot;(ot=this.onMouseUp)===null||ot===void 0||ot.call(this,this._convertViewToModelMouseEvent(nt))}emitMouseDrag(nt){var ot;(ot=this.onMouseDrag)===null||ot===void 0||ot.call(this,this._convertViewToModelMouseEvent(nt))}emitMouseDrop(nt){var ot;(ot=this.onMouseDrop)===null||ot===void 0||ot.call(this,this._convertViewToModelMouseEvent(nt))}emitMouseDropCanceled(){var nt;(nt=this.onMouseDropCanceled)===null||nt===void 0||nt.call(this)}emitMouseWheel(nt){var ot;(ot=this.onMouseWheel)===null||ot===void 0||ot.call(this,nt)}_convertViewToModelMouseEvent(nt){return nt.target?{event:nt.event,target:this._convertViewToModelMouseTarget(nt.target)}:nt}_convertViewToModelMouseTarget(nt){return ViewUserInputEvents.convertViewToModelMouseTarget(nt,this._coordinatesConverter)}static convertViewToModelMouseTarget(nt,ot){const rt=Object.assign({},nt);return rt.position&&(rt.position=ot.convertViewPositionToModelPosition(rt.position)),rt.range&&(rt.range=ot.convertViewRangeToModelRange(rt.range)),(rt.type===5||rt.type===8)&&(rt.detail=this.convertViewToModelViewZoneData(rt.detail,ot)),rt}static convertViewToModelViewZoneData(nt,ot){return{viewZoneId:nt.viewZoneId,positionBefore:nt.positionBefore?ot.convertViewPositionToModelPosition(nt.positionBefore):nt.positionBefore,positionAfter:nt.positionAfter?ot.convertViewPositionToModelPosition(nt.positionAfter):nt.positionAfter,position:ot.convertViewPositionToModelPosition(nt.position),afterLineNumber:ot.convertViewPositionToModelPosition(new Position$1(nt.afterLineNumber,1)).lineNumber}}}var _a$9;class RenderedLinesCollection{constructor(nt){this._createLine=nt,this._set(1,[])}flush(){this._set(1,[])}_set(nt,ot){this._lines=ot,this._rendLineNumberStart=nt}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(nt){const ot=nt-this._rendLineNumberStart;if(ot<0||ot>=this._lines.length)throw new Error("Illegal value for lineNumber");return this._lines[ot]}onLinesDeleted(nt,ot){if(this.getCount()===0)return null;const rt=this.getStartLineNumber(),ut=this.getEndLineNumber();if(ot<rt){const vt=ot-nt+1;return this._rendLineNumberStart-=vt,null}if(nt>ut)return null;let gt=0,pt=0;for(let vt=rt;vt<=ut;vt++){const St=vt-this._rendLineNumberStart;nt<=vt&&vt<=ot&&(pt===0?(gt=St,pt=1):pt++)}if(nt<rt){let vt=0;ot<rt?vt=ot-nt+1:vt=rt-nt,this._rendLineNumberStart-=vt}return this._lines.splice(gt,pt)}onLinesChanged(nt,ot){const rt=nt+ot-1;if(this.getCount()===0)return!1;const ut=this.getStartLineNumber(),gt=this.getEndLineNumber();let pt=!1;for(let mt=nt;mt<=rt;mt++)mt>=ut&&mt<=gt&&(this._lines[mt-this._rendLineNumberStart].onContentChanged(),pt=!0);return pt}onLinesInserted(nt,ot){if(this.getCount()===0)return null;const rt=ot-nt+1,ut=this.getStartLineNumber(),gt=this.getEndLineNumber();if(nt<=ut)return this._rendLineNumberStart+=rt,null;if(nt>gt)return null;if(rt+nt>gt)return this._lines.splice(nt-this._rendLineNumberStart,gt-nt+1);const pt=[];for(let wt=0;wt<rt;wt++)pt[wt]=this._createLine();const mt=nt-this._rendLineNumberStart,vt=this._lines.slice(0,mt),St=this._lines.slice(mt,this._lines.length-rt),yt=this._lines.slice(this._lines.length-rt,this._lines.length);return this._lines=vt.concat(pt).concat(St),yt}onTokensChanged(nt){if(this.getCount()===0)return!1;const ot=this.getStartLineNumber(),rt=this.getEndLineNumber();let ut=!1;for(let gt=0,pt=nt.length;gt<pt;gt++){const mt=nt[gt];if(mt.toLineNumber<ot||mt.fromLineNumber>rt)continue;const vt=Math.max(ot,mt.fromLineNumber),St=Math.min(rt,mt.toLineNumber);for(let yt=vt;yt<=St;yt++){const wt=yt-this._rendLineNumberStart;this._lines[wt].onTokensChanged(),ut=!0}}return ut}}class VisibleLinesCollection{constructor(nt){this._host=nt,this.domNode=this._createDomNode(),this._linesCollection=new RenderedLinesCollection(()=>this._host.createVisibleLine())}_createDomNode(){const nt=createFastDomNode(document.createElement("div"));return nt.setClassName("view-layer"),nt.setPosition("absolute"),nt.domNode.setAttribute("role","presentation"),nt.domNode.setAttribute("aria-hidden","true"),nt}onConfigurationChanged(nt){return!!nt.hasChanged(139)}onFlushed(nt){return this._linesCollection.flush(),!0}onLinesChanged(nt){return this._linesCollection.onLinesChanged(nt.fromLineNumber,nt.count)}onLinesDeleted(nt){const ot=this._linesCollection.onLinesDeleted(nt.fromLineNumber,nt.toLineNumber);if(ot)for(let rt=0,ut=ot.length;rt<ut;rt++){const gt=ot[rt].getDomNode();gt&&this.domNode.domNode.removeChild(gt)}return!0}onLinesInserted(nt){const ot=this._linesCollection.onLinesInserted(nt.fromLineNumber,nt.toLineNumber);if(ot)for(let rt=0,ut=ot.length;rt<ut;rt++){const gt=ot[rt].getDomNode();gt&&this.domNode.domNode.removeChild(gt)}return!0}onScrollChanged(nt){return nt.scrollTopChanged}onTokensChanged(nt){return this._linesCollection.onTokensChanged(nt.ranges)}onZonesChanged(nt){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(nt){return this._linesCollection.getLine(nt)}renderLines(nt){const ot=this._linesCollection._get(),rt=new ViewLayerRenderer(this.domNode.domNode,this._host,nt),ut={rendLineNumberStart:ot.rendLineNumberStart,lines:ot.lines,linesLength:ot.lines.length},gt=rt.render(ut,nt.startLineNumber,nt.endLineNumber,nt.relativeVerticalOffset);this._linesCollection._set(gt.rendLineNumberStart,gt.lines)}}class ViewLayerRenderer{constructor(nt,ot,rt){this.domNode=nt,this.host=ot,this.viewportData=rt}render(nt,ot,rt,ut){const gt={rendLineNumberStart:nt.rendLineNumberStart,lines:nt.lines.slice(0),linesLength:nt.linesLength};if(gt.rendLineNumberStart+gt.linesLength-1<ot||rt<gt.rendLineNumberStart){gt.rendLineNumberStart=ot,gt.linesLength=rt-ot+1,gt.lines=[];for(let pt=ot;pt<=rt;pt++)gt.lines[pt-ot]=this.host.createVisibleLine();return this._finishRendering(gt,!0,ut),gt}if(this._renderUntouchedLines(gt,Math.max(ot-gt.rendLineNumberStart,0),Math.min(rt-gt.rendLineNumberStart,gt.linesLength-1),ut,ot),gt.rendLineNumberStart>ot){const pt=ot,mt=Math.min(rt,gt.rendLineNumberStart-1);pt<=mt&&(this._insertLinesBefore(gt,pt,mt,ut,ot),gt.linesLength+=mt-pt+1)}else if(gt.rendLineNumberStart<ot){const pt=Math.min(gt.linesLength,ot-gt.rendLineNumberStart);pt>0&&(this._removeLinesBefore(gt,pt),gt.linesLength-=pt)}if(gt.rendLineNumberStart=ot,gt.rendLineNumberStart+gt.linesLength-1<rt){const pt=gt.rendLineNumberStart+gt.linesLength,mt=rt;pt<=mt&&(this._insertLinesAfter(gt,pt,mt,ut,ot),gt.linesLength+=mt-pt+1)}else if(gt.rendLineNumberStart+gt.linesLength-1>rt){const pt=Math.max(0,rt-gt.rendLineNumberStart+1),vt=gt.linesLength-1-pt+1;vt>0&&(this._removeLinesAfter(gt,vt),gt.linesLength-=vt)}return this._finishRendering(gt,!1,ut),gt}_renderUntouchedLines(nt,ot,rt,ut,gt){const pt=nt.rendLineNumberStart,mt=nt.lines;for(let vt=ot;vt<=rt;vt++){const St=pt+vt;mt[vt].layoutLine(St,ut[St-gt])}}_insertLinesBefore(nt,ot,rt,ut,gt){const pt=[];let mt=0;for(let vt=ot;vt<=rt;vt++)pt[mt++]=this.host.createVisibleLine();nt.lines=pt.concat(nt.lines)}_removeLinesBefore(nt,ot){for(let rt=0;rt<ot;rt++){const ut=nt.lines[rt].getDomNode();ut&&this.domNode.removeChild(ut)}nt.lines.splice(0,ot)}_insertLinesAfter(nt,ot,rt,ut,gt){const pt=[];let mt=0;for(let vt=ot;vt<=rt;vt++)pt[mt++]=this.host.createVisibleLine();nt.lines=nt.lines.concat(pt)}_removeLinesAfter(nt,ot){const rt=nt.linesLength-ot;for(let ut=0;ut<ot;ut++){const gt=nt.lines[rt+ut].getDomNode();gt&&this.domNode.removeChild(gt)}nt.lines.splice(rt,ot)}_finishRenderingNewLines(nt,ot,rt,ut){ViewLayerRenderer._ttPolicy&&(rt=ViewLayerRenderer._ttPolicy.createHTML(rt));const gt=this.domNode.lastChild;ot||!gt?this.domNode.innerHTML=rt:gt.insertAdjacentHTML("afterend",rt);let pt=this.domNode.lastChild;for(let mt=nt.linesLength-1;mt>=0;mt--){const vt=nt.lines[mt];ut[mt]&&(vt.setDomNode(pt),pt=pt.previousSibling)}}_finishRenderingInvalidLines(nt,ot,rt){const ut=document.createElement("div");ViewLayerRenderer._ttPolicy&&(ot=ViewLayerRenderer._ttPolicy.createHTML(ot)),ut.innerHTML=ot;for(let gt=0;gt<nt.linesLength;gt++){const pt=nt.lines[gt];if(rt[gt]){const mt=ut.firstChild,vt=pt.getDomNode();vt.parentNode.replaceChild(mt,vt),pt.setDomNode(mt)}}}_finishRendering(nt,ot,rt){const ut=ViewLayerRenderer._sb,gt=nt.linesLength,pt=nt.lines,mt=nt.rendLineNumberStart,vt=[];{ut.reset();let St=!1;for(let yt=0;yt<gt;yt++){const wt=pt[yt];vt[yt]=!1,!(wt.getDomNode()||!wt.renderLine(yt+mt,rt[yt],this.viewportData,ut))&&(vt[yt]=!0,St=!0)}St&&this._finishRenderingNewLines(nt,ot,ut.build(),vt)}{ut.reset();let St=!1;const yt=[];for(let wt=0;wt<gt;wt++){const Lt=pt[wt];yt[wt]=!1,!(vt[wt]||!Lt.renderLine(wt+mt,rt[wt],this.viewportData,ut))&&(yt[wt]=!0,St=!0)}St&&this._finishRenderingInvalidLines(nt,ut.build(),yt)}}}ViewLayerRenderer._ttPolicy=(_a$9=window.trustedTypes)===null||_a$9===void 0?void 0:_a$9.createPolicy("editorViewLayer",{createHTML:ct=>ct});ViewLayerRenderer._sb=new StringBuilder(1e5);class ViewOverlays extends ViewPart{constructor(nt){super(nt),this._visibleLines=new VisibleLinesCollection(this),this.domNode=this._visibleLines.domNode;const rt=this._context.configuration.options.get(48);applyFontInfo(this.domNode,rt),this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let nt=0,ot=this._dynamicOverlays.length;nt<ot;nt++)if(this._dynamicOverlays[nt].shouldRender())return!0;return!1}dispose(){super.dispose();for(let nt=0,ot=this._dynamicOverlays.length;nt<ot;nt++)this._dynamicOverlays[nt].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new ViewOverlayLine(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(nt){this._dynamicOverlays.push(nt)}onConfigurationChanged(nt){this._visibleLines.onConfigurationChanged(nt);const ot=this._visibleLines.getStartLineNumber(),rt=this._visibleLines.getEndLineNumber();for(let pt=ot;pt<=rt;pt++)this._visibleLines.getVisibleLine(pt).onConfigurationChanged(nt);const gt=this._context.configuration.options.get(48);return applyFontInfo(this.domNode,gt),!0}onFlushed(nt){return this._visibleLines.onFlushed(nt)}onFocusChanged(nt){return this._isFocused=nt.isFocused,!0}onLinesChanged(nt){return this._visibleLines.onLinesChanged(nt)}onLinesDeleted(nt){return this._visibleLines.onLinesDeleted(nt)}onLinesInserted(nt){return this._visibleLines.onLinesInserted(nt)}onScrollChanged(nt){return this._visibleLines.onScrollChanged(nt)||!0}onTokensChanged(nt){return this._visibleLines.onTokensChanged(nt)}onZonesChanged(nt){return this._visibleLines.onZonesChanged(nt)}prepareRender(nt){const ot=this._dynamicOverlays.filter(rt=>rt.shouldRender());for(let rt=0,ut=ot.length;rt<ut;rt++){const gt=ot[rt];gt.prepareRender(nt),gt.onDidRender()}}render(nt){this._viewOverlaysRender(nt),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(nt){this._visibleLines.renderLines(nt.viewportData)}}class ViewOverlayLine{constructor(nt,ot){this._configuration=nt,this._lineHeight=this._configuration.options.get(64),this._dynamicOverlays=ot,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(nt){this._domNode=createFastDomNode(nt)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(nt){this._lineHeight=this._configuration.options.get(64)}renderLine(nt,ot,rt,ut){let gt="";for(let pt=0,mt=this._dynamicOverlays.length;pt<mt;pt++){const vt=this._dynamicOverlays[pt];gt+=vt.render(rt.startLineNumber,nt)}return this._renderedContent===gt?!1:(this._renderedContent=gt,ut.appendString('<div style="position:absolute;top:'),ut.appendString(String(ot)),ut.appendString("px;width:100%;height:"),ut.appendString(String(this._lineHeight)),ut.appendString('px;">'),ut.appendString(gt),ut.appendString("</div>"),!0)}layoutLine(nt,ot){this._domNode&&(this._domNode.setTop(ot),this._domNode.setHeight(this._lineHeight))}}class ContentViewOverlays extends ViewOverlays{constructor(nt){super(nt);const rt=this._context.configuration.options.get(139);this._contentWidth=rt.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(nt){const rt=this._context.configuration.options.get(139);return this._contentWidth=rt.contentWidth,super.onConfigurationChanged(nt)||!0}onScrollChanged(nt){return super.onScrollChanged(nt)||nt.scrollWidthChanged}_viewOverlaysRender(nt){super._viewOverlaysRender(nt),this.domNode.setWidth(Math.max(nt.scrollWidth,this._contentWidth))}}class MarginViewOverlays extends ViewOverlays{constructor(nt){super(nt);const ot=this._context.configuration.options,rt=ot.get(139);this._contentLeft=rt.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),applyFontInfo(this.domNode,ot.get(48))}onConfigurationChanged(nt){const ot=this._context.configuration.options;applyFontInfo(this.domNode,ot.get(48));const rt=ot.get(139);return this._contentLeft=rt.contentLeft,super.onConfigurationChanged(nt)||!0}onScrollChanged(nt){return super.onScrollChanged(nt)||nt.scrollHeightChanged}_viewOverlaysRender(nt){super._viewOverlaysRender(nt);const ot=Math.min(nt.scrollHeight,1e6);this.domNode.setHeight(ot),this.domNode.setWidth(this._contentLeft)}}class ViewContentWidgets extends ViewPart{constructor(nt,ot){super(nt),this._viewDomNode=ot,this._widgets={},this.domNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(nt){const ot=Object.keys(this._widgets);for(const rt of ot)this._widgets[rt].onConfigurationChanged(nt);return!0}onDecorationsChanged(nt){return!0}onFlushed(nt){return!0}onLineMappingChanged(nt){return this._updateAnchorsViewPositions(),!0}onLinesChanged(nt){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(nt){return this._updateAnchorsViewPositions(),!0}onLinesInserted(nt){return this._updateAnchorsViewPositions(),!0}onScrollChanged(nt){return!0}onZonesChanged(nt){return!0}_updateAnchorsViewPositions(){const nt=Object.keys(this._widgets);for(const ot of nt)this._widgets[ot].updateAnchorViewPosition()}addWidget(nt){const ot=new Widget(this._context,this._viewDomNode,nt);this._widgets[ot.id]=ot,ot.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(ot.domNode):this.domNode.appendChild(ot.domNode),this.setShouldRender()}setWidgetPosition(nt,ot,rt,ut,gt){this._widgets[nt.getId()].setPosition(ot,rt,ut,gt),this.setShouldRender()}removeWidget(nt){const ot=nt.getId();if(this._widgets.hasOwnProperty(ot)){const rt=this._widgets[ot];delete this._widgets[ot];const ut=rt.domNode.domNode;ut.parentNode.removeChild(ut),ut.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(nt){return this._widgets.hasOwnProperty(nt)?this._widgets[nt].suppressMouseDown:!1}onBeforeRender(nt){const ot=Object.keys(this._widgets);for(const rt of ot)this._widgets[rt].onBeforeRender(nt)}prepareRender(nt){const ot=Object.keys(this._widgets);for(const rt of ot)this._widgets[rt].prepareRender(nt)}render(nt){const ot=Object.keys(this._widgets);for(const rt of ot)this._widgets[rt].render(nt)}}class Widget{constructor(nt,ot,rt){this._primaryAnchor=new PositionPair(null,null),this._secondaryAnchor=new PositionPair(null,null),this._context=nt,this._viewDomNode=ot,this._actual=rt,this.domNode=createFastDomNode(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const ut=this._context.configuration.options,gt=ut.get(139);this._fixedOverflowWidgets=ut.get(40),this._contentWidth=gt.contentWidth,this._contentLeft=gt.contentLeft,this._lineHeight=ut.get(64),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(nt){const ot=this._context.configuration.options;if(this._lineHeight=ot.get(64),nt.hasChanged(139)){const rt=ot.get(139);this._contentLeft=rt.contentLeft,this._contentWidth=rt.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(nt,ot,rt){this._affinity=nt,this._primaryAnchor=ut(ot,this._context.viewModel,this._affinity),this._secondaryAnchor=ut(rt,this._context.viewModel,this._affinity);function ut(gt,pt,mt){if(!gt)return new PositionPair(null,null);const vt=pt.model.validatePosition(gt);if(pt.coordinatesConverter.modelPositionIsVisible(vt)){const St=pt.coordinatesConverter.convertModelPositionToViewPosition(vt,mt??void 0);return new PositionPair(gt,St)}return new PositionPair(gt,null)}}_getMaxWidth(){return this.allowEditorOverflow?window.innerWidth||document.documentElement.offsetWidth||document.body.offsetWidth:this._contentWidth}setPosition(nt,ot,rt,ut){this._setPosition(ut,nt,ot),this._preference=rt,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(nt,ot,rt,ut){const gt=nt.top,pt=gt,mt=nt.top+nt.height,vt=ut.viewportHeight-mt,St=gt-rt,yt=pt>=rt,wt=mt,Lt=vt>=rt;let xt=nt.left;return xt+ot>ut.scrollLeft+ut.viewportWidth&&(xt=ut.scrollLeft+ut.viewportWidth-ot),xt<ut.scrollLeft&&(xt=ut.scrollLeft),{fitsAbove:yt,aboveTop:St,fitsBelow:Lt,belowTop:wt,left:xt}}_layoutHorizontalSegmentInPage(nt,ot,rt,ut){const mt=Math.max(15,ot.left-ut),vt=Math.min(ot.left+ot.width+ut,nt.width-15);let St=ot.left+rt-window.scrollX;if(St+ut>vt){const yt=St-(vt-ut);St-=yt,rt-=yt}if(St<mt){const yt=St-mt;St-=yt,rt-=yt}return[rt,St]}_layoutBoxInPage(nt,ot,rt,ut){const gt=nt.top-rt,pt=nt.top+nt.height,mt=getDomNodePagePosition(this._viewDomNode.domNode),vt=mt.top+gt-window.scrollY,St=mt.top+pt-window.scrollY,yt=getClientArea(document.body),[wt,Lt]=this._layoutHorizontalSegmentInPage(yt,mt,nt.left-ut.scrollLeft+this._contentLeft,ot),xt=22,It=22,kt=vt>=xt,At=St+rt<=yt.height-It;return this._fixedOverflowWidgets?{fitsAbove:kt,aboveTop:Math.max(vt,xt),fitsBelow:At,belowTop:St,left:Lt}:{fitsAbove:kt,aboveTop:gt,fitsBelow:At,belowTop:pt,left:wt}}_prepareRenderWidgetAtExactPositionOverflowing(nt){return new Coordinate(nt.top,nt.left+this._contentLeft)}_getAnchorsCoordinates(nt){var ot,rt;const ut=mt(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),gt=((ot=this._secondaryAnchor.viewPosition)===null||ot===void 0?void 0:ot.lineNumber)===((rt=this._primaryAnchor.viewPosition)===null||rt===void 0?void 0:rt.lineNumber)?this._secondaryAnchor.viewPosition:null,pt=mt(gt,this._affinity,this._lineHeight);return{primary:ut,secondary:pt};function mt(vt,St,yt){if(!vt)return null;const wt=nt.visibleRangeForPosition(vt);if(!wt)return null;const Lt=vt.column===1&&St===3?0:wt.left,xt=nt.getVerticalOffsetForLineNumber(vt.lineNumber)-nt.scrollTop;return new AnchorCoordinate(xt,Lt,yt)}}_reduceAnchorCoordinates(nt,ot,rt){if(!ot)return nt;const ut=this._context.configuration.options.get(48);let gt=ot.left;return gt<nt.left?gt=Math.max(gt,nt.left-rt+ut.typicalFullwidthCharacterWidth):gt=Math.min(gt,nt.left+rt-ut.typicalFullwidthCharacterWidth),new AnchorCoordinate(nt.top,gt,nt.height)}_prepareRenderWidget(nt){if(!this._preference||this._preference.length===0)return null;const{primary:ot,secondary:rt}=this._getAnchorsCoordinates(nt);if(!ot)return null;if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let pt=null;if(typeof this._actual.beforeRender=="function"&&(pt=safeInvoke(this._actual.beforeRender,this._actual)),pt)this._cachedDomNodeOffsetWidth=pt.width,this._cachedDomNodeOffsetHeight=pt.height;else{const vt=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(vt.width),this._cachedDomNodeOffsetHeight=Math.round(vt.height)}}const ut=this._reduceAnchorCoordinates(ot,rt,this._cachedDomNodeOffsetWidth);let gt;this.allowEditorOverflow?gt=this._layoutBoxInPage(ut,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,nt):gt=this._layoutBoxInViewport(ut,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,nt);for(let pt=1;pt<=2;pt++)for(const mt of this._preference)if(mt===1){if(!gt)return null;if(pt===2||gt.fitsAbove)return{coordinate:new Coordinate(gt.aboveTop,gt.left),position:1}}else if(mt===2){if(!gt)return null;if(pt===2||gt.fitsBelow)return{coordinate:new Coordinate(gt.belowTop,gt.left),position:2}}else return this.allowEditorOverflow?{coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new Coordinate(ut.top,ut.left)),position:0}:{coordinate:new Coordinate(ut.top,ut.left),position:0};return null}onBeforeRender(nt){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<nt.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>nt.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(nt){this._renderData=this._prepareRenderWidget(nt)}render(nt){if(!this._renderData){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&safeInvoke(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+nt.scrollTop-nt.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&safeInvoke(this._actual.afterRender,this._actual,this._renderData.position)}}class PositionPair{constructor(nt,ot){this.modelPosition=nt,this.viewPosition=ot}}class Coordinate{constructor(nt,ot){this.top=nt,this.left=ot,this._coordinateBrand=void 0}}class AnchorCoordinate{constructor(nt,ot,rt){this.top=nt,this.left=ot,this.height=rt,this._anchorCoordinateBrand=void 0}}function safeInvoke(ct,nt,...ot){try{return ct.call(nt,...ot)}catch{return null}}const currentLineHighlight="";class AbstractLineHighlightOverlay extends DynamicViewOverlay{constructor(nt){super(),this._context=nt;const ot=this._context.configuration.options,rt=ot.get(139);this._lineHeight=ot.get(64),this._renderLineHighlight=ot.get(91),this._renderLineHighlightOnlyWhenFocus=ot.get(92),this._contentLeft=rt.contentLeft,this._contentWidth=rt.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new Selection$1(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let nt=!1;const ot=this._selections.map(ut=>ut.positionLineNumber);ot.sort((ut,gt)=>ut-gt),equals$2(this._cursorLineNumbers,ot)||(this._cursorLineNumbers=ot,nt=!0);const rt=this._selections.every(ut=>ut.isEmpty());return this._selectionIsEmpty!==rt&&(this._selectionIsEmpty=rt,nt=!0),nt}onThemeChanged(nt){return this._readFromSelections()}onConfigurationChanged(nt){const ot=this._context.configuration.options,rt=ot.get(139);return this._lineHeight=ot.get(64),this._renderLineHighlight=ot.get(91),this._renderLineHighlightOnlyWhenFocus=ot.get(92),this._contentLeft=rt.contentLeft,this._contentWidth=rt.contentWidth,!0}onCursorStateChanged(nt){return this._selections=nt.selections,this._readFromSelections()}onFlushed(nt){return!0}onLinesDeleted(nt){return!0}onLinesInserted(nt){return!0}onScrollChanged(nt){return nt.scrollWidthChanged||nt.scrollTopChanged}onZonesChanged(nt){return!0}onFocusChanged(nt){return this._renderLineHighlightOnlyWhenFocus?(this._focused=nt.isFocused,!0):!1}prepareRender(nt){if(!this._shouldRenderThis()){this._renderData=null;return}const ot=this._renderOne(nt),rt=nt.visibleRange.startLineNumber,ut=nt.visibleRange.endLineNumber,gt=this._cursorLineNumbers.length;let pt=0;const mt=[];for(let vt=rt;vt<=ut;vt++){const St=vt-rt;for(;pt<gt&&this._cursorLineNumbers[pt]<vt;)pt++;pt<gt&&this._cursorLineNumbers[pt]===vt?mt[St]=ot:mt[St]=""}this._renderData=mt}render(nt,ot){if(!this._renderData)return"";const rt=ot-nt;return rt>=this._renderData.length?"":this._renderData[rt]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class CurrentLineHighlightOverlay extends AbstractLineHighlightOverlay{_renderOne(nt){return`<div class="${"current-line"+(this._shouldRenderOther()?" current-line-both":"")}" style="width:${Math.max(nt.scrollWidth,this._contentWidth)}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class CurrentLineMarginHighlightOverlay extends AbstractLineHighlightOverlay{_renderOne(nt){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")}" style="width:${this._contentLeft}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}registerThemingParticipant((ct,nt)=>{const ot=ct.getColor(editorLineHighlight);if(ot&&(nt.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${ot}; }`),nt.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${ot}; border: none; }`)),!ot||ot.isTransparent()||ct.defines(editorLineHighlightBorder)){const rt=ct.getColor(editorLineHighlightBorder);rt&&(nt.addRule(`.monaco-editor .view-overlays .current-line { border: 2px solid ${rt}; }`),nt.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid ${rt}; }`),isHighContrast(ct.type)&&(nt.addRule(".monaco-editor .view-overlays .current-line { border-width: 1px; }"),nt.addRule(".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }")))}});const decorations="";class DecorationsOverlay extends DynamicViewOverlay{constructor(nt){super(),this._context=nt;const ot=this._context.configuration.options;this._lineHeight=ot.get(64),this._typicalHalfwidthCharacterWidth=ot.get(48).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(nt){const ot=this._context.configuration.options;return this._lineHeight=ot.get(64),this._typicalHalfwidthCharacterWidth=ot.get(48).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(nt){return!0}onFlushed(nt){return!0}onLinesChanged(nt){return!0}onLinesDeleted(nt){return!0}onLinesInserted(nt){return!0}onScrollChanged(nt){return nt.scrollTopChanged||nt.scrollWidthChanged}onZonesChanged(nt){return!0}prepareRender(nt){const ot=nt.getDecorationsInViewport();let rt=[],ut=0;for(let vt=0,St=ot.length;vt<St;vt++){const yt=ot[vt];yt.options.className&&(rt[ut++]=yt)}rt=rt.sort((vt,St)=>{if(vt.options.zIndex<St.options.zIndex)return-1;if(vt.options.zIndex>St.options.zIndex)return 1;const yt=vt.options.className,wt=St.options.className;return yt<wt?-1:yt>wt?1:Range$2.compareRangesUsingStarts(vt.range,St.range)});const gt=nt.visibleRange.startLineNumber,pt=nt.visibleRange.endLineNumber,mt=[];for(let vt=gt;vt<=pt;vt++){const St=vt-gt;mt[St]=""}this._renderWholeLineDecorations(nt,rt,mt),this._renderNormalDecorations(nt,rt,mt),this._renderResult=mt}_renderWholeLineDecorations(nt,ot,rt){const ut=String(this._lineHeight),gt=nt.visibleRange.startLineNumber,pt=nt.visibleRange.endLineNumber;for(let mt=0,vt=ot.length;mt<vt;mt++){const St=ot[mt];if(!St.options.isWholeLine)continue;const yt='<div class="cdr '+St.options.className+'" style="left:0;width:100%;height:'+ut+'px;"></div>',wt=Math.max(St.range.startLineNumber,gt),Lt=Math.min(St.range.endLineNumber,pt);for(let xt=wt;xt<=Lt;xt++){const It=xt-gt;rt[It]+=yt}}}_renderNormalDecorations(nt,ot,rt){const ut=String(this._lineHeight),gt=nt.visibleRange.startLineNumber;let pt=null,mt=!1,vt=null;for(let St=0,yt=ot.length;St<yt;St++){const wt=ot[St];if(wt.options.isWholeLine)continue;const Lt=wt.options.className,xt=!!wt.options.showIfCollapsed;let It=wt.range;if(xt&&It.endColumn===1&&It.endLineNumber!==It.startLineNumber&&(It=new Range$2(It.startLineNumber,It.startColumn,It.endLineNumber-1,this._context.viewModel.getLineMaxColumn(It.endLineNumber-1))),pt===Lt&&mt===xt&&Range$2.areIntersectingOrTouching(vt,It)){vt=Range$2.plusRange(vt,It);continue}pt!==null&&this._renderNormalDecoration(nt,vt,pt,mt,ut,gt,rt),pt=Lt,mt=xt,vt=It}pt!==null&&this._renderNormalDecoration(nt,vt,pt,mt,ut,gt,rt)}_renderNormalDecoration(nt,ot,rt,ut,gt,pt,mt){const vt=nt.linesVisibleRangesForRange(ot,rt==="findMatch");if(vt)for(let St=0,yt=vt.length;St<yt;St++){const wt=vt[St];if(wt.outsideRenderedLine)continue;const Lt=wt.lineNumber-pt;if(ut&&wt.ranges.length===1){const xt=wt.ranges[0];if(xt.width<this._typicalHalfwidthCharacterWidth){const It=Math.round(xt.left+xt.width/2),kt=Math.max(0,Math.round(It-this._typicalHalfwidthCharacterWidth/2));wt.ranges[0]=new HorizontalRange(kt,this._typicalHalfwidthCharacterWidth)}}for(let xt=0,It=wt.ranges.length;xt<It;xt++){const kt=wt.ranges[xt],At='<div class="cdr '+rt+'" style="left:'+String(kt.left)+"px;width:"+String(kt.width)+"px;height:"+gt+'px;"></div>';mt[Lt]+=At}}}render(nt,ot){if(!this._renderResult)return"";const rt=ot-nt;return rt<0||rt>=this._renderResult.length?"":this._renderResult[rt]}}class EditorScrollbar extends ViewPart{constructor(nt,ot,rt,ut){super(nt);const gt=this._context.configuration.options,pt=gt.get(98),mt=gt.get(72),vt=gt.get(38),St=gt.get(101),yt={listenOnDomNode:rt.domNode,className:"editor-scrollable "+getThemeTypeSelector(nt.theme.type),useShadows:!1,lazyRender:!0,vertical:pt.vertical,horizontal:pt.horizontal,verticalHasArrows:pt.verticalHasArrows,horizontalHasArrows:pt.horizontalHasArrows,verticalScrollbarSize:pt.verticalScrollbarSize,verticalSliderSize:pt.verticalSliderSize,horizontalScrollbarSize:pt.horizontalScrollbarSize,horizontalSliderSize:pt.horizontalSliderSize,handleMouseWheel:pt.handleMouseWheel,alwaysConsumeMouseWheel:pt.alwaysConsumeMouseWheel,arrowSize:pt.arrowSize,mouseWheelScrollSensitivity:mt,fastScrollSensitivity:vt,scrollPredominantAxis:St,scrollByPage:pt.scrollByPage};this.scrollbar=this._register(new SmoothScrollableElement(ot.domNode,yt,this._context.viewLayout.getScrollable())),PartFingerprints.write(this.scrollbar.getDomNode(),5),this.scrollbarDomNode=createFastDomNode(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const wt=(Lt,xt,It)=>{const kt={};if(xt){const At=Lt.scrollTop;At&&(kt.scrollTop=this._context.viewLayout.getCurrentScrollTop()+At,Lt.scrollTop=0)}if(It){const At=Lt.scrollLeft;At&&(kt.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+At,Lt.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(kt,1)};this._register(addDisposableListener(rt.domNode,"scroll",Lt=>wt(rt.domNode,!0,!0))),this._register(addDisposableListener(ot.domNode,"scroll",Lt=>wt(ot.domNode,!0,!1))),this._register(addDisposableListener(ut.domNode,"scroll",Lt=>wt(ut.domNode,!0,!1))),this._register(addDisposableListener(this.scrollbarDomNode.domNode,"scroll",Lt=>wt(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const nt=this._context.configuration.options,ot=nt.get(139);this.scrollbarDomNode.setLeft(ot.contentLeft),nt.get(70).side==="right"?this.scrollbarDomNode.setWidth(ot.contentWidth+ot.minimap.minimapWidth):this.scrollbarDomNode.setWidth(ot.contentWidth),this.scrollbarDomNode.setHeight(ot.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(nt){this.scrollbar.delegateVerticalScrollbarPointerDown(nt)}delegateScrollFromMouseWheelEvent(nt){this.scrollbar.delegateScrollFromMouseWheelEvent(nt)}onConfigurationChanged(nt){if(nt.hasChanged(98)||nt.hasChanged(72)||nt.hasChanged(38)){const ot=this._context.configuration.options,rt=ot.get(98),ut=ot.get(72),gt=ot.get(38),pt=ot.get(101),mt={vertical:rt.vertical,horizontal:rt.horizontal,verticalScrollbarSize:rt.verticalScrollbarSize,horizontalScrollbarSize:rt.horizontalScrollbarSize,scrollByPage:rt.scrollByPage,handleMouseWheel:rt.handleMouseWheel,mouseWheelScrollSensitivity:ut,fastScrollSensitivity:gt,scrollPredominantAxis:pt};this.scrollbar.updateOptions(mt)}return nt.hasChanged(139)&&this._setLayout(),!0}onScrollChanged(nt){return!0}onThemeChanged(nt){return this.scrollbar.updateClassName("editor-scrollable "+getThemeTypeSelector(this._context.theme.type)),!0}prepareRender(nt){}render(nt){this.scrollbar.renderNow()}}const glyphMargin="";class DecorationToRender{constructor(nt,ot,rt,ut,gt){this._decorationToRenderBrand=void 0,this.startLineNumber=+nt,this.endLineNumber=+ot,this.className=String(rt),this.zIndex=ut??0,this.decorationLane=gt??1}}class RenderedDecoration{constructor(nt,ot){this.className=nt,this.zIndex=ot}}class LineRenderedDecorations{constructor(){this.lanes=[]}add(nt,ot){for(;nt>=this.lanes.length;)this.lanes.push([]);this.lanes[nt].push(ot)}getLaneDecorations(nt){return nt<this.lanes.length?this.lanes[nt]:[]}isEmpty(){for(const nt of this.lanes)if(nt.length>0)return!1;return!0}}class DedupOverlay extends DynamicViewOverlay{_render(nt,ot,rt,ut){const gt=[];for(let vt=nt;vt<=ot;vt++){const St=vt-nt;gt[St]=new LineRenderedDecorations}if(rt.length===0)return gt;rt.sort((vt,St)=>vt.className===St.className?vt.startLineNumber===St.startLineNumber?vt.endLineNumber-St.endLineNumber:vt.startLineNumber-St.startLineNumber:vt.className<St.className?-1:1);let pt=null,mt=0;for(let vt=0,St=rt.length;vt<St;vt++){const yt=rt[vt],wt=yt.className,Lt=yt.zIndex;let xt=Math.max(yt.startLineNumber,nt)-nt;const It=Math.min(yt.endLineNumber,ot)-nt,kt=Math.min(yt.decorationLane,ut);pt===wt?(xt=Math.max(mt+1,xt),mt=Math.max(mt,It)):(pt=wt,mt=It);for(let At=xt;At<=mt;At++)gt[At].add(kt,new RenderedDecoration(wt,Lt))}return gt}}class GlyphMarginOverlay extends DedupOverlay{constructor(nt){super(),this._context=nt;const ot=this._context.configuration.options,rt=ot.get(139);this._lineHeight=ot.get(64),this._glyphMargin=ot.get(55),this._glyphMarginLeft=rt.glyphMarginLeft,this._glyphMarginWidth=rt.glyphMarginWidth,this._glyphMarginDecorationLaneCount=rt.glyphMarginDecorationLaneCount,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(nt){const ot=this._context.configuration.options,rt=ot.get(139);return this._lineHeight=ot.get(64),this._glyphMargin=ot.get(55),this._glyphMarginLeft=rt.glyphMarginLeft,this._glyphMarginWidth=rt.glyphMarginWidth,this._glyphMarginDecorationLaneCount=rt.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(nt){return!0}onFlushed(nt){return!0}onLinesChanged(nt){return!0}onLinesDeleted(nt){return!0}onLinesInserted(nt){return!0}onScrollChanged(nt){return nt.scrollTopChanged}onZonesChanged(nt){return!0}_getDecorations(nt){var ot;const rt=nt.getDecorationsInViewport(),ut=[];let gt=0;for(let pt=0,mt=rt.length;pt<mt;pt++){const vt=rt[pt],St=vt.options.glyphMarginClassName,yt=vt.options.zIndex,wt=(ot=vt.options.glyphMargin)===null||ot===void 0?void 0:ot.position;St&&(ut[gt++]=new DecorationToRender(vt.range.startLineNumber,vt.range.endLineNumber,St,yt,wt))}return ut}prepareRender(nt){if(!this._glyphMargin){this._renderResult=null;return}const ot=nt.visibleRange.startLineNumber,rt=nt.visibleRange.endLineNumber,ut=this._getDecorations(nt),gt=this._render(ot,rt,ut,this._glyphMarginDecorationLaneCount),pt=this._lineHeight.toString(),vt='" style="width:'+Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount).toString()+"px;height:"+pt+"px;",St=[];for(let yt=ot;yt<=rt;yt++){const wt=yt-ot,Lt=gt[wt];if(Lt.isEmpty())St[wt]="";else{let xt="";for(let It=1;It<=this._glyphMarginDecorationLaneCount;It+=1){const kt=Lt.getLaneDecorations(It);if(kt.length===0)continue;kt.sort((Nt,Pt)=>Pt.zIndex-Nt.zIndex);const At=kt[0],Tt=[At.className];for(let Nt=1;Nt<kt.length;Nt+=1){const Pt=kt[Nt];if(Pt.zIndex!==At.zIndex)break;Tt.push(Pt.className)}const Rt=(this._glyphMarginLeft+(It-1)*this._lineHeight).toString();xt+='<div class="cgmr codicon '+Tt.join(" ")+vt+"left:"+Rt+'px;"></div>'}St[wt]=xt}}this._renderResult=St}render(nt,ot){if(!this._renderResult)return"";const rt=ot-nt;return rt<0||rt>=this._renderResult.length?"":this._renderResult[rt]}}const indentGuides="";class TextModelPart extends Disposable{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function computeIndentLevel(ct,nt){let ot=0,rt=0;const ut=ct.length;for(;rt<ut;){const gt=ct.charCodeAt(rt);if(gt===32)ot++;else if(gt===9)ot=ot-ot%nt+nt;else break;rt++}return rt===ut?-1:ot}var HorizontalGuidesState;(function(ct){ct[ct.Disabled=0]="Disabled",ct[ct.EnabledForActive=1]="EnabledForActive",ct[ct.Enabled=2]="Enabled"})(HorizontalGuidesState||(HorizontalGuidesState={}));class IndentGuide{constructor(nt,ot,rt,ut,gt,pt){if(this.visibleColumn=nt,this.column=ot,this.className=rt,this.horizontalLine=ut,this.forWrappedLinesAfterColumn=gt,this.forWrappedLinesBeforeOrAtColumn=pt,nt!==-1==(ot!==-1))throw new Error}}class IndentGuideHorizontalLine{constructor(nt,ot){this.top=nt,this.endColumn=ot}}class GuidesTextModelPart extends TextModelPart{constructor(nt,ot){super(),this.textModel=nt,this.languageConfigurationService=ot}getLanguageConfiguration(nt){return this.languageConfigurationService.getLanguageConfiguration(nt)}_computeIndentLevel(nt){return computeIndentLevel(this.textModel.getLineContent(nt+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(nt,ot,rt){this.assertNotDisposed();const ut=this.textModel.getLineCount();if(nt<1||nt>ut)throw new Error("Illegal value for lineNumber");const gt=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,pt=!!(gt&&gt.offSide);let mt=-2,vt=-1,St=-2,yt=-1;const wt=Bt=>{if(mt!==-1&&(mt===-2||mt>Bt-1)){mt=-1,vt=-1;for(let Ut=Bt-2;Ut>=0;Ut--){const qt=this._computeIndentLevel(Ut);if(qt>=0){mt=Ut,vt=qt;break}}}if(St===-2){St=-1,yt=-1;for(let Ut=Bt;Ut<ut;Ut++){const qt=this._computeIndentLevel(Ut);if(qt>=0){St=Ut,yt=qt;break}}}};let Lt=-2,xt=-1,It=-2,kt=-1;const At=Bt=>{if(Lt===-2){Lt=-1,xt=-1;for(let Ut=Bt-2;Ut>=0;Ut--){const qt=this._computeIndentLevel(Ut);if(qt>=0){Lt=Ut,xt=qt;break}}}if(It!==-1&&(It===-2||It<Bt-1)){It=-1,kt=-1;for(let Ut=Bt;Ut<ut;Ut++){const qt=this._computeIndentLevel(Ut);if(qt>=0){It=Ut,kt=qt;break}}}};let Tt=0,Rt=!0,Nt=0,Pt=!0,Ft=0,Kt=0;for(let Bt=0;Rt||Pt;Bt++){const Ut=nt-Bt,qt=nt+Bt;Bt>1&&(Ut<1||Ut<ot)&&(Rt=!1),Bt>1&&(qt>ut||qt>rt)&&(Pt=!1),Bt>5e4&&(Rt=!1,Pt=!1);let Yt=-1;if(Rt&&Ut>=1){const Xt=this._computeIndentLevel(Ut-1);Xt>=0?(St=Ut-1,yt=Xt,Yt=Math.ceil(Xt/this.textModel.getOptions().indentSize)):(wt(Ut),Yt=this._getIndentLevelForWhitespaceLine(pt,vt,yt))}let Zt=-1;if(Pt&&qt<=ut){const Xt=this._computeIndentLevel(qt-1);Xt>=0?(Lt=qt-1,xt=Xt,Zt=Math.ceil(Xt/this.textModel.getOptions().indentSize)):(At(qt),Zt=this._getIndentLevelForWhitespaceLine(pt,xt,kt))}if(Bt===0){Kt=Yt;continue}if(Bt===1){if(qt<=ut&&Zt>=0&&Kt+1===Zt){Rt=!1,Tt=qt,Nt=qt,Ft=Zt;continue}if(Ut>=1&&Yt>=0&&Yt-1===Kt){Pt=!1,Tt=Ut,Nt=Ut,Ft=Yt;continue}if(Tt=nt,Nt=nt,Ft=Kt,Ft===0)return{startLineNumber:Tt,endLineNumber:Nt,indent:Ft}}Rt&&(Yt>=Ft?Tt=Ut:Rt=!1),Pt&&(Zt>=Ft?Nt=qt:Pt=!1)}return{startLineNumber:Tt,endLineNumber:Nt,indent:Ft}}getLinesBracketGuides(nt,ot,rt,ut){var gt;const pt=[];for(let Lt=nt;Lt<=ot;Lt++)pt.push([]);const mt=!0,vt=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new Range$2(nt,1,ot,this.textModel.getLineMaxColumn(ot))).toArray();let St;if(rt&&vt.length>0){const Lt=(nt<=rt.lineNumber&&rt.lineNumber<=ot?vt:this.textModel.bracketPairs.getBracketPairsInRange(Range$2.fromPositions(rt)).toArray()).filter(xt=>Range$2.strictContainsPosition(xt.range,rt));St=(gt=findLast(Lt,xt=>mt))===null||gt===void 0?void 0:gt.range}const yt=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,wt=new BracketPairGuidesClassNames;for(const Lt of vt){if(!Lt.closingBracketRange)continue;const xt=St&&Lt.range.equalsRange(St);if(!xt&&!ut.includeInactive)continue;const It=wt.getInlineClassName(Lt.nestingLevel,Lt.nestingLevelOfEqualBracketType,yt)+(ut.highlightActive&&xt?" "+wt.activeClassName:""),kt=Lt.openingBracketRange.getStartPosition(),At=Lt.closingBracketRange.getStartPosition(),Tt=ut.horizontalGuides===HorizontalGuidesState.Enabled||ut.horizontalGuides===HorizontalGuidesState.EnabledForActive&&xt;if(Lt.range.startLineNumber===Lt.range.endLineNumber){Tt&&pt[Lt.range.startLineNumber-nt].push(new IndentGuide(-1,Lt.openingBracketRange.getEndPosition().column,It,new IndentGuideHorizontalLine(!1,At.column),-1,-1));continue}const Rt=this.getVisibleColumnFromPosition(At),Nt=this.getVisibleColumnFromPosition(Lt.openingBracketRange.getStartPosition()),Pt=Math.min(Nt,Rt,Lt.minVisibleColumnIndentation+1);let Ft=!1;firstNonWhitespaceIndex(this.textModel.getLineContent(Lt.closingBracketRange.startLineNumber))<Lt.closingBracketRange.startColumn-1&&(Ft=!0);const Ut=Math.max(kt.lineNumber,nt),qt=Math.min(At.lineNumber,ot),Yt=Ft?1:0;for(let Zt=Ut;Zt<qt+Yt;Zt++)pt[Zt-nt].push(new IndentGuide(Pt,-1,It,null,Zt===kt.lineNumber?kt.column:-1,Zt===At.lineNumber?At.column:-1));Tt&&(kt.lineNumber>=nt&&Nt>Pt&&pt[kt.lineNumber-nt].push(new IndentGuide(Pt,-1,It,new IndentGuideHorizontalLine(!1,kt.column),-1,-1)),At.lineNumber<=ot&&Rt>Pt&&pt[At.lineNumber-nt].push(new IndentGuide(Pt,-1,It,new IndentGuideHorizontalLine(!Ft,At.column),-1,-1)))}for(const Lt of pt)Lt.sort((xt,It)=>xt.visibleColumn-It.visibleColumn);return pt}getVisibleColumnFromPosition(nt){return CursorColumns.visibleColumnFromColumn(this.textModel.getLineContent(nt.lineNumber),nt.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(nt,ot){this.assertNotDisposed();const rt=this.textModel.getLineCount();if(nt<1||nt>rt)throw new Error("Illegal value for startLineNumber");if(ot<1||ot>rt)throw new Error("Illegal value for endLineNumber");const ut=this.textModel.getOptions(),gt=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,pt=!!(gt&&gt.offSide),mt=new Array(ot-nt+1);let vt=-2,St=-1,yt=-2,wt=-1;for(let Lt=nt;Lt<=ot;Lt++){const xt=Lt-nt,It=this._computeIndentLevel(Lt-1);if(It>=0){vt=Lt-1,St=It,mt[xt]=Math.ceil(It/ut.indentSize);continue}if(vt===-2){vt=-1,St=-1;for(let kt=Lt-2;kt>=0;kt--){const At=this._computeIndentLevel(kt);if(At>=0){vt=kt,St=At;break}}}if(yt!==-1&&(yt===-2||yt<Lt-1)){yt=-1,wt=-1;for(let kt=Lt;kt<rt;kt++){const At=this._computeIndentLevel(kt);if(At>=0){yt=kt,wt=At;break}}}mt[xt]=this._getIndentLevelForWhitespaceLine(pt,St,wt)}return mt}_getIndentLevelForWhitespaceLine(nt,ot,rt){const ut=this.textModel.getOptions();return ot===-1||rt===-1?0:ot<rt?1+Math.floor(ot/ut.indentSize):ot===rt||nt?Math.ceil(rt/ut.indentSize):1+Math.floor(rt/ut.indentSize)}}class BracketPairGuidesClassNames{constructor(){this.activeClassName="indent-active"}getInlineClassName(nt,ot,rt){return this.getInlineClassNameOfLevel(rt?ot:nt)}getInlineClassNameOfLevel(nt){return`bracket-indent-guide lvl-${nt%30}`}}class IndentGuidesOverlay extends DynamicViewOverlay{constructor(nt){super(),this._context=nt,this._primaryPosition=null;const ot=this._context.configuration.options,rt=ot.get(140),ut=ot.get(48);this._lineHeight=ot.get(64),this._spaceWidth=ut.spaceWidth,this._maxIndentLeft=rt.wrappingColumn===-1?-1:rt.wrappingColumn*ut.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=ot.get(14),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(nt){const ot=this._context.configuration.options,rt=ot.get(140),ut=ot.get(48);return this._lineHeight=ot.get(64),this._spaceWidth=ut.spaceWidth,this._maxIndentLeft=rt.wrappingColumn===-1?-1:rt.wrappingColumn*ut.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=ot.get(14),!0}onCursorStateChanged(nt){var ot;const ut=nt.selections[0].getPosition();return!((ot=this._primaryPosition)===null||ot===void 0)&&ot.equals(ut)?!1:(this._primaryPosition=ut,!0)}onDecorationsChanged(nt){return!0}onFlushed(nt){return!0}onLinesChanged(nt){return!0}onLinesDeleted(nt){return!0}onLinesInserted(nt){return!0}onScrollChanged(nt){return nt.scrollTopChanged}onZonesChanged(nt){return!0}onLanguageConfigurationChanged(nt){return!0}prepareRender(nt){var ot,rt,ut,gt;if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}const pt=nt.visibleRange.startLineNumber,mt=nt.visibleRange.endLineNumber,vt=nt.scrollWidth,St=this._lineHeight,yt=this._primaryPosition,wt=this.getGuidesByLine(pt,Math.min(mt+1,this._context.viewModel.getLineCount()),yt),Lt=[];for(let xt=pt;xt<=mt;xt++){const It=xt-pt,kt=wt[It];let At="";const Tt=(rt=(ot=nt.visibleRangeForPosition(new Position$1(xt,1)))===null||ot===void 0?void 0:ot.left)!==null&&rt!==void 0?rt:0;for(const Rt of kt){const Nt=Rt.column===-1?Tt+(Rt.visibleColumn-1)*this._spaceWidth:nt.visibleRangeForPosition(new Position$1(xt,Rt.column)).left;if(Nt>vt||this._maxIndentLeft>0&&Nt>this._maxIndentLeft)break;const Pt=Rt.horizontalLine?Rt.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",Ft=Rt.horizontalLine?((gt=(ut=nt.visibleRangeForPosition(new Position$1(xt,Rt.horizontalLine.endColumn)))===null||ut===void 0?void 0:ut.left)!==null&&gt!==void 0?gt:Nt+this._spaceWidth)-Nt:this._spaceWidth;At+=`<div class="core-guide ${Rt.className} ${Pt}" style="left:${Nt}px;height:${St}px;width:${Ft}px"></div>`}Lt[It]=At}this._renderResult=Lt}getGuidesByLine(nt,ot,rt){const ut=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(nt,ot,rt,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?HorizontalGuidesState.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?HorizontalGuidesState.EnabledForActive:HorizontalGuidesState.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,gt=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(nt,ot):null;let pt=0,mt=0,vt=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&rt){const wt=this._context.viewModel.getActiveIndentGuide(rt.lineNumber,nt,ot);pt=wt.startLineNumber,mt=wt.endLineNumber,vt=wt.indent}const{indentSize:St}=this._context.viewModel.model.getOptions(),yt=[];for(let wt=nt;wt<=ot;wt++){const Lt=new Array;yt.push(Lt);const xt=ut?ut[wt-nt]:[],It=new ArrayQueue(xt),kt=gt?gt[wt-nt]:0;for(let At=1;At<=kt;At++){const Tt=(At-1)*St+1,Rt=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||xt.length===0)&&pt<=wt&&wt<=mt&&At===vt;Lt.push(...It.takeWhile(Pt=>Pt.visibleColumn<Tt)||[]);const Nt=It.peek();(!Nt||Nt.visibleColumn!==Tt||Nt.horizontalLine)&&Lt.push(new IndentGuide(Tt,-1,Rt?"core-guide-indent-active":"core-guide-indent",null,-1,-1))}Lt.push(...It.takeWhile(At=>!0)||[])}return yt}render(nt,ot){if(!this._renderResult)return"";const rt=ot-nt;return rt<0||rt>=this._renderResult.length?"":this._renderResult[rt]}}function transparentToUndefined(ct){if(!(ct&&ct.isTransparent()))return ct}registerThemingParticipant((ct,nt)=>{const ot=[{bracketColor:editorBracketHighlightingForeground1,guideColor:editorBracketPairGuideBackground1,guideColorActive:editorBracketPairGuideActiveBackground1},{bracketColor:editorBracketHighlightingForeground2,guideColor:editorBracketPairGuideBackground2,guideColorActive:editorBracketPairGuideActiveBackground2},{bracketColor:editorBracketHighlightingForeground3,guideColor:editorBracketPairGuideBackground3,guideColorActive:editorBracketPairGuideActiveBackground3},{bracketColor:editorBracketHighlightingForeground4,guideColor:editorBracketPairGuideBackground4,guideColorActive:editorBracketPairGuideActiveBackground4},{bracketColor:editorBracketHighlightingForeground5,guideColor:editorBracketPairGuideBackground5,guideColorActive:editorBracketPairGuideActiveBackground5},{bracketColor:editorBracketHighlightingForeground6,guideColor:editorBracketPairGuideBackground6,guideColorActive:editorBracketPairGuideActiveBackground6}],rt=new BracketPairGuidesClassNames,ut=ot.map(gt=>{var pt,mt;const vt=ct.getColor(gt.bracketColor),St=ct.getColor(gt.guideColor),yt=ct.getColor(gt.guideColorActive),wt=transparentToUndefined((pt=transparentToUndefined(St))!==null&&pt!==void 0?pt:vt==null?void 0:vt.transparent(.3)),Lt=transparentToUndefined((mt=transparentToUndefined(yt))!==null&&mt!==void 0?mt:vt);if(!(!wt||!Lt))return{guideColor:wt,guideColorActive:Lt}}).filter(isDefined);if(ut.length>0){for(let gt=0;gt<30;gt++){const pt=ut[gt%ut.length];nt.addRule(`.monaco-editor .${rt.getInlineClassNameOfLevel(gt).replace(/ /g,".")} { --guide-color: ${pt.guideColor}; --guide-color-active: ${pt.guideColorActive}; }`)}nt.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),nt.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),nt.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),nt.addRule(`.monaco-editor .vertical.${rt.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),nt.addRule(`.monaco-editor .horizontal-top.${rt.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),nt.addRule(`.monaco-editor .horizontal-bottom.${rt.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}});const viewLines="";class DomReadingContext{get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const nt=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=nt.left,this._clientRectScale=nt.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}constructor(nt,ot){this._domNode=nt,this.endNode=ot,this._didDomLayout=!1,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1}markDidDomLayout(){this._didDomLayout=!0}}class LastRenderedData{constructor(){this._currentVisibleRange=new Range$2(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(nt){this._currentVisibleRange=nt}}class HorizontalRevealRangeRequest{constructor(nt,ot,rt,ut,gt,pt,mt){this.minimalReveal=nt,this.lineNumber=ot,this.startColumn=rt,this.endColumn=ut,this.startScrollTop=gt,this.stopScrollTop=pt,this.scrollType=mt,this.type="range",this.minLineNumber=ot,this.maxLineNumber=ot}}class HorizontalRevealSelectionsRequest{constructor(nt,ot,rt,ut,gt){this.minimalReveal=nt,this.selections=ot,this.startScrollTop=rt,this.stopScrollTop=ut,this.scrollType=gt,this.type="selections";let pt=ot[0].startLineNumber,mt=ot[0].endLineNumber;for(let vt=1,St=ot.length;vt<St;vt++){const yt=ot[vt];pt=Math.min(pt,yt.startLineNumber),mt=Math.max(mt,yt.endLineNumber)}this.minLineNumber=pt,this.maxLineNumber=mt}}class ViewLines extends ViewPart{constructor(nt,ot){super(nt),this._linesContent=ot,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new VisibleLinesCollection(this),this.domNode=this._visibleLines.domNode;const rt=this._context.configuration,ut=this._context.configuration.options,gt=ut.get(48),pt=ut.get(140);this._lineHeight=ut.get(64),this._typicalHalfwidthCharacterWidth=gt.typicalHalfwidthCharacterWidth,this._isViewportWrapping=pt.isViewportWrapping,this._revealHorizontalRightPadding=ut.get(95),this._cursorSurroundingLines=ut.get(27),this._cursorSurroundingLinesStyle=ut.get(28),this._canUseLayerHinting=!ut.get(30),this._viewLineOptions=new ViewLineOptions(rt,this._context.theme.type),PartFingerprints.write(this.domNode,7),this.domNode.setClassName(`view-lines ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),applyFontInfo(this.domNode,gt),this._maxLineWidth=0,this._asyncUpdateLineWidths=new RunOnceScheduler(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new RunOnceScheduler(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new LastRenderedData,this._horizontalRevealRequest=null,this._stickyScrollEnabled=ut.get(110).enabled,this._maxNumberStickyLines=ut.get(110).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}createVisibleLine(){return new ViewLine(this._viewLineOptions)}onConfigurationChanged(nt){this._visibleLines.onConfigurationChanged(nt),nt.hasChanged(140)&&(this._maxLineWidth=0);const ot=this._context.configuration.options,rt=ot.get(48),ut=ot.get(140);return this._lineHeight=ot.get(64),this._typicalHalfwidthCharacterWidth=rt.typicalHalfwidthCharacterWidth,this._isViewportWrapping=ut.isViewportWrapping,this._revealHorizontalRightPadding=ot.get(95),this._cursorSurroundingLines=ot.get(27),this._cursorSurroundingLinesStyle=ot.get(28),this._canUseLayerHinting=!ot.get(30),this._stickyScrollEnabled=ot.get(110).enabled,this._maxNumberStickyLines=ot.get(110).maxLineCount,applyFontInfo(this.domNode,rt),this._onOptionsMaybeChanged(),nt.hasChanged(139)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const nt=this._context.configuration,ot=new ViewLineOptions(nt,this._context.theme.type);if(!this._viewLineOptions.equals(ot)){this._viewLineOptions=ot;const rt=this._visibleLines.getStartLineNumber(),ut=this._visibleLines.getEndLineNumber();for(let gt=rt;gt<=ut;gt++)this._visibleLines.getVisibleLine(gt).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(nt){const ot=this._visibleLines.getStartLineNumber(),rt=this._visibleLines.getEndLineNumber();let ut=!1;for(let gt=ot;gt<=rt;gt++)ut=this._visibleLines.getVisibleLine(gt).onSelectionChanged()||ut;return ut}onDecorationsChanged(nt){{const ot=this._visibleLines.getStartLineNumber(),rt=this._visibleLines.getEndLineNumber();for(let ut=ot;ut<=rt;ut++)this._visibleLines.getVisibleLine(ut).onDecorationsChanged()}return!0}onFlushed(nt){const ot=this._visibleLines.onFlushed(nt);return this._maxLineWidth=0,ot}onLinesChanged(nt){return this._visibleLines.onLinesChanged(nt)}onLinesDeleted(nt){return this._visibleLines.onLinesDeleted(nt)}onLinesInserted(nt){return this._visibleLines.onLinesInserted(nt)}onRevealRangeRequest(nt){const ot=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),nt.source,nt.minimalReveal,nt.range,nt.selections,nt.verticalType);if(ot===-1)return!1;let rt=this._context.viewLayout.validateScrollPosition({scrollTop:ot});nt.revealHorizontal?nt.range&&nt.range.startLineNumber!==nt.range.endLineNumber?rt={scrollTop:rt.scrollTop,scrollLeft:0}:nt.range?this._horizontalRevealRequest=new HorizontalRevealRangeRequest(nt.minimalReveal,nt.range.startLineNumber,nt.range.startColumn,nt.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),rt.scrollTop,nt.scrollType):nt.selections&&nt.selections.length>0&&(this._horizontalRevealRequest=new HorizontalRevealSelectionsRequest(nt.minimalReveal,nt.selections,this._context.viewLayout.getCurrentScrollTop(),rt.scrollTop,nt.scrollType)):this._horizontalRevealRequest=null;const gt=Math.abs(this._context.viewLayout.getCurrentScrollTop()-rt.scrollTop)<=this._lineHeight?1:nt.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(rt,gt),!0}onScrollChanged(nt){if(this._horizontalRevealRequest&&nt.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&nt.scrollTopChanged){const ot=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),rt=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(nt.scrollTop<ot||nt.scrollTop>rt)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(nt.scrollWidth),this._visibleLines.onScrollChanged(nt)||!0}onTokensChanged(nt){return this._visibleLines.onTokensChanged(nt)}onZonesChanged(nt){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(nt)}onThemeChanged(nt){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(nt,ot){const rt=this._getViewLineDomNode(nt);if(rt===null)return null;const ut=this._getLineNumberFor(rt);if(ut===-1||ut<1||ut>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(ut)===1)return new Position$1(ut,1);const gt=this._visibleLines.getStartLineNumber(),pt=this._visibleLines.getEndLineNumber();if(ut<gt||ut>pt)return null;let mt=this._visibleLines.getVisibleLine(ut).getColumnOfNodeOffset(ut,nt,ot);const vt=this._context.viewModel.getLineMinColumn(ut);return mt<vt&&(mt=vt),new Position$1(ut,mt)}_getViewLineDomNode(nt){for(;nt&&nt.nodeType===1;){if(nt.className===ViewLine.CLASS_NAME)return nt;nt=nt.parentElement}return null}_getLineNumberFor(nt){const ot=this._visibleLines.getStartLineNumber(),rt=this._visibleLines.getEndLineNumber();for(let ut=ot;ut<=rt;ut++){const gt=this._visibleLines.getVisibleLine(ut);if(nt===gt.getDomNode())return ut}return-1}getLineWidth(nt){const ot=this._visibleLines.getStartLineNumber(),rt=this._visibleLines.getEndLineNumber();if(nt<ot||nt>rt)return-1;const ut=new DomReadingContext(this.domNode.domNode,this._textRangeRestingSpot),gt=this._visibleLines.getVisibleLine(nt).getWidth(ut);return this._updateLineWidthsSlowIfDomDidLayout(ut),gt}linesVisibleRangesForRange(nt,ot){if(this.shouldRender())return null;const rt=nt.endLineNumber,ut=Range$2.intersectRanges(nt,this._lastRenderedData.getCurrentVisibleRange());if(!ut)return null;const gt=[];let pt=0;const mt=new DomReadingContext(this.domNode.domNode,this._textRangeRestingSpot);let vt=0;ot&&(vt=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(ut.startLineNumber,1)).lineNumber);const St=this._visibleLines.getStartLineNumber(),yt=this._visibleLines.getEndLineNumber();for(let wt=ut.startLineNumber;wt<=ut.endLineNumber;wt++){if(wt<St||wt>yt)continue;const Lt=wt===ut.startLineNumber?ut.startColumn:1,xt=wt===ut.endLineNumber?ut.endColumn:this._context.viewModel.getLineMaxColumn(wt),It=this._visibleLines.getVisibleLine(wt).getVisibleRangesForRange(wt,Lt,xt,mt);if(It){if(ot&&wt<rt){const kt=vt;vt=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(wt+1,1)).lineNumber,kt!==vt&&(It.ranges[It.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}gt[pt++]=new LineVisibleRanges(It.outsideRenderedLine,wt,HorizontalRange.from(It.ranges))}}return this._updateLineWidthsSlowIfDomDidLayout(mt),pt===0?null:gt}_visibleRangesForLineRange(nt,ot,rt){if(this.shouldRender()||nt<this._visibleLines.getStartLineNumber()||nt>this._visibleLines.getEndLineNumber())return null;const ut=new DomReadingContext(this.domNode.domNode,this._textRangeRestingSpot),gt=this._visibleLines.getVisibleLine(nt).getVisibleRangesForRange(nt,ot,rt,ut);return this._updateLineWidthsSlowIfDomDidLayout(ut),gt}visibleRangeForPosition(nt){const ot=this._visibleRangesForLineRange(nt.lineNumber,nt.column,nt.column);return ot?new HorizontalPosition(ot.outsideRenderedLine,ot.ranges[0].left):null}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(nt){nt.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(nt){const ot=this._visibleLines.getStartLineNumber(),rt=this._visibleLines.getEndLineNumber();let ut=1,gt=!0;for(let pt=ot;pt<=rt;pt++){const mt=this._visibleLines.getVisibleLine(pt);if(nt&&!mt.getWidthIsFast()){gt=!1;continue}ut=Math.max(ut,mt.getWidth(null))}return gt&&ot===1&&rt===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(ut),gt}_checkMonospaceFontAssumptions(){let nt=-1,ot=-1;const rt=this._visibleLines.getStartLineNumber(),ut=this._visibleLines.getEndLineNumber();for(let gt=rt;gt<=ut;gt++){const pt=this._visibleLines.getVisibleLine(gt);if(pt.needsMonospaceFontCheck()){const mt=pt.getWidth(null);mt>ot&&(ot=mt,nt=gt)}}if(nt!==-1&&!this._visibleLines.getVisibleLine(nt).monospaceAssumptionsAreValid())for(let gt=rt;gt<=ut;gt++)this._visibleLines.getVisibleLine(gt).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(nt){if(this._visibleLines.renderLines(nt),this._lastRenderedData.setCurrentVisibleRange(nt.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const rt=this._horizontalRevealRequest;if(nt.startLineNumber<=rt.minLineNumber&&rt.maxLineNumber<=nt.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const ut=this._computeScrollLeftToReveal(rt);ut&&(this._isViewportWrapping||this._ensureMaxLineWidth(ut.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:ut.scrollLeft},rt.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),isLinux&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const rt=this._visibleLines.getStartLineNumber(),ut=this._visibleLines.getEndLineNumber();for(let gt=rt;gt<=ut;gt++)if(this._visibleLines.getVisibleLine(gt).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const ot=this._context.viewLayout.getCurrentScrollTop()-nt.bigNumbersDelta;this._linesContent.setTop(-ot),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(nt){const ot=Math.ceil(nt);this._maxLineWidth<ot&&(this._maxLineWidth=ot,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(nt,ot,rt,ut,gt,pt){const mt=nt.top,vt=nt.height,St=mt+vt;let yt,wt,Lt;if(gt&&gt.length>0){let Tt=gt[0].startLineNumber,Rt=gt[0].endLineNumber;for(let Nt=1,Pt=gt.length;Nt<Pt;Nt++){const Ft=gt[Nt];Tt=Math.min(Tt,Ft.startLineNumber),Rt=Math.max(Rt,Ft.endLineNumber)}yt=!1,wt=this._context.viewLayout.getVerticalOffsetForLineNumber(Tt),Lt=this._context.viewLayout.getVerticalOffsetForLineNumber(Rt)+this._lineHeight}else if(ut)yt=!0,wt=this._context.viewLayout.getVerticalOffsetForLineNumber(ut.startLineNumber),Lt=this._context.viewLayout.getVerticalOffsetForLineNumber(ut.endLineNumber)+this._lineHeight;else return-1;const xt=(ot==="mouse"||rt)&&this._cursorSurroundingLinesStyle==="default";let It=0,kt=0;if(xt)rt||(It=this._lineHeight);else{const Tt=Math.min(vt/this._lineHeight/2,this._cursorSurroundingLines);this._stickyScrollEnabled?It=Math.max(Tt,this._maxNumberStickyLines)*this._lineHeight:It=Tt*this._lineHeight,kt=Math.max(0,Tt-1)*this._lineHeight}rt||(pt===0||pt===4)&&(kt+=this._lineHeight),wt-=It,Lt+=kt;let At;if(Lt-wt>vt){if(!yt)return-1;At=wt}else if(pt===5||pt===6)if(pt===6&&mt<=wt&&Lt<=St)At=mt;else{const Tt=Math.max(5*this._lineHeight,vt*.2),Rt=wt-Tt,Nt=Lt-vt;At=Math.max(Nt,Rt)}else if(pt===1||pt===2)if(pt===2&&mt<=wt&&Lt<=St)At=mt;else{const Tt=(wt+Lt)/2;At=Math.max(0,Tt-vt/2)}else At=this._computeMinimumScrolling(mt,St,wt,Lt,pt===3,pt===4);return At}_computeScrollLeftToReveal(nt){const ot=this._context.viewLayout.getCurrentViewport(),rt=this._context.configuration.options.get(139),ut=ot.left,gt=ut+ot.width-rt.verticalScrollbarWidth;let pt=1073741824,mt=0;if(nt.type==="range"){const St=this._visibleRangesForLineRange(nt.lineNumber,nt.startColumn,nt.endColumn);if(!St)return null;for(const yt of St.ranges)pt=Math.min(pt,Math.round(yt.left)),mt=Math.max(mt,Math.round(yt.left+yt.width))}else for(const St of nt.selections){if(St.startLineNumber!==St.endLineNumber)return null;const yt=this._visibleRangesForLineRange(St.startLineNumber,St.startColumn,St.endColumn);if(!yt)return null;for(const wt of yt.ranges)pt=Math.min(pt,Math.round(wt.left)),mt=Math.max(mt,Math.round(wt.left+wt.width))}return nt.minimalReveal||(pt=Math.max(0,pt-ViewLines.HORIZONTAL_EXTRA_PX),mt+=this._revealHorizontalRightPadding),nt.type==="selections"&&mt-pt>ot.width?null:{scrollLeft:this._computeMinimumScrolling(ut,gt,pt,mt),maxHorizontalOffset:mt}}_computeMinimumScrolling(nt,ot,rt,ut,gt,pt){nt=nt|0,ot=ot|0,rt=rt|0,ut=ut|0,gt=!!gt,pt=!!pt;const mt=ot-nt;if(ut-rt<mt){if(gt)return rt;if(pt)return Math.max(0,ut-mt);if(rt<nt)return rt;if(ut>ot)return Math.max(0,ut-mt)}else return rt;return nt}}ViewLines.HORIZONTAL_EXTRA_PX=30;const linesDecorations="";class LinesDecorationsOverlay extends DedupOverlay{constructor(nt){super(),this._context=nt;const rt=this._context.configuration.options.get(139);this._decorationsLeft=rt.decorationsLeft,this._decorationsWidth=rt.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(nt){const rt=this._context.configuration.options.get(139);return this._decorationsLeft=rt.decorationsLeft,this._decorationsWidth=rt.decorationsWidth,!0}onDecorationsChanged(nt){return!0}onFlushed(nt){return!0}onLinesChanged(nt){return!0}onLinesDeleted(nt){return!0}onLinesInserted(nt){return!0}onScrollChanged(nt){return nt.scrollTopChanged}onZonesChanged(nt){return!0}_getDecorations(nt){const ot=nt.getDecorationsInViewport(),rt=[];let ut=0;for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt],vt=mt.options.linesDecorationsClassName,St=mt.options.zIndex;vt&&(rt[ut++]=new DecorationToRender(mt.range.startLineNumber,mt.range.endLineNumber,vt,St));const yt=mt.options.firstLineDecorationClassName;yt&&(rt[ut++]=new DecorationToRender(mt.range.startLineNumber,mt.range.startLineNumber,yt,St))}return rt}prepareRender(nt){const ot=nt.visibleRange.startLineNumber,rt=nt.visibleRange.endLineNumber,ut=this._render(ot,rt,this._getDecorations(nt),1),gt=this._decorationsLeft.toString(),pt=this._decorationsWidth.toString(),mt='" style="left:'+gt+"px;width:"+pt+'px;"></div>',vt=[];for(let St=ot;St<=rt;St++){const yt=St-ot,wt=ut[yt].getLaneDecorations(1);let Lt="";for(const xt of wt)Lt+='<div class="cldr '+xt.className+mt;vt[yt]=Lt}this._renderResult=vt}render(nt,ot){return this._renderResult?this._renderResult[ot-nt]:""}}const marginDecorations="";class MarginViewLineDecorationsOverlay extends DedupOverlay{constructor(nt){super(),this._context=nt,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(nt){return!0}onDecorationsChanged(nt){return!0}onFlushed(nt){return!0}onLinesChanged(nt){return!0}onLinesDeleted(nt){return!0}onLinesInserted(nt){return!0}onScrollChanged(nt){return nt.scrollTopChanged}onZonesChanged(nt){return!0}_getDecorations(nt){const ot=nt.getDecorationsInViewport(),rt=[];let ut=0;for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt],vt=mt.options.marginClassName,St=mt.options.zIndex;vt&&(rt[ut++]=new DecorationToRender(mt.range.startLineNumber,mt.range.endLineNumber,vt,St))}return rt}prepareRender(nt){const ot=nt.visibleRange.startLineNumber,rt=nt.visibleRange.endLineNumber,ut=this._render(ot,rt,this._getDecorations(nt),1),gt=[];for(let pt=ot;pt<=rt;pt++){const mt=pt-ot,vt=ut[mt].getLaneDecorations(1);let St="";for(const yt of vt)St+='<div class="cmdr '+yt.className+'" style=""></div>';gt[mt]=St}this._renderResult=gt}render(nt,ot){return this._renderResult?this._renderResult[ot-nt]:""}}const minimap="";class RGBA8{constructor(nt,ot,rt,ut){this._rgba8Brand=void 0,this.r=RGBA8._clamp(nt),this.g=RGBA8._clamp(ot),this.b=RGBA8._clamp(rt),this.a=RGBA8._clamp(ut)}equals(nt){return this.r===nt.r&&this.g===nt.g&&this.b===nt.b&&this.a===nt.a}static _clamp(nt){return nt<0?0:nt>255?255:nt|0}}RGBA8.Empty=new RGBA8(0,0,0,0);class MinimapTokensColorTracker extends Disposable{static getInstance(){return this._INSTANCE||(this._INSTANCE=new MinimapTokensColorTracker),this._INSTANCE}constructor(){super(),this._onDidChange=new Emitter$2,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(TokenizationRegistry.onDidChange(nt=>{nt.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){const nt=TokenizationRegistry.getColorMap();if(!nt){this._colors=[RGBA8.Empty],this._backgroundIsLight=!0;return}this._colors=[RGBA8.Empty];for(let rt=1;rt<nt.length;rt++){const ut=nt[rt].rgba;this._colors[rt]=new RGBA8(ut.r,ut.g,ut.b,Math.round(ut.a*255))}const ot=nt[2].getRelativeLuminance();this._backgroundIsLight=ot>=.5,this._onDidChange.fire(void 0)}getColor(nt){return(nt<1||nt>=this._colors.length)&&(nt=2),this._colors[nt]}backgroundIsLight(){return this._backgroundIsLight}}MinimapTokensColorTracker._INSTANCE=null;const allCharCodes=(()=>{const ct=[];for(let nt=32;nt<=126;nt++)ct.push(nt);return ct.push(65533),ct})(),getCharIndex=(ct,nt)=>(ct-=32,ct<0||ct>96?nt<=2?(ct+96)%96:96-1:ct);class MinimapCharRenderer{constructor(nt,ot){this.scale=ot,this._minimapCharRendererBrand=void 0,this.charDataNormal=MinimapCharRenderer.soften(nt,12/15),this.charDataLight=MinimapCharRenderer.soften(nt,50/60)}static soften(nt,ot){const rt=new Uint8ClampedArray(nt.length);for(let ut=0,gt=nt.length;ut<gt;ut++)rt[ut]=toUint8(nt[ut]*ot);return rt}renderChar(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt){const Lt=1*this.scale,xt=2*this.scale,It=wt?1:xt;if(ot+Lt>nt.width||rt+It>nt.height){console.warn("bad render request outside image data");return}const kt=yt?this.charDataLight:this.charDataNormal,At=getCharIndex(ut,St),Tt=nt.width*4,Rt=mt.r,Nt=mt.g,Pt=mt.b,Ft=gt.r-Rt,Kt=gt.g-Nt,Bt=gt.b-Pt,Ut=Math.max(pt,vt),qt=nt.data;let Yt=At*Lt*xt,Zt=rt*Tt+ot*4;for(let Xt=0;Xt<It;Xt++){let _i=Zt;for(let nn=0;nn<Lt;nn++){const rn=kt[Yt++]/255*(pt/255);qt[_i++]=Rt+Ft*rn,qt[_i++]=Nt+Kt*rn,qt[_i++]=Pt+Bt*rn,qt[_i++]=Ut}Zt+=Tt}}blockRenderChar(nt,ot,rt,ut,gt,pt,mt,vt){const St=1*this.scale,yt=2*this.scale,wt=vt?1:yt;if(ot+St>nt.width||rt+wt>nt.height){console.warn("bad render request outside image data");return}const Lt=nt.width*4,xt=.5*(gt/255),It=pt.r,kt=pt.g,At=pt.b,Tt=ut.r-It,Rt=ut.g-kt,Nt=ut.b-At,Pt=It+Tt*xt,Ft=kt+Rt*xt,Kt=At+Nt*xt,Bt=Math.max(gt,mt),Ut=nt.data;let qt=rt*Lt+ot*4;for(let Yt=0;Yt<wt;Yt++){let Zt=qt;for(let Xt=0;Xt<St;Xt++)Ut[Zt++]=Pt,Ut[Zt++]=Ft,Ut[Zt++]=Kt,Ut[Zt++]=Bt;qt+=Lt}}}const charTable={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},decodeData=ct=>{const nt=new Uint8ClampedArray(ct.length/2);for(let ot=0;ot<ct.length;ot+=2)nt[ot>>1]=charTable[ct[ot]]<<4|charTable[ct[ot+1]]&15;return nt},prebakedMiniMaps={1:once$1(()=>decodeData("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:once$1(()=>decodeData("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};class MinimapCharRendererFactory{static create(nt,ot){if(this.lastCreated&&nt===this.lastCreated.scale&&ot===this.lastFontFamily)return this.lastCreated;let rt;return prebakedMiniMaps[nt]?rt=new MinimapCharRenderer(prebakedMiniMaps[nt](),nt):rt=MinimapCharRendererFactory.createFromSampleData(MinimapCharRendererFactory.createSampleData(ot).data,nt),this.lastFontFamily=ot,this.lastCreated=rt,rt}static createSampleData(nt){const ot=document.createElement("canvas"),rt=ot.getContext("2d");ot.style.height="16px",ot.height=16,ot.width=96*10,ot.style.width=96*10+"px",rt.fillStyle="#ffffff",rt.font=`bold 16px ${nt}`,rt.textBaseline="middle";let ut=0;for(const gt of allCharCodes)rt.fillText(String.fromCharCode(gt),ut,16/2),ut+=10;return rt.getImageData(0,0,96*10,16)}static createFromSampleData(nt,ot){if(nt.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");const ut=MinimapCharRendererFactory._downsample(nt,ot);return new MinimapCharRenderer(ut,ot)}static _downsampleChar(nt,ot,rt,ut,gt){const pt=1*gt,mt=2*gt;let vt=ut,St=0;for(let yt=0;yt<mt;yt++){const wt=yt/mt*16,Lt=(yt+1)/mt*16;for(let xt=0;xt<pt;xt++){const It=xt/pt*10,kt=(xt+1)/pt*10;let At=0,Tt=0;for(let Nt=wt;Nt<Lt;Nt++){const Pt=ot+Math.floor(Nt)*3840,Ft=1-(Nt-Math.floor(Nt));for(let Kt=It;Kt<kt;Kt++){const Bt=1-(Kt-Math.floor(Kt)),Ut=Pt+Math.floor(Kt)*4,qt=Bt*Ft;Tt+=qt,At+=nt[Ut]*nt[Ut+3]/255*qt}}const Rt=At/Tt;St=Math.max(St,Rt),rt[vt++]=toUint8(Rt)}}return St}static _downsample(nt,ot){const rt=2*ot*1*ot,ut=rt*96,gt=new Uint8ClampedArray(ut);let pt=0,mt=0,vt=0;for(let St=0;St<96;St++)vt=Math.max(vt,this._downsampleChar(nt,mt,gt,pt,ot)),pt+=rt,mt+=10*4;if(vt>0){const St=255/vt;for(let yt=0;yt<ut;yt++)gt[yt]*=St}return gt}}const POINTER_DRAG_RESET_DISTANCE=140,GUTTER_DECORATION_WIDTH=2;class MinimapOptions{constructor(nt,ot,rt){const ut=nt.options,gt=ut.get(137),pt=ut.get(139),mt=pt.minimap,vt=ut.get(48),St=ut.get(70);this.renderMinimap=mt.renderMinimap,this.size=St.size,this.minimapHeightIsEditorHeight=mt.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=ut.get(100),this.paddingTop=ut.get(81).top,this.paddingBottom=ut.get(81).bottom,this.showSlider=St.showSlider,this.autohide=St.autohide,this.pixelRatio=gt,this.typicalHalfwidthCharacterWidth=vt.typicalHalfwidthCharacterWidth,this.lineHeight=ut.get(64),this.minimapLeft=mt.minimapLeft,this.minimapWidth=mt.minimapWidth,this.minimapHeight=pt.height,this.canvasInnerWidth=mt.minimapCanvasInnerWidth,this.canvasInnerHeight=mt.minimapCanvasInnerHeight,this.canvasOuterWidth=mt.minimapCanvasOuterWidth,this.canvasOuterHeight=mt.minimapCanvasOuterHeight,this.isSampling=mt.minimapIsSampling,this.editorHeight=pt.height,this.fontScale=mt.minimapScale,this.minimapLineHeight=mt.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.charRenderer=once$1(()=>MinimapCharRendererFactory.create(this.fontScale,vt.fontFamily)),this.defaultBackgroundColor=rt.getColor(2),this.backgroundColor=MinimapOptions._getMinimapBackground(ot,this.defaultBackgroundColor),this.foregroundAlpha=MinimapOptions._getMinimapForegroundOpacity(ot)}static _getMinimapBackground(nt,ot){const rt=nt.getColor(minimapBackground);return rt?new RGBA8(rt.rgba.r,rt.rgba.g,rt.rgba.b,Math.round(255*rt.rgba.a)):ot}static _getMinimapForegroundOpacity(nt){const ot=nt.getColor(minimapForegroundOpacity);return ot?RGBA8._clamp(Math.round(255*ot.rgba.a)):255}equals(nt){return this.renderMinimap===nt.renderMinimap&&this.size===nt.size&&this.minimapHeightIsEditorHeight===nt.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===nt.scrollBeyondLastLine&&this.paddingTop===nt.paddingTop&&this.paddingBottom===nt.paddingBottom&&this.showSlider===nt.showSlider&&this.autohide===nt.autohide&&this.pixelRatio===nt.pixelRatio&&this.typicalHalfwidthCharacterWidth===nt.typicalHalfwidthCharacterWidth&&this.lineHeight===nt.lineHeight&&this.minimapLeft===nt.minimapLeft&&this.minimapWidth===nt.minimapWidth&&this.minimapHeight===nt.minimapHeight&&this.canvasInnerWidth===nt.canvasInnerWidth&&this.canvasInnerHeight===nt.canvasInnerHeight&&this.canvasOuterWidth===nt.canvasOuterWidth&&this.canvasOuterHeight===nt.canvasOuterHeight&&this.isSampling===nt.isSampling&&this.editorHeight===nt.editorHeight&&this.fontScale===nt.fontScale&&this.minimapLineHeight===nt.minimapLineHeight&&this.minimapCharWidth===nt.minimapCharWidth&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(nt.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(nt.backgroundColor)&&this.foregroundAlpha===nt.foregroundAlpha}}class MinimapLayout{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St){this.scrollTop=nt,this.scrollHeight=ot,this.sliderNeeded=rt,this._computedSliderRatio=ut,this.sliderTop=gt,this.sliderHeight=pt,this.topPaddingLineCount=mt,this.startLineNumber=vt,this.endLineNumber=St}getDesiredScrollTopFromDelta(nt){return Math.round(this.scrollTop+nt/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(nt){return Math.round((nt-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(nt){const ot=Math.max(this.startLineNumber,nt.startLineNumber),rt=Math.min(this.endLineNumber,nt.endLineNumber);return ot>rt?null:[ot,rt]}getYForLineNumber(nt,ot){return+(nt-this.startLineNumber+this.topPaddingLineCount)*ot}static create(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt){const Lt=nt.pixelRatio,xt=nt.minimapLineHeight,It=Math.floor(nt.canvasInnerHeight/xt),kt=nt.lineHeight;if(nt.minimapHeightIsEditorHeight){let Kt=vt*nt.lineHeight+nt.paddingTop+nt.paddingBottom;nt.scrollBeyondLastLine&&(Kt+=Math.max(0,gt-nt.lineHeight-nt.paddingBottom));const Bt=Math.max(1,Math.floor(gt*gt/Kt)),Ut=Math.max(0,nt.minimapHeight-Bt),qt=Ut/(yt-gt),Yt=St*qt,Zt=Ut>0,Xt=Math.floor(nt.canvasInnerHeight/nt.minimapLineHeight),_i=Math.floor(nt.paddingTop/nt.lineHeight);return new MinimapLayout(St,yt,Zt,qt,Yt,Bt,_i,1,Math.min(mt,Xt))}let At;if(pt&&rt!==mt){const Kt=rt-ot+1;At=Math.floor(Kt*xt/Lt)}else{const Kt=gt/kt;At=Math.floor(Kt*xt/Lt)}const Tt=Math.floor(nt.paddingTop/kt);let Rt=Math.floor(nt.paddingBottom/kt);if(nt.scrollBeyondLastLine){const Kt=gt/kt;Rt=Math.max(Rt,Kt-1)}let Nt;if(Rt>0){const Kt=gt/kt;Nt=(Tt+mt+Rt-Kt-1)*xt/Lt}else Nt=Math.max(0,(Tt+mt)*xt/Lt-At);Nt=Math.min(nt.minimapHeight-At,Nt);const Pt=Nt/(yt-gt),Ft=St*Pt;if(It>=Tt+mt+Rt){const Kt=Nt>0;return new MinimapLayout(St,yt,Kt,Pt,Ft,At,Tt,1,mt)}else{let Kt;ot>1?Kt=ot+Tt:Kt=Math.max(1,St/kt);let Bt,Ut=Math.max(1,Math.floor(Kt-Ft*Lt/xt));Ut<Tt?(Bt=Tt-Ut+1,Ut=1):(Bt=0,Ut=Math.max(1,Ut-Tt)),wt&&wt.scrollHeight===yt&&(wt.scrollTop>St&&(Ut=Math.min(Ut,wt.startLineNumber),Bt=Math.max(Bt,wt.topPaddingLineCount)),wt.scrollTop<St&&(Ut=Math.max(Ut,wt.startLineNumber),Bt=Math.min(Bt,wt.topPaddingLineCount)));const qt=Math.min(mt,Ut-Bt+It-1),Yt=(St-ut)/kt;let Zt;return St>nt.paddingTop?Zt=(ot-Ut+Bt+Yt)*xt/Lt:Zt=St/nt.paddingTop*(Bt+Yt)*xt/Lt,new MinimapLayout(St,yt,!0,Pt,Zt,At,Bt,Ut,qt)}}}class MinimapLine{constructor(nt){this.dy=nt}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}}MinimapLine.INVALID=new MinimapLine(-1);class RenderData{constructor(nt,ot,rt){this.renderedLayout=nt,this._imageData=ot,this._renderedLines=new RenderedLinesCollection(()=>MinimapLine.INVALID),this._renderedLines._set(nt.startLineNumber,rt)}linesEquals(nt){if(!this.scrollEquals(nt))return!1;const rt=this._renderedLines._get().lines;for(let ut=0,gt=rt.length;ut<gt;ut++)if(rt[ut].dy===-1)return!1;return!0}scrollEquals(nt){return this.renderedLayout.startLineNumber===nt.startLineNumber&&this.renderedLayout.endLineNumber===nt.endLineNumber}_get(){const nt=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:nt.rendLineNumberStart,lines:nt.lines}}onLinesChanged(nt,ot){return this._renderedLines.onLinesChanged(nt,ot)}onLinesDeleted(nt,ot){this._renderedLines.onLinesDeleted(nt,ot)}onLinesInserted(nt,ot){this._renderedLines.onLinesInserted(nt,ot)}onTokensChanged(nt){return this._renderedLines.onTokensChanged(nt)}}class MinimapBuffers{constructor(nt,ot,rt,ut){this._backgroundFillData=MinimapBuffers._createBackgroundFillData(ot,rt,ut),this._buffers=[nt.createImageData(ot,rt),nt.createImageData(ot,rt)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const nt=this._buffers[this._lastUsedBuffer];return nt.data.set(this._backgroundFillData),nt}static _createBackgroundFillData(nt,ot,rt){const ut=rt.r,gt=rt.g,pt=rt.b,mt=rt.a,vt=new Uint8ClampedArray(nt*ot*4);let St=0;for(let yt=0;yt<ot;yt++)for(let wt=0;wt<nt;wt++)vt[St]=ut,vt[St+1]=gt,vt[St+2]=pt,vt[St+3]=mt,St+=4;return vt}}class MinimapSamplingState{static compute(nt,ot,rt){if(nt.renderMinimap===0||!nt.isSampling)return[null,[]];const{minimapLineCount:ut}=EditorLayoutInfoComputer.computeContainedMinimapLineCount({viewLineCount:ot,scrollBeyondLastLine:nt.scrollBeyondLastLine,paddingTop:nt.paddingTop,paddingBottom:nt.paddingBottom,height:nt.editorHeight,lineHeight:nt.lineHeight,pixelRatio:nt.pixelRatio}),gt=ot/ut,pt=gt/2;if(!rt||rt.minimapLines.length===0){const At=[];if(At[0]=1,ut>1){for(let Tt=0,Rt=ut-1;Tt<Rt;Tt++)At[Tt]=Math.round(Tt*gt+pt);At[ut-1]=ot}return[new MinimapSamplingState(gt,At),[]]}const mt=rt.minimapLines,vt=mt.length,St=[];let yt=0,wt=0,Lt=1;const xt=10;let It=[],kt=null;for(let At=0;At<ut;At++){const Tt=Math.max(Lt,Math.round(At*gt)),Rt=Math.max(Tt,Math.round((At+1)*gt));for(;yt<vt&&mt[yt]<Tt;){if(It.length<xt){const Pt=yt+1+wt;kt&&kt.type==="deleted"&&kt._oldIndex===yt-1?kt.deleteToLineNumber++:(kt={type:"deleted",_oldIndex:yt,deleteFromLineNumber:Pt,deleteToLineNumber:Pt},It.push(kt)),wt--}yt++}let Nt;if(yt<vt&&mt[yt]<=Rt)Nt=mt[yt],yt++;else if(At===0?Nt=1:At+1===ut?Nt=ot:Nt=Math.round(At*gt+pt),It.length<xt){const Pt=yt+1+wt;kt&&kt.type==="inserted"&&kt._i===At-1?kt.insertToLineNumber++:(kt={type:"inserted",_i:At,insertFromLineNumber:Pt,insertToLineNumber:Pt},It.push(kt)),wt++}St[At]=Nt,Lt=Nt}if(It.length<xt)for(;yt<vt;){const At=yt+1+wt;kt&&kt.type==="deleted"&&kt._oldIndex===yt-1?kt.deleteToLineNumber++:(kt={type:"deleted",_oldIndex:yt,deleteFromLineNumber:At,deleteToLineNumber:At},It.push(kt)),wt--,yt++}else It=[{type:"flush"}];return[new MinimapSamplingState(gt,St),It]}constructor(nt,ot){this.samplingRatio=nt,this.minimapLines=ot}modelLineToMinimapLine(nt){return Math.min(this.minimapLines.length,Math.max(1,Math.round(nt/this.samplingRatio)))}modelLineRangeToMinimapLineRange(nt,ot){let rt=this.modelLineToMinimapLine(nt)-1;for(;rt>0&&this.minimapLines[rt-1]>=nt;)rt--;let ut=this.modelLineToMinimapLine(ot)-1;for(;ut+1<this.minimapLines.length&&this.minimapLines[ut+1]<=ot;)ut++;if(rt===ut){const gt=this.minimapLines[rt];if(gt<nt||gt>ot)return null}return[rt+1,ut+1]}decorationLineRangeToMinimapLineRange(nt,ot){let rt=this.modelLineToMinimapLine(nt),ut=this.modelLineToMinimapLine(ot);return nt!==ot&&ut===rt&&(ut===this.minimapLines.length?rt>1&&rt--:ut++),[rt,ut]}onLinesDeleted(nt){const ot=nt.toLineNumber-nt.fromLineNumber+1;let rt=this.minimapLines.length,ut=0;for(let gt=this.minimapLines.length-1;gt>=0&&!(this.minimapLines[gt]<nt.fromLineNumber);gt--)this.minimapLines[gt]<=nt.toLineNumber?(this.minimapLines[gt]=Math.max(1,nt.fromLineNumber-1),rt=Math.min(rt,gt),ut=Math.max(ut,gt)):this.minimapLines[gt]-=ot;return[rt,ut]}onLinesInserted(nt){const ot=nt.toLineNumber-nt.fromLineNumber+1;for(let rt=this.minimapLines.length-1;rt>=0&&!(this.minimapLines[rt]<nt.fromLineNumber);rt--)this.minimapLines[rt]+=ot}}class Minimap extends ViewPart{constructor(nt){super(nt),this.tokensColorTracker=MinimapTokensColorTracker.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new MinimapOptions(this._context.configuration,this._context.theme,this.tokensColorTracker);const[ot]=MinimapSamplingState.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=ot,this._shouldCheckSampling=!1,this._actual=new InnerMinimap(nt.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const nt=new MinimapOptions(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(nt)?!1:(this.options=nt,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(nt){return this._onOptionsMaybeChanged()}onCursorStateChanged(nt){return this._selections=nt.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(nt){return nt.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(nt){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(nt){if(this._samplingState){const ot=this._samplingState.modelLineRangeToMinimapLineRange(nt.fromLineNumber,nt.fromLineNumber+nt.count-1);return ot?this._actual.onLinesChanged(ot[0],ot[1]-ot[0]+1):!1}else return this._actual.onLinesChanged(nt.fromLineNumber,nt.count)}onLinesDeleted(nt){if(this._samplingState){const[ot,rt]=this._samplingState.onLinesDeleted(nt);return ot<=rt&&this._actual.onLinesChanged(ot+1,rt-ot+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(nt.fromLineNumber,nt.toLineNumber)}onLinesInserted(nt){return this._samplingState?(this._samplingState.onLinesInserted(nt),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(nt.fromLineNumber,nt.toLineNumber)}onScrollChanged(nt){return this._actual.onScrollChanged()}onThemeChanged(nt){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(nt){if(this._samplingState){const ot=[];for(const rt of nt.ranges){const ut=this._samplingState.modelLineRangeToMinimapLineRange(rt.fromLineNumber,rt.toLineNumber);ut&&ot.push({fromLineNumber:ut[0],toLineNumber:ut[1]})}return ot.length?this._actual.onTokensChanged(ot):!1}else return this._actual.onTokensChanged(nt.ranges)}onTokensColorsChanged(nt){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(nt){return this._actual.onZonesChanged()}prepareRender(nt){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(nt){let ot=nt.visibleRange.startLineNumber,rt=nt.visibleRange.endLineNumber;this._samplingState&&(ot=this._samplingState.modelLineToMinimapLine(ot),rt=this._samplingState.modelLineToMinimapLine(rt));const ut={viewportContainsWhitespaceGaps:nt.viewportData.whitespaceViewportData.length>0,scrollWidth:nt.scrollWidth,scrollHeight:nt.scrollHeight,viewportStartLineNumber:ot,viewportEndLineNumber:rt,viewportStartLineNumberVerticalOffset:nt.getVerticalOffsetForLineNumber(ot),scrollTop:nt.scrollTop,scrollLeft:nt.scrollLeft,viewportWidth:nt.viewportWidth,viewportHeight:nt.viewportHeight};this._actual.render(ut)}_recreateLineSampling(){this._minimapSelections=null;const nt=!!this._samplingState,[ot,rt]=MinimapSamplingState.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=ot,nt&&this._samplingState)for(const ut of rt)switch(ut.type){case"deleted":this._actual.onLinesDeleted(ut.deleteFromLineNumber,ut.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(ut.insertFromLineNumber,ut.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(nt){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[nt-1]):this._context.viewModel.getLineContent(nt)}getLineMaxColumn(nt){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[nt-1]):this._context.viewModel.getLineMaxColumn(nt)}getMinimapLinesRenderingData(nt,ot,rt){if(this._samplingState){const ut=[];for(let gt=0,pt=ot-nt+1;gt<pt;gt++)rt[gt]?ut[gt]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[nt+gt-1]):ut[gt]=null;return ut}return this._context.viewModel.getMinimapLinesRenderingData(nt,ot,rt).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const nt of this._selections){const[ot,rt]=this._samplingState.decorationLineRangeToMinimapLineRange(nt.startLineNumber,nt.endLineNumber);this._minimapSelections.push(new Selection$1(ot,nt.startColumn,rt,nt.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(nt,ot){let rt;if(this._samplingState){const gt=this._samplingState.minimapLines[nt-1],pt=this._samplingState.minimapLines[ot-1];rt=new Range$2(gt,1,pt,this._context.viewModel.getLineMaxColumn(pt))}else rt=new Range$2(nt,1,ot,this._context.viewModel.getLineMaxColumn(ot));const ut=this._context.viewModel.getMinimapDecorationsInRange(rt);if(this._samplingState){const gt=[];for(const pt of ut){if(!pt.options.minimap)continue;const mt=pt.range,vt=this._samplingState.modelLineToMinimapLine(mt.startLineNumber),St=this._samplingState.modelLineToMinimapLine(mt.endLineNumber);gt.push(new ViewModelDecoration(new Range$2(vt,mt.startColumn,St,mt.endColumn),pt.options))}return gt}return ut}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(nt){this._samplingState&&(nt=this._samplingState.minimapLines[nt-1]),this._context.viewModel.revealRange("mouse",!1,new Range$2(nt,1,nt,1),1,0)}setScrollTop(nt){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:nt},1)}}class InnerMinimap extends Disposable{constructor(nt,ot){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=nt,this._model=ot,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(minimapSelection),this._domNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this._domNode,8),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=createFastDomNode(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=createFastDomNode(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=createFastDomNode(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=createFastDomNode(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=createFastDomNode(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=addStandardDisposableListener(this._domNode.domNode,EventType$1.POINTER_DOWN,rt=>{if(rt.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(rt.button===0&&this._lastRenderData){const St=getDomNodePagePosition(this._slider.domNode),yt=St.top+St.height/2;this._startSliderDragging(rt,yt,this._lastRenderData.renderedLayout)}return}const gt=this._model.options.minimapLineHeight,pt=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*rt.offsetY;let vt=Math.floor(pt/gt)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;vt=Math.min(vt,this._model.getLineCount()),this._model.revealLineNumber(vt)}),this._sliderPointerMoveMonitor=new GlobalPointerMoveMonitor,this._sliderPointerDownListener=addStandardDisposableListener(this._slider.domNode,EventType$1.POINTER_DOWN,rt=>{rt.preventDefault(),rt.stopPropagation(),rt.button===0&&this._lastRenderData&&this._startSliderDragging(rt,rt.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Gesture.addTarget(this._domNode.domNode),this._sliderTouchStartListener=addDisposableListener(this._domNode.domNode,EventType.Start,rt=>{rt.preventDefault(),rt.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(rt))},{passive:!1}),this._sliderTouchMoveListener=addDisposableListener(this._domNode.domNode,EventType.Change,rt=>{rt.preventDefault(),rt.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(rt)},{passive:!1}),this._sliderTouchEndListener=addStandardDisposableListener(this._domNode.domNode,EventType.End,rt=>{rt.preventDefault(),rt.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(nt,ot,rt){if(!nt.target||!(nt.target instanceof Element))return;const ut=nt.pageX;this._slider.toggleClassName("active",!0);const gt=(pt,mt)=>{const vt=getDomNodePagePosition(this._domNode.domNode),St=Math.min(Math.abs(mt-ut),Math.abs(mt-vt.left),Math.abs(mt-vt.left-vt.width));if(isWindows&&St>POINTER_DRAG_RESET_DISTANCE){this._model.setScrollTop(rt.scrollTop);return}const yt=pt-ot;this._model.setScrollTop(rt.getDesiredScrollTopFromDelta(yt))};nt.pageY!==ot&&gt(nt.pageY,ut),this._sliderPointerMoveMonitor.startMonitoring(nt.target,nt.pointerId,nt.buttons,pt=>gt(pt.pageY,pt.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(nt){const ot=this._domNode.domNode.getBoundingClientRect().top,rt=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(nt.pageY-ot);this._model.setScrollTop(rt)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){const nt=["minimap"];return this._model.options.showSlider==="always"?nt.push("slider-always"):nt.push("slider-mouseover"),this._model.options.autohide&&nt.push("autohide"),nt.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new MinimapBuffers(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(nt,ot){return this._lastRenderData?this._lastRenderData.onLinesChanged(nt,ot):!1}onLinesDeleted(nt,ot){var rt;return(rt=this._lastRenderData)===null||rt===void 0||rt.onLinesDeleted(nt,ot),!0}onLinesInserted(nt,ot){var rt;return(rt=this._lastRenderData)===null||rt===void 0||rt.onLinesInserted(nt,ot),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(minimapSelection),this._renderDecorations=!0,!0}onTokensChanged(nt){return this._lastRenderData?this._lastRenderData.onTokensChanged(nt):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(nt){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}nt.scrollLeft+nt.viewportWidth>=nt.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const rt=MinimapLayout.create(this._model.options,nt.viewportStartLineNumber,nt.viewportEndLineNumber,nt.viewportStartLineNumberVerticalOffset,nt.viewportHeight,nt.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),nt.scrollTop,nt.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(rt.sliderNeeded?"block":"none"),this._slider.setTop(rt.sliderTop),this._slider.setHeight(rt.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(rt.sliderHeight),this.renderDecorations(rt),this._lastRenderData=this.renderLines(rt)}renderDecorations(nt){if(this._renderDecorations){this._renderDecorations=!1;const ot=this._model.getSelections();ot.sort(Range$2.compareRangesUsingStarts);const rt=this._model.getMinimapDecorationsInViewport(nt.startLineNumber,nt.endLineNumber);rt.sort((Lt,xt)=>(Lt.options.zIndex||0)-(xt.options.zIndex||0));const{canvasInnerWidth:ut,canvasInnerHeight:gt}=this._model.options,pt=this._model.options.minimapLineHeight,mt=this._model.options.minimapCharWidth,vt=this._model.getOptions().tabSize,St=this._decorationsCanvas.domNode.getContext("2d");St.clearRect(0,0,ut,gt);const yt=new ContiguousLineMap(nt.startLineNumber,nt.endLineNumber,!1);this._renderSelectionLineHighlights(St,ot,yt,nt,pt),this._renderDecorationsLineHighlights(St,rt,yt,nt,pt);const wt=new ContiguousLineMap(nt.startLineNumber,nt.endLineNumber,null);this._renderSelectionsHighlights(St,ot,wt,nt,pt,vt,mt,ut),this._renderDecorationsHighlights(St,rt,wt,nt,pt,vt,mt,ut)}}_renderSelectionLineHighlights(nt,ot,rt,ut,gt){if(!this._selectionColor||this._selectionColor.isTransparent())return;nt.fillStyle=this._selectionColor.transparent(.5).toString();let pt=0,mt=0;for(const vt of ot){const St=ut.intersectWithViewport(vt);if(!St)continue;const[yt,wt]=St;for(let It=yt;It<=wt;It++)rt.set(It,!0);const Lt=ut.getYForLineNumber(yt,gt),xt=ut.getYForLineNumber(wt,gt);mt>=Lt||(mt>pt&&nt.fillRect(MINIMAP_GUTTER_WIDTH,pt,nt.canvas.width,mt-pt),pt=Lt),mt=xt}mt>pt&&nt.fillRect(MINIMAP_GUTTER_WIDTH,pt,nt.canvas.width,mt-pt)}_renderDecorationsLineHighlights(nt,ot,rt,ut,gt){const pt=new Map;for(let mt=ot.length-1;mt>=0;mt--){const vt=ot[mt],St=vt.options.minimap;if(!St||St.position!==MinimapPosition.Inline)continue;const yt=ut.intersectWithViewport(vt.range);if(!yt)continue;const[wt,Lt]=yt,xt=St.getColor(this._theme.value);if(!xt||xt.isTransparent())continue;let It=pt.get(xt.toString());It||(It=xt.transparent(.5).toString(),pt.set(xt.toString(),It)),nt.fillStyle=It;for(let kt=wt;kt<=Lt;kt++){if(rt.has(kt))continue;rt.set(kt,!0);const At=ut.getYForLineNumber(wt,gt);nt.fillRect(MINIMAP_GUTTER_WIDTH,At,nt.canvas.width,gt)}}}_renderSelectionsHighlights(nt,ot,rt,ut,gt,pt,mt,vt){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(const St of ot){const yt=ut.intersectWithViewport(St);if(!yt)continue;const[wt,Lt]=yt;for(let xt=wt;xt<=Lt;xt++)this.renderDecorationOnLine(nt,rt,St,this._selectionColor,ut,xt,gt,gt,pt,mt,vt)}}_renderDecorationsHighlights(nt,ot,rt,ut,gt,pt,mt,vt){for(const St of ot){const yt=St.options.minimap;if(!yt)continue;const wt=ut.intersectWithViewport(St.range);if(!wt)continue;const[Lt,xt]=wt,It=yt.getColor(this._theme.value);if(!(!It||It.isTransparent()))for(let kt=Lt;kt<=xt;kt++)switch(yt.position){case MinimapPosition.Inline:this.renderDecorationOnLine(nt,rt,St.range,It,ut,kt,gt,gt,pt,mt,vt);continue;case MinimapPosition.Gutter:{const At=ut.getYForLineNumber(kt,gt),Tt=2;this.renderDecoration(nt,It,Tt,At,GUTTER_DECORATION_WIDTH,gt);continue}}}}renderDecorationOnLine(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt){const Lt=gt.getYForLineNumber(pt,vt);if(Lt+mt<0||Lt>this._model.options.canvasInnerHeight)return;const{startLineNumber:xt,endLineNumber:It}=rt,kt=xt===pt?rt.startColumn:1,At=It===pt?rt.endColumn:this._model.getLineMaxColumn(pt),Tt=this.getXOffsetForPosition(ot,pt,kt,St,yt,wt),Rt=this.getXOffsetForPosition(ot,pt,At,St,yt,wt);this.renderDecoration(nt,ut,Tt,Lt,Rt-Tt,mt)}getXOffsetForPosition(nt,ot,rt,ut,gt,pt){if(rt===1)return MINIMAP_GUTTER_WIDTH;if((rt-1)*gt>=pt)return pt;let vt=nt.get(ot);if(!vt){const St=this._model.getLineContent(ot);vt=[MINIMAP_GUTTER_WIDTH];let yt=MINIMAP_GUTTER_WIDTH;for(let wt=1;wt<St.length+1;wt++){const Lt=St.charCodeAt(wt-1),xt=Lt===9?ut*gt:isFullWidthCharacter(Lt)?2*gt:gt,It=yt+xt;if(It>=pt){vt[wt]=pt;break}vt[wt]=It,yt=It}nt.set(ot,vt)}return rt-1<vt.length?vt[rt-1]:pt}renderDecoration(nt,ot,rt,ut,gt,pt){nt.fillStyle=ot&&ot.toString()||"",nt.fillRect(rt,ut,gt,pt)}renderLines(nt){const ot=nt.startLineNumber,rt=nt.endLineNumber,ut=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(nt)){const rn=this._lastRenderData._get();return new RenderData(nt,rn.imageData,rn.lines)}const gt=this._getBuffer();if(!gt)return null;const[pt,mt,vt]=InnerMinimap._renderUntouchedLines(gt,nt.topPaddingLineCount,ot,rt,ut,this._lastRenderData),St=this._model.getMinimapLinesRenderingData(ot,rt,vt),yt=this._model.getOptions().tabSize,wt=this._model.options.defaultBackgroundColor,Lt=this._model.options.backgroundColor,xt=this._model.options.foregroundAlpha,It=this._model.tokensColorTracker,kt=It.backgroundIsLight(),At=this._model.options.renderMinimap,Tt=this._model.options.charRenderer(),Rt=this._model.options.fontScale,Nt=this._model.options.minimapCharWidth,Ft=(At===1?2:2+1)*Rt,Kt=ut>Ft?Math.floor((ut-Ft)/2):0,Bt=Lt.a/255,Ut=new RGBA8(Math.round((Lt.r-wt.r)*Bt+wt.r),Math.round((Lt.g-wt.g)*Bt+wt.g),Math.round((Lt.b-wt.b)*Bt+wt.b),255);let qt=nt.topPaddingLineCount*ut;const Yt=[];for(let rn=0,dn=rt-ot+1;rn<dn;rn++)vt[rn]&&InnerMinimap._renderLine(gt,Ut,Lt.a,kt,At,Nt,It,xt,Tt,qt,Kt,yt,St[rn],Rt,ut),Yt[rn]=new MinimapLine(qt),qt+=ut;const Zt=pt===-1?0:pt,_i=(mt===-1?gt.height:mt)-Zt;return this._canvas.domNode.getContext("2d").putImageData(gt,0,0,0,Zt,gt.width,_i),new RenderData(nt,gt,Yt)}static _renderUntouchedLines(nt,ot,rt,ut,gt,pt){const mt=[];if(!pt){for(let qt=0,Yt=ut-rt+1;qt<Yt;qt++)mt[qt]=!0;return[-1,-1,mt]}const vt=pt._get(),St=vt.imageData.data,yt=vt.rendLineNumberStart,wt=vt.lines,Lt=wt.length,xt=nt.width,It=nt.data,kt=(ut-rt+1)*gt*xt*4;let At=-1,Tt=-1,Rt=-1,Nt=-1,Pt=-1,Ft=-1,Kt=ot*gt;for(let qt=rt;qt<=ut;qt++){const Yt=qt-rt,Zt=qt-yt,Xt=Zt>=0&&Zt<Lt?wt[Zt].dy:-1;if(Xt===-1){mt[Yt]=!0,Kt+=gt;continue}const _i=Xt*xt*4,nn=(Xt+gt)*xt*4,rn=Kt*xt*4,dn=(Kt+gt)*xt*4;Nt===_i&&Ft===rn?(Nt=nn,Ft=dn):(Rt!==-1&&(It.set(St.subarray(Rt,Nt),Pt),At===-1&&Rt===0&&Rt===Pt&&(At=Nt),Tt===-1&&Nt===kt&&Rt===Pt&&(Tt=Rt)),Rt=_i,Nt=nn,Pt=rn,Ft=dn),mt[Yt]=!1,Kt+=gt}Rt!==-1&&(It.set(St.subarray(Rt,Nt),Pt),At===-1&&Rt===0&&Rt===Pt&&(At=Nt),Tt===-1&&Nt===kt&&Rt===Pt&&(Tt=Rt));const Bt=At===-1?-1:At/(xt*4),Ut=Tt===-1?-1:Tt/(xt*4);return[Bt,Ut,mt]}static _renderLine(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt,xt,It,kt){const At=xt.content,Tt=xt.tokens,Rt=nt.width-pt,Nt=kt===1;let Pt=MINIMAP_GUTTER_WIDTH,Ft=0,Kt=0;for(let Bt=0,Ut=Tt.getCount();Bt<Ut;Bt++){const qt=Tt.getEndOffset(Bt),Yt=Tt.getForeground(Bt),Zt=mt.getColor(Yt);for(;Ft<qt;Ft++){if(Pt>Rt)return;const Xt=At.charCodeAt(Ft);if(Xt===9){const _i=Lt-(Ft+Kt)%Lt;Kt+=_i-1,Pt+=_i*pt}else if(Xt===32)Pt+=pt;else{const _i=isFullWidthCharacter(Xt)?2:1;for(let nn=0;nn<_i;nn++)if(gt===2?St.blockRenderChar(nt,Pt,yt+wt,Zt,vt,ot,rt,Nt):St.renderChar(nt,Pt,yt+wt,Xt,Zt,vt,ot,rt,It,ut,Nt),Pt+=pt,Pt>Rt)return}}}}}class ContiguousLineMap{constructor(nt,ot,rt){this._startLineNumber=nt,this._endLineNumber=ot,this._defaultValue=rt,this._values=[];for(let ut=0,gt=this._endLineNumber-this._startLineNumber+1;ut<gt;ut++)this._values[ut]=rt}has(nt){return this.get(nt)!==this._defaultValue}set(nt,ot){nt<this._startLineNumber||nt>this._endLineNumber||(this._values[nt-this._startLineNumber]=ot)}get(nt){return nt<this._startLineNumber||nt>this._endLineNumber?this._defaultValue:this._values[nt-this._startLineNumber]}}const overlayWidgets="";class ViewOverlayWidgets extends ViewPart{constructor(nt){super(nt);const rt=this._context.configuration.options.get(139);this._widgets={},this._verticalScrollbarWidth=rt.verticalScrollbarWidth,this._minimapWidth=rt.minimap.minimapWidth,this._horizontalScrollbarHeight=rt.horizontalScrollbarHeight,this._editorHeight=rt.height,this._editorWidth=rt.width,this._domNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this._domNode,4),this._domNode.setClassName("overlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(nt){const rt=this._context.configuration.options.get(139);return this._verticalScrollbarWidth=rt.verticalScrollbarWidth,this._minimapWidth=rt.minimap.minimapWidth,this._horizontalScrollbarHeight=rt.horizontalScrollbarHeight,this._editorHeight=rt.height,this._editorWidth=rt.width,!0}addWidget(nt){const ot=createFastDomNode(nt.getDomNode());this._widgets[nt.getId()]={widget:nt,preference:null,domNode:ot},ot.setPosition("absolute"),ot.setAttribute("widgetId",nt.getId()),this._domNode.appendChild(ot),this.setShouldRender()}setWidgetPosition(nt,ot){const rt=this._widgets[nt.getId()];return rt.preference===ot?!1:(rt.preference=ot,this.setShouldRender(),!0)}removeWidget(nt){const ot=nt.getId();if(this._widgets.hasOwnProperty(ot)){const ut=this._widgets[ot].domNode.domNode;delete this._widgets[ot],ut.parentNode.removeChild(ut),this.setShouldRender()}}_renderWidget(nt){const ot=nt.domNode;if(nt.preference===null){ot.setTop("");return}if(nt.preference===0)ot.setTop(0),ot.setRight(2*this._verticalScrollbarWidth+this._minimapWidth);else if(nt.preference===1){const rt=ot.domNode.clientHeight;ot.setTop(this._editorHeight-rt-2*this._horizontalScrollbarHeight),ot.setRight(2*this._verticalScrollbarWidth+this._minimapWidth)}else nt.preference===2&&(ot.setTop(0),ot.domNode.style.right="50%")}prepareRender(nt){}render(nt){this._domNode.setWidth(this._editorWidth);const ot=Object.keys(this._widgets);for(let rt=0,ut=ot.length;rt<ut;rt++){const gt=ot[rt];this._renderWidget(this._widgets[gt])}}}class Settings{constructor(nt,ot){const rt=nt.options;this.lineHeight=rt.get(64),this.pixelRatio=rt.get(137),this.overviewRulerLanes=rt.get(80),this.renderBorder=rt.get(79);const ut=ot.getColor(editorOverviewRulerBorder);this.borderColor=ut?ut.toString():null,this.hideCursor=rt.get(57);const gt=ot.getColor(editorCursorForeground);this.cursorColor=gt?gt.transparent(.7).toString():null,this.themeType=ot.type;const pt=rt.get(70),mt=pt.enabled,vt=pt.side,St=ot.getColor(editorOverviewRulerBackground),yt=TokenizationRegistry.getDefaultBackground();St?this.backgroundColor=St:mt&&vt==="right"?this.backgroundColor=yt:this.backgroundColor=null;const Lt=rt.get(139).overviewRuler;this.top=Lt.top,this.right=Lt.right,this.domWidth=Lt.width,this.domHeight=Lt.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[xt,It]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=xt,this.w=It}_initLanes(nt,ot,rt){const ut=ot-nt;if(rt>=3){const gt=Math.floor(ut/3),pt=Math.floor(ut/3),mt=ut-gt-pt,vt=nt,St=vt+gt,yt=vt+gt+mt;return[[0,vt,St,vt,yt,vt,St,vt],[0,gt,mt,gt+mt,pt,gt+mt+pt,mt+pt,gt+mt+pt]]}else if(rt===2){const gt=Math.floor(ut/2),pt=ut-gt,mt=nt,vt=mt+gt;return[[0,mt,mt,mt,vt,mt,mt,mt],[0,gt,gt,gt,pt,gt+pt,gt+pt,gt+pt]]}else{const gt=nt,pt=ut;return[[0,gt,gt,gt,gt,gt,gt,gt],[0,pt,pt,pt,pt,pt,pt,pt]]}}equals(nt){return this.lineHeight===nt.lineHeight&&this.pixelRatio===nt.pixelRatio&&this.overviewRulerLanes===nt.overviewRulerLanes&&this.renderBorder===nt.renderBorder&&this.borderColor===nt.borderColor&&this.hideCursor===nt.hideCursor&&this.cursorColor===nt.cursorColor&&this.themeType===nt.themeType&&Color.equals(this.backgroundColor,nt.backgroundColor)&&this.top===nt.top&&this.right===nt.right&&this.domWidth===nt.domWidth&&this.domHeight===nt.domHeight&&this.canvasWidth===nt.canvasWidth&&this.canvasHeight===nt.canvasHeight}}class DecorationsOverviewRuler extends ViewPart{constructor(nt){super(nt),this._domNode=createFastDomNode(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=TokenizationRegistry.onDidChange(ot=>{ot.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(nt){const ot=new Settings(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(ot)?!1:(this._settings=ot,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,nt&&this._render(),!0)}onConfigurationChanged(nt){return this._updateSettings(!1)}onCursorStateChanged(nt){this._cursorPositions=[];for(let ot=0,rt=nt.selections.length;ot<rt;ot++)this._cursorPositions[ot]=nt.selections[ot].getPosition();return this._cursorPositions.sort(Position$1.compare),!0}onDecorationsChanged(nt){return!!nt.affectsOverviewRuler}onFlushed(nt){return!0}onScrollChanged(nt){return nt.scrollHeightChanged}onZonesChanged(nt){return!0}onThemeChanged(nt){return this._updateSettings(!1)}getDomNode(){return this._domNode.domNode}prepareRender(nt){}render(nt){this._render()}_render(){const nt=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(nt?Color.Format.CSS.formatHexA(nt):""),this._domNode.setDisplay("none");return}this._domNode.setDisplay("block");const ot=this._settings.canvasWidth,rt=this._settings.canvasHeight,ut=this._settings.lineHeight,gt=this._context.viewLayout,pt=this._context.viewLayout.getScrollHeight(),mt=rt/pt,vt=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme),St=6*this._settings.pixelRatio|0,yt=St/2|0,wt=this._domNode.domNode.getContext("2d");nt?nt.isOpaque()?(wt.fillStyle=Color.Format.CSS.formatHexA(nt),wt.fillRect(0,0,ot,rt)):(wt.clearRect(0,0,ot,rt),wt.fillStyle=Color.Format.CSS.formatHexA(nt),wt.fillRect(0,0,ot,rt)):wt.clearRect(0,0,ot,rt);const Lt=this._settings.x,xt=this._settings.w;vt.sort(OverviewRulerDecorationsGroup.cmp);for(const It of vt){const kt=It.color,At=It.data;wt.fillStyle=kt;let Tt=0,Rt=0,Nt=0;for(let Pt=0,Ft=At.length/3;Pt<Ft;Pt++){const Kt=At[3*Pt],Bt=At[3*Pt+1],Ut=At[3*Pt+2];let qt=gt.getVerticalOffsetForLineNumber(Bt)*mt|0,Yt=(gt.getVerticalOffsetForLineNumber(Ut)+ut)*mt|0;if(Yt-qt<St){let Xt=(qt+Yt)/2|0;Xt<yt?Xt=yt:Xt+yt>rt&&(Xt=rt-yt),qt=Xt-yt,Yt=Xt+yt}qt>Nt+1||Kt!==Tt?(Pt!==0&&wt.fillRect(Lt[Tt],Rt,xt[Tt],Nt-Rt),Tt=Kt,Rt=qt,Nt=Yt):Yt>Nt&&(Nt=Yt)}wt.fillRect(Lt[Tt],Rt,xt[Tt],Nt-Rt)}if(!this._settings.hideCursor&&this._settings.cursorColor){const It=2*this._settings.pixelRatio|0,kt=It/2|0,At=this._settings.x[7],Tt=this._settings.w[7];wt.fillStyle=this._settings.cursorColor;let Rt=-100,Nt=-100;for(let Pt=0,Ft=this._cursorPositions.length;Pt<Ft;Pt++){const Kt=this._cursorPositions[Pt];let Bt=gt.getVerticalOffsetForLineNumber(Kt.lineNumber)*mt|0;Bt<kt?Bt=kt:Bt+kt>rt&&(Bt=rt-kt);const Ut=Bt-kt,qt=Ut+It;Ut>Nt+1?(Pt!==0&&wt.fillRect(At,Rt,Tt,Nt-Rt),Rt=Ut,Nt=qt):qt>Nt&&(Nt=qt)}wt.fillRect(At,Rt,Tt,Nt-Rt)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(wt.beginPath(),wt.lineWidth=1,wt.strokeStyle=this._settings.borderColor,wt.moveTo(0,0),wt.lineTo(0,rt),wt.stroke(),wt.moveTo(0,0),wt.lineTo(ot,0),wt.stroke())}}class ColorZone{constructor(nt,ot,rt){this._colorZoneBrand=void 0,this.from=nt|0,this.to=ot|0,this.colorId=rt|0}static compare(nt,ot){return nt.colorId===ot.colorId?nt.from===ot.from?nt.to-ot.to:nt.from-ot.from:nt.colorId-ot.colorId}}class OverviewRulerZone{constructor(nt,ot,rt,ut){this._overviewRulerZoneBrand=void 0,this.startLineNumber=nt,this.endLineNumber=ot,this.heightInLines=rt,this.color=ut,this._colorZone=null}static compare(nt,ot){return nt.color===ot.color?nt.startLineNumber===ot.startLineNumber?nt.heightInLines===ot.heightInLines?nt.endLineNumber-ot.endLineNumber:nt.heightInLines-ot.heightInLines:nt.startLineNumber-ot.startLineNumber:nt.color<ot.color?-1:1}setColorZone(nt){this._colorZone=nt}getColorZones(){return this._colorZone}}class OverviewZoneManager{constructor(nt){this._getVerticalOffsetForLine=nt,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(nt){this._zones=nt,this._zones.sort(OverviewRulerZone.compare)}setLineHeight(nt){return this._lineHeight===nt?!1:(this._lineHeight=nt,this._colorZonesInvalid=!0,!0)}setPixelRatio(nt){this._pixelRatio=nt,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(nt){return this._domWidth===nt?!1:(this._domWidth=nt,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(nt){return this._domHeight===nt?!1:(this._domHeight=nt,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(nt){return this._outerHeight===nt?!1:(this._outerHeight=nt,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const nt=this._colorZonesInvalid,ot=Math.floor(this._lineHeight),rt=Math.floor(this.getCanvasHeight()),ut=Math.floor(this._outerHeight),gt=rt/ut,pt=Math.floor(4*this._pixelRatio/2),mt=[];for(let vt=0,St=this._zones.length;vt<St;vt++){const yt=this._zones[vt];if(!nt){const Pt=yt.getColorZones();if(Pt){mt.push(Pt);continue}}const wt=this._getVerticalOffsetForLine(yt.startLineNumber),Lt=yt.heightInLines===0?this._getVerticalOffsetForLine(yt.endLineNumber)+ot:wt+yt.heightInLines*ot,xt=Math.floor(gt*wt),It=Math.floor(gt*Lt);let kt=Math.floor((xt+It)/2),At=It-kt;At<pt&&(At=pt),kt-At<0&&(kt=At),kt+At>rt&&(kt=rt-At);const Tt=yt.color;let Rt=this._color2Id[Tt];Rt||(Rt=++this._lastAssignedId,this._color2Id[Tt]=Rt,this._id2Color[Rt]=Tt);const Nt=new ColorZone(kt-At,kt+At,Rt);yt.setColorZone(Nt),mt.push(Nt)}return this._colorZonesInvalid=!1,mt.sort(ColorZone.compare),mt}}class OverviewRuler extends ViewEventHandler{constructor(nt,ot){super(),this._context=nt;const rt=this._context.configuration.options;this._domNode=createFastDomNode(document.createElement("canvas")),this._domNode.setClassName(ot),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new OverviewZoneManager(ut=>this._context.viewLayout.getVerticalOffsetForLineNumber(ut)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(rt.get(64)),this._zoneManager.setPixelRatio(rt.get(137)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(nt){const ot=this._context.configuration.options;return nt.hasChanged(64)&&(this._zoneManager.setLineHeight(ot.get(64)),this._render()),nt.hasChanged(137)&&(this._zoneManager.setPixelRatio(ot.get(137)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(nt){return this._render(),!0}onScrollChanged(nt){return nt.scrollHeightChanged&&(this._zoneManager.setOuterHeight(nt.scrollHeight),this._render()),!0}onZonesChanged(nt){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(nt){this._domNode.setTop(nt.top),this._domNode.setRight(nt.right);let ot=!1;ot=this._zoneManager.setDOMWidth(nt.width)||ot,ot=this._zoneManager.setDOMHeight(nt.height)||ot,ot&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(nt){this._zoneManager.setZones(nt),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const nt=this._zoneManager.getCanvasWidth(),ot=this._zoneManager.getCanvasHeight(),rt=this._zoneManager.resolveColorZones(),ut=this._zoneManager.getId2Color(),gt=this._domNode.domNode.getContext("2d");return gt.clearRect(0,0,nt,ot),rt.length>0&&this._renderOneLane(gt,rt,ut,nt),!0}_renderOneLane(nt,ot,rt,ut){let gt=0,pt=0,mt=0;for(const vt of ot){const St=vt.colorId,yt=vt.from,wt=vt.to;St!==gt?(nt.fillRect(0,pt,ut,mt-pt),gt=St,nt.fillStyle=rt[gt],pt=yt,mt=wt):mt>=yt?mt=Math.max(mt,wt):(nt.fillRect(0,pt,ut,mt-pt),pt=yt,mt=wt)}nt.fillRect(0,pt,ut,mt-pt)}}const rulers="";class Rulers extends ViewPart{constructor(nt){super(nt),this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const ot=this._context.configuration.options;this._rulers=ot.get(97),this._typicalHalfwidthCharacterWidth=ot.get(48).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(nt){const ot=this._context.configuration.options;return this._rulers=ot.get(97),this._typicalHalfwidthCharacterWidth=ot.get(48).typicalHalfwidthCharacterWidth,!0}onScrollChanged(nt){return nt.scrollHeightChanged}prepareRender(nt){}_ensureRulersCount(){const nt=this._renderedRulers.length,ot=this._rulers.length;if(nt===ot)return;if(nt<ot){const{tabSize:ut}=this._context.viewModel.model.getOptions(),gt=ut;let pt=ot-nt;for(;pt>0;){const mt=createFastDomNode(document.createElement("div"));mt.setClassName("view-ruler"),mt.setWidth(gt),this.domNode.appendChild(mt),this._renderedRulers.push(mt),pt--}return}let rt=nt-ot;for(;rt>0;){const ut=this._renderedRulers.pop();this.domNode.removeChild(ut),rt--}}render(nt){this._ensureRulersCount();for(let ot=0,rt=this._rulers.length;ot<rt;ot++){const ut=this._renderedRulers[ot],gt=this._rulers[ot];ut.setBoxShadow(gt.color?`1px 0 0 0 ${gt.color} inset`:""),ut.setHeight(Math.min(nt.scrollHeight,1e6)),ut.setLeft(gt.column*this._typicalHalfwidthCharacterWidth)}}}const scrollDecoration="";class ScrollDecorationViewPart extends ViewPart{constructor(nt){super(nt),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const rt=this._context.configuration.options.get(98);this._useShadows=rt.useShadows,this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const nt=this._useShadows&&this._scrollTop>0;return this._shouldShow!==nt?(this._shouldShow=nt,!0):!1}getDomNode(){return this._domNode}_updateWidth(){const ot=this._context.configuration.options.get(139);ot.minimap.renderMinimap===0||ot.minimap.minimapWidth>0&&ot.minimap.minimapLeft===0?this._width=ot.width:this._width=ot.width-ot.verticalScrollbarWidth}onConfigurationChanged(nt){const rt=this._context.configuration.options.get(98);return this._useShadows=rt.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(nt){return this._scrollTop=nt.scrollTop,this._updateShouldShow()}prepareRender(nt){}render(nt){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}const selections="";class HorizontalRangeWithStyle{constructor(nt){this.left=nt.left,this.width=nt.width,this.startStyle=null,this.endStyle=null}}class LineVisibleRangesWithStyle{constructor(nt,ot){this.lineNumber=nt,this.ranges=ot}}function toStyledRange(ct){return new HorizontalRangeWithStyle(ct)}function toStyled(ct){return new LineVisibleRangesWithStyle(ct.lineNumber,ct.ranges.map(toStyledRange))}class SelectionsOverlay extends DynamicViewOverlay{constructor(nt){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=nt;const ot=this._context.configuration.options;this._lineHeight=ot.get(64),this._roundedSelection=ot.get(96),this._typicalHalfwidthCharacterWidth=ot.get(48).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(nt){const ot=this._context.configuration.options;return this._lineHeight=ot.get(64),this._roundedSelection=ot.get(96),this._typicalHalfwidthCharacterWidth=ot.get(48).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(nt){return this._selections=nt.selections.slice(0),!0}onDecorationsChanged(nt){return!0}onFlushed(nt){return!0}onLinesChanged(nt){return!0}onLinesDeleted(nt){return!0}onLinesInserted(nt){return!0}onScrollChanged(nt){return nt.scrollTopChanged}onZonesChanged(nt){return!0}_visibleRangesHaveGaps(nt){for(let ot=0,rt=nt.length;ot<rt;ot++)if(nt[ot].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(nt,ot,rt){const ut=this._typicalHalfwidthCharacterWidth/4;let gt=null,pt=null;if(rt&&rt.length>0&&ot.length>0){const mt=ot[0].lineNumber;if(mt===nt.startLineNumber)for(let St=0;!gt&&St<rt.length;St++)rt[St].lineNumber===mt&&(gt=rt[St].ranges[0]);const vt=ot[ot.length-1].lineNumber;if(vt===nt.endLineNumber)for(let St=rt.length-1;!pt&&St>=0;St--)rt[St].lineNumber===vt&&(pt=rt[St].ranges[0]);gt&&!gt.startStyle&&(gt=null),pt&&!pt.startStyle&&(pt=null)}for(let mt=0,vt=ot.length;mt<vt;mt++){const St=ot[mt].ranges[0],yt=St.left,wt=St.left+St.width,Lt={top:0,bottom:0},xt={top:0,bottom:0};if(mt>0){const It=ot[mt-1].ranges[0].left,kt=ot[mt-1].ranges[0].left+ot[mt-1].ranges[0].width;abs(yt-It)<ut?Lt.top=2:yt>It&&(Lt.top=1),abs(wt-kt)<ut?xt.top=2:It<wt&&wt<kt&&(xt.top=1)}else gt&&(Lt.top=gt.startStyle.top,xt.top=gt.endStyle.top);if(mt+1<vt){const It=ot[mt+1].ranges[0].left,kt=ot[mt+1].ranges[0].left+ot[mt+1].ranges[0].width;abs(yt-It)<ut?Lt.bottom=2:It<yt&&yt<kt&&(Lt.bottom=1),abs(wt-kt)<ut?xt.bottom=2:wt<kt&&(xt.bottom=1)}else pt&&(Lt.bottom=pt.startStyle.bottom,xt.bottom=pt.endStyle.bottom);St.startStyle=Lt,St.endStyle=xt}}_getVisibleRangesWithStyle(nt,ot,rt){const gt=(ot.linesVisibleRangesForRange(nt,!0)||[]).map(toStyled);return!this._visibleRangesHaveGaps(gt)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(ot.visibleRange,gt,rt),gt}_createSelectionPiece(nt,ot,rt,ut,gt){return'<div class="cslr '+rt+'" style="top:'+nt.toString()+"px;left:"+ut.toString()+"px;width:"+gt.toString()+"px;height:"+ot+'px;"></div>'}_actualRenderOneSelection(nt,ot,rt,ut){if(ut.length===0)return;const gt=!!ut[0].ranges[0].startStyle,pt=this._lineHeight.toString(),mt=(this._lineHeight-1).toString(),vt=ut[0].lineNumber,St=ut[ut.length-1].lineNumber;for(let yt=0,wt=ut.length;yt<wt;yt++){const Lt=ut[yt],xt=Lt.lineNumber,It=xt-ot,kt=rt&&(xt===St||xt===vt)?mt:pt,At=rt&&xt===vt?1:0;let Tt="",Rt="";for(let Nt=0,Pt=Lt.ranges.length;Nt<Pt;Nt++){const Ft=Lt.ranges[Nt];if(gt){const Bt=Ft.startStyle,Ut=Ft.endStyle;if(Bt.top===1||Bt.bottom===1){Tt+=this._createSelectionPiece(At,kt,SelectionsOverlay.SELECTION_CLASS_NAME,Ft.left-SelectionsOverlay.ROUNDED_PIECE_WIDTH,SelectionsOverlay.ROUNDED_PIECE_WIDTH);let qt=SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;Bt.top===1&&(qt+=" "+SelectionsOverlay.SELECTION_TOP_RIGHT),Bt.bottom===1&&(qt+=" "+SelectionsOverlay.SELECTION_BOTTOM_RIGHT),Tt+=this._createSelectionPiece(At,kt,qt,Ft.left-SelectionsOverlay.ROUNDED_PIECE_WIDTH,SelectionsOverlay.ROUNDED_PIECE_WIDTH)}if(Ut.top===1||Ut.bottom===1){Tt+=this._createSelectionPiece(At,kt,SelectionsOverlay.SELECTION_CLASS_NAME,Ft.left+Ft.width,SelectionsOverlay.ROUNDED_PIECE_WIDTH);let qt=SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;Ut.top===1&&(qt+=" "+SelectionsOverlay.SELECTION_TOP_LEFT),Ut.bottom===1&&(qt+=" "+SelectionsOverlay.SELECTION_BOTTOM_LEFT),Tt+=this._createSelectionPiece(At,kt,qt,Ft.left+Ft.width,SelectionsOverlay.ROUNDED_PIECE_WIDTH)}}let Kt=SelectionsOverlay.SELECTION_CLASS_NAME;if(gt){const Bt=Ft.startStyle,Ut=Ft.endStyle;Bt.top===0&&(Kt+=" "+SelectionsOverlay.SELECTION_TOP_LEFT),Bt.bottom===0&&(Kt+=" "+SelectionsOverlay.SELECTION_BOTTOM_LEFT),Ut.top===0&&(Kt+=" "+SelectionsOverlay.SELECTION_TOP_RIGHT),Ut.bottom===0&&(Kt+=" "+SelectionsOverlay.SELECTION_BOTTOM_RIGHT)}Rt+=this._createSelectionPiece(At,kt,Kt,Ft.left,Ft.width)}nt[It][0]+=Tt,nt[It][1]+=Rt}}prepareRender(nt){const ot=[],rt=nt.visibleRange.startLineNumber,ut=nt.visibleRange.endLineNumber;for(let pt=rt;pt<=ut;pt++){const mt=pt-rt;ot[mt]=["",""]}const gt=[];for(let pt=0,mt=this._selections.length;pt<mt;pt++){const vt=this._selections[pt];if(vt.isEmpty()){gt[pt]=null;continue}const St=this._getVisibleRangesWithStyle(vt,nt,this._previousFrameVisibleRangesWithStyle[pt]);gt[pt]=St,this._actualRenderOneSelection(ot,rt,this._selections.length>1,St)}this._previousFrameVisibleRangesWithStyle=gt,this._renderResult=ot.map(([pt,mt])=>pt+mt)}render(nt,ot){if(!this._renderResult)return"";const rt=ot-nt;return rt<0||rt>=this._renderResult.length?"":this._renderResult[rt]}}SelectionsOverlay.SELECTION_CLASS_NAME="selected-text";SelectionsOverlay.SELECTION_TOP_LEFT="top-left-radius";SelectionsOverlay.SELECTION_BOTTOM_LEFT="bottom-left-radius";SelectionsOverlay.SELECTION_TOP_RIGHT="top-right-radius";SelectionsOverlay.SELECTION_BOTTOM_RIGHT="bottom-right-radius";SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";SelectionsOverlay.ROUNDED_PIECE_WIDTH=10;registerThemingParticipant((ct,nt)=>{const ot=ct.getColor(editorSelectionForeground);ot&&!ot.isTransparent()&&nt.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${ot}; }`)});function abs(ct){return ct<0?-ct:ct}const viewCursors="";class ViewCursorRenderData{constructor(nt,ot,rt,ut,gt,pt,mt){this.top=nt,this.left=ot,this.paddingLeft=rt,this.width=ut,this.height=gt,this.textContent=pt,this.textContentClassName=mt}}class ViewCursor{constructor(nt){this._context=nt;const ot=this._context.configuration.options,rt=ot.get(48);this._cursorStyle=ot.get(26),this._lineHeight=ot.get(64),this._typicalHalfwidthCharacterWidth=rt.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(ot.get(29),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setClassName(`cursor ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),applyFontInfo(this._domNode,rt),this._domNode.setDisplay("none"),this._position=new Position$1(1,1),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(nt){const ot=this._context.configuration.options,rt=ot.get(48);return this._cursorStyle=ot.get(26),this._lineHeight=ot.get(64),this._typicalHalfwidthCharacterWidth=rt.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(ot.get(29),this._typicalHalfwidthCharacterWidth),applyFontInfo(this._domNode,rt),!0}onCursorPositionChanged(nt,ot){return ot?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=nt,!0}_getGraphemeAwarePosition(){const{lineNumber:nt,column:ot}=this._position,rt=this._context.viewModel.getLineContent(nt),[ut,gt]=getCharContainingOffset(rt,ot-1);return[new Position$1(nt,ut+1),rt.substring(ut,gt)]}_prepareRender(nt){let ot="",rt="";const[ut,gt]=this._getGraphemeAwarePosition();if(this._cursorStyle===TextEditorCursorStyle$1.Line||this._cursorStyle===TextEditorCursorStyle$1.LineThin){const Lt=nt.visibleRangeForPosition(ut);if(!Lt||Lt.outsideRenderedLine)return null;let xt;this._cursorStyle===TextEditorCursorStyle$1.Line?(xt=computeScreenAwareSize(this._lineCursorWidth>0?this._lineCursorWidth:2),xt>2&&(ot=gt,rt=this._getTokenClassName(ut))):xt=computeScreenAwareSize(1);let It=Lt.left,kt=0;xt>=2&&It>=1&&(kt=1,It-=kt);const At=nt.getVerticalOffsetForLineNumber(ut.lineNumber)-nt.bigNumbersDelta;return new ViewCursorRenderData(At,It,kt,xt,this._lineHeight,ot,rt)}const pt=nt.linesVisibleRangesForRange(new Range$2(ut.lineNumber,ut.column,ut.lineNumber,ut.column+gt.length),!1);if(!pt||pt.length===0)return null;const mt=pt[0];if(mt.outsideRenderedLine||mt.ranges.length===0)return null;const vt=mt.ranges[0],St=gt==="	"?this._typicalHalfwidthCharacterWidth:vt.width<1?this._typicalHalfwidthCharacterWidth:vt.width;this._cursorStyle===TextEditorCursorStyle$1.Block&&(ot=gt,rt=this._getTokenClassName(ut));let yt=nt.getVerticalOffsetForLineNumber(ut.lineNumber)-nt.bigNumbersDelta,wt=this._lineHeight;return(this._cursorStyle===TextEditorCursorStyle$1.Underline||this._cursorStyle===TextEditorCursorStyle$1.UnderlineThin)&&(yt+=this._lineHeight-2,wt=2),new ViewCursorRenderData(yt,vt.left,0,St,wt,ot,rt)}_getTokenClassName(nt){const ot=this._context.viewModel.getViewLineData(nt.lineNumber),rt=ot.tokens.findTokenIndexAtOffset(nt.column-1);return ot.tokens.getClassName(rt)}prepareRender(nt){this._renderData=this._prepareRender(nt)}render(nt){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}class ViewCursors extends ViewPart{constructor(nt){super(nt);const ot=this._context.configuration.options;this._readOnly=ot.get(87),this._cursorBlinking=ot.get(24),this._cursorStyle=ot.get(26),this._cursorSmoothCaretAnimation=ot.get(25),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new ViewCursor(this._context),this._secondaryCursors=[],this._renderData=[],this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new TimeoutTimer,this._cursorFlatBlinkInterval=new IntervalTimer,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(nt){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(nt){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(nt){const ot=this._context.configuration.options;this._readOnly=ot.get(87),this._cursorBlinking=ot.get(24),this._cursorStyle=ot.get(26),this._cursorSmoothCaretAnimation=ot.get(25),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(nt);for(let rt=0,ut=this._secondaryCursors.length;rt<ut;rt++)this._secondaryCursors[rt].onConfigurationChanged(nt);return!0}_onCursorPositionChanged(nt,ot,rt){const ut=this._secondaryCursors.length!==ot.length||this._cursorSmoothCaretAnimation==="explicit"&&rt!==3;if(this._primaryCursor.onCursorPositionChanged(nt,ut),this._updateBlinking(),this._secondaryCursors.length<ot.length){const gt=ot.length-this._secondaryCursors.length;for(let pt=0;pt<gt;pt++){const mt=new ViewCursor(this._context);this._domNode.domNode.insertBefore(mt.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(mt)}}else if(this._secondaryCursors.length>ot.length){const gt=this._secondaryCursors.length-ot.length;for(let pt=0;pt<gt;pt++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let gt=0;gt<ot.length;gt++)this._secondaryCursors[gt].onCursorPositionChanged(ot[gt],ut)}onCursorStateChanged(nt){const ot=[];for(let ut=0,gt=nt.selections.length;ut<gt;ut++)ot[ut]=nt.selections[ut].getPosition();this._onCursorPositionChanged(ot[0],ot.slice(1),nt.reason);const rt=nt.selections[0].isEmpty();return this._selectionIsEmpty!==rt&&(this._selectionIsEmpty=rt,this._updateDomClassName()),!0}onDecorationsChanged(nt){return!0}onFlushed(nt){return!0}onFocusChanged(nt){return this._editorHasFocus=nt.isFocused,this._updateBlinking(),!1}onLinesChanged(nt){return!0}onLinesDeleted(nt){return!0}onLinesInserted(nt){return!0}onScrollChanged(nt){return!0}onTokensChanged(nt){const ot=rt=>{for(let ut=0,gt=nt.ranges.length;ut<gt;ut++)if(nt.ranges[ut].fromLineNumber<=rt.lineNumber&&rt.lineNumber<=nt.ranges[ut].toLineNumber)return!0;return!1};if(ot(this._primaryCursor.getPosition()))return!0;for(const rt of this._secondaryCursors)if(ot(rt.getPosition()))return!0;return!1}onZonesChanged(nt){return!0}_getCursorBlinking(){return this._isComposingInput||!this._editorHasFocus?0:this._readOnly?5:this._cursorBlinking}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const nt=this._getCursorBlinking(),ot=nt===0,rt=nt===5;ot?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!ot&&!rt&&(nt===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},ViewCursors.BLINK_INTERVAL):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},ViewCursors.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let nt="cursors-layer";switch(this._selectionIsEmpty||(nt+=" has-selection"),this._cursorStyle){case TextEditorCursorStyle$1.Line:nt+=" cursor-line-style";break;case TextEditorCursorStyle$1.Block:nt+=" cursor-block-style";break;case TextEditorCursorStyle$1.Underline:nt+=" cursor-underline-style";break;case TextEditorCursorStyle$1.LineThin:nt+=" cursor-line-thin-style";break;case TextEditorCursorStyle$1.BlockOutline:nt+=" cursor-block-outline-style";break;case TextEditorCursorStyle$1.UnderlineThin:nt+=" cursor-underline-thin-style";break;default:nt+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:nt+=" cursor-blink";break;case 2:nt+=" cursor-smooth";break;case 3:nt+=" cursor-phase";break;case 4:nt+=" cursor-expand";break;case 5:nt+=" cursor-solid";break;default:nt+=" cursor-solid"}else nt+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(nt+=" cursor-smooth-caret-animation"),nt}_show(){this._primaryCursor.show();for(let nt=0,ot=this._secondaryCursors.length;nt<ot;nt++)this._secondaryCursors[nt].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let nt=0,ot=this._secondaryCursors.length;nt<ot;nt++)this._secondaryCursors[nt].hide();this._isVisible=!1}prepareRender(nt){this._primaryCursor.prepareRender(nt);for(let ot=0,rt=this._secondaryCursors.length;ot<rt;ot++)this._secondaryCursors[ot].prepareRender(nt)}render(nt){const ot=[];let rt=0;const ut=this._primaryCursor.render(nt);ut&&(ot[rt++]=ut);for(let gt=0,pt=this._secondaryCursors.length;gt<pt;gt++){const mt=this._secondaryCursors[gt].render(nt);mt&&(ot[rt++]=mt)}this._renderData=ot}getLastRenderData(){return this._renderData}}ViewCursors.BLINK_INTERVAL=500;registerThemingParticipant((ct,nt)=>{const ot=ct.getColor(editorCursorForeground);if(ot){let rt=ct.getColor(editorCursorBackground);rt||(rt=ot.opposite()),nt.addRule(`.monaco-editor .cursors-layer .cursor { background-color: ${ot}; border-color: ${ot}; color: ${rt}; }`),isHighContrast(ct.type)&&nt.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${rt}; border-right: 1px solid ${rt}; }`)}});const invalidFunc$1=()=>{throw new Error("Invalid change accessor")};class ViewZones extends ViewPart{constructor(nt){super(nt);const ot=this._context.configuration.options,rt=ot.get(139);this._lineHeight=ot.get(64),this._contentWidth=rt.contentWidth,this._contentLeft=rt.contentLeft,this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=createFastDomNode(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const nt=this._context.viewLayout.getWhitespaces(),ot=new Map;for(const ut of nt)ot.set(ut.id,ut);let rt=!1;return this._context.viewModel.changeWhitespace(ut=>{const gt=Object.keys(this._zones);for(let pt=0,mt=gt.length;pt<mt;pt++){const vt=gt[pt],St=this._zones[vt],yt=this._computeWhitespaceProps(St.delegate);St.isInHiddenArea=yt.isInHiddenArea;const wt=ot.get(vt);wt&&(wt.afterLineNumber!==yt.afterViewLineNumber||wt.height!==yt.heightInPx)&&(ut.changeOneWhitespace(vt,yt.afterViewLineNumber,yt.heightInPx),this._safeCallOnComputedHeight(St.delegate,yt.heightInPx),rt=!0)}}),rt}onConfigurationChanged(nt){const ot=this._context.configuration.options,rt=ot.get(139);return this._lineHeight=ot.get(64),this._contentWidth=rt.contentWidth,this._contentLeft=rt.contentLeft,nt.hasChanged(64)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(nt){return this._recomputeWhitespacesProps()}onLinesDeleted(nt){return!0}onScrollChanged(nt){return nt.scrollTopChanged||nt.scrollWidthChanged}onZonesChanged(nt){return!0}onLinesInserted(nt){return!0}_getZoneOrdinal(nt){var ot,rt;return(rt=(ot=nt.ordinal)!==null&&ot!==void 0?ot:nt.afterColumn)!==null&&rt!==void 0?rt:1e4}_computeWhitespaceProps(nt){if(nt.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(nt),minWidthInPx:this._minWidthInPixels(nt)};let ot;if(typeof nt.afterColumn<"u")ot=this._context.viewModel.model.validatePosition({lineNumber:nt.afterLineNumber,column:nt.afterColumn});else{const pt=this._context.viewModel.model.validatePosition({lineNumber:nt.afterLineNumber,column:1}).lineNumber;ot=new Position$1(pt,this._context.viewModel.model.getLineMaxColumn(pt))}let rt;ot.column===this._context.viewModel.model.getLineMaxColumn(ot.lineNumber)?rt=this._context.viewModel.model.validatePosition({lineNumber:ot.lineNumber+1,column:1}):rt=this._context.viewModel.model.validatePosition({lineNumber:ot.lineNumber,column:ot.column+1});const ut=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(ot,nt.afterColumnAffinity),gt=nt.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(rt);return{isInHiddenArea:!gt,afterViewLineNumber:ut.lineNumber,heightInPx:gt?this._heightInPixels(nt):0,minWidthInPx:this._minWidthInPixels(nt)}}changeViewZones(nt){let ot=!1;return this._context.viewModel.changeWhitespace(rt=>{const ut={addZone:gt=>(ot=!0,this._addZone(rt,gt)),removeZone:gt=>{gt&&(ot=this._removeZone(rt,gt)||ot)},layoutZone:gt=>{gt&&(ot=this._layoutZone(rt,gt)||ot)}};safeInvoke1Arg(nt,ut),ut.addZone=invalidFunc$1,ut.removeZone=invalidFunc$1,ut.layoutZone=invalidFunc$1}),ot}_addZone(nt,ot){const rt=this._computeWhitespaceProps(ot),gt={whitespaceId:nt.insertWhitespace(rt.afterViewLineNumber,this._getZoneOrdinal(ot),rt.heightInPx,rt.minWidthInPx),delegate:ot,isInHiddenArea:rt.isInHiddenArea,isVisible:!1,domNode:createFastDomNode(ot.domNode),marginDomNode:ot.marginDomNode?createFastDomNode(ot.marginDomNode):null};return this._safeCallOnComputedHeight(gt.delegate,rt.heightInPx),gt.domNode.setPosition("absolute"),gt.domNode.domNode.style.width="100%",gt.domNode.setDisplay("none"),gt.domNode.setAttribute("monaco-view-zone",gt.whitespaceId),this.domNode.appendChild(gt.domNode),gt.marginDomNode&&(gt.marginDomNode.setPosition("absolute"),gt.marginDomNode.domNode.style.width="100%",gt.marginDomNode.setDisplay("none"),gt.marginDomNode.setAttribute("monaco-view-zone",gt.whitespaceId),this.marginDomNode.appendChild(gt.marginDomNode)),this._zones[gt.whitespaceId]=gt,this.setShouldRender(),gt.whitespaceId}_removeZone(nt,ot){if(this._zones.hasOwnProperty(ot)){const rt=this._zones[ot];return delete this._zones[ot],nt.removeWhitespace(rt.whitespaceId),rt.domNode.removeAttribute("monaco-visible-view-zone"),rt.domNode.removeAttribute("monaco-view-zone"),rt.domNode.domNode.parentNode.removeChild(rt.domNode.domNode),rt.marginDomNode&&(rt.marginDomNode.removeAttribute("monaco-visible-view-zone"),rt.marginDomNode.removeAttribute("monaco-view-zone"),rt.marginDomNode.domNode.parentNode.removeChild(rt.marginDomNode.domNode)),this.setShouldRender(),!0}return!1}_layoutZone(nt,ot){if(this._zones.hasOwnProperty(ot)){const rt=this._zones[ot],ut=this._computeWhitespaceProps(rt.delegate);return rt.isInHiddenArea=ut.isInHiddenArea,nt.changeOneWhitespace(rt.whitespaceId,ut.afterViewLineNumber,ut.heightInPx),this._safeCallOnComputedHeight(rt.delegate,ut.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(nt){return this._zones.hasOwnProperty(nt)?!!this._zones[nt].delegate.suppressMouseDown:!1}_heightInPixels(nt){return typeof nt.heightInPx=="number"?nt.heightInPx:typeof nt.heightInLines=="number"?this._lineHeight*nt.heightInLines:this._lineHeight}_minWidthInPixels(nt){return typeof nt.minWidthInPx=="number"?nt.minWidthInPx:0}_safeCallOnComputedHeight(nt,ot){if(typeof nt.onComputedHeight=="function")try{nt.onComputedHeight(ot)}catch(rt){onUnexpectedError(rt)}}_safeCallOnDomNodeTop(nt,ot){if(typeof nt.onDomNodeTop=="function")try{nt.onDomNodeTop(ot)}catch(rt){onUnexpectedError(rt)}}prepareRender(nt){}render(nt){const ot=nt.viewportData.whitespaceViewportData,rt={};let ut=!1;for(const pt of ot)this._zones[pt.id].isInHiddenArea||(rt[pt.id]=pt,ut=!0);const gt=Object.keys(this._zones);for(let pt=0,mt=gt.length;pt<mt;pt++){const vt=gt[pt],St=this._zones[vt];let yt=0,wt=0,Lt="none";rt.hasOwnProperty(vt)?(yt=rt[vt].verticalOffset-nt.bigNumbersDelta,wt=rt[vt].height,Lt="block",St.isVisible||(St.domNode.setAttribute("monaco-visible-view-zone","true"),St.isVisible=!0),this._safeCallOnDomNodeTop(St.delegate,nt.getScrolledTopFromAbsoluteTop(rt[vt].verticalOffset))):(St.isVisible&&(St.domNode.removeAttribute("monaco-visible-view-zone"),St.isVisible=!1),this._safeCallOnDomNodeTop(St.delegate,nt.getScrolledTopFromAbsoluteTop(-1e6))),St.domNode.setTop(yt),St.domNode.setHeight(wt),St.domNode.setDisplay(Lt),St.marginDomNode&&(St.marginDomNode.setTop(yt),St.marginDomNode.setHeight(wt),St.marginDomNode.setDisplay(Lt))}ut&&(this.domNode.setWidth(Math.max(nt.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function safeInvoke1Arg(ct,nt){try{return ct(nt)}catch(ot){onUnexpectedError(ot)}}class EditorTheme{get type(){return this._theme.type}get value(){return this._theme}constructor(nt){this._theme=nt}update(nt){this._theme=nt}getColor(nt){return this._theme.getColor(nt)}}class ViewContext{constructor(nt,ot,rt){this.configuration=nt,this.theme=new EditorTheme(ot),this.viewModel=rt,this.viewLayout=rt.viewLayout}addEventHandler(nt){this.viewModel.addViewEventHandler(nt)}removeEventHandler(nt){this.viewModel.removeViewEventHandler(nt)}}class ViewportData{constructor(nt,ot,rt,ut){this.selections=nt,this.startLineNumber=ot.startLineNumber|0,this.endLineNumber=ot.endLineNumber|0,this.relativeVerticalOffset=ot.relativeVerticalOffset,this.bigNumbersDelta=ot.bigNumbersDelta|0,this.whitespaceViewportData=rt,this._model=ut,this.visibleRange=new Range$2(ot.startLineNumber,this._model.getLineMinColumn(ot.startLineNumber),ot.endLineNumber,this._model.getLineMaxColumn(ot.endLineNumber))}getViewLineRenderingData(nt){return this._model.getViewportViewLineRenderingData(this.visibleRange,nt)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}const blockDecorations="";class BlockDecorations extends ViewPart{constructor(nt){super(nt),this.blocks=[],this.contentWidth=-1,this.contentLeft=0,this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let nt=!1;const rt=this._context.configuration.options.get(139),ut=rt.contentWidth-rt.verticalScrollbarWidth;this.contentWidth!==ut&&(this.contentWidth=ut,nt=!0);const gt=rt.contentLeft;return this.contentLeft!==gt&&(this.contentLeft=gt,nt=!0),nt}dispose(){super.dispose()}onConfigurationChanged(nt){return this.update()}onScrollChanged(nt){return nt.scrollTopChanged||nt.scrollLeftChanged}onDecorationsChanged(nt){return!0}onZonesChanged(nt){return!0}prepareRender(nt){}render(nt){var ot;let rt=0;const ut=nt.getDecorationsInViewport();for(const gt of ut){if(!gt.options.blockClassName)continue;let pt=this.blocks[rt];pt||(pt=this.blocks[rt]=createFastDomNode(document.createElement("div")),this.domNode.appendChild(pt));let mt,vt;gt.options.blockIsAfterEnd?(mt=nt.getVerticalOffsetAfterLineNumber(gt.range.endLineNumber,!1),vt=nt.getVerticalOffsetAfterLineNumber(gt.range.endLineNumber,!0)):(mt=nt.getVerticalOffsetForLineNumber(gt.range.startLineNumber,!0),vt=gt.range.isEmpty()&&!gt.options.blockDoesNotCollapse?nt.getVerticalOffsetForLineNumber(gt.range.startLineNumber,!1):nt.getVerticalOffsetAfterLineNumber(gt.range.endLineNumber,!0));const[St,yt,wt,Lt]=(ot=gt.options.blockPadding)!==null&&ot!==void 0?ot:[0,0,0,0];pt.setClassName("blockDecorations-block "+gt.options.blockClassName),pt.setLeft(this.contentLeft-Lt),pt.setWidth(this.contentWidth+Lt+yt),pt.setTop(mt-nt.scrollTop-St),pt.setHeight(vt-mt+St+wt),rt++}for(let gt=rt;gt<this.blocks.length;gt++)this.blocks[gt].domNode.remove();this.blocks.length=rt}}const whitespace="";class WhitespaceOverlay extends DynamicViewOverlay{constructor(nt){super(),this._context=nt,this._options=new WhitespaceOptions(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(nt){const ot=new WhitespaceOptions(this._context.configuration);return this._options.equals(ot)?nt.hasChanged(139):(this._options=ot,!0)}onCursorStateChanged(nt){return this._selection=nt.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(nt){return!0}onFlushed(nt){return!0}onLinesChanged(nt){return!0}onLinesDeleted(nt){return!0}onLinesInserted(nt){return!0}onScrollChanged(nt){return nt.scrollTopChanged}onZonesChanged(nt){return!0}prepareRender(nt){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}const ot=nt.visibleRange.startLineNumber,ut=nt.visibleRange.endLineNumber-ot+1,gt=new Array(ut);for(let mt=0;mt<ut;mt++)gt[mt]=!0;const pt=this._context.viewModel.getMinimapLinesRenderingData(nt.viewportData.startLineNumber,nt.viewportData.endLineNumber,gt);this._renderResult=[];for(let mt=nt.viewportData.startLineNumber;mt<=nt.viewportData.endLineNumber;mt++){const vt=mt-nt.viewportData.startLineNumber,St=pt.data[vt];let yt=null;if(this._options.renderWhitespace==="selection"){const wt=this._selection;for(const Lt of wt){if(Lt.endLineNumber<mt||Lt.startLineNumber>mt)continue;const xt=Lt.startLineNumber===mt?Lt.startColumn:St.minColumn,It=Lt.endLineNumber===mt?Lt.endColumn:St.maxColumn;xt<It&&(yt||(yt=[]),yt.push(new LineRange(xt-1,It-1)))}}this._renderResult[vt]=this._applyRenderWhitespace(nt,mt,yt,St)}}_applyRenderWhitespace(nt,ot,rt,ut){if(this._options.renderWhitespace==="selection"&&!rt||this._options.renderWhitespace==="trailing"&&ut.continuesWithWrappedLine)return"";const gt=this._context.theme.getColor(editorWhitespaces),pt=this._options.renderWithSVG,mt=ut.content,vt=this._options.stopRenderingLineAfter===-1?mt.length:Math.min(this._options.stopRenderingLineAfter,mt.length),St=ut.continuesWithWrappedLine,yt=ut.minColumn-1,wt=this._options.renderWhitespace==="boundary",Lt=this._options.renderWhitespace==="trailing",xt=this._options.lineHeight,It=this._options.middotWidth,kt=this._options.wsmiddotWidth,At=this._options.spaceWidth,Tt=Math.abs(kt-At),Rt=Math.abs(It-At),Nt=Tt<Rt?11825:183,Pt=this._options.canUseHalfwidthRightwardsArrow;let Ft="",Kt=!1,Bt=firstNonWhitespaceIndex(mt),Ut;Bt===-1?(Kt=!0,Bt=vt,Ut=vt):Ut=lastNonWhitespaceIndex(mt);let qt=0,Yt=rt&&rt[qt],Zt=0;for(let Xt=yt;Xt<vt;Xt++){const _i=mt.charCodeAt(Xt);if(Yt&&Xt>=Yt.endOffset&&(qt++,Yt=rt&&rt[qt]),_i!==9&&_i!==32||Lt&&!Kt&&Xt<=Ut)continue;if(wt&&Xt>=Bt&&Xt<=Ut&&_i===32){const rn=Xt-1>=0?mt.charCodeAt(Xt-1):0,dn=Xt+1<vt?mt.charCodeAt(Xt+1):0;if(rn!==32&&dn!==32)continue}if(wt&&St&&Xt===vt-1){const rn=Xt-1>=0?mt.charCodeAt(Xt-1):0;if(_i===32&&rn!==32&&rn!==9)continue}if(rt&&(!Yt||Yt.startOffset>Xt||Yt.endOffset<=Xt))continue;const nn=nt.visibleRangeForPosition(new Position$1(ot,Xt+1));nn&&(pt?(Zt=Math.max(Zt,nn.left),_i===9?Ft+=this._renderArrow(xt,At,nn.left):Ft+=`<circle cx="${(nn.left+At/2).toFixed(2)}" cy="${(xt/2).toFixed(2)}" r="${(At/7).toFixed(2)}" />`):_i===9?Ft+=`<div class="mwh" style="left:${nn.left}px;height:${xt}px;">${Pt?String.fromCharCode(65515):String.fromCharCode(8594)}</div>`:Ft+=`<div class="mwh" style="left:${nn.left}px;height:${xt}px;">${String.fromCharCode(Nt)}</div>`)}return pt?(Zt=Math.round(Zt+At),`<svg style="position:absolute;width:${Zt}px;height:${xt}px" viewBox="0 0 ${Zt} ${xt}" xmlns="http://www.w3.org/2000/svg" fill="${gt}">`+Ft+"</svg>"):Ft}_renderArrow(nt,ot,rt){const ut=ot/7,gt=ot,pt=nt/2,mt=rt,vt={x:0,y:ut/2},St={x:100/125*gt,y:vt.y},yt={x:St.x-.2*St.x,y:St.y+.2*St.x},wt={x:yt.x+.1*St.x,y:yt.y+.1*St.x},Lt={x:wt.x+.35*St.x,y:wt.y-.35*St.x},xt={x:Lt.x,y:-Lt.y},It={x:wt.x,y:-wt.y},kt={x:yt.x,y:-yt.y},At={x:St.x,y:-St.y},Tt={x:vt.x,y:-vt.y};return`<path d="M ${[vt,St,yt,wt,Lt,xt,It,kt,At,Tt].map(Pt=>`${(mt+Pt.x).toFixed(2)} ${(pt+Pt.y).toFixed(2)}`).join(" L ")}" />`}render(nt,ot){if(!this._renderResult)return"";const rt=ot-nt;return rt<0||rt>=this._renderResult.length?"":this._renderResult[rt]}}class WhitespaceOptions{constructor(nt){const ot=nt.options,rt=ot.get(48),ut=ot.get(36);ut==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):ut==="svg"?(this.renderWhitespace=ot.get(94),this.renderWithSVG=!0):(this.renderWhitespace=ot.get(94),this.renderWithSVG=!1),this.spaceWidth=rt.spaceWidth,this.middotWidth=rt.middotWidth,this.wsmiddotWidth=rt.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=rt.canUseHalfwidthRightwardsArrow,this.lineHeight=ot.get(64),this.stopRenderingLineAfter=ot.get(112)}equals(nt){return this.renderWhitespace===nt.renderWhitespace&&this.renderWithSVG===nt.renderWithSVG&&this.spaceWidth===nt.spaceWidth&&this.middotWidth===nt.middotWidth&&this.wsmiddotWidth===nt.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===nt.canUseHalfwidthRightwardsArrow&&this.lineHeight===nt.lineHeight&&this.stopRenderingLineAfter===nt.stopRenderingLineAfter}}class View extends ViewEventHandler{constructor(nt,ot,rt,ut,gt,pt){super(),this._selections=[new Selection$1(1,1,1,1)],this._renderAnimationFrame=null;const mt=new ViewController(ot,ut,gt,nt);this._context=new ViewContext(ot,rt,ut),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=new TextAreaHandler(this._context,mt,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=createFastDomNode(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=createFastDomNode(document.createElement("div")),PartFingerprints.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new EditorScrollbar(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new ViewLines(this._context,this._linesContent),this._viewZones=new ViewZones(this._context),this._viewParts.push(this._viewZones);const vt=new DecorationsOverviewRuler(this._context);this._viewParts.push(vt);const St=new ScrollDecorationViewPart(this._context);this._viewParts.push(St);const yt=new ContentViewOverlays(this._context);this._viewParts.push(yt),yt.addDynamicOverlay(new CurrentLineHighlightOverlay(this._context)),yt.addDynamicOverlay(new SelectionsOverlay(this._context)),yt.addDynamicOverlay(new IndentGuidesOverlay(this._context)),yt.addDynamicOverlay(new DecorationsOverlay(this._context)),yt.addDynamicOverlay(new WhitespaceOverlay(this._context));const wt=new MarginViewOverlays(this._context);this._viewParts.push(wt),wt.addDynamicOverlay(new CurrentLineMarginHighlightOverlay(this._context)),wt.addDynamicOverlay(new GlyphMarginOverlay(this._context)),wt.addDynamicOverlay(new MarginViewLineDecorationsOverlay(this._context)),wt.addDynamicOverlay(new LinesDecorationsOverlay(this._context)),wt.addDynamicOverlay(new LineNumbersOverlay(this._context));const Lt=new Margin(this._context);Lt.getDomNode().appendChild(this._viewZones.marginDomNode),Lt.getDomNode().appendChild(wt.getDomNode()),this._viewParts.push(Lt),this._contentWidgets=new ViewContentWidgets(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new ViewCursors(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new ViewOverlayWidgets(this._context),this._viewParts.push(this._overlayWidgets);const xt=new Rulers(this._context);this._viewParts.push(xt);const It=new BlockDecorations(this._context);this._viewParts.push(It);const kt=new Minimap(this._context);if(this._viewParts.push(kt),vt){const At=this._scrollbar.getOverviewRulerLayoutInfo();At.parent.insertBefore(vt.getDomNode(),At.insertBefore)}this._linesContent.appendChild(yt.getDomNode()),this._linesContent.appendChild(xt.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(Lt.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(St.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(kt.getDomNode()),this._overflowGuardContainer.appendChild(It.domNode),this.domNode.appendChild(this._overflowGuardContainer),pt?pt.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode):this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this._applyLayout(),this._pointerHandler=this._register(new PointerHandler(this._context,mt,this._createPointerHandlerHelper()))}_flushAccumulatedAndRenderNow(){inputLatency.onRenderStart(),this._renderNow()}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:nt=>{this._textAreaHandler.textArea.domNode.dispatchEvent(nt)},getLastRenderData:()=>{const nt=this._viewCursors.getLastRenderData()||[],ot=this._textAreaHandler.getLastRenderData();return new PointerHandlerLastRenderData(nt,ot)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:nt=>this._viewZones.shouldSuppressMouseDownOnViewZone(nt),shouldSuppressMouseDownOnWidget:nt=>this._contentWidgets.shouldSuppressMouseDownOnWidget(nt),getPositionFromDOMInfo:(nt,ot)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(nt,ot)),visibleRangeForPosition:(nt,ot)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new Position$1(nt,ot))),getLineWidth:nt=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(nt))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:nt=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(nt))}}_applyLayout(){const ot=this._context.configuration.options.get(139);this.domNode.setWidth(ot.width),this.domNode.setHeight(ot.height),this._overflowGuardContainer.setWidth(ot.width),this._overflowGuardContainer.setHeight(ot.height),this._linesContent.setWidth(1e6),this._linesContent.setHeight(1e6)}_getEditorClassName(){const nt=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(136)+" "+getThemeTypeSelector(this._context.theme.type)+nt}handleEvents(nt){super.handleEvents(nt),this._scheduleRender()}onConfigurationChanged(nt){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(nt){return this._selections=nt.selections,!1}onFocusChanged(nt){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(nt){return this._context.theme.update(nt.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const nt of this._viewParts)nt.dispose();super.dispose()}_scheduleRender(){this._renderAnimationFrame===null&&(this._renderAnimationFrame=runAtThisOrScheduleAtNextAnimationFrame(this._onRenderScheduled.bind(this),100))}_onRenderScheduled(){this._renderAnimationFrame=null,this._flushAccumulatedAndRenderNow()}_renderNow(){safeInvokeNoArg(()=>this._actualRender())}_getViewPartsToRender(){const nt=[];let ot=0;for(const rt of this._viewParts)rt.shouldRender()&&(nt[ot++]=rt);return nt}_actualRender(){if(!isInDOM(this.domNode.domNode))return;let nt=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&nt.length===0)return;const ot=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(ot.startLineNumber,ot.endLineNumber,ot.centeredLineNumber);const rt=new ViewportData(this._selections,ot,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(rt),this._viewLines.shouldRender()&&(this._viewLines.renderText(rt),this._viewLines.onDidRender(),nt=this._getViewPartsToRender());const ut=new RenderingContext(this._context.viewLayout,rt,this._viewLines);for(const gt of nt)gt.prepareRender(ut);for(const gt of nt)gt.render(ut),gt.onDidRender()}delegateVerticalScrollbarPointerDown(nt){this._scrollbar.delegateVerticalScrollbarPointerDown(nt)}delegateScrollFromMouseWheelEvent(nt){this._scrollbar.delegateScrollFromMouseWheelEvent(nt)}restoreState(nt){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:nt.scrollTop,scrollLeft:nt.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(nt,ot){const rt=this._context.viewModel.model.validatePosition({lineNumber:nt,column:ot}),ut=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(rt);this._flushAccumulatedAndRenderNow();const gt=this._viewLines.visibleRangeForPosition(new Position$1(ut.lineNumber,ut.column));return gt?gt.left:-1}getTargetAtClientPoint(nt,ot){const rt=this._pointerHandler.getTargetAtClientPoint(nt,ot);return rt?ViewUserInputEvents.convertViewToModelMouseTarget(rt,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(nt){return new OverviewRuler(this._context,nt)}change(nt){this._viewZones.changeViewZones(nt),this._scheduleRender()}render(nt,ot){if(ot){this._viewLines.forceShouldRender();for(const rt of this._viewParts)rt.forceShouldRender()}nt?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(nt){this._textAreaHandler.writeScreenReaderContent(nt)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(nt){this._textAreaHandler.setAriaOptions(nt)}addContentWidget(nt){this._contentWidgets.addWidget(nt.widget),this.layoutContentWidget(nt),this._scheduleRender()}layoutContentWidget(nt){var ot,rt,ut,gt,pt,mt,vt,St;this._contentWidgets.setWidgetPosition(nt.widget,(rt=(ot=nt.position)===null||ot===void 0?void 0:ot.position)!==null&&rt!==void 0?rt:null,(gt=(ut=nt.position)===null||ut===void 0?void 0:ut.secondaryPosition)!==null&&gt!==void 0?gt:null,(mt=(pt=nt.position)===null||pt===void 0?void 0:pt.preference)!==null&&mt!==void 0?mt:null,(St=(vt=nt.position)===null||vt===void 0?void 0:vt.positionAffinity)!==null&&St!==void 0?St:null),this._scheduleRender()}removeContentWidget(nt){this._contentWidgets.removeWidget(nt.widget),this._scheduleRender()}addOverlayWidget(nt){this._overlayWidgets.addWidget(nt.widget),this.layoutOverlayWidget(nt),this._scheduleRender()}layoutOverlayWidget(nt){const ot=nt.position?nt.position.preference:null;this._overlayWidgets.setWidgetPosition(nt.widget,ot)&&this._scheduleRender()}removeOverlayWidget(nt){this._overlayWidgets.removeWidget(nt.widget),this._scheduleRender()}}function safeInvokeNoArg(ct){try{return ct()}catch(nt){onUnexpectedError(nt)}}class InternalEditorAction{constructor(nt,ot,rt,ut,gt,pt){this.id=nt,this.label=ot,this.alias=rt,this._precondition=ut,this._run=gt,this._contextKeyService=pt}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(nt){return this.isSupported()?this._run(nt):Promise.resolve(void 0)}}function countEOL(ct){let nt=0,ot=0,rt=0,ut=0;for(let gt=0,pt=ct.length;gt<pt;gt++){const mt=ct.charCodeAt(gt);mt===13?(nt===0&&(ot=gt),nt++,gt+1<pt&&ct.charCodeAt(gt+1)===10?(ut|=2,gt++):ut|=3,rt=gt+1):mt===10&&(ut|=1,nt===0&&(ot=gt),nt++,rt=gt+1)}return nt===0&&(ot=ct.length),[nt,ot,ct.length-rt,ut]}class BracketInfo{constructor(nt,ot,rt,ut){this.range=nt,this.nestingLevel=ot,this.nestingLevelOfEqualBracketType=rt,this.isInvalid=ut}}class BracketPairInfo{constructor(nt,ot,rt,ut,gt,pt){this.range=nt,this.openingBracketRange=ot,this.closingBracketRange=rt,this.nestingLevel=ut,this.nestingLevelOfEqualBracketType=gt,this.bracketPairNode=pt}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}}class BracketPairWithMinIndentationInfo extends BracketPairInfo{constructor(nt,ot,rt,ut,gt,pt,mt){super(nt,ot,rt,ut,gt,pt),this.minVisibleColumnIndentation=mt}}class LengthObj{constructor(nt,ot){this.lineCount=nt,this.columnCount=ot}toString(){return`${this.lineCount},${this.columnCount}`}}LengthObj.zero=new LengthObj(0,0);function lengthDiff(ct,nt,ot,rt){return ct!==ot?toLength(ot-ct,rt):toLength(0,rt-nt)}const lengthZero=0;function lengthIsZero(ct){return ct===0}const factor=Math.pow(2,26);function toLength(ct,nt){return ct*factor+nt}function lengthToObj(ct){const nt=ct,ot=Math.floor(nt/factor),rt=nt-ot*factor;return new LengthObj(ot,rt)}function lengthGetLineCount(ct){return Math.floor(ct/factor)}function lengthGetColumnCountIfZeroLineCount(ct){return ct}function lengthAdd(ct,nt){let ot=ct+nt;return nt>=factor&&(ot=ot-ct%factor),ot}function sumLengths(ct,nt){return ct.reduce((ot,rt)=>lengthAdd(ot,nt(rt)),lengthZero)}function lengthEquals(ct,nt){return ct===nt}function lengthDiffNonNegative(ct,nt){const ot=ct,rt=nt;if(rt-ot<=0)return lengthZero;const gt=Math.floor(ot/factor),pt=Math.floor(rt/factor),mt=rt-pt*factor;if(gt===pt){const vt=ot-gt*factor;return toLength(0,mt-vt)}else return toLength(pt-gt,mt)}function lengthLessThan(ct,nt){return ct<nt}function lengthLessThanEqual(ct,nt){return ct<=nt}function lengthGreaterThanEqual(ct,nt){return ct>=nt}function positionToLength(ct){return toLength(ct.lineNumber-1,ct.column-1)}function lengthsToRange(ct,nt){const ot=ct,rt=Math.floor(ot/factor),ut=ot-rt*factor,gt=nt,pt=Math.floor(gt/factor),mt=gt-pt*factor;return new Range$2(rt+1,ut+1,pt+1,mt+1)}function lengthOfString(ct){const nt=splitLines(ct);return toLength(nt.length-1,nt[nt.length-1].length)}class TextEditInfo{constructor(nt,ot,rt){this.startOffset=nt,this.endOffset=ot,this.newLength=rt}toString(){return`[${lengthToObj(this.startOffset)}...${lengthToObj(this.endOffset)}) -> ${lengthToObj(this.newLength)}`}}class BeforeEditPositionMapper{constructor(nt){this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=nt.map(ot=>TextEditInfoCache.from(ot))}getOffsetBeforeChange(nt){return this.adjustNextEdit(nt),this.translateCurToOld(nt)}getDistanceToNextChange(nt){this.adjustNextEdit(nt);const ot=this.edits[this.nextEditIdx],rt=ot?this.translateOldToCur(ot.offsetObj):null;return rt===null?null:lengthDiffNonNegative(nt,rt)}translateOldToCur(nt){return nt.lineCount===this.deltaLineIdxInOld?toLength(nt.lineCount+this.deltaOldToNewLineCount,nt.columnCount+this.deltaOldToNewColumnCount):toLength(nt.lineCount+this.deltaOldToNewLineCount,nt.columnCount)}translateCurToOld(nt){const ot=lengthToObj(nt);return ot.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?toLength(ot.lineCount-this.deltaOldToNewLineCount,ot.columnCount-this.deltaOldToNewColumnCount):toLength(ot.lineCount-this.deltaOldToNewLineCount,ot.columnCount)}adjustNextEdit(nt){for(;this.nextEditIdx<this.edits.length;){const ot=this.edits[this.nextEditIdx],rt=this.translateOldToCur(ot.endOffsetAfterObj);if(lengthLessThanEqual(rt,nt)){this.nextEditIdx++;const ut=lengthToObj(rt),gt=lengthToObj(this.translateOldToCur(ot.endOffsetBeforeObj)),pt=ut.lineCount-gt.lineCount;this.deltaOldToNewLineCount+=pt;const mt=this.deltaLineIdxInOld===ot.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,vt=ut.columnCount-gt.columnCount;this.deltaOldToNewColumnCount=mt+vt,this.deltaLineIdxInOld=ot.endOffsetBeforeObj.lineCount}else break}}}class TextEditInfoCache{static from(nt){return new TextEditInfoCache(nt.startOffset,nt.endOffset,nt.newLength)}constructor(nt,ot,rt){this.endOffsetBeforeObj=lengthToObj(ot),this.endOffsetAfterObj=lengthToObj(lengthAdd(nt,rt)),this.offsetObj=lengthToObj(nt)}}const emptyArr=[];class SmallImmutableSet{static create(nt,ot){if(nt<=128&&ot.length===0){let rt=SmallImmutableSet.cache[nt];return rt||(rt=new SmallImmutableSet(nt,ot),SmallImmutableSet.cache[nt]=rt),rt}return new SmallImmutableSet(nt,ot)}static getEmpty(){return this.empty}constructor(nt,ot){this.items=nt,this.additionalItems=ot}add(nt,ot){const rt=ot.getKey(nt);let ut=rt>>5;if(ut===0){const pt=1<<rt|this.items;return pt===this.items?this:SmallImmutableSet.create(pt,this.additionalItems)}ut--;const gt=this.additionalItems.slice(0);for(;gt.length<ut;)gt.push(0);return gt[ut]|=1<<(rt&31),SmallImmutableSet.create(this.items,gt)}merge(nt){const ot=this.items|nt.items;if(this.additionalItems===emptyArr&&nt.additionalItems===emptyArr)return ot===this.items?this:ot===nt.items?nt:SmallImmutableSet.create(ot,emptyArr);const rt=[];for(let ut=0;ut<Math.max(this.additionalItems.length,nt.additionalItems.length);ut++){const gt=this.additionalItems[ut]||0,pt=nt.additionalItems[ut]||0;rt.push(gt|pt)}return SmallImmutableSet.create(ot,rt)}intersects(nt){if(this.items&nt.items)return!0;for(let ot=0;ot<Math.min(this.additionalItems.length,nt.additionalItems.length);ot++)if(this.additionalItems[ot]&nt.additionalItems[ot])return!0;return!1}}SmallImmutableSet.cache=new Array(129);SmallImmutableSet.empty=SmallImmutableSet.create(0,emptyArr);const identityKeyProvider={getKey(ct){return ct}};class DenseKeyProvider{constructor(){this.items=new Map}getKey(nt){let ot=this.items.get(nt);return ot===void 0&&(ot=this.items.size,this.items.set(nt,ot)),ot}}class BaseAstNode{get length(){return this._length}constructor(nt){this._length=nt}}class PairAstNode extends BaseAstNode{static create(nt,ot,rt){let ut=nt.length;return ot&&(ut=lengthAdd(ut,ot.length)),rt&&(ut=lengthAdd(ut,rt.length)),new PairAstNode(ut,nt,ot,rt,ot?ot.missingOpeningBracketIds:SmallImmutableSet.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(nt){switch(nt){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const nt=[];return nt.push(this.openingBracket),this.child&&nt.push(this.child),this.closingBracket&&nt.push(this.closingBracket),nt}constructor(nt,ot,rt,ut,gt){super(nt),this.openingBracket=ot,this.child=rt,this.closingBracket=ut,this.missingOpeningBracketIds=gt}canBeReused(nt){return!(this.closingBracket===null||nt.intersects(this.missingOpeningBracketIds))}deepClone(){return new PairAstNode(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(nt,ot){return this.child?this.child.computeMinIndentation(lengthAdd(nt,this.openingBracket.length),ot):Number.MAX_SAFE_INTEGER}}class ListAstNode extends BaseAstNode{static create23(nt,ot,rt,ut=!1){let gt=nt.length,pt=nt.missingOpeningBracketIds;if(nt.listHeight!==ot.listHeight)throw new Error("Invalid list heights");if(gt=lengthAdd(gt,ot.length),pt=pt.merge(ot.missingOpeningBracketIds),rt){if(nt.listHeight!==rt.listHeight)throw new Error("Invalid list heights");gt=lengthAdd(gt,rt.length),pt=pt.merge(rt.missingOpeningBracketIds)}return ut?new Immutable23ListAstNode(gt,nt.listHeight+1,nt,ot,rt,pt):new TwoThreeListAstNode(gt,nt.listHeight+1,nt,ot,rt,pt)}static getEmpty(){return new ImmutableArrayListAstNode(lengthZero,0,[],SmallImmutableSet.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}constructor(nt,ot,rt){super(nt),this.listHeight=ot,this._missingOpeningBracketIds=rt,this.cachedMinIndentation=-1}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const nt=this.childrenLength;if(nt===0)return;const ot=this.getChild(nt-1),rt=ot.kind===4?ot.toMutable():ot;return ot!==rt&&this.setChild(nt-1,rt),rt}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const ot=this.getChild(0),rt=ot.kind===4?ot.toMutable():ot;return ot!==rt&&this.setChild(0,rt),rt}canBeReused(nt){if(nt.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let ot=this;for(;ot.kind===4;){const rt=ot.childrenLength;if(rt===0)throw new BugIndicatingError;ot=ot.getChild(rt-1)}return ot.canBeReused(nt)}handleChildrenChanged(){this.throwIfImmutable();const nt=this.childrenLength;let ot=this.getChild(0).length,rt=this.getChild(0).missingOpeningBracketIds;for(let ut=1;ut<nt;ut++){const gt=this.getChild(ut);ot=lengthAdd(ot,gt.length),rt=rt.merge(gt.missingOpeningBracketIds)}this._length=ot,this._missingOpeningBracketIds=rt,this.cachedMinIndentation=-1}computeMinIndentation(nt,ot){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let rt=Number.MAX_SAFE_INTEGER,ut=nt;for(let gt=0;gt<this.childrenLength;gt++){const pt=this.getChild(gt);pt&&(rt=Math.min(rt,pt.computeMinIndentation(ut,ot)),ut=lengthAdd(ut,pt.length))}return this.cachedMinIndentation=rt,rt}}class TwoThreeListAstNode extends ListAstNode{get childrenLength(){return this._item3!==null?3:2}getChild(nt){switch(nt){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(nt,ot){switch(nt){case 0:this._item1=ot;return;case 1:this._item2=ot;return;case 2:this._item3=ot;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}constructor(nt,ot,rt,ut,gt,pt){super(nt,ot,pt),this._item1=rt,this._item2=ut,this._item3=gt}deepClone(){return new TwoThreeListAstNode(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(nt){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=nt,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const nt=this._item3;return this._item3=null,this.handleChildrenChanged(),nt}prependChildOfSameHeight(nt){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=nt,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const nt=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),nt}toMutable(){return this}}class Immutable23ListAstNode extends TwoThreeListAstNode{toMutable(){return new TwoThreeListAstNode(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class ArrayListAstNode extends ListAstNode{get childrenLength(){return this._children.length}getChild(nt){return this._children[nt]}setChild(nt,ot){this._children[nt]=ot}get children(){return this._children}constructor(nt,ot,rt,ut){super(nt,ot,ut),this._children=rt}deepClone(){const nt=new Array(this._children.length);for(let ot=0;ot<this._children.length;ot++)nt[ot]=this._children[ot].deepClone();return new ArrayListAstNode(this.length,this.listHeight,nt,this.missingOpeningBracketIds)}appendChildOfSameHeight(nt){this.throwIfImmutable(),this._children.push(nt),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const nt=this._children.pop();return this.handleChildrenChanged(),nt}prependChildOfSameHeight(nt){this.throwIfImmutable(),this._children.unshift(nt),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const nt=this._children.shift();return this.handleChildrenChanged(),nt}toMutable(){return this}}class ImmutableArrayListAstNode extends ArrayListAstNode{toMutable(){return new ArrayListAstNode(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const emptyArray=[];class ImmutableLeafAstNode extends BaseAstNode{get listHeight(){return 0}get childrenLength(){return 0}getChild(nt){return null}get children(){return emptyArray}deepClone(){return this}}class TextAstNode extends ImmutableLeafAstNode{get kind(){return 0}get missingOpeningBracketIds(){return SmallImmutableSet.getEmpty()}canBeReused(nt){return!0}computeMinIndentation(nt,ot){const rt=lengthToObj(nt),ut=(rt.columnCount===0?rt.lineCount:rt.lineCount+1)+1,gt=lengthGetLineCount(lengthAdd(nt,this.length))+1;let pt=Number.MAX_SAFE_INTEGER;for(let mt=ut;mt<=gt;mt++){const vt=ot.getLineFirstNonWhitespaceColumn(mt),St=ot.getLineContent(mt);if(vt===0)continue;const yt=CursorColumns.visibleColumnFromColumn(St,vt,ot.getOptions().tabSize);pt=Math.min(pt,yt)}return pt}}class BracketAstNode extends ImmutableLeafAstNode{static create(nt,ot,rt){return new BracketAstNode(nt,ot,rt)}get kind(){return 1}get missingOpeningBracketIds(){return SmallImmutableSet.getEmpty()}constructor(nt,ot,rt){super(nt),this.bracketInfo=ot,this.bracketIds=rt}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(nt){return!1}computeMinIndentation(nt,ot){return Number.MAX_SAFE_INTEGER}}class InvalidBracketAstNode extends ImmutableLeafAstNode{get kind(){return 3}constructor(nt,ot){super(ot),this.missingOpeningBracketIds=nt}canBeReused(nt){return!nt.intersects(this.missingOpeningBracketIds)}computeMinIndentation(nt,ot){return Number.MAX_SAFE_INTEGER}}let Token$1=class{constructor(nt,ot,rt,ut,gt){this.length=nt,this.kind=ot,this.bracketId=rt,this.bracketIds=ut,this.astNode=gt}};class TextBufferTokenizer{constructor(nt,ot){this.textModel=nt,this.bracketTokens=ot,this.reader=new NonPeekableTextBufferTokenizer(this.textModel,this.bracketTokens),this._offset=lengthZero,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=nt.getLineCount(),this.textBufferLastLineLength=nt.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return toLength(this.textBufferLineCount-1,this.textBufferLastLineLength)}skip(nt){this.didPeek=!1,this._offset=lengthAdd(this._offset,nt);const ot=lengthToObj(this._offset);this.reader.setPosition(ot.lineCount,ot.columnCount)}read(){let nt;return this.peeked?(this.didPeek=!1,nt=this.peeked):nt=this.reader.read(),nt&&(this._offset=lengthAdd(this._offset,nt.length)),nt}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class NonPeekableTextBufferTokenizer{constructor(nt,ot){this.textModel=nt,this.bracketTokens=ot,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=nt.getLineCount(),this.textBufferLastLineLength=nt.getLineLength(this.textBufferLineCount)}setPosition(nt,ot){nt===this.lineIdx?(this.lineCharOffset=ot,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=nt,this.lineCharOffset=ot,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const gt=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=gt.length,gt}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const nt=this.lineIdx,ot=this.lineCharOffset;let rt=0;for(;;){const gt=this.lineTokens,pt=gt.getCount();let mt=null;if(this.lineTokenOffset<pt){const vt=gt.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<pt&&vt===gt.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const St=TokenMetadata.getTokenType(vt)===0,yt=TokenMetadata.containsBalancedBrackets(vt),wt=gt.getEndOffset(this.lineTokenOffset);if(yt&&St&&this.lineCharOffset<wt){const Lt=gt.getLanguageId(this.lineTokenOffset),xt=this.line.substring(this.lineCharOffset,wt),It=this.bracketTokens.getSingleLanguageBracketTokens(Lt),kt=It.regExpGlobal;if(kt){kt.lastIndex=0;const At=kt.exec(xt);At&&(mt=It.getToken(At[0]),mt&&(this.lineCharOffset+=At.index))}}if(rt+=wt-this.lineCharOffset,mt)if(nt!==this.lineIdx||ot!==this.lineCharOffset){this.peekedToken=mt;break}else return this.lineCharOffset+=mt.length,mt;else this.lineTokenOffset++,this.lineCharOffset=wt}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,rt+=33,rt>1e3))break;if(rt>1500)break}const ut=lengthDiff(nt,ot,this.lineIdx,this.lineCharOffset);return new Token$1(ut,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(ut))}}class FastTokenizer{constructor(nt,ot){this.text=nt,this._offset=lengthZero,this.idx=0;const rt=ot.getRegExpStr(),ut=rt?new RegExp(rt+`|
`,"gi"):null,gt=[];let pt,mt=0,vt=0,St=0,yt=0;const wt=[];for(let It=0;It<60;It++)wt.push(new Token$1(toLength(0,It),0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(toLength(0,It))));const Lt=[];for(let It=0;It<60;It++)Lt.push(new Token$1(toLength(1,It),0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(toLength(1,It))));if(ut)for(ut.lastIndex=0;(pt=ut.exec(nt))!==null;){const It=pt.index,kt=pt[0];if(kt===`
`)mt++,vt=It+1;else{if(St!==It){let At;if(yt===mt){const Tt=It-St;if(Tt<wt.length)At=wt[Tt];else{const Rt=toLength(0,Tt);At=new Token$1(Rt,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(Rt))}}else{const Tt=mt-yt,Rt=It-vt;if(Tt===1&&Rt<Lt.length)At=Lt[Rt];else{const Nt=toLength(Tt,Rt);At=new Token$1(Nt,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(Nt))}}gt.push(At)}gt.push(ot.getToken(kt)),St=It+kt.length,yt=mt}}const xt=nt.length;if(St!==xt){const It=yt===mt?toLength(0,xt-St):toLength(mt-yt,xt-vt);gt.push(new Token$1(It,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(It)))}this.length=toLength(mt,xt-vt),this.tokens=gt}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(nt){throw new NotSupportedError}}class BracketTokens{static createFromLanguage(nt,ot){function rt(gt){return ot.getKey(`${gt.languageId}:::${gt.bracketText}`)}const ut=new Map;for(const gt of nt.bracketsNew.openingBrackets){const pt=toLength(0,gt.bracketText.length),mt=rt(gt),vt=SmallImmutableSet.getEmpty().add(mt,identityKeyProvider);ut.set(gt.bracketText,new Token$1(pt,1,mt,vt,BracketAstNode.create(pt,gt,vt)))}for(const gt of nt.bracketsNew.closingBrackets){const pt=toLength(0,gt.bracketText.length);let mt=SmallImmutableSet.getEmpty();const vt=gt.getOpeningBrackets();for(const St of vt)mt=mt.add(rt(St),identityKeyProvider);ut.set(gt.bracketText,new Token$1(pt,2,rt(vt[0]),mt,BracketAstNode.create(pt,gt,mt)))}return new BracketTokens(ut)}constructor(nt){this.map=nt,this.hasRegExp=!1,this._regExpGlobal=null}getRegExpStr(){if(this.isEmpty)return null;{const nt=[...this.map.keys()];return nt.sort(),nt.reverse(),nt.map(ot=>prepareBracketForRegExp(ot)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const nt=this.getRegExpStr();this._regExpGlobal=nt?new RegExp(nt,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(nt){return this.map.get(nt.toLowerCase())}findClosingTokenText(nt){for(const[ot,rt]of this.map)if(rt.kind===2&&rt.bracketIds.intersects(nt))return ot}get isEmpty(){return this.map.size===0}}function prepareBracketForRegExp(ct){let nt=escapeRegExpCharacters(ct);return/^[\w ]+/.test(ct)&&(nt=`\\b${nt}`),/[\w ]+$/.test(ct)&&(nt=`${nt}\\b`),nt}class LanguageAgnosticBracketTokens{constructor(nt,ot){this.denseKeyProvider=nt,this.getLanguageConfiguration=ot,this.languageIdToBracketTokens=new Map}didLanguageChange(nt){return this.languageIdToBracketTokens.has(nt)}getSingleLanguageBracketTokens(nt){let ot=this.languageIdToBracketTokens.get(nt);return ot||(ot=BracketTokens.createFromLanguage(this.getLanguageConfiguration(nt),this.denseKeyProvider),this.languageIdToBracketTokens.set(nt,ot)),ot}}function concat23Trees(ct){if(ct.length===0)return null;if(ct.length===1)return ct[0];let nt=0;function ot(){if(nt>=ct.length)return null;const pt=nt,mt=ct[pt].listHeight;for(nt++;nt<ct.length&&ct[nt].listHeight===mt;)nt++;return nt-pt>=2?concat23TreesOfSameHeight(pt===0&&nt===ct.length?ct:ct.slice(pt,nt),!1):ct[pt]}let rt=ot(),ut=ot();if(!ut)return rt;for(let pt=ot();pt;pt=ot())heightDiff(rt,ut)<=heightDiff(ut,pt)?(rt=concat$1(rt,ut),ut=pt):ut=concat$1(ut,pt);return concat$1(rt,ut)}function concat23TreesOfSameHeight(ct,nt=!1){if(ct.length===0)return null;if(ct.length===1)return ct[0];let ot=ct.length;for(;ot>3;){const rt=ot>>1;for(let ut=0;ut<rt;ut++){const gt=ut<<1;ct[ut]=ListAstNode.create23(ct[gt],ct[gt+1],gt+3===ot?ct[gt+2]:null,nt)}ot=rt}return ListAstNode.create23(ct[0],ct[1],ot>=3?ct[2]:null,nt)}function heightDiff(ct,nt){return Math.abs(ct.listHeight-nt.listHeight)}function concat$1(ct,nt){return ct.listHeight===nt.listHeight?ListAstNode.create23(ct,nt,null,!1):ct.listHeight>nt.listHeight?append(ct,nt):prepend(nt,ct)}function append(ct,nt){ct=ct.toMutable();let ot=ct;const rt=[];let ut;for(;;){if(nt.listHeight===ot.listHeight){ut=nt;break}if(ot.kind!==4)throw new Error("unexpected");rt.push(ot),ot=ot.makeLastElementMutable()}for(let gt=rt.length-1;gt>=0;gt--){const pt=rt[gt];ut?pt.childrenLength>=3?ut=ListAstNode.create23(pt.unappendChild(),ut,null,!1):(pt.appendChildOfSameHeight(ut),ut=void 0):pt.handleChildrenChanged()}return ut?ListAstNode.create23(ct,ut,null,!1):ct}function prepend(ct,nt){ct=ct.toMutable();let ot=ct;const rt=[];for(;nt.listHeight!==ot.listHeight;){if(ot.kind!==4)throw new Error("unexpected");rt.push(ot),ot=ot.makeFirstElementMutable()}let ut=nt;for(let gt=rt.length-1;gt>=0;gt--){const pt=rt[gt];ut?pt.childrenLength>=3?ut=ListAstNode.create23(ut,pt.unprependChild(),null,!1):(pt.prependChildOfSameHeight(ut),ut=void 0):pt.handleChildrenChanged()}return ut?ListAstNode.create23(ut,ct,null,!1):ct}class NodeReader{constructor(nt){this.lastOffset=lengthZero,this.nextNodes=[nt],this.offsets=[lengthZero],this.idxs=[]}readLongestNodeAt(nt,ot){if(lengthLessThan(nt,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=nt;;){const rt=lastOrUndefined(this.nextNodes);if(!rt)return;const ut=lastOrUndefined(this.offsets);if(lengthLessThan(nt,ut))return;if(lengthLessThan(ut,nt))if(lengthAdd(ut,rt.length)<=nt)this.nextNodeAfterCurrent();else{const gt=getNextChildIdx(rt);gt!==-1?(this.nextNodes.push(rt.getChild(gt)),this.offsets.push(ut),this.idxs.push(gt)):this.nextNodeAfterCurrent()}else{if(ot(rt))return this.nextNodeAfterCurrent(),rt;{const gt=getNextChildIdx(rt);if(gt===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(rt.getChild(gt)),this.offsets.push(ut),this.idxs.push(gt)}}}}nextNodeAfterCurrent(){for(;;){const nt=lastOrUndefined(this.offsets),ot=lastOrUndefined(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const rt=lastOrUndefined(this.nextNodes),ut=getNextChildIdx(rt,this.idxs[this.idxs.length-1]);if(ut!==-1){this.nextNodes.push(rt.getChild(ut)),this.offsets.push(lengthAdd(nt,ot.length)),this.idxs[this.idxs.length-1]=ut;break}else this.idxs.pop()}}}function getNextChildIdx(ct,nt=-1){for(;;){if(nt++,nt>=ct.childrenLength)return-1;if(ct.getChild(nt))return nt}}function lastOrUndefined(ct){return ct.length>0?ct[ct.length-1]:void 0}function parseDocument(ct,nt,ot,rt){return new Parser(ct,nt,ot,rt).parseDocument()}class Parser{constructor(nt,ot,rt,ut){if(this.tokenizer=nt,this.createImmutableLists=ut,this._itemsConstructed=0,this._itemsFromCache=0,rt&&ut)throw new Error("Not supported");this.oldNodeReader=rt?new NodeReader(rt):void 0,this.positionMapper=new BeforeEditPositionMapper(ot)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let nt=this.parseList(SmallImmutableSet.getEmpty());return nt||(nt=ListAstNode.getEmpty()),nt}parseList(nt){const ot=[];for(;;){let ut=this.tryReadChildFromCache(nt);if(!ut){const gt=this.tokenizer.peek();if(!gt||gt.kind===2&&gt.bracketIds.intersects(nt))break;ut=this.parseChild(nt)}ut.kind===4&&ut.childrenLength===0||ot.push(ut)}return this.oldNodeReader?concat23Trees(ot):concat23TreesOfSameHeight(ot,this.createImmutableLists)}tryReadChildFromCache(nt){if(this.oldNodeReader){const ot=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(ot===null||!lengthIsZero(ot)){const rt=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),ut=>ot!==null&&!lengthLessThan(ut.length,ot)?!1:ut.canBeReused(nt));if(rt)return this._itemsFromCache++,this.tokenizer.skip(rt.length),rt}}}parseChild(nt){this._itemsConstructed++;const ot=this.tokenizer.read();switch(ot.kind){case 2:return new InvalidBracketAstNode(ot.bracketIds,ot.length);case 0:return ot.astNode;case 1:{const rt=nt.merge(ot.bracketIds),ut=this.parseList(rt),gt=this.tokenizer.peek();return gt&&gt.kind===2&&(gt.bracketId===ot.bracketId||gt.bracketIds.intersects(ot.bracketIds))?(this.tokenizer.read(),PairAstNode.create(ot.astNode,ut,gt.astNode)):PairAstNode.create(ot.astNode,ut,null)}default:throw new Error("unexpected")}}}function combineTextEditInfos(ct,nt){if(ct.length===0)return nt;if(nt.length===0)return ct;const ot=new ArrayQueue(toLengthMapping(ct)),rt=toLengthMapping(nt);rt.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let ut=ot.dequeue();function gt(St){if(St===void 0){const wt=ot.takeWhile(Lt=>!0)||[];return ut&&wt.unshift(ut),wt}const yt=[];for(;ut&&!lengthIsZero(St);){const[wt,Lt]=ut.splitAt(St);yt.push(wt),St=lengthDiffNonNegative(wt.lengthAfter,St),ut=Lt??ot.dequeue()}return lengthIsZero(St)||yt.push(new LengthMapping(!1,St,St)),yt}const pt=[];function mt(St,yt,wt){if(pt.length>0&&lengthEquals(pt[pt.length-1].endOffset,St)){const Lt=pt[pt.length-1];pt[pt.length-1]=new TextEditInfo(Lt.startOffset,yt,lengthAdd(Lt.newLength,wt))}else pt.push({startOffset:St,endOffset:yt,newLength:wt})}let vt=lengthZero;for(const St of rt){const yt=gt(St.lengthBefore);if(St.modified){const wt=sumLengths(yt,xt=>xt.lengthBefore),Lt=lengthAdd(vt,wt);mt(vt,Lt,St.lengthAfter),vt=Lt}else for(const wt of yt){const Lt=vt;vt=lengthAdd(vt,wt.lengthBefore),wt.modified&&mt(Lt,vt,wt.lengthAfter)}}return pt}class LengthMapping{constructor(nt,ot,rt){this.modified=nt,this.lengthBefore=ot,this.lengthAfter=rt}splitAt(nt){const ot=lengthDiffNonNegative(nt,this.lengthAfter);return lengthEquals(ot,lengthZero)?[this,void 0]:this.modified?[new LengthMapping(this.modified,this.lengthBefore,nt),new LengthMapping(this.modified,lengthZero,ot)]:[new LengthMapping(this.modified,nt,nt),new LengthMapping(this.modified,ot,ot)]}toString(){return`${this.modified?"M":"U"}:${lengthToObj(this.lengthBefore)} -> ${lengthToObj(this.lengthAfter)}`}}function toLengthMapping(ct){const nt=[];let ot=lengthZero;for(const rt of ct){const ut=lengthDiffNonNegative(ot,rt.startOffset);lengthIsZero(ut)||nt.push(new LengthMapping(!1,ut,ut));const gt=lengthDiffNonNegative(rt.startOffset,rt.endOffset);nt.push(new LengthMapping(!0,gt,rt.newLength)),ot=rt.endOffset}return nt}class BracketPairsTree extends Disposable{didLanguageChange(nt){return this.brackets.didLanguageChange(nt)}constructor(nt,ot){if(super(),this.textModel=nt,this.getLanguageConfiguration=ot,this.didChangeEmitter=new Emitter$2,this.denseKeyProvider=new DenseKeyProvider,this.brackets=new LanguageAgnosticBracketTokens(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this.queuedTextEditsForInitialAstWithoutTokens=[],this.queuedTextEdits=[],nt.tokenization.hasTokens)nt.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{const rt=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),ut=new FastTokenizer(this.textModel.getValue(),rt);this.initialAstWithoutTokens=parseDocument(ut,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){const nt=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,nt||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:nt}){const ot=nt.map(rt=>new TextEditInfo(toLength(rt.fromLineNumber-1,0),toLength(rt.toLineNumber,0),toLength(rt.toLineNumber-rt.fromLineNumber+1,0)));this.handleEdits(ot,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(nt){const ot=nt.changes.map(rt=>{const ut=Range$2.lift(rt.range);return new TextEditInfo(positionToLength(ut.getStartPosition()),positionToLength(ut.getEndPosition()),lengthOfString(rt.text))}).reverse();this.handleEdits(ot,!1)}handleEdits(nt,ot){const rt=combineTextEditInfos(this.queuedTextEdits,nt);this.queuedTextEdits=rt,this.initialAstWithoutTokens&&!ot&&(this.queuedTextEditsForInitialAstWithoutTokens=combineTextEditInfos(this.queuedTextEditsForInitialAstWithoutTokens,nt))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(nt,ot,rt){const ut=ot,gt=new TextBufferTokenizer(this.textModel,this.brackets);return parseDocument(gt,nt,ut,rt)}getBracketsInRange(nt,ot){this.flushQueue();const rt=toLength(nt.startLineNumber-1,nt.startColumn-1),ut=toLength(nt.endLineNumber-1,nt.endColumn-1);return new CallbackIterable(gt=>{const pt=this.initialAstWithoutTokens||this.astWithTokens;collectBrackets(pt,lengthZero,pt.length,rt,ut,gt,0,0,new Map,ot)})}getBracketPairsInRange(nt,ot){this.flushQueue();const rt=positionToLength(nt.getStartPosition()),ut=positionToLength(nt.getEndPosition());return new CallbackIterable(gt=>{const pt=this.initialAstWithoutTokens||this.astWithTokens,mt=new CollectBracketPairsContext(gt,ot,this.textModel);collectBracketPairs(pt,lengthZero,pt.length,rt,ut,mt,0,new Map)})}getFirstBracketAfter(nt){this.flushQueue();const ot=this.initialAstWithoutTokens||this.astWithTokens;return getFirstBracketAfter(ot,lengthZero,ot.length,positionToLength(nt))}getFirstBracketBefore(nt){this.flushQueue();const ot=this.initialAstWithoutTokens||this.astWithTokens;return getFirstBracketBefore(ot,lengthZero,ot.length,positionToLength(nt))}}function getFirstBracketBefore(ct,nt,ot,rt){if(ct.kind===4||ct.kind===2){const ut=[];for(const gt of ct.children)ot=lengthAdd(nt,gt.length),ut.push({nodeOffsetStart:nt,nodeOffsetEnd:ot}),nt=ot;for(let gt=ut.length-1;gt>=0;gt--){const{nodeOffsetStart:pt,nodeOffsetEnd:mt}=ut[gt];if(lengthLessThan(pt,rt)){const vt=getFirstBracketBefore(ct.children[gt],pt,mt,rt);if(vt)return vt}}return null}else{if(ct.kind===3)return null;if(ct.kind===1){const ut=lengthsToRange(nt,ot);return{bracketInfo:ct.bracketInfo,range:ut}}}return null}function getFirstBracketAfter(ct,nt,ot,rt){if(ct.kind===4||ct.kind===2){for(const ut of ct.children){if(ot=lengthAdd(nt,ut.length),lengthLessThan(rt,ot)){const gt=getFirstBracketAfter(ut,nt,ot,rt);if(gt)return gt}nt=ot}return null}else{if(ct.kind===3)return null;if(ct.kind===1){const ut=lengthsToRange(nt,ot);return{bracketInfo:ct.bracketInfo,range:ut}}}return null}function collectBrackets(ct,nt,ot,rt,ut,gt,pt,mt,vt,St,yt=!1){if(pt>200)return!0;e:for(;;)switch(ct.kind){case 4:{const wt=ct.childrenLength;for(let Lt=0;Lt<wt;Lt++){const xt=ct.getChild(Lt);if(xt){if(ot=lengthAdd(nt,xt.length),lengthLessThanEqual(nt,ut)&&lengthGreaterThanEqual(ot,rt)){if(lengthGreaterThanEqual(ot,ut)){ct=xt;continue e}if(!collectBrackets(xt,nt,ot,rt,ut,gt,pt,0,vt,St))return!1}nt=ot}}return!0}case 2:{const wt=!St||!ct.closingBracket||ct.closingBracket.bracketInfo.closesColorized(ct.openingBracket.bracketInfo);let Lt=0;if(vt){let It=vt.get(ct.openingBracket.text);It===void 0&&(It=0),Lt=It,wt&&(It++,vt.set(ct.openingBracket.text,It))}const xt=ct.childrenLength;for(let It=0;It<xt;It++){const kt=ct.getChild(It);if(kt){if(ot=lengthAdd(nt,kt.length),lengthLessThanEqual(nt,ut)&&lengthGreaterThanEqual(ot,rt)){if(lengthGreaterThanEqual(ot,ut)&&kt.kind!==1){ct=kt,wt?(pt++,mt=Lt+1):mt=Lt;continue e}if((wt||kt.kind!==1||!ct.closingBracket)&&!collectBrackets(kt,nt,ot,rt,ut,gt,wt?pt+1:pt,wt?Lt+1:Lt,vt,St,!ct.closingBracket))return!1}nt=ot}}return vt==null||vt.set(ct.openingBracket.text,Lt),!0}case 3:{const wt=lengthsToRange(nt,ot);return gt(new BracketInfo(wt,pt-1,0,!0))}case 1:{const wt=lengthsToRange(nt,ot);return gt(new BracketInfo(wt,pt-1,mt-1,yt))}case 0:return!0}}class CollectBracketPairsContext{constructor(nt,ot,rt){this.push=nt,this.includeMinIndentation=ot,this.textModel=rt}}function collectBracketPairs(ct,nt,ot,rt,ut,gt,pt,mt){var vt;if(pt>200)return!0;let St=!0;if(ct.kind===2){let yt=0;if(mt){let xt=mt.get(ct.openingBracket.text);xt===void 0&&(xt=0),yt=xt,xt++,mt.set(ct.openingBracket.text,xt)}const wt=lengthAdd(nt,ct.openingBracket.length);let Lt=-1;if(gt.includeMinIndentation&&(Lt=ct.computeMinIndentation(nt,gt.textModel)),St=gt.push(new BracketPairWithMinIndentationInfo(lengthsToRange(nt,ot),lengthsToRange(nt,wt),ct.closingBracket?lengthsToRange(lengthAdd(wt,((vt=ct.child)===null||vt===void 0?void 0:vt.length)||lengthZero),ot):void 0,pt,yt,ct,Lt)),nt=wt,St&&ct.child){const xt=ct.child;if(ot=lengthAdd(nt,xt.length),lengthLessThanEqual(nt,ut)&&lengthGreaterThanEqual(ot,rt)&&(St=collectBracketPairs(xt,nt,ot,rt,ut,gt,pt+1,mt),!St))return!1}mt==null||mt.set(ct.openingBracket.text,yt)}else{let yt=nt;for(const wt of ct.children){const Lt=yt;if(yt=lengthAdd(yt,wt.length),lengthLessThanEqual(Lt,ut)&&lengthLessThanEqual(rt,yt)&&(St=collectBracketPairs(wt,Lt,yt,rt,ut,gt,pt,mt),!St))return!1}}return St}class BracketPairsTextModelPart extends Disposable{get canBuildAST(){return this.textModel.getValueLength()<=5e6}constructor(nt,ot){super(),this.textModel=nt,this.languageConfigurationService=ot,this.bracketPairsTree=this._register(new MutableDisposable),this.onDidChangeEmitter=new Emitter$2,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1,this._register(this.languageConfigurationService.onDidChange(rt=>{var ut;(!rt.languageId||!((ut=this.bracketPairsTree.value)===null||ut===void 0)&&ut.object.didLanguageChange(rt.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}))}handleDidChangeOptions(nt){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(nt){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(nt){var ot;(ot=this.bracketPairsTree.value)===null||ot===void 0||ot.object.handleContentChanged(nt)}handleDidChangeBackgroundTokenizationState(){var nt;(nt=this.bracketPairsTree.value)===null||nt===void 0||nt.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(nt){var ot;(ot=this.bracketPairsTree.value)===null||ot===void 0||ot.object.handleDidChangeTokens(nt)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){const nt=new DisposableStore;this.bracketPairsTree.value=createDisposableRef(nt.add(new BracketPairsTree(this.textModel,ot=>this.languageConfigurationService.getLanguageConfiguration(ot))),nt),nt.add(this.bracketPairsTree.value.object.onDidChange(ot=>this.onDidChangeEmitter.fire(ot))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(nt){var ot;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((ot=this.bracketPairsTree.value)===null||ot===void 0?void 0:ot.object.getBracketPairsInRange(nt,!1))||CallbackIterable.empty}getBracketPairsInRangeWithMinIndentation(nt){var ot;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((ot=this.bracketPairsTree.value)===null||ot===void 0?void 0:ot.object.getBracketPairsInRange(nt,!0))||CallbackIterable.empty}getBracketsInRange(nt,ot=!1){var rt;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((rt=this.bracketPairsTree.value)===null||rt===void 0?void 0:rt.object.getBracketsInRange(nt,ot))||CallbackIterable.empty}findMatchingBracketUp(nt,ot,rt){const ut=this.textModel.validatePosition(ot),gt=this.textModel.getLanguageIdAtPosition(ut.lineNumber,ut.column);if(this.canBuildAST){const pt=this.languageConfigurationService.getLanguageConfiguration(gt).bracketsNew.getClosingBracketInfo(nt);if(!pt)return null;const mt=this.getBracketPairsInRange(Range$2.fromPositions(ot,ot)).findLast(vt=>pt.closes(vt.openingBracketInfo));return mt?mt.openingBracketRange:null}else{const pt=nt.toLowerCase(),mt=this.languageConfigurationService.getLanguageConfiguration(gt).brackets;if(!mt)return null;const vt=mt.textIsBracket[pt];return vt?stripBracketSearchCanceled(this._findMatchingBracketUp(vt,ut,createTimeBasedContinueBracketSearchPredicate(rt))):null}}matchBracket(nt,ot){if(this.canBuildAST){const rt=this.getBracketPairsInRange(Range$2.fromPositions(nt,nt)).filter(ut=>ut.closingBracketRange!==void 0&&(ut.openingBracketRange.containsPosition(nt)||ut.closingBracketRange.containsPosition(nt))).findLastMaxBy(compareBy(ut=>ut.openingBracketRange.containsPosition(nt)?ut.openingBracketRange:ut.closingBracketRange,Range$2.compareRangesUsingStarts));return rt?[rt.openingBracketRange,rt.closingBracketRange]:null}else{const rt=createTimeBasedContinueBracketSearchPredicate(ot);return this._matchBracket(this.textModel.validatePosition(nt),rt)}}_establishBracketSearchOffsets(nt,ot,rt,ut){const gt=ot.getCount(),pt=ot.getLanguageId(ut);let mt=Math.max(0,nt.column-1-rt.maxBracketLength);for(let St=ut-1;St>=0;St--){const yt=ot.getEndOffset(St);if(yt<=mt)break;if(ignoreBracketsInToken(ot.getStandardTokenType(St))||ot.getLanguageId(St)!==pt){mt=yt;break}}let vt=Math.min(ot.getLineContent().length,nt.column-1+rt.maxBracketLength);for(let St=ut+1;St<gt;St++){const yt=ot.getStartOffset(St);if(yt>=vt)break;if(ignoreBracketsInToken(ot.getStandardTokenType(St))||ot.getLanguageId(St)!==pt){vt=yt;break}}return{searchStartOffset:mt,searchEndOffset:vt}}_matchBracket(nt,ot){const rt=nt.lineNumber,ut=this.textModel.tokenization.getLineTokens(rt),gt=this.textModel.getLineContent(rt),pt=ut.findTokenIndexAtOffset(nt.column-1);if(pt<0)return null;const mt=this.languageConfigurationService.getLanguageConfiguration(ut.getLanguageId(pt)).brackets;if(mt&&!ignoreBracketsInToken(ut.getStandardTokenType(pt))){let{searchStartOffset:vt,searchEndOffset:St}=this._establishBracketSearchOffsets(nt,ut,mt,pt),yt=null;for(;;){const wt=BracketsUtils.findNextBracketInRange(mt.forwardRegex,rt,gt,vt,St);if(!wt)break;if(wt.startColumn<=nt.column&&nt.column<=wt.endColumn){const Lt=gt.substring(wt.startColumn-1,wt.endColumn-1).toLowerCase(),xt=this._matchFoundBracket(wt,mt.textIsBracket[Lt],mt.textIsOpenBracket[Lt],ot);if(xt){if(xt instanceof BracketSearchCanceled)return null;yt=xt}}vt=wt.endColumn-1}if(yt)return yt}if(pt>0&&ut.getStartOffset(pt)===nt.column-1){const vt=pt-1,St=this.languageConfigurationService.getLanguageConfiguration(ut.getLanguageId(vt)).brackets;if(St&&!ignoreBracketsInToken(ut.getStandardTokenType(vt))){const{searchStartOffset:yt,searchEndOffset:wt}=this._establishBracketSearchOffsets(nt,ut,St,vt),Lt=BracketsUtils.findPrevBracketInRange(St.reversedRegex,rt,gt,yt,wt);if(Lt&&Lt.startColumn<=nt.column&&nt.column<=Lt.endColumn){const xt=gt.substring(Lt.startColumn-1,Lt.endColumn-1).toLowerCase(),It=this._matchFoundBracket(Lt,St.textIsBracket[xt],St.textIsOpenBracket[xt],ot);if(It)return It instanceof BracketSearchCanceled?null:It}}}return null}_matchFoundBracket(nt,ot,rt,ut){if(!ot)return null;const gt=rt?this._findMatchingBracketDown(ot,nt.getEndPosition(),ut):this._findMatchingBracketUp(ot,nt.getStartPosition(),ut);return gt?gt instanceof BracketSearchCanceled?gt:[nt,gt]:null}_findMatchingBracketUp(nt,ot,rt){const ut=nt.languageId,gt=nt.reversedRegex;let pt=-1,mt=0;const vt=(St,yt,wt,Lt)=>{for(;;){if(rt&&++mt%100===0&&!rt())return BracketSearchCanceled.INSTANCE;const xt=BracketsUtils.findPrevBracketInRange(gt,St,yt,wt,Lt);if(!xt)break;const It=yt.substring(xt.startColumn-1,xt.endColumn-1).toLowerCase();if(nt.isOpen(It)?pt++:nt.isClose(It)&&pt--,pt===0)return xt;Lt=xt.startColumn-1}return null};for(let St=ot.lineNumber;St>=1;St--){const yt=this.textModel.tokenization.getLineTokens(St),wt=yt.getCount(),Lt=this.textModel.getLineContent(St);let xt=wt-1,It=Lt.length,kt=Lt.length;St===ot.lineNumber&&(xt=yt.findTokenIndexAtOffset(ot.column-1),It=ot.column-1,kt=ot.column-1);let At=!0;for(;xt>=0;xt--){const Tt=yt.getLanguageId(xt)===ut&&!ignoreBracketsInToken(yt.getStandardTokenType(xt));if(Tt)At?It=yt.getStartOffset(xt):(It=yt.getStartOffset(xt),kt=yt.getEndOffset(xt));else if(At&&It!==kt){const Rt=vt(St,Lt,It,kt);if(Rt)return Rt}At=Tt}if(At&&It!==kt){const Tt=vt(St,Lt,It,kt);if(Tt)return Tt}}return null}_findMatchingBracketDown(nt,ot,rt){const ut=nt.languageId,gt=nt.forwardRegex;let pt=1,mt=0;const vt=(yt,wt,Lt,xt)=>{for(;;){if(rt&&++mt%100===0&&!rt())return BracketSearchCanceled.INSTANCE;const It=BracketsUtils.findNextBracketInRange(gt,yt,wt,Lt,xt);if(!It)break;const kt=wt.substring(It.startColumn-1,It.endColumn-1).toLowerCase();if(nt.isOpen(kt)?pt++:nt.isClose(kt)&&pt--,pt===0)return It;Lt=It.endColumn-1}return null},St=this.textModel.getLineCount();for(let yt=ot.lineNumber;yt<=St;yt++){const wt=this.textModel.tokenization.getLineTokens(yt),Lt=wt.getCount(),xt=this.textModel.getLineContent(yt);let It=0,kt=0,At=0;yt===ot.lineNumber&&(It=wt.findTokenIndexAtOffset(ot.column-1),kt=ot.column-1,At=ot.column-1);let Tt=!0;for(;It<Lt;It++){const Rt=wt.getLanguageId(It)===ut&&!ignoreBracketsInToken(wt.getStandardTokenType(It));if(Rt)Tt||(kt=wt.getStartOffset(It)),At=wt.getEndOffset(It);else if(Tt&&kt!==At){const Nt=vt(yt,xt,kt,At);if(Nt)return Nt}Tt=Rt}if(Tt&&kt!==At){const Rt=vt(yt,xt,kt,At);if(Rt)return Rt}}return null}findPrevBracket(nt){var ot;const rt=this.textModel.validatePosition(nt);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((ot=this.bracketPairsTree.value)===null||ot===void 0?void 0:ot.object.getFirstBracketBefore(rt))||null;let ut=null,gt=null,pt=null;for(let mt=rt.lineNumber;mt>=1;mt--){const vt=this.textModel.tokenization.getLineTokens(mt),St=vt.getCount(),yt=this.textModel.getLineContent(mt);let wt=St-1,Lt=yt.length,xt=yt.length;if(mt===rt.lineNumber){wt=vt.findTokenIndexAtOffset(rt.column-1),Lt=rt.column-1,xt=rt.column-1;const kt=vt.getLanguageId(wt);ut!==kt&&(ut=kt,gt=this.languageConfigurationService.getLanguageConfiguration(ut).brackets,pt=this.languageConfigurationService.getLanguageConfiguration(ut).bracketsNew)}let It=!0;for(;wt>=0;wt--){const kt=vt.getLanguageId(wt);if(ut!==kt){if(gt&&pt&&It&&Lt!==xt){const Tt=BracketsUtils.findPrevBracketInRange(gt.reversedRegex,mt,yt,Lt,xt);if(Tt)return this._toFoundBracket(pt,Tt);It=!1}ut=kt,gt=this.languageConfigurationService.getLanguageConfiguration(ut).brackets,pt=this.languageConfigurationService.getLanguageConfiguration(ut).bracketsNew}const At=!!gt&&!ignoreBracketsInToken(vt.getStandardTokenType(wt));if(At)It?Lt=vt.getStartOffset(wt):(Lt=vt.getStartOffset(wt),xt=vt.getEndOffset(wt));else if(pt&&gt&&It&&Lt!==xt){const Tt=BracketsUtils.findPrevBracketInRange(gt.reversedRegex,mt,yt,Lt,xt);if(Tt)return this._toFoundBracket(pt,Tt)}It=At}if(pt&&gt&&It&&Lt!==xt){const kt=BracketsUtils.findPrevBracketInRange(gt.reversedRegex,mt,yt,Lt,xt);if(kt)return this._toFoundBracket(pt,kt)}}return null}findNextBracket(nt){var ot;const rt=this.textModel.validatePosition(nt);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((ot=this.bracketPairsTree.value)===null||ot===void 0?void 0:ot.object.getFirstBracketAfter(rt))||null;const ut=this.textModel.getLineCount();let gt=null,pt=null,mt=null;for(let vt=rt.lineNumber;vt<=ut;vt++){const St=this.textModel.tokenization.getLineTokens(vt),yt=St.getCount(),wt=this.textModel.getLineContent(vt);let Lt=0,xt=0,It=0;if(vt===rt.lineNumber){Lt=St.findTokenIndexAtOffset(rt.column-1),xt=rt.column-1,It=rt.column-1;const At=St.getLanguageId(Lt);gt!==At&&(gt=At,pt=this.languageConfigurationService.getLanguageConfiguration(gt).brackets,mt=this.languageConfigurationService.getLanguageConfiguration(gt).bracketsNew)}let kt=!0;for(;Lt<yt;Lt++){const At=St.getLanguageId(Lt);if(gt!==At){if(mt&&pt&&kt&&xt!==It){const Rt=BracketsUtils.findNextBracketInRange(pt.forwardRegex,vt,wt,xt,It);if(Rt)return this._toFoundBracket(mt,Rt);kt=!1}gt=At,pt=this.languageConfigurationService.getLanguageConfiguration(gt).brackets,mt=this.languageConfigurationService.getLanguageConfiguration(gt).bracketsNew}const Tt=!!pt&&!ignoreBracketsInToken(St.getStandardTokenType(Lt));if(Tt)kt||(xt=St.getStartOffset(Lt)),It=St.getEndOffset(Lt);else if(mt&&pt&&kt&&xt!==It){const Rt=BracketsUtils.findNextBracketInRange(pt.forwardRegex,vt,wt,xt,It);if(Rt)return this._toFoundBracket(mt,Rt)}kt=Tt}if(mt&&pt&&kt&&xt!==It){const At=BracketsUtils.findNextBracketInRange(pt.forwardRegex,vt,wt,xt,It);if(At)return this._toFoundBracket(mt,At)}}return null}findEnclosingBrackets(nt,ot){const rt=this.textModel.validatePosition(nt);if(this.canBuildAST){const xt=Range$2.fromPositions(rt),It=this.getBracketPairsInRange(Range$2.fromPositions(rt,rt)).findLast(kt=>kt.closingBracketRange!==void 0&&kt.range.strictContainsRange(xt));return It?[It.openingBracketRange,It.closingBracketRange]:null}const ut=createTimeBasedContinueBracketSearchPredicate(ot),gt=this.textModel.getLineCount(),pt=new Map;let mt=[];const vt=(xt,It)=>{if(!pt.has(xt)){const kt=[];for(let At=0,Tt=It?It.brackets.length:0;At<Tt;At++)kt[At]=0;pt.set(xt,kt)}mt=pt.get(xt)};let St=0;const yt=(xt,It,kt,At,Tt)=>{for(;;){if(ut&&++St%100===0&&!ut())return BracketSearchCanceled.INSTANCE;const Rt=BracketsUtils.findNextBracketInRange(xt.forwardRegex,It,kt,At,Tt);if(!Rt)break;const Nt=kt.substring(Rt.startColumn-1,Rt.endColumn-1).toLowerCase(),Pt=xt.textIsBracket[Nt];if(Pt&&(Pt.isOpen(Nt)?mt[Pt.index]++:Pt.isClose(Nt)&&mt[Pt.index]--,mt[Pt.index]===-1))return this._matchFoundBracket(Rt,Pt,!1,ut);At=Rt.endColumn-1}return null};let wt=null,Lt=null;for(let xt=rt.lineNumber;xt<=gt;xt++){const It=this.textModel.tokenization.getLineTokens(xt),kt=It.getCount(),At=this.textModel.getLineContent(xt);let Tt=0,Rt=0,Nt=0;if(xt===rt.lineNumber){Tt=It.findTokenIndexAtOffset(rt.column-1),Rt=rt.column-1,Nt=rt.column-1;const Ft=It.getLanguageId(Tt);wt!==Ft&&(wt=Ft,Lt=this.languageConfigurationService.getLanguageConfiguration(wt).brackets,vt(wt,Lt))}let Pt=!0;for(;Tt<kt;Tt++){const Ft=It.getLanguageId(Tt);if(wt!==Ft){if(Lt&&Pt&&Rt!==Nt){const Bt=yt(Lt,xt,At,Rt,Nt);if(Bt)return stripBracketSearchCanceled(Bt);Pt=!1}wt=Ft,Lt=this.languageConfigurationService.getLanguageConfiguration(wt).brackets,vt(wt,Lt)}const Kt=!!Lt&&!ignoreBracketsInToken(It.getStandardTokenType(Tt));if(Kt)Pt||(Rt=It.getStartOffset(Tt)),Nt=It.getEndOffset(Tt);else if(Lt&&Pt&&Rt!==Nt){const Bt=yt(Lt,xt,At,Rt,Nt);if(Bt)return stripBracketSearchCanceled(Bt)}Pt=Kt}if(Lt&&Pt&&Rt!==Nt){const Ft=yt(Lt,xt,At,Rt,Nt);if(Ft)return stripBracketSearchCanceled(Ft)}}return null}_toFoundBracket(nt,ot){if(!ot)return null;let rt=this.textModel.getValueInRange(ot);rt=rt.toLowerCase();const ut=nt.getBracketInfo(rt);return ut?{range:ot,bracketInfo:ut}:null}}function createDisposableRef(ct,nt){return{object:ct,dispose:()=>nt==null?void 0:nt.dispose()}}function createTimeBasedContinueBracketSearchPredicate(ct){if(typeof ct>"u")return()=>!0;{const nt=Date.now();return()=>Date.now()-nt<=ct}}class BracketSearchCanceled{constructor(){this._searchCanceledBrand=void 0}}BracketSearchCanceled.INSTANCE=new BracketSearchCanceled;function stripBracketSearchCanceled(ct){return ct instanceof BracketSearchCanceled?null:ct}class ColorizedBracketPairsDecorationProvider extends Disposable{constructor(nt){super(),this.textModel=nt,this.colorProvider=new ColorProvider,this.onDidChangeEmitter=new Emitter$2,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=nt.getOptions().bracketPairColorizationOptions,this._register(nt.bracketPairs.onDidChange(ot=>{this.onDidChangeEmitter.fire()}))}handleDidChangeOptions(nt){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(nt,ot,rt,ut){return ut?[]:ot===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(nt,!0).map(pt=>({id:`bracket${pt.range.toString()}-${pt.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(pt,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:pt.range})).toArray():[]}getAllDecorations(nt,ot){return nt===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new Range$2(1,1,this.textModel.getLineCount(),1),nt,ot):[]}}class ColorProvider{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(nt,ot){return nt.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(ot?nt.nestingLevelOfEqualBracketType:nt.nestingLevel)}getInlineClassNameOfLevel(nt){return`bracket-highlighting-${nt%30}`}}registerThemingParticipant((ct,nt)=>{const ot=[editorBracketHighlightingForeground1,editorBracketHighlightingForeground2,editorBracketHighlightingForeground3,editorBracketHighlightingForeground4,editorBracketHighlightingForeground5,editorBracketHighlightingForeground6],rt=new ColorProvider;nt.addRule(`.monaco-editor .${rt.unexpectedClosingBracketClassName} { color: ${ct.getColor(editorBracketHighlightingUnexpectedBracketForeground)}; }`);const ut=ot.map(gt=>ct.getColor(gt)).filter(gt=>!!gt).filter(gt=>!gt.isTransparent());for(let gt=0;gt<30;gt++){const pt=ut[gt%ut.length];nt.addRule(`.monaco-editor .${rt.getInlineClassNameOfLevel(gt)} { color: ${pt}; }`)}});function escapeNewLine(ct){return ct.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class TextChange{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(nt,ot,rt,ut){this.oldPosition=nt,this.oldText=ot,this.newPosition=rt,this.newText=ut}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${escapeNewLine(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${escapeNewLine(this.oldText)}")`:`(replace@${this.oldPosition} "${escapeNewLine(this.oldText)}" with "${escapeNewLine(this.newText)}")`}static _writeStringSize(nt){return 4+2*nt.length}static _writeString(nt,ot,rt){const ut=ot.length;writeUInt32BE(nt,ut,rt),rt+=4;for(let gt=0;gt<ut;gt++)writeUInt16LE(nt,ot.charCodeAt(gt),rt),rt+=2;return rt}static _readString(nt,ot){const rt=readUInt32BE(nt,ot);return ot+=4,decodeUTF16LE(nt,ot,rt)}writeSize(){return 4+4+TextChange._writeStringSize(this.oldText)+TextChange._writeStringSize(this.newText)}write(nt,ot){return writeUInt32BE(nt,this.oldPosition,ot),ot+=4,writeUInt32BE(nt,this.newPosition,ot),ot+=4,ot=TextChange._writeString(nt,this.oldText,ot),ot=TextChange._writeString(nt,this.newText,ot),ot}static read(nt,ot,rt){const ut=readUInt32BE(nt,ot);ot+=4;const gt=readUInt32BE(nt,ot);ot+=4;const pt=TextChange._readString(nt,ot);ot+=TextChange._writeStringSize(pt);const mt=TextChange._readString(nt,ot);return ot+=TextChange._writeStringSize(mt),rt.push(new TextChange(ut,pt,gt,mt)),ot}}function compressConsecutiveTextChanges(ct,nt){return ct===null||ct.length===0?nt:new TextChangeCompressor(ct,nt).compress()}class TextChangeCompressor{constructor(nt,ot){this._prevEdits=nt,this._currEdits=ot,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let nt=0,ot=0,rt=this._getPrev(nt),ut=this._getCurr(ot);for(;nt<this._prevLen||ot<this._currLen;){if(rt===null){this._acceptCurr(ut),ut=this._getCurr(++ot);continue}if(ut===null){this._acceptPrev(rt),rt=this._getPrev(++nt);continue}if(ut.oldEnd<=rt.newPosition){this._acceptCurr(ut),ut=this._getCurr(++ot);continue}if(rt.newEnd<=ut.oldPosition){this._acceptPrev(rt),rt=this._getPrev(++nt);continue}if(ut.oldPosition<rt.newPosition){const[St,yt]=TextChangeCompressor._splitCurr(ut,rt.newPosition-ut.oldPosition);this._acceptCurr(St),ut=yt;continue}if(rt.newPosition<ut.oldPosition){const[St,yt]=TextChangeCompressor._splitPrev(rt,ut.oldPosition-rt.newPosition);this._acceptPrev(St),rt=yt;continue}let mt,vt;if(ut.oldEnd===rt.newEnd)mt=rt,vt=ut,rt=this._getPrev(++nt),ut=this._getCurr(++ot);else if(ut.oldEnd<rt.newEnd){const[St,yt]=TextChangeCompressor._splitPrev(rt,ut.oldLength);mt=St,vt=ut,rt=yt,ut=this._getCurr(++ot)}else{const[St,yt]=TextChangeCompressor._splitCurr(ut,rt.newLength);mt=rt,vt=St,rt=this._getPrev(++nt),ut=yt}this._result[this._resultLen++]=new TextChange(mt.oldPosition,mt.oldText,vt.newPosition,vt.newText),this._prevDeltaOffset+=mt.newLength-mt.oldLength,this._currDeltaOffset+=vt.newLength-vt.oldLength}const gt=TextChangeCompressor._merge(this._result);return TextChangeCompressor._removeNoOps(gt)}_acceptCurr(nt){this._result[this._resultLen++]=TextChangeCompressor._rebaseCurr(this._prevDeltaOffset,nt),this._currDeltaOffset+=nt.newLength-nt.oldLength}_getCurr(nt){return nt<this._currLen?this._currEdits[nt]:null}_acceptPrev(nt){this._result[this._resultLen++]=TextChangeCompressor._rebasePrev(this._currDeltaOffset,nt),this._prevDeltaOffset+=nt.newLength-nt.oldLength}_getPrev(nt){return nt<this._prevLen?this._prevEdits[nt]:null}static _rebaseCurr(nt,ot){return new TextChange(ot.oldPosition-nt,ot.oldText,ot.newPosition,ot.newText)}static _rebasePrev(nt,ot){return new TextChange(ot.oldPosition,ot.oldText,ot.newPosition+nt,ot.newText)}static _splitPrev(nt,ot){const rt=nt.newText.substr(0,ot),ut=nt.newText.substr(ot);return[new TextChange(nt.oldPosition,nt.oldText,nt.newPosition,rt),new TextChange(nt.oldEnd,"",nt.newPosition+ot,ut)]}static _splitCurr(nt,ot){const rt=nt.oldText.substr(0,ot),ut=nt.oldText.substr(ot);return[new TextChange(nt.oldPosition,rt,nt.newPosition,nt.newText),new TextChange(nt.oldPosition+ot,ut,nt.newEnd,"")]}static _merge(nt){if(nt.length===0)return nt;const ot=[];let rt=0,ut=nt[0];for(let gt=1;gt<nt.length;gt++){const pt=nt[gt];ut.oldEnd===pt.oldPosition?ut=new TextChange(ut.oldPosition,ut.oldText+pt.oldText,ut.newPosition,ut.newText+pt.newText):(ot[rt++]=ut,ut=pt)}return ot[rt++]=ut,ot}static _removeNoOps(nt){if(nt.length===0)return nt;const ot=[];let rt=0;for(let ut=0;ut<nt.length;ut++){const gt=nt[ut];gt.oldText!==gt.newText&&(ot[rt++]=gt)}return ot}}function isPathSeparator(ct){return ct===47||ct===92}function toSlashes(ct){return ct.replace(/[\\/]/g,posix.sep)}function toPosixPath(ct){return ct.indexOf("/")===-1&&(ct=toSlashes(ct)),/^[a-zA-Z]:(\/|$)/.test(ct)&&(ct="/"+ct),ct}function getRoot(ct,nt=posix.sep){if(!ct)return"";const ot=ct.length,rt=ct.charCodeAt(0);if(isPathSeparator(rt)){if(isPathSeparator(ct.charCodeAt(1))&&!isPathSeparator(ct.charCodeAt(2))){let gt=3;const pt=gt;for(;gt<ot&&!isPathSeparator(ct.charCodeAt(gt));gt++);if(pt!==gt&&!isPathSeparator(ct.charCodeAt(gt+1))){for(gt+=1;gt<ot;gt++)if(isPathSeparator(ct.charCodeAt(gt)))return ct.slice(0,gt+1).replace(/[\\/]/g,nt)}}return nt}else if(isWindowsDriveLetter(rt)&&ct.charCodeAt(1)===58)return isPathSeparator(ct.charCodeAt(2))?ct.slice(0,2)+nt:ct.slice(0,2);let ut=ct.indexOf("://");if(ut!==-1){for(ut+=3;ut<ot;ut++)if(isPathSeparator(ct.charCodeAt(ut)))return ct.slice(0,ut+1)}return""}function isEqualOrParent(ct,nt,ot,rt=sep){if(ct===nt)return!0;if(!ct||!nt||nt.length>ct.length)return!1;if(ot){if(!startsWithIgnoreCase(ct,nt))return!1;if(nt.length===ct.length)return!0;let gt=nt.length;return nt.charAt(nt.length-1)===rt&&gt--,ct.charAt(gt)===rt}return nt.charAt(nt.length-1)!==rt&&(nt+=rt),ct.indexOf(nt)===0}function isWindowsDriveLetter(ct){return ct>=65&&ct<=90||ct>=97&&ct<=122}function hasDriveLetter(ct,nt=isWindows){return nt?isWindowsDriveLetter(ct.charCodeAt(0))&&ct.charCodeAt(1)===58:!1}function originalFSPath(ct){return uriToFsPath(ct,!0)}class ExtUri{constructor(nt){this._ignorePathCasing=nt}compare(nt,ot,rt=!1){return nt===ot?0:compare(this.getComparisonKey(nt,rt),this.getComparisonKey(ot,rt))}isEqual(nt,ot,rt=!1){return nt===ot?!0:!nt||!ot?!1:this.getComparisonKey(nt,rt)===this.getComparisonKey(ot,rt)}getComparisonKey(nt,ot=!1){return nt.with({path:this._ignorePathCasing(nt)?nt.path.toLowerCase():void 0,fragment:ot?null:void 0}).toString()}isEqualOrParent(nt,ot,rt=!1){if(nt.scheme===ot.scheme){if(nt.scheme===Schemas.file)return isEqualOrParent(originalFSPath(nt),originalFSPath(ot),this._ignorePathCasing(nt))&&nt.query===ot.query&&(rt||nt.fragment===ot.fragment);if(isEqualAuthority(nt.authority,ot.authority))return isEqualOrParent(nt.path,ot.path,this._ignorePathCasing(nt),"/")&&nt.query===ot.query&&(rt||nt.fragment===ot.fragment)}return!1}joinPath(nt,...ot){return URI.joinPath(nt,...ot)}basenameOrAuthority(nt){return basename(nt)||nt.authority}basename(nt){return posix.basename(nt.path)}extname(nt){return posix.extname(nt.path)}dirname(nt){if(nt.path.length===0)return nt;let ot;return nt.scheme===Schemas.file?ot=URI.file(dirname$1(originalFSPath(nt))).path:(ot=posix.dirname(nt.path),nt.authority&&ot.length&&ot.charCodeAt(0)!==47&&(console.error(`dirname("${nt.toString})) resulted in a relative path`),ot="/")),nt.with({path:ot})}normalizePath(nt){if(!nt.path.length)return nt;let ot;return nt.scheme===Schemas.file?ot=URI.file(normalize(originalFSPath(nt))).path:ot=posix.normalize(nt.path),nt.with({path:ot})}relativePath(nt,ot){if(nt.scheme!==ot.scheme||!isEqualAuthority(nt.authority,ot.authority))return;if(nt.scheme===Schemas.file){const gt=relative(originalFSPath(nt),originalFSPath(ot));return isWindows?toSlashes(gt):gt}let rt=nt.path||"/";const ut=ot.path||"/";if(this._ignorePathCasing(nt)){let gt=0;for(const pt=Math.min(rt.length,ut.length);gt<pt&&!(rt.charCodeAt(gt)!==ut.charCodeAt(gt)&&rt.charAt(gt).toLowerCase()!==ut.charAt(gt).toLowerCase());gt++);rt=ut.substr(0,gt)+rt.substr(gt)}return posix.relative(rt,ut)}resolvePath(nt,ot){if(nt.scheme===Schemas.file){const rt=URI.file(resolve(originalFSPath(nt),ot));return nt.with({authority:rt.authority,path:rt.path})}return ot=toPosixPath(ot),nt.with({path:posix.resolve(nt.path,ot)})}isAbsolutePath(nt){return!!nt.path&&nt.path[0]==="/"}isEqualAuthority(nt,ot){return nt===ot||nt!==void 0&&ot!==void 0&&equalsIgnoreCase(nt,ot)}hasTrailingPathSeparator(nt,ot=sep){if(nt.scheme===Schemas.file){const rt=originalFSPath(nt);return rt.length>getRoot(rt).length&&rt[rt.length-1]===ot}else{const rt=nt.path;return rt.length>1&&rt.charCodeAt(rt.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(nt.fsPath)}}removeTrailingPathSeparator(nt,ot=sep){return hasTrailingPathSeparator(nt,ot)?nt.with({path:nt.path.substr(0,nt.path.length-1)}):nt}addTrailingPathSeparator(nt,ot=sep){let rt=!1;if(nt.scheme===Schemas.file){const ut=originalFSPath(nt);rt=ut!==void 0&&ut.length===getRoot(ut).length&&ut[ut.length-1]===ot}else{ot="/";const ut=nt.path;rt=ut.length===1&&ut.charCodeAt(ut.length-1)===47}return!rt&&!hasTrailingPathSeparator(nt,ot)?nt.with({path:nt.path+"/"}):nt}}const extUri=new ExtUri(()=>!1),isEqual=extUri.isEqual.bind(extUri);extUri.isEqualOrParent.bind(extUri);extUri.getComparisonKey.bind(extUri);const basenameOrAuthority=extUri.basenameOrAuthority.bind(extUri),basename=extUri.basename.bind(extUri),extname=extUri.extname.bind(extUri),dirname=extUri.dirname.bind(extUri),joinPath=extUri.joinPath.bind(extUri),normalizePath=extUri.normalizePath.bind(extUri),relativePath=extUri.relativePath.bind(extUri),resolvePath=extUri.resolvePath.bind(extUri);extUri.isAbsolutePath.bind(extUri);const isEqualAuthority=extUri.isEqualAuthority.bind(extUri),hasTrailingPathSeparator=extUri.hasTrailingPathSeparator.bind(extUri);extUri.removeTrailingPathSeparator.bind(extUri);extUri.addTrailingPathSeparator.bind(extUri);var DataUri;(function(ct){ct.META_DATA_LABEL="label",ct.META_DATA_DESCRIPTION="description",ct.META_DATA_SIZE="size",ct.META_DATA_MIME="mime";function nt(ot){const rt=new Map;ot.path.substring(ot.path.indexOf(";")+1,ot.path.lastIndexOf(";")).split(";").forEach(pt=>{const[mt,vt]=pt.split(":");mt&&vt&&rt.set(mt,vt)});const gt=ot.path.substring(0,ot.path.indexOf(";"));return gt&&rt.set(ct.META_DATA_MIME,gt),rt}ct.parseMetaData=nt})(DataUri||(DataUri={}));function uriGetComparisonKey(ct){return ct.toString()}class SingleModelEditStackData{static create(nt,ot){const rt=nt.getAlternativeVersionId(),ut=getModelEOL(nt);return new SingleModelEditStackData(rt,rt,ut,ut,ot,ot,[])}constructor(nt,ot,rt,ut,gt,pt,mt){this.beforeVersionId=nt,this.afterVersionId=ot,this.beforeEOL=rt,this.afterEOL=ut,this.beforeCursorState=gt,this.afterCursorState=pt,this.changes=mt}append(nt,ot,rt,ut,gt){ot.length>0&&(this.changes=compressConsecutiveTextChanges(this.changes,ot)),this.afterEOL=rt,this.afterVersionId=ut,this.afterCursorState=gt}static _writeSelectionsSize(nt){return 4+4*4*(nt?nt.length:0)}static _writeSelections(nt,ot,rt){if(writeUInt32BE(nt,ot?ot.length:0,rt),rt+=4,ot)for(const ut of ot)writeUInt32BE(nt,ut.selectionStartLineNumber,rt),rt+=4,writeUInt32BE(nt,ut.selectionStartColumn,rt),rt+=4,writeUInt32BE(nt,ut.positionLineNumber,rt),rt+=4,writeUInt32BE(nt,ut.positionColumn,rt),rt+=4;return rt}static _readSelections(nt,ot,rt){const ut=readUInt32BE(nt,ot);ot+=4;for(let gt=0;gt<ut;gt++){const pt=readUInt32BE(nt,ot);ot+=4;const mt=readUInt32BE(nt,ot);ot+=4;const vt=readUInt32BE(nt,ot);ot+=4;const St=readUInt32BE(nt,ot);ot+=4,rt.push(new Selection$1(pt,mt,vt,St))}return ot}serialize(){let nt=10+SingleModelEditStackData._writeSelectionsSize(this.beforeCursorState)+SingleModelEditStackData._writeSelectionsSize(this.afterCursorState)+4;for(const ut of this.changes)nt+=ut.writeSize();const ot=new Uint8Array(nt);let rt=0;writeUInt32BE(ot,this.beforeVersionId,rt),rt+=4,writeUInt32BE(ot,this.afterVersionId,rt),rt+=4,writeUInt8(ot,this.beforeEOL,rt),rt+=1,writeUInt8(ot,this.afterEOL,rt),rt+=1,rt=SingleModelEditStackData._writeSelections(ot,this.beforeCursorState,rt),rt=SingleModelEditStackData._writeSelections(ot,this.afterCursorState,rt),writeUInt32BE(ot,this.changes.length,rt),rt+=4;for(const ut of this.changes)rt=ut.write(ot,rt);return ot.buffer}static deserialize(nt){const ot=new Uint8Array(nt);let rt=0;const ut=readUInt32BE(ot,rt);rt+=4;const gt=readUInt32BE(ot,rt);rt+=4;const pt=readUInt8(ot,rt);rt+=1;const mt=readUInt8(ot,rt);rt+=1;const vt=[];rt=SingleModelEditStackData._readSelections(ot,rt,vt);const St=[];rt=SingleModelEditStackData._readSelections(ot,rt,St);const yt=readUInt32BE(ot,rt);rt+=4;const wt=[];for(let Lt=0;Lt<yt;Lt++)rt=TextChange.read(ot,rt,wt);return new SingleModelEditStackData(ut,gt,pt,mt,vt,St,wt)}}class SingleModelEditStackElement{get type(){return 0}get resource(){return URI.isUri(this.model)?this.model:this.model.uri}constructor(nt,ot,rt,ut){this.label=nt,this.code=ot,this.model=rt,this._data=SingleModelEditStackData.create(rt,ut)}toString(){return(this._data instanceof SingleModelEditStackData?this._data:SingleModelEditStackData.deserialize(this._data)).changes.map(ot=>ot.toString()).join(", ")}matchesResource(nt){return(URI.isUri(this.model)?this.model:this.model.uri).toString()===nt.toString()}setModel(nt){this.model=nt}canAppend(nt){return this.model===nt&&this._data instanceof SingleModelEditStackData}append(nt,ot,rt,ut,gt){this._data instanceof SingleModelEditStackData&&this._data.append(nt,ot,rt,ut,gt)}close(){this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize())}open(){this._data instanceof SingleModelEditStackData||(this._data=SingleModelEditStackData.deserialize(this._data))}undo(){if(URI.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize());const nt=SingleModelEditStackData.deserialize(this._data);this.model._applyUndo(nt.changes,nt.beforeEOL,nt.beforeVersionId,nt.beforeCursorState)}redo(){if(URI.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize());const nt=SingleModelEditStackData.deserialize(this._data);this.model._applyRedo(nt.changes,nt.afterEOL,nt.afterVersionId,nt.afterCursorState)}heapSize(){return this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize()),this._data.byteLength+168}}class MultiModelEditStackElement{get resources(){return this._editStackElementsArr.map(nt=>nt.resource)}constructor(nt,ot,rt){this.label=nt,this.code=ot,this.type=1,this._isOpen=!0,this._editStackElementsArr=rt.slice(0),this._editStackElementsMap=new Map;for(const ut of this._editStackElementsArr){const gt=uriGetComparisonKey(ut.resource);this._editStackElementsMap.set(gt,ut)}this._delegate=null}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(nt){const ot=uriGetComparisonKey(nt);return this._editStackElementsMap.has(ot)}setModel(nt){const ot=uriGetComparisonKey(URI.isUri(nt)?nt:nt.uri);this._editStackElementsMap.has(ot)&&this._editStackElementsMap.get(ot).setModel(nt)}canAppend(nt){if(!this._isOpen)return!1;const ot=uriGetComparisonKey(nt.uri);return this._editStackElementsMap.has(ot)?this._editStackElementsMap.get(ot).canAppend(nt):!1}append(nt,ot,rt,ut,gt){const pt=uriGetComparisonKey(nt.uri);this._editStackElementsMap.get(pt).append(nt,ot,rt,ut,gt)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const nt of this._editStackElementsArr)nt.undo()}redo(){for(const nt of this._editStackElementsArr)nt.redo()}heapSize(nt){const ot=uriGetComparisonKey(nt);return this._editStackElementsMap.has(ot)?this._editStackElementsMap.get(ot).heapSize():0}split(){return this._editStackElementsArr}toString(){const nt=[];for(const ot of this._editStackElementsArr)nt.push(`${basename(ot.resource)}: ${ot}`);return`{${nt.join(", ")}}`}}function getModelEOL(ct){return ct.getEOL()===`
`?0:1}function isEditStackElement(ct){return ct?ct instanceof SingleModelEditStackElement||ct instanceof MultiModelEditStackElement:!1}class EditStack{constructor(nt,ot){this._model=nt,this._undoRedoService=ot}pushStackElement(){const nt=this._undoRedoService.getLastElement(this._model.uri);isEditStackElement(nt)&&nt.close()}popStackElement(){const nt=this._undoRedoService.getLastElement(this._model.uri);isEditStackElement(nt)&&nt.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(nt,ot){const rt=this._undoRedoService.getLastElement(this._model.uri);if(isEditStackElement(rt)&&rt.canAppend(this._model))return rt;const ut=new SingleModelEditStackElement(localize("edit","Typing"),"undoredo.textBufferEdit",this._model,nt);return this._undoRedoService.pushElement(ut,ot),ut}pushEOL(nt){const ot=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(nt),ot.append(this._model,[],getModelEOL(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(nt,ot,rt,ut){const gt=this._getOrCreateEditStackElement(nt,ut),pt=this._model.applyEdits(ot,!0),mt=EditStack._computeCursorState(rt,pt),vt=pt.map((St,yt)=>({index:yt,textChange:St.textChange}));return vt.sort((St,yt)=>St.textChange.oldPosition===yt.textChange.oldPosition?St.index-yt.index:St.textChange.oldPosition-yt.textChange.oldPosition),gt.append(this._model,vt.map(St=>St.textChange),getModelEOL(this._model),this._model.getAlternativeVersionId(),mt),mt}static _computeCursorState(nt,ot){try{return nt?nt(ot):null}catch(rt){return onUnexpectedError(rt),null}}}class SpacesDiffResult{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function spacesDiff(ct,nt,ot,rt,ut){ut.spacesDiff=0,ut.looksLikeAlignment=!1;let gt;for(gt=0;gt<nt&&gt<rt;gt++){const Lt=ct.charCodeAt(gt),xt=ot.charCodeAt(gt);if(Lt!==xt)break}let pt=0,mt=0;for(let Lt=gt;Lt<nt;Lt++)ct.charCodeAt(Lt)===32?pt++:mt++;let vt=0,St=0;for(let Lt=gt;Lt<rt;Lt++)ot.charCodeAt(Lt)===32?vt++:St++;if(pt>0&&mt>0||vt>0&&St>0)return;const yt=Math.abs(mt-St),wt=Math.abs(pt-vt);if(yt===0){ut.spacesDiff=wt,wt>0&&0<=vt-1&&vt-1<ct.length&&vt<ot.length&&ot.charCodeAt(vt)!==32&&ct.charCodeAt(vt-1)===32&&ct.charCodeAt(ct.length-1)===44&&(ut.looksLikeAlignment=!0);return}if(wt%yt===0){ut.spacesDiff=wt/yt;return}}function guessIndentation(ct,nt,ot){const rt=Math.min(ct.getLineCount(),1e4);let ut=0,gt=0,pt="",mt=0;const vt=[2,4,6,8,3,5,7],St=8,yt=[0,0,0,0,0,0,0,0,0],wt=new SpacesDiffResult;for(let It=1;It<=rt;It++){const kt=ct.getLineLength(It),At=ct.getLineContent(It),Tt=kt<=65536;let Rt=!1,Nt=0,Pt=0,Ft=0;for(let Bt=0,Ut=kt;Bt<Ut;Bt++){const qt=Tt?At.charCodeAt(Bt):ct.getLineCharCode(It,Bt);if(qt===9)Ft++;else if(qt===32)Pt++;else{Rt=!0,Nt=Bt;break}}if(!Rt||(Ft>0?ut++:Pt>1&&gt++,spacesDiff(pt,mt,At,Nt,wt),wt.looksLikeAlignment&&!(ot&&nt===wt.spacesDiff)))continue;const Kt=wt.spacesDiff;Kt<=St&&yt[Kt]++,pt=At,mt=Nt}let Lt=ot;ut!==gt&&(Lt=ut<gt);let xt=nt;if(Lt){let It=Lt?0:.1*rt;vt.forEach(kt=>{const At=yt[kt];At>It&&(It=At,xt=kt)}),xt===4&&yt[4]>0&&yt[2]>0&&yt[2]>=yt[4]/2&&(xt=2)}return{insertSpaces:Lt,tabSize:xt}}function getNodeColor(ct){return(ct.metadata&1)>>>0}function setNodeColor(ct,nt){ct.metadata=ct.metadata&254|nt<<0}function getNodeIsVisited(ct){return(ct.metadata&2)>>>1===1}function setNodeIsVisited(ct,nt){ct.metadata=ct.metadata&253|(nt?1:0)<<1}function getNodeIsForValidation(ct){return(ct.metadata&4)>>>2===1}function setNodeIsForValidation(ct,nt){ct.metadata=ct.metadata&251|(nt?1:0)<<2}function getNodeIsInGlyphMargin(ct){return(ct.metadata&64)>>>6===1}function setNodeIsInGlyphMargin(ct,nt){ct.metadata=ct.metadata&191|(nt?1:0)<<6}function getNodeStickiness(ct){return(ct.metadata&24)>>>3}function _setNodeStickiness(ct,nt){ct.metadata=ct.metadata&231|nt<<3}function getCollapseOnReplaceEdit(ct){return(ct.metadata&32)>>>5===1}function setCollapseOnReplaceEdit(ct,nt){ct.metadata=ct.metadata&223|(nt?1:0)<<5}class IntervalNode{constructor(nt,ot,rt){this.metadata=0,this.parent=this,this.left=this,this.right=this,setNodeColor(this,1),this.start=ot,this.end=rt,this.delta=0,this.maxEnd=rt,this.id=nt,this.ownerId=0,this.options=null,setNodeIsForValidation(this,!1),setNodeIsInGlyphMargin(this,!1),_setNodeStickiness(this,1),setCollapseOnReplaceEdit(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=ot,this.cachedAbsoluteEnd=rt,this.range=null,setNodeIsVisited(this,!1)}reset(nt,ot,rt,ut){this.start=ot,this.end=rt,this.maxEnd=rt,this.cachedVersionId=nt,this.cachedAbsoluteStart=ot,this.cachedAbsoluteEnd=rt,this.range=ut}setOptions(nt){this.options=nt;const ot=this.options.className;setNodeIsForValidation(this,ot==="squiggly-error"||ot==="squiggly-warning"||ot==="squiggly-info"),setNodeIsInGlyphMargin(this,this.options.glyphMarginClassName!==null),_setNodeStickiness(this,this.options.stickiness),setCollapseOnReplaceEdit(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(nt,ot,rt){this.cachedVersionId!==rt&&(this.range=null),this.cachedVersionId=rt,this.cachedAbsoluteStart=nt,this.cachedAbsoluteEnd=ot}detach(){this.parent=null,this.left=null,this.right=null}}const SENTINEL$1=new IntervalNode(null,0,0);SENTINEL$1.parent=SENTINEL$1;SENTINEL$1.left=SENTINEL$1;SENTINEL$1.right=SENTINEL$1;setNodeColor(SENTINEL$1,0);class IntervalTree{constructor(){this.root=SENTINEL$1,this.requestNormalizeDelta=!1}intervalSearch(nt,ot,rt,ut,gt,pt){return this.root===SENTINEL$1?[]:intervalSearch(this,nt,ot,rt,ut,gt,pt)}search(nt,ot,rt,ut){return this.root===SENTINEL$1?[]:search(this,nt,ot,rt,ut)}collectNodesFromOwner(nt){return collectNodesFromOwner(this,nt)}collectNodesPostOrder(){return collectNodesPostOrder(this)}insert(nt){rbTreeInsert(this,nt),this._normalizeDeltaIfNecessary()}delete(nt){rbTreeDelete(this,nt),this._normalizeDeltaIfNecessary()}resolveNode(nt,ot){const rt=nt;let ut=0;for(;nt!==this.root;)nt===nt.parent.right&&(ut+=nt.parent.delta),nt=nt.parent;const gt=rt.start+ut,pt=rt.end+ut;rt.setCachedOffsets(gt,pt,ot)}acceptReplace(nt,ot,rt,ut){const gt=searchForEditing(this,nt,nt+ot);for(let pt=0,mt=gt.length;pt<mt;pt++){const vt=gt[pt];rbTreeDelete(this,vt)}this._normalizeDeltaIfNecessary(),noOverlapReplace(this,nt,nt+ot,rt),this._normalizeDeltaIfNecessary();for(let pt=0,mt=gt.length;pt<mt;pt++){const vt=gt[pt];vt.start=vt.cachedAbsoluteStart,vt.end=vt.cachedAbsoluteEnd,nodeAcceptEdit(vt,nt,nt+ot,rt,ut),vt.maxEnd=vt.end,rbTreeInsert(this,vt)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,normalizeDelta(this))}}function normalizeDelta(ct){let nt=ct.root,ot=0;for(;nt!==SENTINEL$1;){if(nt.left!==SENTINEL$1&&!getNodeIsVisited(nt.left)){nt=nt.left;continue}if(nt.right!==SENTINEL$1&&!getNodeIsVisited(nt.right)){ot+=nt.delta,nt=nt.right;continue}nt.start=ot+nt.start,nt.end=ot+nt.end,nt.delta=0,recomputeMaxEnd(nt),setNodeIsVisited(nt,!0),setNodeIsVisited(nt.left,!1),setNodeIsVisited(nt.right,!1),nt===nt.parent.right&&(ot-=nt.parent.delta),nt=nt.parent}setNodeIsVisited(ct.root,!1)}function adjustMarkerBeforeColumn(ct,nt,ot,rt){return ct<ot?!0:ct>ot||rt===1?!1:rt===2?!0:nt}function nodeAcceptEdit(ct,nt,ot,rt,ut){const gt=getNodeStickiness(ct),pt=gt===0||gt===2,mt=gt===1||gt===2,vt=ot-nt,St=rt,yt=Math.min(vt,St),wt=ct.start;let Lt=!1;const xt=ct.end;let It=!1;nt<=wt&&xt<=ot&&getCollapseOnReplaceEdit(ct)&&(ct.start=nt,Lt=!0,ct.end=nt,It=!0);{const At=ut?1:vt>0?2:0;!Lt&&adjustMarkerBeforeColumn(wt,pt,nt,At)&&(Lt=!0),!It&&adjustMarkerBeforeColumn(xt,mt,nt,At)&&(It=!0)}if(yt>0&&!ut){const At=vt>St?2:0;!Lt&&adjustMarkerBeforeColumn(wt,pt,nt+yt,At)&&(Lt=!0),!It&&adjustMarkerBeforeColumn(xt,mt,nt+yt,At)&&(It=!0)}{const At=ut?1:0;!Lt&&adjustMarkerBeforeColumn(wt,pt,ot,At)&&(ct.start=nt+St,Lt=!0),!It&&adjustMarkerBeforeColumn(xt,mt,ot,At)&&(ct.end=nt+St,It=!0)}const kt=St-vt;Lt||(ct.start=Math.max(0,wt+kt)),It||(ct.end=Math.max(0,xt+kt)),ct.start>ct.end&&(ct.end=ct.start)}function searchForEditing(ct,nt,ot){let rt=ct.root,ut=0,gt=0,pt=0,mt=0;const vt=[];let St=0;for(;rt!==SENTINEL$1;){if(getNodeIsVisited(rt)){setNodeIsVisited(rt.left,!1),setNodeIsVisited(rt.right,!1),rt===rt.parent.right&&(ut-=rt.parent.delta),rt=rt.parent;continue}if(!getNodeIsVisited(rt.left)){if(gt=ut+rt.maxEnd,gt<nt){setNodeIsVisited(rt,!0);continue}if(rt.left!==SENTINEL$1){rt=rt.left;continue}}if(pt=ut+rt.start,pt>ot){setNodeIsVisited(rt,!0);continue}if(mt=ut+rt.end,mt>=nt&&(rt.setCachedOffsets(pt,mt,0),vt[St++]=rt),setNodeIsVisited(rt,!0),rt.right!==SENTINEL$1&&!getNodeIsVisited(rt.right)){ut+=rt.delta,rt=rt.right;continue}}return setNodeIsVisited(ct.root,!1),vt}function noOverlapReplace(ct,nt,ot,rt){let ut=ct.root,gt=0,pt=0,mt=0;const vt=rt-(ot-nt);for(;ut!==SENTINEL$1;){if(getNodeIsVisited(ut)){setNodeIsVisited(ut.left,!1),setNodeIsVisited(ut.right,!1),ut===ut.parent.right&&(gt-=ut.parent.delta),recomputeMaxEnd(ut),ut=ut.parent;continue}if(!getNodeIsVisited(ut.left)){if(pt=gt+ut.maxEnd,pt<nt){setNodeIsVisited(ut,!0);continue}if(ut.left!==SENTINEL$1){ut=ut.left;continue}}if(mt=gt+ut.start,mt>ot){ut.start+=vt,ut.end+=vt,ut.delta+=vt,(ut.delta<-1073741824||ut.delta>1073741824)&&(ct.requestNormalizeDelta=!0),setNodeIsVisited(ut,!0);continue}if(setNodeIsVisited(ut,!0),ut.right!==SENTINEL$1&&!getNodeIsVisited(ut.right)){gt+=ut.delta,ut=ut.right;continue}}setNodeIsVisited(ct.root,!1)}function collectNodesFromOwner(ct,nt){let ot=ct.root;const rt=[];let ut=0;for(;ot!==SENTINEL$1;){if(getNodeIsVisited(ot)){setNodeIsVisited(ot.left,!1),setNodeIsVisited(ot.right,!1),ot=ot.parent;continue}if(ot.left!==SENTINEL$1&&!getNodeIsVisited(ot.left)){ot=ot.left;continue}if(ot.ownerId===nt&&(rt[ut++]=ot),setNodeIsVisited(ot,!0),ot.right!==SENTINEL$1&&!getNodeIsVisited(ot.right)){ot=ot.right;continue}}return setNodeIsVisited(ct.root,!1),rt}function collectNodesPostOrder(ct){let nt=ct.root;const ot=[];let rt=0;for(;nt!==SENTINEL$1;){if(getNodeIsVisited(nt)){setNodeIsVisited(nt.left,!1),setNodeIsVisited(nt.right,!1),nt=nt.parent;continue}if(nt.left!==SENTINEL$1&&!getNodeIsVisited(nt.left)){nt=nt.left;continue}if(nt.right!==SENTINEL$1&&!getNodeIsVisited(nt.right)){nt=nt.right;continue}ot[rt++]=nt,setNodeIsVisited(nt,!0)}return setNodeIsVisited(ct.root,!1),ot}function search(ct,nt,ot,rt,ut){let gt=ct.root,pt=0,mt=0,vt=0;const St=[];let yt=0;for(;gt!==SENTINEL$1;){if(getNodeIsVisited(gt)){setNodeIsVisited(gt.left,!1),setNodeIsVisited(gt.right,!1),gt===gt.parent.right&&(pt-=gt.parent.delta),gt=gt.parent;continue}if(gt.left!==SENTINEL$1&&!getNodeIsVisited(gt.left)){gt=gt.left;continue}mt=pt+gt.start,vt=pt+gt.end,gt.setCachedOffsets(mt,vt,rt);let wt=!0;if(nt&&gt.ownerId&&gt.ownerId!==nt&&(wt=!1),ot&&getNodeIsForValidation(gt)&&(wt=!1),ut&&!getNodeIsInGlyphMargin(gt)&&(wt=!1),wt&&(St[yt++]=gt),setNodeIsVisited(gt,!0),gt.right!==SENTINEL$1&&!getNodeIsVisited(gt.right)){pt+=gt.delta,gt=gt.right;continue}}return setNodeIsVisited(ct.root,!1),St}function intervalSearch(ct,nt,ot,rt,ut,gt,pt){let mt=ct.root,vt=0,St=0,yt=0,wt=0;const Lt=[];let xt=0;for(;mt!==SENTINEL$1;){if(getNodeIsVisited(mt)){setNodeIsVisited(mt.left,!1),setNodeIsVisited(mt.right,!1),mt===mt.parent.right&&(vt-=mt.parent.delta),mt=mt.parent;continue}if(!getNodeIsVisited(mt.left)){if(St=vt+mt.maxEnd,St<nt){setNodeIsVisited(mt,!0);continue}if(mt.left!==SENTINEL$1){mt=mt.left;continue}}if(yt=vt+mt.start,yt>ot){setNodeIsVisited(mt,!0);continue}if(wt=vt+mt.end,wt>=nt){mt.setCachedOffsets(yt,wt,gt);let It=!0;rt&&mt.ownerId&&mt.ownerId!==rt&&(It=!1),ut&&getNodeIsForValidation(mt)&&(It=!1),pt&&!getNodeIsInGlyphMargin(mt)&&(It=!1),It&&(Lt[xt++]=mt)}if(setNodeIsVisited(mt,!0),mt.right!==SENTINEL$1&&!getNodeIsVisited(mt.right)){vt+=mt.delta,mt=mt.right;continue}}return setNodeIsVisited(ct.root,!1),Lt}function rbTreeInsert(ct,nt){if(ct.root===SENTINEL$1)return nt.parent=SENTINEL$1,nt.left=SENTINEL$1,nt.right=SENTINEL$1,setNodeColor(nt,0),ct.root=nt,ct.root;treeInsert(ct,nt),recomputeMaxEndWalkToRoot(nt.parent);let ot=nt;for(;ot!==ct.root&&getNodeColor(ot.parent)===1;)if(ot.parent===ot.parent.parent.left){const rt=ot.parent.parent.right;getNodeColor(rt)===1?(setNodeColor(ot.parent,0),setNodeColor(rt,0),setNodeColor(ot.parent.parent,1),ot=ot.parent.parent):(ot===ot.parent.right&&(ot=ot.parent,leftRotate$1(ct,ot)),setNodeColor(ot.parent,0),setNodeColor(ot.parent.parent,1),rightRotate$1(ct,ot.parent.parent))}else{const rt=ot.parent.parent.left;getNodeColor(rt)===1?(setNodeColor(ot.parent,0),setNodeColor(rt,0),setNodeColor(ot.parent.parent,1),ot=ot.parent.parent):(ot===ot.parent.left&&(ot=ot.parent,rightRotate$1(ct,ot)),setNodeColor(ot.parent,0),setNodeColor(ot.parent.parent,1),leftRotate$1(ct,ot.parent.parent))}return setNodeColor(ct.root,0),nt}function treeInsert(ct,nt){let ot=0,rt=ct.root;const ut=nt.start,gt=nt.end;for(;;)if(intervalCompare(ut,gt,rt.start+ot,rt.end+ot)<0)if(rt.left===SENTINEL$1){nt.start-=ot,nt.end-=ot,nt.maxEnd-=ot,rt.left=nt;break}else rt=rt.left;else if(rt.right===SENTINEL$1){nt.start-=ot+rt.delta,nt.end-=ot+rt.delta,nt.maxEnd-=ot+rt.delta,rt.right=nt;break}else ot+=rt.delta,rt=rt.right;nt.parent=rt,nt.left=SENTINEL$1,nt.right=SENTINEL$1,setNodeColor(nt,1)}function rbTreeDelete(ct,nt){let ot,rt;if(nt.left===SENTINEL$1?(ot=nt.right,rt=nt,ot.delta+=nt.delta,(ot.delta<-1073741824||ot.delta>1073741824)&&(ct.requestNormalizeDelta=!0),ot.start+=nt.delta,ot.end+=nt.delta):nt.right===SENTINEL$1?(ot=nt.left,rt=nt):(rt=leftest$1(nt.right),ot=rt.right,ot.start+=rt.delta,ot.end+=rt.delta,ot.delta+=rt.delta,(ot.delta<-1073741824||ot.delta>1073741824)&&(ct.requestNormalizeDelta=!0),rt.start+=nt.delta,rt.end+=nt.delta,rt.delta=nt.delta,(rt.delta<-1073741824||rt.delta>1073741824)&&(ct.requestNormalizeDelta=!0)),rt===ct.root){ct.root=ot,setNodeColor(ot,0),nt.detach(),resetSentinel$1(),recomputeMaxEnd(ot),ct.root.parent=SENTINEL$1;return}const ut=getNodeColor(rt)===1;if(rt===rt.parent.left?rt.parent.left=ot:rt.parent.right=ot,rt===nt?ot.parent=rt.parent:(rt.parent===nt?ot.parent=rt:ot.parent=rt.parent,rt.left=nt.left,rt.right=nt.right,rt.parent=nt.parent,setNodeColor(rt,getNodeColor(nt)),nt===ct.root?ct.root=rt:nt===nt.parent.left?nt.parent.left=rt:nt.parent.right=rt,rt.left!==SENTINEL$1&&(rt.left.parent=rt),rt.right!==SENTINEL$1&&(rt.right.parent=rt)),nt.detach(),ut){recomputeMaxEndWalkToRoot(ot.parent),rt!==nt&&(recomputeMaxEndWalkToRoot(rt),recomputeMaxEndWalkToRoot(rt.parent)),resetSentinel$1();return}recomputeMaxEndWalkToRoot(ot),recomputeMaxEndWalkToRoot(ot.parent),rt!==nt&&(recomputeMaxEndWalkToRoot(rt),recomputeMaxEndWalkToRoot(rt.parent));let gt;for(;ot!==ct.root&&getNodeColor(ot)===0;)ot===ot.parent.left?(gt=ot.parent.right,getNodeColor(gt)===1&&(setNodeColor(gt,0),setNodeColor(ot.parent,1),leftRotate$1(ct,ot.parent),gt=ot.parent.right),getNodeColor(gt.left)===0&&getNodeColor(gt.right)===0?(setNodeColor(gt,1),ot=ot.parent):(getNodeColor(gt.right)===0&&(setNodeColor(gt.left,0),setNodeColor(gt,1),rightRotate$1(ct,gt),gt=ot.parent.right),setNodeColor(gt,getNodeColor(ot.parent)),setNodeColor(ot.parent,0),setNodeColor(gt.right,0),leftRotate$1(ct,ot.parent),ot=ct.root)):(gt=ot.parent.left,getNodeColor(gt)===1&&(setNodeColor(gt,0),setNodeColor(ot.parent,1),rightRotate$1(ct,ot.parent),gt=ot.parent.left),getNodeColor(gt.left)===0&&getNodeColor(gt.right)===0?(setNodeColor(gt,1),ot=ot.parent):(getNodeColor(gt.left)===0&&(setNodeColor(gt.right,0),setNodeColor(gt,1),leftRotate$1(ct,gt),gt=ot.parent.left),setNodeColor(gt,getNodeColor(ot.parent)),setNodeColor(ot.parent,0),setNodeColor(gt.left,0),rightRotate$1(ct,ot.parent),ot=ct.root));setNodeColor(ot,0),resetSentinel$1()}function leftest$1(ct){for(;ct.left!==SENTINEL$1;)ct=ct.left;return ct}function resetSentinel$1(){SENTINEL$1.parent=SENTINEL$1,SENTINEL$1.delta=0,SENTINEL$1.start=0,SENTINEL$1.end=0}function leftRotate$1(ct,nt){const ot=nt.right;ot.delta+=nt.delta,(ot.delta<-1073741824||ot.delta>1073741824)&&(ct.requestNormalizeDelta=!0),ot.start+=nt.delta,ot.end+=nt.delta,nt.right=ot.left,ot.left!==SENTINEL$1&&(ot.left.parent=nt),ot.parent=nt.parent,nt.parent===SENTINEL$1?ct.root=ot:nt===nt.parent.left?nt.parent.left=ot:nt.parent.right=ot,ot.left=nt,nt.parent=ot,recomputeMaxEnd(nt),recomputeMaxEnd(ot)}function rightRotate$1(ct,nt){const ot=nt.left;nt.delta-=ot.delta,(nt.delta<-1073741824||nt.delta>1073741824)&&(ct.requestNormalizeDelta=!0),nt.start-=ot.delta,nt.end-=ot.delta,nt.left=ot.right,ot.right!==SENTINEL$1&&(ot.right.parent=nt),ot.parent=nt.parent,nt.parent===SENTINEL$1?ct.root=ot:nt===nt.parent.right?nt.parent.right=ot:nt.parent.left=ot,ot.right=nt,nt.parent=ot,recomputeMaxEnd(nt),recomputeMaxEnd(ot)}function computeMaxEnd(ct){let nt=ct.end;if(ct.left!==SENTINEL$1){const ot=ct.left.maxEnd;ot>nt&&(nt=ot)}if(ct.right!==SENTINEL$1){const ot=ct.right.maxEnd+ct.delta;ot>nt&&(nt=ot)}return nt}function recomputeMaxEnd(ct){ct.maxEnd=computeMaxEnd(ct)}function recomputeMaxEndWalkToRoot(ct){for(;ct!==SENTINEL$1;){const nt=computeMaxEnd(ct);if(ct.maxEnd===nt)return;ct.maxEnd=nt,ct=ct.parent}}function intervalCompare(ct,nt,ot,rt){return ct===ot?nt-rt:ct-ot}class TreeNode{constructor(nt,ot){this.piece=nt,this.color=ot,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==SENTINEL)return leftest(this.right);let nt=this;for(;nt.parent!==SENTINEL&&nt.parent.left!==nt;)nt=nt.parent;return nt.parent===SENTINEL?SENTINEL:nt.parent}prev(){if(this.left!==SENTINEL)return righttest(this.left);let nt=this;for(;nt.parent!==SENTINEL&&nt.parent.right!==nt;)nt=nt.parent;return nt.parent===SENTINEL?SENTINEL:nt.parent}detach(){this.parent=null,this.left=null,this.right=null}}const SENTINEL=new TreeNode(null,0);SENTINEL.parent=SENTINEL;SENTINEL.left=SENTINEL;SENTINEL.right=SENTINEL;SENTINEL.color=0;function leftest(ct){for(;ct.left!==SENTINEL;)ct=ct.left;return ct}function righttest(ct){for(;ct.right!==SENTINEL;)ct=ct.right;return ct}function calculateSize(ct){return ct===SENTINEL?0:ct.size_left+ct.piece.length+calculateSize(ct.right)}function calculateLF(ct){return ct===SENTINEL?0:ct.lf_left+ct.piece.lineFeedCnt+calculateLF(ct.right)}function resetSentinel(){SENTINEL.parent=SENTINEL}function leftRotate(ct,nt){const ot=nt.right;ot.size_left+=nt.size_left+(nt.piece?nt.piece.length:0),ot.lf_left+=nt.lf_left+(nt.piece?nt.piece.lineFeedCnt:0),nt.right=ot.left,ot.left!==SENTINEL&&(ot.left.parent=nt),ot.parent=nt.parent,nt.parent===SENTINEL?ct.root=ot:nt.parent.left===nt?nt.parent.left=ot:nt.parent.right=ot,ot.left=nt,nt.parent=ot}function rightRotate(ct,nt){const ot=nt.left;nt.left=ot.right,ot.right!==SENTINEL&&(ot.right.parent=nt),ot.parent=nt.parent,nt.size_left-=ot.size_left+(ot.piece?ot.piece.length:0),nt.lf_left-=ot.lf_left+(ot.piece?ot.piece.lineFeedCnt:0),nt.parent===SENTINEL?ct.root=ot:nt===nt.parent.right?nt.parent.right=ot:nt.parent.left=ot,ot.right=nt,nt.parent=ot}function rbDelete(ct,nt){let ot,rt;if(nt.left===SENTINEL?(rt=nt,ot=rt.right):nt.right===SENTINEL?(rt=nt,ot=rt.left):(rt=leftest(nt.right),ot=rt.right),rt===ct.root){ct.root=ot,ot.color=0,nt.detach(),resetSentinel(),ct.root.parent=SENTINEL;return}const ut=rt.color===1;if(rt===rt.parent.left?rt.parent.left=ot:rt.parent.right=ot,rt===nt?(ot.parent=rt.parent,recomputeTreeMetadata(ct,ot)):(rt.parent===nt?ot.parent=rt:ot.parent=rt.parent,recomputeTreeMetadata(ct,ot),rt.left=nt.left,rt.right=nt.right,rt.parent=nt.parent,rt.color=nt.color,nt===ct.root?ct.root=rt:nt===nt.parent.left?nt.parent.left=rt:nt.parent.right=rt,rt.left!==SENTINEL&&(rt.left.parent=rt),rt.right!==SENTINEL&&(rt.right.parent=rt),rt.size_left=nt.size_left,rt.lf_left=nt.lf_left,recomputeTreeMetadata(ct,rt)),nt.detach(),ot.parent.left===ot){const pt=calculateSize(ot),mt=calculateLF(ot);if(pt!==ot.parent.size_left||mt!==ot.parent.lf_left){const vt=pt-ot.parent.size_left,St=mt-ot.parent.lf_left;ot.parent.size_left=pt,ot.parent.lf_left=mt,updateTreeMetadata(ct,ot.parent,vt,St)}}if(recomputeTreeMetadata(ct,ot.parent),ut){resetSentinel();return}let gt;for(;ot!==ct.root&&ot.color===0;)ot===ot.parent.left?(gt=ot.parent.right,gt.color===1&&(gt.color=0,ot.parent.color=1,leftRotate(ct,ot.parent),gt=ot.parent.right),gt.left.color===0&&gt.right.color===0?(gt.color=1,ot=ot.parent):(gt.right.color===0&&(gt.left.color=0,gt.color=1,rightRotate(ct,gt),gt=ot.parent.right),gt.color=ot.parent.color,ot.parent.color=0,gt.right.color=0,leftRotate(ct,ot.parent),ot=ct.root)):(gt=ot.parent.left,gt.color===1&&(gt.color=0,ot.parent.color=1,rightRotate(ct,ot.parent),gt=ot.parent.left),gt.left.color===0&&gt.right.color===0?(gt.color=1,ot=ot.parent):(gt.left.color===0&&(gt.right.color=0,gt.color=1,leftRotate(ct,gt),gt=ot.parent.left),gt.color=ot.parent.color,ot.parent.color=0,gt.left.color=0,rightRotate(ct,ot.parent),ot=ct.root));ot.color=0,resetSentinel()}function fixInsert(ct,nt){for(recomputeTreeMetadata(ct,nt);nt!==ct.root&&nt.parent.color===1;)if(nt.parent===nt.parent.parent.left){const ot=nt.parent.parent.right;ot.color===1?(nt.parent.color=0,ot.color=0,nt.parent.parent.color=1,nt=nt.parent.parent):(nt===nt.parent.right&&(nt=nt.parent,leftRotate(ct,nt)),nt.parent.color=0,nt.parent.parent.color=1,rightRotate(ct,nt.parent.parent))}else{const ot=nt.parent.parent.left;ot.color===1?(nt.parent.color=0,ot.color=0,nt.parent.parent.color=1,nt=nt.parent.parent):(nt===nt.parent.left&&(nt=nt.parent,rightRotate(ct,nt)),nt.parent.color=0,nt.parent.parent.color=1,leftRotate(ct,nt.parent.parent))}ct.root.color=0}function updateTreeMetadata(ct,nt,ot,rt){for(;nt!==ct.root&&nt!==SENTINEL;)nt.parent.left===nt&&(nt.parent.size_left+=ot,nt.parent.lf_left+=rt),nt=nt.parent}function recomputeTreeMetadata(ct,nt){let ot=0,rt=0;if(nt!==ct.root){for(;nt!==ct.root&&nt===nt.parent.right;)nt=nt.parent;if(nt!==ct.root)for(nt=nt.parent,ot=calculateSize(nt.left)-nt.size_left,rt=calculateLF(nt.left)-nt.lf_left,nt.size_left+=ot,nt.lf_left+=rt;nt!==ct.root&&(ot!==0||rt!==0);)nt.parent.left===nt&&(nt.parent.size_left+=ot,nt.parent.lf_left+=rt),nt=nt.parent}}const AverageBufferSize=65535;function createUintArray(ct){let nt;return ct[ct.length-1]<65536?nt=new Uint16Array(ct.length):nt=new Uint32Array(ct.length),nt.set(ct,0),nt}class LineStarts{constructor(nt,ot,rt,ut,gt){this.lineStarts=nt,this.cr=ot,this.lf=rt,this.crlf=ut,this.isBasicASCII=gt}}function createLineStartsFast(ct,nt=!0){const ot=[0];let rt=1;for(let ut=0,gt=ct.length;ut<gt;ut++){const pt=ct.charCodeAt(ut);pt===13?ut+1<gt&&ct.charCodeAt(ut+1)===10?(ot[rt++]=ut+2,ut++):ot[rt++]=ut+1:pt===10&&(ot[rt++]=ut+1)}return nt?createUintArray(ot):ot}function createLineStarts(ct,nt){ct.length=0,ct[0]=0;let ot=1,rt=0,ut=0,gt=0,pt=!0;for(let vt=0,St=nt.length;vt<St;vt++){const yt=nt.charCodeAt(vt);yt===13?vt+1<St&&nt.charCodeAt(vt+1)===10?(gt++,ct[ot++]=vt+2,vt++):(rt++,ct[ot++]=vt+1):yt===10?(ut++,ct[ot++]=vt+1):pt&&yt!==9&&(yt<32||yt>126)&&(pt=!1)}const mt=new LineStarts(createUintArray(ct),rt,ut,gt,pt);return ct.length=0,mt}class Piece{constructor(nt,ot,rt,ut,gt){this.bufferIndex=nt,this.start=ot,this.end=rt,this.lineFeedCnt=ut,this.length=gt}}class StringBuffer{constructor(nt,ot){this.buffer=nt,this.lineStarts=ot}}class PieceTreeSnapshot{constructor(nt,ot){this._pieces=[],this._tree=nt,this._BOM=ot,this._index=0,nt.root!==SENTINEL&&nt.iterate(nt.root,rt=>(rt!==SENTINEL&&this._pieces.push(rt.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class PieceTreeSearchCache{constructor(nt){this._limit=nt,this._cache=[]}get(nt){for(let ot=this._cache.length-1;ot>=0;ot--){const rt=this._cache[ot];if(rt.nodeStartOffset<=nt&&rt.nodeStartOffset+rt.node.piece.length>=nt)return rt}return null}get2(nt){for(let ot=this._cache.length-1;ot>=0;ot--){const rt=this._cache[ot];if(rt.nodeStartLineNumber&&rt.nodeStartLineNumber<nt&&rt.nodeStartLineNumber+rt.node.piece.lineFeedCnt>=nt)return rt}return null}set(nt){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(nt)}validate(nt){let ot=!1;const rt=this._cache;for(let ut=0;ut<rt.length;ut++){const gt=rt[ut];if(gt.node.parent===null||gt.nodeStartOffset>=nt){rt[ut]=null,ot=!0;continue}}if(ot){const ut=[];for(const gt of rt)gt!==null&&ut.push(gt);this._cache=ut}}}class PieceTreeBase{constructor(nt,ot,rt){this.create(nt,ot,rt)}create(nt,ot,rt){this._buffers=[new StringBuffer("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=SENTINEL,this._lineCnt=1,this._length=0,this._EOL=ot,this._EOLLength=ot.length,this._EOLNormalized=rt;let ut=null;for(let gt=0,pt=nt.length;gt<pt;gt++)if(nt[gt].buffer.length>0){nt[gt].lineStarts||(nt[gt].lineStarts=createLineStartsFast(nt[gt].buffer));const mt=new Piece(gt+1,{line:0,column:0},{line:nt[gt].lineStarts.length-1,column:nt[gt].buffer.length-nt[gt].lineStarts[nt[gt].lineStarts.length-1]},nt[gt].lineStarts.length-1,nt[gt].buffer.length);this._buffers.push(nt[gt]),ut=this.rbInsertRight(ut,mt)}this._searchCache=new PieceTreeSearchCache(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(nt){const ot=AverageBufferSize,rt=ot-Math.floor(ot/3),ut=rt*2;let gt="",pt=0;const mt=[];if(this.iterate(this.root,vt=>{const St=this.getNodeContent(vt),yt=St.length;if(pt<=rt||pt+yt<ut)return gt+=St,pt+=yt,!0;const wt=gt.replace(/\r\n|\r|\n/g,nt);return mt.push(new StringBuffer(wt,createLineStartsFast(wt))),gt=St,pt=yt,!0}),pt>0){const vt=gt.replace(/\r\n|\r|\n/g,nt);mt.push(new StringBuffer(vt,createLineStartsFast(vt)))}this.create(mt,nt,!0)}getEOL(){return this._EOL}setEOL(nt){this._EOL=nt,this._EOLLength=this._EOL.length,this.normalizeEOL(nt)}createSnapshot(nt){return new PieceTreeSnapshot(this,nt)}getOffsetAt(nt,ot){let rt=0,ut=this.root;for(;ut!==SENTINEL;)if(ut.left!==SENTINEL&&ut.lf_left+1>=nt)ut=ut.left;else if(ut.lf_left+ut.piece.lineFeedCnt+1>=nt){rt+=ut.size_left;const gt=this.getAccumulatedValue(ut,nt-ut.lf_left-2);return rt+=gt+ot-1}else nt-=ut.lf_left+ut.piece.lineFeedCnt,rt+=ut.size_left+ut.piece.length,ut=ut.right;return rt}getPositionAt(nt){nt=Math.floor(nt),nt=Math.max(0,nt);let ot=this.root,rt=0;const ut=nt;for(;ot!==SENTINEL;)if(ot.size_left!==0&&ot.size_left>=nt)ot=ot.left;else if(ot.size_left+ot.piece.length>=nt){const gt=this.getIndexOf(ot,nt-ot.size_left);if(rt+=ot.lf_left+gt.index,gt.index===0){const pt=this.getOffsetAt(rt+1,1),mt=ut-pt;return new Position$1(rt+1,mt+1)}return new Position$1(rt+1,gt.remainder+1)}else if(nt-=ot.size_left+ot.piece.length,rt+=ot.lf_left+ot.piece.lineFeedCnt,ot.right===SENTINEL){const gt=this.getOffsetAt(rt+1,1),pt=ut-nt-gt;return new Position$1(rt+1,pt+1)}else ot=ot.right;return new Position$1(1,1)}getValueInRange(nt,ot){if(nt.startLineNumber===nt.endLineNumber&&nt.startColumn===nt.endColumn)return"";const rt=this.nodeAt2(nt.startLineNumber,nt.startColumn),ut=this.nodeAt2(nt.endLineNumber,nt.endColumn),gt=this.getValueInRange2(rt,ut);return ot?ot!==this._EOL||!this._EOLNormalized?gt.replace(/\r\n|\r|\n/g,ot):ot===this.getEOL()&&this._EOLNormalized?gt:gt.replace(/\r\n|\r|\n/g,ot):gt}getValueInRange2(nt,ot){if(nt.node===ot.node){const mt=nt.node,vt=this._buffers[mt.piece.bufferIndex].buffer,St=this.offsetInBuffer(mt.piece.bufferIndex,mt.piece.start);return vt.substring(St+nt.remainder,St+ot.remainder)}let rt=nt.node;const ut=this._buffers[rt.piece.bufferIndex].buffer,gt=this.offsetInBuffer(rt.piece.bufferIndex,rt.piece.start);let pt=ut.substring(gt+nt.remainder,gt+rt.piece.length);for(rt=rt.next();rt!==SENTINEL;){const mt=this._buffers[rt.piece.bufferIndex].buffer,vt=this.offsetInBuffer(rt.piece.bufferIndex,rt.piece.start);if(rt===ot.node){pt+=mt.substring(vt,vt+ot.remainder);break}else pt+=mt.substr(vt,rt.piece.length);rt=rt.next()}return pt}getLinesContent(){const nt=[];let ot=0,rt="",ut=!1;return this.iterate(this.root,gt=>{if(gt===SENTINEL)return!0;const pt=gt.piece;let mt=pt.length;if(mt===0)return!0;const vt=this._buffers[pt.bufferIndex].buffer,St=this._buffers[pt.bufferIndex].lineStarts,yt=pt.start.line,wt=pt.end.line;let Lt=St[yt]+pt.start.column;if(ut&&(vt.charCodeAt(Lt)===10&&(Lt++,mt--),nt[ot++]=rt,rt="",ut=!1,mt===0))return!0;if(yt===wt)return!this._EOLNormalized&&vt.charCodeAt(Lt+mt-1)===13?(ut=!0,rt+=vt.substr(Lt,mt-1)):rt+=vt.substr(Lt,mt),!0;rt+=this._EOLNormalized?vt.substring(Lt,Math.max(Lt,St[yt+1]-this._EOLLength)):vt.substring(Lt,St[yt+1]).replace(/(\r\n|\r|\n)$/,""),nt[ot++]=rt;for(let xt=yt+1;xt<wt;xt++)rt=this._EOLNormalized?vt.substring(St[xt],St[xt+1]-this._EOLLength):vt.substring(St[xt],St[xt+1]).replace(/(\r\n|\r|\n)$/,""),nt[ot++]=rt;return!this._EOLNormalized&&vt.charCodeAt(St[wt]+pt.end.column-1)===13?(ut=!0,pt.end.column===0?ot--:rt=vt.substr(St[wt],pt.end.column-1)):rt=vt.substr(St[wt],pt.end.column),!0}),ut&&(nt[ot++]=rt,rt=""),nt[ot++]=rt,nt}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(nt){return this._lastVisitedLine.lineNumber===nt?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=nt,nt===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(nt):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(nt,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(nt).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(nt){if(nt.remainder===nt.node.piece.length){const ot=nt.node.next();if(!ot)return 0;const rt=this._buffers[ot.piece.bufferIndex],ut=this.offsetInBuffer(ot.piece.bufferIndex,ot.piece.start);return rt.buffer.charCodeAt(ut)}else{const ot=this._buffers[nt.node.piece.bufferIndex],ut=this.offsetInBuffer(nt.node.piece.bufferIndex,nt.node.piece.start)+nt.remainder;return ot.buffer.charCodeAt(ut)}}getLineCharCode(nt,ot){const rt=this.nodeAt2(nt,ot+1);return this._getCharCode(rt)}getLineLength(nt){if(nt===this.getLineCount()){const ot=this.getOffsetAt(nt,1);return this.getLength()-ot}return this.getOffsetAt(nt+1,1)-this.getOffsetAt(nt,1)-this._EOLLength}findMatchesInNode(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt){const Lt=this._buffers[nt.piece.bufferIndex],xt=this.offsetInBuffer(nt.piece.bufferIndex,nt.piece.start),It=this.offsetInBuffer(nt.piece.bufferIndex,gt),kt=this.offsetInBuffer(nt.piece.bufferIndex,pt);let At;const Tt={line:0,column:0};let Rt,Nt;ot._wordSeparators?(Rt=Lt.buffer.substring(It,kt),Nt=Pt=>Pt+It,ot.reset(0)):(Rt=Lt.buffer,Nt=Pt=>Pt,ot.reset(It));do if(At=ot.next(Rt),At){if(Nt(At.index)>=kt)return yt;this.positionInBuffer(nt,Nt(At.index)-xt,Tt);const Pt=this.getLineFeedCnt(nt.piece.bufferIndex,gt,Tt),Ft=Tt.line===gt.line?Tt.column-gt.column+ut:Tt.column+1,Kt=Ft+At[0].length;if(wt[yt++]=createFindMatch(new Range$2(rt+Pt,Ft,rt+Pt,Kt),At,vt),Nt(At.index)+At[0].length>=kt||yt>=St)return yt}while(At);return yt}findMatchesLineByLine(nt,ot,rt,ut){const gt=[];let pt=0;const mt=new Searcher(ot.wordSeparators,ot.regex);let vt=this.nodeAt2(nt.startLineNumber,nt.startColumn);if(vt===null)return[];const St=this.nodeAt2(nt.endLineNumber,nt.endColumn);if(St===null)return[];let yt=this.positionInBuffer(vt.node,vt.remainder);const wt=this.positionInBuffer(St.node,St.remainder);if(vt.node===St.node)return this.findMatchesInNode(vt.node,mt,nt.startLineNumber,nt.startColumn,yt,wt,ot,rt,ut,pt,gt),gt;let Lt=nt.startLineNumber,xt=vt.node;for(;xt!==St.node;){const kt=this.getLineFeedCnt(xt.piece.bufferIndex,yt,xt.piece.end);if(kt>=1){const Tt=this._buffers[xt.piece.bufferIndex].lineStarts,Rt=this.offsetInBuffer(xt.piece.bufferIndex,xt.piece.start),Nt=Tt[yt.line+kt],Pt=Lt===nt.startLineNumber?nt.startColumn:1;if(pt=this.findMatchesInNode(xt,mt,Lt,Pt,yt,this.positionInBuffer(xt,Nt-Rt),ot,rt,ut,pt,gt),pt>=ut)return gt;Lt+=kt}const At=Lt===nt.startLineNumber?nt.startColumn-1:0;if(Lt===nt.endLineNumber){const Tt=this.getLineContent(Lt).substring(At,nt.endColumn-1);return pt=this._findMatchesInLine(ot,mt,Tt,nt.endLineNumber,At,pt,gt,rt,ut),gt}if(pt=this._findMatchesInLine(ot,mt,this.getLineContent(Lt).substr(At),Lt,At,pt,gt,rt,ut),pt>=ut)return gt;Lt++,vt=this.nodeAt2(Lt,1),xt=vt.node,yt=this.positionInBuffer(vt.node,vt.remainder)}if(Lt===nt.endLineNumber){const kt=Lt===nt.startLineNumber?nt.startColumn-1:0,At=this.getLineContent(Lt).substring(kt,nt.endColumn-1);return pt=this._findMatchesInLine(ot,mt,At,nt.endLineNumber,kt,pt,gt,rt,ut),gt}const It=Lt===nt.startLineNumber?nt.startColumn:1;return pt=this.findMatchesInNode(St.node,mt,Lt,It,yt,wt,ot,rt,ut,pt,gt),gt}_findMatchesInLine(nt,ot,rt,ut,gt,pt,mt,vt,St){const yt=nt.wordSeparators;if(!vt&&nt.simpleSearch){const Lt=nt.simpleSearch,xt=Lt.length,It=rt.length;let kt=-xt;for(;(kt=rt.indexOf(Lt,kt+xt))!==-1;)if((!yt||isValidMatch(yt,rt,It,kt,xt))&&(mt[pt++]=new FindMatch(new Range$2(ut,kt+1+gt,ut,kt+1+xt+gt),null),pt>=St))return pt;return pt}let wt;ot.reset(0);do if(wt=ot.next(rt),wt&&(mt[pt++]=createFindMatch(new Range$2(ut,wt.index+1+gt,ut,wt.index+1+wt[0].length+gt),wt,vt),pt>=St))return pt;while(wt);return pt}insert(nt,ot,rt=!1){if(this._EOLNormalized=this._EOLNormalized&&rt,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==SENTINEL){const{node:ut,remainder:gt,nodeStartOffset:pt}=this.nodeAt(nt),mt=ut.piece,vt=mt.bufferIndex,St=this.positionInBuffer(ut,gt);if(ut.piece.bufferIndex===0&&mt.end.line===this._lastChangeBufferPos.line&&mt.end.column===this._lastChangeBufferPos.column&&pt+mt.length===nt&&ot.length<AverageBufferSize){this.appendToNode(ut,ot),this.computeBufferMetadata();return}if(pt===nt)this.insertContentToNodeLeft(ot,ut),this._searchCache.validate(nt);else if(pt+ut.piece.length>nt){const yt=[];let wt=new Piece(mt.bufferIndex,St,mt.end,this.getLineFeedCnt(mt.bufferIndex,St,mt.end),this.offsetInBuffer(vt,mt.end)-this.offsetInBuffer(vt,St));if(this.shouldCheckCRLF()&&this.endWithCR(ot)&&this.nodeCharCodeAt(ut,gt)===10){const kt={line:wt.start.line+1,column:0};wt=new Piece(wt.bufferIndex,kt,wt.end,this.getLineFeedCnt(wt.bufferIndex,kt,wt.end),wt.length-1),ot+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(ot))if(this.nodeCharCodeAt(ut,gt-1)===13){const kt=this.positionInBuffer(ut,gt-1);this.deleteNodeTail(ut,kt),ot="\r"+ot,ut.piece.length===0&&yt.push(ut)}else this.deleteNodeTail(ut,St);else this.deleteNodeTail(ut,St);const Lt=this.createNewPieces(ot);wt.length>0&&this.rbInsertRight(ut,wt);let xt=ut;for(let It=0;It<Lt.length;It++)xt=this.rbInsertRight(xt,Lt[It]);this.deleteNodes(yt)}else this.insertContentToNodeRight(ot,ut)}else{const ut=this.createNewPieces(ot);let gt=this.rbInsertLeft(null,ut[0]);for(let pt=1;pt<ut.length;pt++)gt=this.rbInsertRight(gt,ut[pt])}this.computeBufferMetadata()}delete(nt,ot){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",ot<=0||this.root===SENTINEL)return;const rt=this.nodeAt(nt),ut=this.nodeAt(nt+ot),gt=rt.node,pt=ut.node;if(gt===pt){const Lt=this.positionInBuffer(gt,rt.remainder),xt=this.positionInBuffer(gt,ut.remainder);if(rt.nodeStartOffset===nt){if(ot===gt.piece.length){const It=gt.next();rbDelete(this,gt),this.validateCRLFWithPrevNode(It),this.computeBufferMetadata();return}this.deleteNodeHead(gt,xt),this._searchCache.validate(nt),this.validateCRLFWithPrevNode(gt),this.computeBufferMetadata();return}if(rt.nodeStartOffset+gt.piece.length===nt+ot){this.deleteNodeTail(gt,Lt),this.validateCRLFWithNextNode(gt),this.computeBufferMetadata();return}this.shrinkNode(gt,Lt,xt),this.computeBufferMetadata();return}const mt=[],vt=this.positionInBuffer(gt,rt.remainder);this.deleteNodeTail(gt,vt),this._searchCache.validate(nt),gt.piece.length===0&&mt.push(gt);const St=this.positionInBuffer(pt,ut.remainder);this.deleteNodeHead(pt,St),pt.piece.length===0&&mt.push(pt);const yt=gt.next();for(let Lt=yt;Lt!==SENTINEL&&Lt!==pt;Lt=Lt.next())mt.push(Lt);const wt=gt.piece.length===0?gt.prev():gt;this.deleteNodes(mt),this.validateCRLFWithNextNode(wt),this.computeBufferMetadata()}insertContentToNodeLeft(nt,ot){const rt=[];if(this.shouldCheckCRLF()&&this.endWithCR(nt)&&this.startWithLF(ot)){const pt=ot.piece,mt={line:pt.start.line+1,column:0},vt=new Piece(pt.bufferIndex,mt,pt.end,this.getLineFeedCnt(pt.bufferIndex,mt,pt.end),pt.length-1);ot.piece=vt,nt+=`
`,updateTreeMetadata(this,ot,-1,-1),ot.piece.length===0&&rt.push(ot)}const ut=this.createNewPieces(nt);let gt=this.rbInsertLeft(ot,ut[ut.length-1]);for(let pt=ut.length-2;pt>=0;pt--)gt=this.rbInsertLeft(gt,ut[pt]);this.validateCRLFWithPrevNode(gt),this.deleteNodes(rt)}insertContentToNodeRight(nt,ot){this.adjustCarriageReturnFromNext(nt,ot)&&(nt+=`
`);const rt=this.createNewPieces(nt),ut=this.rbInsertRight(ot,rt[0]);let gt=ut;for(let pt=1;pt<rt.length;pt++)gt=this.rbInsertRight(gt,rt[pt]);this.validateCRLFWithPrevNode(ut)}positionInBuffer(nt,ot,rt){const ut=nt.piece,gt=nt.piece.bufferIndex,pt=this._buffers[gt].lineStarts,vt=pt[ut.start.line]+ut.start.column+ot;let St=ut.start.line,yt=ut.end.line,wt=0,Lt=0,xt=0;for(;St<=yt&&(wt=St+(yt-St)/2|0,xt=pt[wt],wt!==yt);)if(Lt=pt[wt+1],vt<xt)yt=wt-1;else if(vt>=Lt)St=wt+1;else break;return rt?(rt.line=wt,rt.column=vt-xt,null):{line:wt,column:vt-xt}}getLineFeedCnt(nt,ot,rt){if(rt.column===0)return rt.line-ot.line;const ut=this._buffers[nt].lineStarts;if(rt.line===ut.length-1)return rt.line-ot.line;const gt=ut[rt.line+1],pt=ut[rt.line]+rt.column;if(gt>pt+1)return rt.line-ot.line;const mt=pt-1;return this._buffers[nt].buffer.charCodeAt(mt)===13?rt.line-ot.line+1:rt.line-ot.line}offsetInBuffer(nt,ot){return this._buffers[nt].lineStarts[ot.line]+ot.column}deleteNodes(nt){for(let ot=0;ot<nt.length;ot++)rbDelete(this,nt[ot])}createNewPieces(nt){if(nt.length>AverageBufferSize){const yt=[];for(;nt.length>AverageBufferSize;){const Lt=nt.charCodeAt(AverageBufferSize-1);let xt;Lt===13||Lt>=55296&&Lt<=56319?(xt=nt.substring(0,AverageBufferSize-1),nt=nt.substring(AverageBufferSize-1)):(xt=nt.substring(0,AverageBufferSize),nt=nt.substring(AverageBufferSize));const It=createLineStartsFast(xt);yt.push(new Piece(this._buffers.length,{line:0,column:0},{line:It.length-1,column:xt.length-It[It.length-1]},It.length-1,xt.length)),this._buffers.push(new StringBuffer(xt,It))}const wt=createLineStartsFast(nt);return yt.push(new Piece(this._buffers.length,{line:0,column:0},{line:wt.length-1,column:nt.length-wt[wt.length-1]},wt.length-1,nt.length)),this._buffers.push(new StringBuffer(nt,wt)),yt}let ot=this._buffers[0].buffer.length;const rt=createLineStartsFast(nt,!1);let ut=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===ot&&ot!==0&&this.startWithLF(nt)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},ut=this._lastChangeBufferPos;for(let yt=0;yt<rt.length;yt++)rt[yt]+=ot+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(rt.slice(1)),this._buffers[0].buffer+="_"+nt,ot+=1}else{if(ot!==0)for(let yt=0;yt<rt.length;yt++)rt[yt]+=ot;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(rt.slice(1)),this._buffers[0].buffer+=nt}const gt=this._buffers[0].buffer.length,pt=this._buffers[0].lineStarts.length-1,mt=gt-this._buffers[0].lineStarts[pt],vt={line:pt,column:mt},St=new Piece(0,ut,vt,this.getLineFeedCnt(0,ut,vt),gt-ot);return this._lastChangeBufferPos=vt,[St]}getLineRawContent(nt,ot=0){let rt=this.root,ut="";const gt=this._searchCache.get2(nt);if(gt){rt=gt.node;const pt=this.getAccumulatedValue(rt,nt-gt.nodeStartLineNumber-1),mt=this._buffers[rt.piece.bufferIndex].buffer,vt=this.offsetInBuffer(rt.piece.bufferIndex,rt.piece.start);if(gt.nodeStartLineNumber+rt.piece.lineFeedCnt===nt)ut=mt.substring(vt+pt,vt+rt.piece.length);else{const St=this.getAccumulatedValue(rt,nt-gt.nodeStartLineNumber);return mt.substring(vt+pt,vt+St-ot)}}else{let pt=0;const mt=nt;for(;rt!==SENTINEL;)if(rt.left!==SENTINEL&&rt.lf_left>=nt-1)rt=rt.left;else if(rt.lf_left+rt.piece.lineFeedCnt>nt-1){const vt=this.getAccumulatedValue(rt,nt-rt.lf_left-2),St=this.getAccumulatedValue(rt,nt-rt.lf_left-1),yt=this._buffers[rt.piece.bufferIndex].buffer,wt=this.offsetInBuffer(rt.piece.bufferIndex,rt.piece.start);return pt+=rt.size_left,this._searchCache.set({node:rt,nodeStartOffset:pt,nodeStartLineNumber:mt-(nt-1-rt.lf_left)}),yt.substring(wt+vt,wt+St-ot)}else if(rt.lf_left+rt.piece.lineFeedCnt===nt-1){const vt=this.getAccumulatedValue(rt,nt-rt.lf_left-2),St=this._buffers[rt.piece.bufferIndex].buffer,yt=this.offsetInBuffer(rt.piece.bufferIndex,rt.piece.start);ut=St.substring(yt+vt,yt+rt.piece.length);break}else nt-=rt.lf_left+rt.piece.lineFeedCnt,pt+=rt.size_left+rt.piece.length,rt=rt.right}for(rt=rt.next();rt!==SENTINEL;){const pt=this._buffers[rt.piece.bufferIndex].buffer;if(rt.piece.lineFeedCnt>0){const mt=this.getAccumulatedValue(rt,0),vt=this.offsetInBuffer(rt.piece.bufferIndex,rt.piece.start);return ut+=pt.substring(vt,vt+mt-ot),ut}else{const mt=this.offsetInBuffer(rt.piece.bufferIndex,rt.piece.start);ut+=pt.substr(mt,rt.piece.length)}rt=rt.next()}return ut}computeBufferMetadata(){let nt=this.root,ot=1,rt=0;for(;nt!==SENTINEL;)ot+=nt.lf_left+nt.piece.lineFeedCnt,rt+=nt.size_left+nt.piece.length,nt=nt.right;this._lineCnt=ot,this._length=rt,this._searchCache.validate(this._length)}getIndexOf(nt,ot){const rt=nt.piece,ut=this.positionInBuffer(nt,ot),gt=ut.line-rt.start.line;if(this.offsetInBuffer(rt.bufferIndex,rt.end)-this.offsetInBuffer(rt.bufferIndex,rt.start)===ot){const pt=this.getLineFeedCnt(nt.piece.bufferIndex,rt.start,ut);if(pt!==gt)return{index:pt,remainder:0}}return{index:gt,remainder:ut.column}}getAccumulatedValue(nt,ot){if(ot<0)return 0;const rt=nt.piece,ut=this._buffers[rt.bufferIndex].lineStarts,gt=rt.start.line+ot+1;return gt>rt.end.line?ut[rt.end.line]+rt.end.column-ut[rt.start.line]-rt.start.column:ut[gt]-ut[rt.start.line]-rt.start.column}deleteNodeTail(nt,ot){const rt=nt.piece,ut=rt.lineFeedCnt,gt=this.offsetInBuffer(rt.bufferIndex,rt.end),pt=ot,mt=this.offsetInBuffer(rt.bufferIndex,pt),vt=this.getLineFeedCnt(rt.bufferIndex,rt.start,pt),St=vt-ut,yt=mt-gt,wt=rt.length+yt;nt.piece=new Piece(rt.bufferIndex,rt.start,pt,vt,wt),updateTreeMetadata(this,nt,yt,St)}deleteNodeHead(nt,ot){const rt=nt.piece,ut=rt.lineFeedCnt,gt=this.offsetInBuffer(rt.bufferIndex,rt.start),pt=ot,mt=this.getLineFeedCnt(rt.bufferIndex,pt,rt.end),vt=this.offsetInBuffer(rt.bufferIndex,pt),St=mt-ut,yt=gt-vt,wt=rt.length+yt;nt.piece=new Piece(rt.bufferIndex,pt,rt.end,mt,wt),updateTreeMetadata(this,nt,yt,St)}shrinkNode(nt,ot,rt){const ut=nt.piece,gt=ut.start,pt=ut.end,mt=ut.length,vt=ut.lineFeedCnt,St=ot,yt=this.getLineFeedCnt(ut.bufferIndex,ut.start,St),wt=this.offsetInBuffer(ut.bufferIndex,ot)-this.offsetInBuffer(ut.bufferIndex,gt);nt.piece=new Piece(ut.bufferIndex,ut.start,St,yt,wt),updateTreeMetadata(this,nt,wt-mt,yt-vt);const Lt=new Piece(ut.bufferIndex,rt,pt,this.getLineFeedCnt(ut.bufferIndex,rt,pt),this.offsetInBuffer(ut.bufferIndex,pt)-this.offsetInBuffer(ut.bufferIndex,rt)),xt=this.rbInsertRight(nt,Lt);this.validateCRLFWithPrevNode(xt)}appendToNode(nt,ot){this.adjustCarriageReturnFromNext(ot,nt)&&(ot+=`
`);const rt=this.shouldCheckCRLF()&&this.startWithLF(ot)&&this.endWithCR(nt),ut=this._buffers[0].buffer.length;this._buffers[0].buffer+=ot;const gt=createLineStartsFast(ot,!1);for(let xt=0;xt<gt.length;xt++)gt[xt]+=ut;if(rt){const xt=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:ut-xt}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(gt.slice(1));const pt=this._buffers[0].lineStarts.length-1,mt=this._buffers[0].buffer.length-this._buffers[0].lineStarts[pt],vt={line:pt,column:mt},St=nt.piece.length+ot.length,yt=nt.piece.lineFeedCnt,wt=this.getLineFeedCnt(0,nt.piece.start,vt),Lt=wt-yt;nt.piece=new Piece(nt.piece.bufferIndex,nt.piece.start,vt,wt,St),this._lastChangeBufferPos=vt,updateTreeMetadata(this,nt,ot.length,Lt)}nodeAt(nt){let ot=this.root;const rt=this._searchCache.get(nt);if(rt)return{node:rt.node,nodeStartOffset:rt.nodeStartOffset,remainder:nt-rt.nodeStartOffset};let ut=0;for(;ot!==SENTINEL;)if(ot.size_left>nt)ot=ot.left;else if(ot.size_left+ot.piece.length>=nt){ut+=ot.size_left;const gt={node:ot,remainder:nt-ot.size_left,nodeStartOffset:ut};return this._searchCache.set(gt),gt}else nt-=ot.size_left+ot.piece.length,ut+=ot.size_left+ot.piece.length,ot=ot.right;return null}nodeAt2(nt,ot){let rt=this.root,ut=0;for(;rt!==SENTINEL;)if(rt.left!==SENTINEL&&rt.lf_left>=nt-1)rt=rt.left;else if(rt.lf_left+rt.piece.lineFeedCnt>nt-1){const gt=this.getAccumulatedValue(rt,nt-rt.lf_left-2),pt=this.getAccumulatedValue(rt,nt-rt.lf_left-1);return ut+=rt.size_left,{node:rt,remainder:Math.min(gt+ot-1,pt),nodeStartOffset:ut}}else if(rt.lf_left+rt.piece.lineFeedCnt===nt-1){const gt=this.getAccumulatedValue(rt,nt-rt.lf_left-2);if(gt+ot-1<=rt.piece.length)return{node:rt,remainder:gt+ot-1,nodeStartOffset:ut};ot-=rt.piece.length-gt;break}else nt-=rt.lf_left+rt.piece.lineFeedCnt,ut+=rt.size_left+rt.piece.length,rt=rt.right;for(rt=rt.next();rt!==SENTINEL;){if(rt.piece.lineFeedCnt>0){const gt=this.getAccumulatedValue(rt,0),pt=this.offsetOfNode(rt);return{node:rt,remainder:Math.min(ot-1,gt),nodeStartOffset:pt}}else if(rt.piece.length>=ot-1){const gt=this.offsetOfNode(rt);return{node:rt,remainder:ot-1,nodeStartOffset:gt}}else ot-=rt.piece.length;rt=rt.next()}return null}nodeCharCodeAt(nt,ot){if(nt.piece.lineFeedCnt<1)return-1;const rt=this._buffers[nt.piece.bufferIndex],ut=this.offsetInBuffer(nt.piece.bufferIndex,nt.piece.start)+ot;return rt.buffer.charCodeAt(ut)}offsetOfNode(nt){if(!nt)return 0;let ot=nt.size_left;for(;nt!==this.root;)nt.parent.right===nt&&(ot+=nt.parent.size_left+nt.parent.piece.length),nt=nt.parent;return ot}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(nt){if(typeof nt=="string")return nt.charCodeAt(0)===10;if(nt===SENTINEL||nt.piece.lineFeedCnt===0)return!1;const ot=nt.piece,rt=this._buffers[ot.bufferIndex].lineStarts,ut=ot.start.line,gt=rt[ut]+ot.start.column;return ut===rt.length-1||rt[ut+1]>gt+1?!1:this._buffers[ot.bufferIndex].buffer.charCodeAt(gt)===10}endWithCR(nt){return typeof nt=="string"?nt.charCodeAt(nt.length-1)===13:nt===SENTINEL||nt.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(nt,nt.piece.length-1)===13}validateCRLFWithPrevNode(nt){if(this.shouldCheckCRLF()&&this.startWithLF(nt)){const ot=nt.prev();this.endWithCR(ot)&&this.fixCRLF(ot,nt)}}validateCRLFWithNextNode(nt){if(this.shouldCheckCRLF()&&this.endWithCR(nt)){const ot=nt.next();this.startWithLF(ot)&&this.fixCRLF(nt,ot)}}fixCRLF(nt,ot){const rt=[],ut=this._buffers[nt.piece.bufferIndex].lineStarts;let gt;nt.piece.end.column===0?gt={line:nt.piece.end.line-1,column:ut[nt.piece.end.line]-ut[nt.piece.end.line-1]-1}:gt={line:nt.piece.end.line,column:nt.piece.end.column-1};const pt=nt.piece.length-1,mt=nt.piece.lineFeedCnt-1;nt.piece=new Piece(nt.piece.bufferIndex,nt.piece.start,gt,mt,pt),updateTreeMetadata(this,nt,-1,-1),nt.piece.length===0&&rt.push(nt);const vt={line:ot.piece.start.line+1,column:0},St=ot.piece.length-1,yt=this.getLineFeedCnt(ot.piece.bufferIndex,vt,ot.piece.end);ot.piece=new Piece(ot.piece.bufferIndex,vt,ot.piece.end,yt,St),updateTreeMetadata(this,ot,-1,-1),ot.piece.length===0&&rt.push(ot);const wt=this.createNewPieces(`\r
`);this.rbInsertRight(nt,wt[0]);for(let Lt=0;Lt<rt.length;Lt++)rbDelete(this,rt[Lt])}adjustCarriageReturnFromNext(nt,ot){if(this.shouldCheckCRLF()&&this.endWithCR(nt)){const rt=ot.next();if(this.startWithLF(rt)){if(nt+=`
`,rt.piece.length===1)rbDelete(this,rt);else{const ut=rt.piece,gt={line:ut.start.line+1,column:0},pt=ut.length-1,mt=this.getLineFeedCnt(ut.bufferIndex,gt,ut.end);rt.piece=new Piece(ut.bufferIndex,gt,ut.end,mt,pt),updateTreeMetadata(this,rt,-1,-1)}return!0}}return!1}iterate(nt,ot){if(nt===SENTINEL)return ot(SENTINEL);const rt=this.iterate(nt.left,ot);return rt&&ot(nt)&&this.iterate(nt.right,ot)}getNodeContent(nt){if(nt===SENTINEL)return"";const ot=this._buffers[nt.piece.bufferIndex],rt=nt.piece,ut=this.offsetInBuffer(rt.bufferIndex,rt.start),gt=this.offsetInBuffer(rt.bufferIndex,rt.end);return ot.buffer.substring(ut,gt)}getPieceContent(nt){const ot=this._buffers[nt.bufferIndex],rt=this.offsetInBuffer(nt.bufferIndex,nt.start),ut=this.offsetInBuffer(nt.bufferIndex,nt.end);return ot.buffer.substring(rt,ut)}rbInsertRight(nt,ot){const rt=new TreeNode(ot,1);if(rt.left=SENTINEL,rt.right=SENTINEL,rt.parent=SENTINEL,rt.size_left=0,rt.lf_left=0,this.root===SENTINEL)this.root=rt,rt.color=0;else if(nt.right===SENTINEL)nt.right=rt,rt.parent=nt;else{const gt=leftest(nt.right);gt.left=rt,rt.parent=gt}return fixInsert(this,rt),rt}rbInsertLeft(nt,ot){const rt=new TreeNode(ot,1);if(rt.left=SENTINEL,rt.right=SENTINEL,rt.parent=SENTINEL,rt.size_left=0,rt.lf_left=0,this.root===SENTINEL)this.root=rt,rt.color=0;else if(nt.left===SENTINEL)nt.left=rt,rt.parent=nt;else{const ut=righttest(nt.left);ut.right=rt,rt.parent=ut}return fixInsert(this,rt),rt}}class PieceTreeTextBuffer extends Disposable{constructor(nt,ot,rt,ut,gt,pt,mt){super(),this._onDidChangeContent=this._register(new Emitter$2),this._BOM=ot,this._mightContainNonBasicASCII=!pt,this._mightContainRTL=ut,this._mightContainUnusualLineTerminators=gt,this._pieceTree=new PieceTreeBase(nt,rt,mt)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(nt){return this._pieceTree.createSnapshot(nt?this._BOM:"")}getOffsetAt(nt,ot){return this._pieceTree.getOffsetAt(nt,ot)}getPositionAt(nt){return this._pieceTree.getPositionAt(nt)}getRangeAt(nt,ot){const rt=nt+ot,ut=this.getPositionAt(nt),gt=this.getPositionAt(rt);return new Range$2(ut.lineNumber,ut.column,gt.lineNumber,gt.column)}getValueInRange(nt,ot=0){if(nt.isEmpty())return"";const rt=this._getEndOfLine(ot);return this._pieceTree.getValueInRange(nt,rt)}getValueLengthInRange(nt,ot=0){if(nt.isEmpty())return 0;if(nt.startLineNumber===nt.endLineNumber)return nt.endColumn-nt.startColumn;const rt=this.getOffsetAt(nt.startLineNumber,nt.startColumn),ut=this.getOffsetAt(nt.endLineNumber,nt.endColumn);let gt=0;const pt=this._getEndOfLine(ot),mt=this.getEOL();if(pt.length!==mt.length){const vt=pt.length-mt.length,St=nt.endLineNumber-nt.startLineNumber;gt=vt*St}return ut-rt+gt}getCharacterCountInRange(nt,ot=0){if(this._mightContainNonBasicASCII){let rt=0;const ut=nt.startLineNumber,gt=nt.endLineNumber;for(let pt=ut;pt<=gt;pt++){const mt=this.getLineContent(pt),vt=pt===ut?nt.startColumn-1:0,St=pt===gt?nt.endColumn-1:mt.length;for(let yt=vt;yt<St;yt++)isHighSurrogate(mt.charCodeAt(yt))?(rt=rt+1,yt=yt+1):rt=rt+1}return rt+=this._getEndOfLine(ot).length*(gt-ut),rt}return this.getValueLengthInRange(nt,ot)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(nt){return this._pieceTree.getLineContent(nt)}getLineCharCode(nt,ot){return this._pieceTree.getLineCharCode(nt,ot)}getLineLength(nt){return this._pieceTree.getLineLength(nt)}getLineFirstNonWhitespaceColumn(nt){const ot=firstNonWhitespaceIndex(this.getLineContent(nt));return ot===-1?0:ot+1}getLineLastNonWhitespaceColumn(nt){const ot=lastNonWhitespaceIndex(this.getLineContent(nt));return ot===-1?0:ot+2}_getEndOfLine(nt){switch(nt){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(nt){this._pieceTree.setEOL(nt)}applyEdits(nt,ot,rt){let ut=this._mightContainRTL,gt=this._mightContainUnusualLineTerminators,pt=this._mightContainNonBasicASCII,mt=!0,vt=[];for(let kt=0;kt<nt.length;kt++){const At=nt[kt];mt&&At._isTracked&&(mt=!1);const Tt=At.range;if(At.text){let Kt=!0;pt||(Kt=!isBasicASCII(At.text),pt=Kt),!ut&&Kt&&(ut=containsRTL(At.text)),!gt&&Kt&&(gt=containsUnusualLineTerminators(At.text))}let Rt="",Nt=0,Pt=0,Ft=0;if(At.text){let Kt;[Nt,Pt,Ft,Kt]=countEOL(At.text);const Bt=this.getEOL();Kt===0||Kt===(Bt===`\r
`?2:1)?Rt=At.text:Rt=At.text.replace(/\r\n|\r|\n/g,Bt)}vt[kt]={sortIndex:kt,identifier:At.identifier||null,range:Tt,rangeOffset:this.getOffsetAt(Tt.startLineNumber,Tt.startColumn),rangeLength:this.getValueLengthInRange(Tt),text:Rt,eolCount:Nt,firstLineLength:Pt,lastLineLength:Ft,forceMoveMarkers:!!At.forceMoveMarkers,isAutoWhitespaceEdit:At.isAutoWhitespaceEdit||!1}}vt.sort(PieceTreeTextBuffer._sortOpsAscending);let St=!1;for(let kt=0,At=vt.length-1;kt<At;kt++){const Tt=vt[kt].range.getEndPosition(),Rt=vt[kt+1].range.getStartPosition();if(Rt.isBeforeOrEqual(Tt)){if(Rt.isBefore(Tt))throw new Error("Overlapping ranges are not allowed!");St=!0}}mt&&(vt=this._reduceOperations(vt));const yt=rt||ot?PieceTreeTextBuffer._getInverseEditRanges(vt):[],wt=[];if(ot)for(let kt=0;kt<vt.length;kt++){const At=vt[kt],Tt=yt[kt];if(At.isAutoWhitespaceEdit&&At.range.isEmpty())for(let Rt=Tt.startLineNumber;Rt<=Tt.endLineNumber;Rt++){let Nt="";Rt===Tt.startLineNumber&&(Nt=this.getLineContent(At.range.startLineNumber),firstNonWhitespaceIndex(Nt)!==-1)||wt.push({lineNumber:Rt,oldContent:Nt})}}let Lt=null;if(rt){let kt=0;Lt=[];for(let At=0;At<vt.length;At++){const Tt=vt[At],Rt=yt[At],Nt=this.getValueInRange(Tt.range),Pt=Tt.rangeOffset+kt;kt+=Tt.text.length-Nt.length,Lt[At]={sortIndex:Tt.sortIndex,identifier:Tt.identifier,range:Rt,text:Nt,textChange:new TextChange(Tt.rangeOffset,Nt,Pt,Tt.text)}}St||Lt.sort((At,Tt)=>At.sortIndex-Tt.sortIndex)}this._mightContainRTL=ut,this._mightContainUnusualLineTerminators=gt,this._mightContainNonBasicASCII=pt;const xt=this._doApplyEdits(vt);let It=null;if(ot&&wt.length>0){wt.sort((kt,At)=>At.lineNumber-kt.lineNumber),It=[];for(let kt=0,At=wt.length;kt<At;kt++){const Tt=wt[kt].lineNumber;if(kt>0&&wt[kt-1].lineNumber===Tt)continue;const Rt=wt[kt].oldContent,Nt=this.getLineContent(Tt);Nt.length===0||Nt===Rt||firstNonWhitespaceIndex(Nt)!==-1||It.push(Tt)}}return this._onDidChangeContent.fire(),new ApplyEditsResult(Lt,xt,It)}_reduceOperations(nt){return nt.length<1e3?nt:[this._toSingleEditOperation(nt)]}_toSingleEditOperation(nt){let ot=!1;const rt=nt[0].range,ut=nt[nt.length-1].range,gt=new Range$2(rt.startLineNumber,rt.startColumn,ut.endLineNumber,ut.endColumn);let pt=rt.startLineNumber,mt=rt.startColumn;const vt=[];for(let xt=0,It=nt.length;xt<It;xt++){const kt=nt[xt],At=kt.range;ot=ot||kt.forceMoveMarkers,vt.push(this.getValueInRange(new Range$2(pt,mt,At.startLineNumber,At.startColumn))),kt.text.length>0&&vt.push(kt.text),pt=At.endLineNumber,mt=At.endColumn}const St=vt.join(""),[yt,wt,Lt]=countEOL(St);return{sortIndex:0,identifier:nt[0].identifier,range:gt,rangeOffset:this.getOffsetAt(gt.startLineNumber,gt.startColumn),rangeLength:this.getValueLengthInRange(gt,0),text:St,eolCount:yt,firstLineLength:wt,lastLineLength:Lt,forceMoveMarkers:ot,isAutoWhitespaceEdit:!1}}_doApplyEdits(nt){nt.sort(PieceTreeTextBuffer._sortOpsDescending);const ot=[];for(let rt=0;rt<nt.length;rt++){const ut=nt[rt],gt=ut.range.startLineNumber,pt=ut.range.startColumn,mt=ut.range.endLineNumber,vt=ut.range.endColumn;if(gt===mt&&pt===vt&&ut.text.length===0)continue;ut.text?(this._pieceTree.delete(ut.rangeOffset,ut.rangeLength),this._pieceTree.insert(ut.rangeOffset,ut.text,!0)):this._pieceTree.delete(ut.rangeOffset,ut.rangeLength);const St=new Range$2(gt,pt,mt,vt);ot.push({range:St,rangeLength:ut.rangeLength,text:ut.text,rangeOffset:ut.rangeOffset,forceMoveMarkers:ut.forceMoveMarkers})}return ot}findMatchesLineByLine(nt,ot,rt,ut){return this._pieceTree.findMatchesLineByLine(nt,ot,rt,ut)}static _getInverseEditRanges(nt){const ot=[];let rt=0,ut=0,gt=null;for(let pt=0,mt=nt.length;pt<mt;pt++){const vt=nt[pt];let St,yt;gt?gt.range.endLineNumber===vt.range.startLineNumber?(St=rt,yt=ut+(vt.range.startColumn-gt.range.endColumn)):(St=rt+(vt.range.startLineNumber-gt.range.endLineNumber),yt=vt.range.startColumn):(St=vt.range.startLineNumber,yt=vt.range.startColumn);let wt;if(vt.text.length>0){const Lt=vt.eolCount+1;Lt===1?wt=new Range$2(St,yt,St,yt+vt.firstLineLength):wt=new Range$2(St,yt,St+Lt-1,vt.lastLineLength+1)}else wt=new Range$2(St,yt,St,yt);rt=wt.endLineNumber,ut=wt.endColumn,ot.push(wt),gt=vt}return ot}static _sortOpsAscending(nt,ot){const rt=Range$2.compareRangesUsingEnds(nt.range,ot.range);return rt===0?nt.sortIndex-ot.sortIndex:rt}static _sortOpsDescending(nt,ot){const rt=Range$2.compareRangesUsingEnds(nt.range,ot.range);return rt===0?ot.sortIndex-nt.sortIndex:-rt}}class PieceTreeTextBufferFactory{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St){this._chunks=nt,this._bom=ot,this._cr=rt,this._lf=ut,this._crlf=gt,this._containsRTL=pt,this._containsUnusualLineTerminators=mt,this._isBasicASCII=vt,this._normalizeEOL=St}_getEOL(nt){const ot=this._cr+this._lf+this._crlf,rt=this._cr+this._crlf;return ot===0?nt===1?`
`:`\r
`:rt>ot/2?`\r
`:`
`}create(nt){const ot=this._getEOL(nt),rt=this._chunks;if(this._normalizeEOL&&(ot===`\r
`&&(this._cr>0||this._lf>0)||ot===`
`&&(this._cr>0||this._crlf>0)))for(let gt=0,pt=rt.length;gt<pt;gt++){const mt=rt[gt].buffer.replace(/\r\n|\r|\n/g,ot),vt=createLineStartsFast(mt);rt[gt]=new StringBuffer(mt,vt)}const ut=new PieceTreeTextBuffer(rt,this._bom,ot,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:ut,disposable:ut}}}class PieceTreeTextBufferBuilder{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(nt){if(nt.length===0)return;this.chunks.length===0&&startsWithUTF8BOM(nt)&&(this.BOM=UTF8_BOM_CHARACTER,nt=nt.substr(1));const ot=nt.charCodeAt(nt.length-1);ot===13||ot>=55296&&ot<=56319?(this._acceptChunk1(nt.substr(0,nt.length-1),!1),this._hasPreviousChar=!0,this._previousChar=ot):(this._acceptChunk1(nt,!1),this._hasPreviousChar=!1,this._previousChar=ot)}_acceptChunk1(nt,ot){!ot&&nt.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+nt):this._acceptChunk2(nt))}_acceptChunk2(nt){const ot=createLineStarts(this._tmpLineStarts,nt);this.chunks.push(new StringBuffer(nt,ot.lineStarts)),this.cr+=ot.cr,this.lf+=ot.lf,this.crlf+=ot.crlf,ot.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=containsRTL(nt)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=containsUnusualLineTerminators(nt)))}finish(nt=!0){return this._finish(),new PieceTreeTextBufferFactory(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,nt)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const nt=this.chunks[this.chunks.length-1];nt.buffer+=String.fromCharCode(this._previousChar);const ot=createLineStartsFast(nt.buffer);nt.lineStarts=ot,this._previousChar===13&&this.cr++}}}class FixedArray{constructor(nt){this._default=nt,this._store=[]}get(nt){return nt<this._store.length?this._store[nt]:this._default}set(nt,ot){for(;nt>=this._store.length;)this._store[this._store.length]=this._default;this._store[nt]=ot}replace(nt,ot,rt){if(nt>=this._store.length)return;if(ot===0){this.insert(nt,rt);return}else if(rt===0){this.delete(nt,ot);return}const ut=this._store.slice(0,nt),gt=this._store.slice(nt+ot),pt=arrayFill(rt,this._default);this._store=ut.concat(pt,gt)}delete(nt,ot){ot===0||nt>=this._store.length||this._store.splice(nt,ot)}insert(nt,ot){if(ot===0||nt>=this._store.length)return;const rt=[];for(let ut=0;ut<ot;ut++)rt[ut]=this._default;this._store=arrayInsert(this._store,nt,rt)}}function arrayFill(ct,nt){const ot=[];for(let rt=0;rt<ct;rt++)ot[rt]=nt;return ot}class ContiguousMultilineTokens{get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(nt,ot){this._startLineNumber=nt,this._tokens=ot}getLineTokens(nt){return this._tokens[nt-this._startLineNumber]}appendLineTokens(nt){this._tokens.push(nt)}}class ContiguousMultilineTokensBuilder{constructor(){this._tokens=[]}add(nt,ot){if(this._tokens.length>0){const rt=this._tokens[this._tokens.length-1];if(rt.endLineNumber+1===nt){rt.appendLineTokens(ot);return}}this._tokens.push(new ContiguousMultilineTokens(nt,[ot]))}finalize(){return this._tokens}}class TokenizerWithStateStore{constructor(nt,ot){this.tokenizationSupport=ot,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new TrackingTokenizationStateStore(nt)}getStartState(nt){return nt===1?this.initialState:this.store.getEndState(nt-1)}}class TokenizerWithStateStoreAndTextModel extends TokenizerWithStateStore{constructor(nt,ot,rt,ut){super(nt,ot),this._textModel=rt,this._languageIdCodec=ut}updateTokensUntilLine(nt,ot){const rt=this._textModel.getLanguageId();for(;;){const ut=this.store.getFirstInvalidEndStateLineNumber();if(!ut||ut>ot)break;const gt=this._textModel.getLineContent(ut),pt=this.getStartState(ut),mt=safeTokenize(this._languageIdCodec,rt,this.tokenizationSupport,gt,!0,pt);nt.add(ut,mt.tokens),this.store.setEndState(ut,mt.endState)}}getTokenTypeIfInsertingCharacter(nt,ot){const rt=this.getStartState(nt.lineNumber);if(!rt)return 0;const ut=this._textModel.getLanguageId(),gt=this._textModel.getLineContent(nt.lineNumber),pt=gt.substring(0,nt.column-1)+ot+gt.substring(nt.column-1),mt=safeTokenize(this._languageIdCodec,ut,this.tokenizationSupport,pt,!0,rt),vt=new LineTokens(mt.tokens,pt,this._languageIdCodec);if(vt.getCount()===0)return 0;const St=vt.findTokenIndexAtOffset(nt.column-1);return vt.getStandardTokenType(St)}tokenizeLineWithEdit(nt,ot,rt){const ut=nt.lineNumber,gt=nt.column,pt=this.getStartState(ut);if(!pt)return null;const mt=this._textModel.getLineContent(ut),vt=mt.substring(0,gt-1)+rt+mt.substring(gt-1+ot),St=this._textModel.getLanguageIdAtPosition(ut,0),yt=safeTokenize(this._languageIdCodec,St,this.tokenizationSupport,vt,!0,pt);return new LineTokens(yt.tokens,vt,this._languageIdCodec)}isCheapToTokenize(nt){const ot=this.store.getFirstInvalidEndStateLineNumberOrMax();return nt<ot||nt===ot&&this._textModel.getLineLength(nt)<2048}tokenizeHeuristically(nt,ot,rt){if(rt<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(ot<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(nt,rt),{heuristicTokens:!1};let ut=this.guessStartState(ot);const gt=this._textModel.getLanguageId();for(let pt=ot;pt<=rt;pt++){const mt=this._textModel.getLineContent(pt),vt=safeTokenize(this._languageIdCodec,gt,this.tokenizationSupport,mt,!0,ut);nt.add(pt,vt.tokens),ut=vt.endState}return{heuristicTokens:!0}}guessStartState(nt){let ot=this._textModel.getLineFirstNonWhitespaceColumn(nt);const rt=[];let ut=null;for(let mt=nt-1;ot>1&&mt>=1;mt--){const vt=this._textModel.getLineFirstNonWhitespaceColumn(mt);if(vt!==0&&vt<ot&&(rt.push(this._textModel.getLineContent(mt)),ot=vt,ut=this.getStartState(mt),ut))break}ut||(ut=this.tokenizationSupport.getInitialState()),rt.reverse();const gt=this._textModel.getLanguageId();let pt=ut;for(const mt of rt)pt=safeTokenize(this._languageIdCodec,gt,this.tokenizationSupport,mt,!1,pt).endState;return pt}}class TrackingTokenizationStateStore{constructor(nt){this.lineCount=nt,this.tokenizationStateStore=new TokenizationStateStore,this._invalidEndStatesLineNumbers=new RangePriorityQueueImpl,this._invalidEndStatesLineNumbers.addRange(new OffsetRange(1,nt+1))}getEndState(nt){return this.tokenizationStateStore.getEndState(nt)}setEndState(nt,ot){for(;;){const ut=this._invalidEndStatesLineNumbers.min;if(ut!==null&&ut<=nt)this._invalidEndStatesLineNumbers.removeMin();else break}const rt=this.tokenizationStateStore.setEndState(nt,ot);return rt&&nt<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new OffsetRange(nt+1,nt+2)),rt}acceptChange(nt,ot){this.lineCount+=ot-nt.length,this.tokenizationStateStore.acceptChange(nt,ot),this._invalidEndStatesLineNumbers.addRangeAndResize(new OffsetRange(nt.startLineNumber,nt.endLineNumberExclusive),ot)}acceptChanges(nt){for(const ot of nt){const[rt]=countEOL(ot.text);this.acceptChange(new LineRange$1(ot.range.startLineNumber,ot.range.endLineNumber+1),rt+1)}}invalidateEndStateRange(nt){this._invalidEndStatesLineNumbers.addRange(new OffsetRange(nt.startLineNumber,nt.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this._invalidEndStatesLineNumbers.min||Number.MAX_SAFE_INTEGER}isTokenizationComplete(){return this._invalidEndStatesLineNumbers.min===null}}class TokenizationStateStore{constructor(){this._lineEndStates=new FixedArray(null)}getEndState(nt){return this._lineEndStates.get(nt)}setEndState(nt,ot){const rt=this._lineEndStates.get(nt);return rt&&rt.equals(ot)?!1:(this._lineEndStates.set(nt,ot),!0)}acceptChange(nt,ot){let rt=nt.length;ot>0&&rt>0&&(rt--,ot--),this._lineEndStates.replace(nt.startLineNumber,rt,ot)}}class RangePriorityQueueImpl{constructor(){this._ranges=[]}get min(){return this._ranges.length===0?null:this._ranges[0].start}removeMin(){if(this._ranges.length===0)return null;const nt=this._ranges[0];return nt.start+1===nt.endExclusive?this._ranges.shift():this._ranges[0]=new OffsetRange(nt.start+1,nt.endExclusive),nt.start}addRange(nt){OffsetRange.addRange(nt,this._ranges)}addRangeAndResize(nt,ot){let rt=0;for(;!(rt>=this._ranges.length||nt.start<=this._ranges[rt].endExclusive);)rt++;let ut=rt;for(;!(ut>=this._ranges.length||nt.endExclusive<this._ranges[ut].start);)ut++;const gt=ot-nt.length;for(let pt=ut;pt<this._ranges.length;pt++)this._ranges[pt]=this._ranges[pt].delta(gt);if(rt===ut){const pt=new OffsetRange(nt.start,nt.start+ot);pt.isEmpty||this._ranges.splice(rt,0,pt)}else{const pt=Math.min(nt.start,this._ranges[rt].start),mt=Math.max(nt.endExclusive,this._ranges[ut-1].endExclusive),vt=new OffsetRange(pt,mt+gt);vt.isEmpty?this._ranges.splice(rt,ut-rt):this._ranges.splice(rt,ut-rt,vt)}}toString(){return this._ranges.map(nt=>nt.toString()).join(" + ")}}function safeTokenize(ct,nt,ot,rt,ut,gt){let pt=null;if(ot)try{pt=ot.tokenizeEncoded(rt,ut,gt.clone())}catch(mt){onUnexpectedError(mt)}return pt||(pt=nullTokenizeEncoded(ct.encodeLanguageId(nt),gt)),LineTokens.convertToEndOffset(pt.tokens,rt.length),pt}class DefaultBackgroundTokenizer{constructor(nt,ot){this._tokenizerWithStateStore=nt,this._backgroundTokenStore=ot,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,runWhenIdle(nt=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(nt)}))}_backgroundTokenizeWithDeadline(nt){const ot=Date.now()+nt.timeRemaining(),rt=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<ot?setTimeout0(rt):this._beginBackgroundTokenization())};rt()}_backgroundTokenizeForAtLeast1ms(){const nt=this._tokenizerWithStateStore._textModel.getLineCount(),ot=new ContiguousMultilineTokensBuilder,rt=StopWatch.create(!1);do if(rt.elapsed()>1||this._tokenizeOneInvalidLine(ot)>=nt)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(ot.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.isTokenizationComplete():!1}_tokenizeOneInvalidLine(nt){if(!this._tokenizerWithStateStore||!this._hasLinesToTokenize())return this._tokenizerWithStateStore._textModel.getLineCount()+1;const ot=this._tokenizerWithStateStore.store.getFirstInvalidEndStateLineNumber();return this._tokenizerWithStateStore.updateTokensUntilLine(nt,ot),ot}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.isTokenizationComplete()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(nt,ot){this._tokenizerWithStateStore.store.invalidateEndStateRange(new LineRange$1(nt,ot))}}const EMPTY_LINE_TOKENS=new Uint32Array(0).buffer;class ContiguousTokensEditing{static deleteBeginning(nt,ot){return nt===null||nt===EMPTY_LINE_TOKENS?nt:ContiguousTokensEditing.delete(nt,0,ot)}static deleteEnding(nt,ot){if(nt===null||nt===EMPTY_LINE_TOKENS)return nt;const rt=toUint32Array(nt),ut=rt[rt.length-2];return ContiguousTokensEditing.delete(nt,ot,ut)}static delete(nt,ot,rt){if(nt===null||nt===EMPTY_LINE_TOKENS||ot===rt)return nt;const ut=toUint32Array(nt),gt=ut.length>>>1;if(ot===0&&ut[ut.length-2]===rt)return EMPTY_LINE_TOKENS;const pt=LineTokens.findIndexInTokensArray(ut,ot),mt=pt>0?ut[pt-1<<1]:0,vt=ut[pt<<1];if(rt<vt){const xt=rt-ot;for(let It=pt;It<gt;It++)ut[It<<1]-=xt;return nt}let St,yt;mt!==ot?(ut[pt<<1]=ot,St=pt+1<<1,yt=ot):(St=pt<<1,yt=mt);const wt=rt-ot;for(let xt=pt+1;xt<gt;xt++){const It=ut[xt<<1]-wt;It>yt&&(ut[St++]=It,ut[St++]=ut[(xt<<1)+1],yt=It)}if(St===ut.length)return nt;const Lt=new Uint32Array(St);return Lt.set(ut.subarray(0,St),0),Lt.buffer}static append(nt,ot){if(ot===EMPTY_LINE_TOKENS)return nt;if(nt===EMPTY_LINE_TOKENS)return ot;if(nt===null)return nt;if(ot===null)return null;const rt=toUint32Array(nt),ut=toUint32Array(ot),gt=ut.length>>>1,pt=new Uint32Array(rt.length+ut.length);pt.set(rt,0);let mt=rt.length;const vt=rt[rt.length-2];for(let St=0;St<gt;St++)pt[mt++]=ut[St<<1]+vt,pt[mt++]=ut[(St<<1)+1];return pt.buffer}static insert(nt,ot,rt){if(nt===null||nt===EMPTY_LINE_TOKENS)return nt;const ut=toUint32Array(nt),gt=ut.length>>>1;let pt=LineTokens.findIndexInTokensArray(ut,ot);pt>0&&ut[pt-1<<1]===ot&&pt--;for(let mt=pt;mt<gt;mt++)ut[mt<<1]+=rt;return nt}}function toUint32Array(ct){return ct instanceof Uint32Array?ct:new Uint32Array(ct)}class ContiguousTokensStore{constructor(nt){this._lineTokens=[],this._len=0,this._languageIdCodec=nt}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(nt,ot,rt){let ut=null;if(ot<this._len&&(ut=this._lineTokens[ot]),ut!==null&&ut!==EMPTY_LINE_TOKENS)return new LineTokens(toUint32Array(ut),rt,this._languageIdCodec);const gt=new Uint32Array(2);return gt[0]=rt.length,gt[1]=getDefaultMetadata(this._languageIdCodec.encodeLanguageId(nt)),new LineTokens(gt,rt,this._languageIdCodec)}static _massageTokens(nt,ot,rt){const ut=rt?toUint32Array(rt):null;if(ot===0){let gt=!1;if(ut&&ut.length>1&&(gt=TokenMetadata.getLanguageId(ut[1])!==nt),!gt)return EMPTY_LINE_TOKENS}if(!ut||ut.length===0){const gt=new Uint32Array(2);return gt[0]=ot,gt[1]=getDefaultMetadata(nt),gt.buffer}return ut[ut.length-2]=ot,ut.byteOffset===0&&ut.byteLength===ut.buffer.byteLength?ut.buffer:ut}_ensureLine(nt){for(;nt>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(nt,ot){ot!==0&&(nt+ot>this._len&&(ot=this._len-nt),this._lineTokens.splice(nt,ot),this._len-=ot)}_insertLines(nt,ot){if(ot===0)return;const rt=[];for(let ut=0;ut<ot;ut++)rt[ut]=null;this._lineTokens=arrayInsert(this._lineTokens,nt,rt),this._len+=ot}setTokens(nt,ot,rt,ut,gt){const pt=ContiguousTokensStore._massageTokens(this._languageIdCodec.encodeLanguageId(nt),rt,ut);this._ensureLine(ot);const mt=this._lineTokens[ot];return this._lineTokens[ot]=pt,gt?!ContiguousTokensStore._equals(mt,pt):!1}static _equals(nt,ot){if(!nt||!ot)return!nt&&!ot;const rt=toUint32Array(nt),ut=toUint32Array(ot);if(rt.length!==ut.length)return!1;for(let gt=0,pt=rt.length;gt<pt;gt++)if(rt[gt]!==ut[gt])return!1;return!0}acceptEdit(nt,ot,rt){this._acceptDeleteRange(nt),this._acceptInsertText(new Position$1(nt.startLineNumber,nt.startColumn),ot,rt)}_acceptDeleteRange(nt){const ot=nt.startLineNumber-1;if(ot>=this._len)return;if(nt.startLineNumber===nt.endLineNumber){if(nt.startColumn===nt.endColumn)return;this._lineTokens[ot]=ContiguousTokensEditing.delete(this._lineTokens[ot],nt.startColumn-1,nt.endColumn-1);return}this._lineTokens[ot]=ContiguousTokensEditing.deleteEnding(this._lineTokens[ot],nt.startColumn-1);const rt=nt.endLineNumber-1;let ut=null;rt<this._len&&(ut=ContiguousTokensEditing.deleteBeginning(this._lineTokens[rt],nt.endColumn-1)),this._lineTokens[ot]=ContiguousTokensEditing.append(this._lineTokens[ot],ut),this._deleteLines(nt.startLineNumber,nt.endLineNumber-nt.startLineNumber)}_acceptInsertText(nt,ot,rt){if(ot===0&&rt===0)return;const ut=nt.lineNumber-1;if(!(ut>=this._len)){if(ot===0){this._lineTokens[ut]=ContiguousTokensEditing.insert(this._lineTokens[ut],nt.column-1,rt);return}this._lineTokens[ut]=ContiguousTokensEditing.deleteEnding(this._lineTokens[ut],nt.column-1),this._lineTokens[ut]=ContiguousTokensEditing.insert(this._lineTokens[ut],nt.column-1,rt),this._insertLines(nt.lineNumber,ot)}}setMultilineTokens(nt,ot){if(nt.length===0)return{changes:[]};const rt=[];for(let ut=0,gt=nt.length;ut<gt;ut++){const pt=nt[ut];let mt=0,vt=0,St=!1;for(let yt=pt.startLineNumber;yt<=pt.endLineNumber;yt++)St?(this.setTokens(ot.getLanguageId(),yt-1,ot.getLineLength(yt),pt.getLineTokens(yt),!1),vt=yt):this.setTokens(ot.getLanguageId(),yt-1,ot.getLineLength(yt),pt.getLineTokens(yt),!0)&&(St=!0,mt=yt,vt=yt);St&&rt.push({fromLineNumber:mt,toLineNumber:vt})}return{changes:rt}}}function getDefaultMetadata(ct){return(ct<<0|0|0|32768|2<<24|1024)>>>0}class SparseTokensStore{constructor(nt){this._pieces=[],this._isComplete=!1,this._languageIdCodec=nt}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(nt,ot){this._pieces=nt||[],this._isComplete=ot}setPartial(nt,ot){let rt=nt;if(ot.length>0){const gt=ot[0].getRange(),pt=ot[ot.length-1].getRange();if(!gt||!pt)return nt;rt=nt.plusRange(gt).plusRange(pt)}let ut=null;for(let gt=0,pt=this._pieces.length;gt<pt;gt++){const mt=this._pieces[gt];if(mt.endLineNumber<rt.startLineNumber)continue;if(mt.startLineNumber>rt.endLineNumber){ut=ut||{index:gt};break}if(mt.removeTokens(rt),mt.isEmpty()){this._pieces.splice(gt,1),gt--,pt--;continue}if(mt.endLineNumber<rt.startLineNumber)continue;if(mt.startLineNumber>rt.endLineNumber){ut=ut||{index:gt};continue}const[vt,St]=mt.split(rt);if(vt.isEmpty()){ut=ut||{index:gt};continue}St.isEmpty()||(this._pieces.splice(gt,1,vt,St),gt++,pt++,ut=ut||{index:gt})}return ut=ut||{index:this._pieces.length},ot.length>0&&(this._pieces=arrayInsert(this._pieces,ut.index,ot)),rt}isComplete(){return this._isComplete}addSparseTokens(nt,ot){if(ot.getLineContent().length===0)return ot;const rt=this._pieces;if(rt.length===0)return ot;const ut=SparseTokensStore._findFirstPieceWithLine(rt,nt),gt=rt[ut].getLineTokens(nt);if(!gt)return ot;const pt=ot.getCount(),mt=gt.getCount();let vt=0;const St=[];let yt=0,wt=0;const Lt=(xt,It)=>{xt!==wt&&(wt=xt,St[yt++]=xt,St[yt++]=It)};for(let xt=0;xt<mt;xt++){const It=gt.getStartCharacter(xt),kt=gt.getEndCharacter(xt),At=gt.getMetadata(xt),Tt=((At&1?2048:0)|(At&2?4096:0)|(At&4?8192:0)|(At&8?16384:0)|(At&16?16744448:0)|(At&32?4278190080:0))>>>0,Rt=~Tt>>>0;for(;vt<pt&&ot.getEndOffset(vt)<=It;)Lt(ot.getEndOffset(vt),ot.getMetadata(vt)),vt++;for(vt<pt&&ot.getStartOffset(vt)<It&&Lt(It,ot.getMetadata(vt));vt<pt&&ot.getEndOffset(vt)<kt;)Lt(ot.getEndOffset(vt),ot.getMetadata(vt)&Rt|At&Tt),vt++;if(vt<pt)Lt(kt,ot.getMetadata(vt)&Rt|At&Tt),ot.getEndOffset(vt)===kt&&vt++;else{const Nt=Math.min(Math.max(0,vt-1),pt-1);Lt(kt,ot.getMetadata(Nt)&Rt|At&Tt)}}for(;vt<pt;)Lt(ot.getEndOffset(vt),ot.getMetadata(vt)),vt++;return new LineTokens(new Uint32Array(St),ot.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(nt,ot){let rt=0,ut=nt.length-1;for(;rt<ut;){let gt=rt+Math.floor((ut-rt)/2);if(nt[gt].endLineNumber<ot)rt=gt+1;else if(nt[gt].startLineNumber>ot)ut=gt-1;else{for(;gt>rt&&nt[gt-1].startLineNumber<=ot&&ot<=nt[gt-1].endLineNumber;)gt--;return gt}}return rt}acceptEdit(nt,ot,rt,ut,gt){for(const pt of this._pieces)pt.acceptEdit(nt,ot,rt,ut,gt)}}class TokenizationTextModelPart extends TextModelPart{constructor(nt,ot,rt,ut,gt,pt){super(),this._languageService=nt,this._languageConfigurationService=ot,this._textModel=rt,this._bracketPairsTextModelPart=ut,this._languageId=gt,this._attachedViews=pt,this._semanticTokens=new SparseTokensStore(this._languageService.languageIdCodec),this._onDidChangeLanguage=this._register(new Emitter$2),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new Emitter$2),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new Emitter$2),this.onDidChangeTokens=this._onDidChangeTokens.event,this.grammarTokens=this._register(new GrammarTokens(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews)),this._register(this._languageConfigurationService.onDidChange(mt=>{mt.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(this.grammarTokens.onDidChangeTokens(mt=>{this._emitModelTokensChangedEvent(mt)})),this._register(this.grammarTokens.onDidChangeBackgroundTokenizationState(mt=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()}))}handleDidChangeContent(nt){if(nt.isFlush)this._semanticTokens.flush();else if(!nt.isEolChange)for(const ot of nt.changes){const[rt,ut,gt]=countEOL(ot.text);this._semanticTokens.acceptEdit(ot.range,rt,ut,gt,ot.text.length>0?ot.text.charCodeAt(0):0)}this.grammarTokens.handleDidChangeContent(nt)}handleDidChangeAttached(){this.grammarTokens.handleDidChangeAttached()}getLineTokens(nt){this.validateLineNumber(nt);const ot=this.grammarTokens.getLineTokens(nt);return this._semanticTokens.addSparseTokens(nt,ot)}_emitModelTokensChangedEvent(nt){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(nt),this._onDidChangeTokens.fire(nt))}validateLineNumber(nt){if(nt<1||nt>this._textModel.getLineCount())throw new BugIndicatingError("Illegal value for lineNumber")}get hasTokens(){return this.grammarTokens.hasTokens}resetTokenization(){this.grammarTokens.resetTokenization()}get backgroundTokenizationState(){return this.grammarTokens.backgroundTokenizationState}forceTokenization(nt){this.validateLineNumber(nt),this.grammarTokens.forceTokenization(nt)}isCheapToTokenize(nt){return this.validateLineNumber(nt),this.grammarTokens.isCheapToTokenize(nt)}tokenizeIfCheap(nt){this.validateLineNumber(nt),this.grammarTokens.tokenizeIfCheap(nt)}getTokenTypeIfInsertingCharacter(nt,ot,rt){return this.grammarTokens.getTokenTypeIfInsertingCharacter(nt,ot,rt)}tokenizeLineWithEdit(nt,ot,rt){return this.grammarTokens.tokenizeLineWithEdit(nt,ot,rt)}setSemanticTokens(nt,ot){this._semanticTokens.set(nt,ot),this._emitModelTokensChangedEvent({semanticTokensApplied:nt!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(nt,ot){if(this.hasCompleteSemanticTokens())return;const rt=this._textModel.validateRange(this._semanticTokens.setPartial(nt,ot));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:rt.startLineNumber,toLineNumber:rt.endLineNumber}]})}getWordAtPosition(nt){this.assertNotDisposed();const ot=this._textModel.validatePosition(nt),rt=this._textModel.getLineContent(ot.lineNumber),ut=this.getLineTokens(ot.lineNumber),gt=ut.findTokenIndexAtOffset(ot.column-1),[pt,mt]=TokenizationTextModelPart._findLanguageBoundaries(ut,gt),vt=getWordAtText(ot.column,this.getLanguageConfiguration(ut.getLanguageId(gt)).getWordDefinition(),rt.substring(pt,mt),pt);if(vt&&vt.startColumn<=nt.column&&nt.column<=vt.endColumn)return vt;if(gt>0&&pt===ot.column-1){const[St,yt]=TokenizationTextModelPart._findLanguageBoundaries(ut,gt-1),wt=getWordAtText(ot.column,this.getLanguageConfiguration(ut.getLanguageId(gt-1)).getWordDefinition(),rt.substring(St,yt),St);if(wt&&wt.startColumn<=nt.column&&nt.column<=wt.endColumn)return wt}return null}getLanguageConfiguration(nt){return this._languageConfigurationService.getLanguageConfiguration(nt)}static _findLanguageBoundaries(nt,ot){const rt=nt.getLanguageId(ot);let ut=0;for(let pt=ot;pt>=0&&nt.getLanguageId(pt)===rt;pt--)ut=nt.getStartOffset(pt);let gt=nt.getLineContent().length;for(let pt=ot,mt=nt.getCount();pt<mt&&nt.getLanguageId(pt)===rt;pt++)gt=nt.getEndOffset(pt);return[ut,gt]}getWordUntilPosition(nt){const ot=this.getWordAtPosition(nt);return ot?{word:ot.word.substr(0,nt.column-ot.startColumn),startColumn:ot.startColumn,endColumn:nt.column}:{word:"",startColumn:nt.column,endColumn:nt.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(nt,ot){const rt=this._textModel.validatePosition(new Position$1(nt,ot)),ut=this.getLineTokens(rt.lineNumber);return ut.getLanguageId(ut.findTokenIndexAtOffset(rt.column-1))}setLanguageId(nt,ot="api"){if(this._languageId===nt)return;const rt={oldLanguage:this._languageId,newLanguage:nt,source:ot};this._languageId=nt,this._bracketPairsTextModelPart.handleDidChangeLanguage(rt),this.grammarTokens.resetTokenization(),this._onDidChangeLanguage.fire(rt),this._onDidChangeLanguageConfiguration.fire({})}}class GrammarTokens extends Disposable{get backgroundTokenizationState(){return this._backgroundTokenizationState}constructor(nt,ot,rt,ut){super(),this._languageIdCodec=nt,this._textModel=ot,this.getLanguageId=rt,this._tokenizer=null,this._defaultBackgroundTokenizer=null,this._backgroundTokenizer=this._register(new MutableDisposable),this._tokens=new ContiguousTokensStore(this._languageIdCodec),this._debugBackgroundTokenizer=this._register(new MutableDisposable),this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new Emitter$2),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event,this._onDidChangeTokens=this._register(new Emitter$2),this.onDidChangeTokens=this._onDidChangeTokens.event,this._attachedViewStates=this._register(new DisposableMap),this._register(TokenizationRegistry.onDidChange(gt=>{const pt=this.getLanguageId();gt.changedLanguages.indexOf(pt)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(ut.onDidChangeVisibleRanges(({view:gt,state:pt})=>{if(pt){let mt=this._attachedViewStates.get(gt);mt||(mt=new AttachedViewHandler(()=>this.refreshRanges(mt.lineRanges)),this._attachedViewStates.set(gt,mt)),mt.handleStateChange(pt)}else this._attachedViewStates.deleteAndDispose(gt)}))}resetTokenization(nt=!0){var ot;this._tokens.flush(),(ot=this._debugBackgroundTokens)===null||ot===void 0||ot.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new TrackingTokenizationStateStore(this._textModel.getLineCount())),nt&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});const rt=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];const pt=TokenizationRegistry.get(this.getLanguageId());if(!pt)return[null,null];let mt;try{mt=pt.getInitialState()}catch(vt){return onUnexpectedError(vt),[null,null]}return[pt,mt]},[ut,gt]=rt();if(ut&&gt?this._tokenizer=new TokenizerWithStateStoreAndTextModel(this._textModel.getLineCount(),ut,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){const pt={setTokens:mt=>{this.setTokens(mt)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;const mt=2;this._backgroundTokenizationState=mt,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(mt,vt)=>{var St,yt,wt;if(!vt)throw new BugIndicatingError;const Lt=(yt=(St=this._tokenizer)===null||St===void 0?void 0:St.store.getFirstInvalidEndStateLineNumber())!==null&&yt!==void 0?yt:void 0;Lt!==void 0&&mt>=Lt&&((wt=this._tokenizer)===null||wt===void 0||wt.store.setEndState(mt,vt))}};ut&&ut.createBackgroundTokenizer&&!ut.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=ut.createBackgroundTokenizer(this._textModel,pt)),this._backgroundTokenizer.value||(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new DefaultBackgroundTokenizer(this._tokenizer,pt),this._defaultBackgroundTokenizer.handleChanges()),ut!=null&&ut.backgroundTokenizerShouldOnlyVerifyTokens&&ut.createBackgroundTokenizer?(this._debugBackgroundTokens=new ContiguousTokensStore(this._languageIdCodec),this._debugBackgroundStates=new TrackingTokenizationStateStore(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=ut.createBackgroundTokenizer(this._textModel,{setTokens:mt=>{var vt;(vt=this._debugBackgroundTokens)===null||vt===void 0||vt.setMultilineTokens(mt,this._textModel)},backgroundTokenizationFinished(){},setEndState:(mt,vt)=>{var St;(St=this._debugBackgroundStates)===null||St===void 0||St.setEndState(mt,vt)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){var nt;(nt=this._defaultBackgroundTokenizer)===null||nt===void 0||nt.handleChanges()}handleDidChangeContent(nt){var ot,rt,ut;if(nt.isFlush)this.resetTokenization(!1);else if(!nt.isEolChange){for(const gt of nt.changes){const[pt,mt]=countEOL(gt.text);this._tokens.acceptEdit(gt.range,pt,mt),(ot=this._debugBackgroundTokens)===null||ot===void 0||ot.acceptEdit(gt.range,pt,mt)}(rt=this._debugBackgroundStates)===null||rt===void 0||rt.acceptChanges(nt.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(nt.changes),(ut=this._defaultBackgroundTokenizer)===null||ut===void 0||ut.handleChanges()}}setTokens(nt){const{changes:ot}=this._tokens.setMultilineTokens(nt,this._textModel);return ot.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:ot}),{changes:ot}}refreshAllVisibleLineTokens(){const nt=LineRange$1.joinMany([...this._attachedViewStates].map(([ot,rt])=>rt.lineRanges));this.refreshRanges(nt)}refreshRanges(nt){for(const ot of nt)this.refreshRange(ot.startLineNumber,ot.endLineNumberExclusive-1)}refreshRange(nt,ot){var rt,ut;if(!this._tokenizer)return;nt=Math.max(1,nt),ot=Math.min(this._textModel.getLineCount(),ot);const gt=new ContiguousMultilineTokensBuilder,{heuristicTokens:pt}=this._tokenizer.tokenizeHeuristically(gt,nt,ot),mt=this.setTokens(gt.finalize());if(pt)for(const vt of mt.changes)(rt=this._backgroundTokenizer.value)===null||rt===void 0||rt.requestTokens(vt.fromLineNumber,vt.toLineNumber+1);(ut=this._defaultBackgroundTokenizer)===null||ut===void 0||ut.checkFinished()}forceTokenization(nt){var ot,rt;const ut=new ContiguousMultilineTokensBuilder;(ot=this._tokenizer)===null||ot===void 0||ot.updateTokensUntilLine(ut,nt),this.setTokens(ut.finalize()),(rt=this._defaultBackgroundTokenizer)===null||rt===void 0||rt.checkFinished()}isCheapToTokenize(nt){return this._tokenizer?this._tokenizer.isCheapToTokenize(nt):!0}tokenizeIfCheap(nt){this.isCheapToTokenize(nt)&&this.forceTokenization(nt)}getLineTokens(nt){var ot;const rt=this._textModel.getLineContent(nt),ut=this._tokens.getTokens(this._textModel.getLanguageId(),nt-1,rt);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>nt&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>nt){const gt=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),nt-1,rt);!ut.equals(gt)&&(!((ot=this._debugBackgroundTokenizer.value)===null||ot===void 0)&&ot.reportMismatchingTokens)&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(nt)}return ut}getTokenTypeIfInsertingCharacter(nt,ot,rt){if(!this._tokenizer)return 0;const ut=this._textModel.validatePosition(new Position$1(nt,ot));return this.forceTokenization(ut.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(ut,rt)}tokenizeLineWithEdit(nt,ot,rt){if(!this._tokenizer)return null;const ut=this._textModel.validatePosition(nt);return this.forceTokenization(ut.lineNumber),this._tokenizer.tokenizeLineWithEdit(ut,ot,rt)}get hasTokens(){return this._tokens.hasTokens}}class AttachedViewHandler extends Disposable{get lineRanges(){return this._lineRanges}constructor(nt){super(),this._refreshTokens=nt,this.runner=this._register(new RunOnceScheduler(()=>this.update(),50)),this._computedLineRanges=[],this._lineRanges=[]}update(){equals$2(this._computedLineRanges,this._lineRanges)||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(nt){this._lineRanges=nt.visibleLineRanges,nt.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}}class ModelRawFlush{constructor(){this.changeType=1}}class LineInjectedText{static applyInjectedText(nt,ot){if(!ot||ot.length===0)return nt;let rt="",ut=0;for(const gt of ot)rt+=nt.substring(ut,gt.column-1),ut=gt.column-1,rt+=gt.options.content;return rt+=nt.substring(ut),rt}static fromDecorations(nt){const ot=[];for(const rt of nt)rt.options.before&&rt.options.before.content.length>0&&ot.push(new LineInjectedText(rt.ownerId,rt.range.startLineNumber,rt.range.startColumn,rt.options.before,0)),rt.options.after&&rt.options.after.content.length>0&&ot.push(new LineInjectedText(rt.ownerId,rt.range.endLineNumber,rt.range.endColumn,rt.options.after,1));return ot.sort((rt,ut)=>rt.lineNumber===ut.lineNumber?rt.column===ut.column?rt.order-ut.order:rt.column-ut.column:rt.lineNumber-ut.lineNumber),ot}constructor(nt,ot,rt,ut,gt){this.ownerId=nt,this.lineNumber=ot,this.column=rt,this.options=ut,this.order=gt}}class ModelRawLineChanged{constructor(nt,ot,rt){this.changeType=2,this.lineNumber=nt,this.detail=ot,this.injectedText=rt}}class ModelRawLinesDeleted{constructor(nt,ot){this.changeType=3,this.fromLineNumber=nt,this.toLineNumber=ot}}class ModelRawLinesInserted{constructor(nt,ot,rt,ut){this.changeType=4,this.injectedTexts=ut,this.fromLineNumber=nt,this.toLineNumber=ot,this.detail=rt}}class ModelRawEOLChanged{constructor(){this.changeType=5}}class ModelRawContentChangedEvent{constructor(nt,ot,rt,ut){this.changes=nt,this.versionId=ot,this.isUndoing=rt,this.isRedoing=ut,this.resultingSelection=null}containsEvent(nt){for(let ot=0,rt=this.changes.length;ot<rt;ot++)if(this.changes[ot].changeType===nt)return!0;return!1}static merge(nt,ot){const rt=[].concat(nt.changes).concat(ot.changes),ut=ot.versionId,gt=nt.isUndoing||ot.isUndoing,pt=nt.isRedoing||ot.isRedoing;return new ModelRawContentChangedEvent(rt,ut,gt,pt)}}class ModelInjectedTextChangedEvent{constructor(nt){this.changes=nt}}class InternalModelContentChangeEvent{constructor(nt,ot){this.rawContentChangedEvent=nt,this.contentChangedEvent=ot}merge(nt){const ot=ModelRawContentChangedEvent.merge(this.rawContentChangedEvent,nt.rawContentChangedEvent),rt=InternalModelContentChangeEvent._mergeChangeEvents(this.contentChangedEvent,nt.contentChangedEvent);return new InternalModelContentChangeEvent(ot,rt)}static _mergeChangeEvents(nt,ot){const rt=[].concat(nt.changes).concat(ot.changes),ut=ot.eol,gt=ot.versionId,pt=nt.isUndoing||ot.isUndoing,mt=nt.isRedoing||ot.isRedoing,vt=nt.isFlush||ot.isFlush,St=nt.isEolChange&&ot.isEolChange;return{changes:rt,eol:ut,isEolChange:St,versionId:gt,isUndoing:pt,isRedoing:mt,isFlush:vt}}}const IUndoRedoService=createDecorator("undoRedoService");class ResourceEditStackSnapshot{constructor(nt,ot){this.resource=nt,this.elements=ot}}class UndoRedoGroup{constructor(){this.id=UndoRedoGroup._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}}UndoRedoGroup._ID=0;UndoRedoGroup.None=new UndoRedoGroup;class UndoRedoSource{constructor(){this.id=UndoRedoSource._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}}UndoRedoSource._ID=0;UndoRedoSource.None=new UndoRedoSource;var __decorate$1Z=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1T=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};function createTextBufferFactory(ct){const nt=new PieceTreeTextBufferBuilder;return nt.acceptChunk(ct),nt.finish()}function createTextBufferFactoryFromSnapshot(ct){const nt=new PieceTreeTextBufferBuilder;let ot;for(;typeof(ot=ct.read())=="string";)nt.acceptChunk(ot);return nt.finish()}function createTextBuffer(ct,nt){let ot;return typeof ct=="string"?ot=createTextBufferFactory(ct):isITextSnapshot(ct)?ot=createTextBufferFactoryFromSnapshot(ct):ot=ct,ot.create(nt)}let MODEL_ID$1=0;const LIMIT_FIND_COUNT=999,LONG_LINE_BOUNDARY=1e4;class TextModelSnapshot{constructor(nt){this._source=nt,this._eos=!1}read(){if(this._eos)return null;const nt=[];let ot=0,rt=0;do{const ut=this._source.read();if(ut===null)return this._eos=!0,ot===0?null:nt.join("");if(ut.length>0&&(nt[ot++]=ut,rt+=ut.length),rt>=64*1024)return nt.join("")}while(!0)}}const invalidFunc=()=>{throw new Error("Invalid change accessor")};let TextModel=class Eo extends Disposable{static resolveOptions(nt,ot){if(ot.detectIndentation){const rt=guessIndentation(nt,ot.tabSize,ot.insertSpaces);return new TextModelResolvedOptions({tabSize:rt.tabSize,indentSize:"tabSize",insertSpaces:rt.insertSpaces,trimAutoWhitespace:ot.trimAutoWhitespace,defaultEOL:ot.defaultEOL,bracketPairColorizationOptions:ot.bracketPairColorizationOptions})}return new TextModelResolvedOptions(ot)}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}onDidChangeContent(nt){return this._eventEmitter.slowEvent(ot=>nt(ot.contentChangedEvent))}onDidChangeContentOrInjectedText(nt){return combinedDisposable(this._eventEmitter.fastEvent(ot=>nt(ot)),this._onDidChangeInjectedText.event(ot=>nt(ot)))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}constructor(nt,ot,rt,ut=null,gt,pt,mt){super(),this._undoRedoService=gt,this._languageService=pt,this._languageConfigurationService=mt,this._onWillDispose=this._register(new Emitter$2),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new DidChangeDecorationsEmitter(xt=>this.handleBeforeFireDecorationsChangedEvent(xt))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new Emitter$2),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new Emitter$2),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeInjectedText=this._register(new Emitter$2),this._eventEmitter=this._register(new DidChangeContentEmitter),this._languageSelectionListener=this._register(new MutableDisposable),this._deltaDecorationCallCnt=0,this._attachedViews=new AttachedViews,MODEL_ID$1++,this.id="$model"+MODEL_ID$1,this.isForSimpleWidget=rt.isForSimpleWidget,typeof ut>"u"||ut===null?this._associatedResource=URI.parse("inmemory://model/"+MODEL_ID$1):this._associatedResource=ut,this._attachedEditorCount=0;const{textBuffer:vt,disposable:St}=createTextBuffer(nt,rt.defaultEOL);this._buffer=vt,this._bufferDisposable=St,this._options=Eo.resolveOptions(this._buffer,rt);const yt=typeof ot=="string"?ot:ot.languageId;typeof ot!="string"&&(this._languageSelectionListener.value=ot.onDidChange(()=>this._setLanguage(ot.languageId))),this._bracketPairs=this._register(new BracketPairsTextModelPart(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new GuidesTextModelPart(this,this._languageConfigurationService)),this._decorationProvider=this._register(new ColorizedBracketPairsDecorationProvider(this)),this._tokenizationTextModelPart=new TokenizationTextModelPart(this._languageService,this._languageConfigurationService,this,this._bracketPairs,yt,this._attachedViews);const wt=this._buffer.getLineCount(),Lt=this._buffer.getValueLengthInRange(new Range$2(1,1,wt,this._buffer.getLineLength(wt)+1),0);rt.largeFileOptimizations?this._isTooLargeForTokenization=Lt>Eo.LARGE_FILE_SIZE_THRESHOLD||wt>Eo.LARGE_FILE_LINE_COUNT_THRESHOLD:this._isTooLargeForTokenization=!1,this._isTooLargeForSyncing=Lt>Eo._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=singleLetterHash(MODEL_ID$1),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new DecorationsTrees,this._commandManager=new EditStack(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(yt)}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const nt=new PieceTreeTextBuffer([],"",`
`,!1,!1,!0,!0);nt.dispose(),this._buffer=nt,this._bufferDisposable=Disposable.None}_assertNotDisposed(){if(this._isDisposed)throw new Error("Model is disposed!")}_emitContentChangedEvent(nt,ot){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(ot),this._bracketPairs.handleDidChangeContent(ot),this._eventEmitter.fire(new InternalModelContentChangeEvent(nt,ot)))}setValue(nt){if(this._assertNotDisposed(),nt==null)throw illegalArgument();const{textBuffer:ot,disposable:rt}=createTextBuffer(nt,this._options.defaultEOL);this._setValueFromTextBuffer(ot,rt)}_createContentChanged2(nt,ot,rt,ut,gt,pt,mt,vt){return{changes:[{range:nt,rangeOffset:ot,rangeLength:rt,text:ut}],eol:this._buffer.getEOL(),isEolChange:vt,versionId:this.getVersionId(),isUndoing:gt,isRedoing:pt,isFlush:mt}}_setValueFromTextBuffer(nt,ot){this._assertNotDisposed();const rt=this.getFullModelRange(),ut=this.getValueLengthInRange(rt),gt=this.getLineCount(),pt=this.getLineMaxColumn(gt);this._buffer=nt,this._bufferDisposable.dispose(),this._bufferDisposable=ot,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new DecorationsTrees,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new ModelRawContentChangedEvent([new ModelRawFlush],this._versionId,!1,!1),this._createContentChanged2(new Range$2(1,1,gt,pt),0,ut,this.getValue(),!1,!1,!0,!1))}setEOL(nt){this._assertNotDisposed();const ot=nt===1?`\r
`:`
`;if(this._buffer.getEOL()===ot)return;const rt=this.getFullModelRange(),ut=this.getValueLengthInRange(rt),gt=this.getLineCount(),pt=this.getLineMaxColumn(gt);this._onBeforeEOLChange(),this._buffer.setEOL(ot),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new ModelRawContentChangedEvent([new ModelRawEOLChanged],this._versionId,!1,!1),this._createContentChanged2(new Range$2(1,1,gt,pt),0,ut,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const nt=this.getVersionId(),ot=this._decorationsTree.collectNodesPostOrder();for(let rt=0,ut=ot.length;rt<ut;rt++){const gt=ot[rt],pt=gt.range,mt=gt.cachedAbsoluteStart-gt.start,vt=this._buffer.getOffsetAt(pt.startLineNumber,pt.startColumn),St=this._buffer.getOffsetAt(pt.endLineNumber,pt.endColumn);gt.cachedAbsoluteStart=vt,gt.cachedAbsoluteEnd=St,gt.cachedVersionId=nt,gt.start=vt-mt,gt.end=St-mt,recomputeMaxEnd(gt)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(nt){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(nt)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let nt=0,ot=0;const rt=this._buffer.getLineCount();for(let ut=1;ut<=rt;ut++){const gt=this._buffer.getLineLength(ut);gt>=LONG_LINE_BOUNDARY?ot+=gt:nt+=gt}return ot>nt}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(nt){this._assertNotDisposed();const ot=typeof nt.tabSize<"u"?nt.tabSize:this._options.tabSize,rt=typeof nt.indentSize<"u"?nt.indentSize:this._options.originalIndentSize,ut=typeof nt.insertSpaces<"u"?nt.insertSpaces:this._options.insertSpaces,gt=typeof nt.trimAutoWhitespace<"u"?nt.trimAutoWhitespace:this._options.trimAutoWhitespace,pt=typeof nt.bracketColorizationOptions<"u"?nt.bracketColorizationOptions:this._options.bracketPairColorizationOptions,mt=new TextModelResolvedOptions({tabSize:ot,indentSize:rt,insertSpaces:ut,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:gt,bracketPairColorizationOptions:pt});if(this._options.equals(mt))return;const vt=this._options.createChangeEvent(mt);this._options=mt,this._bracketPairs.handleDidChangeOptions(vt),this._decorationProvider.handleDidChangeOptions(vt),this._onDidChangeOptions.fire(vt)}detectIndentation(nt,ot){this._assertNotDisposed();const rt=guessIndentation(this._buffer,ot,nt);this.updateOptions({insertSpaces:rt.insertSpaces,tabSize:rt.tabSize,indentSize:rt.tabSize})}normalizeIndentation(nt){return this._assertNotDisposed(),normalizeIndentation(nt,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(nt=null){const ot=this.findMatches(UNUSUAL_LINE_TERMINATORS.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(nt,ot.map(rt=>({range:rt.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(nt){this._assertNotDisposed();const ot=this._validatePosition(nt.lineNumber,nt.column,0);return this._buffer.getOffsetAt(ot.lineNumber,ot.column)}getPositionAt(nt){this._assertNotDisposed();const ot=Math.min(this._buffer.getLength(),Math.max(0,nt));return this._buffer.getPositionAt(ot)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(nt){this._versionId=nt}_overwriteAlternativeVersionId(nt){this._alternativeVersionId=nt}_overwriteInitialUndoRedoSnapshot(nt){this._initialUndoRedoSnapshot=nt}getValue(nt,ot=!1){this._assertNotDisposed();const rt=this.getFullModelRange(),ut=this.getValueInRange(rt,nt);return ot?this._buffer.getBOM()+ut:ut}createSnapshot(nt=!1){return new TextModelSnapshot(this._buffer.createSnapshot(nt))}getValueLength(nt,ot=!1){this._assertNotDisposed();const rt=this.getFullModelRange(),ut=this.getValueLengthInRange(rt,nt);return ot?this._buffer.getBOM().length+ut:ut}getValueInRange(nt,ot=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(nt),ot)}getValueLengthInRange(nt,ot=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(nt),ot)}getCharacterCountInRange(nt,ot=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(nt),ot)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(nt){if(this._assertNotDisposed(),nt<1||nt>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineContent(nt)}getLineLength(nt){if(this._assertNotDisposed(),nt<1||nt>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(nt)}getLinesContent(){return this._assertNotDisposed(),this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(nt){return this._assertNotDisposed(),1}getLineMaxColumn(nt){if(this._assertNotDisposed(),nt<1||nt>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(nt)+1}getLineFirstNonWhitespaceColumn(nt){if(this._assertNotDisposed(),nt<1||nt>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(nt)}getLineLastNonWhitespaceColumn(nt){if(this._assertNotDisposed(),nt<1||nt>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(nt)}_validateRangeRelaxedNoAllocations(nt){const ot=this._buffer.getLineCount(),rt=nt.startLineNumber,ut=nt.startColumn;let gt=Math.floor(typeof rt=="number"&&!isNaN(rt)?rt:1),pt=Math.floor(typeof ut=="number"&&!isNaN(ut)?ut:1);if(gt<1)gt=1,pt=1;else if(gt>ot)gt=ot,pt=this.getLineMaxColumn(gt);else if(pt<=1)pt=1;else{const wt=this.getLineMaxColumn(gt);pt>=wt&&(pt=wt)}const mt=nt.endLineNumber,vt=nt.endColumn;let St=Math.floor(typeof mt=="number"&&!isNaN(mt)?mt:1),yt=Math.floor(typeof vt=="number"&&!isNaN(vt)?vt:1);if(St<1)St=1,yt=1;else if(St>ot)St=ot,yt=this.getLineMaxColumn(St);else if(yt<=1)yt=1;else{const wt=this.getLineMaxColumn(St);yt>=wt&&(yt=wt)}return rt===gt&&ut===pt&&mt===St&&vt===yt&&nt instanceof Range$2&&!(nt instanceof Selection$1)?nt:new Range$2(gt,pt,St,yt)}_isValidPosition(nt,ot,rt){if(typeof nt!="number"||typeof ot!="number"||isNaN(nt)||isNaN(ot)||nt<1||ot<1||(nt|0)!==nt||(ot|0)!==ot)return!1;const ut=this._buffer.getLineCount();if(nt>ut)return!1;if(ot===1)return!0;const gt=this.getLineMaxColumn(nt);if(ot>gt)return!1;if(rt===1){const pt=this._buffer.getLineCharCode(nt,ot-2);if(isHighSurrogate(pt))return!1}return!0}_validatePosition(nt,ot,rt){const ut=Math.floor(typeof nt=="number"&&!isNaN(nt)?nt:1),gt=Math.floor(typeof ot=="number"&&!isNaN(ot)?ot:1),pt=this._buffer.getLineCount();if(ut<1)return new Position$1(1,1);if(ut>pt)return new Position$1(pt,this.getLineMaxColumn(pt));if(gt<=1)return new Position$1(ut,1);const mt=this.getLineMaxColumn(ut);if(gt>=mt)return new Position$1(ut,mt);if(rt===1){const vt=this._buffer.getLineCharCode(ut,gt-2);if(isHighSurrogate(vt))return new Position$1(ut,gt-1)}return new Position$1(ut,gt)}validatePosition(nt){return this._assertNotDisposed(),nt instanceof Position$1&&this._isValidPosition(nt.lineNumber,nt.column,1)?nt:this._validatePosition(nt.lineNumber,nt.column,1)}_isValidRange(nt,ot){const rt=nt.startLineNumber,ut=nt.startColumn,gt=nt.endLineNumber,pt=nt.endColumn;if(!this._isValidPosition(rt,ut,0)||!this._isValidPosition(gt,pt,0))return!1;if(ot===1){const mt=ut>1?this._buffer.getLineCharCode(rt,ut-2):0,vt=pt>1&&pt<=this._buffer.getLineLength(gt)?this._buffer.getLineCharCode(gt,pt-2):0,St=isHighSurrogate(mt),yt=isHighSurrogate(vt);return!St&&!yt}return!0}validateRange(nt){if(this._assertNotDisposed(),nt instanceof Range$2&&!(nt instanceof Selection$1)&&this._isValidRange(nt,1))return nt;const rt=this._validatePosition(nt.startLineNumber,nt.startColumn,0),ut=this._validatePosition(nt.endLineNumber,nt.endColumn,0),gt=rt.lineNumber,pt=rt.column,mt=ut.lineNumber,vt=ut.column;{const St=pt>1?this._buffer.getLineCharCode(gt,pt-2):0,yt=vt>1&&vt<=this._buffer.getLineLength(mt)?this._buffer.getLineCharCode(mt,vt-2):0,wt=isHighSurrogate(St),Lt=isHighSurrogate(yt);return!wt&&!Lt?new Range$2(gt,pt,mt,vt):gt===mt&&pt===vt?new Range$2(gt,pt-1,mt,vt-1):wt&&Lt?new Range$2(gt,pt-1,mt,vt+1):wt?new Range$2(gt,pt-1,mt,vt):new Range$2(gt,pt,mt,vt+1)}}modifyPosition(nt,ot){this._assertNotDisposed();const rt=this.getOffsetAt(nt)+ot;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,rt)))}getFullModelRange(){this._assertNotDisposed();const nt=this.getLineCount();return new Range$2(1,1,nt,this.getLineMaxColumn(nt))}findMatchesLineByLine(nt,ot,rt,ut){return this._buffer.findMatchesLineByLine(nt,ot,rt,ut)}findMatches(nt,ot,rt,ut,gt,pt,mt=LIMIT_FIND_COUNT){this._assertNotDisposed();let vt=null;ot!==null&&(Array.isArray(ot)||(ot=[ot]),ot.every(wt=>Range$2.isIRange(wt))&&(vt=ot.map(wt=>this.validateRange(wt)))),vt===null&&(vt=[this.getFullModelRange()]),vt=vt.sort((wt,Lt)=>wt.startLineNumber-Lt.startLineNumber||wt.startColumn-Lt.startColumn);const St=[];St.push(vt.reduce((wt,Lt)=>Range$2.areIntersecting(wt,Lt)?wt.plusRange(Lt):(St.push(wt),Lt)));let yt;if(!rt&&nt.indexOf(`
`)<0){const Lt=new SearchParams(nt,rt,ut,gt).parseSearchRequest();if(!Lt)return[];yt=xt=>this.findMatchesLineByLine(xt,Lt,pt,mt)}else yt=wt=>TextModelSearch.findMatches(this,new SearchParams(nt,rt,ut,gt),wt,pt,mt);return St.map(yt).reduce((wt,Lt)=>wt.concat(Lt),[])}findNextMatch(nt,ot,rt,ut,gt,pt){this._assertNotDisposed();const mt=this.validatePosition(ot);if(!rt&&nt.indexOf(`
`)<0){const St=new SearchParams(nt,rt,ut,gt).parseSearchRequest();if(!St)return null;const yt=this.getLineCount();let wt=new Range$2(mt.lineNumber,mt.column,yt,this.getLineMaxColumn(yt)),Lt=this.findMatchesLineByLine(wt,St,pt,1);return TextModelSearch.findNextMatch(this,new SearchParams(nt,rt,ut,gt),mt,pt),Lt.length>0||(wt=new Range$2(1,1,mt.lineNumber,this.getLineMaxColumn(mt.lineNumber)),Lt=this.findMatchesLineByLine(wt,St,pt,1),Lt.length>0)?Lt[0]:null}return TextModelSearch.findNextMatch(this,new SearchParams(nt,rt,ut,gt),mt,pt)}findPreviousMatch(nt,ot,rt,ut,gt,pt){this._assertNotDisposed();const mt=this.validatePosition(ot);return TextModelSearch.findPreviousMatch(this,new SearchParams(nt,rt,ut,gt),mt,pt)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(nt){if((this.getEOL()===`
`?0:1)!==nt)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(nt)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(nt){return nt instanceof ValidAnnotatedEditOperation?nt:new ValidAnnotatedEditOperation(nt.identifier||null,this.validateRange(nt.range),nt.text,nt.forceMoveMarkers||!1,nt.isAutoWhitespaceEdit||!1,nt._isTracked||!1)}_validateEditOperations(nt){const ot=[];for(let rt=0,ut=nt.length;rt<ut;rt++)ot[rt]=this._validateEditOperation(nt[rt]);return ot}pushEditOperations(nt,ot,rt,ut){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(nt,this._validateEditOperations(ot),rt,ut)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(nt,ot,rt,ut){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const gt=ot.map(mt=>({range:this.validateRange(mt.range),text:mt.text}));let pt=!0;if(nt)for(let mt=0,vt=nt.length;mt<vt;mt++){const St=nt[mt];let yt=!1;for(let wt=0,Lt=gt.length;wt<Lt;wt++){const xt=gt[wt].range,It=xt.startLineNumber>St.endLineNumber,kt=St.startLineNumber>xt.endLineNumber;if(!It&&!kt){yt=!0;break}}if(!yt){pt=!1;break}}if(pt)for(let mt=0,vt=this._trimAutoWhitespaceLines.length;mt<vt;mt++){const St=this._trimAutoWhitespaceLines[mt],yt=this.getLineMaxColumn(St);let wt=!0;for(let Lt=0,xt=gt.length;Lt<xt;Lt++){const It=gt[Lt].range,kt=gt[Lt].text;if(!(St<It.startLineNumber||St>It.endLineNumber)&&!(St===It.startLineNumber&&It.startColumn===yt&&It.isEmpty()&&kt&&kt.length>0&&kt.charAt(0)===`
`)&&!(St===It.startLineNumber&&It.startColumn===1&&It.isEmpty()&&kt&&kt.length>0&&kt.charAt(kt.length-1)===`
`)){wt=!1;break}}if(wt){const Lt=new Range$2(St,1,St,yt);ot.push(new ValidAnnotatedEditOperation(null,Lt,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(nt,ot,rt,ut)}_applyUndo(nt,ot,rt,ut){const gt=nt.map(pt=>{const mt=this.getPositionAt(pt.newPosition),vt=this.getPositionAt(pt.newEnd);return{range:new Range$2(mt.lineNumber,mt.column,vt.lineNumber,vt.column),text:pt.oldText}});this._applyUndoRedoEdits(gt,ot,!0,!1,rt,ut)}_applyRedo(nt,ot,rt,ut){const gt=nt.map(pt=>{const mt=this.getPositionAt(pt.oldPosition),vt=this.getPositionAt(pt.oldEnd);return{range:new Range$2(mt.lineNumber,mt.column,vt.lineNumber,vt.column),text:pt.newText}});this._applyUndoRedoEdits(gt,ot,!1,!0,rt,ut)}_applyUndoRedoEdits(nt,ot,rt,ut,gt,pt){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=rt,this._isRedoing=ut,this.applyEdits(nt,!1),this.setEOL(ot),this._overwriteAlternativeVersionId(gt)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(pt),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(nt,ot=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const rt=this._validateEditOperations(nt);return this._doApplyEdits(rt,ot)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(nt,ot){const rt=this._buffer.getLineCount(),ut=this._buffer.applyEdits(nt,this._options.trimAutoWhitespace,ot),gt=this._buffer.getLineCount(),pt=ut.changes;if(this._trimAutoWhitespaceLines=ut.trimAutoWhitespaceLineNumbers,pt.length!==0){for(let St=0,yt=pt.length;St<yt;St++){const wt=pt[St];this._decorationsTree.acceptReplace(wt.rangeOffset,wt.rangeLength,wt.text.length,wt.forceMoveMarkers)}const mt=[];this._increaseVersionId();let vt=rt;for(let St=0,yt=pt.length;St<yt;St++){const wt=pt[St],[Lt]=countEOL(wt.text);this._onDidChangeDecorations.fire();const xt=wt.range.startLineNumber,It=wt.range.endLineNumber,kt=It-xt,At=Lt,Tt=Math.min(kt,At),Rt=At-kt,Nt=gt-vt-Rt+xt,Pt=Nt,Ft=Nt+At,Kt=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new Position$1(Pt,1)),this.getOffsetAt(new Position$1(Ft,this.getLineMaxColumn(Ft))),0),Bt=LineInjectedText.fromDecorations(Kt),Ut=new ArrayQueue(Bt);for(let qt=Tt;qt>=0;qt--){const Yt=xt+qt,Zt=Nt+qt;Ut.takeFromEndWhile(_i=>_i.lineNumber>Zt);const Xt=Ut.takeFromEndWhile(_i=>_i.lineNumber===Zt);mt.push(new ModelRawLineChanged(Yt,this.getLineContent(Zt),Xt))}if(Tt<kt){const qt=xt+Tt;mt.push(new ModelRawLinesDeleted(qt+1,It))}if(Tt<At){const qt=new ArrayQueue(Bt),Yt=xt+Tt,Zt=At-Tt,Xt=gt-vt-Zt+Yt+1,_i=[],nn=[];for(let rn=0;rn<Zt;rn++){const dn=Xt+rn;nn[rn]=this.getLineContent(dn),qt.takeWhile(bn=>bn.lineNumber<dn),_i[rn]=qt.takeWhile(bn=>bn.lineNumber===dn)}mt.push(new ModelRawLinesInserted(Yt+1,xt+At,nn,_i))}vt+=Rt}this._emitContentChangedEvent(new ModelRawContentChangedEvent(mt,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:pt,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return ut.reverseEdits===null?void 0:ut.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(nt){if(nt===null||nt.size===0)return;const rt=Array.from(nt).map(ut=>new ModelRawLineChanged(ut,this.getLineContent(ut),this._getInjectedTextInLine(ut)));this._onDidChangeInjectedText.fire(new ModelInjectedTextChangedEvent(rt))}changeDecorations(nt,ot=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(ot,nt)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(nt,ot){const rt={addDecoration:(gt,pt)=>this._deltaDecorationsImpl(nt,[],[{range:gt,options:pt}])[0],changeDecoration:(gt,pt)=>{this._changeDecorationImpl(gt,pt)},changeDecorationOptions:(gt,pt)=>{this._changeDecorationOptionsImpl(gt,_normalizeOptions(pt))},removeDecoration:gt=>{this._deltaDecorationsImpl(nt,[gt],[])},deltaDecorations:(gt,pt)=>gt.length===0&&pt.length===0?[]:this._deltaDecorationsImpl(nt,gt,pt)};let ut=null;try{ut=ot(rt)}catch(gt){onUnexpectedError(gt)}return rt.addDecoration=invalidFunc,rt.changeDecoration=invalidFunc,rt.changeDecorationOptions=invalidFunc,rt.removeDecoration=invalidFunc,rt.deltaDecorations=invalidFunc,ut}deltaDecorations(nt,ot,rt=0){if(this._assertNotDisposed(),nt||(nt=[]),nt.length===0&&ot.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),onUnexpectedError(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(rt,nt,ot)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(nt){return this.getDecorationRange(nt)}_setTrackedRange(nt,ot,rt){const ut=nt?this._decorations[nt]:null;if(!ut)return ot?this._deltaDecorationsImpl(0,[],[{range:ot,options:TRACKED_RANGE_OPTIONS[rt]}],!0)[0]:null;if(!ot)return this._decorationsTree.delete(ut),delete this._decorations[ut.id],null;const gt=this._validateRangeRelaxedNoAllocations(ot),pt=this._buffer.getOffsetAt(gt.startLineNumber,gt.startColumn),mt=this._buffer.getOffsetAt(gt.endLineNumber,gt.endColumn);return this._decorationsTree.delete(ut),ut.reset(this.getVersionId(),pt,mt,gt),ut.setOptions(TRACKED_RANGE_OPTIONS[rt]),this._decorationsTree.insert(ut),ut.id}removeAllDecorationsWithOwnerId(nt){if(this._isDisposed)return;const ot=this._decorationsTree.collectNodesFromOwner(nt);for(let rt=0,ut=ot.length;rt<ut;rt++){const gt=ot[rt];this._decorationsTree.delete(gt),delete this._decorations[gt.id]}}getDecorationOptions(nt){const ot=this._decorations[nt];return ot?ot.options:null}getDecorationRange(nt){const ot=this._decorations[nt];return ot?this._decorationsTree.getNodeRange(this,ot):null}getLineDecorations(nt,ot=0,rt=!1){return nt<1||nt>this.getLineCount()?[]:this.getLinesDecorations(nt,nt,ot,rt)}getLinesDecorations(nt,ot,rt=0,ut=!1,gt=!1){const pt=this.getLineCount(),mt=Math.min(pt,Math.max(1,nt)),vt=Math.min(pt,Math.max(1,ot)),St=this.getLineMaxColumn(vt),yt=new Range$2(mt,1,vt,St),wt=this._getDecorationsInRange(yt,rt,ut,gt);return pushMany(wt,this._decorationProvider.getDecorationsInRange(yt,rt,ut)),wt}getDecorationsInRange(nt,ot=0,rt=!1,ut=!1,gt=!1){const pt=this.validateRange(nt),mt=this._getDecorationsInRange(pt,ot,rt,gt);return pushMany(mt,this._decorationProvider.getDecorationsInRange(pt,ot,rt,ut)),mt}getOverviewRulerDecorations(nt=0,ot=!1){return this._decorationsTree.getAll(this,nt,ot,!0,!1)}getInjectedTextDecorations(nt=0){return this._decorationsTree.getAllInjectedText(this,nt)}_getInjectedTextInLine(nt){const ot=this._buffer.getOffsetAt(nt,1),rt=ot+this._buffer.getLineLength(nt),ut=this._decorationsTree.getInjectedTextInInterval(this,ot,rt,0);return LineInjectedText.fromDecorations(ut).filter(gt=>gt.lineNumber===nt)}getAllDecorations(nt=0,ot=!1){let rt=this._decorationsTree.getAll(this,nt,ot,!1,!1);return rt=rt.concat(this._decorationProvider.getAllDecorations(nt,ot)),rt}getAllMarginDecorations(nt=0){return this._decorationsTree.getAll(this,nt,!1,!1,!0)}_getDecorationsInRange(nt,ot,rt,ut){const gt=this._buffer.getOffsetAt(nt.startLineNumber,nt.startColumn),pt=this._buffer.getOffsetAt(nt.endLineNumber,nt.endColumn);return this._decorationsTree.getAllInInterval(this,gt,pt,ot,rt,ut)}getRangeAt(nt,ot){return this._buffer.getRangeAt(nt,ot-nt)}_changeDecorationImpl(nt,ot){const rt=this._decorations[nt];if(!rt)return;if(rt.options.after){const mt=this.getDecorationRange(nt);this._onDidChangeDecorations.recordLineAffectedByInjectedText(mt.endLineNumber)}if(rt.options.before){const mt=this.getDecorationRange(nt);this._onDidChangeDecorations.recordLineAffectedByInjectedText(mt.startLineNumber)}const ut=this._validateRangeRelaxedNoAllocations(ot),gt=this._buffer.getOffsetAt(ut.startLineNumber,ut.startColumn),pt=this._buffer.getOffsetAt(ut.endLineNumber,ut.endColumn);this._decorationsTree.delete(rt),rt.reset(this.getVersionId(),gt,pt,ut),this._decorationsTree.insert(rt),this._onDidChangeDecorations.checkAffectedAndFire(rt.options),rt.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(ut.endLineNumber),rt.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(ut.startLineNumber)}_changeDecorationOptionsImpl(nt,ot){const rt=this._decorations[nt];if(!rt)return;const ut=!!(rt.options.overviewRuler&&rt.options.overviewRuler.color),gt=!!(ot.overviewRuler&&ot.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(rt.options),this._onDidChangeDecorations.checkAffectedAndFire(ot),rt.options.after||ot.after){const pt=this._decorationsTree.getNodeRange(this,rt);this._onDidChangeDecorations.recordLineAffectedByInjectedText(pt.endLineNumber)}if(rt.options.before||ot.before){const pt=this._decorationsTree.getNodeRange(this,rt);this._onDidChangeDecorations.recordLineAffectedByInjectedText(pt.startLineNumber)}ut!==gt?(this._decorationsTree.delete(rt),rt.setOptions(ot),this._decorationsTree.insert(rt)):rt.setOptions(ot)}_deltaDecorationsImpl(nt,ot,rt,ut=!1){const gt=this.getVersionId(),pt=ot.length;let mt=0;const vt=rt.length;let St=0;this._onDidChangeDecorations.beginDeferredEmit();try{const yt=new Array(vt);for(;mt<pt||St<vt;){let wt=null;if(mt<pt){do wt=this._decorations[ot[mt++]];while(!wt&&mt<pt);if(wt){if(wt.options.after){const Lt=this._decorationsTree.getNodeRange(this,wt);this._onDidChangeDecorations.recordLineAffectedByInjectedText(Lt.endLineNumber)}if(wt.options.before){const Lt=this._decorationsTree.getNodeRange(this,wt);this._onDidChangeDecorations.recordLineAffectedByInjectedText(Lt.startLineNumber)}this._decorationsTree.delete(wt),ut||this._onDidChangeDecorations.checkAffectedAndFire(wt.options)}}if(St<vt){if(!wt){const Tt=++this._lastDecorationId,Rt=`${this._instanceId};${Tt}`;wt=new IntervalNode(Rt,0,0),this._decorations[Rt]=wt}const Lt=rt[St],xt=this._validateRangeRelaxedNoAllocations(Lt.range),It=_normalizeOptions(Lt.options),kt=this._buffer.getOffsetAt(xt.startLineNumber,xt.startColumn),At=this._buffer.getOffsetAt(xt.endLineNumber,xt.endColumn);wt.ownerId=nt,wt.reset(gt,kt,At,xt),wt.setOptions(It),wt.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(xt.endLineNumber),wt.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(xt.startLineNumber),ut||this._onDidChangeDecorations.checkAffectedAndFire(It),this._decorationsTree.insert(wt),yt[St]=wt.id,St++}else wt&&delete this._decorations[wt.id]}return yt}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(nt,ot){typeof nt=="string"?(this._languageSelectionListener.clear(),this._setLanguage(nt,ot)):(this._languageSelectionListener.value=nt.onDidChange(()=>this._setLanguage(nt.languageId,ot)),this._setLanguage(nt.languageId,ot))}_setLanguage(nt,ot){this.tokenization.setLanguageId(nt,ot),this._languageService.requestRichLanguageFeatures(nt)}getLanguageIdAtPosition(nt,ot){return this.tokenization.getLanguageIdAtPosition(nt,ot)}getWordAtPosition(nt){return this._tokenizationTextModelPart.getWordAtPosition(nt)}getWordUntilPosition(nt){return this._tokenizationTextModelPart.getWordUntilPosition(nt)}normalizePosition(nt,ot){return nt}getLineIndentColumn(nt){return indentOfLine(this.getLineContent(nt))+1}};TextModel._MODEL_SYNC_LIMIT=50*1024*1024;TextModel.LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;TextModel.LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;TextModel.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:EDITOR_MODEL_DEFAULTS.tabSize,indentSize:EDITOR_MODEL_DEFAULTS.indentSize,insertSpaces:EDITOR_MODEL_DEFAULTS.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:EDITOR_MODEL_DEFAULTS.trimAutoWhitespace,largeFileOptimizations:EDITOR_MODEL_DEFAULTS.largeFileOptimizations,bracketPairColorizationOptions:EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions};TextModel=__decorate$1Z([__param$1T(4,IUndoRedoService),__param$1T(5,ILanguageService),__param$1T(6,ILanguageConfigurationService)],TextModel);function indentOfLine(ct){let nt=0;for(const ot of ct)if(ot===" "||ot==="	")nt++;else break;return nt}function isNodeInOverviewRuler(ct){return!!(ct.options.overviewRuler&&ct.options.overviewRuler.color)}function isNodeInjectedText(ct){return!!ct.options.after||!!ct.options.before}class DecorationsTrees{constructor(){this._decorationsTree0=new IntervalTree,this._decorationsTree1=new IntervalTree,this._injectedTextDecorationsTree=new IntervalTree}ensureAllNodesHaveRanges(nt){this.getAll(nt,0,!1,!1,!1)}_ensureNodesHaveRanges(nt,ot){for(const rt of ot)rt.range===null&&(rt.range=nt.getRangeAt(rt.cachedAbsoluteStart,rt.cachedAbsoluteEnd));return ot}getAllInInterval(nt,ot,rt,ut,gt,pt){const mt=nt.getVersionId(),vt=this._intervalSearch(ot,rt,ut,gt,mt,pt);return this._ensureNodesHaveRanges(nt,vt)}_intervalSearch(nt,ot,rt,ut,gt,pt){const mt=this._decorationsTree0.intervalSearch(nt,ot,rt,ut,gt,pt),vt=this._decorationsTree1.intervalSearch(nt,ot,rt,ut,gt,pt),St=this._injectedTextDecorationsTree.intervalSearch(nt,ot,rt,ut,gt,pt);return mt.concat(vt).concat(St)}getInjectedTextInInterval(nt,ot,rt,ut){const gt=nt.getVersionId(),pt=this._injectedTextDecorationsTree.intervalSearch(ot,rt,ut,!1,gt,!1);return this._ensureNodesHaveRanges(nt,pt).filter(mt=>mt.options.showIfCollapsed||!mt.range.isEmpty())}getAllInjectedText(nt,ot){const rt=nt.getVersionId(),ut=this._injectedTextDecorationsTree.search(ot,!1,rt,!1);return this._ensureNodesHaveRanges(nt,ut).filter(gt=>gt.options.showIfCollapsed||!gt.range.isEmpty())}getAll(nt,ot,rt,ut,gt){const pt=nt.getVersionId(),mt=this._search(ot,rt,ut,pt,gt);return this._ensureNodesHaveRanges(nt,mt)}_search(nt,ot,rt,ut,gt){if(rt)return this._decorationsTree1.search(nt,ot,ut,gt);{const pt=this._decorationsTree0.search(nt,ot,ut,gt),mt=this._decorationsTree1.search(nt,ot,ut,gt),vt=this._injectedTextDecorationsTree.search(nt,ot,ut,gt);return pt.concat(mt).concat(vt)}}collectNodesFromOwner(nt){const ot=this._decorationsTree0.collectNodesFromOwner(nt),rt=this._decorationsTree1.collectNodesFromOwner(nt),ut=this._injectedTextDecorationsTree.collectNodesFromOwner(nt);return ot.concat(rt).concat(ut)}collectNodesPostOrder(){const nt=this._decorationsTree0.collectNodesPostOrder(),ot=this._decorationsTree1.collectNodesPostOrder(),rt=this._injectedTextDecorationsTree.collectNodesPostOrder();return nt.concat(ot).concat(rt)}insert(nt){isNodeInjectedText(nt)?this._injectedTextDecorationsTree.insert(nt):isNodeInOverviewRuler(nt)?this._decorationsTree1.insert(nt):this._decorationsTree0.insert(nt)}delete(nt){isNodeInjectedText(nt)?this._injectedTextDecorationsTree.delete(nt):isNodeInOverviewRuler(nt)?this._decorationsTree1.delete(nt):this._decorationsTree0.delete(nt)}getNodeRange(nt,ot){const rt=nt.getVersionId();return ot.cachedVersionId!==rt&&this._resolveNode(ot,rt),ot.range===null&&(ot.range=nt.getRangeAt(ot.cachedAbsoluteStart,ot.cachedAbsoluteEnd)),ot.range}_resolveNode(nt,ot){isNodeInjectedText(nt)?this._injectedTextDecorationsTree.resolveNode(nt,ot):isNodeInOverviewRuler(nt)?this._decorationsTree1.resolveNode(nt,ot):this._decorationsTree0.resolveNode(nt,ot)}acceptReplace(nt,ot,rt,ut){this._decorationsTree0.acceptReplace(nt,ot,rt,ut),this._decorationsTree1.acceptReplace(nt,ot,rt,ut),this._injectedTextDecorationsTree.acceptReplace(nt,ot,rt,ut)}}function cleanClassName(ct){return ct.replace(/[^a-z0-9\-_]/gi," ")}class DecorationOptions{constructor(nt){this.color=nt.color||"",this.darkColor=nt.darkColor||""}}class ModelDecorationOverviewRulerOptions extends DecorationOptions{constructor(nt){super(nt),this._resolvedColor=null,this.position=typeof nt.position=="number"?nt.position:OverviewRulerLane.Center}getColor(nt){return this._resolvedColor||(nt.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,nt):this._resolvedColor=this._resolveColor(this.color,nt)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(nt,ot){if(typeof nt=="string")return nt;const rt=nt?ot.getColor(nt.id):null;return rt?rt.toString():""}}class ModelDecorationGlyphMarginOptions{constructor(nt){var ot;this.position=(ot=nt==null?void 0:nt.position)!==null&&ot!==void 0?ot:GlyphMarginLane.Left}}class ModelDecorationMinimapOptions extends DecorationOptions{constructor(nt){super(nt),this.position=nt.position}getColor(nt){return this._resolvedColor||(nt.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,nt):this._resolvedColor=this._resolveColor(this.color,nt)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(nt,ot){return typeof nt=="string"?Color.fromHex(nt):ot.getColor(nt.id)}}class ModelDecorationInjectedTextOptions{static from(nt){return nt instanceof ModelDecorationInjectedTextOptions?nt:new ModelDecorationInjectedTextOptions(nt)}constructor(nt){this.content=nt.content||"",this.inlineClassName=nt.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=nt.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=nt.attachedData||null,this.cursorStops=nt.cursorStops||null}}class ModelDecorationOptions{static register(nt){return new ModelDecorationOptions(nt)}static createDynamic(nt){return new ModelDecorationOptions(nt)}constructor(nt){var ot,rt,ut,gt,pt;this.description=nt.description,this.blockClassName=nt.blockClassName?cleanClassName(nt.blockClassName):null,this.blockDoesNotCollapse=(ot=nt.blockDoesNotCollapse)!==null&&ot!==void 0?ot:null,this.blockIsAfterEnd=(rt=nt.blockIsAfterEnd)!==null&&rt!==void 0?rt:null,this.blockPadding=(ut=nt.blockPadding)!==null&&ut!==void 0?ut:null,this.stickiness=nt.stickiness||0,this.zIndex=nt.zIndex||0,this.className=nt.className?cleanClassName(nt.className):null,this.hoverMessage=nt.hoverMessage||null,this.glyphMarginHoverMessage=nt.glyphMarginHoverMessage||null,this.isWholeLine=nt.isWholeLine||!1,this.showIfCollapsed=nt.showIfCollapsed||!1,this.collapseOnReplaceEdit=nt.collapseOnReplaceEdit||!1,this.overviewRuler=nt.overviewRuler?new ModelDecorationOverviewRulerOptions(nt.overviewRuler):null,this.minimap=nt.minimap?new ModelDecorationMinimapOptions(nt.minimap):null,this.glyphMargin=nt.glyphMarginClassName?new ModelDecorationGlyphMarginOptions(nt.glyphMargin):null,this.glyphMarginClassName=nt.glyphMarginClassName?cleanClassName(nt.glyphMarginClassName):null,this.linesDecorationsClassName=nt.linesDecorationsClassName?cleanClassName(nt.linesDecorationsClassName):null,this.firstLineDecorationClassName=nt.firstLineDecorationClassName?cleanClassName(nt.firstLineDecorationClassName):null,this.marginClassName=nt.marginClassName?cleanClassName(nt.marginClassName):null,this.inlineClassName=nt.inlineClassName?cleanClassName(nt.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=nt.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=nt.beforeContentClassName?cleanClassName(nt.beforeContentClassName):null,this.afterContentClassName=nt.afterContentClassName?cleanClassName(nt.afterContentClassName):null,this.after=nt.after?ModelDecorationInjectedTextOptions.from(nt.after):null,this.before=nt.before?ModelDecorationInjectedTextOptions.from(nt.before):null,this.hideInCommentTokens=(gt=nt.hideInCommentTokens)!==null&&gt!==void 0?gt:!1,this.hideInStringTokens=(pt=nt.hideInStringTokens)!==null&&pt!==void 0?pt:!1}}ModelDecorationOptions.EMPTY=ModelDecorationOptions.register({description:"empty"});const TRACKED_RANGE_OPTIONS=[ModelDecorationOptions.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),ModelDecorationOptions.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),ModelDecorationOptions.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),ModelDecorationOptions.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function _normalizeOptions(ct){return ct instanceof ModelDecorationOptions?ct:ModelDecorationOptions.createDynamic(ct)}class DidChangeDecorationsEmitter extends Disposable{constructor(nt){super(),this.handleBeforeFire=nt,this._actual=this._register(new Emitter$2),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var nt;this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),(nt=this._affectedInjectedTextLines)===null||nt===void 0||nt.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(nt){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(nt)}checkAffectedAndFire(nt){this._affectsMinimap||(this._affectsMinimap=!!(nt.minimap&&nt.minimap.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!!(nt.overviewRuler&&nt.overviewRuler.color)),this._affectsGlyphMargin||(this._affectsGlyphMargin=!!nt.glyphMarginClassName),this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);const nt={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(nt)}}class DidChangeContentEmitter extends Disposable{constructor(){super(),this._fastEmitter=this._register(new Emitter$2),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new Emitter$2),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(nt=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=nt;const ot=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(ot),this._slowEmitter.fire(ot)}}fire(nt){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(nt):this._deferredEvent=nt;return}this._fastEmitter.fire(nt),this._slowEmitter.fire(nt)}}class AttachedViews{constructor(){this._onDidChangeVisibleRanges=new Emitter$2,this.onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event,this._views=new Set}attachView(){const nt=new AttachedViewImpl(ot=>{this._onDidChangeVisibleRanges.fire({view:nt,state:ot})});return this._views.add(nt),nt}detachView(nt){this._views.delete(nt),this._onDidChangeVisibleRanges.fire({view:nt,state:void 0})}}class AttachedViewImpl{constructor(nt){this.handleStateChange=nt}setVisibleLines(nt,ot){const rt=nt.map(ut=>new LineRange$1(ut.startLineNumber,ut.endLineNumber+1));this.handleStateChange({visibleLineRanges:rt,stabilized:ot})}}class Cursor{constructor(nt){this._selTrackedRange=null,this._trackSelection=!0,this._setState(nt,new SingleCursorState(new Range$2(1,1,1,1),0,0,new Position$1(1,1),0),new SingleCursorState(new Range$2(1,1,1,1),0,0,new Position$1(1,1),0))}dispose(nt){this._removeTrackedRange(nt)}startTrackingSelection(nt){this._trackSelection=!0,this._updateTrackedRange(nt)}stopTrackingSelection(nt){this._trackSelection=!1,this._removeTrackedRange(nt)}_updateTrackedRange(nt){this._trackSelection&&(this._selTrackedRange=nt.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(nt){this._selTrackedRange=nt.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new CursorState$1(this.modelState,this.viewState)}readSelectionFromMarkers(nt){const ot=nt.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!ot.isEmpty()?Selection$1.fromRange(ot.collapseToEnd(),this.modelState.selection.getDirection()):Selection$1.fromRange(ot,this.modelState.selection.getDirection())}ensureValidState(nt){this._setState(nt,this.modelState,this.viewState)}setState(nt,ot,rt){this._setState(nt,ot,rt)}static _validatePositionWithCache(nt,ot,rt,ut){return ot.equals(rt)?ut:nt.normalizePosition(ot,2)}static _validateViewState(nt,ot){const rt=ot.position,ut=ot.selectionStart.getStartPosition(),gt=ot.selectionStart.getEndPosition(),pt=nt.normalizePosition(rt,2),mt=this._validatePositionWithCache(nt,ut,rt,pt),vt=this._validatePositionWithCache(nt,gt,ut,mt);return rt.equals(pt)&&ut.equals(mt)&&gt.equals(vt)?ot:new SingleCursorState(Range$2.fromPositions(mt,vt),ot.selectionStartKind,ot.selectionStartLeftoverVisibleColumns+ut.column-mt.column,pt,ot.leftoverVisibleColumns+rt.column-pt.column)}_setState(nt,ot,rt){if(rt&&(rt=Cursor._validateViewState(nt.viewModel,rt)),ot){const ut=nt.model.validateRange(ot.selectionStart),gt=ot.selectionStart.equalsRange(ut)?ot.selectionStartLeftoverVisibleColumns:0,pt=nt.model.validatePosition(ot.position),mt=ot.position.equals(pt)?ot.leftoverVisibleColumns:0;ot=new SingleCursorState(ut,ot.selectionStartKind,gt,pt,mt)}else{if(!rt)return;const ut=nt.model.validateRange(nt.coordinatesConverter.convertViewRangeToModelRange(rt.selectionStart)),gt=nt.model.validatePosition(nt.coordinatesConverter.convertViewPositionToModelPosition(rt.position));ot=new SingleCursorState(ut,rt.selectionStartKind,rt.selectionStartLeftoverVisibleColumns,gt,rt.leftoverVisibleColumns)}if(rt){const ut=nt.coordinatesConverter.validateViewRange(rt.selectionStart,ot.selectionStart),gt=nt.coordinatesConverter.validateViewPosition(rt.position,ot.position);rt=new SingleCursorState(ut,ot.selectionStartKind,ot.selectionStartLeftoverVisibleColumns,gt,ot.leftoverVisibleColumns)}else{const ut=nt.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(ot.selectionStart.startLineNumber,ot.selectionStart.startColumn)),gt=nt.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(ot.selectionStart.endLineNumber,ot.selectionStart.endColumn)),pt=new Range$2(ut.lineNumber,ut.column,gt.lineNumber,gt.column),mt=nt.coordinatesConverter.convertModelPositionToViewPosition(ot.position);rt=new SingleCursorState(pt,ot.selectionStartKind,ot.selectionStartLeftoverVisibleColumns,mt,ot.leftoverVisibleColumns)}this.modelState=ot,this.viewState=rt,this._updateTrackedRange(nt)}}class CursorCollection{constructor(nt){this.context=nt,this.cursors=[new Cursor(nt)],this.lastAddedCursorIndex=0}dispose(){for(const nt of this.cursors)nt.dispose(this.context)}startTrackingSelections(){for(const nt of this.cursors)nt.startTrackingSelection(this.context)}stopTrackingSelections(){for(const nt of this.cursors)nt.stopTrackingSelection(this.context)}updateContext(nt){this.context=nt}ensureValidState(){for(const nt of this.cursors)nt.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(nt=>nt.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(nt=>nt.asCursorState())}getViewPositions(){return this.cursors.map(nt=>nt.viewState.position)}getTopMostViewPosition(){return findMinBy(this.cursors,compareBy(nt=>nt.viewState.position,Position$1.compare)).viewState.position}getBottomMostViewPosition(){return findLastMaxBy(this.cursors,compareBy(nt=>nt.viewState.position,Position$1.compare)).viewState.position}getSelections(){return this.cursors.map(nt=>nt.modelState.selection)}getViewSelections(){return this.cursors.map(nt=>nt.viewState.selection)}setSelections(nt){this.setStates(CursorState$1.fromModelSelections(nt))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(nt){nt!==null&&(this.cursors[0].setState(this.context,nt[0].modelState,nt[0].viewState),this._setSecondaryStates(nt.slice(1)))}_setSecondaryStates(nt){const ot=this.cursors.length-1,rt=nt.length;if(ot<rt){const ut=rt-ot;for(let gt=0;gt<ut;gt++)this._addSecondaryCursor()}else if(ot>rt){const ut=ot-rt;for(let gt=0;gt<ut;gt++)this._removeSecondaryCursor(this.cursors.length-2)}for(let ut=0;ut<rt;ut++)this.cursors[ut+1].setState(this.context,nt[ut].modelState,nt[ut].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new Cursor(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(nt){this.lastAddedCursorIndex>=nt+1&&this.lastAddedCursorIndex--,this.cursors[nt+1].dispose(this.context),this.cursors.splice(nt+1,1)}normalize(){if(this.cursors.length===1)return;const nt=this.cursors.slice(0),ot=[];for(let rt=0,ut=nt.length;rt<ut;rt++)ot.push({index:rt,selection:nt[rt].modelState.selection});ot.sort(compareBy(rt=>rt.selection,Range$2.compareRangesUsingStarts));for(let rt=0;rt<ot.length-1;rt++){const ut=ot[rt],gt=ot[rt+1],pt=ut.selection,mt=gt.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let vt;if(mt.isEmpty()||pt.isEmpty()?vt=mt.getStartPosition().isBeforeOrEqual(pt.getEndPosition()):vt=mt.getStartPosition().isBefore(pt.getEndPosition()),vt){const St=ut.index<gt.index?rt:rt+1,yt=ut.index<gt.index?rt+1:rt,wt=ot[yt].index,Lt=ot[St].index,xt=ot[yt].selection,It=ot[St].selection;if(!xt.equalsSelection(It)){const kt=xt.plusRange(It),At=xt.selectionStartLineNumber===xt.startLineNumber&&xt.selectionStartColumn===xt.startColumn,Tt=It.selectionStartLineNumber===It.startLineNumber&&It.selectionStartColumn===It.startColumn;let Rt;wt===this.lastAddedCursorIndex?(Rt=At,this.lastAddedCursorIndex=Lt):Rt=Tt;let Nt;Rt?Nt=new Selection$1(kt.startLineNumber,kt.startColumn,kt.endLineNumber,kt.endColumn):Nt=new Selection$1(kt.endLineNumber,kt.endColumn,kt.startLineNumber,kt.startColumn),ot[St].selection=Nt;const Pt=CursorState$1.fromModelSelection(Nt);nt[Lt].setState(this.context,Pt.modelState,Pt.viewState)}for(const kt of ot)kt.index>wt&&kt.index--;nt.splice(wt,1),ot.splice(yt,1),this._removeSecondaryCursor(wt-1),rt--}}}}class CursorContext{constructor(nt,ot,rt,ut){this._cursorContextBrand=void 0,this.model=nt,this.viewModel=ot,this.coordinatesConverter=rt,this.cursorConfig=ut}}class ViewCompositionStartEvent{constructor(){this.type=0}}class ViewCompositionEndEvent{constructor(){this.type=1}}class ViewConfigurationChangedEvent{constructor(nt){this.type=2,this._source=nt}hasChanged(nt){return this._source.hasChanged(nt)}}class ViewCursorStateChangedEvent{constructor(nt,ot,rt){this.selections=nt,this.modelSelections=ot,this.reason=rt,this.type=3}}class ViewDecorationsChangedEvent{constructor(nt){this.type=4,nt?(this.affectsMinimap=nt.affectsMinimap,this.affectsOverviewRuler=nt.affectsOverviewRuler,this.affectsGlyphMargin=nt.affectsGlyphMargin):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0)}}class ViewFlushedEvent{constructor(){this.type=5}}class ViewFocusChangedEvent{constructor(nt){this.type=6,this.isFocused=nt}}class ViewLanguageConfigurationEvent{constructor(){this.type=7}}class ViewLineMappingChangedEvent{constructor(){this.type=8}}class ViewLinesChangedEvent{constructor(nt,ot){this.fromLineNumber=nt,this.count=ot,this.type=9}}class ViewLinesDeletedEvent{constructor(nt,ot){this.type=10,this.fromLineNumber=nt,this.toLineNumber=ot}}class ViewLinesInsertedEvent{constructor(nt,ot){this.type=11,this.fromLineNumber=nt,this.toLineNumber=ot}}class ViewRevealRangeRequestEvent{constructor(nt,ot,rt,ut,gt,pt,mt){this.source=nt,this.minimalReveal=ot,this.range=rt,this.selections=ut,this.verticalType=gt,this.revealHorizontal=pt,this.scrollType=mt,this.type=12}}class ViewScrollChangedEvent{constructor(nt){this.type=13,this.scrollWidth=nt.scrollWidth,this.scrollLeft=nt.scrollLeft,this.scrollHeight=nt.scrollHeight,this.scrollTop=nt.scrollTop,this.scrollWidthChanged=nt.scrollWidthChanged,this.scrollLeftChanged=nt.scrollLeftChanged,this.scrollHeightChanged=nt.scrollHeightChanged,this.scrollTopChanged=nt.scrollTopChanged}}class ViewThemeChangedEvent{constructor(nt){this.theme=nt,this.type=14}}class ViewTokensChangedEvent{constructor(nt){this.type=15,this.ranges=nt}}class ViewTokensColorsChangedEvent{constructor(){this.type=16}}let ViewZonesChangedEvent$1=class{constructor(){this.type=17}};class ViewModelEventDispatcher extends Disposable{constructor(){super(),this._onEvent=this._register(new Emitter$2),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(nt){this._addOutgoingEvent(nt),this._emitOutgoingEvents()}_addOutgoingEvent(nt){for(let ot=0,rt=this._outgoingEvents.length;ot<rt;ot++){const ut=this._outgoingEvents[ot].kind===nt.kind?this._outgoingEvents[ot].attemptToMerge(nt):null;if(ut){this._outgoingEvents[ot]=ut;return}}this._outgoingEvents.push(nt)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const nt=this._outgoingEvents.shift();nt.isNoOp()||this._onEvent.fire(nt)}}addViewEventHandler(nt){for(let ot=0,rt=this._eventHandlers.length;ot<rt;ot++)this._eventHandlers[ot]===nt&&console.warn("Detected duplicate listener in ViewEventDispatcher",nt);this._eventHandlers.push(nt)}removeViewEventHandler(nt){for(let ot=0;ot<this._eventHandlers.length;ot++)if(this._eventHandlers[ot]===nt){this._eventHandlers.splice(ot,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new ViewModelEventsCollector),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const nt=this._collector.outgoingEvents,ot=this._collector.viewEvents;this._collector=null;for(const rt of nt)this._addOutgoingEvent(rt);ot.length>0&&this._emitMany(ot)}this._emitOutgoingEvents()}emitSingleViewEvent(nt){try{this.beginEmitViewEvents().emitViewEvent(nt)}finally{this.endEmitViewEvents()}}_emitMany(nt){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(nt):this._viewEventQueue=nt,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const nt=this._viewEventQueue;this._viewEventQueue=null;const ot=this._eventHandlers.slice(0);for(const rt of ot)rt.handleEvents(nt)}}}class ViewModelEventsCollector{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(nt){this.viewEvents.push(nt)}emitOutgoingEvent(nt){this.outgoingEvents.push(nt)}}class ContentSizeChangedEvent{constructor(nt,ot,rt,ut){this.kind=0,this._oldContentWidth=nt,this._oldContentHeight=ot,this.contentWidth=rt,this.contentHeight=ut,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(nt){return nt.kind!==this.kind?null:new ContentSizeChangedEvent(this._oldContentWidth,this._oldContentHeight,nt.contentWidth,nt.contentHeight)}}class FocusChangedEvent{constructor(nt,ot){this.kind=1,this.oldHasFocus=nt,this.hasFocus=ot}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(nt){return nt.kind!==this.kind?null:new FocusChangedEvent(this.oldHasFocus,nt.hasFocus)}}class ScrollChangedEvent{constructor(nt,ot,rt,ut,gt,pt,mt,vt){this.kind=2,this._oldScrollWidth=nt,this._oldScrollLeft=ot,this._oldScrollHeight=rt,this._oldScrollTop=ut,this.scrollWidth=gt,this.scrollLeft=pt,this.scrollHeight=mt,this.scrollTop=vt,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(nt){return nt.kind!==this.kind?null:new ScrollChangedEvent(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,nt.scrollWidth,nt.scrollLeft,nt.scrollHeight,nt.scrollTop)}}class ViewZonesChangedEvent{constructor(){this.kind=3}isNoOp(){return!1}attemptToMerge(nt){return nt.kind!==this.kind?null:this}}class HiddenAreasChangedEvent{constructor(){this.kind=4}isNoOp(){return!1}attemptToMerge(nt){return nt.kind!==this.kind?null:this}}class CursorStateChangedEvent{constructor(nt,ot,rt,ut,gt,pt,mt){this.kind=6,this.oldSelections=nt,this.selections=ot,this.oldModelVersionId=rt,this.modelVersionId=ut,this.source=gt,this.reason=pt,this.reachedMaxCursorCount=mt}static _selectionsAreEqual(nt,ot){if(!nt&&!ot)return!0;if(!nt||!ot)return!1;const rt=nt.length,ut=ot.length;if(rt!==ut)return!1;for(let gt=0;gt<rt;gt++)if(!nt[gt].equalsSelection(ot[gt]))return!1;return!0}isNoOp(){return CursorStateChangedEvent._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(nt){return nt.kind!==this.kind?null:new CursorStateChangedEvent(this.oldSelections,nt.selections,this.oldModelVersionId,nt.modelVersionId,nt.source,nt.reason,this.reachedMaxCursorCount||nt.reachedMaxCursorCount)}}class ReadOnlyEditAttemptEvent{constructor(){this.kind=5}isNoOp(){return!1}attemptToMerge(nt){return nt.kind!==this.kind?null:this}}class ModelDecorationsChangedEvent{constructor(nt){this.event=nt,this.kind=7}isNoOp(){return!1}attemptToMerge(nt){return null}}class ModelLanguageChangedEvent{constructor(nt){this.event=nt,this.kind=8}isNoOp(){return!1}attemptToMerge(nt){return null}}class ModelLanguageConfigurationChangedEvent{constructor(nt){this.event=nt,this.kind=9}isNoOp(){return!1}attemptToMerge(nt){return null}}class ModelContentChangedEvent{constructor(nt){this.event=nt,this.kind=10}isNoOp(){return!1}attemptToMerge(nt){return null}}class ModelOptionsChangedEvent{constructor(nt){this.event=nt,this.kind=11}isNoOp(){return!1}attemptToMerge(nt){return null}}class ModelTokensChangedEvent{constructor(nt){this.event=nt,this.kind=12}isNoOp(){return!1}attemptToMerge(nt){return null}}class CursorsController extends Disposable{constructor(nt,ot,rt,ut){super(),this._model=nt,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=ot,this._coordinatesConverter=rt,this.context=new CursorContext(this._model,this._viewModel,this._coordinatesConverter,ut),this._cursors=new CursorCollection(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=dispose(this._autoClosedActions),super.dispose()}updateConfiguration(nt){this.context=new CursorContext(this._model,this._viewModel,this._coordinatesConverter,nt),this._cursors.updateContext(this.context)}onLineMappingChanged(nt){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(nt,"viewModel",0,this.getCursorStates())}setHasFocus(nt){this._hasFocus=nt}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const nt=this._cursors.getSelections();for(let ot=0;ot<this._autoClosedActions.length;ot++){const rt=this._autoClosedActions[ot];rt.isValid(nt)||(rt.dispose(),this._autoClosedActions.splice(ot,1),ot--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(nt,ot,rt,ut){let gt=!1;const pt=this.context.cursorConfig.multiCursorLimit;ut!==null&&ut.length>pt&&(ut=ut.slice(0,pt),gt=!0);const mt=CursorModelState.from(this._model,this);return this._cursors.setStates(ut),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(nt,ot,rt,mt,gt)}setCursorColumnSelectData(nt){this._columnSelectData=nt}revealPrimary(nt,ot,rt,ut,gt,pt){const mt=this._cursors.getViewPositions();let vt=null,St=null;mt.length>1?St=this._cursors.getViewSelections():vt=Range$2.fromPositions(mt[0],mt[0]),nt.emitViewEvent(new ViewRevealRangeRequestEvent(ot,rt,vt,St,ut,gt,pt))}saveState(){const nt=[],ot=this._cursors.getSelections();for(let rt=0,ut=ot.length;rt<ut;rt++){const gt=ot[rt];nt.push({inSelectionMode:!gt.isEmpty(),selectionStart:{lineNumber:gt.selectionStartLineNumber,column:gt.selectionStartColumn},position:{lineNumber:gt.positionLineNumber,column:gt.positionColumn}})}return nt}restoreState(nt,ot){const rt=[];for(let ut=0,gt=ot.length;ut<gt;ut++){const pt=ot[ut];let mt=1,vt=1;pt.position&&pt.position.lineNumber&&(mt=pt.position.lineNumber),pt.position&&pt.position.column&&(vt=pt.position.column);let St=mt,yt=vt;pt.selectionStart&&pt.selectionStart.lineNumber&&(St=pt.selectionStart.lineNumber),pt.selectionStart&&pt.selectionStart.column&&(yt=pt.selectionStart.column),rt.push({selectionStartLineNumber:St,selectionStartColumn:yt,positionLineNumber:mt,positionColumn:vt})}this.setStates(nt,"restoreState",0,CursorState$1.fromModelSelections(rt)),this.revealPrimary(nt,"restoreState",!1,0,!0,1)}onModelContentChanged(nt,ot){if(ot instanceof ModelInjectedTextChangedEvent){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(nt,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{const rt=ot.rawContentChangedEvent;if(this._knownModelVersionId=rt.versionId,this._isHandling)return;const ut=rt.containsEvent(1);if(this._prevEditOperationType=0,ut)this._cursors.dispose(),this._cursors=new CursorCollection(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(nt,"model",1,null,!1);else if(this._hasFocus&&rt.resultingSelection&&rt.resultingSelection.length>0){const gt=CursorState$1.fromModelSelections(rt.resultingSelection);this.setStates(nt,"modelChange",rt.isUndoing?5:rt.isRedoing?6:2,gt)&&this.revealPrimary(nt,"modelChange",!1,0,!0,0)}else{const gt=this._cursors.readSelectionFromMarkers();this.setStates(nt,"modelChange",2,CursorState$1.fromModelSelections(gt))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const nt=this._cursors.getPrimaryCursor(),ot=nt.viewState.selectionStart.getStartPosition(),rt=nt.viewState.position;return{isReal:!1,fromViewLineNumber:ot.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,ot),toViewLineNumber:rt.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,rt)}}getSelections(){return this._cursors.getSelections()}setSelections(nt,ot,rt,ut){this.setStates(nt,ot,ut,CursorState$1.fromModelSelections(rt))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(nt){this._prevEditOperationType=nt}_pushAutoClosedAction(nt,ot){const rt=[],ut=[];for(let mt=0,vt=nt.length;mt<vt;mt++)rt.push({range:nt[mt],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),ut.push({range:ot[mt],options:{description:"auto-closed-enclosing",stickiness:1}});const gt=this._model.deltaDecorations([],rt),pt=this._model.deltaDecorations([],ut);this._autoClosedActions.push(new AutoClosedAction(this._model,gt,pt))}_executeEditOperation(nt){if(!nt)return;nt.shouldPushStackElementBefore&&this._model.pushStackElement();const ot=CommandExecutor.executeCommands(this._model,this._cursors.getSelections(),nt.commands);if(ot){this._interpretCommandResult(ot);const rt=[],ut=[];for(let gt=0;gt<nt.commands.length;gt++){const pt=nt.commands[gt];pt instanceof TypeWithAutoClosingCommand&&pt.enclosingRange&&pt.closeCharacterRange&&(rt.push(pt.closeCharacterRange),ut.push(pt.enclosingRange))}rt.length>0&&this._pushAutoClosedAction(rt,ut),this._prevEditOperationType=nt.type}nt.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(nt){(!nt||nt.length===0)&&(nt=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(nt),this._cursors.normalize()}_emitStateChangedIfNecessary(nt,ot,rt,ut,gt){const pt=CursorModelState.from(this._model,this);if(pt.equals(ut))return!1;const mt=this._cursors.getSelections(),vt=this._cursors.getViewSelections();if(nt.emitViewEvent(new ViewCursorStateChangedEvent(vt,mt,rt)),!ut||ut.cursorState.length!==pt.cursorState.length||pt.cursorState.some((St,yt)=>!St.modelState.equals(ut.cursorState[yt].modelState))){const St=ut?ut.cursorState.map(wt=>wt.modelState.selection):null,yt=ut?ut.modelVersionId:0;nt.emitOutgoingEvent(new CursorStateChangedEvent(St,mt,yt,pt.modelVersionId,ot||"keyboard",rt,gt))}return!0}_findAutoClosingPairs(nt){if(!nt.length)return null;const ot=[];for(let rt=0,ut=nt.length;rt<ut;rt++){const gt=nt[rt];if(!gt.text||gt.text.indexOf(`
`)>=0)return null;const pt=gt.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!pt)return null;const mt=pt[1],vt=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(mt);if(!vt||vt.length!==1)return null;const St=vt[0].open,yt=gt.text.length-pt[2].length-1,wt=gt.text.lastIndexOf(St,yt-1);if(wt===-1)return null;ot.push([wt,yt])}return ot}executeEdits(nt,ot,rt,ut){let gt=null;ot==="snippet"&&(gt=this._findAutoClosingPairs(rt)),gt&&(rt[0]._isTracked=!0);const pt=[],mt=[],vt=this._model.pushEditOperations(this.getSelections(),rt,St=>{if(gt)for(let wt=0,Lt=gt.length;wt<Lt;wt++){const[xt,It]=gt[wt],kt=St[wt],At=kt.range.startLineNumber,Tt=kt.range.startColumn-1+xt,Rt=kt.range.startColumn-1+It;pt.push(new Range$2(At,Rt+1,At,Rt+2)),mt.push(new Range$2(At,Tt+1,At,Rt+2))}const yt=ut(St);return yt&&(this._isHandling=!0),yt});vt&&(this._isHandling=!1,this.setSelections(nt,ot,vt,0)),pt.length>0&&this._pushAutoClosedAction(pt,mt)}_executeEdit(nt,ot,rt,ut=0){if(this.context.cursorConfig.readOnly)return;const gt=CursorModelState.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),nt()}catch(pt){onUnexpectedError(pt)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(ot,rt,ut,gt,!1)&&this.revealPrimary(ot,rt,!1,0,!0,0)}getAutoClosedCharacters(){return AutoClosedAction.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(nt){this._compositionState=new CompositionState(this._model,this.getSelections())}endComposition(nt,ot){const rt=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{ot==="keyboard"&&this._executeEditOperation(TypeOperations.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,rt,this.getSelections(),this.getAutoClosedCharacters()))},nt,ot)}type(nt,ot,rt){this._executeEdit(()=>{if(rt==="keyboard"){const ut=ot.length;let gt=0;for(;gt<ut;){const pt=nextCharLength(ot,gt),mt=ot.substr(gt,pt);this._executeEditOperation(TypeOperations.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),mt)),gt+=pt}}else this._executeEditOperation(TypeOperations.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),ot))},nt,rt)}compositionType(nt,ot,rt,ut,gt,pt){if(ot.length===0&&rt===0&&ut===0){if(gt!==0){const mt=this.getSelections().map(vt=>{const St=vt.getPosition();return new Selection$1(St.lineNumber,St.column+gt,St.lineNumber,St.column+gt)});this.setSelections(nt,pt,mt,0)}return}this._executeEdit(()=>{this._executeEditOperation(TypeOperations.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),ot,rt,ut,gt))},nt,pt)}paste(nt,ot,rt,ut,gt){this._executeEdit(()=>{this._executeEditOperation(TypeOperations.paste(this.context.cursorConfig,this._model,this.getSelections(),ot,rt,ut||[]))},nt,gt,4)}cut(nt,ot){this._executeEdit(()=>{this._executeEditOperation(DeleteOperations.cut(this.context.cursorConfig,this._model,this.getSelections()))},nt,ot)}executeCommand(nt,ot,rt){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new EditOperationResult(0,[ot],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},nt,rt)}executeCommands(nt,ot,rt){this._executeEdit(()=>{this._executeEditOperation(new EditOperationResult(0,ot,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},nt,rt)}}class CursorModelState{static from(nt,ot){return new CursorModelState(nt.getVersionId(),ot.getCursorStates())}constructor(nt,ot){this.modelVersionId=nt,this.cursorState=ot}equals(nt){if(!nt||this.modelVersionId!==nt.modelVersionId||this.cursorState.length!==nt.cursorState.length)return!1;for(let ot=0,rt=this.cursorState.length;ot<rt;ot++)if(!this.cursorState[ot].equals(nt.cursorState[ot]))return!1;return!0}}class AutoClosedAction{static getAllAutoClosedCharacters(nt){let ot=[];for(const rt of nt)ot=ot.concat(rt.getAutoClosedCharactersRanges());return ot}constructor(nt,ot,rt){this._model=nt,this._autoClosedCharactersDecorations=ot,this._autoClosedEnclosingDecorations=rt}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const nt=[];for(let ot=0;ot<this._autoClosedCharactersDecorations.length;ot++){const rt=this._model.getDecorationRange(this._autoClosedCharactersDecorations[ot]);rt&&nt.push(rt)}return nt}isValid(nt){const ot=[];for(let rt=0;rt<this._autoClosedEnclosingDecorations.length;rt++){const ut=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[rt]);if(ut&&(ot.push(ut),ut.startLineNumber!==ut.endLineNumber))return!1}ot.sort(Range$2.compareRangesUsingStarts),nt.sort(Range$2.compareRangesUsingStarts);for(let rt=0;rt<nt.length;rt++)if(rt>=ot.length||!ot[rt].strictContainsRange(nt[rt]))return!1;return!0}}class CommandExecutor{static executeCommands(nt,ot,rt){const ut={model:nt,selectionsBefore:ot,trackedRanges:[],trackedRangesDirection:[]},gt=this._innerExecuteCommands(ut,rt);for(let pt=0,mt=ut.trackedRanges.length;pt<mt;pt++)ut.model._setTrackedRange(ut.trackedRanges[pt],null,0);return gt}static _innerExecuteCommands(nt,ot){if(this._arrayIsEmpty(ot))return null;const rt=this._getEditOperations(nt,ot);if(rt.operations.length===0)return null;const ut=rt.operations,gt=this._getLoserCursorMap(ut);if(gt.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const pt=[];for(let St=0,yt=ut.length;St<yt;St++)gt.hasOwnProperty(ut[St].identifier.major.toString())||pt.push(ut[St]);rt.hadTrackedEditOperation&&pt.length>0&&(pt[0]._isTracked=!0);let mt=nt.model.pushEditOperations(nt.selectionsBefore,pt,St=>{const yt=[];for(let xt=0;xt<nt.selectionsBefore.length;xt++)yt[xt]=[];for(const xt of St)xt.identifier&&yt[xt.identifier.major].push(xt);const wt=(xt,It)=>xt.identifier.minor-It.identifier.minor,Lt=[];for(let xt=0;xt<nt.selectionsBefore.length;xt++)yt[xt].length>0?(yt[xt].sort(wt),Lt[xt]=ot[xt].computeCursorState(nt.model,{getInverseEditOperations:()=>yt[xt],getTrackedSelection:It=>{const kt=parseInt(It,10),At=nt.model._getTrackedRange(nt.trackedRanges[kt]);return nt.trackedRangesDirection[kt]===0?new Selection$1(At.startLineNumber,At.startColumn,At.endLineNumber,At.endColumn):new Selection$1(At.endLineNumber,At.endColumn,At.startLineNumber,At.startColumn)}})):Lt[xt]=nt.selectionsBefore[xt];return Lt});mt||(mt=nt.selectionsBefore);const vt=[];for(const St in gt)gt.hasOwnProperty(St)&&vt.push(parseInt(St,10));vt.sort((St,yt)=>yt-St);for(const St of vt)mt.splice(St,1);return mt}static _arrayIsEmpty(nt){for(let ot=0,rt=nt.length;ot<rt;ot++)if(nt[ot])return!1;return!0}static _getEditOperations(nt,ot){let rt=[],ut=!1;for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt];if(mt){const vt=this._getEditOperationsFromCommand(nt,gt,mt);rt=rt.concat(vt.operations),ut=ut||vt.hadTrackedEditOperation}}return{operations:rt,hadTrackedEditOperation:ut}}static _getEditOperationsFromCommand(nt,ot,rt){const ut=[];let gt=0;const pt=(wt,Lt,xt=!1)=>{Range$2.isEmpty(wt)&&Lt===""||ut.push({identifier:{major:ot,minor:gt++},range:wt,text:Lt,forceMoveMarkers:xt,isAutoWhitespaceEdit:rt.insertsAutoWhitespace})};let mt=!1;const yt={addEditOperation:pt,addTrackedEditOperation:(wt,Lt,xt)=>{mt=!0,pt(wt,Lt,xt)},trackSelection:(wt,Lt)=>{const xt=Selection$1.liftSelection(wt);let It;if(xt.isEmpty())if(typeof Lt=="boolean")Lt?It=2:It=3;else{const Tt=nt.model.getLineMaxColumn(xt.startLineNumber);xt.startColumn===Tt?It=2:It=3}else It=1;const kt=nt.trackedRanges.length,At=nt.model._setTrackedRange(null,xt,It);return nt.trackedRanges[kt]=At,nt.trackedRangesDirection[kt]=xt.getDirection(),kt.toString()}};try{rt.getEditOperations(nt.model,yt)}catch(wt){return onUnexpectedError(wt),{operations:[],hadTrackedEditOperation:!1}}return{operations:ut,hadTrackedEditOperation:mt}}static _getLoserCursorMap(nt){nt=nt.slice(0),nt.sort((rt,ut)=>-Range$2.compareRangesUsingEnds(rt.range,ut.range));const ot={};for(let rt=1;rt<nt.length;rt++){const ut=nt[rt-1],gt=nt[rt];if(Range$2.getStartPosition(ut.range).isBefore(Range$2.getEndPosition(gt.range))){let pt;ut.identifier.major>gt.identifier.major?pt=ut.identifier.major:pt=gt.identifier.major,ot[pt.toString()]=!0;for(let mt=0;mt<nt.length;mt++)nt[mt].identifier.major===pt&&(nt.splice(mt,1),mt<rt&&rt--,mt--);rt>0&&rt--}}return ot}}class CompositionLineState{constructor(nt,ot,rt){this.text=nt,this.startSelection=ot,this.endSelection=rt}}class CompositionState{static _capture(nt,ot){const rt=[];for(const ut of ot){if(ut.startLineNumber!==ut.endLineNumber)return null;rt.push(new CompositionLineState(nt.getLineContent(ut.startLineNumber),ut.startColumn-1,ut.endColumn-1))}return rt}constructor(nt,ot){this._original=CompositionState._capture(nt,ot)}deduceOutcome(nt,ot){if(!this._original)return null;const rt=CompositionState._capture(nt,ot);if(!rt||this._original.length!==rt.length)return null;const ut=[];for(let gt=0,pt=this._original.length;gt<pt;gt++)ut.push(CompositionState._deduceOutcome(this._original[gt],rt[gt]));return ut}static _deduceOutcome(nt,ot){const rt=Math.min(nt.startSelection,ot.startSelection,commonPrefixLength(nt.text,ot.text)),ut=Math.min(nt.text.length-nt.endSelection,ot.text.length-ot.endSelection,commonSuffixLength(nt.text,ot.text)),gt=nt.text.substring(rt,nt.text.length-ut),pt=ot.text.substring(rt,ot.text.length-ut);return new CompositionOutcome(gt,nt.startSelection-rt,nt.endSelection-rt,pt,ot.startSelection-rt,ot.endSelection-rt)}}var __awaiter$1p=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const fallback={getInitialState:()=>NullState,tokenizeEncoded:(ct,nt,ot)=>nullTokenizeEncoded(0,ot)};function tokenizeToString(ct,nt,ot){return __awaiter$1p(this,void 0,void 0,function*(){if(!ot)return _tokenizeToString(nt,ct.languageIdCodec,fallback);const rt=yield TokenizationRegistry.getOrCreate(ot);return _tokenizeToString(nt,ct.languageIdCodec,rt||fallback)})}function tokenizeLineToHTML(ct,nt,ot,rt,ut,gt,pt){let mt="<div>",vt=rt,St=0,yt=!0;for(let wt=0,Lt=nt.getCount();wt<Lt;wt++){const xt=nt.getEndOffset(wt);if(xt<=rt)continue;let It="";for(;vt<xt&&vt<ut;vt++){const kt=ct.charCodeAt(vt);switch(kt){case 9:{let At=gt-(vt+St)%gt;for(St+=At-1;At>0;)pt&&yt?(It+="&#160;",yt=!1):(It+=" ",yt=!0),At--;break}case 60:It+="&lt;",yt=!1;break;case 62:It+="&gt;",yt=!1;break;case 38:It+="&amp;",yt=!1;break;case 0:It+="&#00;",yt=!1;break;case 65279:case 8232:case 8233:case 133:It+="",yt=!1;break;case 13:It+="&#8203",yt=!1;break;case 32:pt&&yt?(It+="&#160;",yt=!1):(It+=" ",yt=!0);break;default:It+=String.fromCharCode(kt),yt=!1}}if(mt+=`<span style="${nt.getInlineStyle(wt,ot)}">${It}</span>`,xt>ut||vt>=ut)break}return mt+="</div>",mt}function _tokenizeToString(ct,nt,ot){let rt='<div class="monaco-tokenized-source">';const ut=splitLines(ct);let gt=ot.getInitialState();for(let pt=0,mt=ut.length;pt<mt;pt++){const vt=ut[pt];pt>0&&(rt+="<br/>");const St=ot.tokenizeEncoded(vt,!0,gt);LineTokens.convertToEndOffset(St.tokens,vt.length);const wt=new LineTokens(St.tokens,vt,nt).inflate();let Lt=0;for(let xt=0,It=wt.getCount();xt<It;xt++){const kt=wt.getClassName(xt),At=wt.getEndOffset(xt);rt+=`<span class="${kt}">${escape$1(vt.substring(Lt,At))}</span>`,Lt=At}gt=St.endState}return rt+="</div>",rt}class PendingChanges{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(nt){this._hasPending=!0,this._inserts.push(nt)}change(nt){this._hasPending=!0,this._changes.push(nt)}remove(nt){this._hasPending=!0,this._removes.push(nt)}mustCommit(){return this._hasPending}commit(nt){if(!this._hasPending)return;const ot=this._inserts,rt=this._changes,ut=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],nt._commitPendingChanges(ot,rt,ut)}}class EditorWhitespace{constructor(nt,ot,rt,ut,gt){this.id=nt,this.afterLineNumber=ot,this.ordinal=rt,this.height=ut,this.minWidth=gt,this.prefixSum=0}}class LinesLayout{constructor(nt,ot,rt,ut){this._instanceId=singleLetterHash(++LinesLayout.INSTANCE_COUNT),this._pendingChanges=new PendingChanges,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=nt,this._lineHeight=ot,this._paddingTop=rt,this._paddingBottom=ut}static findInsertionIndex(nt,ot,rt){let ut=0,gt=nt.length;for(;ut<gt;){const pt=ut+gt>>>1;ot===nt[pt].afterLineNumber?rt<nt[pt].ordinal?gt=pt:ut=pt+1:ot<nt[pt].afterLineNumber?gt=pt:ut=pt+1}return ut}setLineHeight(nt){this._checkPendingChanges(),this._lineHeight=nt}setPadding(nt,ot){this._paddingTop=nt,this._paddingBottom=ot}onFlushed(nt){this._checkPendingChanges(),this._lineCount=nt}changeWhitespace(nt){let ot=!1;try{nt({insertWhitespace:(ut,gt,pt,mt)=>{ot=!0,ut=ut|0,gt=gt|0,pt=pt|0,mt=mt|0;const vt=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new EditorWhitespace(vt,ut,gt,pt,mt)),vt},changeOneWhitespace:(ut,gt,pt)=>{ot=!0,gt=gt|0,pt=pt|0,this._pendingChanges.change({id:ut,newAfterLineNumber:gt,newHeight:pt})},removeWhitespace:ut=>{ot=!0,this._pendingChanges.remove({id:ut})}})}finally{this._pendingChanges.commit(this)}return ot}_commitPendingChanges(nt,ot,rt){if((nt.length>0||rt.length>0)&&(this._minWidth=-1),nt.length+ot.length+rt.length<=1){for(const vt of nt)this._insertWhitespace(vt);for(const vt of ot)this._changeOneWhitespace(vt.id,vt.newAfterLineNumber,vt.newHeight);for(const vt of rt){const St=this._findWhitespaceIndex(vt.id);St!==-1&&this._removeWhitespace(St)}return}const ut=new Set;for(const vt of rt)ut.add(vt.id);const gt=new Map;for(const vt of ot)gt.set(vt.id,vt);const pt=vt=>{const St=[];for(const yt of vt)if(!ut.has(yt.id)){if(gt.has(yt.id)){const wt=gt.get(yt.id);yt.afterLineNumber=wt.newAfterLineNumber,yt.height=wt.newHeight}St.push(yt)}return St},mt=pt(this._arr).concat(pt(nt));mt.sort((vt,St)=>vt.afterLineNumber===St.afterLineNumber?vt.ordinal-St.ordinal:vt.afterLineNumber-St.afterLineNumber),this._arr=mt,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(nt){const ot=LinesLayout.findInsertionIndex(this._arr,nt.afterLineNumber,nt.ordinal);this._arr.splice(ot,0,nt),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,ot-1)}_findWhitespaceIndex(nt){const ot=this._arr;for(let rt=0,ut=ot.length;rt<ut;rt++)if(ot[rt].id===nt)return rt;return-1}_changeOneWhitespace(nt,ot,rt){const ut=this._findWhitespaceIndex(nt);if(ut!==-1&&(this._arr[ut].height!==rt&&(this._arr[ut].height=rt,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,ut-1)),this._arr[ut].afterLineNumber!==ot)){const gt=this._arr[ut];this._removeWhitespace(ut),gt.afterLineNumber=ot,this._insertWhitespace(gt)}}_removeWhitespace(nt){this._arr.splice(nt,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,nt-1)}onLinesDeleted(nt,ot){this._checkPendingChanges(),nt=nt|0,ot=ot|0,this._lineCount-=ot-nt+1;for(let rt=0,ut=this._arr.length;rt<ut;rt++){const gt=this._arr[rt].afterLineNumber;nt<=gt&&gt<=ot?this._arr[rt].afterLineNumber=nt-1:gt>ot&&(this._arr[rt].afterLineNumber-=ot-nt+1)}}onLinesInserted(nt,ot){this._checkPendingChanges(),nt=nt|0,ot=ot|0,this._lineCount+=ot-nt+1;for(let rt=0,ut=this._arr.length;rt<ut;rt++){const gt=this._arr[rt].afterLineNumber;nt<=gt&&(this._arr[rt].afterLineNumber+=ot-nt+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(nt){this._checkPendingChanges(),nt=nt|0;let ot=Math.max(0,this._prefixSumValidIndex+1);ot===0&&(this._arr[0].prefixSum=this._arr[0].height,ot++);for(let rt=ot;rt<=nt;rt++)this._arr[rt].prefixSum=this._arr[rt-1].prefixSum+this._arr[rt].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,nt),this._arr[nt].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();const nt=this._lineHeight*this._lineCount,ot=this.getWhitespacesTotalHeight();return nt+ot+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(nt){this._checkPendingChanges(),nt=nt|0;const ot=this._findLastWhitespaceBeforeLineNumber(nt);return ot===-1?0:this.getWhitespacesAccumulatedHeight(ot)}_findLastWhitespaceBeforeLineNumber(nt){nt=nt|0;const ot=this._arr;let rt=0,ut=ot.length-1;for(;rt<=ut;){const pt=(ut-rt|0)/2|0,mt=rt+pt|0;if(ot[mt].afterLineNumber<nt){if(mt+1>=ot.length||ot[mt+1].afterLineNumber>=nt)return mt;rt=mt+1|0}else ut=mt-1|0}return-1}_findFirstWhitespaceAfterLineNumber(nt){nt=nt|0;const rt=this._findLastWhitespaceBeforeLineNumber(nt)+1;return rt<this._arr.length?rt:-1}getFirstWhitespaceIndexAfterLineNumber(nt){return this._checkPendingChanges(),nt=nt|0,this._findFirstWhitespaceAfterLineNumber(nt)}getVerticalOffsetForLineNumber(nt,ot=!1){this._checkPendingChanges(),nt=nt|0;let rt;nt>1?rt=this._lineHeight*(nt-1):rt=0;const ut=this.getWhitespaceAccumulatedHeightBeforeLineNumber(nt-(ot?1:0));return rt+ut+this._paddingTop}getVerticalOffsetAfterLineNumber(nt,ot=!1){this._checkPendingChanges(),nt=nt|0;const rt=this._lineHeight*nt,ut=this.getWhitespaceAccumulatedHeightBeforeLineNumber(nt+(ot?1:0));return rt+ut+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let nt=0;for(let ot=0,rt=this._arr.length;ot<rt;ot++)nt=Math.max(nt,this._arr[ot].minWidth);this._minWidth=nt}return this._minWidth}isAfterLines(nt){this._checkPendingChanges();const ot=this.getLinesTotalHeight();return nt>ot}isInTopPadding(nt){return this._paddingTop===0?!1:(this._checkPendingChanges(),nt<this._paddingTop)}isInBottomPadding(nt){if(this._paddingBottom===0)return!1;this._checkPendingChanges();const ot=this.getLinesTotalHeight();return nt>=ot-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(nt){if(this._checkPendingChanges(),nt=nt|0,nt<0)return 1;const ot=this._lineCount|0,rt=this._lineHeight;let ut=1,gt=ot;for(;ut<gt;){const pt=(ut+gt)/2|0,mt=this.getVerticalOffsetForLineNumber(pt)|0;if(nt>=mt+rt)ut=pt+1;else{if(nt>=mt)return pt;gt=pt}}return ut>ot?ot:ut}getLinesViewportData(nt,ot){this._checkPendingChanges(),nt=nt|0,ot=ot|0;const rt=this._lineHeight,ut=this.getLineNumberAtOrAfterVerticalOffset(nt)|0,gt=this.getVerticalOffsetForLineNumber(ut)|0;let pt=this._lineCount|0,mt=this.getFirstWhitespaceIndexAfterLineNumber(ut)|0;const vt=this.getWhitespacesCount()|0;let St,yt;mt===-1?(mt=vt,yt=pt+1,St=0):(yt=this.getAfterLineNumberForWhitespaceIndex(mt)|0,St=this.getHeightForWhitespaceIndex(mt)|0);let wt=gt,Lt=wt;const xt=5e5;let It=0;gt>=xt&&(It=Math.floor(gt/xt)*xt,It=Math.floor(It/rt)*rt,Lt-=It);const kt=[],At=nt+(ot-nt)/2;let Tt=-1;for(let Ft=ut;Ft<=pt;Ft++){if(Tt===-1){const Kt=wt,Bt=wt+rt;(Kt<=At&&At<Bt||Kt>At)&&(Tt=Ft)}for(wt+=rt,kt[Ft-ut]=Lt,Lt+=rt;yt===Ft;)Lt+=St,wt+=St,mt++,mt>=vt?yt=pt+1:(yt=this.getAfterLineNumberForWhitespaceIndex(mt)|0,St=this.getHeightForWhitespaceIndex(mt)|0);if(wt>=ot){pt=Ft;break}}Tt===-1&&(Tt=pt);const Rt=this.getVerticalOffsetForLineNumber(pt)|0;let Nt=ut,Pt=pt;return Nt<Pt&&gt<nt&&Nt++,Nt<Pt&&Rt+rt>ot&&Pt--,{bigNumbersDelta:It,startLineNumber:ut,endLineNumber:pt,relativeVerticalOffset:kt,centeredLineNumber:Tt,completelyVisibleStartLineNumber:Nt,completelyVisibleEndLineNumber:Pt}}getVerticalOffsetForWhitespaceIndex(nt){this._checkPendingChanges(),nt=nt|0;const ot=this.getAfterLineNumberForWhitespaceIndex(nt);let rt;ot>=1?rt=this._lineHeight*ot:rt=0;let ut;return nt>0?ut=this.getWhitespacesAccumulatedHeight(nt-1):ut=0,rt+ut+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(nt){this._checkPendingChanges(),nt=nt|0;let ot=0,rt=this.getWhitespacesCount()-1;if(rt<0)return-1;const ut=this.getVerticalOffsetForWhitespaceIndex(rt),gt=this.getHeightForWhitespaceIndex(rt);if(nt>=ut+gt)return-1;for(;ot<rt;){const pt=Math.floor((ot+rt)/2),mt=this.getVerticalOffsetForWhitespaceIndex(pt),vt=this.getHeightForWhitespaceIndex(pt);if(nt>=mt+vt)ot=pt+1;else{if(nt>=mt)return pt;rt=pt}}return ot}getWhitespaceAtVerticalOffset(nt){this._checkPendingChanges(),nt=nt|0;const ot=this.getWhitespaceIndexAtOrAfterVerticallOffset(nt);if(ot<0||ot>=this.getWhitespacesCount())return null;const rt=this.getVerticalOffsetForWhitespaceIndex(ot);if(rt>nt)return null;const ut=this.getHeightForWhitespaceIndex(ot),gt=this.getIdForWhitespaceIndex(ot),pt=this.getAfterLineNumberForWhitespaceIndex(ot);return{id:gt,afterLineNumber:pt,verticalOffset:rt,height:ut}}getWhitespaceViewportData(nt,ot){this._checkPendingChanges(),nt=nt|0,ot=ot|0;const rt=this.getWhitespaceIndexAtOrAfterVerticallOffset(nt),ut=this.getWhitespacesCount()-1;if(rt<0)return[];const gt=[];for(let pt=rt;pt<=ut;pt++){const mt=this.getVerticalOffsetForWhitespaceIndex(pt),vt=this.getHeightForWhitespaceIndex(pt);if(mt>=ot)break;gt.push({id:this.getIdForWhitespaceIndex(pt),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(pt),verticalOffset:mt,height:vt})}return gt}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(nt){return this._checkPendingChanges(),nt=nt|0,this._arr[nt].id}getAfterLineNumberForWhitespaceIndex(nt){return this._checkPendingChanges(),nt=nt|0,this._arr[nt].afterLineNumber}getHeightForWhitespaceIndex(nt){return this._checkPendingChanges(),nt=nt|0,this._arr[nt].height}}LinesLayout.INSTANCE_COUNT=0;const SMOOTH_SCROLLING_TIME=125;class EditorScrollDimensions{constructor(nt,ot,rt,ut){nt=nt|0,ot=ot|0,rt=rt|0,ut=ut|0,nt<0&&(nt=0),ot<0&&(ot=0),rt<0&&(rt=0),ut<0&&(ut=0),this.width=nt,this.contentWidth=ot,this.scrollWidth=Math.max(nt,ot),this.height=rt,this.contentHeight=ut,this.scrollHeight=Math.max(rt,ut)}equals(nt){return this.width===nt.width&&this.contentWidth===nt.contentWidth&&this.height===nt.height&&this.contentHeight===nt.contentHeight}}class EditorScrollable extends Disposable{constructor(nt,ot){super(),this._onDidContentSizeChange=this._register(new Emitter$2),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new EditorScrollDimensions(0,0,0,0),this._scrollable=this._register(new Scrollable({forceIntegerValues:!0,smoothScrollDuration:nt,scheduleAtNextAnimationFrame:ot})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(nt){this._scrollable.setSmoothScrollDuration(nt)}validateScrollPosition(nt){return this._scrollable.validateScrollPosition(nt)}getScrollDimensions(){return this._dimensions}setScrollDimensions(nt){if(this._dimensions.equals(nt))return;const ot=this._dimensions;this._dimensions=nt,this._scrollable.setScrollDimensions({width:nt.width,scrollWidth:nt.scrollWidth,height:nt.height,scrollHeight:nt.scrollHeight},!0);const rt=ot.contentWidth!==nt.contentWidth,ut=ot.contentHeight!==nt.contentHeight;(rt||ut)&&this._onDidContentSizeChange.fire(new ContentSizeChangedEvent(ot.contentWidth,ot.contentHeight,nt.contentWidth,nt.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(nt){this._scrollable.setScrollPositionNow(nt)}setScrollPositionSmooth(nt){this._scrollable.setScrollPositionSmooth(nt)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}}class ViewLayout extends Disposable{constructor(nt,ot,rt){super(),this._configuration=nt;const ut=this._configuration.options,gt=ut.get(139),pt=ut.get(81);this._linesLayout=new LinesLayout(ot,ut.get(64),pt.top,pt.bottom),this._scrollable=this._register(new EditorScrollable(0,rt)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new EditorScrollDimensions(gt.contentWidth,0,gt.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(109)?SMOOTH_SCROLLING_TIME:0)}onConfigurationChanged(nt){const ot=this._configuration.options;if(nt.hasChanged(64)&&this._linesLayout.setLineHeight(ot.get(64)),nt.hasChanged(81)){const rt=ot.get(81);this._linesLayout.setPadding(rt.top,rt.bottom)}if(nt.hasChanged(139)){const rt=ot.get(139),ut=rt.contentWidth,gt=rt.height,pt=this._scrollable.getScrollDimensions(),mt=pt.contentWidth;this._scrollable.setScrollDimensions(new EditorScrollDimensions(ut,pt.contentWidth,gt,this._getContentHeight(ut,gt,mt)))}else this._updateHeight();nt.hasChanged(109)&&this._configureSmoothScrollDuration()}onFlushed(nt){this._linesLayout.onFlushed(nt)}onLinesDeleted(nt,ot){this._linesLayout.onLinesDeleted(nt,ot)}onLinesInserted(nt,ot){this._linesLayout.onLinesInserted(nt,ot)}_getHorizontalScrollbarHeight(nt,ot){const ut=this._configuration.options.get(98);return ut.horizontal===2||nt>=ot?0:ut.horizontalScrollbarSize}_getContentHeight(nt,ot,rt){const ut=this._configuration.options;let gt=this._linesLayout.getLinesTotalHeight();return ut.get(100)?gt+=Math.max(0,ot-ut.get(64)-ut.get(81).bottom):gt+=this._getHorizontalScrollbarHeight(nt,rt),gt}_updateHeight(){const nt=this._scrollable.getScrollDimensions(),ot=nt.width,rt=nt.height,ut=nt.contentWidth;this._scrollable.setScrollDimensions(new EditorScrollDimensions(ot,nt.contentWidth,rt,this._getContentHeight(ot,rt,ut)))}getCurrentViewport(){const nt=this._scrollable.getScrollDimensions(),ot=this._scrollable.getCurrentScrollPosition();return new Viewport(ot.scrollTop,ot.scrollLeft,nt.width,nt.height)}getFutureViewport(){const nt=this._scrollable.getScrollDimensions(),ot=this._scrollable.getFutureScrollPosition();return new Viewport(ot.scrollTop,ot.scrollLeft,nt.width,nt.height)}_computeContentWidth(nt){const ot=this._configuration.options,rt=ot.get(140),ut=ot.get(48),gt=ot.get(139);if(rt.isViewportWrapping){const pt=ot.get(70);return nt>gt.contentWidth+ut.typicalHalfwidthCharacterWidth&&pt.enabled&&pt.side==="right"?nt+gt.verticalScrollbarWidth:nt}else{const pt=ot.get(99)*ut.typicalHalfwidthCharacterWidth,mt=this._linesLayout.getWhitespaceMinWidth();return Math.max(nt+pt+gt.verticalScrollbarWidth,mt)}}setMaxLineWidth(nt){const ot=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new EditorScrollDimensions(ot.width,this._computeContentWidth(nt),ot.height,ot.contentHeight)),this._updateHeight()}saveState(){const nt=this._scrollable.getFutureScrollPosition(),ot=nt.scrollTop,rt=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(ot),ut=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(rt);return{scrollTop:ot,scrollTopWithoutViewZones:ot-ut,scrollLeft:nt.scrollLeft}}changeWhitespace(nt){const ot=this._linesLayout.changeWhitespace(nt);return ot&&this.onHeightMaybeChanged(),ot}getVerticalOffsetForLineNumber(nt,ot=!1){return this._linesLayout.getVerticalOffsetForLineNumber(nt,ot)}getVerticalOffsetAfterLineNumber(nt,ot=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(nt,ot)}isAfterLines(nt){return this._linesLayout.isAfterLines(nt)}isInTopPadding(nt){return this._linesLayout.isInTopPadding(nt)}isInBottomPadding(nt){return this._linesLayout.isInBottomPadding(nt)}getLineNumberAtVerticalOffset(nt){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(nt)}getWhitespaceAtVerticalOffset(nt){return this._linesLayout.getWhitespaceAtVerticalOffset(nt)}getLinesViewportData(){const nt=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(nt.top,nt.top+nt.height)}getLinesViewportDataAtScrollTop(nt){const ot=this._scrollable.getScrollDimensions();return nt+ot.height>ot.scrollHeight&&(nt=ot.scrollHeight-ot.height),nt<0&&(nt=0),this._linesLayout.getLinesViewportData(nt,nt+ot.height)}getWhitespaceViewportData(){const nt=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(nt.top,nt.top+nt.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(nt){return this._scrollable.validateScrollPosition(nt)}setScrollPosition(nt,ot){ot===1?this._scrollable.setScrollPositionNow(nt):this._scrollable.setScrollPositionSmooth(nt)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(nt,ot){const rt=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:rt.scrollLeft+nt,scrollTop:rt.scrollTop+ot})}}class ViewModelDecorations{constructor(nt,ot,rt,ut,gt){this.editorId=nt,this.model=ot,this.configuration=rt,this._linesCollection=ut,this._coordinatesConverter=gt,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(nt){const ot=nt.id;let rt=this._decorationsCache[ot];if(!rt){const ut=nt.range,gt=nt.options;let pt;if(gt.isWholeLine){const mt=this._coordinatesConverter.convertModelPositionToViewPosition(new Position$1(ut.startLineNumber,1),0),vt=this._coordinatesConverter.convertModelPositionToViewPosition(new Position$1(ut.endLineNumber,this.model.getLineMaxColumn(ut.endLineNumber)),1);pt=new Range$2(mt.lineNumber,mt.column,vt.lineNumber,vt.column)}else pt=this._coordinatesConverter.convertModelRangeToViewRange(ut,1);rt=new ViewModelDecoration(pt,gt),this._decorationsCache[ot]=rt}return rt}getMinimapDecorationsInRange(nt){return this._getDecorationsInRange(nt,!0,!1).decorations}getDecorationsViewportData(nt){let ot=this._cachedModelDecorationsResolver!==null;return ot=ot&&nt.equalsRange(this._cachedModelDecorationsResolverViewRange),ot||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(nt,!1,!1),this._cachedModelDecorationsResolverViewRange=nt),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(nt,ot=!1,rt=!1){const ut=new Range$2(nt,this._linesCollection.getViewLineMinColumn(nt),nt,this._linesCollection.getViewLineMaxColumn(nt));return this._getDecorationsInRange(ut,ot,rt).inlineDecorations[0]}_getDecorationsInRange(nt,ot,rt){const ut=this._linesCollection.getDecorationsInRange(nt,this.editorId,filterValidationDecorations(this.configuration.options),ot,rt),gt=nt.startLineNumber,pt=nt.endLineNumber,mt=[];let vt=0;const St=[];for(let yt=gt;yt<=pt;yt++)St[yt-gt]=[];for(let yt=0,wt=ut.length;yt<wt;yt++){const Lt=ut[yt],xt=Lt.options;if(!isModelDecorationVisible(this.model,Lt))continue;const It=this._getOrCreateViewModelDecoration(Lt),kt=It.range;if(mt[vt++]=It,xt.inlineClassName){const At=new InlineDecoration(kt,xt.inlineClassName,xt.inlineClassNameAffectsLetterSpacing?3:0),Tt=Math.max(gt,kt.startLineNumber),Rt=Math.min(pt,kt.endLineNumber);for(let Nt=Tt;Nt<=Rt;Nt++)St[Nt-gt].push(At)}if(xt.beforeContentClassName&&gt<=kt.startLineNumber&&kt.startLineNumber<=pt){const At=new InlineDecoration(new Range$2(kt.startLineNumber,kt.startColumn,kt.startLineNumber,kt.startColumn),xt.beforeContentClassName,1);St[kt.startLineNumber-gt].push(At)}if(xt.afterContentClassName&&gt<=kt.endLineNumber&&kt.endLineNumber<=pt){const At=new InlineDecoration(new Range$2(kt.endLineNumber,kt.endColumn,kt.endLineNumber,kt.endColumn),xt.afterContentClassName,2);St[kt.endLineNumber-gt].push(At)}}return{decorations:mt,inlineDecorations:St}}}function isModelDecorationVisible(ct,nt){return!(nt.options.hideInCommentTokens&&isModelDecorationInComment(ct,nt)||nt.options.hideInStringTokens&&isModelDecorationInString(ct,nt))}function isModelDecorationInComment(ct,nt){return testTokensInRange(ct,nt.range,ot=>ot===1)}function isModelDecorationInString(ct,nt){return testTokensInRange(ct,nt.range,ot=>ot===2)}function testTokensInRange(ct,nt,ot){for(let rt=nt.startLineNumber;rt<=nt.endLineNumber;rt++){const ut=ct.tokenization.getLineTokens(rt),gt=rt===nt.startLineNumber,pt=rt===nt.endLineNumber;let mt=gt?ut.findTokenIndexAtOffset(nt.startColumn-1):0;for(;mt<ut.getCount()&&!(pt&&ut.getStartOffset(mt)>nt.endColumn-1);){if(!ot(ut.getStandardTokenType(mt)))return!1;mt++}}return!0}function createModelLineProjection(ct,nt){return ct===null?nt?IdentityModelLineProjection.INSTANCE:HiddenModelLineProjection.INSTANCE:new ModelLineProjection(ct,nt)}class ModelLineProjection{constructor(nt,ot){this._projectionData=nt,this._isVisible=ot}isVisible(){return this._isVisible}setVisible(nt){return this._isVisible=nt,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(nt,ot,rt){this._assertVisible();const ut=rt>0?this._projectionData.breakOffsets[rt-1]:0,gt=this._projectionData.breakOffsets[rt];let pt;if(this._projectionData.injectionOffsets!==null){const mt=this._projectionData.injectionOffsets.map((St,yt)=>new LineInjectedText(0,0,St+1,this._projectionData.injectionOptions[yt],0));pt=LineInjectedText.applyInjectedText(nt.getLineContent(ot),mt).substring(ut,gt)}else pt=nt.getValueInRange({startLineNumber:ot,startColumn:ut+1,endLineNumber:ot,endColumn:gt+1});return rt>0&&(pt=spaces(this._projectionData.wrappedTextIndentLength)+pt),pt}getViewLineLength(nt,ot,rt){return this._assertVisible(),this._projectionData.getLineLength(rt)}getViewLineMinColumn(nt,ot,rt){return this._assertVisible(),this._projectionData.getMinOutputOffset(rt)+1}getViewLineMaxColumn(nt,ot,rt){return this._assertVisible(),this._projectionData.getMaxOutputOffset(rt)+1}getViewLineData(nt,ot,rt){const ut=new Array;return this.getViewLinesData(nt,ot,rt,1,0,[!0],ut),ut[0]}getViewLinesData(nt,ot,rt,ut,gt,pt,mt){this._assertVisible();const vt=this._projectionData,St=vt.injectionOffsets,yt=vt.injectionOptions;let wt=null;if(St){wt=[];let xt=0,It=0;for(let kt=0;kt<vt.getOutputLineCount();kt++){const At=new Array;wt[kt]=At;const Tt=kt>0?vt.breakOffsets[kt-1]:0,Rt=vt.breakOffsets[kt];for(;It<St.length;){const Nt=yt[It].content.length,Pt=St[It]+xt,Ft=Pt+Nt;if(Pt>Rt)break;if(Tt<Ft){const Kt=yt[It];if(Kt.inlineClassName){const Bt=kt>0?vt.wrappedTextIndentLength:0,Ut=Bt+Math.max(Pt-Tt,0),qt=Bt+Math.min(Ft-Tt,Rt);Ut!==qt&&At.push(new SingleLineInlineDecoration(Ut,qt,Kt.inlineClassName,Kt.inlineClassNameAffectsLetterSpacing))}}if(Ft<=Rt)xt+=Nt,It++;else break}}}let Lt;St?Lt=nt.tokenization.getLineTokens(ot).withInserted(St.map((xt,It)=>({offset:xt,text:yt[It].content,tokenMetadata:LineTokens.defaultTokenMetadata}))):Lt=nt.tokenization.getLineTokens(ot);for(let xt=rt;xt<rt+ut;xt++){const It=gt+xt-rt;if(!pt[It]){mt[It]=null;continue}mt[It]=this._getViewLineData(Lt,wt?wt[xt]:null,xt)}}_getViewLineData(nt,ot,rt){this._assertVisible();const ut=this._projectionData,gt=rt>0?ut.wrappedTextIndentLength:0,pt=rt>0?ut.breakOffsets[rt-1]:0,mt=ut.breakOffsets[rt],vt=nt.sliceAndInflate(pt,mt,gt);let St=vt.getLineContent();rt>0&&(St=spaces(ut.wrappedTextIndentLength)+St);const yt=this._projectionData.getMinOutputOffset(rt)+1,wt=St.length+1,Lt=rt+1<this.getViewLineCount(),xt=rt===0?0:ut.breakOffsetsVisibleColumn[rt-1];return new ViewLineData(St,Lt,yt,wt,xt,vt,ot)}getModelColumnOfViewPosition(nt,ot){return this._assertVisible(),this._projectionData.translateToInputOffset(nt,ot-1)+1}getViewPositionOfModelPosition(nt,ot,rt=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(ot-1,rt).toPosition(nt)}getViewLineNumberOfModelPosition(nt,ot){this._assertVisible();const rt=this._projectionData.translateToOutputPosition(ot-1);return nt+rt.outputLineIndex}normalizePosition(nt,ot,rt){const ut=ot.lineNumber-nt;return this._projectionData.normalizeOutputPosition(nt,ot.column-1,rt).toPosition(ut)}getInjectedTextAt(nt,ot){return this._projectionData.getInjectedText(nt,ot-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}class IdentityModelLineProjection{constructor(){}isVisible(){return!0}setVisible(nt){return nt?this:HiddenModelLineProjection.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(nt,ot,rt){return nt.getLineContent(ot)}getViewLineLength(nt,ot,rt){return nt.getLineLength(ot)}getViewLineMinColumn(nt,ot,rt){return nt.getLineMinColumn(ot)}getViewLineMaxColumn(nt,ot,rt){return nt.getLineMaxColumn(ot)}getViewLineData(nt,ot,rt){const ut=nt.tokenization.getLineTokens(ot),gt=ut.getLineContent();return new ViewLineData(gt,!1,1,gt.length+1,0,ut.inflate(),null)}getViewLinesData(nt,ot,rt,ut,gt,pt,mt){if(!pt[gt]){mt[gt]=null;return}mt[gt]=this.getViewLineData(nt,ot,0)}getModelColumnOfViewPosition(nt,ot){return ot}getViewPositionOfModelPosition(nt,ot){return new Position$1(nt,ot)}getViewLineNumberOfModelPosition(nt,ot){return nt}normalizePosition(nt,ot,rt){return ot}getInjectedTextAt(nt,ot){return null}}IdentityModelLineProjection.INSTANCE=new IdentityModelLineProjection;class HiddenModelLineProjection{constructor(){}isVisible(){return!1}setVisible(nt){return nt?IdentityModelLineProjection.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(nt,ot,rt){throw new Error("Not supported")}getViewLineLength(nt,ot,rt){throw new Error("Not supported")}getViewLineMinColumn(nt,ot,rt){throw new Error("Not supported")}getViewLineMaxColumn(nt,ot,rt){throw new Error("Not supported")}getViewLineData(nt,ot,rt){throw new Error("Not supported")}getViewLinesData(nt,ot,rt,ut,gt,pt,mt){throw new Error("Not supported")}getModelColumnOfViewPosition(nt,ot){throw new Error("Not supported")}getViewPositionOfModelPosition(nt,ot){throw new Error("Not supported")}getViewLineNumberOfModelPosition(nt,ot){throw new Error("Not supported")}normalizePosition(nt,ot,rt){throw new Error("Not supported")}getInjectedTextAt(nt,ot){throw new Error("Not supported")}}HiddenModelLineProjection.INSTANCE=new HiddenModelLineProjection;const _spaces=[""];function spaces(ct){if(ct>=_spaces.length)for(let nt=1;nt<=ct;nt++)_spaces[nt]=_makeSpaces(nt);return _spaces[ct]}function _makeSpaces(ct){return new Array(ct+1).join(" ")}class ViewModelLinesFromProjectedModel{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt){this._editorId=nt,this.model=ot,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=rt,this._monospaceLineBreaksComputerFactory=ut,this.fontInfo=gt,this.tabSize=pt,this.wrappingStrategy=mt,this.wrappingColumn=vt,this.wrappingIndent=St,this.wordBreak=yt,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new CoordinatesConverter(this)}_constructLines(nt,ot){this.modelLineProjections=[],nt&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const rt=this.model.getLinesContent(),ut=this.model.getInjectedTextDecorations(this._editorId),gt=rt.length,pt=this.createLineBreaksComputer(),mt=new ArrayQueue(LineInjectedText.fromDecorations(ut));for(let kt=0;kt<gt;kt++){const At=mt.takeWhile(Tt=>Tt.lineNumber===kt+1);pt.addRequest(rt[kt],At,ot?ot[kt]:null)}const vt=pt.finalize(),St=[],yt=this.hiddenAreasDecorationIds.map(kt=>this.model.getDecorationRange(kt)).sort(Range$2.compareRangesUsingStarts);let wt=1,Lt=0,xt=-1,It=xt+1<yt.length?Lt+1:gt+2;for(let kt=0;kt<gt;kt++){const At=kt+1;At===It&&(xt++,wt=yt[xt].startLineNumber,Lt=yt[xt].endLineNumber,It=xt+1<yt.length?Lt+1:gt+2);const Tt=At>=wt&&At<=Lt,Rt=createModelLineProjection(vt[kt],!Tt);St[kt]=Rt.getViewLineCount(),this.modelLineProjections[kt]=Rt}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new ConstantTimePrefixSumComputer(St)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(nt=>this.model.getDecorationRange(nt))}setHiddenAreas(nt){const ot=nt.map(Lt=>this.model.validateRange(Lt)),rt=normalizeLineRanges(ot),ut=this.hiddenAreasDecorationIds.map(Lt=>this.model.getDecorationRange(Lt)).sort(Range$2.compareRangesUsingStarts);if(rt.length===ut.length){let Lt=!1;for(let xt=0;xt<rt.length;xt++)if(!rt[xt].equalsRange(ut[xt])){Lt=!0;break}if(!Lt)return!1}const gt=rt.map(Lt=>({range:Lt,options:ModelDecorationOptions.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,gt);const pt=rt;let mt=1,vt=0,St=-1,yt=St+1<pt.length?vt+1:this.modelLineProjections.length+2,wt=!1;for(let Lt=0;Lt<this.modelLineProjections.length;Lt++){const xt=Lt+1;xt===yt&&(St++,mt=pt[St].startLineNumber,vt=pt[St].endLineNumber,yt=St+1<pt.length?vt+1:this.modelLineProjections.length+2);let It=!1;if(xt>=mt&&xt<=vt?this.modelLineProjections[Lt].isVisible()&&(this.modelLineProjections[Lt]=this.modelLineProjections[Lt].setVisible(!1),It=!0):(wt=!0,this.modelLineProjections[Lt].isVisible()||(this.modelLineProjections[Lt]=this.modelLineProjections[Lt].setVisible(!0),It=!0)),It){const kt=this.modelLineProjections[Lt].getViewLineCount();this.projectedModelLineLineCounts.setValue(Lt,kt)}}return wt||this.setHiddenAreas([]),!0}modelPositionIsVisible(nt,ot){return nt<1||nt>this.modelLineProjections.length?!1:this.modelLineProjections[nt-1].isVisible()}getModelLineViewLineCount(nt){return nt<1||nt>this.modelLineProjections.length?1:this.modelLineProjections[nt-1].getViewLineCount()}setTabSize(nt){return this.tabSize===nt?!1:(this.tabSize=nt,this._constructLines(!1,null),!0)}setWrappingSettings(nt,ot,rt,ut,gt){const pt=this.fontInfo.equals(nt),mt=this.wrappingStrategy===ot,vt=this.wrappingColumn===rt,St=this.wrappingIndent===ut,yt=this.wordBreak===gt;if(pt&&mt&&vt&&St&&yt)return!1;const wt=pt&&mt&&!vt&&St&&yt;this.fontInfo=nt,this.wrappingStrategy=ot,this.wrappingColumn=rt,this.wrappingIndent=ut,this.wordBreak=gt;let Lt=null;if(wt){Lt=[];for(let xt=0,It=this.modelLineProjections.length;xt<It;xt++)Lt[xt]=this.modelLineProjections[xt].getProjectionData()}return this._constructLines(!1,Lt),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(nt,ot,rt){if(!nt||nt<=this._validModelVersionId)return null;const ut=ot===1?1:this.projectedModelLineLineCounts.getPrefixSum(ot-1)+1,gt=this.projectedModelLineLineCounts.getPrefixSum(rt);return this.modelLineProjections.splice(ot-1,rt-ot+1),this.projectedModelLineLineCounts.removeValues(ot-1,rt-ot+1),new ViewLinesDeletedEvent(ut,gt)}onModelLinesInserted(nt,ot,rt,ut){if(!nt||nt<=this._validModelVersionId)return null;const gt=ot>2&&!this.modelLineProjections[ot-2].isVisible(),pt=ot===1?1:this.projectedModelLineLineCounts.getPrefixSum(ot-1)+1;let mt=0;const vt=[],St=[];for(let yt=0,wt=ut.length;yt<wt;yt++){const Lt=createModelLineProjection(ut[yt],!gt);vt.push(Lt);const xt=Lt.getViewLineCount();mt+=xt,St[yt]=xt}return this.modelLineProjections=this.modelLineProjections.slice(0,ot-1).concat(vt).concat(this.modelLineProjections.slice(ot-1)),this.projectedModelLineLineCounts.insertValues(ot-1,St),new ViewLinesInsertedEvent(pt,pt+mt-1)}onModelLineChanged(nt,ot,rt){if(nt!==null&&nt<=this._validModelVersionId)return[!1,null,null,null];const ut=ot-1,gt=this.modelLineProjections[ut].getViewLineCount(),pt=this.modelLineProjections[ut].isVisible(),mt=createModelLineProjection(rt,pt);this.modelLineProjections[ut]=mt;const vt=this.modelLineProjections[ut].getViewLineCount();let St=!1,yt=0,wt=-1,Lt=0,xt=-1,It=0,kt=-1;gt>vt?(yt=this.projectedModelLineLineCounts.getPrefixSum(ot-1)+1,wt=yt+vt-1,It=wt+1,kt=It+(gt-vt)-1,St=!0):gt<vt?(yt=this.projectedModelLineLineCounts.getPrefixSum(ot-1)+1,wt=yt+gt-1,Lt=wt+1,xt=Lt+(vt-gt)-1,St=!0):(yt=this.projectedModelLineLineCounts.getPrefixSum(ot-1)+1,wt=yt+vt-1),this.projectedModelLineLineCounts.setValue(ut,vt);const At=yt<=wt?new ViewLinesChangedEvent(yt,wt-yt+1):null,Tt=Lt<=xt?new ViewLinesInsertedEvent(Lt,xt):null,Rt=It<=kt?new ViewLinesDeletedEvent(It,kt):null;return[St,At,Tt,Rt]}acceptVersionId(nt){this._validModelVersionId=nt,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(nt){if(nt<1)return 1;const ot=this.getViewLineCount();return nt>ot?ot:nt|0}getActiveIndentGuide(nt,ot,rt){nt=this._toValidViewLineNumber(nt),ot=this._toValidViewLineNumber(ot),rt=this._toValidViewLineNumber(rt);const ut=this.convertViewPositionToModelPosition(nt,this.getViewLineMinColumn(nt)),gt=this.convertViewPositionToModelPosition(ot,this.getViewLineMinColumn(ot)),pt=this.convertViewPositionToModelPosition(rt,this.getViewLineMinColumn(rt)),mt=this.model.guides.getActiveIndentGuide(ut.lineNumber,gt.lineNumber,pt.lineNumber),vt=this.convertModelPositionToViewPosition(mt.startLineNumber,1),St=this.convertModelPositionToViewPosition(mt.endLineNumber,this.model.getLineMaxColumn(mt.endLineNumber));return{startLineNumber:vt.lineNumber,endLineNumber:St.lineNumber,indent:mt.indent}}getViewLineInfo(nt){nt=this._toValidViewLineNumber(nt);const ot=this.projectedModelLineLineCounts.getIndexOf(nt-1),rt=ot.index,ut=ot.remainder;return new ViewLineInfo(rt+1,ut)}getMinColumnOfViewLine(nt){return this.modelLineProjections[nt.modelLineNumber-1].getViewLineMinColumn(this.model,nt.modelLineNumber,nt.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(nt){return this.modelLineProjections[nt.modelLineNumber-1].getViewLineMaxColumn(this.model,nt.modelLineNumber,nt.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(nt){const ot=this.modelLineProjections[nt.modelLineNumber-1],rt=ot.getViewLineMinColumn(this.model,nt.modelLineNumber,nt.modelLineWrappedLineIdx),ut=ot.getModelColumnOfViewPosition(nt.modelLineWrappedLineIdx,rt);return new Position$1(nt.modelLineNumber,ut)}getModelEndPositionOfViewLine(nt){const ot=this.modelLineProjections[nt.modelLineNumber-1],rt=ot.getViewLineMaxColumn(this.model,nt.modelLineNumber,nt.modelLineWrappedLineIdx),ut=ot.getModelColumnOfViewPosition(nt.modelLineWrappedLineIdx,rt);return new Position$1(nt.modelLineNumber,ut)}getViewLineInfosGroupedByModelRanges(nt,ot){const rt=this.getViewLineInfo(nt),ut=this.getViewLineInfo(ot),gt=new Array;let pt=this.getModelStartPositionOfViewLine(rt),mt=new Array;for(let vt=rt.modelLineNumber;vt<=ut.modelLineNumber;vt++){const St=this.modelLineProjections[vt-1];if(St.isVisible()){const yt=vt===rt.modelLineNumber?rt.modelLineWrappedLineIdx:0,wt=vt===ut.modelLineNumber?ut.modelLineWrappedLineIdx+1:St.getViewLineCount();for(let Lt=yt;Lt<wt;Lt++)mt.push(new ViewLineInfo(vt,Lt))}if(!St.isVisible()&&pt){const yt=new Position$1(vt-1,this.model.getLineMaxColumn(vt-1)+1),wt=Range$2.fromPositions(pt,yt);gt.push(new ViewLineInfoGroupedByModelRange(wt,mt)),mt=[],pt=null}else St.isVisible()&&!pt&&(pt=new Position$1(vt,1))}if(pt){const vt=Range$2.fromPositions(pt,this.getModelEndPositionOfViewLine(ut));gt.push(new ViewLineInfoGroupedByModelRange(vt,mt))}return gt}getViewLinesBracketGuides(nt,ot,rt,ut){const gt=rt?this.convertViewPositionToModelPosition(rt.lineNumber,rt.column):null,pt=[];for(const mt of this.getViewLineInfosGroupedByModelRanges(nt,ot)){const vt=mt.modelRange.startLineNumber,St=this.model.guides.getLinesBracketGuides(vt,mt.modelRange.endLineNumber,gt,ut);for(const yt of mt.viewLines){const Lt=St[yt.modelLineNumber-vt].map(xt=>{if(xt.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[yt.modelLineNumber-1].getViewPositionOfModelPosition(0,xt.forWrappedLinesAfterColumn).lineNumber>=yt.modelLineWrappedLineIdx||xt.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[yt.modelLineNumber-1].getViewPositionOfModelPosition(0,xt.forWrappedLinesBeforeOrAtColumn).lineNumber<yt.modelLineWrappedLineIdx)return;if(!xt.horizontalLine)return xt;let It=-1;if(xt.column!==-1){const Tt=this.modelLineProjections[yt.modelLineNumber-1].getViewPositionOfModelPosition(0,xt.column);if(Tt.lineNumber===yt.modelLineWrappedLineIdx)It=Tt.column;else if(Tt.lineNumber<yt.modelLineWrappedLineIdx)It=this.getMinColumnOfViewLine(yt);else if(Tt.lineNumber>yt.modelLineWrappedLineIdx)return}const kt=this.convertModelPositionToViewPosition(yt.modelLineNumber,xt.horizontalLine.endColumn),At=this.modelLineProjections[yt.modelLineNumber-1].getViewPositionOfModelPosition(0,xt.horizontalLine.endColumn);return At.lineNumber===yt.modelLineWrappedLineIdx?new IndentGuide(xt.visibleColumn,It,xt.className,new IndentGuideHorizontalLine(xt.horizontalLine.top,kt.column),-1,-1):At.lineNumber<yt.modelLineWrappedLineIdx||xt.visibleColumn!==-1?void 0:new IndentGuide(xt.visibleColumn,It,xt.className,new IndentGuideHorizontalLine(xt.horizontalLine.top,this.getMaxColumnOfViewLine(yt)),-1,-1)});pt.push(Lt.filter(xt=>!!xt))}}return pt}getViewLinesIndentGuides(nt,ot){nt=this._toValidViewLineNumber(nt),ot=this._toValidViewLineNumber(ot);const rt=this.convertViewPositionToModelPosition(nt,this.getViewLineMinColumn(nt)),ut=this.convertViewPositionToModelPosition(ot,this.getViewLineMaxColumn(ot));let gt=[];const pt=[],mt=[],vt=rt.lineNumber-1,St=ut.lineNumber-1;let yt=null;for(let It=vt;It<=St;It++){const kt=this.modelLineProjections[It];if(kt.isVisible()){const At=kt.getViewLineNumberOfModelPosition(0,It===vt?rt.column:1),Tt=kt.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(It+1)),Rt=Tt-At+1;let Nt=0;Rt>1&&kt.getViewLineMinColumn(this.model,It+1,Tt)===1&&(Nt=At===0?1:2),pt.push(Rt),mt.push(Nt),yt===null&&(yt=new Position$1(It+1,0))}else yt!==null&&(gt=gt.concat(this.model.guides.getLinesIndentGuides(yt.lineNumber,It)),yt=null)}yt!==null&&(gt=gt.concat(this.model.guides.getLinesIndentGuides(yt.lineNumber,ut.lineNumber)),yt=null);const wt=ot-nt+1,Lt=new Array(wt);let xt=0;for(let It=0,kt=gt.length;It<kt;It++){let At=gt[It];const Tt=Math.min(wt-xt,pt[It]),Rt=mt[It];let Nt;Rt===2?Nt=0:Rt===1?Nt=1:Nt=Tt;for(let Pt=0;Pt<Tt;Pt++)Pt===Nt&&(At=0),Lt[xt++]=At}return Lt}getViewLineContent(nt){const ot=this.getViewLineInfo(nt);return this.modelLineProjections[ot.modelLineNumber-1].getViewLineContent(this.model,ot.modelLineNumber,ot.modelLineWrappedLineIdx)}getViewLineLength(nt){const ot=this.getViewLineInfo(nt);return this.modelLineProjections[ot.modelLineNumber-1].getViewLineLength(this.model,ot.modelLineNumber,ot.modelLineWrappedLineIdx)}getViewLineMinColumn(nt){const ot=this.getViewLineInfo(nt);return this.modelLineProjections[ot.modelLineNumber-1].getViewLineMinColumn(this.model,ot.modelLineNumber,ot.modelLineWrappedLineIdx)}getViewLineMaxColumn(nt){const ot=this.getViewLineInfo(nt);return this.modelLineProjections[ot.modelLineNumber-1].getViewLineMaxColumn(this.model,ot.modelLineNumber,ot.modelLineWrappedLineIdx)}getViewLineData(nt){const ot=this.getViewLineInfo(nt);return this.modelLineProjections[ot.modelLineNumber-1].getViewLineData(this.model,ot.modelLineNumber,ot.modelLineWrappedLineIdx)}getViewLinesData(nt,ot,rt){nt=this._toValidViewLineNumber(nt),ot=this._toValidViewLineNumber(ot);const ut=this.projectedModelLineLineCounts.getIndexOf(nt-1);let gt=nt;const pt=ut.index,mt=ut.remainder,vt=[];for(let St=pt,yt=this.model.getLineCount();St<yt;St++){const wt=this.modelLineProjections[St];if(!wt.isVisible())continue;const Lt=St===pt?mt:0;let xt=wt.getViewLineCount()-Lt,It=!1;if(gt+xt>ot&&(It=!0,xt=ot-gt+1),wt.getViewLinesData(this.model,St+1,Lt,xt,gt-nt,rt,vt),gt+=xt,It)break}return vt}validateViewPosition(nt,ot,rt){nt=this._toValidViewLineNumber(nt);const ut=this.projectedModelLineLineCounts.getIndexOf(nt-1),gt=ut.index,pt=ut.remainder,mt=this.modelLineProjections[gt],vt=mt.getViewLineMinColumn(this.model,gt+1,pt),St=mt.getViewLineMaxColumn(this.model,gt+1,pt);ot<vt&&(ot=vt),ot>St&&(ot=St);const yt=mt.getModelColumnOfViewPosition(pt,ot);return this.model.validatePosition(new Position$1(gt+1,yt)).equals(rt)?new Position$1(nt,ot):this.convertModelPositionToViewPosition(rt.lineNumber,rt.column)}validateViewRange(nt,ot){const rt=this.validateViewPosition(nt.startLineNumber,nt.startColumn,ot.getStartPosition()),ut=this.validateViewPosition(nt.endLineNumber,nt.endColumn,ot.getEndPosition());return new Range$2(rt.lineNumber,rt.column,ut.lineNumber,ut.column)}convertViewPositionToModelPosition(nt,ot){const rt=this.getViewLineInfo(nt),ut=this.modelLineProjections[rt.modelLineNumber-1].getModelColumnOfViewPosition(rt.modelLineWrappedLineIdx,ot);return this.model.validatePosition(new Position$1(rt.modelLineNumber,ut))}convertViewRangeToModelRange(nt){const ot=this.convertViewPositionToModelPosition(nt.startLineNumber,nt.startColumn),rt=this.convertViewPositionToModelPosition(nt.endLineNumber,nt.endColumn);return new Range$2(ot.lineNumber,ot.column,rt.lineNumber,rt.column)}convertModelPositionToViewPosition(nt,ot,rt=2){const ut=this.model.validatePosition(new Position$1(nt,ot)),gt=ut.lineNumber,pt=ut.column;let mt=gt-1,vt=!1;for(;mt>0&&!this.modelLineProjections[mt].isVisible();)mt--,vt=!0;if(mt===0&&!this.modelLineProjections[mt].isVisible())return new Position$1(1,1);const St=1+this.projectedModelLineLineCounts.getPrefixSum(mt);let yt;return vt?yt=this.modelLineProjections[mt].getViewPositionOfModelPosition(St,this.model.getLineMaxColumn(mt+1),rt):yt=this.modelLineProjections[gt-1].getViewPositionOfModelPosition(St,pt,rt),yt}convertModelRangeToViewRange(nt,ot=0){if(nt.isEmpty()){const rt=this.convertModelPositionToViewPosition(nt.startLineNumber,nt.startColumn,ot);return Range$2.fromPositions(rt)}else{const rt=this.convertModelPositionToViewPosition(nt.startLineNumber,nt.startColumn,1),ut=this.convertModelPositionToViewPosition(nt.endLineNumber,nt.endColumn,0);return new Range$2(rt.lineNumber,rt.column,ut.lineNumber,ut.column)}}getViewLineNumberOfModelPosition(nt,ot){let rt=nt-1;if(this.modelLineProjections[rt].isVisible()){const gt=1+this.projectedModelLineLineCounts.getPrefixSum(rt);return this.modelLineProjections[rt].getViewLineNumberOfModelPosition(gt,ot)}for(;rt>0&&!this.modelLineProjections[rt].isVisible();)rt--;if(rt===0&&!this.modelLineProjections[rt].isVisible())return 1;const ut=1+this.projectedModelLineLineCounts.getPrefixSum(rt);return this.modelLineProjections[rt].getViewLineNumberOfModelPosition(ut,this.model.getLineMaxColumn(rt+1))}getDecorationsInRange(nt,ot,rt,ut,gt){const pt=this.convertViewPositionToModelPosition(nt.startLineNumber,nt.startColumn),mt=this.convertViewPositionToModelPosition(nt.endLineNumber,nt.endColumn);if(mt.lineNumber-pt.lineNumber<=nt.endLineNumber-nt.startLineNumber)return this.model.getDecorationsInRange(new Range$2(pt.lineNumber,1,mt.lineNumber,mt.column),ot,rt,ut,gt);let vt=[];const St=pt.lineNumber-1,yt=mt.lineNumber-1;let wt=null;for(let kt=St;kt<=yt;kt++)if(this.modelLineProjections[kt].isVisible())wt===null&&(wt=new Position$1(kt+1,kt===St?pt.column:1));else if(wt!==null){const Tt=this.model.getLineMaxColumn(kt);vt=vt.concat(this.model.getDecorationsInRange(new Range$2(wt.lineNumber,wt.column,kt,Tt),ot,rt,ut)),wt=null}wt!==null&&(vt=vt.concat(this.model.getDecorationsInRange(new Range$2(wt.lineNumber,wt.column,mt.lineNumber,mt.column),ot,rt,ut)),wt=null),vt.sort((kt,At)=>{const Tt=Range$2.compareRangesUsingStarts(kt.range,At.range);return Tt===0?kt.id<At.id?-1:kt.id>At.id?1:0:Tt});const Lt=[];let xt=0,It=null;for(const kt of vt){const At=kt.id;It!==At&&(It=At,Lt[xt++]=kt)}return Lt}getInjectedTextAt(nt){const ot=this.getViewLineInfo(nt.lineNumber);return this.modelLineProjections[ot.modelLineNumber-1].getInjectedTextAt(ot.modelLineWrappedLineIdx,nt.column)}normalizePosition(nt,ot){const rt=this.getViewLineInfo(nt.lineNumber);return this.modelLineProjections[rt.modelLineNumber-1].normalizePosition(rt.modelLineWrappedLineIdx,nt,ot)}getLineIndentColumn(nt){const ot=this.getViewLineInfo(nt);return ot.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(ot.modelLineNumber):0}}function normalizeLineRanges(ct){if(ct.length===0)return[];const nt=ct.slice();nt.sort(Range$2.compareRangesUsingStarts);const ot=[];let rt=nt[0].startLineNumber,ut=nt[0].endLineNumber;for(let gt=1,pt=nt.length;gt<pt;gt++){const mt=nt[gt];mt.startLineNumber>ut+1?(ot.push(new Range$2(rt,1,ut,1)),rt=mt.startLineNumber,ut=mt.endLineNumber):mt.endLineNumber>ut&&(ut=mt.endLineNumber)}return ot.push(new Range$2(rt,1,ut,1)),ot}class ViewLineInfo{constructor(nt,ot){this.modelLineNumber=nt,this.modelLineWrappedLineIdx=ot}}class ViewLineInfoGroupedByModelRange{constructor(nt,ot){this.modelRange=nt,this.viewLines=ot}}class CoordinatesConverter{constructor(nt){this._lines=nt}convertViewPositionToModelPosition(nt){return this._lines.convertViewPositionToModelPosition(nt.lineNumber,nt.column)}convertViewRangeToModelRange(nt){return this._lines.convertViewRangeToModelRange(nt)}validateViewPosition(nt,ot){return this._lines.validateViewPosition(nt.lineNumber,nt.column,ot)}validateViewRange(nt,ot){return this._lines.validateViewRange(nt,ot)}convertModelPositionToViewPosition(nt,ot){return this._lines.convertModelPositionToViewPosition(nt.lineNumber,nt.column,ot)}convertModelRangeToViewRange(nt,ot){return this._lines.convertModelRangeToViewRange(nt,ot)}modelPositionIsVisible(nt){return this._lines.modelPositionIsVisible(nt.lineNumber,nt.column)}getModelLineViewLineCount(nt){return this._lines.getModelLineViewLineCount(nt)}getViewLineNumberOfModelPosition(nt,ot){return this._lines.getViewLineNumberOfModelPosition(nt,ot)}}class ViewModelLinesFromModelAsIs{constructor(nt){this.model=nt}dispose(){}createCoordinatesConverter(){return new IdentityCoordinatesConverter(this)}getHiddenAreas(){return[]}setHiddenAreas(nt){return!1}setTabSize(nt){return!1}setWrappingSettings(nt,ot,rt,ut){return!1}createLineBreaksComputer(){const nt=[];return{addRequest:(ot,rt,ut)=>{nt.push(null)},finalize:()=>nt}}onModelFlushed(){}onModelLinesDeleted(nt,ot,rt){return new ViewLinesDeletedEvent(ot,rt)}onModelLinesInserted(nt,ot,rt,ut){return new ViewLinesInsertedEvent(ot,rt)}onModelLineChanged(nt,ot,rt){return[!1,new ViewLinesChangedEvent(ot,1),null,null]}acceptVersionId(nt){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(nt,ot,rt){return{startLineNumber:nt,endLineNumber:nt,indent:0}}getViewLinesBracketGuides(nt,ot,rt){return new Array(ot-nt+1).fill([])}getViewLinesIndentGuides(nt,ot){const rt=ot-nt+1,ut=new Array(rt);for(let gt=0;gt<rt;gt++)ut[gt]=0;return ut}getViewLineContent(nt){return this.model.getLineContent(nt)}getViewLineLength(nt){return this.model.getLineLength(nt)}getViewLineMinColumn(nt){return this.model.getLineMinColumn(nt)}getViewLineMaxColumn(nt){return this.model.getLineMaxColumn(nt)}getViewLineData(nt){const ot=this.model.tokenization.getLineTokens(nt),rt=ot.getLineContent();return new ViewLineData(rt,!1,1,rt.length+1,0,ot.inflate(),null)}getViewLinesData(nt,ot,rt){const ut=this.model.getLineCount();nt=Math.min(Math.max(1,nt),ut),ot=Math.min(Math.max(1,ot),ut);const gt=[];for(let pt=nt;pt<=ot;pt++){const mt=pt-nt;gt[mt]=rt[mt]?this.getViewLineData(pt):null}return gt}getDecorationsInRange(nt,ot,rt,ut,gt){return this.model.getDecorationsInRange(nt,ot,rt,ut,gt)}normalizePosition(nt,ot){return this.model.normalizePosition(nt,ot)}getLineIndentColumn(nt){return this.model.getLineIndentColumn(nt)}getInjectedTextAt(nt){return null}}class IdentityCoordinatesConverter{constructor(nt){this._lines=nt}_validPosition(nt){return this._lines.model.validatePosition(nt)}_validRange(nt){return this._lines.model.validateRange(nt)}convertViewPositionToModelPosition(nt){return this._validPosition(nt)}convertViewRangeToModelRange(nt){return this._validRange(nt)}validateViewPosition(nt,ot){return this._validPosition(ot)}validateViewRange(nt,ot){return this._validRange(ot)}convertModelPositionToViewPosition(nt){return this._validPosition(nt)}convertModelRangeToViewRange(nt){return this._validRange(nt)}modelPositionIsVisible(nt){const ot=this._lines.model.getLineCount();return!(nt.lineNumber<1||nt.lineNumber>ot)}getModelLineViewLineCount(nt){return 1}getViewLineNumberOfModelPosition(nt,ot){return nt}}class ViewModel extends Disposable{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St){if(super(),this.languageConfigurationService=mt,this._themeService=vt,this._attachedView=St,this.hiddenAreasModel=new HiddenAreasModel,this.previousHiddenAreas=[],this._editorId=nt,this._configuration=ot,this.model=rt,this._eventDispatcher=new ViewModelEventDispatcher,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new RunOnceScheduler(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=ViewportStart.create(this.model),this.model.isTooLargeForTokenization())this._lines=new ViewModelLinesFromModelAsIs(this.model);else{const yt=this._configuration.options,wt=yt.get(48),Lt=yt.get(133),xt=yt.get(140),It=yt.get(132),kt=yt.get(124);this._lines=new ViewModelLinesFromProjectedModel(this._editorId,this.model,ut,gt,wt,this.model.getOptions().tabSize,Lt,xt.wrappingColumn,It,kt)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new CursorsController(rt,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new ViewLayout(this._configuration,this.getLineCount(),pt)),this._register(this.viewLayout.onDidScroll(yt=>{yt.scrollTopChanged&&this._handleVisibleLinesChanged(),yt.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new ViewScrollChangedEvent(yt)),this._eventDispatcher.emitOutgoingEvent(new ScrollChangedEvent(yt.oldScrollWidth,yt.oldScrollLeft,yt.oldScrollHeight,yt.oldScrollTop,yt.scrollWidth,yt.scrollLeft,yt.scrollHeight,yt.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(yt=>{this._eventDispatcher.emitOutgoingEvent(yt)})),this._decorations=new ViewModelDecorations(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(yt=>{try{const wt=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(wt,yt)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(MinimapTokensColorTracker.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new ViewTokensColorsChangedEvent)})),this._register(this._themeService.onDidColorThemeChange(yt=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new ViewThemeChangedEvent(yt))})),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(nt){this._eventDispatcher.addViewEventHandler(nt)}removeViewEventHandler(nt){this._eventDispatcher.removeViewEventHandler(nt)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){const nt=this.viewLayout.getLinesViewportData(),ot=new Range$2(nt.startLineNumber,this.getLineMinColumn(nt.startLineNumber),nt.endLineNumber,this.getLineMaxColumn(nt.endLineNumber));return this._toModelVisibleRanges(ot)}visibleLinesStabilized(){const nt=this.getModelVisibleRanges();this._attachedView.setVisibleLines(nt,!0)}_handleVisibleLinesChanged(){const nt=this.getModelVisibleRanges();this._attachedView.setVisibleLines(nt,!1)}setHasFocus(nt){this._hasFocus=nt,this._cursor.setHasFocus(nt),this._eventDispatcher.emitSingleViewEvent(new ViewFocusChangedEvent(nt)),this._eventDispatcher.emitOutgoingEvent(new FocusChangedEvent(!nt,nt))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new ViewCompositionStartEvent)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new ViewCompositionEndEvent)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){const nt=new Position$1(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),ot=this.coordinatesConverter.convertViewPositionToModelPosition(nt);return new StableViewport(ot,this._viewportStart.startLineDelta)}return new StableViewport(null,0)}_onConfigurationChanged(nt,ot){const rt=this._captureStableViewport(),ut=this._configuration.options,gt=ut.get(48),pt=ut.get(133),mt=ut.get(140),vt=ut.get(132),St=ut.get(124);this._lines.setWrappingSettings(gt,pt,mt.wrappingColumn,vt,St)&&(nt.emitViewEvent(new ViewFlushedEvent),nt.emitViewEvent(new ViewLineMappingChangedEvent),nt.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(nt),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),ot.hasChanged(87)&&(this._decorations.reset(),nt.emitViewEvent(new ViewDecorationsChangedEvent(null))),nt.emitViewEvent(new ViewConfigurationChangedEvent(ot)),this.viewLayout.onConfigurationChanged(ot),rt.recoverViewportStart(this.coordinatesConverter,this.viewLayout),CursorConfiguration.shouldRecreate(ot)&&(this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(nt=>{try{const rt=this._eventDispatcher.beginEmitViewEvents();let ut=!1,gt=!1;const pt=nt instanceof InternalModelContentChangeEvent?nt.rawContentChangedEvent.changes:nt.changes,mt=nt instanceof InternalModelContentChangeEvent?nt.rawContentChangedEvent.versionId:null,vt=this._lines.createLineBreaksComputer();for(const wt of pt)switch(wt.changeType){case 4:{for(let Lt=0;Lt<wt.detail.length;Lt++){const xt=wt.detail[Lt];let It=wt.injectedTexts[Lt];It&&(It=It.filter(kt=>!kt.ownerId||kt.ownerId===this._editorId)),vt.addRequest(xt,It,null)}break}case 2:{let Lt=null;wt.injectedText&&(Lt=wt.injectedText.filter(xt=>!xt.ownerId||xt.ownerId===this._editorId)),vt.addRequest(wt.detail,Lt,null);break}}const St=vt.finalize(),yt=new ArrayQueue(St);for(const wt of pt)switch(wt.changeType){case 1:{this._lines.onModelFlushed(),rt.emitViewEvent(new ViewFlushedEvent),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),ut=!0;break}case 3:{const Lt=this._lines.onModelLinesDeleted(mt,wt.fromLineNumber,wt.toLineNumber);Lt!==null&&(rt.emitViewEvent(Lt),this.viewLayout.onLinesDeleted(Lt.fromLineNumber,Lt.toLineNumber)),ut=!0;break}case 4:{const Lt=yt.takeCount(wt.detail.length),xt=this._lines.onModelLinesInserted(mt,wt.fromLineNumber,wt.toLineNumber,Lt);xt!==null&&(rt.emitViewEvent(xt),this.viewLayout.onLinesInserted(xt.fromLineNumber,xt.toLineNumber)),ut=!0;break}case 2:{const Lt=yt.dequeue(),[xt,It,kt,At]=this._lines.onModelLineChanged(mt,wt.lineNumber,Lt);gt=xt,It&&rt.emitViewEvent(It),kt&&(rt.emitViewEvent(kt),this.viewLayout.onLinesInserted(kt.fromLineNumber,kt.toLineNumber)),At&&(rt.emitViewEvent(At),this.viewLayout.onLinesDeleted(At.fromLineNumber,At.toLineNumber));break}case 5:break}mt!==null&&this._lines.acceptVersionId(mt),this.viewLayout.onHeightMaybeChanged(),!ut&&gt&&(rt.emitViewEvent(new ViewLineMappingChangedEvent),rt.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(rt),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}const ot=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&ot){const rt=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(rt){const ut=this.coordinatesConverter.convertModelPositionToViewPosition(rt.getStartPosition()),gt=this.viewLayout.getVerticalOffsetForLineNumber(ut.lineNumber);this.viewLayout.setScrollPosition({scrollTop:gt+this._viewportStart.startLineDelta},1)}}try{const rt=this._eventDispatcher.beginEmitViewEvents();nt instanceof InternalModelContentChangeEvent&&rt.emitOutgoingEvent(new ModelContentChangedEvent(nt.contentChangedEvent)),this._cursor.onModelContentChanged(rt,nt)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(nt=>{const ot=[];for(let rt=0,ut=nt.ranges.length;rt<ut;rt++){const gt=nt.ranges[rt],pt=this.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(gt.fromLineNumber,1)).lineNumber,mt=this.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(gt.toLineNumber,this.model.getLineMaxColumn(gt.toLineNumber))).lineNumber;ot[rt]={fromLineNumber:pt,toLineNumber:mt}}this._eventDispatcher.emitSingleViewEvent(new ViewTokensChangedEvent(ot)),this._eventDispatcher.emitOutgoingEvent(new ModelTokensChangedEvent(nt))})),this._register(this.model.onDidChangeLanguageConfiguration(nt=>{this._eventDispatcher.emitSingleViewEvent(new ViewLanguageConfigurationEvent),this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new ModelLanguageConfigurationChangedEvent(nt))})),this._register(this.model.onDidChangeLanguage(nt=>{this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new ModelLanguageChangedEvent(nt))})),this._register(this.model.onDidChangeOptions(nt=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const ot=this._eventDispatcher.beginEmitViewEvents();ot.emitViewEvent(new ViewFlushedEvent),ot.emitViewEvent(new ViewLineMappingChangedEvent),ot.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(ot),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new ModelOptionsChangedEvent(nt))})),this._register(this.model.onDidChangeDecorations(nt=>{var ot,rt;if(this._decorations.onModelDecorationsChanged(),nt.affectsGlyphMargin){const ut=this.model.getAllMarginDecorations();let gt=!1;ut.sort((vt,St)=>Range$2.compareRangesUsingStarts(vt.range,St.range));let pt=null,mt=null;for(const vt of ut){const St=(rt=(ot=vt.options.glyphMargin)===null||ot===void 0?void 0:ot.position)!==null&&rt!==void 0?rt:GlyphMarginLane.Left;if(St===GlyphMarginLane.Left&&(!pt||Range$2.compareRangesUsingEnds(pt,vt.range)<0)&&(pt=vt.range),St===GlyphMarginLane.Right&&(!mt||Range$2.compareRangesUsingEnds(mt,vt.range)<0)&&(mt=vt.range),pt&&mt){if(pt.endLineNumber<mt.startLineNumber){pt=null;continue}if(mt.endLineNumber<pt.startLineNumber){mt=null;continue}gt=!0;break}}this._configuration.setGlyphMarginDecorationLaneCount(gt?2:1)}this._eventDispatcher.emitSingleViewEvent(new ViewDecorationsChangedEvent(nt)),this._eventDispatcher.emitOutgoingEvent(new ModelDecorationsChangedEvent(nt))}))}setHiddenAreas(nt,ot){this.hiddenAreasModel.setHiddenAreas(ot,nt);const rt=this.hiddenAreasModel.getMergedRanges();if(rt===this.previousHiddenAreas)return;this.previousHiddenAreas=rt;const ut=this._captureStableViewport();let gt=!1;try{const pt=this._eventDispatcher.beginEmitViewEvents();gt=this._lines.setHiddenAreas(rt),gt&&(pt.emitViewEvent(new ViewFlushedEvent),pt.emitViewEvent(new ViewLineMappingChangedEvent),pt.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(pt),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged()),ut.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),gt&&this._eventDispatcher.emitOutgoingEvent(new HiddenAreasChangedEvent)}getVisibleRangesPlusViewportAboveBelow(){const nt=this._configuration.options.get(139),ot=this._configuration.options.get(64),rt=Math.max(20,Math.round(nt.height/ot)),ut=this.viewLayout.getLinesViewportData(),gt=Math.max(1,ut.completelyVisibleStartLineNumber-rt),pt=Math.min(this.getLineCount(),ut.completelyVisibleEndLineNumber+rt);return this._toModelVisibleRanges(new Range$2(gt,this.getLineMinColumn(gt),pt,this.getLineMaxColumn(pt)))}getVisibleRanges(){const nt=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(nt)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(nt){const ot=this.coordinatesConverter.convertViewRangeToModelRange(nt),rt=this._lines.getHiddenAreas();if(rt.length===0)return[ot];const ut=[];let gt=0,pt=ot.startLineNumber,mt=ot.startColumn;const vt=ot.endLineNumber,St=ot.endColumn;for(let yt=0,wt=rt.length;yt<wt;yt++){const Lt=rt[yt].startLineNumber,xt=rt[yt].endLineNumber;xt<pt||Lt>vt||(pt<Lt&&(ut[gt++]=new Range$2(pt,mt,Lt-1,this.model.getLineMaxColumn(Lt-1))),pt=xt+1,mt=1)}return(pt<vt||pt===vt&&mt<St)&&(ut[gt++]=new Range$2(pt,mt,vt,St)),ut}getCompletelyVisibleViewRange(){const nt=this.viewLayout.getLinesViewportData(),ot=nt.completelyVisibleStartLineNumber,rt=nt.completelyVisibleEndLineNumber;return new Range$2(ot,this.getLineMinColumn(ot),rt,this.getLineMaxColumn(rt))}getCompletelyVisibleViewRangeAtScrollTop(nt){const ot=this.viewLayout.getLinesViewportDataAtScrollTop(nt),rt=ot.completelyVisibleStartLineNumber,ut=ot.completelyVisibleEndLineNumber;return new Range$2(rt,this.getLineMinColumn(rt),ut,this.getLineMaxColumn(ut))}saveState(){const nt=this.viewLayout.saveState(),ot=nt.scrollTop,rt=this.viewLayout.getLineNumberAtVerticalOffset(ot),ut=this.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(rt,this.getLineMinColumn(rt))),gt=this.viewLayout.getVerticalOffsetForLineNumber(rt)-ot;return{scrollLeft:nt.scrollLeft,firstPosition:ut,firstPositionDeltaTop:gt}}reduceRestoreState(nt){if(typeof nt.firstPosition>"u")return this._reduceRestoreStateCompatibility(nt);const ot=this.model.validatePosition(nt.firstPosition),rt=this.coordinatesConverter.convertModelPositionToViewPosition(ot),ut=this.viewLayout.getVerticalOffsetForLineNumber(rt.lineNumber)-nt.firstPositionDeltaTop;return{scrollLeft:nt.scrollLeft,scrollTop:ut}}_reduceRestoreStateCompatibility(nt){return{scrollLeft:nt.scrollLeft,scrollTop:nt.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(nt,ot,rt){this._viewportStart.update(this,nt)}getActiveIndentGuide(nt,ot,rt){return this._lines.getActiveIndentGuide(nt,ot,rt)}getLinesIndentGuides(nt,ot){return this._lines.getViewLinesIndentGuides(nt,ot)}getBracketGuidesInRangeByLine(nt,ot,rt,ut){return this._lines.getViewLinesBracketGuides(nt,ot,rt,ut)}getLineContent(nt){return this._lines.getViewLineContent(nt)}getLineLength(nt){return this._lines.getViewLineLength(nt)}getLineMinColumn(nt){return this._lines.getViewLineMinColumn(nt)}getLineMaxColumn(nt){return this._lines.getViewLineMaxColumn(nt)}getLineFirstNonWhitespaceColumn(nt){const ot=firstNonWhitespaceIndex(this.getLineContent(nt));return ot===-1?0:ot+1}getLineLastNonWhitespaceColumn(nt){const ot=lastNonWhitespaceIndex(this.getLineContent(nt));return ot===-1?0:ot+2}getMinimapDecorationsInRange(nt){return this._decorations.getMinimapDecorationsInRange(nt)}getDecorationsInViewport(nt){return this._decorations.getDecorationsViewportData(nt).decorations}getInjectedTextAt(nt){return this._lines.getInjectedTextAt(nt)}getViewportViewLineRenderingData(nt,ot){const ut=this._decorations.getDecorationsViewportData(nt).inlineDecorations[ot-nt.startLineNumber];return this._getViewLineRenderingData(ot,ut)}getViewLineRenderingData(nt){const ot=this._decorations.getInlineDecorationsOnLine(nt);return this._getViewLineRenderingData(nt,ot)}_getViewLineRenderingData(nt,ot){const rt=this.model.mightContainRTL(),ut=this.model.mightContainNonBasicASCII(),gt=this.getTabSize(),pt=this._lines.getViewLineData(nt);return pt.inlineDecorations&&(ot=[...ot,...pt.inlineDecorations.map(mt=>mt.toInlineDecoration(nt))]),new ViewLineRenderingData(pt.minColumn,pt.maxColumn,pt.content,pt.continuesWithWrappedLine,rt,ut,pt.tokens,ot,gt,pt.startVisibleColumn)}getViewLineData(nt){return this._lines.getViewLineData(nt)}getMinimapLinesRenderingData(nt,ot,rt){const ut=this._lines.getViewLinesData(nt,ot,rt);return new MinimapLinesRenderingData(this.getTabSize(),ut)}getAllOverviewRulerDecorations(nt){const ot=this.model.getOverviewRulerDecorations(this._editorId,filterValidationDecorations(this._configuration.options)),rt=new OverviewRulerDecorations;for(const ut of ot){const gt=ut.options,pt=gt.overviewRuler;if(!pt)continue;const mt=pt.position;if(mt===0)continue;const vt=pt.getColor(nt.value),St=this.coordinatesConverter.getViewLineNumberOfModelPosition(ut.range.startLineNumber,ut.range.startColumn),yt=this.coordinatesConverter.getViewLineNumberOfModelPosition(ut.range.endLineNumber,ut.range.endColumn);rt.accept(vt,gt.zIndex,St,yt,mt)}return rt.asArray}_invalidateDecorationsColorCache(){const nt=this.model.getOverviewRulerDecorations();for(const ot of nt){const rt=ot.options.overviewRuler;rt==null||rt.invalidateCachedColor();const ut=ot.options.minimap;ut==null||ut.invalidateCachedColor()}}getValueInRange(nt,ot){const rt=this.coordinatesConverter.convertViewRangeToModelRange(nt);return this.model.getValueInRange(rt,ot)}getValueLengthInRange(nt,ot){const rt=this.coordinatesConverter.convertViewRangeToModelRange(nt);return this.model.getValueLengthInRange(rt,ot)}modifyPosition(nt,ot){const rt=this.coordinatesConverter.convertViewPositionToModelPosition(nt);return this.model.modifyPosition(rt,ot)}deduceModelPositionRelativeToViewPosition(nt,ot,rt){const ut=this.coordinatesConverter.convertViewPositionToModelPosition(nt);this.model.getEOL().length===2&&(ot<0?ot-=rt:ot+=rt);const pt=this.model.getOffsetAt(ut)+ot;return this.model.getPositionAt(pt)}getPlainTextToCopy(nt,ot,rt){const ut=rt?`\r
`:this.model.getEOL();nt=nt.slice(0),nt.sort(Range$2.compareRangesUsingStarts);let gt=!1,pt=!1;for(const vt of nt)vt.isEmpty()?gt=!0:pt=!0;if(!pt){if(!ot)return"";const vt=nt.map(yt=>yt.startLineNumber);let St="";for(let yt=0;yt<vt.length;yt++)yt>0&&vt[yt-1]===vt[yt]||(St+=this.model.getLineContent(vt[yt])+ut);return St}if(gt&&ot){const vt=[];let St=0;for(const yt of nt){const wt=yt.startLineNumber;yt.isEmpty()?wt!==St&&vt.push(this.model.getLineContent(wt)):vt.push(this.model.getValueInRange(yt,rt?2:0)),St=wt}return vt.length===1?vt[0]:vt}const mt=[];for(const vt of nt)vt.isEmpty()||mt.push(this.model.getValueInRange(vt,rt?2:0));return mt.length===1?mt[0]:mt}getRichTextToCopy(nt,ot){const rt=this.model.getLanguageId();if(rt===PLAINTEXT_LANGUAGE_ID||nt.length!==1)return null;let ut=nt[0];if(ut.isEmpty()){if(!ot)return null;const yt=ut.startLineNumber;ut=new Range$2(yt,this.model.getLineMinColumn(yt),yt,this.model.getLineMaxColumn(yt))}const gt=this._configuration.options.get(48),pt=this._getColorMap(),vt=/[:;\\\/<>]/.test(gt.fontFamily)||gt.fontFamily===EDITOR_FONT_DEFAULTS.fontFamily;let St;return vt?St=EDITOR_FONT_DEFAULTS.fontFamily:(St=gt.fontFamily,St=St.replace(/"/g,"'"),/[,']/.test(St)||/[+ ]/.test(St)&&(St=`'${St}'`),St=`${St}, ${EDITOR_FONT_DEFAULTS.fontFamily}`),{mode:rt,html:`<div style="color: ${pt[1]};background-color: ${pt[2]};font-family: ${St};font-weight: ${gt.fontWeight};font-size: ${gt.fontSize}px;line-height: ${gt.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(ut,pt)+"</div>"}}_getHTMLToCopy(nt,ot){const rt=nt.startLineNumber,ut=nt.startColumn,gt=nt.endLineNumber,pt=nt.endColumn,mt=this.getTabSize();let vt="";for(let St=rt;St<=gt;St++){const yt=this.model.tokenization.getLineTokens(St),wt=yt.getLineContent(),Lt=St===rt?ut-1:0,xt=St===gt?pt-1:wt.length;wt===""?vt+="<br>":vt+=tokenizeLineToHTML(wt,yt.inflate(),ot,Lt,xt,mt,isWindows)}return vt}_getColorMap(){const nt=TokenizationRegistry.getColorMap(),ot=["#000000"];if(nt)for(let rt=1,ut=nt.length;rt<ut;rt++)ot[rt]=Color.Format.CSS.formatHex(nt[rt]);return ot}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(nt,ot,rt){return this._withViewEventsCollector(ut=>this._cursor.setStates(ut,nt,ot,rt))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(nt){this._cursor.setCursorColumnSelectData(nt)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(nt){this._cursor.setPrevEditOperationType(nt)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(nt,ot,rt=0){this._withViewEventsCollector(ut=>this._cursor.setSelections(ut,nt,ot,rt))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(nt){this._withViewEventsCollector(ot=>this._cursor.restoreState(ot,nt))}_executeCursorEdit(nt){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new ReadOnlyEditAttemptEvent);return}this._withViewEventsCollector(nt)}executeEdits(nt,ot,rt){this._executeCursorEdit(ut=>this._cursor.executeEdits(ut,nt,ot,rt))}startComposition(){this._executeCursorEdit(nt=>this._cursor.startComposition(nt))}endComposition(nt){this._executeCursorEdit(ot=>this._cursor.endComposition(ot,nt))}type(nt,ot){this._executeCursorEdit(rt=>this._cursor.type(rt,nt,ot))}compositionType(nt,ot,rt,ut,gt){this._executeCursorEdit(pt=>this._cursor.compositionType(pt,nt,ot,rt,ut,gt))}paste(nt,ot,rt,ut){this._executeCursorEdit(gt=>this._cursor.paste(gt,nt,ot,rt,ut))}cut(nt){this._executeCursorEdit(ot=>this._cursor.cut(ot,nt))}executeCommand(nt,ot){this._executeCursorEdit(rt=>this._cursor.executeCommand(rt,nt,ot))}executeCommands(nt,ot){this._executeCursorEdit(rt=>this._cursor.executeCommands(rt,nt,ot))}revealPrimaryCursor(nt,ot,rt=!1){this._withViewEventsCollector(ut=>this._cursor.revealPrimary(ut,nt,rt,0,ot,0))}revealTopMostCursor(nt){const ot=this._cursor.getTopMostViewPosition(),rt=new Range$2(ot.lineNumber,ot.column,ot.lineNumber,ot.column);this._withViewEventsCollector(ut=>ut.emitViewEvent(new ViewRevealRangeRequestEvent(nt,!1,rt,null,0,!0,0)))}revealBottomMostCursor(nt){const ot=this._cursor.getBottomMostViewPosition(),rt=new Range$2(ot.lineNumber,ot.column,ot.lineNumber,ot.column);this._withViewEventsCollector(ut=>ut.emitViewEvent(new ViewRevealRangeRequestEvent(nt,!1,rt,null,0,!0,0)))}revealRange(nt,ot,rt,ut,gt){this._withViewEventsCollector(pt=>pt.emitViewEvent(new ViewRevealRangeRequestEvent(nt,!1,rt,null,ut,ot,gt)))}changeWhitespace(nt){this.viewLayout.changeWhitespace(nt)&&(this._eventDispatcher.emitSingleViewEvent(new ViewZonesChangedEvent$1),this._eventDispatcher.emitOutgoingEvent(new ViewZonesChangedEvent))}_withViewEventsCollector(nt){try{const ot=this._eventDispatcher.beginEmitViewEvents();return nt(ot)}finally{this._eventDispatcher.endEmitViewEvents()}}normalizePosition(nt,ot){return this._lines.normalizePosition(nt,ot)}getLineIndentColumn(nt){return this._lines.getLineIndentColumn(nt)}}class ViewportStart{static create(nt){const ot=nt._setTrackedRange(null,new Range$2(1,1,1,1),1);return new ViewportStart(nt,1,!1,ot,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}constructor(nt,ot,rt,ut,gt){this._model=nt,this._viewLineNumber=ot,this._isValid=rt,this._modelTrackedRange=ut,this._startLineDelta=gt}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(nt,ot){const rt=nt.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(ot,nt.getLineMinColumn(ot))),ut=nt.model._setTrackedRange(this._modelTrackedRange,new Range$2(rt.lineNumber,rt.column,rt.lineNumber,rt.column),1),gt=nt.viewLayout.getVerticalOffsetForLineNumber(ot),pt=nt.viewLayout.getCurrentScrollTop();this._viewLineNumber=ot,this._isValid=!0,this._modelTrackedRange=ut,this._startLineDelta=pt-gt}invalidate(){this._isValid=!1}}class OverviewRulerDecorations{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(nt,ot,rt,ut,gt){const pt=this._asMap[nt];if(pt){const mt=pt.data,vt=mt[mt.length-3],St=mt[mt.length-1];if(vt===gt&&St+1>=rt){ut>St&&(mt[mt.length-1]=ut);return}mt.push(gt,rt,ut)}else{const mt=new OverviewRulerDecorationsGroup(nt,ot,[gt,rt,ut]);this._asMap[nt]=mt,this.asArray.push(mt)}}}class HiddenAreasModel{constructor(){this.hiddenAreas=new Map,this.shouldRecompute=!1,this.ranges=[]}setHiddenAreas(nt,ot){const rt=this.hiddenAreas.get(nt);rt&&rangeArraysEqual(rt,ot)||(this.hiddenAreas.set(nt,ot),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;const nt=Array.from(this.hiddenAreas.values()).reduce((ot,rt)=>mergeLineRangeArray(ot,rt),[]);return rangeArraysEqual(this.ranges,nt)?this.ranges:(this.ranges=nt,this.ranges)}}function mergeLineRangeArray(ct,nt){const ot=[];let rt=0,ut=0;for(;rt<ct.length&&ut<nt.length;){const gt=ct[rt],pt=nt[ut];if(gt.endLineNumber<pt.startLineNumber-1)ot.push(ct[rt++]);else if(pt.endLineNumber<gt.startLineNumber-1)ot.push(nt[ut++]);else{const mt=Math.min(gt.startLineNumber,pt.startLineNumber),vt=Math.max(gt.endLineNumber,pt.endLineNumber);ot.push(new Range$2(mt,1,vt,1)),rt++,ut++}}for(;rt<ct.length;)ot.push(ct[rt++]);for(;ut<nt.length;)ot.push(nt[ut++]);return ot}function rangeArraysEqual(ct,nt){if(ct.length!==nt.length)return!1;for(let ot=0;ot<ct.length;ot++)if(!ct[ot].equalsRange(nt[ot]))return!1;return!0}class StableViewport{constructor(nt,ot){this.viewportStartModelPosition=nt,this.startLineDelta=ot}recoverViewportStart(nt,ot){if(!this.viewportStartModelPosition)return;const rt=nt.convertModelPositionToViewPosition(this.viewportStartModelPosition),ut=ot.getVerticalOffsetForLineNumber(rt.lineNumber);ot.setScrollPosition({scrollTop:ut+this.startLineDelta},1)}}class ServiceCollection{constructor(...nt){this._entries=new Map;for(const[ot,rt]of nt)this.set(ot,rt)}set(nt,ot){const rt=this._entries.get(nt);return this._entries.set(nt,ot),rt}get(nt){return this._entries.get(nt)}}var Severity$1;(function(ct){ct[ct.Ignore=0]="Ignore",ct[ct.Info=1]="Info",ct[ct.Warning=2]="Warning",ct[ct.Error=3]="Error"})(Severity$1||(Severity$1={}));(function(ct){const nt="error",ot="warning",rt="warn",ut="info",gt="ignore";function pt(vt){return vt?equalsIgnoreCase(nt,vt)?ct.Error:equalsIgnoreCase(ot,vt)||equalsIgnoreCase(rt,vt)?ct.Warning:equalsIgnoreCase(ut,vt)?ct.Info:ct.Ignore:ct.Ignore}ct.fromValue=pt;function mt(vt){switch(vt){case ct.Error:return nt;case ct.Warning:return ot;case ct.Info:return ut;default:return gt}}ct.toString=mt})(Severity$1||(Severity$1={}));const Severity$2=Severity$1;var Severity=Severity$2;const INotificationService=createDecorator("notificationService");class NoOpNotification{}class ModelLineProjectionData{constructor(nt,ot,rt,ut,gt){this.injectionOffsets=nt,this.injectionOptions=ot,this.breakOffsets=rt,this.breakOffsetsVisibleColumn=ut,this.wrappedTextIndentLength=gt}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(nt){return nt>0?this.wrappedTextIndentLength:0}getLineLength(nt){const ot=nt>0?this.breakOffsets[nt-1]:0;let ut=this.breakOffsets[nt]-ot;return nt>0&&(ut+=this.wrappedTextIndentLength),ut}getMaxOutputOffset(nt){return this.getLineLength(nt)}translateToInputOffset(nt,ot){nt>0&&(ot=Math.max(0,ot-this.wrappedTextIndentLength));let ut=nt===0?ot:this.breakOffsets[nt-1]+ot;if(this.injectionOffsets!==null)for(let gt=0;gt<this.injectionOffsets.length&&ut>this.injectionOffsets[gt];gt++)ut<this.injectionOffsets[gt]+this.injectionOptions[gt].content.length?ut=this.injectionOffsets[gt]:ut-=this.injectionOptions[gt].content.length;return ut}translateToOutputPosition(nt,ot=2){let rt=nt;if(this.injectionOffsets!==null)for(let ut=0;ut<this.injectionOffsets.length&&!(nt<this.injectionOffsets[ut]||ot!==1&&nt===this.injectionOffsets[ut]);ut++)rt+=this.injectionOptions[ut].content.length;return this.offsetInInputWithInjectionsToOutputPosition(rt,ot)}offsetInInputWithInjectionsToOutputPosition(nt,ot=2){let rt=0,ut=this.breakOffsets.length-1,gt=0,pt=0;for(;rt<=ut;){gt=rt+(ut-rt)/2|0;const vt=this.breakOffsets[gt];if(pt=gt>0?this.breakOffsets[gt-1]:0,ot===0)if(nt<=pt)ut=gt-1;else if(nt>vt)rt=gt+1;else break;else if(nt<pt)ut=gt-1;else if(nt>=vt)rt=gt+1;else break}let mt=nt-pt;return gt>0&&(mt+=this.wrappedTextIndentLength),new OutputPosition(gt,mt)}normalizeOutputPosition(nt,ot,rt){if(this.injectionOffsets!==null){const ut=this.outputPositionToOffsetInInputWithInjections(nt,ot),gt=this.normalizeOffsetInInputWithInjectionsAroundInjections(ut,rt);if(gt!==ut)return this.offsetInInputWithInjectionsToOutputPosition(gt,rt)}if(rt===0){if(nt>0&&ot===this.getMinOutputOffset(nt))return new OutputPosition(nt-1,this.getMaxOutputOffset(nt-1))}else if(rt===1){const ut=this.getOutputLineCount()-1;if(nt<ut&&ot===this.getMaxOutputOffset(nt))return new OutputPosition(nt+1,this.getMinOutputOffset(nt+1))}return new OutputPosition(nt,ot)}outputPositionToOffsetInInputWithInjections(nt,ot){return nt>0&&(ot=Math.max(0,ot-this.wrappedTextIndentLength)),(nt>0?this.breakOffsets[nt-1]:0)+ot}normalizeOffsetInInputWithInjectionsAroundInjections(nt,ot){const rt=this.getInjectedTextAtOffset(nt);if(!rt)return nt;if(ot===2){if(nt===rt.offsetInInputWithInjections+rt.length&&hasRightCursorStop(this.injectionOptions[rt.injectedTextIndex].cursorStops))return rt.offsetInInputWithInjections+rt.length;{let ut=rt.offsetInInputWithInjections;if(hasLeftCursorStop(this.injectionOptions[rt.injectedTextIndex].cursorStops))return ut;let gt=rt.injectedTextIndex-1;for(;gt>=0&&this.injectionOffsets[gt]===this.injectionOffsets[rt.injectedTextIndex]&&!(hasRightCursorStop(this.injectionOptions[gt].cursorStops)||(ut-=this.injectionOptions[gt].content.length,hasLeftCursorStop(this.injectionOptions[gt].cursorStops)));)gt--;return ut}}else if(ot===1||ot===4){let ut=rt.offsetInInputWithInjections+rt.length,gt=rt.injectedTextIndex;for(;gt+1<this.injectionOffsets.length&&this.injectionOffsets[gt+1]===this.injectionOffsets[gt];)ut+=this.injectionOptions[gt+1].content.length,gt++;return ut}else if(ot===0||ot===3){let ut=rt.offsetInInputWithInjections,gt=rt.injectedTextIndex;for(;gt-1>=0&&this.injectionOffsets[gt-1]===this.injectionOffsets[gt];)ut-=this.injectionOptions[gt-1].content.length,gt--;return ut}assertNever()}getInjectedText(nt,ot){const rt=this.outputPositionToOffsetInInputWithInjections(nt,ot),ut=this.getInjectedTextAtOffset(rt);return ut?{options:this.injectionOptions[ut.injectedTextIndex]}:null}getInjectedTextAtOffset(nt){const ot=this.injectionOffsets,rt=this.injectionOptions;if(ot!==null){let ut=0;for(let gt=0;gt<ot.length;gt++){const pt=rt[gt].content.length,mt=ot[gt]+ut,vt=ot[gt]+ut+pt;if(mt>nt)break;if(nt<=vt)return{injectedTextIndex:gt,offsetInInputWithInjections:mt,length:pt};ut+=pt}}}}function hasRightCursorStop(ct){return ct==null?!0:ct===InjectedTextCursorStops.Right||ct===InjectedTextCursorStops.Both}function hasLeftCursorStop(ct){return ct==null?!0:ct===InjectedTextCursorStops.Left||ct===InjectedTextCursorStops.Both}class OutputPosition{constructor(nt,ot){this.outputLineIndex=nt,this.outputOffset=ot}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(nt){return new Position$1(nt+this.outputLineIndex,this.outputOffset+1)}}class MonospaceLineBreaksComputerFactory{static create(nt){return new MonospaceLineBreaksComputerFactory(nt.get(128),nt.get(127))}constructor(nt,ot){this.classifier=new WrappingCharacterClassifier(nt,ot)}createLineBreaksComputer(nt,ot,rt,ut,gt){const pt=[],mt=[],vt=[];return{addRequest:(St,yt,wt)=>{pt.push(St),mt.push(yt),vt.push(wt)},finalize:()=>{const St=nt.typicalFullwidthCharacterWidth/nt.typicalHalfwidthCharacterWidth,yt=[];for(let wt=0,Lt=pt.length;wt<Lt;wt++){const xt=mt[wt],It=vt[wt];It&&!It.injectionOptions&&!xt?yt[wt]=createLineBreaksFromPreviousLineBreaks(this.classifier,It,pt[wt],ot,rt,St,ut,gt):yt[wt]=createLineBreaks$1(this.classifier,pt[wt],xt,ot,rt,St,ut,gt)}return arrPool1.length=0,arrPool2.length=0,yt}}}}class WrappingCharacterClassifier extends CharacterClassifier{constructor(nt,ot){super(0);for(let rt=0;rt<nt.length;rt++)this.set(nt.charCodeAt(rt),1);for(let rt=0;rt<ot.length;rt++)this.set(ot.charCodeAt(rt),2)}get(nt){return nt>=0&&nt<256?this._asciiMap[nt]:nt>=12352&&nt<=12543||nt>=13312&&nt<=19903||nt>=19968&&nt<=40959?3:this._map.get(nt)||this._defaultValue}}let arrPool1=[],arrPool2=[];function createLineBreaksFromPreviousLineBreaks(ct,nt,ot,rt,ut,gt,pt,mt){if(ut===-1)return null;const vt=ot.length;if(vt<=1)return null;const St=mt==="keepAll",yt=nt.breakOffsets,wt=nt.breakOffsetsVisibleColumn,Lt=computeWrappedTextIndentLength(ot,rt,ut,gt,pt),xt=ut-Lt,It=arrPool1,kt=arrPool2;let At=0,Tt=0,Rt=0,Nt=ut;const Pt=yt.length;let Ft=0;if(Ft>=0){let Kt=Math.abs(wt[Ft]-Nt);for(;Ft+1<Pt;){const Bt=Math.abs(wt[Ft+1]-Nt);if(Bt>=Kt)break;Kt=Bt,Ft++}}for(;Ft<Pt;){let Kt=Ft<0?0:yt[Ft],Bt=Ft<0?0:wt[Ft];Tt>Kt&&(Kt=Tt,Bt=Rt);let Ut=0,qt=0,Yt=0,Zt=0;if(Bt<=Nt){let _i=Bt,nn=Kt===0?0:ot.charCodeAt(Kt-1),rn=Kt===0?0:ct.get(nn),dn=!0;for(let bn=Kt;bn<vt;bn++){const un=bn,an=ot.charCodeAt(bn);let Cn,_n;if(isHighSurrogate(an)?(bn++,Cn=0,_n=2):(Cn=ct.get(an),_n=computeCharWidth(an,_i,rt,gt)),un>Tt&&canBreak(nn,rn,an,Cn,St)&&(Ut=un,qt=_i),_i+=_n,_i>Nt){un>Tt?(Yt=un,Zt=_i-_n):(Yt=bn+1,Zt=_i),_i-qt>xt&&(Ut=0),dn=!1;break}nn=an,rn=Cn}if(dn){At>0&&(It[At]=yt[yt.length-1],kt[At]=wt[yt.length-1],At++);break}}if(Ut===0){let _i=Bt,nn=ot.charCodeAt(Kt),rn=ct.get(nn),dn=!1;for(let bn=Kt-1;bn>=Tt;bn--){const un=bn+1,an=ot.charCodeAt(bn);if(an===9){dn=!0;break}let Cn,_n;if(isLowSurrogate(an)?(bn--,Cn=0,_n=2):(Cn=ct.get(an),_n=isFullWidthCharacter(an)?gt:1),_i<=Nt){if(Yt===0&&(Yt=un,Zt=_i),_i<=Nt-xt)break;if(canBreak(an,Cn,nn,rn,St)){Ut=un,qt=_i;break}}_i-=_n,nn=an,rn=Cn}if(Ut!==0){const bn=xt-(Zt-qt);if(bn<=rt){const un=ot.charCodeAt(Yt);let an;isHighSurrogate(un)?an=2:an=computeCharWidth(un,Zt,rt,gt),bn-an<0&&(Ut=0)}}if(dn){Ft--;continue}}if(Ut===0&&(Ut=Yt,qt=Zt),Ut<=Tt){const _i=ot.charCodeAt(Tt);isHighSurrogate(_i)?(Ut=Tt+2,qt=Rt+2):(Ut=Tt+1,qt=Rt+computeCharWidth(_i,Rt,rt,gt))}for(Tt=Ut,It[At]=Ut,Rt=qt,kt[At]=qt,At++,Nt=qt+xt;Ft<0||Ft<Pt&&wt[Ft]<qt;)Ft++;let Xt=Math.abs(wt[Ft]-Nt);for(;Ft+1<Pt;){const _i=Math.abs(wt[Ft+1]-Nt);if(_i>=Xt)break;Xt=_i,Ft++}}return At===0?null:(It.length=At,kt.length=At,arrPool1=nt.breakOffsets,arrPool2=nt.breakOffsetsVisibleColumn,nt.breakOffsets=It,nt.breakOffsetsVisibleColumn=kt,nt.wrappedTextIndentLength=Lt,nt)}function createLineBreaks$1(ct,nt,ot,rt,ut,gt,pt,mt){const vt=LineInjectedText.applyInjectedText(nt,ot);let St,yt;if(ot&&ot.length>0?(St=ot.map(qt=>qt.options),yt=ot.map(qt=>qt.column-1)):(St=null,yt=null),ut===-1)return St?new ModelLineProjectionData(yt,St,[vt.length],[],0):null;const wt=vt.length;if(wt<=1)return St?new ModelLineProjectionData(yt,St,[vt.length],[],0):null;const Lt=mt==="keepAll",xt=computeWrappedTextIndentLength(vt,rt,ut,gt,pt),It=ut-xt,kt=[],At=[];let Tt=0,Rt=0,Nt=0,Pt=ut,Ft=vt.charCodeAt(0),Kt=ct.get(Ft),Bt=computeCharWidth(Ft,0,rt,gt),Ut=1;isHighSurrogate(Ft)&&(Bt+=1,Ft=vt.charCodeAt(1),Kt=ct.get(Ft),Ut++);for(let qt=Ut;qt<wt;qt++){const Yt=qt,Zt=vt.charCodeAt(qt);let Xt,_i;isHighSurrogate(Zt)?(qt++,Xt=0,_i=2):(Xt=ct.get(Zt),_i=computeCharWidth(Zt,Bt,rt,gt)),canBreak(Ft,Kt,Zt,Xt,Lt)&&(Rt=Yt,Nt=Bt),Bt+=_i,Bt>Pt&&((Rt===0||Bt-Nt>It)&&(Rt=Yt,Nt=Bt-_i),kt[Tt]=Rt,At[Tt]=Nt,Tt++,Pt=Nt+It,Rt=0),Ft=Zt,Kt=Xt}return Tt===0&&(!ot||ot.length===0)?null:(kt[Tt]=wt,At[Tt]=Bt,new ModelLineProjectionData(yt,St,kt,At,xt))}function computeCharWidth(ct,nt,ot,rt){return ct===9?ot-nt%ot:isFullWidthCharacter(ct)||ct<32?rt:1}function tabCharacterWidth(ct,nt){return nt-ct%nt}function canBreak(ct,nt,ot,rt,ut){return ot!==32&&(nt===2&&rt!==2||nt!==1&&rt===1||!ut&&nt===3&&rt!==2||!ut&&rt===3&&nt!==1)}function computeWrappedTextIndentLength(ct,nt,ot,rt,ut){let gt=0;if(ut!==0){const pt=firstNonWhitespaceIndex(ct);if(pt!==-1){for(let vt=0;vt<pt;vt++){const St=ct.charCodeAt(vt)===9?tabCharacterWidth(gt,nt):1;gt+=St}const mt=ut===3?2:ut===2?1:0;for(let vt=0;vt<mt;vt++){const St=tabCharacterWidth(gt,nt);gt+=St}gt+rt>ot&&(gt=0)}}return gt}var _a$8;const ttPolicy$2=(_a$8=window.trustedTypes)===null||_a$8===void 0?void 0:_a$8.createPolicy("domLineBreaksComputer",{createHTML:ct=>ct});class DOMLineBreaksComputerFactory{static create(){return new DOMLineBreaksComputerFactory}constructor(){}createLineBreaksComputer(nt,ot,rt,ut,gt){const pt=[],mt=[];return{addRequest:(vt,St,yt)=>{pt.push(vt),mt.push(St)},finalize:()=>createLineBreaks(pt,nt,ot,rt,ut,gt,mt)}}}function createLineBreaks(ct,nt,ot,rt,ut,gt,pt){var mt;function vt(qt){const Yt=pt[qt];if(Yt){const Zt=LineInjectedText.applyInjectedText(ct[qt],Yt),Xt=Yt.map(nn=>nn.options),_i=Yt.map(nn=>nn.column-1);return new ModelLineProjectionData(_i,Xt,[Zt.length],[],0)}else return null}if(rt===-1){const qt=[];for(let Yt=0,Zt=ct.length;Yt<Zt;Yt++)qt[Yt]=vt(Yt);return qt}const St=Math.round(rt*nt.typicalHalfwidthCharacterWidth),wt=Math.round(ot*(ut===3?2:ut===2?1:0)),Lt=Math.ceil(nt.spaceWidth*wt),xt=document.createElement("div");applyFontInfo(xt,nt);const It=new StringBuilder(1e4),kt=[],At=[],Tt=[],Rt=[],Nt=[];for(let qt=0;qt<ct.length;qt++){const Yt=LineInjectedText.applyInjectedText(ct[qt],pt[qt]);let Zt=0,Xt=0,_i=St;if(ut!==0)if(Zt=firstNonWhitespaceIndex(Yt),Zt===-1)Zt=0;else{for(let bn=0;bn<Zt;bn++){const un=Yt.charCodeAt(bn)===9?ot-Xt%ot:1;Xt+=un}const dn=Math.ceil(nt.spaceWidth*Xt);dn+nt.typicalFullwidthCharacterWidth>St?(Zt=0,Xt=0):_i=St-dn}const nn=Yt.substr(Zt),rn=renderLine(nn,Xt,ot,_i,It,Lt);kt[qt]=Zt,At[qt]=Xt,Tt[qt]=nn,Rt[qt]=rn[0],Nt[qt]=rn[1]}const Pt=It.build(),Ft=(mt=ttPolicy$2==null?void 0:ttPolicy$2.createHTML(Pt))!==null&&mt!==void 0?mt:Pt;xt.innerHTML=Ft,xt.style.position="absolute",xt.style.top="10000",gt==="keepAll"?(xt.style.wordBreak="keep-all",xt.style.overflowWrap="anywhere"):(xt.style.wordBreak="inherit",xt.style.overflowWrap="break-word"),document.body.appendChild(xt);const Kt=document.createRange(),Bt=Array.prototype.slice.call(xt.children,0),Ut=[];for(let qt=0;qt<ct.length;qt++){const Yt=Bt[qt],Zt=readLineBreaks(Kt,Yt,Tt[qt],Rt[qt]);if(Zt===null){Ut[qt]=vt(qt);continue}const Xt=kt[qt],_i=At[qt]+wt,nn=Nt[qt],rn=[];for(let an=0,Cn=Zt.length;an<Cn;an++)rn[an]=nn[Zt[an]];if(Xt!==0)for(let an=0,Cn=Zt.length;an<Cn;an++)Zt[an]+=Xt;let dn,bn;const un=pt[qt];un?(dn=un.map(an=>an.options),bn=un.map(an=>an.column-1)):(dn=null,bn=null),Ut[qt]=new ModelLineProjectionData(bn,dn,Zt,rn,_i)}return document.body.removeChild(xt),Ut}function renderLine(ct,nt,ot,rt,ut,gt){if(gt!==0){const Lt=String(gt);ut.appendString('<div style="text-indent: -'),ut.appendString(Lt),ut.appendString("px; padding-left: "),ut.appendString(Lt),ut.appendString("px; box-sizing: border-box; width:")}else ut.appendString('<div style="width:');ut.appendString(String(rt)),ut.appendString('px;">');const pt=ct.length;let mt=nt,vt=0;const St=[],yt=[];let wt=0<pt?ct.charCodeAt(0):0;ut.appendString("<span>");for(let Lt=0;Lt<pt;Lt++){Lt!==0&&Lt%16384===0&&ut.appendString("</span><span>"),St[Lt]=vt,yt[Lt]=mt;const xt=wt;wt=Lt+1<pt?ct.charCodeAt(Lt+1):0;let It=1,kt=1;switch(xt){case 9:It=ot-mt%ot,kt=It;for(let At=1;At<=It;At++)At<It?ut.appendCharCode(160):ut.appendASCIICharCode(32);break;case 32:wt===32?ut.appendCharCode(160):ut.appendASCIICharCode(32);break;case 60:ut.appendString("&lt;");break;case 62:ut.appendString("&gt;");break;case 38:ut.appendString("&amp;");break;case 0:ut.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:ut.appendCharCode(65533);break;default:isFullWidthCharacter(xt)&&kt++,xt<32?ut.appendCharCode(9216+xt):ut.appendCharCode(xt)}vt+=It,mt+=kt}return ut.appendString("</span>"),St[ct.length]=vt,yt[ct.length]=mt,ut.appendString("</div>"),[St,yt]}function readLineBreaks(ct,nt,ot,rt){if(ot.length<=1)return null;const ut=Array.prototype.slice.call(nt.children,0),gt=[];try{discoverBreaks(ct,ut,rt,0,null,ot.length-1,null,gt)}catch(pt){return console.log(pt),null}return gt.length===0?null:(gt.push(ot.length),gt)}function discoverBreaks(ct,nt,ot,rt,ut,gt,pt,mt){if(rt===gt||(ut=ut||readClientRect(ct,nt,ot[rt],ot[rt+1]),pt=pt||readClientRect(ct,nt,ot[gt],ot[gt+1]),Math.abs(ut[0].top-pt[0].top)<=.1))return;if(rt+1===gt){mt.push(gt);return}const vt=rt+(gt-rt)/2|0,St=readClientRect(ct,nt,ot[vt],ot[vt+1]);discoverBreaks(ct,nt,ot,rt,ut,vt,St,mt),discoverBreaks(ct,nt,ot,vt,St,gt,pt,mt)}function readClientRect(ct,nt,ot,rt){return ct.setStart(nt[ot/16384|0].firstChild,ot%16384),ct.setEnd(nt[rt/16384|0].firstChild,rt%16384),ct.getClientRects()}class CodeEditorContributions extends Disposable{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new DisposableMap),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(nt,ot,rt){this._editor=nt,this._instantiationService=rt;for(const ut of ot){if(this._pending.has(ut.id)){onUnexpectedError(new Error(`Cannot have two contributions with the same id ${ut.id}`));continue}this._pending.set(ut.id,ut)}this._instantiateSome(0),this._register(runWhenIdle(()=>{this._instantiateSome(1)})),this._register(runWhenIdle(()=>{this._instantiateSome(2)})),this._register(runWhenIdle(()=>{this._instantiateSome(3)},5e3))}saveViewState(){const nt={};for(const[ot,rt]of this._instances)typeof rt.saveViewState=="function"&&(nt[ot]=rt.saveViewState());return nt}restoreViewState(nt){for(const[ot,rt]of this._instances)typeof rt.restoreViewState=="function"&&rt.restoreViewState(nt[ot])}get(nt){return this._instantiateById(nt),this._instances.get(nt)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){this._register(runWhenIdle(()=>{this._instantiateSome(1)},50))}_instantiateSome(nt){if(this._finishedInstantiation[nt])return;this._finishedInstantiation[nt]=!0;const ot=this._findPendingContributionsByInstantiation(nt);for(const rt of ot)this._instantiateById(rt.id)}_findPendingContributionsByInstantiation(nt){const ot=[];for(const[,rt]of this._pending)rt.instantiation===nt&&ot.push(rt);return ot}_instantiateById(nt){const ot=this._pending.get(nt);if(ot){if(this._pending.delete(nt),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const rt=this._instantiationService.createInstance(ot.ctor,this._editor);this._instances.set(ot.id,rt),typeof rt.restoreViewState=="function"&&ot.instantiation!==0&&console.warn(`Editor contribution '${ot.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(rt){onUnexpectedError(rt)}}}}var __decorate$1Y=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1S=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$1o=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let EDITOR_ID=0,ModelData$1=class{constructor(nt,ot,rt,ut,gt,pt){this.model=nt,this.viewModel=ot,this.view=rt,this.hasRealView=ut,this.listenersToRemove=gt,this.attachedView=pt}dispose(){dispose(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}},CodeEditorWidget=class _o extends Disposable{get isSimpleWidget(){return this._configuration.isSimpleWidget}constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt){super(),this.languageConfigurationService=wt,this._deliveryQueue=new EventDeliveryQueue,this._contributions=this._register(new CodeEditorContributions),this._onDidDispose=this._register(new Emitter$2),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new BooleanEventEmitter({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new BooleanEventEmitter({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new Emitter$2({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),gt.willCreateCodeEditor();const xt=Object.assign({},ot);this._domElement=nt,this._overflowWidgetsDomNode=xt.overflowWidgetsDomNode,delete xt.overflowWidgetsDomNode,this._id=++EDITOR_ID,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=rt.telemetryData,this._configuration=this._register(this._createConfiguration(rt.isSimpleWidget||!1,xt,yt)),this._register(this._configuration.onDidChange(At=>{this._onDidChangeConfiguration.fire(At);const Tt=this._configuration.options;if(At.hasChanged(139)){const Rt=Tt.get(139);this._onDidLayoutChange.fire(Rt)}})),this._contextKeyService=this._register(mt.createScoped(this._domElement)),this._notificationService=St,this._codeEditorService=gt,this._commandService=pt,this._themeService=vt,this._register(new EditorContextKeysManager(this,this._contextKeyService)),this._register(new EditorModeContext(this,this._contextKeyService,Lt)),this._instantiationService=ut.createChild(new ServiceCollection([IContextKeyService,this._contextKeyService])),this._modelData=null,this._focusTracker=new CodeEditorWidgetFocusTracker(nt),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={};let It;Array.isArray(rt.contributions)?It=rt.contributions:It=EditorExtensionsRegistry.getEditorContributions(),this._contributions.initialize(this,It,this._instantiationService);for(const At of EditorExtensionsRegistry.getEditorActions()){if(this._actions.has(At.id)){onUnexpectedError(new Error(`Cannot have two actions with the same id ${At.id}`));continue}const Tt=new InternalEditorAction(At.id,At.label,At.alias,withNullAsUndefined(At.precondition),()=>this._instantiationService.invokeFunction(Rt=>Promise.resolve(At.runEditorCommand(Rt,this,null))),this._contextKeyService);this._actions.set(Tt.id,Tt)}const kt=()=>!this._configuration.options.get(87)&&this._configuration.options.get(34).enabled;this._register(new DragAndDropObserver(this._domElement,{onDragEnter:()=>{},onDragOver:At=>{if(!kt())return;const Tt=this.getTargetAtClientPoint(At.clientX,At.clientY);Tt!=null&&Tt.position&&this.showDropIndicatorAt(Tt.position)},onDrop:At=>__awaiter$1o(this,void 0,void 0,function*(){if(!kt()||(this.removeDropIndicator(),!At.dataTransfer))return;const Tt=this.getTargetAtClientPoint(At.clientX,At.clientY);Tt!=null&&Tt.position&&this._onDropIntoEditor.fire({position:Tt.position,event:At})}),onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(nt){var ot;(ot=this._modelData)===null||ot===void 0||ot.view.writeScreenReaderContent(nt)}_createConfiguration(nt,ot,rt){return new EditorConfiguration(nt,ot,this._domElement,rt)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return EditorType.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(nt){return this._instantiationService.invokeFunction(nt)}updateOptions(nt){this._configuration.updateOptions(nt||{})}getOptions(){return this._configuration.options}getOption(nt){return this._configuration.options.get(nt)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(nt){return this._modelData?WordOperations.getWordAtPosition(this._modelData.model,this._configuration.options.get(125),nt):null}getValue(nt=null){if(!this._modelData)return"";const ot=!!(nt&&nt.preserveBOM);let rt=0;return nt&&nt.lineEnding&&nt.lineEnding===`
`?rt=1:nt&&nt.lineEnding&&nt.lineEnding===`\r
`&&(rt=2),this._modelData.model.getValue(rt,ot)}setValue(nt){this._modelData&&this._modelData.model.setValue(nt)}getModel(){return this._modelData?this._modelData.model:null}setModel(nt=null){const ot=nt;if(this._modelData===null&&ot===null||this._modelData&&this._modelData.model===ot)return;const rt=this.hasTextFocus(),ut=this._detachModel();this._attachModel(ot),rt&&this.hasModel()&&this.focus();const gt={oldModelUrl:ut?ut.uri:null,newModelUrl:ot?ot.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(gt),this._postDetachModelCleanup(ut),this._contributions.onAfterModelAttached()}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const nt in this._decorationTypeSubtypes){const ot=this._decorationTypeSubtypes[nt];for(const rt in ot)this._removeDecorationType(nt+"-"+rt)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(nt,ot,rt,ut){const gt=nt.model.validatePosition({lineNumber:ot,column:rt}),pt=nt.viewModel.coordinatesConverter.convertModelPositionToViewPosition(gt);return nt.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(pt.lineNumber,ut)}getTopForLineNumber(nt,ot=!1){return this._modelData?_o._getVerticalOffsetForPosition(this._modelData,nt,1,ot):-1}getTopForPosition(nt,ot){return this._modelData?_o._getVerticalOffsetForPosition(this._modelData,nt,ot,!1):-1}static _getVerticalOffsetForPosition(nt,ot,rt,ut=!1){const gt=nt.model.validatePosition({lineNumber:ot,column:rt}),pt=nt.viewModel.coordinatesConverter.convertModelPositionToViewPosition(gt);return nt.viewModel.viewLayout.getVerticalOffsetForLineNumber(pt.lineNumber,ut)}getBottomForLineNumber(nt,ot=!1){return this._modelData?_o._getVerticalOffsetAfterPosition(this._modelData,nt,1,ot):-1}setHiddenAreas(nt,ot){var rt;(rt=this._modelData)===null||rt===void 0||rt.viewModel.setHiddenAreas(nt.map(ut=>Range$2.lift(ut)),ot)}getVisibleColumnFromPosition(nt){if(!this._modelData)return nt.column;const ot=this._modelData.model.validatePosition(nt),rt=this._modelData.model.getOptions().tabSize;return CursorColumns.visibleColumnFromColumn(this._modelData.model.getLineContent(ot.lineNumber),ot.column,rt)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(nt,ot="api"){if(this._modelData){if(!Position$1.isIPosition(nt))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(ot,[{selectionStartLineNumber:nt.lineNumber,selectionStartColumn:nt.column,positionLineNumber:nt.lineNumber,positionColumn:nt.column}])}}_sendRevealRange(nt,ot,rt,ut){if(!this._modelData)return;if(!Range$2.isIRange(nt))throw new Error("Invalid arguments");const gt=this._modelData.model.validateRange(nt),pt=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(gt);this._modelData.viewModel.revealRange("api",rt,pt,ot,ut)}revealLine(nt,ot=0){this._revealLine(nt,0,ot)}revealLineInCenter(nt,ot=0){this._revealLine(nt,1,ot)}revealLineInCenterIfOutsideViewport(nt,ot=0){this._revealLine(nt,2,ot)}revealLineNearTop(nt,ot=0){this._revealLine(nt,5,ot)}_revealLine(nt,ot,rt){if(typeof nt!="number")throw new Error("Invalid arguments");this._sendRevealRange(new Range$2(nt,1,nt,1),ot,!1,rt)}revealPosition(nt,ot=0){this._revealPosition(nt,0,!0,ot)}revealPositionInCenter(nt,ot=0){this._revealPosition(nt,1,!0,ot)}revealPositionInCenterIfOutsideViewport(nt,ot=0){this._revealPosition(nt,2,!0,ot)}revealPositionNearTop(nt,ot=0){this._revealPosition(nt,5,!0,ot)}_revealPosition(nt,ot,rt,ut){if(!Position$1.isIPosition(nt))throw new Error("Invalid arguments");this._sendRevealRange(new Range$2(nt.lineNumber,nt.column,nt.lineNumber,nt.column),ot,rt,ut)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(nt,ot="api"){const rt=Selection$1.isISelection(nt),ut=Range$2.isIRange(nt);if(!rt&&!ut)throw new Error("Invalid arguments");if(rt)this._setSelectionImpl(nt,ot);else if(ut){const gt={selectionStartLineNumber:nt.startLineNumber,selectionStartColumn:nt.startColumn,positionLineNumber:nt.endLineNumber,positionColumn:nt.endColumn};this._setSelectionImpl(gt,ot)}}_setSelectionImpl(nt,ot){if(!this._modelData)return;const rt=new Selection$1(nt.selectionStartLineNumber,nt.selectionStartColumn,nt.positionLineNumber,nt.positionColumn);this._modelData.viewModel.setSelections(ot,[rt])}revealLines(nt,ot,rt=0){this._revealLines(nt,ot,0,rt)}revealLinesInCenter(nt,ot,rt=0){this._revealLines(nt,ot,1,rt)}revealLinesInCenterIfOutsideViewport(nt,ot,rt=0){this._revealLines(nt,ot,2,rt)}revealLinesNearTop(nt,ot,rt=0){this._revealLines(nt,ot,5,rt)}_revealLines(nt,ot,rt,ut){if(typeof nt!="number"||typeof ot!="number")throw new Error("Invalid arguments");this._sendRevealRange(new Range$2(nt,1,ot,1),rt,!1,ut)}revealRange(nt,ot=0,rt=!1,ut=!0){this._revealRange(nt,rt?1:0,ut,ot)}revealRangeInCenter(nt,ot=0){this._revealRange(nt,1,!0,ot)}revealRangeInCenterIfOutsideViewport(nt,ot=0){this._revealRange(nt,2,!0,ot)}revealRangeNearTop(nt,ot=0){this._revealRange(nt,5,!0,ot)}revealRangeNearTopIfOutsideViewport(nt,ot=0){this._revealRange(nt,6,!0,ot)}revealRangeAtTop(nt,ot=0){this._revealRange(nt,3,!0,ot)}_revealRange(nt,ot,rt,ut){if(!Range$2.isIRange(nt))throw new Error("Invalid arguments");this._sendRevealRange(Range$2.lift(nt),ot,rt,ut)}setSelections(nt,ot="api",rt=0){if(this._modelData){if(!nt||nt.length===0)throw new Error("Invalid arguments");for(let ut=0,gt=nt.length;ut<gt;ut++)if(!Selection$1.isISelection(nt[ut]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(ot,nt,rt)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(nt,ot=1){if(this._modelData){if(typeof nt!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:nt},ot)}}setScrollTop(nt,ot=1){if(this._modelData){if(typeof nt!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:nt},ot)}}setScrollPosition(nt,ot=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(nt,ot)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;const nt=this._contributions.saveViewState(),ot=this._modelData.viewModel.saveCursorState(),rt=this._modelData.viewModel.saveState();return{cursorState:ot,viewState:rt,contributionsState:nt}}restoreViewState(nt){if(!this._modelData||!this._modelData.hasRealView)return;const ot=nt;if(ot&&ot.cursorState&&ot.viewState){const rt=ot.cursorState;Array.isArray(rt)?rt.length>0&&this._modelData.viewModel.restoreCursorState(rt):this._modelData.viewModel.restoreCursorState([rt]),this._contributions.restoreViewState(ot.contributionsState||{});const ut=this._modelData.viewModel.reduceRestoreState(ot.viewState);this._modelData.view.restoreState(ut)}}getContribution(nt){return this._contributions.get(nt)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let nt=this.getActions();return nt=nt.filter(ot=>ot.isSupported()),nt}getAction(nt){return this._actions.get(nt)||null}trigger(nt,ot,rt){switch(rt=rt||{},ot){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(nt);return;case"type":{const gt=rt;this._type(nt,gt.text||"");return}case"replacePreviousChar":{const gt=rt;this._compositionType(nt,gt.text||"",gt.replaceCharCnt||0,0,0);return}case"compositionType":{const gt=rt;this._compositionType(nt,gt.text||"",gt.replacePrevCharCnt||0,gt.replaceNextCharCnt||0,gt.positionDelta||0);return}case"paste":{const gt=rt;this._paste(nt,gt.text||"",gt.pasteOnNewLine||!1,gt.multicursorText||null,gt.mode||null);return}case"cut":this._cut(nt);return}const ut=this.getAction(ot);if(ut){Promise.resolve(ut.run(rt)).then(void 0,onUnexpectedError);return}this._modelData&&(this._triggerEditorCommand(nt,ot,rt)||this._triggerCommand(ot,rt))}_triggerCommand(nt,ot){this._commandService.executeCommand(nt,ot)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(nt){this._modelData&&(this._modelData.viewModel.endComposition(nt),this._onDidCompositionEnd.fire())}_type(nt,ot){!this._modelData||ot.length===0||(nt==="keyboard"&&this._onWillType.fire(ot),this._modelData.viewModel.type(ot,nt),nt==="keyboard"&&this._onDidType.fire(ot))}_compositionType(nt,ot,rt,ut,gt){this._modelData&&this._modelData.viewModel.compositionType(ot,rt,ut,gt,nt)}_paste(nt,ot,rt,ut,gt){if(!this._modelData||ot.length===0)return;const pt=this._modelData.viewModel,mt=pt.getSelection().getStartPosition();pt.paste(ot,rt,ut,nt);const vt=pt.getSelection().getStartPosition();nt==="keyboard"&&this._onDidPaste.fire({range:new Range$2(mt.lineNumber,mt.column,vt.lineNumber,vt.column),languageId:gt})}_cut(nt){this._modelData&&this._modelData.viewModel.cut(nt)}_triggerEditorCommand(nt,ot,rt){const ut=EditorExtensionsRegistry.getEditorCommand(ot);return ut?(rt=rt||{},rt.source=nt,this._instantiationService.invokeFunction(gt=>{Promise.resolve(ut.runEditorCommand(gt,this,rt)).then(void 0,onUnexpectedError)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(87)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(87)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(nt,ot,rt){if(!this._modelData||this._configuration.options.get(87))return!1;let ut;return rt?Array.isArray(rt)?ut=()=>rt:ut=rt:ut=()=>null,this._modelData.viewModel.executeEdits(nt,ot,ut),!0}executeCommand(nt,ot){this._modelData&&this._modelData.viewModel.executeCommand(ot,nt)}executeCommands(nt,ot){this._modelData&&this._modelData.viewModel.executeCommands(ot,nt)}createDecorationsCollection(nt){return new EditorDecorationsCollection(this,nt)}changeDecorations(nt){return this._modelData?this._modelData.model.changeDecorations(nt,this._id):null}getLineDecorations(nt){return this._modelData?this._modelData.model.getLineDecorations(nt,this._id,filterValidationDecorations(this._configuration.options)):null}getDecorationsInRange(nt){return this._modelData?this._modelData.model.getDecorationsInRange(nt,this._id,filterValidationDecorations(this._configuration.options)):null}deltaDecorations(nt,ot){return this._modelData?nt.length===0&&ot.length===0?nt:this._modelData.model.deltaDecorations(nt,ot,this._id):[]}removeDecorations(nt){!this._modelData||nt.length===0||this._modelData.model.changeDecorations(ot=>{ot.deltaDecorations(nt,[])})}removeDecorationsByType(nt){const ot=this._decorationTypeKeysToIds[nt];ot&&this.deltaDecorations(ot,[]),this._decorationTypeKeysToIds.hasOwnProperty(nt)&&delete this._decorationTypeKeysToIds[nt],this._decorationTypeSubtypes.hasOwnProperty(nt)&&delete this._decorationTypeSubtypes[nt]}getLayoutInfo(){return this._configuration.options.get(139)}createOverviewRuler(nt){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(nt)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(nt){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(nt)}delegateScrollFromMouseWheelEvent(nt){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(nt)}layout(nt){this._configuration.observeContainer(nt),this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(nt){const ot={widget:nt,position:nt.getPosition()};this._contentWidgets.hasOwnProperty(nt.getId())&&console.warn("Overwriting a content widget with the same id."),this._contentWidgets[nt.getId()]=ot,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(ot)}layoutContentWidget(nt){const ot=nt.getId();if(this._contentWidgets.hasOwnProperty(ot)){const rt=this._contentWidgets[ot];rt.position=nt.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(rt)}}removeContentWidget(nt){const ot=nt.getId();if(this._contentWidgets.hasOwnProperty(ot)){const rt=this._contentWidgets[ot];delete this._contentWidgets[ot],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(rt)}}addOverlayWidget(nt){const ot={widget:nt,position:nt.getPosition()};this._overlayWidgets.hasOwnProperty(nt.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[nt.getId()]=ot,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(ot)}layoutOverlayWidget(nt){const ot=nt.getId();if(this._overlayWidgets.hasOwnProperty(ot)){const rt=this._overlayWidgets[ot];rt.position=nt.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(rt)}}removeOverlayWidget(nt){const ot=nt.getId();if(this._overlayWidgets.hasOwnProperty(ot)){const rt=this._overlayWidgets[ot];delete this._overlayWidgets[ot],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(rt)}}changeViewZones(nt){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(nt)}getTargetAtClientPoint(nt,ot){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(nt,ot)}getScrolledVisiblePosition(nt){if(!this._modelData||!this._modelData.hasRealView)return null;const ot=this._modelData.model.validatePosition(nt),rt=this._configuration.options,ut=rt.get(139),gt=_o._getVerticalOffsetForPosition(this._modelData,ot.lineNumber,ot.column)-this.getScrollTop(),pt=this._modelData.view.getOffsetForColumn(ot.lineNumber,ot.column)+ut.glyphMarginWidth+ut.lineNumbersWidth+ut.decorationsWidth-this.getScrollLeft();return{top:gt,left:pt,height:rt.get(64)}}getOffsetForColumn(nt,ot){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(nt,ot)}render(nt=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.view.render(!0,nt)}setAriaOptions(nt){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(nt)}applyFontInfo(nt){applyFontInfo(nt,this._configuration.options.get(48))}setBanner(nt,ot){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),this._bannerDomNode=nt,this._configuration.setReservedHeight(nt?ot:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(nt){if(!nt){this._modelData=null;return}const ot=[];this._domElement.setAttribute("data-mode-id",nt.getLanguageId()),this._configuration.setIsDominatedByLongLines(nt.isDominatedByLongLines()),this._configuration.setModelLineCount(nt.getLineCount());const rt=nt.onBeforeAttached(),ut=new ViewModel(this._id,this._configuration,nt,DOMLineBreaksComputerFactory.create(),MonospaceLineBreaksComputerFactory.create(this._configuration.options),mt=>scheduleAtNextAnimationFrame(mt),this.languageConfigurationService,this._themeService,rt);ot.push(nt.onWillDispose(()=>this.setModel(null))),ot.push(ut.onEvent(mt=>{switch(mt.kind){case 0:this._onDidContentSizeChange.fire(mt);break;case 1:this._editorTextFocus.setValue(mt.hasFocus);break;case 2:this._onDidScrollChange.fire(mt);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(mt.reachedMaxCursorCount){const wt=this.getOption(77),Lt=localize("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",wt);this._notificationService.prompt(Severity.Warning,Lt,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:localize("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const vt=[];for(let wt=0,Lt=mt.selections.length;wt<Lt;wt++)vt[wt]=mt.selections[wt].getPosition();const St={position:vt[0],secondaryPositions:vt.slice(1),reason:mt.reason,source:mt.source};this._onDidChangeCursorPosition.fire(St);const yt={selection:mt.selections[0],secondarySelections:mt.selections.slice(1),modelVersionId:mt.modelVersionId,oldSelections:mt.oldSelections,oldModelVersionId:mt.oldModelVersionId,source:mt.source,reason:mt.reason};this._onDidChangeCursorSelection.fire(yt);break}case 7:this._onDidChangeModelDecorations.fire(mt.event);break;case 8:this._domElement.setAttribute("data-mode-id",nt.getLanguageId()),this._onDidChangeModelLanguage.fire(mt.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(mt.event);break;case 10:this._onDidChangeModelContent.fire(mt.event);break;case 11:this._onDidChangeModelOptions.fire(mt.event);break;case 12:this._onDidChangeModelTokens.fire(mt.event);break}}));const[gt,pt]=this._createView(ut);if(pt){this._domElement.appendChild(gt.domNode.domNode);let mt=Object.keys(this._contentWidgets);for(let vt=0,St=mt.length;vt<St;vt++){const yt=mt[vt];gt.addContentWidget(this._contentWidgets[yt])}mt=Object.keys(this._overlayWidgets);for(let vt=0,St=mt.length;vt<St;vt++){const yt=mt[vt];gt.addOverlayWidget(this._overlayWidgets[yt])}gt.render(!1,!0),gt.domNode.domNode.setAttribute("data-uri",nt.uri.toString())}this._modelData=new ModelData$1(nt,ut,gt,pt,ot,rt)}_createView(nt){let ot;this.isSimpleWidget?ot={paste:(gt,pt,mt,vt)=>{this._paste("keyboard",gt,pt,mt,vt)},type:gt=>{this._type("keyboard",gt)},compositionType:(gt,pt,mt,vt)=>{this._compositionType("keyboard",gt,pt,mt,vt)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:ot={paste:(gt,pt,mt,vt)=>{const St={text:gt,pasteOnNewLine:pt,multicursorText:mt,mode:vt};this._commandService.executeCommand("paste",St)},type:gt=>{const pt={text:gt};this._commandService.executeCommand("type",pt)},compositionType:(gt,pt,mt,vt)=>{if(mt||vt){const St={text:gt,replacePrevCharCnt:pt,replaceNextCharCnt:mt,positionDelta:vt};this._commandService.executeCommand("compositionType",St)}else{const St={text:gt,replaceCharCnt:pt};this._commandService.executeCommand("replacePreviousChar",St)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const rt=new ViewUserInputEvents(nt.coordinatesConverter);return rt.onKeyDown=gt=>this._onKeyDown.fire(gt),rt.onKeyUp=gt=>this._onKeyUp.fire(gt),rt.onContextMenu=gt=>this._onContextMenu.fire(gt),rt.onMouseMove=gt=>this._onMouseMove.fire(gt),rt.onMouseLeave=gt=>this._onMouseLeave.fire(gt),rt.onMouseDown=gt=>this._onMouseDown.fire(gt),rt.onMouseUp=gt=>this._onMouseUp.fire(gt),rt.onMouseDrag=gt=>this._onMouseDrag.fire(gt),rt.onMouseDrop=gt=>this._onMouseDrop.fire(gt),rt.onMouseDropCanceled=gt=>this._onMouseDropCanceled.fire(gt),rt.onMouseWheel=gt=>this._onMouseWheel.fire(gt),[new View(ot,this._configuration,this._themeService.getColorTheme(),nt,rt,this._overflowWidgetsDomNode),!0]}_postDetachModelCleanup(nt){nt==null||nt.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const nt=this._modelData.model,ot=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),ot&&this._domElement.contains(ot)&&this._domElement.removeChild(ot),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),nt}_removeDecorationType(nt){this._codeEditorService.removeDecorationType(nt)}hasModel(){return this._modelData!==null}showDropIndicatorAt(nt){const ot=[{range:new Range$2(nt.lineNumber,nt.column,nt.lineNumber,nt.column),options:_o.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(ot),this.revealPosition(nt,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}};CodeEditorWidget.dropIntoEditorDecorationOptions=ModelDecorationOptions.register({description:"workbench-dnd-target",className:"dnd-target"});CodeEditorWidget=__decorate$1Y([__param$1S(3,IInstantiationService),__param$1S(4,ICodeEditorService),__param$1S(5,ICommandService),__param$1S(6,IContextKeyService),__param$1S(7,IThemeService),__param$1S(8,INotificationService),__param$1S(9,IAccessibilityService),__param$1S(10,ILanguageConfigurationService),__param$1S(11,ILanguageFeaturesService)],CodeEditorWidget);class BooleanEventEmitter extends Disposable{constructor(nt){super(),this._emitterOptions=nt,this._onDidChangeToTrue=this._register(new Emitter$2(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new Emitter$2(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(nt){const ot=nt?2:1;this._value!==ot&&(this._value=ot,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class InteractionEmitter extends Emitter$2{constructor(nt,ot){super({deliveryQueue:ot}),this._contributions=nt}fire(nt){this._contributions.onBeforeInteractionEvent(),super.fire(nt)}}class EditorContextKeysManager extends Disposable{constructor(nt,ot){super(),this._editor=nt,ot.createKey("editorId",nt.getId()),this._editorSimpleInput=EditorContextKeys.editorSimpleInput.bindTo(ot),this._editorFocus=EditorContextKeys.focus.bindTo(ot),this._textInputFocus=EditorContextKeys.textInputFocus.bindTo(ot),this._editorTextFocus=EditorContextKeys.editorTextFocus.bindTo(ot),this._editorTabMovesFocus=EditorContextKeys.tabMovesFocus.bindTo(ot),this._editorReadonly=EditorContextKeys.readOnly.bindTo(ot),this._inDiffEditor=EditorContextKeys.inDiffEditor.bindTo(ot),this._editorColumnSelection=EditorContextKeys.columnSelection.bindTo(ot),this._hasMultipleSelections=EditorContextKeys.hasMultipleSelections.bindTo(ot),this._hasNonEmptySelection=EditorContextKeys.hasNonEmptySelection.bindTo(ot),this._canUndo=EditorContextKeys.canUndo.bindTo(ot),this._canRedo=EditorContextKeys.canRedo.bindTo(ot),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(TabFocus.onDidChangeTabFocus(()=>this._editorTabMovesFocus.set(TabFocus.getTabFocusMode("editorFocus")))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const nt=this._editor.getOptions();this._editorTabMovesFocus.set(TabFocus.getTabFocusMode("editorFocus")),this._editorReadonly.set(nt.get(87)),this._inDiffEditor.set(nt.get(59)),this._editorColumnSelection.set(nt.get(20))}_updateFromSelection(){const nt=this._editor.getSelections();nt?(this._hasMultipleSelections.set(nt.length>1),this._hasNonEmptySelection.set(nt.some(ot=>!ot.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const nt=this._editor.getModel();this._canUndo.set(!!(nt&&nt.canUndo())),this._canRedo.set(!!(nt&&nt.canRedo()))}}class EditorModeContext extends Disposable{constructor(nt,ot,rt){super(),this._editor=nt,this._contextKeyService=ot,this._languageFeaturesService=rt,this._langId=EditorContextKeys.languageId.bindTo(ot),this._hasCompletionItemProvider=EditorContextKeys.hasCompletionItemProvider.bindTo(ot),this._hasCodeActionsProvider=EditorContextKeys.hasCodeActionsProvider.bindTo(ot),this._hasCodeLensProvider=EditorContextKeys.hasCodeLensProvider.bindTo(ot),this._hasDefinitionProvider=EditorContextKeys.hasDefinitionProvider.bindTo(ot),this._hasDeclarationProvider=EditorContextKeys.hasDeclarationProvider.bindTo(ot),this._hasImplementationProvider=EditorContextKeys.hasImplementationProvider.bindTo(ot),this._hasTypeDefinitionProvider=EditorContextKeys.hasTypeDefinitionProvider.bindTo(ot),this._hasHoverProvider=EditorContextKeys.hasHoverProvider.bindTo(ot),this._hasDocumentHighlightProvider=EditorContextKeys.hasDocumentHighlightProvider.bindTo(ot),this._hasDocumentSymbolProvider=EditorContextKeys.hasDocumentSymbolProvider.bindTo(ot),this._hasReferenceProvider=EditorContextKeys.hasReferenceProvider.bindTo(ot),this._hasRenameProvider=EditorContextKeys.hasRenameProvider.bindTo(ot),this._hasSignatureHelpProvider=EditorContextKeys.hasSignatureHelpProvider.bindTo(ot),this._hasInlayHintsProvider=EditorContextKeys.hasInlayHintsProvider.bindTo(ot),this._hasDocumentFormattingProvider=EditorContextKeys.hasDocumentFormattingProvider.bindTo(ot),this._hasDocumentSelectionFormattingProvider=EditorContextKeys.hasDocumentSelectionFormattingProvider.bindTo(ot),this._hasMultipleDocumentFormattingProvider=EditorContextKeys.hasMultipleDocumentFormattingProvider.bindTo(ot),this._hasMultipleDocumentSelectionFormattingProvider=EditorContextKeys.hasMultipleDocumentSelectionFormattingProvider.bindTo(ot),this._isInWalkThrough=EditorContextKeys.isInWalkThroughSnippet.bindTo(ot);const ut=()=>this._update();this._register(nt.onDidChangeModel(ut)),this._register(nt.onDidChangeModelLanguage(ut)),this._register(rt.completionProvider.onDidChange(ut)),this._register(rt.codeActionProvider.onDidChange(ut)),this._register(rt.codeLensProvider.onDidChange(ut)),this._register(rt.definitionProvider.onDidChange(ut)),this._register(rt.declarationProvider.onDidChange(ut)),this._register(rt.implementationProvider.onDidChange(ut)),this._register(rt.typeDefinitionProvider.onDidChange(ut)),this._register(rt.hoverProvider.onDidChange(ut)),this._register(rt.documentHighlightProvider.onDidChange(ut)),this._register(rt.documentSymbolProvider.onDidChange(ut)),this._register(rt.referenceProvider.onDidChange(ut)),this._register(rt.renameProvider.onDidChange(ut)),this._register(rt.documentFormattingEditProvider.onDidChange(ut)),this._register(rt.documentRangeFormattingEditProvider.onDidChange(ut)),this._register(rt.signatureHelpProvider.onDidChange(ut)),this._register(rt.inlayHintsProvider.onDidChange(ut)),ut()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()})}_update(){const nt=this._editor.getModel();if(!nt){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(nt.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(nt)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(nt)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(nt)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(nt)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(nt)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(nt)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(nt)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(nt)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(nt)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(nt)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(nt)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(nt)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(nt)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(nt)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(nt)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(nt)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(nt)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(nt).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(nt).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(nt).length>1),this._isInWalkThrough.set(nt.uri.scheme===Schemas.walkThroughSnippet)})}}class CodeEditorWidgetFocusTracker extends Disposable{constructor(nt){super(),this._onChange=this._register(new Emitter$2),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(trackFocus(nt)),this._register(this._domFocusTracker.onDidFocus(()=>{this._hasFocus=!0,this._onChange.fire(void 0)})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasFocus=!1,this._onChange.fire(void 0)}))}hasFocus(){return this._hasFocus}}class EditorDecorationsCollection{get length(){return this._decorationIds.length}constructor(nt,ot){this._editor=nt,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(ot)&&ot.length>0&&this.set(ot)}onDidChange(nt,ot,rt){return this._editor.onDidChangeModelDecorations(ut=>{this._isChangingDecorations||nt.call(ot,ut)},rt)}getRange(nt){return!this._editor.hasModel()||nt>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[nt])}getRanges(){if(!this._editor.hasModel())return[];const nt=this._editor.getModel(),ot=[];for(const rt of this._decorationIds){const ut=nt.getDecorationRange(rt);ut&&ot.push(ut)}return ot}has(nt){return this._decorationIds.includes(nt.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(nt){try{this._isChangingDecorations=!0,this._editor.changeDecorations(ot=>{this._decorationIds=ot.deltaDecorations(this._decorationIds,nt)})}finally{this._isChangingDecorations=!1}return this._decorationIds}}const squigglyStart=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),squigglyEnd=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function getSquigglySVGData(ct){return squigglyStart+encodeURIComponent(ct.toString())+squigglyEnd}const dotdotdotStart=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),dotdotdotEnd=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function getDotDotDotSVGData(ct){return dotdotdotStart+encodeURIComponent(ct.toString())+dotdotdotEnd}registerThemingParticipant((ct,nt)=>{const ot=ct.getColor(editorErrorForeground);ot&&nt.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${getSquigglySVGData(ot)}") repeat-x bottom left; }`);const rt=ct.getColor(editorWarningForeground);rt&&nt.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${getSquigglySVGData(rt)}") repeat-x bottom left; }`);const ut=ct.getColor(editorInfoForeground);ut&&nt.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${getSquigglySVGData(ut)}") repeat-x bottom left; }`);const gt=ct.getColor(editorHintForeground);gt&&nt.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${getDotDotDotSVGData(gt)}") no-repeat bottom left; }`);const pt=ct.getColor(editorUnnecessaryCodeOpacity);pt&&nt.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${pt.rgba.a}; }`)});const sash="";var __decorate$1X=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt};const DEBUG=!1;var OrthogonalEdge;(function(ct){ct.North="north",ct.South="south",ct.East="east",ct.West="west"})(OrthogonalEdge||(OrthogonalEdge={}));let globalSize=4;const onDidChangeGlobalSize=new Emitter$2;let globalHoverDelay=300;const onDidChangeHoverDelay=new Emitter$2;class MouseEventFactory{constructor(){this.disposables=new DisposableStore}get onPointerMove(){return this.disposables.add(new DomEmitter(window,"mousemove")).event}get onPointerUp(){return this.disposables.add(new DomEmitter(window,"mouseup")).event}dispose(){this.disposables.dispose()}}__decorate$1X([memoize],MouseEventFactory.prototype,"onPointerMove",null);__decorate$1X([memoize],MouseEventFactory.prototype,"onPointerUp",null);class GestureEventFactory{get onPointerMove(){return this.disposables.add(new DomEmitter(this.el,EventType.Change)).event}get onPointerUp(){return this.disposables.add(new DomEmitter(this.el,EventType.End)).event}constructor(nt){this.el=nt,this.disposables=new DisposableStore}dispose(){this.disposables.dispose()}}__decorate$1X([memoize],GestureEventFactory.prototype,"onPointerMove",null);__decorate$1X([memoize],GestureEventFactory.prototype,"onPointerUp",null);class OrthogonalPointerEventFactory{get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}constructor(nt){this.factory=nt}dispose(){}}__decorate$1X([memoize],OrthogonalPointerEventFactory.prototype,"onPointerMove",null);__decorate$1X([memoize],OrthogonalPointerEventFactory.prototype,"onPointerUp",null);const PointerEventsDisabledCssClass="pointer-events-disabled";class Sash extends Disposable{get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(nt){this._state!==nt&&(this.el.classList.toggle("disabled",nt===0),this.el.classList.toggle("minimum",nt===1),this.el.classList.toggle("maximum",nt===2),this._state=nt,this.onDidEnablementChange.fire(nt))}set orthogonalStartSash(nt){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),nt){const ot=rt=>{this.orthogonalStartDragHandleDisposables.clear(),rt!==0&&(this._orthogonalStartDragHandle=append$1(this.el,$$d(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(toDisposable(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new DomEmitter(this._orthogonalStartDragHandle,"mouseenter")).event(()=>Sash.onMouseEnter(nt),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new DomEmitter(this._orthogonalStartDragHandle,"mouseleave")).event(()=>Sash.onMouseLeave(nt),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(nt.onDidEnablementChange.event(ot,this)),ot(nt.state)}this._orthogonalStartSash=nt}set orthogonalEndSash(nt){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),nt){const ot=rt=>{this.orthogonalEndDragHandleDisposables.clear(),rt!==0&&(this._orthogonalEndDragHandle=append$1(this.el,$$d(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(toDisposable(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new DomEmitter(this._orthogonalEndDragHandle,"mouseenter")).event(()=>Sash.onMouseEnter(nt),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new DomEmitter(this._orthogonalEndDragHandle,"mouseleave")).event(()=>Sash.onMouseLeave(nt),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(nt.onDidEnablementChange.event(ot,this)),ot(nt.state)}this._orthogonalEndSash=nt}constructor(nt,ot,rt){super(),this.hoverDelay=globalHoverDelay,this.hoverDelayer=this._register(new Delayer(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new Emitter$2),this._onDidStart=this._register(new Emitter$2),this._onDidChange=this._register(new Emitter$2),this._onDidReset=this._register(new Emitter$2),this._onDidEnd=this._register(new Emitter$2),this.orthogonalStartSashDisposables=this._register(new DisposableStore),this.orthogonalStartDragHandleDisposables=this._register(new DisposableStore),this.orthogonalEndSashDisposables=this._register(new DisposableStore),this.orthogonalEndDragHandleDisposables=this._register(new DisposableStore),this.onDidStart=this._onDidStart.event,this.onDidChange=this._onDidChange.event,this.onDidReset=this._onDidReset.event,this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.el=append$1(nt,$$d(".monaco-sash")),rt.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${rt.orthogonalEdge}`),isMacintosh&&this.el.classList.add("mac");const ut=this._register(new DomEmitter(this.el,"mousedown")).event;this._register(ut(wt=>this.onPointerStart(wt,new MouseEventFactory),this));const gt=this._register(new DomEmitter(this.el,"dblclick")).event;this._register(gt(this.onPointerDoublePress,this));const pt=this._register(new DomEmitter(this.el,"mouseenter")).event;this._register(pt(()=>Sash.onMouseEnter(this)));const mt=this._register(new DomEmitter(this.el,"mouseleave")).event;this._register(mt(()=>Sash.onMouseLeave(this))),this._register(Gesture.addTarget(this.el));const vt=this._register(new DomEmitter(this.el,EventType.Start)).event;this._register(vt(wt=>this.onPointerStart(wt,new GestureEventFactory(this.el)),this));const St=this._register(new DomEmitter(this.el,EventType.Tap)).event;let yt;this._register(St(wt=>{if(yt){clearTimeout(yt),yt=void 0,this.onPointerDoublePress(wt);return}clearTimeout(yt),yt=setTimeout(()=>yt=void 0,250)},this)),typeof rt.size=="number"?(this.size=rt.size,rt.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=globalSize,this._register(onDidChangeGlobalSize.event(wt=>{this.size=wt,this.layout()}))),this._register(onDidChangeHoverDelay.event(wt=>this.hoverDelay=wt)),this.layoutProvider=ot,this.orthogonalStartSash=rt.orthogonalStartSash,this.orthogonalEndSash=rt.orthogonalEndSash,this.orientation=rt.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",DEBUG),this.layout()}onPointerStart(nt,ot){EventHelper.stop(nt);let rt=!1;if(!nt.__orthogonalSashEvent){const It=this.getOrthogonalSash(nt);It&&(rt=!0,nt.__orthogonalSashEvent=!0,It.onPointerStart(nt,new OrthogonalPointerEventFactory(ot)))}if(this.linkedSash&&!nt.__linkedSashEvent&&(nt.__linkedSashEvent=!0,this.linkedSash.onPointerStart(nt,new OrthogonalPointerEventFactory(ot))),!this.state)return;const ut=document.getElementsByTagName("iframe");for(const It of ut)It.classList.add(PointerEventsDisabledCssClass);const gt=nt.pageX,pt=nt.pageY,mt=nt.altKey,vt={startX:gt,currentX:gt,startY:pt,currentY:pt,altKey:mt};this.el.classList.add("active"),this._onDidStart.fire(vt);const St=createStyleSheet(this.el),yt=()=>{let It="";rt?It="all-scroll":this.orientation===1?this.state===1?It="s-resize":this.state===2?It="n-resize":It=isMacintosh?"row-resize":"ns-resize":this.state===1?It="e-resize":this.state===2?It="w-resize":It=isMacintosh?"col-resize":"ew-resize",St.textContent=`* { cursor: ${It} !important; }`},wt=new DisposableStore;yt(),rt||this.onDidEnablementChange.event(yt,null,wt);const Lt=It=>{EventHelper.stop(It,!1);const kt={startX:gt,currentX:It.pageX,startY:pt,currentY:It.pageY,altKey:mt};this._onDidChange.fire(kt)},xt=It=>{EventHelper.stop(It,!1),this.el.removeChild(St),this.el.classList.remove("active"),this._onDidEnd.fire(),wt.dispose();for(const kt of ut)kt.classList.remove(PointerEventsDisabledCssClass)};ot.onPointerMove(Lt,null,wt),ot.onPointerUp(xt,null,wt),wt.add(ot)}onPointerDoublePress(nt){const ot=this.getOrthogonalSash(nt);ot&&ot._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(nt,ot=!1){nt.el.classList.contains("active")?(nt.hoverDelayer.cancel(),nt.el.classList.add("hover")):nt.hoverDelayer.trigger(()=>nt.el.classList.add("hover"),nt.hoverDelay).then(void 0,()=>{}),!ot&&nt.linkedSash&&Sash.onMouseEnter(nt.linkedSash,!0)}static onMouseLeave(nt,ot=!1){nt.hoverDelayer.cancel(),nt.el.classList.remove("hover"),!ot&&nt.linkedSash&&Sash.onMouseLeave(nt.linkedSash,!0)}clearSashHoverState(){Sash.onMouseLeave(this)}layout(){if(this.orientation===0){const nt=this.layoutProvider;this.el.style.left=nt.getVerticalSashLeft(this)-this.size/2+"px",nt.getVerticalSashTop&&(this.el.style.top=nt.getVerticalSashTop(this)+"px"),nt.getVerticalSashHeight&&(this.el.style.height=nt.getVerticalSashHeight(this)+"px")}else{const nt=this.layoutProvider;this.el.style.top=nt.getHorizontalSashTop(this)-this.size/2+"px",nt.getHorizontalSashLeft&&(this.el.style.left=nt.getHorizontalSashLeft(this)+"px"),nt.getHorizontalSashWidth&&(this.el.style.width=nt.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(nt){var ot;const rt=(ot=nt.initialTarget)!==null&&ot!==void 0?ot:nt.target;if(!(!rt||!(rt instanceof HTMLElement))&&rt.classList.contains("orthogonal-drag-handle"))return rt.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}}const diffEditor="";class StableEditorScrollState{static capture(nt){if(nt.getScrollTop()===0||nt.hasPendingScrollAnimation())return new StableEditorScrollState(nt.getScrollTop(),nt.getContentHeight(),null,0,null);let ot=null,rt=0;const ut=nt.getVisibleRanges();if(ut.length>0){ot=ut[0].getStartPosition();const gt=nt.getTopForPosition(ot.lineNumber,ot.column);rt=nt.getScrollTop()-gt}return new StableEditorScrollState(nt.getScrollTop(),nt.getContentHeight(),ot,rt,nt.getPosition())}constructor(nt,ot,rt,ut,gt){this._initialScrollTop=nt,this._initialContentHeight=ot,this._visiblePosition=rt,this._visiblePositionScrollDelta=ut,this._cursorPosition=gt}restore(nt){if(!(this._initialContentHeight===nt.getContentHeight()&&this._initialScrollTop===nt.getScrollTop())&&this._visiblePosition){const ot=nt.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);nt.setScrollTop(ot+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(nt){if(this._initialContentHeight===nt.getContentHeight()&&this._initialScrollTop===nt.getScrollTop())return;const ot=nt.getPosition();if(!this._cursorPosition||!ot)return;const rt=nt.getTopForLineNumber(ot.lineNumber)-nt.getTopForLineNumber(this._cursorPosition.lineNumber);nt.setScrollTop(nt.getScrollTop()+rt)}}const diffReview="",DataTransfers={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:Mimes.text};var _a$7,_b$1;class ResourceMapEntry{constructor(nt,ot){this.uri=nt,this.value=ot}}class ResourceMap{constructor(nt,ot){this[_a$7]="ResourceMap",nt instanceof ResourceMap?(this.map=new Map(nt.map),this.toKey=ot??ResourceMap.defaultToKey):(this.map=new Map,this.toKey=nt??ResourceMap.defaultToKey)}set(nt,ot){return this.map.set(this.toKey(nt),new ResourceMapEntry(nt,ot)),this}get(nt){var ot;return(ot=this.map.get(this.toKey(nt)))===null||ot===void 0?void 0:ot.value}has(nt){return this.map.has(this.toKey(nt))}get size(){return this.map.size}clear(){this.map.clear()}delete(nt){return this.map.delete(this.toKey(nt))}forEach(nt,ot){typeof ot<"u"&&(nt=nt.bind(ot));for(const[rt,ut]of this.map)nt(ut.value,ut.uri,this)}*values(){for(const nt of this.map.values())yield nt.value}*keys(){for(const nt of this.map.values())yield nt.uri}*entries(){for(const nt of this.map.values())yield[nt.uri,nt.value]}*[(_a$7=Symbol.toStringTag,Symbol.iterator)](){for(const[,nt]of this.map)yield[nt.uri,nt.value]}}ResourceMap.defaultToKey=ct=>ct.toString();class LinkedMap{constructor(){this[_b$1]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var nt;return(nt=this._head)===null||nt===void 0?void 0:nt.value}get last(){var nt;return(nt=this._tail)===null||nt===void 0?void 0:nt.value}has(nt){return this._map.has(nt)}get(nt,ot=0){const rt=this._map.get(nt);if(rt)return ot!==0&&this.touch(rt,ot),rt.value}set(nt,ot,rt=0){let ut=this._map.get(nt);if(ut)ut.value=ot,rt!==0&&this.touch(ut,rt);else{switch(ut={key:nt,value:ot,next:void 0,previous:void 0},rt){case 0:this.addItemLast(ut);break;case 1:this.addItemFirst(ut);break;case 2:this.addItemLast(ut);break;default:this.addItemLast(ut);break}this._map.set(nt,ut),this._size++}return this}delete(nt){return!!this.remove(nt)}remove(nt){const ot=this._map.get(nt);if(ot)return this._map.delete(nt),this.removeItem(ot),this._size--,ot.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const nt=this._head;return this._map.delete(nt.key),this.removeItem(nt),this._size--,nt.value}forEach(nt,ot){const rt=this._state;let ut=this._head;for(;ut;){if(ot?nt.bind(ot)(ut.value,ut.key,this):nt(ut.value,ut.key,this),this._state!==rt)throw new Error("LinkedMap got modified during iteration.");ut=ut.next}}keys(){const nt=this,ot=this._state;let rt=this._head;const ut={[Symbol.iterator](){return ut},next(){if(nt._state!==ot)throw new Error("LinkedMap got modified during iteration.");if(rt){const gt={value:rt.key,done:!1};return rt=rt.next,gt}else return{value:void 0,done:!0}}};return ut}values(){const nt=this,ot=this._state;let rt=this._head;const ut={[Symbol.iterator](){return ut},next(){if(nt._state!==ot)throw new Error("LinkedMap got modified during iteration.");if(rt){const gt={value:rt.value,done:!1};return rt=rt.next,gt}else return{value:void 0,done:!0}}};return ut}entries(){const nt=this,ot=this._state;let rt=this._head;const ut={[Symbol.iterator](){return ut},next(){if(nt._state!==ot)throw new Error("LinkedMap got modified during iteration.");if(rt){const gt={value:[rt.key,rt.value],done:!1};return rt=rt.next,gt}else return{value:void 0,done:!0}}};return ut}[(_b$1=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(nt){if(nt>=this.size)return;if(nt===0){this.clear();return}let ot=this._head,rt=this.size;for(;ot&&rt>nt;)this._map.delete(ot.key),ot=ot.next,rt--;this._head=ot,this._size=rt,ot&&(ot.previous=void 0),this._state++}addItemFirst(nt){if(!this._head&&!this._tail)this._tail=nt;else if(this._head)nt.next=this._head,this._head.previous=nt;else throw new Error("Invalid list");this._head=nt,this._state++}addItemLast(nt){if(!this._head&&!this._tail)this._head=nt;else if(this._tail)nt.previous=this._tail,this._tail.next=nt;else throw new Error("Invalid list");this._tail=nt,this._state++}removeItem(nt){if(nt===this._head&&nt===this._tail)this._head=void 0,this._tail=void 0;else if(nt===this._head){if(!nt.next)throw new Error("Invalid list");nt.next.previous=void 0,this._head=nt.next}else if(nt===this._tail){if(!nt.previous)throw new Error("Invalid list");nt.previous.next=void 0,this._tail=nt.previous}else{const ot=nt.next,rt=nt.previous;if(!ot||!rt)throw new Error("Invalid list");ot.previous=rt,rt.next=ot}nt.next=void 0,nt.previous=void 0,this._state++}touch(nt,ot){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(ot!==1&&ot!==2)){if(ot===1){if(nt===this._head)return;const rt=nt.next,ut=nt.previous;nt===this._tail?(ut.next=void 0,this._tail=ut):(rt.previous=ut,ut.next=rt),nt.previous=void 0,nt.next=this._head,this._head.previous=nt,this._head=nt,this._state++}else if(ot===2){if(nt===this._tail)return;const rt=nt.next,ut=nt.previous;nt===this._head?(rt.previous=void 0,this._head=rt):(rt.previous=ut,ut.next=rt),nt.next=void 0,nt.previous=this._tail,this._tail.next=nt,this._tail=nt,this._state++}}}toJSON(){const nt=[];return this.forEach((ot,rt)=>{nt.push([rt,ot])}),nt}fromJSON(nt){this.clear();for(const[ot,rt]of nt)this.set(ot,rt)}}class LRUCache extends LinkedMap{constructor(nt,ot=1){super(),this._limit=nt,this._ratio=Math.min(Math.max(0,ot),1)}get limit(){return this._limit}set limit(nt){this._limit=nt,this.checkTrim()}get(nt,ot=2){return super.get(nt,ot)}peek(nt){return super.get(nt,0)}set(nt,ot){return super.set(nt,ot,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}function or(...ct){return function(nt,ot){for(let rt=0,ut=ct.length;rt<ut;rt++){const gt=ct[rt](nt,ot);if(gt)return gt}return null}}_matchesPrefix.bind(void 0,!1);const matchesPrefix=_matchesPrefix.bind(void 0,!0);function _matchesPrefix(ct,nt,ot){if(!ot||ot.length<nt.length)return null;let rt;return ct?rt=startsWithIgnoreCase(ot,nt):rt=ot.indexOf(nt)===0,rt?nt.length>0?[{start:0,end:nt.length}]:[]:null}function matchesContiguousSubString(ct,nt){const ot=nt.toLowerCase().indexOf(ct.toLowerCase());return ot===-1?null:[{start:ot,end:ot+ct.length}]}function matchesSubString(ct,nt){return _matchesSubString(ct.toLowerCase(),nt.toLowerCase(),0,0)}function _matchesSubString(ct,nt,ot,rt){if(ot===ct.length)return[];if(rt===nt.length)return null;if(ct[ot]===nt[rt]){let ut=null;return(ut=_matchesSubString(ct,nt,ot+1,rt+1))?join({start:rt,end:rt+1},ut):null}return _matchesSubString(ct,nt,ot,rt+1)}function isLower(ct){return 97<=ct&&ct<=122}function isUpper(ct){return 65<=ct&&ct<=90}function isNumber(ct){return 48<=ct&&ct<=57}function isWhitespace(ct){return ct===32||ct===9||ct===10||ct===13}const wordSeparators=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(ct=>wordSeparators.add(ct.charCodeAt(0)));function isWordSeparator(ct){return isWhitespace(ct)||wordSeparators.has(ct)}function charactersMatch(ct,nt){return ct===nt||isWordSeparator(ct)&&isWordSeparator(nt)}function isAlphanumeric(ct){return isLower(ct)||isUpper(ct)||isNumber(ct)}function join(ct,nt){return nt.length===0?nt=[ct]:ct.end===nt[0].start?nt[0].start=ct.start:nt.unshift(ct),nt}function nextAnchor(ct,nt){for(let ot=nt;ot<ct.length;ot++){const rt=ct.charCodeAt(ot);if(isUpper(rt)||isNumber(rt)||ot>0&&!isAlphanumeric(ct.charCodeAt(ot-1)))return ot}return ct.length}function _matchesCamelCase(ct,nt,ot,rt){if(ot===ct.length)return[];if(rt===nt.length)return null;if(ct[ot]!==nt[rt].toLowerCase())return null;{let ut=null,gt=rt+1;for(ut=_matchesCamelCase(ct,nt,ot+1,rt+1);!ut&&(gt=nextAnchor(nt,gt))<nt.length;)ut=_matchesCamelCase(ct,nt,ot+1,gt),gt++;return ut===null?null:join({start:rt,end:rt+1},ut)}}function analyzeCamelCaseWord(ct){let nt=0,ot=0,rt=0,ut=0,gt=0;for(let yt=0;yt<ct.length;yt++)gt=ct.charCodeAt(yt),isUpper(gt)&&nt++,isLower(gt)&&ot++,isAlphanumeric(gt)&&rt++,isNumber(gt)&&ut++;const pt=nt/ct.length,mt=ot/ct.length,vt=rt/ct.length,St=ut/ct.length;return{upperPercent:pt,lowerPercent:mt,alphaPercent:vt,numericPercent:St}}function isUpperCaseWord(ct){const{upperPercent:nt,lowerPercent:ot}=ct;return ot===0&&nt>.6}function isCamelCaseWord(ct){const{upperPercent:nt,lowerPercent:ot,alphaPercent:rt,numericPercent:ut}=ct;return ot>.2&&nt<.8&&rt>.6&&ut<.2}function isCamelCasePattern(ct){let nt=0,ot=0,rt=0,ut=0;for(let gt=0;gt<ct.length;gt++)rt=ct.charCodeAt(gt),isUpper(rt)&&nt++,isLower(rt)&&ot++,isWhitespace(rt)&&ut++;return(nt===0||ot===0)&&ut===0?ct.length<=30:nt<=5}function matchesCamelCase(ct,nt){if(!nt||(nt=nt.trim(),nt.length===0)||!isCamelCasePattern(ct)||nt.length>60)return null;const ot=analyzeCamelCaseWord(nt);if(!isCamelCaseWord(ot)){if(!isUpperCaseWord(ot))return null;nt=nt.toLowerCase()}let rt=null,ut=0;for(ct=ct.toLowerCase();ut<nt.length&&(rt=_matchesCamelCase(ct,nt,0,ut))===null;)ut=nextAnchor(nt,ut+1);return rt}function matchesWords(ct,nt,ot=!1){if(!nt||nt.length===0)return null;let rt=null,ut=0;for(ct=ct.toLowerCase(),nt=nt.toLowerCase();ut<nt.length&&(rt=_matchesWords(ct,nt,0,ut,ot))===null;)ut=nextWord(nt,ut+1);return rt}function _matchesWords(ct,nt,ot,rt,ut){if(ot===ct.length)return[];if(rt===nt.length)return null;if(charactersMatch(ct.charCodeAt(ot),nt.charCodeAt(rt))){let gt=null,pt=rt+1;if(gt=_matchesWords(ct,nt,ot+1,rt+1,ut),!ut)for(;!gt&&(pt=nextWord(nt,pt))<nt.length;)gt=_matchesWords(ct,nt,ot+1,pt,ut),pt++;return gt?ct.charCodeAt(ot)!==nt.charCodeAt(rt)?gt:join({start:rt,end:rt+1},gt):null}else return null}function nextWord(ct,nt){for(let ot=nt;ot<ct.length;ot++)if(isWordSeparator(ct.charCodeAt(ot))||ot>0&&isWordSeparator(ct.charCodeAt(ot-1)))return ot;return ct.length}const fuzzyContiguousFilter=or(matchesPrefix,matchesCamelCase,matchesContiguousSubString),fuzzySeparateFilter=or(matchesPrefix,matchesCamelCase,matchesSubString),fuzzyRegExpCache=new LRUCache(1e4);function matchesFuzzy(ct,nt,ot=!1){if(typeof ct!="string"||typeof nt!="string")return null;let rt=fuzzyRegExpCache.get(ct);rt||(rt=new RegExp(convertSimple2RegExpPattern(ct),"i"),fuzzyRegExpCache.set(ct,rt));const ut=rt.exec(nt);return ut?[{start:ut.index,end:ut.index+ut[0].length}]:ot?fuzzySeparateFilter(ct,nt):fuzzyContiguousFilter(ct,nt)}function anyScore(ct,nt,ot,rt,ut,gt){const pt=Math.min(13,ct.length);for(;ot<pt;ot++){const mt=fuzzyScore(ct,nt,ot,rt,ut,gt,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(mt)return mt}return[0,gt]}function createMatches(ct){if(typeof ct>"u")return[];const nt=[],ot=ct[1];for(let rt=ct.length-1;rt>1;rt--){const ut=ct[rt]+ot,gt=nt[nt.length-1];gt&&gt.end===ut?gt.end=ut+1:nt.push({start:ut,end:ut+1})}return nt}const _maxLen=128;function initTable(){const ct=[],nt=[];for(let ot=0;ot<=_maxLen;ot++)nt[ot]=0;for(let ot=0;ot<=_maxLen;ot++)ct.push(nt.slice(0));return ct}function initArr(ct){const nt=[];for(let ot=0;ot<=ct;ot++)nt[ot]=0;return nt}const _minWordMatchPos=initArr(2*_maxLen),_maxWordMatchPos=initArr(2*_maxLen),_diag=initTable(),_table=initTable(),_arrows=initTable();function isSeparatorAtPos(ct,nt){if(nt<0||nt>=ct.length)return!1;const ot=ct.codePointAt(nt);switch(ot){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!isEmojiImprecise(ot)}}function isWhitespaceAtPos(ct,nt){if(nt<0||nt>=ct.length)return!1;switch(ct.charCodeAt(nt)){case 32:case 9:return!0;default:return!1}}function isUpperCaseAtPos(ct,nt,ot){return nt[ct]!==ot[ct]}function isPatternInWord(ct,nt,ot,rt,ut,gt,pt=!1){for(;nt<ot&&ut<gt;)ct[nt]===rt[ut]&&(pt&&(_minWordMatchPos[nt]=ut),nt+=1),ut+=1;return nt===ot}var FuzzyScore;(function(ct){ct.Default=[-100,0];function nt(ot){return!ot||ot.length===2&&ot[0]===-100&&ot[1]===0}ct.isDefault=nt})(FuzzyScore||(FuzzyScore={}));class FuzzyScoreOptions{constructor(nt,ot){this.firstMatchCanBeWeak=nt,this.boostFullMatch=ot}}FuzzyScoreOptions.default={boostFullMatch:!0,firstMatchCanBeWeak:!1};function fuzzyScore(ct,nt,ot,rt,ut,gt,pt=FuzzyScoreOptions.default){const mt=ct.length>_maxLen?_maxLen:ct.length,vt=rt.length>_maxLen?_maxLen:rt.length;if(ot>=mt||gt>=vt||mt-ot>vt-gt||!isPatternInWord(nt,ot,mt,ut,gt,vt,!0))return;_fillInMaxWordMatchPos(mt,vt,ot,gt,nt,ut);let St=1,yt=1,wt=ot,Lt=gt;const xt=[!1];for(St=1,wt=ot;wt<mt;St++,wt++){const Rt=_minWordMatchPos[wt],Nt=_maxWordMatchPos[wt],Pt=wt+1<mt?_maxWordMatchPos[wt+1]:vt;for(yt=Rt-gt+1,Lt=Rt;Lt<Pt;yt++,Lt++){let Ft=Number.MIN_SAFE_INTEGER,Kt=!1;Lt<=Nt&&(Ft=_doScore(ct,nt,wt,ot,rt,ut,Lt,vt,gt,_diag[St-1][yt-1]===0,xt));let Bt=0;Ft!==Number.MAX_SAFE_INTEGER&&(Kt=!0,Bt=Ft+_table[St-1][yt-1]);const Ut=Lt>Rt,qt=Ut?_table[St][yt-1]+(_diag[St][yt-1]>0?-5:0):0,Yt=Lt>Rt+1&&_diag[St][yt-1]>0,Zt=Yt?_table[St][yt-2]+(_diag[St][yt-2]>0?-5:0):0;if(Yt&&(!Ut||Zt>=qt)&&(!Kt||Zt>=Bt))_table[St][yt]=Zt,_arrows[St][yt]=3,_diag[St][yt]=0;else if(Ut&&(!Kt||qt>=Bt))_table[St][yt]=qt,_arrows[St][yt]=2,_diag[St][yt]=0;else if(Kt)_table[St][yt]=Bt,_arrows[St][yt]=1,_diag[St][yt]=_diag[St-1][yt-1]+1;else throw new Error("not possible")}}if(!xt[0]&&!pt.firstMatchCanBeWeak)return;St--,yt--;const It=[_table[St][yt],gt];let kt=0,At=0;for(;St>=1;){let Rt=yt;do{const Nt=_arrows[St][Rt];if(Nt===3)Rt=Rt-2;else if(Nt===2)Rt=Rt-1;else break}while(Rt>=1);kt>1&&nt[ot+St-1]===ut[gt+yt-1]&&!isUpperCaseAtPos(Rt+gt-1,rt,ut)&&kt+1>_diag[St][Rt]&&(Rt=yt),Rt===yt?kt++:kt=1,At||(At=Rt),St--,yt=Rt-1,It.push(yt)}vt===mt&&pt.boostFullMatch&&(It[0]+=2);const Tt=At-mt;return It[0]-=Tt,It}function _fillInMaxWordMatchPos(ct,nt,ot,rt,ut,gt){let pt=ct-1,mt=nt-1;for(;pt>=ot&&mt>=rt;)ut[pt]===gt[mt]&&(_maxWordMatchPos[pt]=mt,pt--),mt--}function _doScore(ct,nt,ot,rt,ut,gt,pt,mt,vt,St,yt){if(nt[ot]!==gt[pt])return Number.MIN_SAFE_INTEGER;let wt=1,Lt=!1;return pt===ot-rt?wt=ct[ot]===ut[pt]?7:5:isUpperCaseAtPos(pt,ut,gt)&&(pt===0||!isUpperCaseAtPos(pt-1,ut,gt))?(wt=ct[ot]===ut[pt]?7:5,Lt=!0):isSeparatorAtPos(gt,pt)&&(pt===0||!isSeparatorAtPos(gt,pt-1))?wt=5:(isSeparatorAtPos(gt,pt-1)||isWhitespaceAtPos(gt,pt-1))&&(wt=5,Lt=!0),wt>1&&ot===rt&&(yt[0]=!0),Lt||(Lt=isUpperCaseAtPos(pt,ut,gt)||isSeparatorAtPos(gt,pt-1)||isWhitespaceAtPos(gt,pt-1)),ot===rt?pt>vt&&(wt-=Lt?3:5):St?wt+=Lt?2:0:wt+=Lt?0:1,pt+1===mt&&(wt-=Lt?3:5),wt}function fuzzyScoreGracefulAggressive(ct,nt,ot,rt,ut,gt,pt){return fuzzyScoreWithPermutations(ct,nt,ot,rt,ut,gt,!0,pt)}function fuzzyScoreWithPermutations(ct,nt,ot,rt,ut,gt,pt,mt){let vt=fuzzyScore(ct,nt,ot,rt,ut,gt,mt);if(vt&&!pt)return vt;if(ct.length>=3){const St=Math.min(7,ct.length-1);for(let yt=ot+1;yt<St;yt++){const wt=nextTypoPermutation(ct,yt);if(wt){const Lt=fuzzyScore(wt,wt.toLowerCase(),ot,rt,ut,gt,mt);Lt&&(Lt[0]-=3,(!vt||Lt[0]>vt[0])&&(vt=Lt))}}}return vt}function nextTypoPermutation(ct,nt){if(nt+1>=ct.length)return;const ot=ct[nt],rt=ct[nt+1];if(ot!==rt)return ct.slice(0,nt)+rt+ot+ct.slice(nt+2)}const iconStartMarker="$(",iconsRegex=new RegExp(`\\$\\(${ThemeIcon.iconNameExpression}(?:${ThemeIcon.iconModifierExpression})?\\)`,"g"),escapeIconsRegex=new RegExp(`(\\\\)?${iconsRegex.source}`,"g");function escapeIcons(ct){return ct.replace(escapeIconsRegex,(nt,ot)=>ot?nt:`\\${nt}`)}const markdownEscapedIconsRegex=new RegExp(`\\\\${iconsRegex.source}`,"g");function markdownEscapeEscapedIcons(ct){return ct.replace(markdownEscapedIconsRegex,nt=>`\\${nt}`)}const stripIconsRegex=new RegExp(`(\\s)?(\\\\)?${iconsRegex.source}(\\s)?`,"g");function stripIcons(ct){return ct.indexOf(iconStartMarker)===-1?ct:ct.replace(stripIconsRegex,(nt,ot,rt,ut)=>rt?nt:ot||ut||"")}function getCodiconAriaLabel(ct){return ct?ct.replace(/\$\((.*?)\)/g,(nt,ot)=>` ${ot} `).trim():""}const _parseIconsRegex=new RegExp(`\\$\\(${ThemeIcon.iconNameCharacter}+\\)`,"g");function parseLabelWithIcons(ct){_parseIconsRegex.lastIndex=0;let nt="";const ot=[];let rt=0;for(;;){const ut=_parseIconsRegex.lastIndex,gt=_parseIconsRegex.exec(ct),pt=ct.substring(ut,gt==null?void 0:gt.index);if(pt.length>0){nt+=pt;for(let mt=0;mt<pt.length;mt++)ot.push(rt)}if(!gt)break;rt+=gt[0].length}return{text:nt,iconOffsets:ot}}function matchesFuzzyIconAware(ct,nt,ot=!1){const{text:rt,iconOffsets:ut}=nt;if(!ut||ut.length===0)return matchesFuzzy(ct,rt,ot);const gt=ltrim(rt," "),pt=rt.length-gt.length,mt=matchesFuzzy(ct,gt,ot);if(mt)for(const vt of mt){const St=ut[vt.start+pt]+pt;vt.start+=St,vt.end+=St}return mt}class MarkdownString{constructor(nt="",ot=!1){var rt,ut,gt;if(this.value=nt,typeof this.value!="string")throw illegalArgument("value");typeof ot=="boolean"?(this.isTrusted=ot,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=(rt=ot.isTrusted)!==null&&rt!==void 0?rt:void 0,this.supportThemeIcons=(ut=ot.supportThemeIcons)!==null&&ut!==void 0?ut:!1,this.supportHtml=(gt=ot.supportHtml)!==null&&gt!==void 0?gt:!1)}appendText(nt,ot=0){return this.value+=escapeMarkdownSyntaxTokens(this.supportThemeIcons?escapeIcons(nt):nt).replace(/([ \t]+)/g,(rt,ut)=>"&nbsp;".repeat(ut.length)).replace(/\>/gm,"\\>").replace(/\n/g,ot===1?`\\
`:`

`),this}appendMarkdown(nt){return this.value+=nt,this}appendCodeblock(nt,ot){return this.value+="\n```",this.value+=nt,this.value+=`
`,this.value+=ot,this.value+="\n```\n",this}appendLink(nt,ot,rt){return this.value+="[",this.value+=this._escape(ot,"]"),this.value+="](",this.value+=this._escape(String(nt),")"),rt&&(this.value+=` "${this._escape(this._escape(rt,'"'),")")}"`),this.value+=")",this}_escape(nt,ot){const rt=new RegExp(escapeRegExpCharacters(ot),"g");return nt.replace(rt,(ut,gt)=>nt.charAt(gt-1)!=="\\"?`\\${ut}`:ut)}}function isEmptyMarkdownString(ct){return isMarkdownString(ct)?!ct.value:Array.isArray(ct)?ct.every(isEmptyMarkdownString):!0}function isMarkdownString(ct){return ct instanceof MarkdownString?!0:ct&&typeof ct=="object"?typeof ct.value=="string"&&(typeof ct.isTrusted=="boolean"||typeof ct.isTrusted=="object"||ct.isTrusted===void 0)&&(typeof ct.supportThemeIcons=="boolean"||ct.supportThemeIcons===void 0):!1}function markdownStringEqual(ct,nt){return ct===nt?!0:!ct||!nt?!1:ct.value===nt.value&&ct.isTrusted===nt.isTrusted&&ct.supportThemeIcons===nt.supportThemeIcons&&ct.supportHtml===nt.supportHtml&&(ct.baseUri===nt.baseUri||!!ct.baseUri&&!!nt.baseUri&&isEqual(URI.from(ct.baseUri),URI.from(nt.baseUri)))}function escapeMarkdownSyntaxTokens(ct){return ct.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function escapeDoubleQuotes(ct){return ct.replace(/"/g,"&quot;")}function removeMarkdownEscapes(ct){return ct&&ct.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function parseHrefAndDimensions(ct){const nt=[],ot=ct.split("|").map(ut=>ut.trim());ct=ot[0];const rt=ot[1];if(rt){const ut=/height=(\d+)/.exec(rt),gt=/width=(\d+)/.exec(rt),pt=ut?ut[1]:"",mt=gt?gt[1]:"",vt=isFinite(parseInt(mt)),St=isFinite(parseInt(pt));vt&&nt.push(`width="${mt}"`),St&&nt.push(`height="${pt}"`)}return{href:ct,dimensions:nt}}var __awaiter$1n=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function setupNativeHover(ct,nt){isString$1(nt)?ct.title=stripIcons(nt):nt!=null&&nt.markdownNotSupportedFallback?ct.title=nt.markdownNotSupportedFallback:ct.removeAttribute("title")}class UpdatableHoverWidget{constructor(nt,ot,rt){this.hoverDelegate=nt,this.target=ot,this.fadeInAnimation=rt}update(nt,ot,rt){var ut;return __awaiter$1n(this,void 0,void 0,function*(){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let gt;if(nt===void 0||isString$1(nt)||nt instanceof HTMLElement)gt=nt;else if(!isFunction(nt.markdown))gt=(ut=nt.markdown)!==null&&ut!==void 0?ut:nt.markdownNotSupportedFallback;else{this._hoverWidget||this.show(localize("iconLabel.loading","Loading..."),ot),this._cancellationTokenSource=new CancellationTokenSource$1;const pt=this._cancellationTokenSource.token;if(gt=yield nt.markdown(pt),gt===void 0&&(gt=nt.markdownNotSupportedFallback),this.isDisposed||pt.isCancellationRequested)return}this.show(gt,ot,rt)})}show(nt,ot,rt){const ut=this._hoverWidget;if(this.hasContent(nt)){const gt=Object.assign({content:nt,target:this.target,showPointer:this.hoverDelegate.placement==="element",hoverPosition:2,skipFadeInAnimation:!this.fadeInAnimation||!!ut},rt);this._hoverWidget=this.hoverDelegate.showHover(gt,ot)}ut==null||ut.dispose()}hasContent(nt){return nt?isMarkdownString(nt)?!!nt.value:!0:!1}get isDisposed(){var nt;return(nt=this._hoverWidget)===null||nt===void 0?void 0:nt.isDisposed}dispose(){var nt,ot;(nt=this._hoverWidget)===null||nt===void 0||nt.dispose(),(ot=this._cancellationTokenSource)===null||ot===void 0||ot.dispose(!0),this._cancellationTokenSource=void 0}}function setupCustomHover(ct,nt,ot,rt){let ut,gt;const pt=(wt,Lt)=>{var xt;const It=gt!==void 0;wt&&(gt==null||gt.dispose(),gt=void 0),Lt&&(ut==null||ut.dispose(),ut=void 0),It&&((xt=ct.onDidHideHover)===null||xt===void 0||xt.call(ct))},mt=(wt,Lt,xt)=>new TimeoutTimer(()=>__awaiter$1n(this,void 0,void 0,function*(){(!gt||gt.isDisposed)&&(gt=new UpdatableHoverWidget(ct,xt||nt,wt>0),yield gt.update(ot,Lt,rt))}),wt),vt=()=>{if(ut)return;const wt=new DisposableStore,Lt=kt=>pt(!1,kt.fromElement===nt);wt.add(addDisposableListener(nt,EventType$1.MOUSE_LEAVE,Lt,!0));const xt=()=>pt(!0,!0);wt.add(addDisposableListener(nt,EventType$1.MOUSE_DOWN,xt,!0));const It={targetElements:[nt],dispose:()=>{}};if(ct.placement===void 0||ct.placement==="mouse"){const kt=At=>{It.x=At.x+10,At.target instanceof HTMLElement&&At.target.classList.contains("action-label")&&pt(!0,!0)};wt.add(addDisposableListener(nt,EventType$1.MOUSE_MOVE,kt,!0))}wt.add(mt(ct.delay,!1,It)),ut=wt},St=addDisposableListener(nt,EventType$1.MOUSE_OVER,vt,!0);return{show:wt=>{pt(!1,!0),mt(0,wt)},hide:()=>{pt(!0,!0)},update:(wt,Lt)=>__awaiter$1n(this,void 0,void 0,function*(){ot=wt,yield gt==null?void 0:gt.update(ot,void 0,Lt)}),dispose:()=>{St.dispose(),pt(!0,!0)}}}function renderText(ct,nt={}){const ot=createElement(nt);return ot.textContent=ct,ot}function renderFormattedText(ct,nt={}){const ot=createElement(nt);return _renderFormattedText(ot,parseFormattedText(ct,!!nt.renderCodeSegments),nt.actionHandler,nt.renderCodeSegments),ot}function createElement(ct){const nt=ct.inline?"span":"div",ot=document.createElement(nt);return ct.className&&(ot.className=ct.className),ot}class StringStream{constructor(nt){this.source=nt,this.index=0}eos(){return this.index>=this.source.length}next(){const nt=this.peek();return this.advance(),nt}peek(){return this.source[this.index]}advance(){this.index++}}function _renderFormattedText(ct,nt,ot,rt){let ut;if(nt.type===2)ut=document.createTextNode(nt.content||"");else if(nt.type===3)ut=document.createElement("b");else if(nt.type===4)ut=document.createElement("i");else if(nt.type===7&&rt)ut=document.createElement("code");else if(nt.type===5&&ot){const gt=document.createElement("a");ot.disposables.add(addStandardDisposableListener(gt,"click",pt=>{ot.callback(String(nt.index),pt)})),ut=gt}else nt.type===8?ut=document.createElement("br"):nt.type===1&&(ut=ct);ut&&ct!==ut&&ct.appendChild(ut),ut&&Array.isArray(nt.children)&&nt.children.forEach(gt=>{_renderFormattedText(ut,gt,ot,rt)})}function parseFormattedText(ct,nt){const ot={type:1,children:[]};let rt=0,ut=ot;const gt=[],pt=new StringStream(ct);for(;!pt.eos();){let mt=pt.next();const vt=mt==="\\"&&formatTagType(pt.peek(),nt)!==0;if(vt&&(mt=pt.next()),!vt&&isFormatTag(mt,nt)&&mt===pt.peek()){pt.advance(),ut.type===2&&(ut=gt.pop());const St=formatTagType(mt,nt);if(ut.type===St||ut.type===5&&St===6)ut=gt.pop();else{const yt={type:St,children:[]};St===5&&(yt.index=rt,rt++),ut.children.push(yt),gt.push(ut),ut=yt}}else if(mt===`
`)ut.type===2&&(ut=gt.pop()),ut.children.push({type:8});else if(ut.type!==2){const St={type:2,content:mt};ut.children.push(St),gt.push(ut),ut=St}else ut.content+=mt}return ut.type===2&&(ut=gt.pop()),ot}function isFormatTag(ct,nt){return formatTagType(ct,nt)!==0}function formatTagType(ct,nt){switch(ct){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return nt?7:0;default:return 0}}const labelWithIconsRegex=new RegExp(`(\\\\)?\\$\\((${ThemeIcon.iconNameExpression}(?:${ThemeIcon.iconModifierExpression})?)\\)`,"g");function renderLabelWithIcons(ct){const nt=new Array;let ot,rt=0,ut=0;for(;(ot=labelWithIconsRegex.exec(ct))!==null;){ut=ot.index||0,rt<ut&&nt.push(ct.substring(rt,ut)),rt=(ot.index||0)+ot[0].length;const[,gt,pt]=ot;nt.push(gt?`$(${pt})`:renderIcon({id:pt}))}return rt<ct.length&&nt.push(ct.substring(rt)),nt}function renderIcon(ct){const nt=$$d("span");return nt.classList.add(...ThemeIcon.asClassNameArray(ct)),nt}class IdGenerator{constructor(nt){this._prefix=nt,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const defaultGenerator=new IdGenerator("id#");let __marked_exports={};(function(){function ct(nt,ot){ot(__marked_exports)}ct.amd=!0,function(nt,ot){typeof ct=="function"&&ct.amd?ct(["exports"],ot):typeof exports=="object"&&typeof module<"u"?ot(exports):(nt=typeof globalThis<"u"?globalThis:nt||self,ot(nt.marked={}))}(this,function(nt){function ot($t,zt){for(var jt=0;jt<zt.length;jt++){var Gt=zt[jt];Gt.enumerable=Gt.enumerable||!1,Gt.configurable=!0,"value"in Gt&&(Gt.writable=!0),Object.defineProperty($t,Gt.key,Gt)}}function rt($t,zt,jt){return zt&&ot($t.prototype,zt),jt&&ot($t,jt),Object.defineProperty($t,"prototype",{writable:!1}),$t}function ut($t,zt){if($t){if(typeof $t=="string")return gt($t,zt);var jt=Object.prototype.toString.call($t).slice(8,-1);if(jt==="Object"&&$t.constructor&&(jt=$t.constructor.name),jt==="Map"||jt==="Set")return Array.from($t);if(jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jt))return gt($t,zt)}}function gt($t,zt){(zt==null||zt>$t.length)&&(zt=$t.length);for(var jt=0,Gt=new Array(zt);jt<zt;jt++)Gt[jt]=$t[jt];return Gt}function pt($t,zt){var jt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(jt)return(jt=jt.call($t)).next.bind(jt);if(Array.isArray($t)||(jt=ut($t))||zt&&$t&&typeof $t.length=="number"){jt&&($t=jt);var Gt=0;return function(){return Gt>=$t.length?{done:!0}:{done:!1,value:$t[Gt++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mt(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}nt.defaults=mt();function vt($t){nt.defaults=$t}var St=/[&<>"']/,yt=/[&<>"']/g,wt=/[<>"']|&(?!#?\w+;)/,Lt=/[<>"']|&(?!#?\w+;)/g,xt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},It=function(zt){return xt[zt]};function kt($t,zt){if(zt){if(St.test($t))return $t.replace(yt,It)}else if(wt.test($t))return $t.replace(Lt,It);return $t}var At=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Tt($t){return $t.replace(At,function(zt,jt){return jt=jt.toLowerCase(),jt==="colon"?":":jt.charAt(0)==="#"?jt.charAt(1)==="x"?String.fromCharCode(parseInt(jt.substring(2),16)):String.fromCharCode(+jt.substring(1)):""})}var Rt=/(^|[^\[])\^/g;function Nt($t,zt){$t=typeof $t=="string"?$t:$t.source,zt=zt||"";var jt={replace:function(Qt,Jt){return Jt=Jt.source||Jt,Jt=Jt.replace(Rt,"$1"),$t=$t.replace(Qt,Jt),jt},getRegex:function(){return new RegExp($t,zt)}};return jt}var Pt=/[^\w:]/g,Ft=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function Kt($t,zt,jt){if($t){var Gt;try{Gt=decodeURIComponent(Tt(jt)).replace(Pt,"").toLowerCase()}catch{return null}if(Gt.indexOf("javascript:")===0||Gt.indexOf("vbscript:")===0||Gt.indexOf("data:")===0)return null}zt&&!Ft.test(jt)&&(jt=Zt(zt,jt));try{jt=encodeURI(jt).replace(/%25/g,"%")}catch{return null}return jt}var Bt={},Ut=/^[^:]+:\/*[^/]*$/,qt=/^([^:]+:)[\s\S]*$/,Yt=/^([^:]+:\/*[^/]*)[\s\S]*$/;function Zt($t,zt){Bt[" "+$t]||(Ut.test($t)?Bt[" "+$t]=$t+"/":Bt[" "+$t]=rn($t,"/",!0)),$t=Bt[" "+$t];var jt=$t.indexOf(":")===-1;return zt.substring(0,2)==="//"?jt?zt:$t.replace(qt,"$1")+zt:zt.charAt(0)==="/"?jt?zt:$t.replace(Yt,"$1")+zt:$t+zt}var Xt={exec:function(){}};function _i($t){for(var zt=1,jt,Gt;zt<arguments.length;zt++){jt=arguments[zt];for(Gt in jt)Object.prototype.hasOwnProperty.call(jt,Gt)&&($t[Gt]=jt[Gt])}return $t}function nn($t,zt){var jt=$t.replace(/\|/g,function(Jt,en,sn){for(var gn=!1,mn=en;--mn>=0&&sn[mn]==="\\";)gn=!gn;return gn?"|":" |"}),Gt=jt.split(/ \|/),Qt=0;if(Gt[0].trim()||Gt.shift(),Gt.length>0&&!Gt[Gt.length-1].trim()&&Gt.pop(),Gt.length>zt)Gt.splice(zt);else for(;Gt.length<zt;)Gt.push("");for(;Qt<Gt.length;Qt++)Gt[Qt]=Gt[Qt].trim().replace(/\\\|/g,"|");return Gt}function rn($t,zt,jt){var Gt=$t.length;if(Gt===0)return"";for(var Qt=0;Qt<Gt;){var Jt=$t.charAt(Gt-Qt-1);if(Jt===zt&&!jt)Qt++;else if(Jt!==zt&&jt)Qt++;else break}return $t.slice(0,Gt-Qt)}function dn($t,zt){if($t.indexOf(zt[1])===-1)return-1;for(var jt=$t.length,Gt=0,Qt=0;Qt<jt;Qt++)if($t[Qt]==="\\")Qt++;else if($t[Qt]===zt[0])Gt++;else if($t[Qt]===zt[1]&&(Gt--,Gt<0))return Qt;return-1}function bn($t){$t&&$t.sanitize&&!$t.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function un($t,zt){if(zt<1)return"";for(var jt="";zt>1;)zt&1&&(jt+=$t),zt>>=1,$t+=$t;return jt+$t}function an($t,zt,jt,Gt){var Qt=zt.href,Jt=zt.title?kt(zt.title):null,en=$t[1].replace(/\\([\[\]])/g,"$1");if($t[0].charAt(0)!=="!"){Gt.state.inLink=!0;var sn={type:"link",raw:jt,href:Qt,title:Jt,text:en,tokens:Gt.inlineTokens(en)};return Gt.state.inLink=!1,sn}return{type:"image",raw:jt,href:Qt,title:Jt,text:kt(en)}}function Cn($t,zt){var jt=$t.match(/^(\s+)(?:```)/);if(jt===null)return zt;var Gt=jt[1];return zt.split(`
`).map(function(Qt){var Jt=Qt.match(/^\s+/);if(Jt===null)return Qt;var en=Jt[0];return en.length>=Gt.length?Qt.slice(Gt.length):Qt}).join(`
`)}var _n=function(){function $t(jt){this.options=jt||nt.defaults}var zt=$t.prototype;return zt.space=function(Gt){var Qt=this.rules.block.newline.exec(Gt);if(Qt&&Qt[0].length>0)return{type:"space",raw:Qt[0]}},zt.code=function(Gt){var Qt=this.rules.block.code.exec(Gt);if(Qt){var Jt=Qt[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:Qt[0],codeBlockStyle:"indented",text:this.options.pedantic?Jt:rn(Jt,`
`)}}},zt.fences=function(Gt){var Qt=this.rules.block.fences.exec(Gt);if(Qt){var Jt=Qt[0],en=Cn(Jt,Qt[3]||"");return{type:"code",raw:Jt,lang:Qt[2]?Qt[2].trim():Qt[2],text:en}}},zt.heading=function(Gt){var Qt=this.rules.block.heading.exec(Gt);if(Qt){var Jt=Qt[2].trim();if(/#$/.test(Jt)){var en=rn(Jt,"#");(this.options.pedantic||!en||/ $/.test(en))&&(Jt=en.trim())}return{type:"heading",raw:Qt[0],depth:Qt[1].length,text:Jt,tokens:this.lexer.inline(Jt)}}},zt.hr=function(Gt){var Qt=this.rules.block.hr.exec(Gt);if(Qt)return{type:"hr",raw:Qt[0]}},zt.blockquote=function(Gt){var Qt=this.rules.block.blockquote.exec(Gt);if(Qt){var Jt=Qt[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:Qt[0],tokens:this.lexer.blockTokens(Jt,[]),text:Jt}}},zt.list=function(Gt){var Qt=this.rules.block.list.exec(Gt);if(Qt){var Jt,en,sn,gn,mn,vn,En,Dn,An,Rn,Ln,Pn,On=Qt[1].trim(),to=On.length>1,Fn={type:"list",raw:"",ordered:to,start:to?+On.slice(0,-1):"",loose:!1,items:[]};On=to?"\\d{1,9}\\"+On.slice(-1):"\\"+On,this.options.pedantic&&(On=to?On:"[*+-]");for(var zn=new RegExp("^( {0,3}"+On+")((?:[	 ][^\\n]*)?(?:\\n|$))");Gt&&(Pn=!1,!(!(Qt=zn.exec(Gt))||this.rules.block.hr.test(Gt)));){if(Jt=Qt[0],Gt=Gt.substring(Jt.length),Dn=Qt[2].split(`
`,1)[0],An=Gt.split(`
`,1)[0],this.options.pedantic?(gn=2,Ln=Dn.trimLeft()):(gn=Qt[2].search(/[^ ]/),gn=gn>4?1:gn,Ln=Dn.slice(gn),gn+=Qt[1].length),vn=!1,!Dn&&/^ *$/.test(An)&&(Jt+=An+`
`,Gt=Gt.substring(An.length+1),Pn=!0),!Pn)for(var lo=new RegExp("^ {0,"+Math.min(3,gn-1)+"}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))"),eo=new RegExp("^ {0,"+Math.min(3,gn-1)+"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)"),oo=new RegExp("^ {0,"+Math.min(3,gn-1)+"}(?:```|~~~)"),ao=new RegExp("^ {0,"+Math.min(3,gn-1)+"}#");Gt&&(Rn=Gt.split(`
`,1)[0],Dn=Rn,this.options.pedantic&&(Dn=Dn.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(oo.test(Dn)||ao.test(Dn)||lo.test(Dn)||eo.test(Gt)));){if(Dn.search(/[^ ]/)>=gn||!Dn.trim())Ln+=`
`+Dn.slice(gn);else if(!vn)Ln+=`
`+Dn;else break;!vn&&!Dn.trim()&&(vn=!0),Jt+=Rn+`
`,Gt=Gt.substring(Rn.length+1)}Fn.loose||(En?Fn.loose=!0:/\n *\n *$/.test(Jt)&&(En=!0)),this.options.gfm&&(en=/^\[[ xX]\] /.exec(Ln),en&&(sn=en[0]!=="[ ] ",Ln=Ln.replace(/^\[[ xX]\] +/,""))),Fn.items.push({type:"list_item",raw:Jt,task:!!en,checked:sn,loose:!1,text:Ln}),Fn.raw+=Jt}Fn.items[Fn.items.length-1].raw=Jt.trimRight(),Fn.items[Fn.items.length-1].text=Ln.trimRight(),Fn.raw=Fn.raw.trimRight();var co=Fn.items.length;for(mn=0;mn<co;mn++){this.lexer.state.top=!1,Fn.items[mn].tokens=this.lexer.blockTokens(Fn.items[mn].text,[]);var uo=Fn.items[mn].tokens.filter(function(io){return io.type==="space"}),ho=uo.every(function(io){for(var ko=io.raw.split(""),bo=0,To=pt(ko),Ro;!(Ro=To()).done;){var Tn=Ro.value;if(Tn===`
`&&(bo+=1),bo>1)return!0}return!1});!Fn.loose&&uo.length&&ho&&(Fn.loose=!0,Fn.items[mn].loose=!0)}return Fn}},zt.html=function(Gt){var Qt=this.rules.block.html.exec(Gt);if(Qt){var Jt={type:"html",raw:Qt[0],pre:!this.options.sanitizer&&(Qt[1]==="pre"||Qt[1]==="script"||Qt[1]==="style"),text:Qt[0]};if(this.options.sanitize){var en=this.options.sanitizer?this.options.sanitizer(Qt[0]):kt(Qt[0]);Jt.type="paragraph",Jt.text=en,Jt.tokens=this.lexer.inline(en)}return Jt}},zt.def=function(Gt){var Qt=this.rules.block.def.exec(Gt);if(Qt){Qt[3]&&(Qt[3]=Qt[3].substring(1,Qt[3].length-1));var Jt=Qt[1].toLowerCase().replace(/\s+/g," ");return{type:"def",tag:Jt,raw:Qt[0],href:Qt[2],title:Qt[3]}}},zt.table=function(Gt){var Qt=this.rules.block.table.exec(Gt);if(Qt){var Jt={type:"table",header:nn(Qt[1]).map(function(En){return{text:En}}),align:Qt[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:Qt[3]&&Qt[3].trim()?Qt[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(Jt.header.length===Jt.align.length){Jt.raw=Qt[0];var en=Jt.align.length,sn,gn,mn,vn;for(sn=0;sn<en;sn++)/^ *-+: *$/.test(Jt.align[sn])?Jt.align[sn]="right":/^ *:-+: *$/.test(Jt.align[sn])?Jt.align[sn]="center":/^ *:-+ *$/.test(Jt.align[sn])?Jt.align[sn]="left":Jt.align[sn]=null;for(en=Jt.rows.length,sn=0;sn<en;sn++)Jt.rows[sn]=nn(Jt.rows[sn],Jt.header.length).map(function(En){return{text:En}});for(en=Jt.header.length,gn=0;gn<en;gn++)Jt.header[gn].tokens=this.lexer.inline(Jt.header[gn].text);for(en=Jt.rows.length,gn=0;gn<en;gn++)for(vn=Jt.rows[gn],mn=0;mn<vn.length;mn++)vn[mn].tokens=this.lexer.inline(vn[mn].text);return Jt}}},zt.lheading=function(Gt){var Qt=this.rules.block.lheading.exec(Gt);if(Qt)return{type:"heading",raw:Qt[0],depth:Qt[2].charAt(0)==="="?1:2,text:Qt[1],tokens:this.lexer.inline(Qt[1])}},zt.paragraph=function(Gt){var Qt=this.rules.block.paragraph.exec(Gt);if(Qt){var Jt=Qt[1].charAt(Qt[1].length-1)===`
`?Qt[1].slice(0,-1):Qt[1];return{type:"paragraph",raw:Qt[0],text:Jt,tokens:this.lexer.inline(Jt)}}},zt.text=function(Gt){var Qt=this.rules.block.text.exec(Gt);if(Qt)return{type:"text",raw:Qt[0],text:Qt[0],tokens:this.lexer.inline(Qt[0])}},zt.escape=function(Gt){var Qt=this.rules.inline.escape.exec(Gt);if(Qt)return{type:"escape",raw:Qt[0],text:kt(Qt[1])}},zt.tag=function(Gt){var Qt=this.rules.inline.tag.exec(Gt);if(Qt)return!this.lexer.state.inLink&&/^<a /i.test(Qt[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(Qt[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(Qt[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(Qt[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:Qt[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(Qt[0]):kt(Qt[0]):Qt[0]}},zt.link=function(Gt){var Qt=this.rules.inline.link.exec(Gt);if(Qt){var Jt=Qt[2].trim();if(!this.options.pedantic&&/^</.test(Jt)){if(!/>$/.test(Jt))return;var en=rn(Jt.slice(0,-1),"\\");if((Jt.length-en.length)%2===0)return}else{var sn=dn(Qt[2],"()");if(sn>-1){var gn=Qt[0].indexOf("!")===0?5:4,mn=gn+Qt[1].length+sn;Qt[2]=Qt[2].substring(0,sn),Qt[0]=Qt[0].substring(0,mn).trim(),Qt[3]=""}}var vn=Qt[2],En="";if(this.options.pedantic){var Dn=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(vn);Dn&&(vn=Dn[1],En=Dn[3])}else En=Qt[3]?Qt[3].slice(1,-1):"";return vn=vn.trim(),/^</.test(vn)&&(this.options.pedantic&&!/>$/.test(Jt)?vn=vn.slice(1):vn=vn.slice(1,-1)),an(Qt,{href:vn&&vn.replace(this.rules.inline._escapes,"$1"),title:En&&En.replace(this.rules.inline._escapes,"$1")},Qt[0],this.lexer)}},zt.reflink=function(Gt,Qt){var Jt;if((Jt=this.rules.inline.reflink.exec(Gt))||(Jt=this.rules.inline.nolink.exec(Gt))){var en=(Jt[2]||Jt[1]).replace(/\s+/g," ");if(en=Qt[en.toLowerCase()],!en||!en.href){var sn=Jt[0].charAt(0);return{type:"text",raw:sn,text:sn}}return an(Jt,en,Jt[0],this.lexer)}},zt.emStrong=function(Gt,Qt,Jt){Jt===void 0&&(Jt="");var en=this.rules.inline.emStrong.lDelim.exec(Gt);if(en&&!(en[3]&&Jt.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var sn=en[1]||en[2]||"";if(!sn||sn&&(Jt===""||this.rules.inline.punctuation.exec(Jt))){var gn=en[0].length-1,mn,vn,En=gn,Dn=0,An=en[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(An.lastIndex=0,Qt=Qt.slice(-1*Gt.length+gn);(en=An.exec(Qt))!=null;)if(mn=en[1]||en[2]||en[3]||en[4]||en[5]||en[6],!!mn){if(vn=mn.length,en[3]||en[4]){En+=vn;continue}else if((en[5]||en[6])&&gn%3&&!((gn+vn)%3)){Dn+=vn;continue}if(En-=vn,!(En>0)){if(vn=Math.min(vn,vn+En+Dn),Math.min(gn,vn)%2){var Rn=Gt.slice(1,gn+en.index+vn);return{type:"em",raw:Gt.slice(0,gn+en.index+vn+1),text:Rn,tokens:this.lexer.inlineTokens(Rn)}}var Ln=Gt.slice(2,gn+en.index+vn-1);return{type:"strong",raw:Gt.slice(0,gn+en.index+vn+1),text:Ln,tokens:this.lexer.inlineTokens(Ln)}}}}}},zt.codespan=function(Gt){var Qt=this.rules.inline.code.exec(Gt);if(Qt){var Jt=Qt[2].replace(/\n/g," "),en=/[^ ]/.test(Jt),sn=/^ /.test(Jt)&&/ $/.test(Jt);return en&&sn&&(Jt=Jt.substring(1,Jt.length-1)),Jt=kt(Jt,!0),{type:"codespan",raw:Qt[0],text:Jt}}},zt.br=function(Gt){var Qt=this.rules.inline.br.exec(Gt);if(Qt)return{type:"br",raw:Qt[0]}},zt.del=function(Gt){var Qt=this.rules.inline.del.exec(Gt);if(Qt)return{type:"del",raw:Qt[0],text:Qt[2],tokens:this.lexer.inlineTokens(Qt[2])}},zt.autolink=function(Gt,Qt){var Jt=this.rules.inline.autolink.exec(Gt);if(Jt){var en,sn;return Jt[2]==="@"?(en=kt(this.options.mangle?Qt(Jt[1]):Jt[1]),sn="mailto:"+en):(en=kt(Jt[1]),sn=en),{type:"link",raw:Jt[0],text:en,href:sn,tokens:[{type:"text",raw:en,text:en}]}}},zt.url=function(Gt,Qt){var Jt;if(Jt=this.rules.inline.url.exec(Gt)){var en,sn;if(Jt[2]==="@")en=kt(this.options.mangle?Qt(Jt[0]):Jt[0]),sn="mailto:"+en;else{var gn;do gn=Jt[0],Jt[0]=this.rules.inline._backpedal.exec(Jt[0])[0];while(gn!==Jt[0]);en=kt(Jt[0]),Jt[1]==="www."?sn="http://"+en:sn=en}return{type:"link",raw:Jt[0],text:en,href:sn,tokens:[{type:"text",raw:en,text:en}]}}},zt.inlineText=function(Gt,Qt){var Jt=this.rules.inline.text.exec(Gt);if(Jt){var en;return this.lexer.state.inRawBlock?en=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(Jt[0]):kt(Jt[0]):Jt[0]:en=kt(this.options.smartypants?Qt(Jt[0]):Jt[0]),{type:"text",raw:Jt[0],text:en}}},$t}(),hn={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Xt,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};hn._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/,hn._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,hn.def=Nt(hn.def).replace("label",hn._label).replace("title",hn._title).getRegex(),hn.bullet=/(?:[*+-]|\d{1,9}[.)])/,hn.listItemStart=Nt(/^( *)(bull) */).replace("bull",hn.bullet).getRegex(),hn.list=Nt(hn.list).replace(/bull/g,hn.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+hn.def.source+")").getRegex(),hn._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",hn._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,hn.html=Nt(hn.html,"i").replace("comment",hn._comment).replace("tag",hn._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),hn.paragraph=Nt(hn._paragraph).replace("hr",hn.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hn._tag).getRegex(),hn.blockquote=Nt(hn.blockquote).replace("paragraph",hn.paragraph).getRegex(),hn.normal=_i({},hn),hn.gfm=_i({},hn.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),hn.gfm.table=Nt(hn.gfm.table).replace("hr",hn.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hn._tag).getRegex(),hn.gfm.paragraph=Nt(hn._paragraph).replace("hr",hn.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",hn.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hn._tag).getRegex(),hn.pedantic=_i({},hn.normal,{html:Nt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",hn._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Xt,paragraph:Nt(hn.normal._paragraph).replace("hr",hn.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",hn.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var pn={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Xt,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Xt,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};pn._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",pn.punctuation=Nt(pn.punctuation).replace(/punctuation/g,pn._punctuation).getRegex(),pn.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,pn.escapedEmSt=/\\\*|\\_/g,pn._comment=Nt(hn._comment).replace("(?:-->|$)","-->").getRegex(),pn.emStrong.lDelim=Nt(pn.emStrong.lDelim).replace(/punct/g,pn._punctuation).getRegex(),pn.emStrong.rDelimAst=Nt(pn.emStrong.rDelimAst,"g").replace(/punct/g,pn._punctuation).getRegex(),pn.emStrong.rDelimUnd=Nt(pn.emStrong.rDelimUnd,"g").replace(/punct/g,pn._punctuation).getRegex(),pn._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,pn._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,pn._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,pn.autolink=Nt(pn.autolink).replace("scheme",pn._scheme).replace("email",pn._email).getRegex(),pn._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,pn.tag=Nt(pn.tag).replace("comment",pn._comment).replace("attribute",pn._attribute).getRegex(),pn._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,pn._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,pn._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,pn.link=Nt(pn.link).replace("label",pn._label).replace("href",pn._href).replace("title",pn._title).getRegex(),pn.reflink=Nt(pn.reflink).replace("label",pn._label).replace("ref",hn._label).getRegex(),pn.nolink=Nt(pn.nolink).replace("ref",hn._label).getRegex(),pn.reflinkSearch=Nt(pn.reflinkSearch,"g").replace("reflink",pn.reflink).replace("nolink",pn.nolink).getRegex(),pn.normal=_i({},pn),pn.pedantic=_i({},pn.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Nt(/^!?\[(label)\]\((.*?)\)/).replace("label",pn._label).getRegex(),reflink:Nt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",pn._label).getRegex()}),pn.gfm=_i({},pn.normal,{escape:Nt(pn.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),pn.gfm.url=Nt(pn.gfm.url,"i").replace("email",pn.gfm._extended_email).getRegex(),pn.breaks=_i({},pn.gfm,{br:Nt(pn.br).replace("{2,}","*").getRegex(),text:Nt(pn.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function yn($t){return $t.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function Mn($t){var zt="",jt,Gt,Qt=$t.length;for(jt=0;jt<Qt;jt++)Gt=$t.charCodeAt(jt),Math.random()>.5&&(Gt="x"+Gt.toString(16)),zt+="&#"+Gt+";";return zt}var Nn=function(){function $t(jt){this.tokens=[],this.tokens.links=Object.create(null),this.options=jt||nt.defaults,this.options.tokenizer=this.options.tokenizer||new _n,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var Gt={block:hn.normal,inline:pn.normal};this.options.pedantic?(Gt.block=hn.pedantic,Gt.inline=pn.pedantic):this.options.gfm&&(Gt.block=hn.gfm,this.options.breaks?Gt.inline=pn.breaks:Gt.inline=pn.gfm),this.tokenizer.rules=Gt}$t.lex=function(Gt,Qt){var Jt=new $t(Qt);return Jt.lex(Gt)},$t.lexInline=function(Gt,Qt){var Jt=new $t(Qt);return Jt.inlineTokens(Gt)};var zt=$t.prototype;return zt.lex=function(Gt){Gt=Gt.replace(/\r\n|\r/g,`
`),this.blockTokens(Gt,this.tokens);for(var Qt;Qt=this.inlineQueue.shift();)this.inlineTokens(Qt.src,Qt.tokens);return this.tokens},zt.blockTokens=function(Gt,Qt){var Jt=this;Qt===void 0&&(Qt=[]),this.options.pedantic?Gt=Gt.replace(/\t/g,"    ").replace(/^ +$/gm,""):Gt=Gt.replace(/^( *)(\t+)/gm,function(En,Dn,An){return Dn+"    ".repeat(An.length)});for(var en,sn,gn,mn;Gt;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(En){return(en=En.call({lexer:Jt},Gt,Qt))?(Gt=Gt.substring(en.raw.length),Qt.push(en),!0):!1}))){if(en=this.tokenizer.space(Gt)){Gt=Gt.substring(en.raw.length),en.raw.length===1&&Qt.length>0?Qt[Qt.length-1].raw+=`
`:Qt.push(en);continue}if(en=this.tokenizer.code(Gt)){Gt=Gt.substring(en.raw.length),sn=Qt[Qt.length-1],sn&&(sn.type==="paragraph"||sn.type==="text")?(sn.raw+=`
`+en.raw,sn.text+=`
`+en.text,this.inlineQueue[this.inlineQueue.length-1].src=sn.text):Qt.push(en);continue}if(en=this.tokenizer.fences(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.heading(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.hr(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.blockquote(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.list(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.html(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.def(Gt)){Gt=Gt.substring(en.raw.length),sn=Qt[Qt.length-1],sn&&(sn.type==="paragraph"||sn.type==="text")?(sn.raw+=`
`+en.raw,sn.text+=`
`+en.raw,this.inlineQueue[this.inlineQueue.length-1].src=sn.text):this.tokens.links[en.tag]||(this.tokens.links[en.tag]={href:en.href,title:en.title});continue}if(en=this.tokenizer.table(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.lheading(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(gn=Gt,this.options.extensions&&this.options.extensions.startBlock&&function(){var En=1/0,Dn=Gt.slice(1),An=void 0;Jt.options.extensions.startBlock.forEach(function(Rn){An=Rn.call({lexer:this},Dn),typeof An=="number"&&An>=0&&(En=Math.min(En,An))}),En<1/0&&En>=0&&(gn=Gt.substring(0,En+1))}(),this.state.top&&(en=this.tokenizer.paragraph(gn))){sn=Qt[Qt.length-1],mn&&sn.type==="paragraph"?(sn.raw+=`
`+en.raw,sn.text+=`
`+en.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=sn.text):Qt.push(en),mn=gn.length!==Gt.length,Gt=Gt.substring(en.raw.length);continue}if(en=this.tokenizer.text(Gt)){Gt=Gt.substring(en.raw.length),sn=Qt[Qt.length-1],sn&&sn.type==="text"?(sn.raw+=`
`+en.raw,sn.text+=`
`+en.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=sn.text):Qt.push(en);continue}if(Gt){var vn="Infinite loop on byte: "+Gt.charCodeAt(0);if(this.options.silent){console.error(vn);break}else throw new Error(vn)}}return this.state.top=!0,Qt},zt.inline=function(Gt,Qt){return Qt===void 0&&(Qt=[]),this.inlineQueue.push({src:Gt,tokens:Qt}),Qt},zt.inlineTokens=function(Gt,Qt){var Jt=this;Qt===void 0&&(Qt=[]);var en,sn,gn,mn=Gt,vn,En,Dn;if(this.tokens.links){var An=Object.keys(this.tokens.links);if(An.length>0)for(;(vn=this.tokenizer.rules.inline.reflinkSearch.exec(mn))!=null;)An.includes(vn[0].slice(vn[0].lastIndexOf("[")+1,-1))&&(mn=mn.slice(0,vn.index)+"["+un("a",vn[0].length-2)+"]"+mn.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(vn=this.tokenizer.rules.inline.blockSkip.exec(mn))!=null;)mn=mn.slice(0,vn.index)+"["+un("a",vn[0].length-2)+"]"+mn.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(vn=this.tokenizer.rules.inline.escapedEmSt.exec(mn))!=null;)mn=mn.slice(0,vn.index)+"++"+mn.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;Gt;)if(En||(Dn=""),En=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(Ln){return(en=Ln.call({lexer:Jt},Gt,Qt))?(Gt=Gt.substring(en.raw.length),Qt.push(en),!0):!1}))){if(en=this.tokenizer.escape(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.tag(Gt)){Gt=Gt.substring(en.raw.length),sn=Qt[Qt.length-1],sn&&en.type==="text"&&sn.type==="text"?(sn.raw+=en.raw,sn.text+=en.text):Qt.push(en);continue}if(en=this.tokenizer.link(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.reflink(Gt,this.tokens.links)){Gt=Gt.substring(en.raw.length),sn=Qt[Qt.length-1],sn&&en.type==="text"&&sn.type==="text"?(sn.raw+=en.raw,sn.text+=en.text):Qt.push(en);continue}if(en=this.tokenizer.emStrong(Gt,mn,Dn)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.codespan(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.br(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.del(Gt)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(en=this.tokenizer.autolink(Gt,Mn)){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(!this.state.inLink&&(en=this.tokenizer.url(Gt,Mn))){Gt=Gt.substring(en.raw.length),Qt.push(en);continue}if(gn=Gt,this.options.extensions&&this.options.extensions.startInline&&function(){var Ln=1/0,Pn=Gt.slice(1),On=void 0;Jt.options.extensions.startInline.forEach(function(to){On=to.call({lexer:this},Pn),typeof On=="number"&&On>=0&&(Ln=Math.min(Ln,On))}),Ln<1/0&&Ln>=0&&(gn=Gt.substring(0,Ln+1))}(),en=this.tokenizer.inlineText(gn,yn)){Gt=Gt.substring(en.raw.length),en.raw.slice(-1)!=="_"&&(Dn=en.raw.slice(-1)),En=!0,sn=Qt[Qt.length-1],sn&&sn.type==="text"?(sn.raw+=en.raw,sn.text+=en.text):Qt.push(en);continue}if(Gt){var Rn="Infinite loop on byte: "+Gt.charCodeAt(0);if(this.options.silent){console.error(Rn);break}else throw new Error(Rn)}}return Qt},rt($t,null,[{key:"rules",get:function(){return{block:hn,inline:pn}}}]),$t}(),Wn=function(){function $t(jt){this.options=jt||nt.defaults}var zt=$t.prototype;return zt.code=function(Gt,Qt,Jt){var en=(Qt||"").match(/\S*/)[0];if(this.options.highlight){var sn=this.options.highlight(Gt,en);sn!=null&&sn!==Gt&&(Jt=!0,Gt=sn)}return Gt=Gt.replace(/\n$/,"")+`
`,en?'<pre><code class="'+this.options.langPrefix+kt(en,!0)+'">'+(Jt?Gt:kt(Gt,!0))+`</code></pre>
`:"<pre><code>"+(Jt?Gt:kt(Gt,!0))+`</code></pre>
`},zt.blockquote=function(Gt){return`<blockquote>
`+Gt+`</blockquote>
`},zt.html=function(Gt){return Gt},zt.heading=function(Gt,Qt,Jt,en){if(this.options.headerIds){var sn=this.options.headerPrefix+en.slug(Jt);return"<h"+Qt+' id="'+sn+'">'+Gt+"</h"+Qt+`>
`}return"<h"+Qt+">"+Gt+"</h"+Qt+`>
`},zt.hr=function(){return this.options.xhtml?`<hr/>
`:`<hr>
`},zt.list=function(Gt,Qt,Jt){var en=Qt?"ol":"ul",sn=Qt&&Jt!==1?' start="'+Jt+'"':"";return"<"+en+sn+`>
`+Gt+"</"+en+`>
`},zt.listitem=function(Gt){return"<li>"+Gt+`</li>
`},zt.checkbox=function(Gt){return"<input "+(Gt?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},zt.paragraph=function(Gt){return"<p>"+Gt+`</p>
`},zt.table=function(Gt,Qt){return Qt&&(Qt="<tbody>"+Qt+"</tbody>"),`<table>
<thead>
`+Gt+`</thead>
`+Qt+`</table>
`},zt.tablerow=function(Gt){return`<tr>
`+Gt+`</tr>
`},zt.tablecell=function(Gt,Qt){var Jt=Qt.header?"th":"td",en=Qt.align?"<"+Jt+' align="'+Qt.align+'">':"<"+Jt+">";return en+Gt+("</"+Jt+`>
`)},zt.strong=function(Gt){return"<strong>"+Gt+"</strong>"},zt.em=function(Gt){return"<em>"+Gt+"</em>"},zt.codespan=function(Gt){return"<code>"+Gt+"</code>"},zt.br=function(){return this.options.xhtml?"<br/>":"<br>"},zt.del=function(Gt){return"<del>"+Gt+"</del>"},zt.link=function(Gt,Qt,Jt){if(Gt=Kt(this.options.sanitize,this.options.baseUrl,Gt),Gt===null)return Jt;var en='<a href="'+kt(Gt)+'"';return Qt&&(en+=' title="'+Qt+'"'),en+=">"+Jt+"</a>",en},zt.image=function(Gt,Qt,Jt){if(Gt=Kt(this.options.sanitize,this.options.baseUrl,Gt),Gt===null)return Jt;var en='<img src="'+Gt+'" alt="'+Jt+'"';return Qt&&(en+=' title="'+Qt+'"'),en+=this.options.xhtml?"/>":">",en},zt.text=function(Gt){return Gt},$t}(),Jn=function(){function $t(){}var zt=$t.prototype;return zt.strong=function(Gt){return Gt},zt.em=function(Gt){return Gt},zt.codespan=function(Gt){return Gt},zt.del=function(Gt){return Gt},zt.html=function(Gt){return Gt},zt.text=function(Gt){return Gt},zt.link=function(Gt,Qt,Jt){return""+Jt},zt.image=function(Gt,Qt,Jt){return""+Jt},zt.br=function(){return""},$t}(),Xn=function(){function $t(){this.seen={}}var zt=$t.prototype;return zt.serialize=function(Gt){return Gt.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},zt.getNextSafeSlug=function(Gt,Qt){var Jt=Gt,en=0;if(this.seen.hasOwnProperty(Jt)){en=this.seen[Gt];do en++,Jt=Gt+"-"+en;while(this.seen.hasOwnProperty(Jt))}return Qt||(this.seen[Gt]=en,this.seen[Jt]=0),Jt},zt.slug=function(Gt,Qt){Qt===void 0&&(Qt={});var Jt=this.serialize(Gt);return this.getNextSafeSlug(Jt,Qt.dryrun)},$t}(),Un=function(){function $t(jt){this.options=jt||nt.defaults,this.options.renderer=this.options.renderer||new Wn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Jn,this.slugger=new Xn}$t.parse=function(Gt,Qt){var Jt=new $t(Qt);return Jt.parse(Gt)},$t.parseInline=function(Gt,Qt){var Jt=new $t(Qt);return Jt.parseInline(Gt)};var zt=$t.prototype;return zt.parse=function(Gt,Qt){Qt===void 0&&(Qt=!0);var Jt="",en,sn,gn,mn,vn,En,Dn,An,Rn,Ln,Pn,On,to,Fn,zn,lo,eo,oo,ao,co=Gt.length;for(en=0;en<co;en++){if(Ln=Gt[en],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Ln.type]&&(ao=this.options.extensions.renderers[Ln.type].call({parser:this},Ln),ao!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(Ln.type))){Jt+=ao||"";continue}switch(Ln.type){case"space":continue;case"hr":{Jt+=this.renderer.hr();continue}case"heading":{Jt+=this.renderer.heading(this.parseInline(Ln.tokens),Ln.depth,Tt(this.parseInline(Ln.tokens,this.textRenderer)),this.slugger);continue}case"code":{Jt+=this.renderer.code(Ln.text,Ln.lang,Ln.escaped);continue}case"table":{for(An="",Dn="",mn=Ln.header.length,sn=0;sn<mn;sn++)Dn+=this.renderer.tablecell(this.parseInline(Ln.header[sn].tokens),{header:!0,align:Ln.align[sn]});for(An+=this.renderer.tablerow(Dn),Rn="",mn=Ln.rows.length,sn=0;sn<mn;sn++){for(En=Ln.rows[sn],Dn="",vn=En.length,gn=0;gn<vn;gn++)Dn+=this.renderer.tablecell(this.parseInline(En[gn].tokens),{header:!1,align:Ln.align[gn]});Rn+=this.renderer.tablerow(Dn)}Jt+=this.renderer.table(An,Rn);continue}case"blockquote":{Rn=this.parse(Ln.tokens),Jt+=this.renderer.blockquote(Rn);continue}case"list":{for(Pn=Ln.ordered,On=Ln.start,to=Ln.loose,mn=Ln.items.length,Rn="",sn=0;sn<mn;sn++)zn=Ln.items[sn],lo=zn.checked,eo=zn.task,Fn="",zn.task&&(oo=this.renderer.checkbox(lo),to?zn.tokens.length>0&&zn.tokens[0].type==="paragraph"?(zn.tokens[0].text=oo+" "+zn.tokens[0].text,zn.tokens[0].tokens&&zn.tokens[0].tokens.length>0&&zn.tokens[0].tokens[0].type==="text"&&(zn.tokens[0].tokens[0].text=oo+" "+zn.tokens[0].tokens[0].text)):zn.tokens.unshift({type:"text",text:oo}):Fn+=oo),Fn+=this.parse(zn.tokens,to),Rn+=this.renderer.listitem(Fn,eo,lo);Jt+=this.renderer.list(Rn,Pn,On);continue}case"html":{Jt+=this.renderer.html(Ln.text);continue}case"paragraph":{Jt+=this.renderer.paragraph(this.parseInline(Ln.tokens));continue}case"text":{for(Rn=Ln.tokens?this.parseInline(Ln.tokens):Ln.text;en+1<co&&Gt[en+1].type==="text";)Ln=Gt[++en],Rn+=`
`+(Ln.tokens?this.parseInline(Ln.tokens):Ln.text);Jt+=Qt?this.renderer.paragraph(Rn):Rn;continue}default:{var uo='Token with "'+Ln.type+'" type was not found.';if(this.options.silent){console.error(uo);return}else throw new Error(uo)}}}return Jt},zt.parseInline=function(Gt,Qt){Qt=Qt||this.renderer;var Jt="",en,sn,gn,mn=Gt.length;for(en=0;en<mn;en++){if(sn=Gt[en],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[sn.type]&&(gn=this.options.extensions.renderers[sn.type].call({parser:this},sn),gn!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(sn.type))){Jt+=gn||"";continue}switch(sn.type){case"escape":{Jt+=Qt.text(sn.text);break}case"html":{Jt+=Qt.html(sn.text);break}case"link":{Jt+=Qt.link(sn.href,sn.title,this.parseInline(sn.tokens,Qt));break}case"image":{Jt+=Qt.image(sn.href,sn.title,sn.text);break}case"strong":{Jt+=Qt.strong(this.parseInline(sn.tokens,Qt));break}case"em":{Jt+=Qt.em(this.parseInline(sn.tokens,Qt));break}case"codespan":{Jt+=Qt.codespan(sn.text);break}case"br":{Jt+=Qt.br();break}case"del":{Jt+=Qt.del(this.parseInline(sn.tokens,Qt));break}case"text":{Jt+=Qt.text(sn.text);break}default:{var vn='Token with "'+sn.type+'" type was not found.';if(this.options.silent){console.error(vn);return}else throw new Error(vn)}}}return Jt},$t}();function In($t,zt,jt){if(typeof $t>"u"||$t===null)throw new Error("marked(): input parameter is undefined or null");if(typeof $t!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call($t)+", string expected");if(typeof zt=="function"&&(jt=zt,zt=null),zt=_i({},In.defaults,zt||{}),bn(zt),jt){var Gt=zt.highlight,Qt;try{Qt=Nn.lex($t,zt)}catch(mn){return jt(mn)}var Jt=function(vn){var En;if(!vn)try{zt.walkTokens&&In.walkTokens(Qt,zt.walkTokens),En=Un.parse(Qt,zt)}catch(Dn){vn=Dn}return zt.highlight=Gt,vn?jt(vn):jt(null,En)};if(!Gt||Gt.length<3||(delete zt.highlight,!Qt.length))return Jt();var en=0;In.walkTokens(Qt,function(mn){mn.type==="code"&&(en++,setTimeout(function(){Gt(mn.text,mn.lang,function(vn,En){if(vn)return Jt(vn);En!=null&&En!==mn.text&&(mn.text=En,mn.escaped=!0),en--,en===0&&Jt()})},0))}),en===0&&Jt();return}function sn(mn){if(mn.message+=`
Please report this to https://github.com/markedjs/marked.`,zt.silent)return"<p>An error occurred:</p><pre>"+kt(mn.message+"",!0)+"</pre>";throw mn}try{var gn=Nn.lex($t,zt);if(zt.walkTokens){if(zt.async)return Promise.all(In.walkTokens(gn,zt.walkTokens)).then(function(){return Un.parse(gn,zt)}).catch(sn);In.walkTokens(gn,zt.walkTokens)}return Un.parse(gn,zt)}catch(mn){sn(mn)}}In.options=In.setOptions=function($t){return _i(In.defaults,$t),vt(In.defaults),In},In.getDefaults=mt,In.defaults=nt.defaults,In.use=function(){for(var $t=arguments.length,zt=new Array($t),jt=0;jt<$t;jt++)zt[jt]=arguments[jt];var Gt=_i.apply(void 0,[{}].concat(zt)),Qt=In.defaults.extensions||{renderers:{},childTokens:{}},Jt;zt.forEach(function(en){if(en.extensions&&(Jt=!0,en.extensions.forEach(function(gn){if(!gn.name)throw new Error("extension name required");if(gn.renderer){var mn=Qt.renderers?Qt.renderers[gn.name]:null;mn?Qt.renderers[gn.name]=function(){for(var vn=arguments.length,En=new Array(vn),Dn=0;Dn<vn;Dn++)En[Dn]=arguments[Dn];var An=gn.renderer.apply(this,En);return An===!1&&(An=mn.apply(this,En)),An}:Qt.renderers[gn.name]=gn.renderer}if(gn.tokenizer){if(!gn.level||gn.level!=="block"&&gn.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");Qt[gn.level]?Qt[gn.level].unshift(gn.tokenizer):Qt[gn.level]=[gn.tokenizer],gn.start&&(gn.level==="block"?Qt.startBlock?Qt.startBlock.push(gn.start):Qt.startBlock=[gn.start]:gn.level==="inline"&&(Qt.startInline?Qt.startInline.push(gn.start):Qt.startInline=[gn.start]))}gn.childTokens&&(Qt.childTokens[gn.name]=gn.childTokens)})),en.renderer&&function(){var gn=In.defaults.renderer||new Wn,mn=function(Dn){var An=gn[Dn];gn[Dn]=function(){for(var Rn=arguments.length,Ln=new Array(Rn),Pn=0;Pn<Rn;Pn++)Ln[Pn]=arguments[Pn];var On=en.renderer[Dn].apply(gn,Ln);return On===!1&&(On=An.apply(gn,Ln)),On}};for(var vn in en.renderer)mn(vn);Gt.renderer=gn}(),en.tokenizer&&function(){var gn=In.defaults.tokenizer||new _n,mn=function(Dn){var An=gn[Dn];gn[Dn]=function(){for(var Rn=arguments.length,Ln=new Array(Rn),Pn=0;Pn<Rn;Pn++)Ln[Pn]=arguments[Pn];var On=en.tokenizer[Dn].apply(gn,Ln);return On===!1&&(On=An.apply(gn,Ln)),On}};for(var vn in en.tokenizer)mn(vn);Gt.tokenizer=gn}(),en.walkTokens){var sn=In.defaults.walkTokens;Gt.walkTokens=function(gn){var mn=[];return mn.push(en.walkTokens.call(this,gn)),sn&&(mn=mn.concat(sn.call(this,gn))),mn}}Jt&&(Gt.extensions=Qt),In.setOptions(Gt)})},In.walkTokens=function($t,zt){for(var jt=[],Gt=function(){var sn=Jt.value;switch(jt=jt.concat(zt.call(In,sn)),sn.type){case"table":{for(var gn=pt(sn.header),mn;!(mn=gn()).done;){var vn=mn.value;jt=jt.concat(In.walkTokens(vn.tokens,zt))}for(var En=pt(sn.rows),Dn;!(Dn=En()).done;)for(var An=Dn.value,Rn=pt(An),Ln;!(Ln=Rn()).done;){var Pn=Ln.value;jt=jt.concat(In.walkTokens(Pn.tokens,zt))}break}case"list":{jt=jt.concat(In.walkTokens(sn.items,zt));break}default:In.defaults.extensions&&In.defaults.extensions.childTokens&&In.defaults.extensions.childTokens[sn.type]?In.defaults.extensions.childTokens[sn.type].forEach(function(On){jt=jt.concat(In.walkTokens(sn[On],zt))}):sn.tokens&&(jt=jt.concat(In.walkTokens(sn.tokens,zt)))}},Qt=pt($t),Jt;!(Jt=Qt()).done;)Gt();return jt},In.parseInline=function($t,zt){if(typeof $t>"u"||$t===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof $t!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call($t)+", string expected");zt=_i({},In.defaults,zt||{}),bn(zt);try{var jt=Nn.lexInline($t,zt);return zt.walkTokens&&In.walkTokens(jt,zt.walkTokens),Un.parseInline(jt,zt)}catch(Gt){if(Gt.message+=`
Please report this to https://github.com/markedjs/marked.`,zt.silent)return"<p>An error occurred:</p><pre>"+kt(Gt.message+"",!0)+"</pre>";throw Gt}},In.Parser=Un,In.parser=Un.parse,In.Renderer=Wn,In.TextRenderer=Jn,In.Lexer=Nn,In.lexer=Nn.lex,In.Tokenizer=_n,In.Slugger=Xn,In.parse=In;var jn=In.options,Gn=In.setOptions,qn=In.use,ln=In.walkTokens,fn=In.parseInline,Sn=In,xn=Un.parse,tn=Nn.lex;nt.Lexer=Nn,nt.Parser=Un,nt.Renderer=Wn,nt.Slugger=Xn,nt.TextRenderer=Jn,nt.Tokenizer=_n,nt.getDefaults=mt,nt.lexer=tn,nt.marked=In,nt.options=jn,nt.parse=Sn,nt.parseInline=fn,nt.parser=xn,nt.setOptions=Gn,nt.use=qn,nt.walkTokens=ln,Object.defineProperty(nt,"__esModule",{value:!0})})})();__marked_exports.Lexer||exports.Lexer;__marked_exports.Parser||exports.Parser;__marked_exports.Renderer||exports.Renderer;__marked_exports.Slugger||exports.Slugger;__marked_exports.TextRenderer||exports.TextRenderer;__marked_exports.Tokenizer||exports.Tokenizer;__marked_exports.getDefaults||exports.getDefaults;__marked_exports.lexer||exports.lexer;var marked=__marked_exports.marked||exports.marked;__marked_exports.options||exports.options;__marked_exports.parse||exports.parse;__marked_exports.parseInline||exports.parseInline;__marked_exports.parser||exports.parser;__marked_exports.setOptions||exports.setOptions;__marked_exports.use||exports.use;__marked_exports.walkTokens||exports.walkTokens;function parse$2(ct){let nt=JSON.parse(ct);return nt=revive(nt),nt}function revive(ct,nt=0){if(!ct||nt>200)return ct;if(typeof ct=="object"){switch(ct.$mid){case 1:return URI.revive(ct);case 2:return new RegExp(ct.source,ct.flags);case 16:return new Date(ct.source)}if(ct instanceof VSBuffer||ct instanceof Uint8Array)return ct;if(Array.isArray(ct))for(let ot=0;ot<ct.length;++ot)ct[ot]=revive(ct[ot],nt+1);else for(const ot in ct)Object.hasOwnProperty.call(ct,ot)&&(ct[ot]=revive(ct[ot],nt+1))}return ct}const defaultMarkedRenderers=Object.freeze({image:(ct,nt,ot)=>{let rt=[],ut=[];return ct&&({href:ct,dimensions:rt}=parseHrefAndDimensions(ct),ut.push(`src="${escapeDoubleQuotes(ct)}"`)),ot&&ut.push(`alt="${escapeDoubleQuotes(ot)}"`),nt&&ut.push(`title="${escapeDoubleQuotes(nt)}"`),rt.length&&(ut=ut.concat(rt)),"<img "+ut.join(" ")+">"},paragraph:ct=>`<p>${ct}</p>`,link:(ct,nt,ot)=>typeof ct!="string"?"":(ct===ot&&(ot=removeMarkdownEscapes(ot)),nt=typeof nt=="string"?escapeDoubleQuotes(removeMarkdownEscapes(nt)):"",ct=removeMarkdownEscapes(ct),ct=ct.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${ct}" title="${nt||ct}">${ot}</a>`)});function renderMarkdown(ct,nt={},ot={}){var rt,ut;const gt=new DisposableStore;let pt=!1;const mt=createElement(nt),vt=function(Tt){let Rt;try{Rt=parse$2(decodeURIComponent(Tt))}catch{}return Rt?(Rt=cloneAndChange(Rt,Nt=>{if(ct.uris&&ct.uris[Nt])return URI.revive(ct.uris[Nt])}),encodeURIComponent(JSON.stringify(Rt))):Tt},St=function(Tt,Rt){const Nt=ct.uris&&ct.uris[Tt];let Pt=URI.revive(Nt);return Rt?Tt.startsWith(Schemas.data+":")?Tt:(Pt||(Pt=URI.parse(Tt)),FileAccess.uriToBrowserUri(Pt).toString(!0)):!Pt||URI.parse(Tt).toString()===Pt.toString()?Tt:(Pt.query&&(Pt=Pt.with({query:vt(Pt.query)})),Pt.toString())},yt=new marked.Renderer;yt.image=defaultMarkedRenderers.image,yt.link=defaultMarkedRenderers.link,yt.paragraph=defaultMarkedRenderers.paragraph;const wt=[],Lt=[];if(nt.codeBlockRendererSync?yt.code=(Tt,Rt)=>{const Nt=defaultGenerator.nextId(),Pt=nt.codeBlockRendererSync(postProcessCodeBlockLanguageId(Rt),Tt);return Lt.push([Nt,Pt]),`<div class="code" data-code="${Nt}">${escape$1(Tt)}</div>`}:nt.codeBlockRenderer&&(yt.code=(Tt,Rt)=>{const Nt=defaultGenerator.nextId(),Pt=nt.codeBlockRenderer(postProcessCodeBlockLanguageId(Rt),Tt);return wt.push(Pt.then(Ft=>[Nt,Ft])),`<div class="code" data-code="${Nt}">${escape$1(Tt)}</div>`}),nt.actionHandler){const Tt=function(Pt){let Ft=Pt.target;if(!(Ft.tagName!=="A"&&(Ft=Ft.parentElement,!Ft||Ft.tagName!=="A")))try{let Kt=Ft.dataset.href;Kt&&(ct.baseUri&&(Kt=resolveWithBaseUri(URI.from(ct.baseUri),Kt)),nt.actionHandler.callback(Kt,Pt))}catch(Kt){onUnexpectedError(Kt)}finally{Pt.preventDefault()}},Rt=nt.actionHandler.disposables.add(new DomEmitter(mt,"click")),Nt=nt.actionHandler.disposables.add(new DomEmitter(mt,"auxclick"));nt.actionHandler.disposables.add(Event.any(Rt.event,Nt.event)(Pt=>{const Ft=new StandardMouseEvent(Pt);!Ft.leftButton&&!Ft.middleButton||Tt(Ft)})),nt.actionHandler.disposables.add(addDisposableListener(mt,"keydown",Pt=>{const Ft=new StandardKeyboardEvent(Pt);!Ft.equals(10)&&!Ft.equals(3)||Tt(Ft)}))}ct.supportHtml||(ot.sanitizer=Tt=>(ct.isTrusted?Tt.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?Tt:"",ot.sanitize=!0,ot.silent=!0),ot.renderer=yt;let xt=(rt=ct.value)!==null&&rt!==void 0?rt:"";xt.length>1e5&&(xt=`${xt.substr(0,1e5)}`),ct.supportThemeIcons&&(xt=markdownEscapeEscapedIcons(xt));let It;if(nt.fillInIncompleteTokens){const Tt=Object.assign(Object.assign({},marked.defaults),ot),Rt=marked.lexer(xt,Tt),Nt=fillInIncompleteTokens(Rt);It=marked.parser(Nt,Tt)}else It=marked.parse(xt,ot);ct.supportThemeIcons&&(It=renderLabelWithIcons(It).map(Rt=>typeof Rt=="string"?Rt:Rt.outerHTML).join(""));const At=new DOMParser().parseFromString(sanitizeRenderedMarkdown(ct,It),"text/html");if(At.body.querySelectorAll("img").forEach(Tt=>{const Rt=Tt.getAttribute("src");if(Rt){let Nt=Rt;try{ct.baseUri&&(Nt=resolveWithBaseUri(URI.from(ct.baseUri),Nt))}catch{}Tt.src=St(Nt,!0)}}),At.body.querySelectorAll("a").forEach(Tt=>{const Rt=Tt.getAttribute("href");if(Tt.setAttribute("href",""),!Rt||/^data:|javascript:/i.test(Rt)||/^command:/i.test(Rt)&&!ct.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(Rt))Tt.replaceWith(...Tt.childNodes);else{let Nt=St(Rt,!1);ct.baseUri&&(Nt=resolveWithBaseUri(URI.from(ct.baseUri),Rt)),Tt.dataset.href=Nt}}),mt.innerHTML=sanitizeRenderedMarkdown(ct,At.body.innerHTML),wt.length>0)Promise.all(wt).then(Tt=>{var Rt,Nt;if(pt)return;const Pt=new Map(Tt),Ft=mt.querySelectorAll("div[data-code]");for(const Kt of Ft){const Bt=Pt.get((Rt=Kt.dataset.code)!==null&&Rt!==void 0?Rt:"");Bt&&reset(Kt,Bt)}(Nt=nt.asyncRenderCallback)===null||Nt===void 0||Nt.call(nt)});else if(Lt.length>0){const Tt=new Map(Lt),Rt=mt.querySelectorAll("div[data-code]");for(const Nt of Rt){const Pt=Tt.get((ut=Nt.dataset.code)!==null&&ut!==void 0?ut:"");Pt&&reset(Nt,Pt)}}if(nt.asyncRenderCallback)for(const Tt of mt.getElementsByTagName("img")){const Rt=gt.add(addDisposableListener(Tt,"load",()=>{Rt.dispose(),nt.asyncRenderCallback()}))}return{element:mt,dispose:()=>{pt=!0,gt.dispose()}}}function postProcessCodeBlockLanguageId(ct){if(!ct)return"";const nt=ct.split(/[\s+|:|,|\{|\?]/,1);return nt.length?nt[0]:ct}function resolveWithBaseUri(ct,nt){return/^\w[\w\d+.-]*:/.test(nt)?nt:ct.path.endsWith("/")?resolvePath(ct,nt).toString():resolvePath(dirname(ct),nt).toString()}function sanitizeRenderedMarkdown(ct,nt){const{config:ot,allowedSchemes:rt}=getSanitizerOptions(ct);addHook("uponSanitizeAttribute",(gt,pt)=>{if(pt.attrName==="style"||pt.attrName==="class"){if(gt.tagName==="SPAN"){if(pt.attrName==="style"){pt.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?$/.test(pt.attrValue);return}else if(pt.attrName==="class"){pt.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(pt.attrValue);return}}pt.keepAttr=!1;return}});const ut=hookDomPurifyHrefAndSrcSanitizer(rt);try{return sanitize(nt,Object.assign(Object.assign({},ot),{RETURN_TRUSTED_TYPE:!0}))}finally{removeHook("uponSanitizeAttribute"),ut.dispose()}}const allowedMarkdownAttr=["align","autoplay","alt","class","controls","data-code","data-href","height","href","loop","muted","playsinline","poster","src","style","target","title","width","start"];function getSanitizerOptions(ct){const nt=[Schemas.http,Schemas.https,Schemas.mailto,Schemas.data,Schemas.file,Schemas.vscodeFileResource,Schemas.vscodeRemote,Schemas.vscodeRemoteResource];return ct.isTrusted&&nt.push(Schemas.command),{config:{ALLOWED_TAGS:[...basicMarkupHtmlTags],ALLOWED_ATTR:allowedMarkdownAttr,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:nt}}function renderStringAsPlaintext(ct){return typeof ct=="string"?ct:renderMarkdownAsPlaintext(ct)}function renderMarkdownAsPlaintext(ct){var nt;let ot=(nt=ct.value)!==null&&nt!==void 0?nt:"";ot.length>1e5&&(ot=`${ot.substr(0,1e5)}`);const rt=marked.parse(ot,{renderer:plainTextRenderer.value}).replace(/&(#\d+|[a-zA-Z]+);/g,ut=>{var gt;return(gt=unescapeInfo.get(ut))!==null&&gt!==void 0?gt:ut});return sanitizeRenderedMarkdown({isTrusted:!1},rt).toString()}const unescapeInfo=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]),plainTextRenderer=new Lazy(()=>{const ct=new marked.Renderer;return ct.code=nt=>nt,ct.blockquote=nt=>nt,ct.html=nt=>"",ct.heading=(nt,ot,rt)=>nt+`
`,ct.hr=()=>"",ct.list=(nt,ot)=>nt,ct.listitem=nt=>nt+`
`,ct.paragraph=nt=>nt+`
`,ct.table=(nt,ot)=>nt+ot+`
`,ct.tablerow=nt=>nt,ct.tablecell=(nt,ot)=>nt+" ",ct.strong=nt=>nt,ct.em=nt=>nt,ct.codespan=nt=>nt,ct.br=()=>`
`,ct.del=nt=>nt,ct.image=(nt,ot,rt)=>"",ct.text=nt=>nt,ct.link=(nt,ot,rt)=>rt,ct});function mergeRawTokenText(ct){let nt="";return ct.forEach(ot=>{nt+=ot.raw}),nt}function completeSingleLinePattern(ct){const nt=ct.tokens[0];if(nt.type==="text"){const ot=nt.raw.split(`
`),rt=ot[ot.length-1];if(rt.includes("`"))return completeCodespan(ct);if(rt.includes("**"))return completeDoublestar(ct);if(rt.match(/\*\w/))return completeStar(ct);if(rt.match(/(^|\s)__\w/))return completeDoubleUnderscore(ct);if(rt.match(/(^|\s)_\w/))return completeUnderscore(ct);if(rt.match(/(^|\s)\[.*\]\(\w*/))return completeLinkTarget(ct);if(rt.match(/(^|\s)\[\w/))return completeLinkText(ct)}}function fillInIncompleteTokens(ct){let nt,ot;for(nt=0;nt<ct.length;nt++){const rt=ct[nt];if(rt.type==="paragraph"&&rt.raw.match(/(\n|^)```/)){ot=completeCodeBlock(ct.slice(nt));break}if(rt.type==="paragraph"&&rt.raw.match(/(\n|^)\|/)){ot=completeTable(ct.slice(nt));break}if(nt===ct.length-1&&rt.type==="paragraph"){const ut=completeSingleLinePattern(rt);if(ut){ot=[ut];break}}}if(ot){const rt=[...ct.slice(0,nt),...ot];return rt.links=ct.links,rt}return ct}function completeCodeBlock(ct){const nt=mergeRawTokenText(ct);return marked.lexer(nt+"\n```")}function completeCodespan(ct){return completeWithString(ct,"`")}function completeStar(ct){return completeWithString(ct,"*")}function completeUnderscore(ct){return completeWithString(ct,"_")}function completeLinkTarget(ct){return completeWithString(ct,")")}function completeLinkText(ct){return completeWithString(ct,"](about:blank)")}function completeDoublestar(ct){return completeWithString(ct,"**")}function completeDoubleUnderscore(ct){return completeWithString(ct,"__")}function completeWithString(ct,nt){const ot=mergeRawTokenText(Array.isArray(ct)?ct:[ct]);return marked.lexer(ot+nt)[0]}function completeTable(ct){const nt=mergeRawTokenText(ct),ot=nt.split(`
`);let rt,ut=!1;for(let gt=0;gt<ot.length;gt++){const pt=ot[gt].trim();if(typeof rt>"u"&&pt.match(/^\s*\|/)){const mt=pt.match(/(\|[^\|]+)(?=\||$)/g);mt&&(rt=mt.length)}else if(typeof rt=="number")if(pt.match(/^\s*\|/)){if(gt!==ot.length-1)return;ut=!0}else return}if(typeof rt=="number"&&rt>0){const gt=ut?ot.slice(0,-1).join(`
`):nt,pt=!!gt.match(/\|\s*$/),mt=gt+(pt?"":"|")+`
|${" --- |".repeat(rt)}`;return marked.lexer(mt)}}class CombinedSpliceable{constructor(nt){this.spliceables=nt}splice(nt,ot,rt){this.spliceables.forEach(ut=>ut.splice(nt,ot,rt))}}function clamp(ct,nt,ot){return Math.min(Math.max(ct,nt),ot)}class MovingAverage{constructor(){this._n=1,this._val=0}update(nt){return this._val=this._val+(nt-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class SlidingWindowAverage{constructor(nt){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(nt),this._values.fill(0,0,nt)}update(nt){const ot=this._values[this._index];return this._values[this._index]=nt,this._index=(this._index+1)%this._values.length,this._sum-=ot,this._sum+=nt,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}const list="";class ListError extends Error{constructor(nt,ot){super(`ListError [${nt}] ${ot}`)}}var Range$1;(function(ct){function nt(gt,pt){if(gt.start>=pt.end||pt.start>=gt.end)return{start:0,end:0};const mt=Math.max(gt.start,pt.start),vt=Math.min(gt.end,pt.end);return vt-mt<=0?{start:0,end:0}:{start:mt,end:vt}}ct.intersect=nt;function ot(gt){return gt.end-gt.start<=0}ct.isEmpty=ot;function rt(gt,pt){return!ot(nt(gt,pt))}ct.intersects=rt;function ut(gt,pt){const mt=[],vt={start:gt.start,end:Math.min(pt.start,gt.end)},St={start:Math.max(pt.end,gt.start),end:gt.end};return ot(vt)||mt.push(vt),ot(St)||mt.push(St),mt}ct.relativeComplement=ut})(Range$1||(Range$1={}));function groupIntersect(ct,nt){const ot=[];for(const rt of nt){if(ct.start>=rt.range.end)continue;if(ct.end<rt.range.start)break;const ut=Range$1.intersect(ct,rt.range);Range$1.isEmpty(ut)||ot.push({range:ut,size:rt.size})}return ot}function shift({start:ct,end:nt},ot){return{start:ct+ot,end:nt+ot}}function consolidate(ct){const nt=[];let ot=null;for(const rt of ct){const ut=rt.range.start,gt=rt.range.end,pt=rt.size;if(ot&&pt===ot.size){ot.range.end=gt;continue}ot={range:{start:ut,end:gt},size:pt},nt.push(ot)}return nt}function concat(...ct){return consolidate(ct.reduce((nt,ot)=>nt.concat(ot),[]))}class RangeMap{constructor(){this.groups=[],this._size=0}splice(nt,ot,rt=[]){const ut=rt.length-ot,gt=groupIntersect({start:0,end:nt},this.groups),pt=groupIntersect({start:nt+ot,end:Number.POSITIVE_INFINITY},this.groups).map(vt=>({range:shift(vt.range,ut),size:vt.size})),mt=rt.map((vt,St)=>({range:{start:nt+St,end:nt+St+1},size:vt.size}));this.groups=concat(gt,mt,pt),this._size=this.groups.reduce((vt,St)=>vt+St.size*(St.range.end-St.range.start),0)}get count(){const nt=this.groups.length;return nt?this.groups[nt-1].range.end:0}get size(){return this._size}indexAt(nt){if(nt<0)return-1;let ot=0,rt=0;for(const ut of this.groups){const gt=ut.range.end-ut.range.start,pt=rt+gt*ut.size;if(nt<pt)return ot+Math.floor((nt-rt)/ut.size);ot+=gt,rt=pt}return ot}indexAfter(nt){return Math.min(this.indexAt(nt)+1,this.count)}positionAt(nt){if(nt<0)return-1;let ot=0,rt=0;for(const ut of this.groups){const gt=ut.range.end-ut.range.start,pt=rt+gt;if(nt<pt)return ot+(nt-rt)*ut.size;ot+=gt*ut.size,rt=pt}return-1}}function removeFromParent(ct){var nt;try{(nt=ct.parentElement)===null||nt===void 0||nt.removeChild(ct)}catch{}}class RowCache{constructor(nt){this.renderers=nt,this.cache=new Map,this.transactionNodesPendingRemoval=new Set,this.inTransaction=!1}alloc(nt){let ot=this.getTemplateCache(nt).pop(),rt=!1;if(ot)rt=this.transactionNodesPendingRemoval.has(ot.domNode),rt&&this.transactionNodesPendingRemoval.delete(ot.domNode);else{const ut=$$d(".monaco-list-row"),pt=this.getRenderer(nt).renderTemplate(ut);ot={domNode:ut,templateId:nt,templateData:pt}}return{row:ot,isReusingConnectedDomNode:rt}}release(nt){nt&&this.releaseRow(nt)}transact(nt){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{nt()}finally{for(const ot of this.transactionNodesPendingRemoval)this.doRemoveNode(ot);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(nt){const{domNode:ot,templateId:rt}=nt;ot&&(this.inTransaction?this.transactionNodesPendingRemoval.add(ot):this.doRemoveNode(ot)),this.getTemplateCache(rt).push(nt)}doRemoveNode(nt){nt.classList.remove("scrolling"),removeFromParent(nt)}getTemplateCache(nt){let ot=this.cache.get(nt);return ot||(ot=[],this.cache.set(nt,ot)),ot}dispose(){this.cache.forEach((nt,ot)=>{for(const rt of nt)this.getRenderer(ot).disposeTemplate(rt.templateData),rt.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(nt){const ot=this.renderers.get(nt);if(!ot)throw new Error(`No renderer found for ${nt}`);return ot}}var __decorate$1W=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt};const StaticDND={CurrentDragAndDropData:void 0},DefaultOptions$1={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(ct){return[ct]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class ElementsDragAndDropData{constructor(nt){this.elements=nt}update(){}getData(){return this.elements}}class ExternalElementsDragAndDropData{constructor(nt){this.elements=nt}update(){}getData(){return this.elements}}class NativeDragAndDropData{constructor(){this.types=[],this.files=[]}update(nt){if(nt.types&&this.types.splice(0,this.types.length,...nt.types),nt.files){this.files.splice(0,this.files.length);for(let ot=0;ot<nt.files.length;ot++){const rt=nt.files.item(ot);rt&&(rt.size||rt.type)&&this.files.push(rt)}}}getData(){return{types:this.types,files:this.files}}}function equalsDragFeedback(ct,nt){return Array.isArray(ct)&&Array.isArray(nt)?equals$2(ct,nt):ct===nt}class ListViewAccessibilityProvider{constructor(nt){nt!=null&&nt.getSetSize?this.getSetSize=nt.getSetSize.bind(nt):this.getSetSize=(ot,rt,ut)=>ut,nt!=null&&nt.getPosInSet?this.getPosInSet=nt.getPosInSet.bind(nt):this.getPosInSet=(ot,rt)=>rt+1,nt!=null&&nt.getRole?this.getRole=nt.getRole.bind(nt):this.getRole=ot=>"listitem",nt!=null&&nt.isChecked?this.isChecked=nt.isChecked.bind(nt):this.isChecked=ot=>{}}}class ListView{get contentHeight(){return this.rangeMap.size}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(nt){if(nt!==this._horizontalScrolling){if(nt&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=nt,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const ot of this.items)this.measureItemWidth(ot);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:getContentWidth(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}constructor(nt,ot,rt,ut=DefaultOptions$1){var gt,pt,mt,vt,St,yt,wt,Lt,xt,It,kt,At;if(this.virtualDelegate=ot,this.domId=`list_id_${++ListView.InstanceCount}`,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new Delayer(50),this.splicing=!1,this.dragOverAnimationStopDisposable=Disposable.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=Disposable.None,this.onDragLeaveTimeout=Disposable.None,this.disposables=new DisposableStore,this._onDidChangeContentHeight=new Emitter$2,this._horizontalScrolling=!1,ut.horizontalScrolling&&ut.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=new RangeMap;for(const Rt of rt)this.renderers.set(Rt.templateId,Rt);this.cache=this.disposables.add(new RowCache(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof ut.mouseSupport=="boolean"?ut.mouseSupport:!0),this._horizontalScrolling=(gt=ut.horizontalScrolling)!==null&&gt!==void 0?gt:DefaultOptions$1.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.additionalScrollHeight=typeof ut.additionalScrollHeight>"u"?0:ut.additionalScrollHeight,this.accessibilityProvider=new ListViewAccessibilityProvider(ut.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",((pt=ut.transformOptimization)!==null&&pt!==void 0?pt:DefaultOptions$1.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Gesture.addTarget(this.rowsContainer)),this.scrollable=new Scrollable({forceIntegerValues:!0,smoothScrollDuration:(mt=ut.smoothScrolling)!==null&&mt!==void 0&&mt?125:0,scheduleAtNextAnimationFrame:Rt=>scheduleAtNextAnimationFrame(Rt)}),this.scrollableElement=this.disposables.add(new SmoothScrollableElement(this.rowsContainer,{alwaysConsumeMouseWheel:(vt=ut.alwaysConsumeMouseWheel)!==null&&vt!==void 0?vt:DefaultOptions$1.alwaysConsumeMouseWheel,horizontal:1,vertical:(St=ut.verticalScrollMode)!==null&&St!==void 0?St:DefaultOptions$1.verticalScrollMode,useShadows:(yt=ut.useShadows)!==null&&yt!==void 0?yt:DefaultOptions$1.useShadows,mouseWheelScrollSensitivity:ut.mouseWheelScrollSensitivity,fastScrollSensitivity:ut.fastScrollSensitivity,scrollByPage:ut.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),nt.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(addDisposableListener(this.rowsContainer,EventType.Change,Rt=>this.onTouchChange(Rt))),this.disposables.add(addDisposableListener(this.scrollableElement.getDomNode(),"scroll",Rt=>Rt.target.scrollTop=0)),this.disposables.add(addDisposableListener(this.domNode,"dragover",Rt=>this.onDragOver(this.toDragEvent(Rt)))),this.disposables.add(addDisposableListener(this.domNode,"drop",Rt=>this.onDrop(this.toDragEvent(Rt)))),this.disposables.add(addDisposableListener(this.domNode,"dragleave",Rt=>this.onDragLeave(this.toDragEvent(Rt)))),this.disposables.add(addDisposableListener(this.domNode,"dragend",Rt=>this.onDragEnd(Rt))),this.setRowLineHeight=(wt=ut.setRowLineHeight)!==null&&wt!==void 0?wt:DefaultOptions$1.setRowLineHeight,this.setRowHeight=(Lt=ut.setRowHeight)!==null&&Lt!==void 0?Lt:DefaultOptions$1.setRowHeight,this.supportDynamicHeights=(xt=ut.supportDynamicHeights)!==null&&xt!==void 0?xt:DefaultOptions$1.supportDynamicHeights,this.dnd=(It=ut.dnd)!==null&&It!==void 0?It:DefaultOptions$1.dnd,this.layout((kt=ut.initialSize)===null||kt===void 0?void 0:kt.height,(At=ut.initialSize)===null||At===void 0?void 0:At.width)}updateOptions(nt){nt.additionalScrollHeight!==void 0&&(this.additionalScrollHeight=nt.additionalScrollHeight,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),nt.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(nt.smoothScrolling?125:0),nt.horizontalScrolling!==void 0&&(this.horizontalScrolling=nt.horizontalScrolling);let ot;nt.scrollByPage!==void 0&&(ot=Object.assign(Object.assign({},ot??{}),{scrollByPage:nt.scrollByPage})),nt.mouseWheelScrollSensitivity!==void 0&&(ot=Object.assign(Object.assign({},ot??{}),{mouseWheelScrollSensitivity:nt.mouseWheelScrollSensitivity})),nt.fastScrollSensitivity!==void 0&&(ot=Object.assign(Object.assign({},ot??{}),{fastScrollSensitivity:nt.fastScrollSensitivity})),ot&&this.scrollableElement.updateOptions(ot)}splice(nt,ot,rt=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(nt,ot,rt)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(nt,ot,rt=[]){const ut=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),gt={start:nt,end:nt+ot},pt=Range$1.intersect(ut,gt),mt=new Map;for(let Kt=pt.end-1;Kt>=pt.start;Kt--){const Bt=this.items[Kt];if(Bt.dragStartDisposable.dispose(),Bt.checkedDisposable.dispose(),Bt.row){let Ut=mt.get(Bt.templateId);Ut||(Ut=[],mt.set(Bt.templateId,Ut));const qt=this.renderers.get(Bt.templateId);qt&&qt.disposeElement&&qt.disposeElement(Bt.element,Kt,Bt.row.templateData,Bt.size),Ut.push(Bt.row)}Bt.row=null}const vt={start:nt+ot,end:this.items.length},St=Range$1.intersect(vt,ut),yt=Range$1.relativeComplement(vt,ut),wt=rt.map(Kt=>({id:String(this.itemId++),element:Kt,templateId:this.virtualDelegate.getTemplateId(Kt),size:this.virtualDelegate.getHeight(Kt),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(Kt),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:Disposable.None,checkedDisposable:Disposable.None}));let Lt;nt===0&&ot>=this.items.length?(this.rangeMap=new RangeMap,this.rangeMap.splice(0,0,wt),Lt=this.items,this.items=wt):(this.rangeMap.splice(nt,ot,wt),Lt=this.items.splice(nt,ot,...wt));const xt=rt.length-ot,It=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),kt=shift(St,xt),At=Range$1.intersect(It,kt);for(let Kt=At.start;Kt<At.end;Kt++)this.updateItemInDOM(this.items[Kt],Kt);const Tt=Range$1.relativeComplement(kt,It);for(const Kt of Tt)for(let Bt=Kt.start;Bt<Kt.end;Bt++)this.removeItemFromDOM(Bt);const Rt=yt.map(Kt=>shift(Kt,xt)),Pt=[{start:nt,end:nt+rt.length},...Rt].map(Kt=>Range$1.intersect(It,Kt)),Ft=this.getNextToLastElement(Pt);for(const Kt of Pt)for(let Bt=Kt.start;Bt<Kt.end;Bt++){const Ut=this.items[Bt],qt=mt.get(Ut.templateId),Yt=qt==null?void 0:qt.pop();this.insertItemInDOM(Bt,Ft,Yt)}for(const Kt of mt.values())for(const Bt of Kt)this.cache.release(Bt);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),Lt.map(Kt=>Kt.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=scheduleAtNextAnimationFrame(()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let nt=0;for(const ot of this.items)typeof ot.width<"u"&&(nt=Math.max(nt,ot.width));this.scrollWidth=nt,this.scrollableElement.setScrollDimensions({scrollWidth:nt===0?0:nt+10})}rerender(){if(this.supportDynamicHeights){for(const nt of this.items)nt.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){const nt=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),ot=this.rangeMap.positionAt(nt.start),rt=this.rangeMap.positionAt(nt.start+1);return rt!==-1&&(rt-ot)/2+ot<this.scrollTop?nt.start+1:nt.start}element(nt){return this.items[nt].element}domElement(nt){const ot=this.items[nt].row;return ot&&ot.domNode}elementHeight(nt){return this.items[nt].size}elementTop(nt){return this.rangeMap.positionAt(nt)}indexAt(nt){return this.rangeMap.indexAt(nt)}indexAfter(nt){return this.rangeMap.indexAfter(nt)}layout(nt,ot){const rt={height:typeof nt=="number"?nt:getContentHeight(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,rt.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(rt),typeof ot<"u"&&(this.renderWidth=ot,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof ot=="number"?ot:getContentWidth(this.domNode)})}render(nt,ot,rt,ut,gt,pt=!1){const mt=this.getRenderRange(ot,rt),vt=Range$1.relativeComplement(mt,nt),St=Range$1.relativeComplement(nt,mt),yt=this.getNextToLastElement(vt);if(pt){const wt=Range$1.intersect(nt,mt);for(let Lt=wt.start;Lt<wt.end;Lt++)this.updateItemInDOM(this.items[Lt],Lt)}this.cache.transact(()=>{for(const wt of St)for(let Lt=wt.start;Lt<wt.end;Lt++)this.removeItemFromDOM(Lt);for(const wt of vt)for(let Lt=wt.start;Lt<wt.end;Lt++)this.insertItemInDOM(Lt,yt)}),ut!==void 0&&(this.rowsContainer.style.left=`-${ut}px`),this.rowsContainer.style.top=`-${ot}px`,this.horizontalScrolling&&gt!==void 0&&(this.rowsContainer.style.width=`${Math.max(gt,this.renderWidth)}px`),this.lastRenderTop=ot,this.lastRenderHeight=rt}insertItemInDOM(nt,ot,rt){const ut=this.items[nt];let gt=!1;if(!ut.row)if(rt)ut.row=rt;else{const yt=this.cache.alloc(ut.templateId);ut.row=yt.row,gt=yt.isReusingConnectedDomNode}const pt=this.accessibilityProvider.getRole(ut.element)||"listitem";ut.row.domNode.setAttribute("role",pt);const mt=this.accessibilityProvider.isChecked(ut.element);if(typeof mt=="boolean")ut.row.domNode.setAttribute("aria-checked",String(!!mt));else if(mt){const yt=wt=>ut.row.domNode.setAttribute("aria-checked",String(!!wt));yt(mt.value),ut.checkedDisposable=mt.onDidChange(yt)}(gt||!ut.row.domNode.parentElement)&&(ot?this.rowsContainer.insertBefore(ut.row.domNode,ot):this.rowsContainer.appendChild(ut.row.domNode)),this.updateItemInDOM(ut,nt);const vt=this.renderers.get(ut.templateId);if(!vt)throw new Error(`No renderer found for template id ${ut.templateId}`);vt==null||vt.renderElement(ut.element,nt,ut.row.templateData,ut.size);const St=this.dnd.getDragURI(ut.element);ut.dragStartDisposable.dispose(),ut.row.domNode.draggable=!!St,St&&(ut.dragStartDisposable=addDisposableListener(ut.row.domNode,"dragstart",yt=>this.onDragStart(ut.element,St,yt))),this.horizontalScrolling&&(this.measureItemWidth(ut),this.eventuallyUpdateScrollWidth())}measureItemWidth(nt){if(!nt.row||!nt.row.domNode)return;nt.row.domNode.style.width="fit-content",nt.width=getContentWidth(nt.row.domNode);const ot=window.getComputedStyle(nt.row.domNode);ot.paddingLeft&&(nt.width+=parseFloat(ot.paddingLeft)),ot.paddingRight&&(nt.width+=parseFloat(ot.paddingRight)),nt.row.domNode.style.width=""}updateItemInDOM(nt,ot){nt.row.domNode.style.top=`${this.elementTop(ot)}px`,this.setRowHeight&&(nt.row.domNode.style.height=`${nt.size}px`),this.setRowLineHeight&&(nt.row.domNode.style.lineHeight=`${nt.size}px`),nt.row.domNode.setAttribute("data-index",`${ot}`),nt.row.domNode.setAttribute("data-last-element",ot===this.length-1?"true":"false"),nt.row.domNode.setAttribute("data-parity",ot%2===0?"even":"odd"),nt.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(nt.element,ot,this.length))),nt.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(nt.element,ot))),nt.row.domNode.setAttribute("id",this.getElementDomId(ot)),nt.row.domNode.classList.toggle("drop-target",nt.dropTarget)}removeItemFromDOM(nt){const ot=this.items[nt];if(ot.dragStartDisposable.dispose(),ot.checkedDisposable.dispose(),ot.row){const rt=this.renderers.get(ot.templateId);rt&&rt.disposeElement&&rt.disposeElement(ot.element,nt,ot.row.templateData,ot.size),this.cache.release(ot.row),ot.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(nt,ot){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:nt,reuseAnimation:ot})}get scrollTop(){return this.getScrollTop()}set scrollTop(nt){this.setScrollTop(nt)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.additionalScrollHeight}get onMouseClick(){return Event.map(this.disposables.add(new DomEmitter(this.domNode,"click")).event,nt=>this.toMouseEvent(nt),this.disposables)}get onMouseDblClick(){return Event.map(this.disposables.add(new DomEmitter(this.domNode,"dblclick")).event,nt=>this.toMouseEvent(nt),this.disposables)}get onMouseMiddleClick(){return Event.filter(Event.map(this.disposables.add(new DomEmitter(this.domNode,"auxclick")).event,nt=>this.toMouseEvent(nt),this.disposables),nt=>nt.browserEvent.button===1,this.disposables)}get onMouseDown(){return Event.map(this.disposables.add(new DomEmitter(this.domNode,"mousedown")).event,nt=>this.toMouseEvent(nt),this.disposables)}get onMouseOver(){return Event.map(this.disposables.add(new DomEmitter(this.domNode,"mouseover")).event,nt=>this.toMouseEvent(nt),this.disposables)}get onMouseOut(){return Event.map(this.disposables.add(new DomEmitter(this.domNode,"mouseout")).event,nt=>this.toMouseEvent(nt),this.disposables)}get onContextMenu(){return Event.any(Event.map(this.disposables.add(new DomEmitter(this.domNode,"contextmenu")).event,nt=>this.toMouseEvent(nt),this.disposables),Event.map(this.disposables.add(new DomEmitter(this.domNode,EventType.Contextmenu)).event,nt=>this.toGestureEvent(nt),this.disposables))}get onTouchStart(){return Event.map(this.disposables.add(new DomEmitter(this.domNode,"touchstart")).event,nt=>this.toTouchEvent(nt),this.disposables)}get onTap(){return Event.map(this.disposables.add(new DomEmitter(this.rowsContainer,EventType.Tap)).event,nt=>this.toGestureEvent(nt),this.disposables)}toMouseEvent(nt){const ot=this.getItemIndexFromEventTarget(nt.target||null),rt=typeof ot>"u"?void 0:this.items[ot],ut=rt&&rt.element;return{browserEvent:nt,index:ot,element:ut}}toTouchEvent(nt){const ot=this.getItemIndexFromEventTarget(nt.target||null),rt=typeof ot>"u"?void 0:this.items[ot],ut=rt&&rt.element;return{browserEvent:nt,index:ot,element:ut}}toGestureEvent(nt){const ot=this.getItemIndexFromEventTarget(nt.initialTarget||null),rt=typeof ot>"u"?void 0:this.items[ot],ut=rt&&rt.element;return{browserEvent:nt,index:ot,element:ut}}toDragEvent(nt){const ot=this.getItemIndexFromEventTarget(nt.target||null),rt=typeof ot>"u"?void 0:this.items[ot],ut=rt&&rt.element;return{browserEvent:nt,index:ot,element:ut}}onScroll(nt){try{const ot=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(ot,nt.scrollTop,nt.height,nt.scrollLeft,nt.scrollWidth),this.supportDynamicHeights&&this._rerender(nt.scrollTop,nt.height,nt.inSmoothScrolling)}catch(ot){throw console.error("Got bad scroll event:",nt),ot}}onTouchChange(nt){nt.preventDefault(),nt.stopPropagation(),this.scrollTop-=nt.translationY}onDragStart(nt,ot,rt){var ut,gt;if(!rt.dataTransfer)return;const pt=this.dnd.getDragElements(nt);if(rt.dataTransfer.effectAllowed="copyMove",rt.dataTransfer.setData(DataTransfers.TEXT,ot),rt.dataTransfer.setDragImage){let mt;this.dnd.getDragLabel&&(mt=this.dnd.getDragLabel(pt,rt)),typeof mt>"u"&&(mt=String(pt.length));const vt=$$d(".monaco-drag-image");vt.textContent=mt;const yt=(wt=>{for(;wt&&!wt.classList.contains("monaco-workbench");)wt=wt.parentElement;return wt||document.body})(this.domNode);yt.appendChild(vt),rt.dataTransfer.setDragImage(vt,-10,-10),setTimeout(()=>yt.removeChild(vt),0)}this.domNode.classList.add("dragging"),this.currentDragData=new ElementsDragAndDropData(pt),StaticDND.CurrentDragAndDropData=new ExternalElementsDragAndDropData(pt),(gt=(ut=this.dnd).onDragStart)===null||gt===void 0||gt.call(ut,this.currentDragData,rt)}onDragOver(nt){var ot;if(nt.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),StaticDND.CurrentDragAndDropData&&StaticDND.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(nt.browserEvent),!nt.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(StaticDND.CurrentDragAndDropData)this.currentDragData=StaticDND.CurrentDragAndDropData;else{if(!nt.browserEvent.dataTransfer.types)return!1;this.currentDragData=new NativeDragAndDropData}const rt=this.dnd.onDragOver(this.currentDragData,nt.element,nt.index,nt.browserEvent);if(this.canDrop=typeof rt=="boolean"?rt:rt.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;nt.browserEvent.dataTransfer.dropEffect=typeof rt!="boolean"&&rt.effect===0?"copy":"move";let ut;if(typeof rt!="boolean"&&rt.feedback?ut=rt.feedback:typeof nt.index>"u"?ut=[-1]:ut=[nt.index],ut=distinct(ut).filter(gt=>gt>=-1&&gt<this.length).sort((gt,pt)=>gt-pt),ut=ut[0]===-1?[-1]:ut,equalsDragFeedback(this.currentDragFeedback,ut))return!0;if(this.currentDragFeedback=ut,this.currentDragFeedbackDisposable.dispose(),ut[0]===-1)this.domNode.classList.add("drop-target"),this.rowsContainer.classList.add("drop-target"),this.currentDragFeedbackDisposable=toDisposable(()=>{this.domNode.classList.remove("drop-target"),this.rowsContainer.classList.remove("drop-target")});else{for(const gt of ut){const pt=this.items[gt];pt.dropTarget=!0,(ot=pt.row)===null||ot===void 0||ot.domNode.classList.add("drop-target")}this.currentDragFeedbackDisposable=toDisposable(()=>{var gt;for(const pt of ut){const mt=this.items[pt];mt.dropTarget=!1,(gt=mt.row)===null||gt===void 0||gt.domNode.classList.remove("drop-target")}})}return!0}onDragLeave(nt){var ot,rt;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=disposableTimeout(()=>this.clearDragOverFeedback(),100),this.currentDragData&&((rt=(ot=this.dnd).onDragLeave)===null||rt===void 0||rt.call(ot,this.currentDragData,nt.element,nt.index,nt.browserEvent))}onDrop(nt){if(!this.canDrop)return;const ot=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,StaticDND.CurrentDragAndDropData=void 0,!(!ot||!nt.browserEvent.dataTransfer)&&(nt.browserEvent.preventDefault(),ot.update(nt.browserEvent.dataTransfer),this.dnd.drop(ot,nt.element,nt.index,nt.browserEvent))}onDragEnd(nt){var ot,rt;this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,StaticDND.CurrentDragAndDropData=void 0,(rt=(ot=this.dnd).onDragEnd)===null||rt===void 0||rt.call(ot,nt)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=Disposable.None}setupDragAndDropScrollTopAnimation(nt){if(!this.dragOverAnimationDisposable){const ot=getTopLeftOffset(this.domNode).top;this.dragOverAnimationDisposable=animate(this.animateDragAndDropScrollTop.bind(this,ot))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=disposableTimeout(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3),this.dragOverMouseY=nt.pageY}animateDragAndDropScrollTop(nt){if(this.dragOverMouseY===void 0)return;const ot=this.dragOverMouseY-nt,rt=this.renderHeight-35;ot<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(ot-35))):ot>rt&&(this.scrollTop+=Math.min(14,Math.floor(.3*(ot-rt))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getItemIndexFromEventTarget(nt){const ot=this.scrollableElement.getDomNode();let rt=nt;for(;rt instanceof HTMLElement&&rt!==this.rowsContainer&&ot.contains(rt);){const ut=rt.getAttribute("data-index");if(ut){const gt=Number(ut);if(!isNaN(gt))return gt}rt=rt.parentElement}}getRenderRange(nt,ot){return{start:this.rangeMap.indexAt(nt),end:this.rangeMap.indexAfter(nt+ot-1)}}_rerender(nt,ot,rt){const ut=this.getRenderRange(nt,ot);let gt,pt;nt===this.elementTop(ut.start)?(gt=ut.start,pt=0):ut.end-ut.start>1&&(gt=ut.start+1,pt=this.elementTop(gt)-nt);let mt=0;for(;;){const vt=this.getRenderRange(nt,ot);let St=!1;for(let yt=vt.start;yt<vt.end;yt++){const wt=this.probeDynamicHeight(yt);wt!==0&&this.rangeMap.splice(yt,1,[this.items[yt]]),mt+=wt,St=St||wt!==0}if(!St){mt!==0&&this.eventuallyUpdateScrollDimensions();const yt=Range$1.relativeComplement(ut,vt);for(const Lt of yt)for(let xt=Lt.start;xt<Lt.end;xt++)this.items[xt].row&&this.removeItemFromDOM(xt);const wt=Range$1.relativeComplement(vt,ut);for(const Lt of wt)for(let xt=Lt.start;xt<Lt.end;xt++){const It=xt+1,kt=It<this.items.length?this.items[It].row:null,At=kt?kt.domNode:null;this.insertItemInDOM(xt,At)}for(let Lt=vt.start;Lt<vt.end;Lt++)this.items[Lt].row&&this.updateItemInDOM(this.items[Lt],Lt);if(typeof gt=="number"){const Lt=this.scrollable.getFutureScrollPosition().scrollTop-nt,xt=this.elementTop(gt)-pt+Lt;this.setScrollTop(xt,rt)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(nt){var ot,rt,ut;const gt=this.items[nt];if(this.virtualDelegate.getDynamicHeight){const St=this.virtualDelegate.getDynamicHeight(gt.element);if(St!==null){const yt=gt.size;return gt.size=St,gt.lastDynamicHeightWidth=this.renderWidth,St-yt}}if(!gt.hasDynamicHeight||gt.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(gt.element))return 0;const pt=gt.size;if(gt.row)return gt.row.domNode.style.height="",gt.size=gt.row.domNode.offsetHeight,gt.lastDynamicHeightWidth=this.renderWidth,gt.size-pt;const{row:mt}=this.cache.alloc(gt.templateId);mt.domNode.style.height="",this.rowsContainer.appendChild(mt.domNode);const vt=this.renderers.get(gt.templateId);if(!vt)throw new BugIndicatingError("Missing renderer for templateId: "+gt.templateId);return vt.renderElement(gt.element,nt,mt.templateData,void 0),gt.size=mt.domNode.offsetHeight,(ot=vt.disposeElement)===null||ot===void 0||ot.call(vt,gt.element,nt,mt.templateData,void 0),(ut=(rt=this.virtualDelegate).setDynamicHeight)===null||ut===void 0||ut.call(rt,gt.element,gt.size),gt.lastDynamicHeightWidth=this.renderWidth,this.rowsContainer.removeChild(mt.domNode),this.cache.release(mt),gt.size-pt}getNextToLastElement(nt){const ot=nt[nt.length-1];if(!ot)return null;const rt=this.items[ot.end];return!rt||!rt.row?null:rt.row.domNode}getElementDomId(nt){return`${this.domId}_${nt}`}dispose(){var nt;if(this.items){for(const ot of this.items)if(ot.row){const rt=this.renderers.get(ot.row.templateId);rt&&((nt=rt.disposeElement)===null||nt===void 0||nt.call(rt,ot.element,-1,ot.row.templateData,void 0),rt.disposeTemplate(ot.row.templateData))}this.items=[]}this.domNode&&this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),dispose(this.disposables)}}ListView.InstanceCount=0;__decorate$1W([memoize],ListView.prototype,"onMouseClick",null);__decorate$1W([memoize],ListView.prototype,"onMouseDblClick",null);__decorate$1W([memoize],ListView.prototype,"onMouseMiddleClick",null);__decorate$1W([memoize],ListView.prototype,"onMouseDown",null);__decorate$1W([memoize],ListView.prototype,"onMouseOver",null);__decorate$1W([memoize],ListView.prototype,"onMouseOut",null);__decorate$1W([memoize],ListView.prototype,"onContextMenu",null);__decorate$1W([memoize],ListView.prototype,"onTouchStart",null);__decorate$1W([memoize],ListView.prototype,"onTap",null);var __decorate$1V=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__awaiter$1m=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class TraitRenderer{constructor(nt){this.trait=nt,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(nt){return nt}renderElement(nt,ot,rt){const ut=this.renderedElements.findIndex(gt=>gt.templateData===rt);if(ut>=0){const gt=this.renderedElements[ut];this.trait.unrender(rt),gt.index=ot}else{const gt={index:ot,templateData:rt};this.renderedElements.push(gt)}this.trait.renderIndex(ot,rt)}splice(nt,ot,rt){const ut=[];for(const gt of this.renderedElements)gt.index<nt?ut.push(gt):gt.index>=nt+ot&&ut.push({index:gt.index+rt-ot,templateData:gt.templateData});this.renderedElements=ut}renderIndexes(nt){for(const{index:ot,templateData:rt}of this.renderedElements)nt.indexOf(ot)>-1&&this.trait.renderIndex(ot,rt)}disposeTemplate(nt){const ot=this.renderedElements.findIndex(rt=>rt.templateData===nt);ot<0||this.renderedElements.splice(ot,1)}}let Trait$1=class{get name(){return this._trait}get renderer(){return new TraitRenderer(this)}constructor(nt){this._trait=nt,this.length=0,this.indexes=[],this.sortedIndexes=[],this._onChange=new Emitter$2,this.onChange=this._onChange.event}splice(nt,ot,rt){var ut;ot=Math.max(0,Math.min(ot,this.length-nt));const gt=rt.length-ot,pt=nt+ot,mt=[...this.sortedIndexes.filter(St=>St<nt),...rt.map((St,yt)=>St?yt+nt:-1).filter(St=>St!==-1),...this.sortedIndexes.filter(St=>St>=pt).map(St=>St+gt)],vt=this.length+gt;if(this.sortedIndexes.length>0&&mt.length===0&&vt>0){const St=(ut=this.sortedIndexes.find(yt=>yt>=nt))!==null&&ut!==void 0?ut:vt-1;mt.push(Math.min(St,vt-1))}this.renderer.splice(nt,ot,rt.length),this._set(mt,mt),this.length=vt}renderIndex(nt,ot){ot.classList.toggle(this._trait,this.contains(nt))}unrender(nt){nt.classList.remove(this._trait)}set(nt,ot){return this._set(nt,[...nt].sort(numericSort),ot)}_set(nt,ot,rt){const ut=this.indexes,gt=this.sortedIndexes;this.indexes=nt,this.sortedIndexes=ot;const pt=disjunction(gt,nt);return this.renderer.renderIndexes(pt),this._onChange.fire({indexes:nt,browserEvent:rt}),ut}get(){return this.indexes}contains(nt){return binarySearch(this.sortedIndexes,nt,numericSort)>=0}dispose(){dispose(this._onChange)}};__decorate$1V([memoize],Trait$1.prototype,"renderer",null);class SelectionTrait extends Trait$1{constructor(nt){super("selected"),this.setAriaSelected=nt}renderIndex(nt,ot){super.renderIndex(nt,ot),this.setAriaSelected&&(this.contains(nt)?ot.setAttribute("aria-selected","true"):ot.setAttribute("aria-selected","false"))}}class TraitSpliceable{constructor(nt,ot,rt){this.trait=nt,this.view=ot,this.identityProvider=rt}splice(nt,ot,rt){if(!this.identityProvider)return this.trait.splice(nt,ot,rt.map(()=>!1));const ut=this.trait.get().map(pt=>this.identityProvider.getId(this.view.element(pt)).toString()),gt=rt.map(pt=>ut.indexOf(this.identityProvider.getId(pt).toString())>-1);this.trait.splice(nt,ot,gt)}}function isInputElement(ct){return ct.tagName==="INPUT"||ct.tagName==="TEXTAREA"}function isMonacoEditor(ct){return ct.classList.contains("monaco-editor")?!0:ct.classList.contains("monaco-list")||!ct.parentElement?!1:isMonacoEditor(ct.parentElement)}function isButton(ct){return ct.tagName==="A"&&ct.classList.contains("monaco-button")||ct.tagName==="DIV"&&ct.classList.contains("monaco-button-dropdown")?!0:ct.classList.contains("monaco-list")||!ct.parentElement?!1:isButton(ct.parentElement)}class KeyboardController{get onKeyDown(){return this.disposables.add(Event.chain(this.disposables.add(new DomEmitter(this.view.domNode,"keydown")).event).filter(nt=>!isInputElement(nt.target)).map(nt=>new StandardKeyboardEvent(nt)))}constructor(nt,ot,rt){this.list=nt,this.view=ot,this.disposables=new DisposableStore,this.multipleSelectionDisposables=new DisposableStore,this.onKeyDown.filter(ut=>ut.keyCode===3).on(this.onEnter,this,this.disposables),this.onKeyDown.filter(ut=>ut.keyCode===16).on(this.onUpArrow,this,this.disposables),this.onKeyDown.filter(ut=>ut.keyCode===18).on(this.onDownArrow,this,this.disposables),this.onKeyDown.filter(ut=>ut.keyCode===11).on(this.onPageUpArrow,this,this.disposables),this.onKeyDown.filter(ut=>ut.keyCode===12).on(this.onPageDownArrow,this,this.disposables),this.onKeyDown.filter(ut=>ut.keyCode===9).on(this.onEscape,this,this.disposables),rt.multipleSelectionSupport!==!1&&this.onKeyDown.filter(ut=>(isMacintosh?ut.metaKey:ut.ctrlKey)&&ut.keyCode===31).on(this.onCtrlA,this,this.multipleSelectionDisposables)}updateOptions(nt){nt.multipleSelectionSupport!==void 0&&(this.multipleSelectionDisposables.clear(),nt.multipleSelectionSupport&&this.onKeyDown.filter(ot=>(isMacintosh?ot.metaKey:ot.ctrlKey)&&ot.keyCode===31).on(this.onCtrlA,this,this.multipleSelectionDisposables))}onEnter(nt){nt.preventDefault(),nt.stopPropagation(),this.list.setSelection(this.list.getFocus(),nt.browserEvent)}onUpArrow(nt){nt.preventDefault(),nt.stopPropagation(),this.list.focusPrevious(1,!1,nt.browserEvent);const ot=this.list.getFocus()[0];this.list.setAnchor(ot),this.list.reveal(ot),this.view.domNode.focus()}onDownArrow(nt){nt.preventDefault(),nt.stopPropagation(),this.list.focusNext(1,!1,nt.browserEvent);const ot=this.list.getFocus()[0];this.list.setAnchor(ot),this.list.reveal(ot),this.view.domNode.focus()}onPageUpArrow(nt){nt.preventDefault(),nt.stopPropagation(),this.list.focusPreviousPage(nt.browserEvent);const ot=this.list.getFocus()[0];this.list.setAnchor(ot),this.list.reveal(ot),this.view.domNode.focus()}onPageDownArrow(nt){nt.preventDefault(),nt.stopPropagation(),this.list.focusNextPage(nt.browserEvent);const ot=this.list.getFocus()[0];this.list.setAnchor(ot),this.list.reveal(ot),this.view.domNode.focus()}onCtrlA(nt){nt.preventDefault(),nt.stopPropagation(),this.list.setSelection(range(this.list.length),nt.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(nt){this.list.getSelection().length&&(nt.preventDefault(),nt.stopPropagation(),this.list.setSelection([],nt.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}__decorate$1V([memoize],KeyboardController.prototype,"onKeyDown",null);var TypeNavigationMode;(function(ct){ct[ct.Automatic=0]="Automatic",ct[ct.Trigger=1]="Trigger"})(TypeNavigationMode||(TypeNavigationMode={}));var TypeNavigationControllerState;(function(ct){ct[ct.Idle=0]="Idle",ct[ct.Typing=1]="Typing"})(TypeNavigationControllerState||(TypeNavigationControllerState={}));const DefaultKeyboardNavigationDelegate=new class{mightProducePrintableCharacter(ct){return ct.ctrlKey||ct.metaKey||ct.altKey?!1:ct.keyCode>=31&&ct.keyCode<=56||ct.keyCode>=21&&ct.keyCode<=30||ct.keyCode>=98&&ct.keyCode<=107||ct.keyCode>=85&&ct.keyCode<=95}};class TypeNavigationController{constructor(nt,ot,rt,ut,gt){this.list=nt,this.view=ot,this.keyboardNavigationLabelProvider=rt,this.keyboardNavigationEventFilter=ut,this.delegate=gt,this.enabled=!1,this.state=TypeNavigationControllerState.Idle,this.mode=TypeNavigationMode.Automatic,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new DisposableStore,this.disposables=new DisposableStore,this.updateOptions(nt.options)}updateOptions(nt){var ot,rt;!((ot=nt.typeNavigationEnabled)!==null&&ot!==void 0)||ot?this.enable():this.disable(),this.mode=(rt=nt.typeNavigationMode)!==null&&rt!==void 0?rt:TypeNavigationMode.Automatic}enable(){if(this.enabled)return;let nt=!1;const ot=this.enabledDisposables.add(Event.chain(this.enabledDisposables.add(new DomEmitter(this.view.domNode,"keydown")).event)).filter(gt=>!isInputElement(gt.target)).filter(()=>this.mode===TypeNavigationMode.Automatic||this.triggered).map(gt=>new StandardKeyboardEvent(gt)).filter(gt=>nt||this.keyboardNavigationEventFilter(gt)).filter(gt=>this.delegate.mightProducePrintableCharacter(gt)).forEach(gt=>EventHelper.stop(gt,!0)).map(gt=>gt.browserEvent.key).event,rt=Event.debounce(ot,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);Event.reduce(Event.any(ot,rt),(gt,pt)=>pt===null?null:(gt||"")+pt,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),rt(this.onClear,this,this.enabledDisposables),ot(()=>nt=!0,void 0,this.enabledDisposables),rt(()=>nt=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var nt;const ot=this.list.getFocus();if(ot.length>0&&ot[0]===this.previouslyFocused){const rt=(nt=this.list.options.accessibilityProvider)===null||nt===void 0?void 0:nt.getAriaLabel(this.list.element(ot[0]));rt&&alert(rt)}this.previouslyFocused=-1}onInput(nt){if(!nt){this.state=TypeNavigationControllerState.Idle,this.triggered=!1;return}const ot=this.list.getFocus(),rt=ot.length>0?ot[0]:0,ut=this.state===TypeNavigationControllerState.Idle?1:0;this.state=TypeNavigationControllerState.Typing;for(let gt=0;gt<this.list.length;gt++){const pt=(rt+gt+ut)%this.list.length,mt=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(pt)),vt=mt&&mt.toString();if(typeof vt>"u"||matchesPrefix(nt,vt)){this.previouslyFocused=rt,this.list.setFocus([pt]),this.list.reveal(pt);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class DOMFocusController{constructor(nt,ot){this.list=nt,this.view=ot,this.disposables=new DisposableStore,this.disposables.add(Event.chain(this.disposables.add(new DomEmitter(ot.domNode,"keydown")).event)).filter(ut=>!isInputElement(ut.target)).map(ut=>new StandardKeyboardEvent(ut)).filter(ut=>ut.keyCode===2&&!ut.ctrlKey&&!ut.metaKey&&!ut.shiftKey&&!ut.altKey).on(this.onTab,this,this.disposables)}onTab(nt){if(nt.target!==this.view.domNode)return;const ot=this.list.getFocus();if(ot.length===0)return;const rt=this.view.domElement(ot[0]);if(!rt)return;const ut=rt.querySelector("[tabIndex]");if(!ut||!(ut instanceof HTMLElement)||ut.tabIndex===-1)return;const gt=window.getComputedStyle(ut);gt.visibility==="hidden"||gt.display==="none"||(nt.preventDefault(),nt.stopPropagation(),ut.focus())}dispose(){this.disposables.dispose()}}function isSelectionSingleChangeEvent(ct){return isMacintosh?ct.browserEvent.metaKey:ct.browserEvent.ctrlKey}function isSelectionRangeChangeEvent(ct){return ct.browserEvent.shiftKey}function isMouseRightClick(ct){return ct instanceof MouseEvent&&ct.button===2}const DefaultMultipleSelectionController={isSelectionSingleChangeEvent,isSelectionRangeChangeEvent};class MouseController{constructor(nt){this.list=nt,this.disposables=new DisposableStore,this._onPointer=new Emitter$2,this.onPointer=this._onPointer.event,nt.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||DefaultMultipleSelectionController),this.mouseSupport=typeof nt.options.mouseSupport>"u"||!!nt.options.mouseSupport,this.mouseSupport&&(nt.onMouseDown(this.onMouseDown,this,this.disposables),nt.onContextMenu(this.onContextMenu,this,this.disposables),nt.onMouseDblClick(this.onDoubleClick,this,this.disposables),nt.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Gesture.addTarget(nt.getHTMLElement()))),Event.any(nt.onMouseClick,nt.onMouseMiddleClick,nt.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(nt){nt.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,nt.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||DefaultMultipleSelectionController))}isSelectionSingleChangeEvent(nt){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(nt):!1}isSelectionRangeChangeEvent(nt){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(nt):!1}isSelectionChangeEvent(nt){return this.isSelectionSingleChangeEvent(nt)||this.isSelectionRangeChangeEvent(nt)}onMouseDown(nt){isMonacoEditor(nt.browserEvent.target)||document.activeElement!==nt.browserEvent.target&&this.list.domFocus()}onContextMenu(nt){if(isInputElement(nt.browserEvent.target)||isMonacoEditor(nt.browserEvent.target))return;const ot=typeof nt.index>"u"?[]:[nt.index];this.list.setFocus(ot,nt.browserEvent)}onViewPointer(nt){if(!this.mouseSupport||isInputElement(nt.browserEvent.target)||isMonacoEditor(nt.browserEvent.target))return;const ot=nt.index;if(typeof ot>"u"){this.list.setFocus([],nt.browserEvent),this.list.setSelection([],nt.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionRangeChangeEvent(nt))return this.changeSelection(nt);if(this.isSelectionChangeEvent(nt))return this.changeSelection(nt);this.list.setFocus([ot],nt.browserEvent),this.list.setAnchor(ot),isMouseRightClick(nt.browserEvent)||this.list.setSelection([ot],nt.browserEvent),this._onPointer.fire(nt)}onDoubleClick(nt){if(isInputElement(nt.browserEvent.target)||isMonacoEditor(nt.browserEvent.target)||this.isSelectionChangeEvent(nt))return;const ot=this.list.getFocus();this.list.setSelection(ot,nt.browserEvent)}changeSelection(nt){const ot=nt.index;let rt=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(nt)){if(typeof rt>"u"){const yt=this.list.getFocus()[0];rt=yt??ot,this.list.setAnchor(rt)}const ut=Math.min(rt,ot),gt=Math.max(rt,ot),pt=range(ut,gt+1),mt=this.list.getSelection(),vt=getContiguousRangeContaining(disjunction(mt,[rt]),rt);if(vt.length===0)return;const St=disjunction(pt,relativeComplement(mt,vt));this.list.setSelection(St,nt.browserEvent),this.list.setFocus([ot],nt.browserEvent)}else if(this.isSelectionSingleChangeEvent(nt)){const ut=this.list.getSelection(),gt=ut.filter(pt=>pt!==ot);this.list.setFocus([ot]),this.list.setAnchor(ot),ut.length===gt.length?this.list.setSelection([...gt,ot],nt.browserEvent):this.list.setSelection(gt,nt.browserEvent)}}dispose(){this.disposables.dispose()}}class DefaultStyleController{constructor(nt,ot){this.styleElement=nt,this.selectorSuffix=ot}style(nt){var ot,rt;const ut=this.selectorSuffix&&`.${this.selectorSuffix}`,gt=[];nt.listBackground&&gt.push(`.monaco-list${ut} .monaco-list-rows { background: ${nt.listBackground}; }`),nt.listFocusBackground&&(gt.push(`.monaco-list${ut}:focus .monaco-list-row.focused { background-color: ${nt.listFocusBackground}; }`),gt.push(`.monaco-list${ut}:focus .monaco-list-row.focused:hover { background-color: ${nt.listFocusBackground}; }`)),nt.listFocusForeground&&gt.push(`.monaco-list${ut}:focus .monaco-list-row.focused { color: ${nt.listFocusForeground}; }`),nt.listActiveSelectionBackground&&(gt.push(`.monaco-list${ut}:focus .monaco-list-row.selected { background-color: ${nt.listActiveSelectionBackground}; }`),gt.push(`.monaco-list${ut}:focus .monaco-list-row.selected:hover { background-color: ${nt.listActiveSelectionBackground}; }`)),nt.listActiveSelectionForeground&&gt.push(`.monaco-list${ut}:focus .monaco-list-row.selected { color: ${nt.listActiveSelectionForeground}; }`),nt.listActiveSelectionIconForeground&&gt.push(`.monaco-list${ut}:focus .monaco-list-row.selected .codicon { color: ${nt.listActiveSelectionIconForeground}; }`),nt.listFocusAndSelectionBackground&&gt.push(`
				.monaco-drag-image,
				.monaco-list${ut}:focus .monaco-list-row.selected.focused { background-color: ${nt.listFocusAndSelectionBackground}; }
			`),nt.listFocusAndSelectionForeground&&gt.push(`
				.monaco-drag-image,
				.monaco-list${ut}:focus .monaco-list-row.selected.focused { color: ${nt.listFocusAndSelectionForeground}; }
			`),nt.listInactiveFocusForeground&&(gt.push(`.monaco-list${ut} .monaco-list-row.focused { color:  ${nt.listInactiveFocusForeground}; }`),gt.push(`.monaco-list${ut} .monaco-list-row.focused:hover { color:  ${nt.listInactiveFocusForeground}; }`)),nt.listInactiveSelectionIconForeground&&gt.push(`.monaco-list${ut} .monaco-list-row.focused .codicon { color:  ${nt.listInactiveSelectionIconForeground}; }`),nt.listInactiveFocusBackground&&(gt.push(`.monaco-list${ut} .monaco-list-row.focused { background-color:  ${nt.listInactiveFocusBackground}; }`),gt.push(`.monaco-list${ut} .monaco-list-row.focused:hover { background-color:  ${nt.listInactiveFocusBackground}; }`)),nt.listInactiveSelectionBackground&&(gt.push(`.monaco-list${ut} .monaco-list-row.selected { background-color:  ${nt.listInactiveSelectionBackground}; }`),gt.push(`.monaco-list${ut} .monaco-list-row.selected:hover { background-color:  ${nt.listInactiveSelectionBackground}; }`)),nt.listInactiveSelectionForeground&&gt.push(`.monaco-list${ut} .monaco-list-row.selected { color: ${nt.listInactiveSelectionForeground}; }`),nt.listHoverBackground&&gt.push(`.monaco-list${ut}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${nt.listHoverBackground}; }`),nt.listHoverForeground&&gt.push(`.monaco-list${ut}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${nt.listHoverForeground}; }`);const pt=asCssValueWithDefault(nt.listFocusAndSelectionOutline,asCssValueWithDefault(nt.listSelectionOutline,(ot=nt.listFocusOutline)!==null&&ot!==void 0?ot:""));pt&&gt.push(`.monaco-list${ut}:focus .monaco-list-row.focused.selected { outline: 1px solid ${pt}; outline-offset: -1px;}`),nt.listFocusOutline&&gt.push(`
				.monaco-drag-image,
				.monaco-list${ut}:focus .monaco-list-row.focused { outline: 1px solid ${nt.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${ut}.last-focused .monaco-list-row.focused { outline: 1px solid ${nt.listFocusOutline}; outline-offset: -1px; }
			`);const mt=asCssValueWithDefault(nt.listSelectionOutline,(rt=nt.listInactiveFocusOutline)!==null&&rt!==void 0?rt:"");mt&&gt.push(`.monaco-list${ut} .monaco-list-row.focused.selected { outline: 1px dotted ${mt}; outline-offset: -1px; }`),nt.listSelectionOutline&&gt.push(`.monaco-list${ut} .monaco-list-row.selected { outline: 1px dotted ${nt.listSelectionOutline}; outline-offset: -1px; }`),nt.listInactiveFocusOutline&&gt.push(`.monaco-list${ut} .monaco-list-row.focused { outline: 1px dotted ${nt.listInactiveFocusOutline}; outline-offset: -1px; }`),nt.listHoverOutline&&gt.push(`.monaco-list${ut} .monaco-list-row:hover { outline: 1px dashed ${nt.listHoverOutline}; outline-offset: -1px; }`),nt.listDropBackground&&gt.push(`
				.monaco-list${ut}.drop-target,
				.monaco-list${ut} .monaco-list-rows.drop-target,
				.monaco-list${ut} .monaco-list-row.drop-target { background-color: ${nt.listDropBackground} !important; color: inherit !important; }
			`),nt.tableColumnsBorder&&gt.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${nt.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),nt.tableOddRowsBackgroundColor&&gt.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${nt.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=gt.join(`
`)}}const unthemedListStyles={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropBackground:"#383B3D",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:Color.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:Color.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:Color.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0},DefaultOptions={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){}}};function getContiguousRangeContaining(ct,nt){const ot=ct.indexOf(nt);if(ot===-1)return[];const rt=[];let ut=ot-1;for(;ut>=0&&ct[ut]===nt-(ot-ut);)rt.push(ct[ut--]);for(rt.reverse(),ut=ot;ut<ct.length&&ct[ut]===nt+(ut-ot);)rt.push(ct[ut++]);return rt}function disjunction(ct,nt){const ot=[];let rt=0,ut=0;for(;rt<ct.length||ut<nt.length;)if(rt>=ct.length)ot.push(nt[ut++]);else if(ut>=nt.length)ot.push(ct[rt++]);else if(ct[rt]===nt[ut]){ot.push(ct[rt]),rt++,ut++;continue}else ct[rt]<nt[ut]?ot.push(ct[rt++]):ot.push(nt[ut++]);return ot}function relativeComplement(ct,nt){const ot=[];let rt=0,ut=0;for(;rt<ct.length||ut<nt.length;)if(rt>=ct.length)ot.push(nt[ut++]);else if(ut>=nt.length)ot.push(ct[rt++]);else if(ct[rt]===nt[ut]){rt++,ut++;continue}else ct[rt]<nt[ut]?ot.push(ct[rt++]):ut++;return ot}const numericSort=(ct,nt)=>ct-nt;class PipelineRenderer{constructor(nt,ot){this._templateId=nt,this.renderers=ot}get templateId(){return this._templateId}renderTemplate(nt){return this.renderers.map(ot=>ot.renderTemplate(nt))}renderElement(nt,ot,rt,ut){let gt=0;for(const pt of this.renderers)pt.renderElement(nt,ot,rt[gt++],ut)}disposeElement(nt,ot,rt,ut){var gt;let pt=0;for(const mt of this.renderers)(gt=mt.disposeElement)===null||gt===void 0||gt.call(mt,nt,ot,rt[pt],ut),pt+=1}disposeTemplate(nt){let ot=0;for(const rt of this.renderers)rt.disposeTemplate(nt[ot++])}}class AccessibiltyRenderer{constructor(nt){this.accessibilityProvider=nt,this.templateId="a18n"}renderTemplate(nt){return nt}renderElement(nt,ot,rt){const ut=this.accessibilityProvider.getAriaLabel(nt);ut?rt.setAttribute("aria-label",ut):rt.removeAttribute("aria-label");const gt=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(nt);typeof gt=="number"?rt.setAttribute("aria-level",`${gt}`):rt.removeAttribute("aria-level")}disposeTemplate(nt){}}class ListViewDragAndDrop{constructor(nt,ot){this.list=nt,this.dnd=ot}getDragElements(nt){const ot=this.list.getSelectedElements();return ot.indexOf(nt)>-1?ot:[nt]}getDragURI(nt){return this.dnd.getDragURI(nt)}getDragLabel(nt,ot){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(nt,ot)}onDragStart(nt,ot){var rt,ut;(ut=(rt=this.dnd).onDragStart)===null||ut===void 0||ut.call(rt,nt,ot)}onDragOver(nt,ot,rt,ut){return this.dnd.onDragOver(nt,ot,rt,ut)}onDragLeave(nt,ot,rt,ut){var gt,pt;(pt=(gt=this.dnd).onDragLeave)===null||pt===void 0||pt.call(gt,nt,ot,rt,ut)}onDragEnd(nt){var ot,rt;(rt=(ot=this.dnd).onDragEnd)===null||rt===void 0||rt.call(ot,nt)}drop(nt,ot,rt,ut){this.dnd.drop(nt,ot,rt,ut)}}class List{get onDidChangeFocus(){return Event.map(this.eventBufferer.wrapEvent(this.focus.onChange),nt=>this.toListEvent(nt),this.disposables)}get onDidChangeSelection(){return Event.map(this.eventBufferer.wrapEvent(this.selection.onChange),nt=>this.toListEvent(nt),this.disposables)}get domId(){return this.view.domId}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let nt=!1;const ot=this.disposables.add(Event.chain(this.disposables.add(new DomEmitter(this.view.domNode,"keydown")).event)).map(gt=>new StandardKeyboardEvent(gt)).filter(gt=>nt=gt.keyCode===58||gt.shiftKey&&gt.keyCode===68).map(gt=>EventHelper.stop(gt,!0)).filter(()=>!1).event,rt=this.disposables.add(Event.chain(this.disposables.add(new DomEmitter(this.view.domNode,"keyup")).event)).forEach(()=>nt=!1).map(gt=>new StandardKeyboardEvent(gt)).filter(gt=>gt.keyCode===58||gt.shiftKey&&gt.keyCode===68).map(gt=>EventHelper.stop(gt,!0)).map(({browserEvent:gt})=>{const pt=this.getFocus(),mt=pt.length?pt[0]:void 0,vt=typeof mt<"u"?this.view.element(mt):void 0,St=typeof mt<"u"?this.view.domElement(mt):this.view.domNode;return{index:mt,element:vt,anchor:St,browserEvent:gt}}).event,ut=this.disposables.add(Event.chain(this.view.onContextMenu)).filter(gt=>!nt).map(({element:gt,index:pt,browserEvent:mt})=>({element:gt,index:pt,anchor:{x:mt.pageX+1,y:mt.pageY},browserEvent:mt})).event;return Event.any(ot,rt,ut)}get onKeyDown(){return this.disposables.add(new DomEmitter(this.view.domNode,"keydown")).event}get onDidFocus(){return Event.signal(this.disposables.add(new DomEmitter(this.view.domNode,"focus",!0)).event)}constructor(nt,ot,rt,ut,gt=DefaultOptions){var pt,mt,vt,St;this.user=nt,this._options=gt,this.focus=new Trait$1("focused"),this.anchor=new Trait$1("anchor"),this.eventBufferer=new EventBufferer,this._ariaLabel="",this.disposables=new DisposableStore,this._onDidDispose=new Emitter$2,this.onDidDispose=this._onDidDispose.event;const yt=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?(pt=this._options.accessibilityProvider)===null||pt===void 0?void 0:pt.getWidgetRole():"list";this.selection=new SelectionTrait(yt!=="listbox");const wt=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=gt.accessibilityProvider,this.accessibilityProvider&&(wt.push(new AccessibiltyRenderer(this.accessibilityProvider)),(vt=(mt=this.accessibilityProvider).onDidChangeActiveDescendant)===null||vt===void 0||vt.call(mt,this.onDidChangeActiveDescendant,this,this.disposables)),ut=ut.map(xt=>new PipelineRenderer(xt.templateId,[...wt,xt]));const Lt=Object.assign(Object.assign({},gt),{dnd:gt.dnd&&new ListViewDragAndDrop(this,gt.dnd)});if(this.view=this.createListView(ot,rt,ut,Lt),this.view.domNode.setAttribute("role",yt),gt.styleController)this.styleController=gt.styleController(this.view.domId);else{const xt=createStyleSheet(this.view.domNode);this.styleController=new DefaultStyleController(xt,this.view.domId)}if(this.spliceable=new CombinedSpliceable([new TraitSpliceable(this.focus,this.view,gt.identityProvider),new TraitSpliceable(this.selection,this.view,gt.identityProvider),new TraitSpliceable(this.anchor,this.view,gt.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new DOMFocusController(this,this.view)),(typeof gt.keyboardSupport!="boolean"||gt.keyboardSupport)&&(this.keyboardController=new KeyboardController(this,this.view,gt),this.disposables.add(this.keyboardController)),gt.keyboardNavigationLabelProvider){const xt=gt.keyboardNavigationDelegate||DefaultKeyboardNavigationDelegate;this.typeNavigationController=new TypeNavigationController(this,this.view,gt.keyboardNavigationLabelProvider,(St=gt.keyboardNavigationEventFilter)!==null&&St!==void 0?St:()=>!0,xt),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(gt),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}createListView(nt,ot,rt,ut){return new ListView(nt,ot,rt,ut)}createMouseController(nt){return new MouseController(this)}updateOptions(nt={}){var ot,rt;this._options=Object.assign(Object.assign({},this._options),nt),(ot=this.typeNavigationController)===null||ot===void 0||ot.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(nt),(rt=this.keyboardController)===null||rt===void 0||rt.updateOptions(nt),this.view.updateOptions(nt)}get options(){return this._options}splice(nt,ot,rt=[]){if(nt<0||nt>this.view.length)throw new ListError(this.user,`Invalid start index: ${nt}`);if(ot<0)throw new ListError(this.user,`Invalid delete count: ${ot}`);ot===0&&rt.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(nt,ot,rt))}rerender(){this.view.rerender()}element(nt){return this.view.element(nt)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(nt){this.view.setScrollTop(nt)}get scrollHeight(){return this.view.scrollHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(nt){this._ariaLabel=nt,this.view.domNode.setAttribute("aria-label",nt)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(nt,ot){this.view.layout(nt,ot)}setSelection(nt,ot){for(const rt of nt)if(rt<0||rt>=this.length)throw new ListError(this.user,`Invalid index ${rt}`);this.selection.set(nt,ot)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(nt=>this.view.element(nt))}setAnchor(nt){if(typeof nt>"u"){this.anchor.set([]);return}if(nt<0||nt>=this.length)throw new ListError(this.user,`Invalid index ${nt}`);this.anchor.set([nt])}getAnchor(){return firstOrDefault(this.anchor.get(),void 0)}getAnchorElement(){const nt=this.getAnchor();return typeof nt>"u"?void 0:this.element(nt)}setFocus(nt,ot){for(const rt of nt)if(rt<0||rt>=this.length)throw new ListError(this.user,`Invalid index ${rt}`);this.focus.set(nt,ot)}focusNext(nt=1,ot=!1,rt,ut){if(this.length===0)return;const gt=this.focus.get(),pt=this.findNextIndex(gt.length>0?gt[0]+nt:0,ot,ut);pt>-1&&this.setFocus([pt],rt)}focusPrevious(nt=1,ot=!1,rt,ut){if(this.length===0)return;const gt=this.focus.get(),pt=this.findPreviousIndex(gt.length>0?gt[0]-nt:0,ot,ut);pt>-1&&this.setFocus([pt],rt)}focusNextPage(nt,ot){return __awaiter$1m(this,void 0,void 0,function*(){let rt=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);rt=rt===0?0:rt-1;const ut=this.getFocus()[0];if(ut!==rt&&(ut===void 0||rt>ut)){const gt=this.findPreviousIndex(rt,!1,ot);gt>-1&&ut!==gt?this.setFocus([gt],nt):this.setFocus([rt],nt)}else{const gt=this.view.getScrollTop();let pt=gt+this.view.renderHeight;rt>ut&&(pt-=this.view.elementHeight(rt)),this.view.setScrollTop(pt),this.view.getScrollTop()!==gt&&(this.setFocus([]),yield timeout(0),yield this.focusNextPage(nt,ot))}})}focusPreviousPage(nt,ot){return __awaiter$1m(this,void 0,void 0,function*(){let rt;const ut=this.view.getScrollTop();ut===0?rt=this.view.indexAt(ut):rt=this.view.indexAfter(ut-1);const gt=this.getFocus()[0];if(gt!==rt&&(gt===void 0||gt>=rt)){const pt=this.findNextIndex(rt,!1,ot);pt>-1&&gt!==pt?this.setFocus([pt],nt):this.setFocus([rt],nt)}else{const pt=ut;this.view.setScrollTop(ut-this.view.renderHeight),this.view.getScrollTop()!==pt&&(this.setFocus([]),yield timeout(0),yield this.focusPreviousPage(nt,ot))}})}focusLast(nt,ot){if(this.length===0)return;const rt=this.findPreviousIndex(this.length-1,!1,ot);rt>-1&&this.setFocus([rt],nt)}focusFirst(nt,ot){this.focusNth(0,nt,ot)}focusNth(nt,ot,rt){if(this.length===0)return;const ut=this.findNextIndex(nt,!1,rt);ut>-1&&this.setFocus([ut],ot)}findNextIndex(nt,ot=!1,rt){for(let ut=0;ut<this.length;ut++){if(nt>=this.length&&!ot)return-1;if(nt=nt%this.length,!rt||rt(this.element(nt)))return nt;nt++}return-1}findPreviousIndex(nt,ot=!1,rt){for(let ut=0;ut<this.length;ut++){if(nt<0&&!ot)return-1;if(nt=(this.length+nt%this.length)%this.length,!rt||rt(this.element(nt)))return nt;nt--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(nt=>this.view.element(nt))}reveal(nt,ot){if(nt<0||nt>=this.length)throw new ListError(this.user,`Invalid index ${nt}`);const rt=this.view.getScrollTop(),ut=this.view.elementTop(nt),gt=this.view.elementHeight(nt);if(isNumber$1(ot)){const pt=gt-this.view.renderHeight;this.view.setScrollTop(pt*clamp(ot,0,1)+ut)}else{const pt=ut+gt,mt=rt+this.view.renderHeight;ut<rt&&pt>=mt||(ut<rt||pt>=mt&&gt>=this.view.renderHeight?this.view.setScrollTop(ut):pt>=mt&&this.view.setScrollTop(pt-this.view.renderHeight))}}getHTMLElement(){return this.view.domNode}getElementID(nt){return this.view.getElementDomId(nt)}style(nt){this.styleController.style(nt)}toListEvent({indexes:nt,browserEvent:ot}){return{indexes:nt,elements:nt.map(rt=>this.view.element(rt)),browserEvent:ot}}_onFocusChange(){const nt=this.focus.get();this.view.domNode.classList.toggle("element-focused",nt.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var nt;const ot=this.focus.get();if(ot.length>0){let rt;!((nt=this.accessibilityProvider)===null||nt===void 0)&&nt.getActiveDescendantId&&(rt=this.accessibilityProvider.getActiveDescendantId(this.view.element(ot[0]))),this.view.domNode.setAttribute("aria-activedescendant",rt||this.view.getElementDomId(ot[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const nt=this.selection.get();this.view.domNode.classList.toggle("selection-none",nt.length===0),this.view.domNode.classList.toggle("selection-single",nt.length===1),this.view.domNode.classList.toggle("selection-multiple",nt.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}__decorate$1V([memoize],List.prototype,"onDidChangeFocus",null);__decorate$1V([memoize],List.prototype,"onDidChangeSelection",null);__decorate$1V([memoize],List.prototype,"onContextMenu",null);__decorate$1V([memoize],List.prototype,"onKeyDown",null);__decorate$1V([memoize],List.prototype,"onDidFocus",null);const selectBoxCustom="",$$c=$$d,SELECT_OPTION_ENTRY_TEMPLATE_ID="selectOption.entry.template";class SelectListRenderer{get templateId(){return SELECT_OPTION_ENTRY_TEMPLATE_ID}renderTemplate(nt){const ot=Object.create(null);return ot.root=nt,ot.text=append$1(nt,$$c(".option-text")),ot.detail=append$1(nt,$$c(".option-detail")),ot.decoratorRight=append$1(nt,$$c(".option-decorator-right")),ot}renderElement(nt,ot,rt){const ut=rt,gt=nt.text,pt=nt.detail,mt=nt.decoratorRight,vt=nt.isDisabled;ut.text.textContent=gt,ut.detail.textContent=pt||"",ut.decoratorRight.innerText=mt||"",vt?ut.root.classList.add("option-disabled"):ut.root.classList.remove("option-disabled")}disposeTemplate(nt){}}class SelectBoxList extends Disposable{constructor(nt,ot,rt,ut,gt){super(),this.options=[],this._currentSelection=0,this._hasDetails=!1,this._skipLayout=!1,this._sticky=!1,this._isVisible=!1,this.styles=ut,this.selectBoxOptions=gt||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=SelectBoxList.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new Emitter$2,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(rt),this.selected=ot||0,nt&&this.setOptions(nt,ot),this.initStyleSheet()}getHeight(){return 22}getTemplateId(){return SELECT_OPTION_ENTRY_TEMPLATE_ID}constructSelectDropDown(nt){this.contextViewProvider=nt,this.selectDropDownContainer=$$d(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=append$1(this.selectDropDownContainer,$$c(".select-box-details-pane"));const ot=append$1(this.selectDropDownContainer,$$c(".select-box-dropdown-container-width-control")),rt=append$1(ot,$$c(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",append$1(rt,this.widthControlElement),this._dropDownPosition=0,this.styleElement=createStyleSheet(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(addDisposableListener(this.selectDropDownContainer,EventType$1.DRAG_START,ut=>{EventHelper.stop(ut,!0)}))}registerListeners(){this._register(addStandardDisposableListener(this.selectElement,"change",ot=>{this.selected=ot.target.selectedIndex,this._onDidSelect.fire({index:ot.target.selectedIndex,selected:ot.target.value}),this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)})),this._register(addDisposableListener(this.selectElement,EventType$1.CLICK,ot=>{EventHelper.stop(ot),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(addDisposableListener(this.selectElement,EventType$1.MOUSE_DOWN,ot=>{EventHelper.stop(ot)}));let nt;this._register(addDisposableListener(this.selectElement,"touchstart",ot=>{nt=this._isVisible})),this._register(addDisposableListener(this.selectElement,"touchend",ot=>{EventHelper.stop(ot),nt?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(addDisposableListener(this.selectElement,EventType$1.KEY_DOWN,ot=>{const rt=new StandardKeyboardEvent(ot);let ut=!1;isMacintosh?(rt.keyCode===18||rt.keyCode===16||rt.keyCode===10||rt.keyCode===3)&&(ut=!0):(rt.keyCode===18&&rt.altKey||rt.keyCode===16&&rt.altKey||rt.keyCode===10||rt.keyCode===3)&&(ut=!0),ut&&(this.showSelectDropDown(),EventHelper.stop(ot,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(nt,ot){equals$2(this.options,nt)||(this.options=nt,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((rt,ut)=>{this.selectElement.add(this.createOption(rt.text,ut,rt.isDisabled)),typeof rt.description=="string"&&(this._hasDetails=!0)})),ot!==void 0&&(this.select(ot),this._currentSelection=this.selected)}setOptionsList(){var nt;(nt=this.selectList)===null||nt===void 0||nt.splice(0,this.selectList.length,this.options)}select(nt){nt>=0&&nt<this.options.length?this.selected=nt:nt>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(nt){this.selectElement.tabIndex=nt?0:-1}render(nt){this.container=nt,nt.classList.add("select-container"),nt.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){const nt=[];this.styles.listFocusBackground&&nt.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&nt.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&nt.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(nt.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),nt.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),nt.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(nt.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),nt.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&nt.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&nt.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&nt.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&nt.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),nt.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),nt.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=nt.join(`
`)}styleSelectElement(){var nt,ot,rt;const ut=(nt=this.styles.selectBackground)!==null&&nt!==void 0?nt:"",gt=(ot=this.styles.selectForeground)!==null&&ot!==void 0?ot:"",pt=(rt=this.styles.selectBorder)!==null&&rt!==void 0?rt:"";this.selectElement.style.backgroundColor=ut,this.selectElement.style.color=gt,this.selectElement.style.borderColor=pt}styleList(){var nt,ot;const rt=(nt=this.styles.selectBackground)!==null&&nt!==void 0?nt:"",ut=asCssValueWithDefault(this.styles.selectListBackground,rt);this.selectDropDownListContainer.style.backgroundColor=ut,this.selectionDetailsPane.style.backgroundColor=ut;const gt=(ot=this.styles.focusBorder)!==null&&ot!==void 0?ot:"";this.selectDropDownContainer.style.outlineColor=gt,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(nt,ot,rt){const ut=document.createElement("option");return ut.value=nt,ut.text=nt,ut.disabled=!!rt,ut}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:nt=>this.renderSelectDropDown(nt,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:nt=>this.renderSelectDropDown(nt),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(nt){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),nt&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(nt,ot){return nt.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(ot),{dispose:()=>{try{nt.removeChild(this.selectDropDownContainer)}catch{}}}}measureMaxDetailsHeight(){let nt=0;return this.options.forEach((ot,rt)=>{this.updateDetail(rt),this.selectionDetailsPane.offsetHeight>nt&&(nt=this.selectionDetailsPane.offsetHeight)}),nt}layoutSelectDropDown(nt){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");const ot=getDomNodePagePosition(this.selectElement),rt=getComputedStyle(this.selectElement),ut=parseFloat(rt.getPropertyValue("--dropdown-padding-top"))+parseFloat(rt.getPropertyValue("--dropdown-padding-bottom")),gt=window.innerHeight-ot.top-ot.height-(this.selectBoxOptions.minBottomMargin||0),pt=ot.top-SelectBoxList.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,mt=this.selectElement.offsetWidth,vt=this.setWidthControlElement(this.widthControlElement),St=Math.max(vt,Math.round(mt)).toString()+"px";this.selectDropDownContainer.style.width=St,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let yt=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());const wt=this._hasDetails?this._cachedMaxDetailsHeight:0,Lt=yt+ut+wt,xt=Math.floor((gt-ut-wt)/this.getHeight()),It=Math.floor((pt-ut-wt)/this.getHeight());if(nt)return ot.top+ot.height>window.innerHeight-22||ot.top<SelectBoxList.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||xt<1&&It<1?!1:(xt<SelectBoxList.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&It>xt&&this.options.length>xt?(this._dropDownPosition=1,this.selectDropDownContainer.removeChild(this.selectDropDownListContainer),this.selectDropDownContainer.removeChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownContainer.removeChild(this.selectDropDownListContainer),this.selectDropDownContainer.removeChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(ot.top+ot.height>window.innerHeight-22||ot.top<SelectBoxList.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&xt<1||this._dropDownPosition===1&&It<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&xt+It<1)return this.hideSelectDropDown(!0),!1;Lt>gt&&(yt=xt*this.getHeight())}else Lt>pt&&(yt=It*this.getHeight());return this.selectList.layout(yt),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=yt+ut+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=yt+ut+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=St,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(nt){let ot=0;if(nt){let rt=0,ut=0;this.options.forEach((gt,pt)=>{const mt=gt.detail?gt.detail.length:0,vt=gt.decoratorRight?gt.decoratorRight.length:0,St=gt.text.length+mt+vt;St>ut&&(rt=pt,ut=St)}),nt.textContent=this.options[rt].text+(this.options[rt].decoratorRight?this.options[rt].decoratorRight+" ":""),ot=getTotalWidth(nt)}return ot}createSelectList(nt){if(this.selectList)return;this.selectDropDownListContainer=append$1(nt,$$c(".select-box-dropdown-list-container")),this.listRenderer=new SelectListRenderer,this.selectList=new List("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:ut=>{let gt=ut.text;return ut.detail&&(gt+=`. ${ut.detail}`),ut.decoratorRight&&(gt+=`. ${ut.decoratorRight}`),ut.description&&(gt+=`. ${ut.description}`),gt},getWidgetAriaLabel:()=>localize({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>"option",getWidgetRole:()=>"listbox"}}),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);const ot=this._register(new DomEmitter(this.selectDropDownListContainer,"keydown")),rt=Event.chain(ot.event).filter(()=>this.selectList.length>0).map(ut=>new StandardKeyboardEvent(ut));this._register(rt.filter(ut=>ut.keyCode===3).on(ut=>this.onEnter(ut),this)),this._register(rt.filter(ut=>ut.keyCode===2).on(ut=>this.onEnter(ut),this)),this._register(rt.filter(ut=>ut.keyCode===9).on(ut=>this.onEscape(ut),this)),this._register(rt.filter(ut=>ut.keyCode===16).on(ut=>this.onUpArrow(ut),this)),this._register(rt.filter(ut=>ut.keyCode===18).on(ut=>this.onDownArrow(ut),this)),this._register(rt.filter(ut=>ut.keyCode===12).on(this.onPageDown,this)),this._register(rt.filter(ut=>ut.keyCode===11).on(this.onPageUp,this)),this._register(rt.filter(ut=>ut.keyCode===14).on(this.onHome,this)),this._register(rt.filter(ut=>ut.keyCode===13).on(this.onEnd,this)),this._register(rt.filter(ut=>ut.keyCode>=21&&ut.keyCode<=56||ut.keyCode>=85&&ut.keyCode<=113).on(this.onCharacter,this)),this._register(addDisposableListener(this.selectList.getHTMLElement(),EventType$1.POINTER_UP,ut=>this.onPointerUp(ut))),this._register(this.selectList.onMouseOver(ut=>typeof ut.index<"u"&&this.selectList.setFocus([ut.index]))),this._register(this.selectList.onDidChangeFocus(ut=>this.onListFocus(ut))),this._register(addDisposableListener(this.selectDropDownContainer,EventType$1.FOCUS_OUT,ut=>{!this._isVisible||isAncestor$1(ut.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(nt){if(!this.selectList.length)return;EventHelper.stop(nt);const ot=nt.target;if(!ot||ot.classList.contains("slider"))return;const rt=ot.closest(".monaco-list-row");if(!rt)return;const ut=Number(rt.getAttribute("data-index")),gt=rt.classList.contains("option-disabled");ut>=0&&ut<this.options.length&&!gt&&(this.selected=ut,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(nt,ot){const rt=gt=>{for(let pt=0;pt<gt.childNodes.length;pt++){const mt=gt.childNodes.item(pt);(mt.tagName&&mt.tagName.toLowerCase())==="img"?gt.removeChild(mt):rt(mt)}},ut=renderMarkdown({value:nt,supportThemeIcons:!0},{actionHandler:ot});return ut.element.classList.add("select-box-description-markdown"),rt(ut.element),ut.element}onListFocus(nt){!this._isVisible||!this._hasDetails||this.updateDetail(nt.indexes[0])}updateDetail(nt){var ot,rt;this.selectionDetailsPane.innerText="";const ut=this.options[nt],gt=(ot=ut==null?void 0:ut.description)!==null&&ot!==void 0?ot:"",pt=(rt=ut==null?void 0:ut.descriptionIsMarkdown)!==null&&rt!==void 0?rt:!1;if(gt){if(pt){const mt=ut.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(gt,mt))}else this.selectionDetailsPane.innerText=gt;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(nt){EventHelper.stop(nt),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(nt){EventHelper.stop(nt),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(nt){if(this.selected<this.options.length-1){EventHelper.stop(nt,!0);const ot=this.options[this.selected+1].isDisabled;if(ot&&this.options.length>this.selected+2)this.selected+=2;else{if(ot)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(nt){this.selected>0&&(EventHelper.stop(nt,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(nt){EventHelper.stop(nt),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(nt){EventHelper.stop(nt),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(nt){EventHelper.stop(nt),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(nt){EventHelper.stop(nt),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(nt){const ot=KeyCodeUtils.toString(nt.keyCode);let rt=-1;for(let ut=0;ut<this.options.length-1;ut++)if(rt=(ut+this.selected+1)%this.options.length,this.options[rt].text.charAt(0).toUpperCase()===ot&&!this.options[rt].isDisabled){this.select(rt),this.selectList.setFocus([rt]),this.selectList.reveal(this.selectList.getFocus()[0]),EventHelper.stop(nt);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}}SelectBoxList.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;SelectBoxList.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;SelectBoxList.DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;class SelectBoxNative extends Disposable{constructor(nt,ot,rt,ut){super(),this.selected=0,this.selectBoxOptions=ut||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new Emitter$2),this.styles=rt,this.registerListeners(),this.setOptions(nt,ot)}registerListeners(){this._register(Gesture.addTarget(this.selectElement)),[EventType.Tap].forEach(nt=>{this._register(addDisposableListener(this.selectElement,nt,ot=>{this.selectElement.focus()}))}),this._register(addStandardDisposableListener(this.selectElement,"click",nt=>{EventHelper.stop(nt,!0)})),this._register(addStandardDisposableListener(this.selectElement,"change",nt=>{this.selectElement.title=nt.target.value,this._onDidSelect.fire({index:nt.target.selectedIndex,selected:nt.target.value})})),this._register(addStandardDisposableListener(this.selectElement,"keydown",nt=>{let ot=!1;isMacintosh?(nt.keyCode===18||nt.keyCode===16||nt.keyCode===10)&&(ot=!0):(nt.keyCode===18&&nt.altKey||nt.keyCode===10||nt.keyCode===3)&&(ot=!0),ot&&nt.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(nt,ot){(!this.options||!equals$2(this.options,nt))&&(this.options=nt,this.selectElement.options.length=0,this.options.forEach((rt,ut)=>{this.selectElement.add(this.createOption(rt.text,ut,rt.isDisabled))})),ot!==void 0&&this.select(ot)}select(nt){this.options.length===0?this.selected=0:nt>=0&&nt<this.options.length?this.selected=nt:nt>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(nt){this.selectElement.tabIndex=nt?0:-1}render(nt){nt.classList.add("select-container"),nt.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}applyStyles(){var nt,ot,rt;this.selectElement&&(this.selectElement.style.backgroundColor=(nt=this.styles.selectBackground)!==null&&nt!==void 0?nt:"",this.selectElement.style.color=(ot=this.styles.selectForeground)!==null&&ot!==void 0?ot:"",this.selectElement.style.borderColor=(rt=this.styles.selectBorder)!==null&&rt!==void 0?rt:"")}createOption(nt,ot,rt){const ut=document.createElement("option");return ut.value=nt,ut.text=nt,ut.disabled=!!rt,ut}}const selectBox="";class SelectBox extends Widget$1{constructor(nt,ot,rt,ut,gt){super(),isMacintosh&&!(gt!=null&&gt.useCustomDrawn)?this.selectBoxDelegate=new SelectBoxNative(nt,ot,ut,gt):this.selectBoxDelegate=new SelectBoxList(nt,ot,rt,ut,gt),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(nt,ot){this.selectBoxDelegate.setOptions(nt,ot)}select(nt){this.selectBoxDelegate.select(nt)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(nt){this.selectBoxDelegate.setFocusable(nt)}render(nt){this.selectBoxDelegate.render(nt)}}const actionbar="";class BaseActionViewItem extends Disposable{get action(){return this._action}constructor(nt,ot,rt={}){super(),this.options=rt,this._context=nt||this,this._action=ot,ot instanceof Action&&this._register(ot.onDidChange(ut=>{this.element&&this.handleActionChangeEvent(ut)}))}handleActionChangeEvent(nt){nt.enabled!==void 0&&this.updateEnabled(),nt.checked!==void 0&&this.updateChecked(),nt.class!==void 0&&this.updateClass(),nt.label!==void 0&&(this.updateLabel(),this.updateTooltip()),nt.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new ActionRunner)),this._actionRunner}set actionRunner(nt){this._actionRunner=nt}isEnabled(){return this._action.enabled}setActionContext(nt){this._context=nt}render(nt){const ot=this.element=nt;this._register(Gesture.addTarget(nt));const rt=this.options&&this.options.draggable;rt&&(nt.draggable=!0,isFirefox&&this._register(addDisposableListener(nt,EventType$1.DRAG_START,ut=>{var gt;return(gt=ut.dataTransfer)===null||gt===void 0?void 0:gt.setData(DataTransfers.TEXT,this._action.label)}))),this._register(addDisposableListener(ot,EventType.Tap,ut=>this.onClick(ut,!0))),this._register(addDisposableListener(ot,EventType$1.MOUSE_DOWN,ut=>{rt||EventHelper.stop(ut,!0),this._action.enabled&&ut.button===0&&ot.classList.add("active")})),isMacintosh&&this._register(addDisposableListener(ot,EventType$1.CONTEXT_MENU,ut=>{ut.button===0&&ut.ctrlKey===!0&&this.onClick(ut)})),this._register(addDisposableListener(ot,EventType$1.CLICK,ut=>{EventHelper.stop(ut,!0),this.options&&this.options.isMenu||this.onClick(ut)})),this._register(addDisposableListener(ot,EventType$1.DBLCLICK,ut=>{EventHelper.stop(ut,!0)})),[EventType$1.MOUSE_UP,EventType$1.MOUSE_OUT].forEach(ut=>{this._register(addDisposableListener(ot,ut,gt=>{EventHelper.stop(gt),ot.classList.remove("active")}))})}onClick(nt,ot=!1){var rt;EventHelper.stop(nt,!0);const ut=isUndefinedOrNull(this._context)?!((rt=this.options)===null||rt===void 0)&&rt.useEventAsContext?nt:{preserveFocus:ot}:this._context;this.actionRunner.run(this._action,ut)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(nt){this.element&&(this.element.tabIndex=nt?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getTooltip(){return this.action.tooltip}updateTooltip(){var nt;if(!this.element)return;const ot=(nt=this.getTooltip())!==null&&nt!==void 0?nt:"";this.updateAriaLabel(),this.options.hoverDelegate?(this.element.title="",this.customHover?this.customHover.update(ot):(this.customHover=setupCustomHover(this.options.hoverDelegate,this.element,ot),this._store.add(this.customHover))):this.element.title=ot}updateAriaLabel(){var nt;if(this.element){const ot=(nt=this.getTooltip())!==null&&nt!==void 0?nt:"";this.element.setAttribute("aria-label",ot)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}}class ActionViewItem extends BaseActionViewItem{constructor(nt,ot,rt){super(nt,ot,rt),this.options=rt,this.options.icon=rt.icon!==void 0?rt.icon:!1,this.options.label=rt.label!==void 0?rt.label:!0,this.cssClass=""}render(nt){super.render(nt),this.element&&(this.label=append$1(this.element,$$d("a.action-label"))),this.label&&(this._action.id===Separator.ID?this.label.setAttribute("role","presentation"):this.options.isMenu?this.label.setAttribute("role","menuitem"):this.label.setAttribute("role","button")),this.options.label&&this.options.keybinding&&this.element&&(append$1(this.element,$$d("span.keybinding")).textContent=this.options.keybinding),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(nt){this.label&&(this.label.tabIndex=nt?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let nt=null;return this.action.tooltip?nt=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(nt=this.action.label,this.options.keybinding&&(nt=localize({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",nt,this.options.keybinding))),nt??void 0}updateClass(){var nt;this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.action.class,this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):(nt=this.label)===null||nt===void 0||nt.classList.remove("codicon")}updateEnabled(){var nt,ot;this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),(nt=this.element)===null||nt===void 0||nt.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),(ot=this.element)===null||ot===void 0||ot.classList.add("disabled"))}updateAriaLabel(){var nt;if(this.label){const ot=(nt=this.getTooltip())!==null&&nt!==void 0?nt:"";this.label.setAttribute("aria-label",ot)}}updateChecked(){this.label&&(this.action.checked?this.label.classList.add("checked"):this.label.classList.remove("checked"))}}class SelectActionViewItem extends BaseActionViewItem{constructor(nt,ot,rt,ut,gt,pt,mt){super(nt,ot),this.selectBox=new SelectBox(rt,ut,gt,pt,mt),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}select(nt){this.selectBox.select(nt)}registerListeners(){this._register(this.selectBox.onDidSelect(nt=>this.runAction(nt.selected,nt.index)))}runAction(nt,ot){this.actionRunner.run(this._action,this.getActionContext(nt,ot))}getActionContext(nt,ot){return nt}setFocusable(nt){this.selectBox.setFocusable(nt)}focus(){var nt;(nt=this.selectBox)===null||nt===void 0||nt.focus()}blur(){var nt;(nt=this.selectBox)===null||nt===void 0||nt.blur()}render(nt){this.selectBox.render(nt)}}var __awaiter$1l=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class ActionBar extends Disposable{constructor(nt,ot={}){var rt,ut,gt,pt,mt,vt;super(),this._actionRunnerDisposables=this._register(new DisposableStore),this.viewItemDisposables=this._register(new DisposableMap),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new Emitter$2),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new Emitter$2({onWillAddFirstListener:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new Emitter$2),this.onDidRun=this._onDidRun.event,this._onWillRun=this._register(new Emitter$2),this.onWillRun=this._onWillRun.event,this.options=ot,this._context=(rt=ot.context)!==null&&rt!==void 0?rt:null,this._orientation=(ut=this.options.orientation)!==null&&ut!==void 0?ut:0,this._triggerKeys={keyDown:(pt=(gt=this.options.triggerKeys)===null||gt===void 0?void 0:gt.keyDown)!==null&&pt!==void 0?pt:!1,keys:(vt=(mt=this.options.triggerKeys)===null||mt===void 0?void 0:mt.keys)!==null&&vt!==void 0?vt:[3,10]},this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new ActionRunner,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(wt=>this._onDidRun.fire(wt))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(wt=>this._onWillRun.fire(wt))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar",ot.animated!==!1&&this.domNode.classList.add("animated");let St,yt;switch(this._orientation){case 0:St=[15],yt=[17];break;case 1:St=[16],yt=[18],this.domNode.className+=" vertical";break}this._register(addDisposableListener(this.domNode,EventType$1.KEY_DOWN,wt=>{const Lt=new StandardKeyboardEvent(wt);let xt=!0;const It=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;St&&(Lt.equals(St[0])||Lt.equals(St[1]))?xt=this.focusPrevious():yt&&(Lt.equals(yt[0])||Lt.equals(yt[1]))?xt=this.focusNext():Lt.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():Lt.equals(14)?xt=this.focusFirst():Lt.equals(13)?xt=this.focusLast():Lt.equals(2)&&It instanceof BaseActionViewItem&&It.trapsArrowNavigation?xt=this.focusNext():this.isTriggerKeyEvent(Lt)?this._triggerKeys.keyDown?this.doTrigger(Lt):this.triggerKeyDown=!0:xt=!1,xt&&(Lt.preventDefault(),Lt.stopPropagation())})),this._register(addDisposableListener(this.domNode,EventType$1.KEY_UP,wt=>{const Lt=new StandardKeyboardEvent(wt);this.isTriggerKeyEvent(Lt)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(Lt)),Lt.preventDefault(),Lt.stopPropagation()):(Lt.equals(2)||Lt.equals(1026))&&this.updateFocusedItem()})),this.focusTracker=this._register(trackFocus(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(getActiveElement()===this.domNode||!isAncestor$1(getActiveElement(),this.domNode))&&(this._onDidBlur.fire(),this.focusedItem=void 0,this.previouslyFocusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),nt.appendChild(this.domNode)}refreshRole(){this.length()>=2?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(nt){if(this.focusable=nt,this.focusable){const ot=this.viewItems.find(rt=>rt instanceof BaseActionViewItem&&rt.isEnabled());ot instanceof BaseActionViewItem&&ot.setFocusable(!0)}else this.viewItems.forEach(ot=>{ot instanceof BaseActionViewItem&&ot.setFocusable(!1)})}isTriggerKeyEvent(nt){let ot=!1;return this._triggerKeys.keys.forEach(rt=>{ot=ot||nt.equals(rt)}),ot}updateFocusedItem(){for(let nt=0;nt<this.actionsList.children.length;nt++){const ot=this.actionsList.children[nt];if(isAncestor$1(getActiveElement(),ot)){this.focusedItem=nt;break}}}get context(){return this._context}set context(nt){this._context=nt,this.viewItems.forEach(ot=>ot.setActionContext(nt))}get actionRunner(){return this._actionRunner}set actionRunner(nt){this._actionRunner=nt,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(ot=>this._onDidRun.fire(ot))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(ot=>this._onWillRun.fire(ot))),this.viewItems.forEach(ot=>ot.actionRunner=nt)}getContainer(){return this.domNode}getAction(nt){var ot;if(typeof nt=="number")return(ot=this.viewItems[nt])===null||ot===void 0?void 0:ot.action;if(nt instanceof HTMLElement){for(;nt.parentElement!==this.actionsList;){if(!nt.parentElement)return;nt=nt.parentElement}for(let rt=0;rt<this.actionsList.childNodes.length;rt++)if(this.actionsList.childNodes[rt]===nt)return this.viewItems[rt].action}}push(nt,ot={}){const rt=Array.isArray(nt)?nt:[nt];let ut=isNumber$1(ot.index)?ot.index:null;rt.forEach(gt=>{const pt=document.createElement("li");pt.className="action-item",pt.setAttribute("role","presentation");let mt;const vt=Object.assign({hoverDelegate:this.options.hoverDelegate},ot);this.options.actionViewItemProvider&&(mt=this.options.actionViewItemProvider(gt,vt)),mt||(mt=new ActionViewItem(this.context,gt,vt)),this.options.allowContextMenu||this.viewItemDisposables.set(mt,addDisposableListener(pt,EventType$1.CONTEXT_MENU,St=>{EventHelper.stop(St,!0)})),mt.actionRunner=this._actionRunner,mt.setActionContext(this.context),mt.render(pt),this.focusable&&mt instanceof BaseActionViewItem&&this.viewItems.length===0&&mt.setFocusable(!0),ut===null||ut<0||ut>=this.actionsList.children.length?(this.actionsList.appendChild(pt),this.viewItems.push(mt)):(this.actionsList.insertBefore(pt,this.actionsList.children[ut]),this.viewItems.splice(ut,0,mt),ut++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}clear(){this.isEmpty()||(this.viewItems=dispose(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),clearNode(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(nt){let ot=!1,rt;if(nt===void 0?ot=!0:typeof nt=="number"?rt=nt:typeof nt=="boolean"&&(ot=nt),ot&&typeof this.focusedItem>"u"){const ut=this.viewItems.findIndex(gt=>gt.isEnabled());this.focusedItem=ut===-1?void 0:ut,this.updateFocus(void 0,void 0,!0)}else rt!==void 0&&(this.focusedItem=rt),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(nt){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const ot=this.focusedItem;let rt;do{if(!nt&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=ot,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,rt=this.viewItems[this.focusedItem]}while(this.focusedItem!==ot&&(this.options.focusOnlyEnabledItems&&!rt.isEnabled()||rt.action.id===Separator.ID));return this.updateFocus(),!0}focusPrevious(nt){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const ot=this.focusedItem;let rt;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!nt&&this.options.preventLoopNavigation)return this.focusedItem=ot,!1;this.focusedItem=this.viewItems.length-1}rt=this.viewItems[this.focusedItem]}while(this.focusedItem!==ot&&(this.options.focusOnlyEnabledItems&&!rt.isEnabled()||rt.action.id===Separator.ID));return this.updateFocus(!0),!0}updateFocus(nt,ot,rt=!1){var ut;typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:ot}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&((ut=this.viewItems[this.previouslyFocusedItem])===null||ut===void 0||ut.blur());const gt=this.focusedItem!==void 0&&this.viewItems[this.focusedItem];if(gt){let pt=!0;isFunction(gt.focus)||(pt=!1),this.options.focusOnlyEnabledItems&&isFunction(gt.isEnabled)&&!gt.isEnabled()&&(pt=!1),gt.action.id===Separator.ID&&(pt=!1),pt?(rt||this.previouslyFocusedItem!==this.focusedItem)&&(gt.focus(nt),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:ot}),this.previouslyFocusedItem=void 0)}}doTrigger(nt){if(typeof this.focusedItem>"u")return;const ot=this.viewItems[this.focusedItem];if(ot instanceof BaseActionViewItem){const rt=ot._context===null||ot._context===void 0?nt:ot._context;this.run(ot._action,rt)}}run(nt,ot){return __awaiter$1l(this,void 0,void 0,function*(){yield this._actionRunner.run(nt,ot)})}dispose(){this._context=void 0,this.viewItems=dispose(this.viewItems),this.getContainer().remove(),super.dispose()}}const Extensions$2={IconContribution:"base.contributions.icons"};var IconContribution;(function(ct){function nt(ot,rt){let ut=ot.defaults;for(;ThemeIcon.isThemeIcon(ut);){const gt=iconRegistry.getIcon(ut.id);if(!gt)return;ut=gt.defaults}return ut}ct.getDefinition=nt})(IconContribution||(IconContribution={}));var IconFontDefinition;(function(ct){function nt(rt){return{weight:rt.weight,style:rt.style,src:rt.src.map(ut=>({format:ut.format,location:ut.location.toString()}))}}ct.toJSONObject=nt;function ot(rt){const ut=gt=>isString$1(gt)?gt:void 0;if(rt&&Array.isArray(rt.src)&&rt.src.every(gt=>isString$1(gt.format)&&isString$1(gt.location)))return{weight:ut(rt.weight),style:ut(rt.style),src:rt.src.map(gt=>({format:gt.format,location:URI.parse(gt.location)}))}}ct.fromJSONObject=ot})(IconFontDefinition||(IconFontDefinition={}));class IconRegistry{constructor(){this._onDidChange=new Emitter$2,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:localize("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:localize("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${ThemeIcon.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(nt,ot,rt,ut){const gt=this.iconsById[nt];if(gt){if(rt&&!gt.description){gt.description=rt,this.iconSchema.properties[nt].markdownDescription=`${rt} $(${nt})`;const vt=this.iconReferenceSchema.enum.indexOf(nt);vt!==-1&&(this.iconReferenceSchema.enumDescriptions[vt]=rt),this._onDidChange.fire()}return gt}const pt={id:nt,description:rt,defaults:ot,deprecationMessage:ut};this.iconsById[nt]=pt;const mt={$ref:"#/definitions/icons"};return ut&&(mt.deprecationMessage=ut),rt&&(mt.markdownDescription=`${rt}: $(${nt})`),this.iconSchema.properties[nt]=mt,this.iconReferenceSchema.enum.push(nt),this.iconReferenceSchema.enumDescriptions.push(rt||""),this._onDidChange.fire(),{id:nt}}getIcons(){return Object.keys(this.iconsById).map(nt=>this.iconsById[nt])}getIcon(nt){return this.iconsById[nt]}getIconSchema(){return this.iconSchema}toString(){const nt=(gt,pt)=>gt.id.localeCompare(pt.id),ot=gt=>{for(;ThemeIcon.isThemeIcon(gt.defaults);)gt=this.iconsById[gt.defaults.id];return`codicon codicon-${gt?gt.id:""}`},rt=[];rt.push("| preview     | identifier                        | default codicon ID                | description"),rt.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const ut=Object.keys(this.iconsById).map(gt=>this.iconsById[gt]);for(const gt of ut.filter(pt=>!!pt.description).sort(nt))rt.push(`|<i class="${ot(gt)}"></i>|${gt.id}|${ThemeIcon.isThemeIcon(gt.defaults)?gt.defaults.id:gt.id}|${gt.description||""}|`);rt.push("| preview     | identifier                        "),rt.push("| ----------- | --------------------------------- |");for(const gt of ut.filter(pt=>!ThemeIcon.isThemeIcon(pt.defaults)).sort(nt))rt.push(`|<i class="${ot(gt)}"></i>|${gt.id}|`);return rt.join(`
`)}}const iconRegistry=new IconRegistry;Registry.add(Extensions$2.IconContribution,iconRegistry);function registerIcon(ct,nt,ot,rt){return iconRegistry.registerIcon(ct,nt,ot,rt)}function getIconRegistry(){return iconRegistry}function initialize(){const ct=getCodiconFontCharacters();for(const nt in ct){const ot="\\"+ct[nt].toString(16);iconRegistry.registerIcon(nt,{fontCharacter:ot})}}initialize();const iconsSchemaId="vscode://schemas/icons",schemaRegistry=Registry.as(Extensions$9.JSONContribution);schemaRegistry.registerSchema(iconsSchemaId,iconRegistry.getIconSchema());const delayer=new RunOnceScheduler(()=>schemaRegistry.notifySchemaChanged(iconsSchemaId),200);iconRegistry.onDidChange(()=>{delayer.isScheduled()||delayer.schedule()});const widgetClose=registerIcon("widget-close",Codicon.close,localize("widgetClose","Icon for the close action in widgets."));registerIcon("goto-previous-location",Codicon.arrowUp,localize("previousChangeIcon","Icon for goto previous editor location."));registerIcon("goto-next-location",Codicon.arrowDown,localize("nextChangeIcon","Icon for goto next editor location."));ThemeIcon.modify(Codicon.sync,"spin");ThemeIcon.modify(Codicon.loading,"spin");var __decorate$1U=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1R=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$1k=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},_a$6;const DIFF_LINES_PADDING=3;class DiffEntry{constructor(nt,ot,rt,ut){this.originalLineStart=nt,this.originalLineEnd=ot,this.modifiedLineStart=rt,this.modifiedLineEnd=ut}getType(){return this.originalLineStart===0?1:this.modifiedLineStart===0?2:0}}class Diff{constructor(nt){this.entries=nt}}const diffReviewInsertIcon=registerIcon("diff-review-insert",Codicon.add,localize("diffReviewInsertIcon","Icon for 'Insert' in diff review.")),diffReviewRemoveIcon=registerIcon("diff-review-remove",Codicon.remove,localize("diffReviewRemoveIcon","Icon for 'Remove' in diff review.")),diffReviewCloseIcon=registerIcon("diff-review-close",Codicon.close,localize("diffReviewCloseIcon","Icon for 'Close' in diff review."));let DiffReview=class fo extends Disposable{constructor(nt,ot,rt,ut){super(),this._languageService=ot,this._audioCueService=rt,this._configurationService=ut,this._width=0,this._diffEditor=nt,this._isVisible=!1,this.shadow=createFastDomNode(document.createElement("div")),this.shadow.setClassName("diff-review-shadow"),this.actionBarContainer=createFastDomNode(document.createElement("div")),this.actionBarContainer.setClassName("diff-review-actions"),this._actionBar=this._register(new ActionBar(this.actionBarContainer.domNode)),this._actionBar.push(new Action("diffreview.close",localize("label.close","Close"),"close-diff-review "+ThemeIcon.asClassName(diffReviewCloseIcon),!0,()=>__awaiter$1k(this,void 0,void 0,function*(){return this.hide()})),{label:!1,icon:!0}),this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setClassName("diff-review monaco-editor-background"),this._content=createFastDomNode(document.createElement("div")),this._content.setClassName("diff-review-content"),this._content.setAttribute("role","code"),this.scrollbar=this._register(new DomScrollableElement(this._content.domNode,{})),this.domNode.domNode.appendChild(this.scrollbar.getDomNode()),this._register(nt.onDidUpdateDiff(()=>{this._isVisible&&(this._diffs=this._compute(),this._render())})),this._register(nt.getModifiedEditor().onDidChangeCursorPosition(()=>{this._isVisible&&this._render()})),this._register(addStandardDisposableListener(this.domNode.domNode,"click",gt=>{gt.preventDefault();const pt=findParentWithClass(gt.target,"diff-review-row");pt&&this._goToRow(pt)})),this._register(addStandardDisposableListener(this.domNode.domNode,"keydown",gt=>{(gt.equals(18)||gt.equals(2066)||gt.equals(530))&&(gt.preventDefault(),this._goToRow(this._getNextRow(),"next")),(gt.equals(16)||gt.equals(2064)||gt.equals(528))&&(gt.preventDefault(),this._goToRow(this._getPrevRow(),"previous")),(gt.equals(9)||gt.equals(2057)||gt.equals(521)||gt.equals(1033)||gt.equals(10)||gt.equals(3))&&(gt.preventDefault(),this.accept())})),this._register(this._configurationService.onDidChangeConfiguration(gt=>{gt.affectsConfiguration("accessibility.verbosity.diff-editor")&&this._diffEditor.updateOptions({accessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.diff-editor")})})),this._diffs=[],this._currentDiff=null}prev(){let nt=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let rt=-1;for(let ut=0,gt=this._diffs.length;ut<gt;ut++)if(this._diffs[ut]===this._currentDiff){rt=ut;break}nt=this._diffs.length+rt-1}else nt=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs.length===0)return;nt=nt%this._diffs.length;const ot=this._diffs[nt].entries;this._diffEditor.setPosition(new Position$1(ot[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:ot[0].modifiedLineStart,endColumn:1073741824,endLineNumber:ot[ot.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getPrevRow(),"previous")}next(){let nt=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let rt=-1;for(let ut=0,gt=this._diffs.length;ut<gt;ut++)if(this._diffs[ut]===this._currentDiff){rt=ut;break}nt=rt+1}else nt=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs.length===0)return;nt=nt%this._diffs.length;const ot=this._diffs[nt].entries;this._diffEditor.setPosition(new Position$1(ot[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:ot[0].modifiedLineStart,endColumn:1073741824,endLineNumber:ot[ot.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow(),"next")}accept(){let nt=-1;const ot=this._getCurrentFocusedRow();if(ot){const rt=parseInt(ot.getAttribute("data-line"),10);isNaN(rt)||(nt=rt)}this.hide(),nt!==-1&&(this._diffEditor.setPosition(new Position$1(nt,1)),this._diffEditor.revealPosition(new Position$1(nt,1),1))}hide(){this._isVisible=!1,this._diffEditor.updateOptions({readOnly:!1}),this._diffEditor.focus(),this._diffEditor.doLayout(),this._render()}_getPrevRow(){const nt=this._getCurrentFocusedRow();return nt?nt.previousElementSibling?nt.previousElementSibling:nt:this._getFirstRow()}_getNextRow(){const nt=this._getCurrentFocusedRow();return nt?nt.nextElementSibling?nt.nextElementSibling:nt:this._getFirstRow()}_getFirstRow(){return this.domNode.domNode.querySelector(".diff-review-row")}_getCurrentFocusedRow(){const nt=document.activeElement;return nt&&/diff-review-row/.test(nt.className)?nt:null}_goToRow(nt,ot){const rt=this._getCurrentFocusedRow();nt.tabIndex=0,nt.focus(),rt&&rt!==nt&&(rt.tabIndex=-1);const ut=ot?ot==="next"?rt==null?void 0:rt.nextElementSibling:rt==null?void 0:rt.previousElementSibling:rt;ut!=null&&ut.classList.contains("line-insert")?this._audioCueService.playAudioCue(AudioCue.diffLineInserted,!0):ut!=null&&ut.classList.contains("line-delete")&&this._audioCueService.playAudioCue(AudioCue.diffLineDeleted,!0),this.scrollbar.scanDomNode()}isVisible(){return this._isVisible}layout(nt,ot,rt){this._width=ot,this.shadow.setTop(nt-6),this.shadow.setWidth(ot),this.shadow.setHeight(this._isVisible?6:0),this.domNode.setTop(nt),this.domNode.setWidth(ot),this.domNode.setHeight(rt),this._content.setHeight(rt),this._content.setWidth(ot),this._isVisible?(this.actionBarContainer.setAttribute("aria-hidden","false"),this.actionBarContainer.setDisplay("block")):(this.actionBarContainer.setAttribute("aria-hidden","true"),this.actionBarContainer.setDisplay("none"))}_compute(){const nt=this._diffEditor.getLineChanges();if(!nt||nt.length===0)return[];const ot=this._diffEditor.getOriginalEditor().getModel(),rt=this._diffEditor.getModifiedEditor().getModel();return!ot||!rt?[]:fo._mergeAdjacent(nt,ot.getLineCount(),rt.getLineCount())}static _mergeAdjacent(nt,ot,rt){if(!nt||nt.length===0)return[];const ut=[];let gt=0;for(let St=0,yt=nt.length;St<yt;St++){const wt=nt[St],Lt=wt.originalStartLineNumber,xt=wt.originalEndLineNumber,It=wt.modifiedStartLineNumber,kt=wt.modifiedEndLineNumber,At=[];let Tt=0;{const Rt=xt===0?Lt:Lt-1,Nt=kt===0?It:It-1;let Pt=1,Ft=1;if(St>0){const Ut=nt[St-1];Ut.originalEndLineNumber===0?Pt=Ut.originalStartLineNumber+1:Pt=Ut.originalEndLineNumber+1,Ut.modifiedEndLineNumber===0?Ft=Ut.modifiedStartLineNumber+1:Ft=Ut.modifiedEndLineNumber+1}let Kt=Rt-DIFF_LINES_PADDING+1,Bt=Nt-DIFF_LINES_PADDING+1;if(Kt<Pt){const Ut=Pt-Kt;Kt=Kt+Ut,Bt=Bt+Ut}if(Bt<Ft){const Ut=Ft-Bt;Kt=Kt+Ut,Bt=Bt+Ut}At[Tt++]=new DiffEntry(Kt,Rt,Bt,Nt)}xt!==0&&(At[Tt++]=new DiffEntry(Lt,xt,0,0)),kt!==0&&(At[Tt++]=new DiffEntry(0,0,It,kt));{const Rt=xt===0?Lt+1:xt+1,Nt=kt===0?It+1:kt+1;let Pt=ot,Ft=rt;if(St+1<yt){const Ut=nt[St+1];Ut.originalEndLineNumber===0?Pt=Ut.originalStartLineNumber:Pt=Ut.originalStartLineNumber-1,Ut.modifiedEndLineNumber===0?Ft=Ut.modifiedStartLineNumber:Ft=Ut.modifiedStartLineNumber-1}let Kt=Rt+DIFF_LINES_PADDING-1,Bt=Nt+DIFF_LINES_PADDING-1;if(Kt>Pt){const Ut=Pt-Kt;Kt=Kt+Ut,Bt=Bt+Ut}if(Bt>Ft){const Ut=Ft-Bt;Kt=Kt+Ut,Bt=Bt+Ut}At[Tt++]=new DiffEntry(Rt,Kt,Nt,Bt)}ut[gt++]=new Diff(At)}let pt=ut[0].entries;const mt=[];let vt=0;for(let St=1,yt=ut.length;St<yt;St++){const wt=ut[St].entries,Lt=pt[pt.length-1],xt=wt[0];if(Lt.getType()===0&&xt.getType()===0&&xt.originalLineStart<=Lt.originalLineEnd){pt[pt.length-1]=new DiffEntry(Lt.originalLineStart,xt.originalLineEnd,Lt.modifiedLineStart,xt.modifiedLineEnd),pt=pt.concat(wt.slice(1));continue}mt[vt++]=new Diff(pt),pt=wt}return mt[vt++]=new Diff(pt),mt}_findDiffIndex(nt){const ot=nt.lineNumber;for(let rt=0,ut=this._diffs.length;rt<ut;rt++){const gt=this._diffs[rt].entries,pt=gt[gt.length-1].modifiedLineEnd;if(ot<=pt)return rt}return 0}_render(){const nt=this._diffEditor.getOriginalEditor().getOptions(),ot=this._diffEditor.getModifiedEditor().getOptions(),rt=this._diffEditor.getOriginalEditor().getModel(),ut=this._diffEditor.getModifiedEditor().getModel(),gt=rt.getOptions(),pt=ut.getOptions();if(!this._isVisible||!rt||!ut){clearNode(this._content.domNode),this._currentDiff=null,this.scrollbar.scanDomNode();return}this._diffEditor.updateOptions({readOnly:!0});const mt=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs[mt]===this._currentDiff)return;this._currentDiff=this._diffs[mt];const vt=this._diffs[mt].entries,St=document.createElement("div");St.className="diff-review-table",St.setAttribute("role","list"),St.setAttribute("aria-label",'Difference review. Use "Stage | Unstage | Revert Selected Ranges" commands'),applyFontInfo(St,ot.get(48));let yt=0,wt=0,Lt=0,xt=0;for(let Bt=0,Ut=vt.length;Bt<Ut;Bt++){const qt=vt[Bt],Yt=qt.originalLineStart,Zt=qt.originalLineEnd,Xt=qt.modifiedLineStart,_i=qt.modifiedLineEnd;Yt!==0&&(yt===0||Yt<yt)&&(yt=Yt),Zt!==0&&(wt===0||Zt>wt)&&(wt=Zt),Xt!==0&&(Lt===0||Xt<Lt)&&(Lt=Xt),_i!==0&&(xt===0||_i>xt)&&(xt=_i)}const It=document.createElement("div");It.className="diff-review-row";const kt=document.createElement("div");kt.className="diff-review-cell diff-review-summary";const At=wt-yt+1,Tt=xt-Lt+1;kt.appendChild(document.createTextNode(`${mt+1}/${this._diffs.length}: @@ -${yt},${At} +${Lt},${Tt} @@`)),It.setAttribute("data-line",String(Lt));const Rt=Bt=>Bt===0?localize("no_lines_changed","no lines changed"):Bt===1?localize("one_line_changed","1 line changed"):localize("more_lines_changed","{0} lines changed",Bt),Nt=Rt(At),Pt=Rt(Tt);It.setAttribute("aria-label",localize({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",mt+1,this._diffs.length,yt,Nt,Lt,Pt)),It.appendChild(kt),It.setAttribute("role","listitem"),St.appendChild(It);const Ft=ot.get(64);let Kt=Lt;for(let Bt=0,Ut=vt.length;Bt<Ut;Bt++){const qt=vt[Bt];fo._renderSection(St,qt,Kt,Ft,this._width,nt,rt,gt,ot,ut,pt,this._languageService.languageIdCodec),qt.modifiedLineStart!==0&&(Kt=qt.modifiedLineEnd)}clearNode(this._content.domNode),this._content.domNode.appendChild(St),this.scrollbar.scanDomNode()}static _renderSection(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt){const xt=ot.getType();let It="diff-review-row",kt="";const At="diff-review-spacer";let Tt=null;switch(xt){case 1:It="diff-review-row line-insert",kt=" char-insert",Tt=diffReviewInsertIcon;break;case 2:It="diff-review-row line-delete",kt=" char-delete",Tt=diffReviewRemoveIcon;break}const Rt=ot.originalLineStart,Nt=ot.originalLineEnd,Pt=ot.modifiedLineStart,Ft=ot.modifiedLineEnd,Kt=Math.max(Ft-Pt,Nt-Rt),Bt=pt.get(139),Ut=Bt.glyphMarginWidth+Bt.lineNumbersWidth,qt=St.get(139),Yt=10+qt.glyphMarginWidth+qt.lineNumbersWidth;for(let Zt=0;Zt<=Kt;Zt++){const Xt=Rt===0?0:Rt+Zt,_i=Pt===0?0:Pt+Zt,nn=document.createElement("div");nn.style.minWidth=gt+"px",nn.className=It,nn.setAttribute("role","listitem"),_i!==0&&(rt=_i),nn.setAttribute("data-line",String(rt));const rn=document.createElement("div");rn.className="diff-review-cell",rn.style.height=`${ut}px`,nn.appendChild(rn);const dn=document.createElement("span");dn.style.width=Ut+"px",dn.style.minWidth=Ut+"px",dn.className="diff-review-line-number"+kt,Xt!==0?dn.appendChild(document.createTextNode(String(Xt))):dn.innerText="",rn.appendChild(dn);const bn=document.createElement("span");bn.style.width=Yt+"px",bn.style.minWidth=Yt+"px",bn.style.paddingRight="10px",bn.className="diff-review-line-number"+kt,_i!==0?bn.appendChild(document.createTextNode(String(_i))):bn.innerText="",rn.appendChild(bn);const un=document.createElement("span");if(un.className=At,Tt){const _n=document.createElement("span");_n.className=ThemeIcon.asClassName(Tt),_n.innerText="",un.appendChild(_n)}else un.innerText="";rn.appendChild(un);let an;if(_i!==0){let _n=this._renderLine(yt,St,wt.tabSize,_i,Lt);fo._ttPolicy&&(_n=fo._ttPolicy.createHTML(_n)),rn.insertAdjacentHTML("beforeend",_n),an=yt.getLineContent(_i)}else{let _n=this._renderLine(mt,pt,vt.tabSize,Xt,Lt);fo._ttPolicy&&(_n=fo._ttPolicy.createHTML(_n)),rn.insertAdjacentHTML("beforeend",_n),an=mt.getLineContent(Xt)}an.length===0&&(an=localize("blankLine","blank"));let Cn="";switch(xt){case 0:Xt===_i?Cn=localize({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",an,Xt):Cn=localize("equalLine","{0} original line {1} modified line {2}",an,Xt,_i);break;case 1:Cn=localize("insertLine","+ {0} modified line {1}",an,_i);break;case 2:Cn=localize("deleteLine","- {0} original line {1}",an,Xt);break}nn.setAttribute("aria-label",Cn),nt.appendChild(nn)}}static _renderLine(nt,ot,rt,ut,gt){const pt=nt.getLineContent(ut),mt=ot.get(48),vt=LineTokens.createEmpty(pt,gt),St=ViewLineRenderingData.isBasicASCII(pt,nt.mightContainNonBasicASCII()),yt=ViewLineRenderingData.containsRTL(pt,St,nt.mightContainRTL());return renderViewLine2(new RenderLineInput(mt.isMonospace&&!ot.get(31),mt.canUseHalfwidthRightwardsArrow,pt,!1,St,yt,0,vt,[],rt,0,mt.spaceWidth,mt.middotWidth,mt.wsmiddotWidth,ot.get(112),ot.get(94),ot.get(89),ot.get(49)!==EditorFontLigatures.OFF,null)).html}};DiffReview._ttPolicy=(_a$6=window.trustedTypes)===null||_a$6===void 0?void 0:_a$6.createPolicy("diffReview",{createHTML:ct=>ct});DiffReview=__decorate$1U([__param$1R(1,ILanguageService),__param$1R(2,IAudioCueService),__param$1R(3,IConfigurationService)],DiffReview);class DiffReviewNext extends EditorAction{constructor(){super({id:"editor.action.diffReview.next",label:localize("editor.action.diffReview.next","Go to Next Difference"),alias:"Go to Next Difference",precondition:ContextKeyExpr.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:65,weight:100}})}run(nt,ot){const rt=findFocusedDiffEditor(nt);rt==null||rt.diffReviewNext()}}class DiffReviewPrev extends EditorAction{constructor(){super({id:"editor.action.diffReview.prev",label:localize("editor.action.diffReview.prev","Go to Previous Difference"),alias:"Go to Previous Difference",precondition:ContextKeyExpr.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:1089,weight:100}})}run(nt,ot){const rt=findFocusedDiffEditor(nt);rt==null||rt.diffReviewPrev()}}function findFocusedDiffEditor(ct){const nt=ct.get(ICodeEditorService),ot=nt.listDiffEditors(),rt=nt.getActiveCodeEditor();if(!rt)return null;for(let ut=0,gt=ot.length;ut<gt;ut++){const pt=ot[ut];if(pt.getModifiedEditor().getId()===rt.getId()||pt.getOriginalEditor().getId()===rt.getId())return pt}return null}registerEditorAction(DiffReviewNext);registerEditorAction(DiffReviewPrev);var __awaiter$1j=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class InlineDiffMargin extends Disposable{get visibility(){return this._visibility}set visibility(nt){this._visibility!==nt&&(this._visibility=nt,nt?this._diffActions.style.visibility="visible":this._diffActions.style.visibility="hidden")}constructor(nt,ot,rt,ut,gt,pt){super(),this._viewZoneId=nt,this._marginDomNode=ot,this.editor=rt,this.diff=ut,this._contextMenuService=gt,this._clipboardService=pt,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=ThemeIcon.asClassName(Codicon.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const mt=rt.getOption(64),vt=rt.getModel().getEOL();this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${mt}px`,this._diffActions.style.lineHeight=`${mt}px`,this._marginDomNode.appendChild(this._diffActions);const St=[],yt=ut.modifiedEndLineNumber===0;St.push(new Action("diff.clipboard.copyDeletedContent",yt?ut.originalEndLineNumber>ut.modifiedStartLineNumber?localize("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):localize("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):ut.originalEndLineNumber>ut.modifiedStartLineNumber?localize("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):localize("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,()=>__awaiter$1j(this,void 0,void 0,function*(){const kt=new Range$2(ut.originalStartLineNumber,1,ut.originalEndLineNumber+1,1),At=ut.originalModel.getValueInRange(kt);yield this._clipboardService.writeText(At)})));let wt=0,Lt;ut.originalEndLineNumber>ut.modifiedStartLineNumber&&(Lt=new Action("diff.clipboard.copyDeletedLineContent",yt?localize("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",ut.originalStartLineNumber):localize("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",ut.originalStartLineNumber),void 0,!0,()=>__awaiter$1j(this,void 0,void 0,function*(){const kt=ut.originalModel.getLineContent(ut.originalStartLineNumber+wt);if(kt===""){const At=ut.originalModel.getEndOfLineSequence();yield this._clipboardService.writeText(At===0?`
`:`\r
`)}else yield this._clipboardService.writeText(kt)})),St.push(Lt)),rt.getOption(87)||St.push(new Action("diff.inline.revertChange",localize("diff.inline.revertChange.label","Revert this change"),void 0,!0,()=>__awaiter$1j(this,void 0,void 0,function*(){const kt=new Range$2(ut.originalStartLineNumber,1,ut.originalEndLineNumber,ut.originalModel.getLineMaxColumn(ut.originalEndLineNumber)),At=ut.originalModel.getValueInRange(kt);if(ut.modifiedEndLineNumber===0){const Tt=rt.getModel().getLineMaxColumn(ut.modifiedStartLineNumber);rt.executeEdits("diffEditor",[{range:new Range$2(ut.modifiedStartLineNumber,Tt,ut.modifiedStartLineNumber,Tt),text:vt+At}])}else{const Tt=rt.getModel().getLineMaxColumn(ut.modifiedEndLineNumber);rt.executeEdits("diffEditor",[{range:new Range$2(ut.modifiedStartLineNumber,1,ut.modifiedEndLineNumber,Tt),text:At}])}})));const It=(kt,At)=>{this._contextMenuService.showContextMenu({getAnchor:()=>({x:kt,y:At}),getActions:()=>(Lt&&(Lt.label=yt?localize("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",ut.originalStartLineNumber+wt):localize("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",ut.originalStartLineNumber+wt)),St),autoSelectFirstItem:!0})};this._register(addStandardDisposableListener(this._diffActions,"mousedown",kt=>{const{top:At,height:Tt}=getDomNodePagePosition(this._diffActions),Rt=Math.floor(mt/3);kt.preventDefault(),It(kt.posx,At+Tt+Rt)})),this._register(rt.onMouseMove(kt=>{kt.target.type===8||kt.target.type===5?kt.target.detail.viewZoneId===this._viewZoneId?(this.visibility=!0,wt=this._updateLightBulbPosition(this._marginDomNode,kt.event.browserEvent.y,mt)):this.visibility=!1:this.visibility=!1})),this._register(rt.onMouseDown(kt=>{kt.event.rightButton&&(kt.target.type===8||kt.target.type===5)&&kt.target.detail.viewZoneId===this._viewZoneId&&(kt.event.preventDefault(),wt=this._updateLightBulbPosition(this._marginDomNode,kt.event.browserEvent.y,mt),It(kt.event.posx,kt.event.posy+mt))}))}_updateLightBulbPosition(nt,ot,rt){const{top:ut}=getDomNodePagePosition(nt),gt=ot-ut,pt=Math.floor(gt/rt),mt=pt*rt;if(this._diffActions.style.top=`${mt}px`,this.diff.viewLineCounts){let vt=0;for(let St=0;St<this.diff.viewLineCounts.length;St++)if(vt+=this.diff.viewLineCounts[St],pt<vt)return St}return pt}}const IEditorWorkerService=createDecorator("editorWorkerService");var __decorate$1T=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1Q=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$1i=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let WorkerBasedDocumentDiffProvider=class{constructor(nt,ot,rt){this.editorWorkerService=ot,this.telemetryService=rt,this.onDidChangeEventEmitter=new Emitter$2,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(nt)}dispose(){var nt;(nt=this.diffAlgorithmOnDidChangeSubscription)===null||nt===void 0||nt.dispose()}computeDiff(nt,ot,rt){var ut;return __awaiter$1i(this,void 0,void 0,function*(){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(nt,ot,rt);const gt=StopWatch.create(!0),pt=yield this.editorWorkerService.computeDiff(nt.uri,ot.uri,rt,this.diffAlgorithm),mt=gt.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:mt,timedOut:(ut=pt==null?void 0:pt.quitEarly)!==null&&ut!==void 0?ut:!0}),!pt)throw new Error("no diff result available");return pt})}setOptions(nt){var ot;let rt=!1;nt.diffAlgorithm&&this.diffAlgorithm!==nt.diffAlgorithm&&((ot=this.diffAlgorithmOnDidChangeSubscription)===null||ot===void 0||ot.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=nt.diffAlgorithm,typeof nt.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=nt.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),rt=!0),rt&&this.onDidChangeEventEmitter.fire()}};WorkerBasedDocumentDiffProvider=__decorate$1T([__param$1Q(1,IEditorWorkerService),__param$1Q(2,ITelemetryService)],WorkerBasedDocumentDiffProvider);const IClipboardService=createDecorator("clipboardService"),IContextViewService=createDecorator("contextViewService"),IContextMenuService=createDecorator("contextMenuService"),IProgressService=createDecorator("progressService");class Progress{constructor(nt){this.callback=nt}report(nt){this._value=nt,this.callback(this._value)}}Progress.None=Object.freeze({report(){}});const IEditorProgressService=createDecorator("editorProgressService");var __decorate$1S=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1P=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},_a$5;class VisualEditorState{constructor(nt,ot){this._contextMenuService=nt,this._clipboardService=ot,this._zones=[],this._inlineDiffMargins=[],this._zonesMap={},this._decorations=[]}getForeignViewZones(nt){return nt.filter(ot=>!this._zonesMap[String(ot.id)])}clean(nt){this._zones.length>0&&nt.changeViewZones(ot=>{for(const rt of this._zones)ot.removeZone(rt)}),this._zones=[],this._zonesMap={},nt.changeDecorations(ot=>{this._decorations=ot.deltaDecorations(this._decorations,[])})}apply(nt,ot,rt,ut){const gt=ut?StableEditorScrollState.capture(nt):null;nt.changeViewZones(pt=>{var mt;for(const vt of this._zones)pt.removeZone(vt);for(const vt of this._inlineDiffMargins)vt.dispose();this._zones=[],this._zonesMap={},this._inlineDiffMargins=[];for(let vt=0,St=rt.zones.length;vt<St;vt++){const yt=rt.zones[vt];yt.suppressMouseDown=!0;const wt=pt.addZone(yt);this._zones.push(wt),this._zonesMap[String(wt)]=!0,rt.zones[vt].diff&&yt.marginDomNode&&(yt.suppressMouseDown=!1,((mt=rt.zones[vt].diff)===null||mt===void 0?void 0:mt.originalModel.getValueLength())!==0&&this._inlineDiffMargins.push(new InlineDiffMargin(wt,yt.marginDomNode,nt,rt.zones[vt].diff,this._contextMenuService,this._clipboardService)))}}),gt==null||gt.restore(nt),nt.changeDecorations(pt=>{this._decorations=pt.deltaDecorations(this._decorations,rt.decorations)}),ot==null||ot.setZones(rt.overviewZones)}}let DIFF_EDITOR_ID=0;const diffInsertIcon=registerIcon("diff-insert",Codicon.add,localize("diffInsertIcon","Line decoration for inserts in the diff editor.")),diffRemoveIcon=registerIcon("diff-remove",Codicon.remove,localize("diffRemoveIcon","Line decoration for removals in the diff editor.")),ttPolicy$1=(_a$5=window.trustedTypes)===null||_a$5===void 0?void 0:_a$5.createPolicy("diffEditorWidget",{createHTML:ct=>ct}),ariaNavigationTip=localize("diff-aria-navigation-tip"," use Shift + F7 to navigate changes");let DiffEditorWidget=class Kn extends Disposable{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt){super(),this._editorProgressService=wt,this._onDidDispose=this._register(new Emitter$2),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModel=this._register(new Emitter$2),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidUpdateDiff=this._register(new Emitter$2),this.onDidUpdateDiff=this._onDidUpdateDiff.event,this._onDidContentSizeChange=this._register(new Emitter$2),this._lastOriginalWarning=null,this._lastModifiedWarning=null,mt.willCreateDiffEditor(),this._documentDiffProvider=this._register(pt.createInstance(WorkerBasedDocumentDiffProvider,ot)),this._register(this._documentDiffProvider.onDidChange(xt=>this._beginUpdateDecorationsSoon())),this._codeEditorService=mt,this._contextKeyService=this._register(gt.createScoped(nt)),this._instantiationService=pt.createChild(new ServiceCollection([IContextKeyService,this._contextKeyService])),this._contextKeyService.createKey("isInDiffEditor",!0),this._themeService=vt,this._notificationService=St,this._id=++DIFF_EDITOR_ID,this._state=0,this._updatingDiffProgress=null,this._domElement=nt,ot=ot||{},this._options=validateDiffEditorOptions(ot,{enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1}),typeof ot.isInEmbeddedEditor<"u"?this._contextKeyService.createKey("isInEmbeddedDiffEditor",ot.isInEmbeddedEditor):this._contextKeyService.createKey("isInEmbeddedDiffEditor",!1),this._updateDecorationsRunner=this._register(new RunOnceScheduler(()=>this._updateDecorations(),0)),this._containerDomElement=document.createElement("div"),this._containerDomElement.className=Kn._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide),this._containerDomElement.style.position="relative",this._containerDomElement.style.height="100%",this._domElement.appendChild(this._containerDomElement),this._overviewViewportDomElement=createFastDomNode(document.createElement("div")),this._overviewViewportDomElement.setClassName("diffViewport"),this._overviewViewportDomElement.setPosition("absolute"),this._overviewDomElement=document.createElement("div"),this._overviewDomElement.className="diffOverview",this._overviewDomElement.style.position="absolute",this._overviewDomElement.appendChild(this._overviewViewportDomElement.domNode),this._register(addStandardDisposableListener(this._overviewDomElement,EventType$1.POINTER_DOWN,xt=>{this._modifiedEditor.delegateVerticalScrollbarPointerDown(xt)})),this._register(addDisposableListener(this._overviewDomElement,EventType$1.MOUSE_WHEEL,xt=>{this._modifiedEditor.delegateScrollFromMouseWheelEvent(xt)},{passive:!1})),this._options.renderOverviewRuler&&this._containerDomElement.appendChild(this._overviewDomElement),this._originalDomNode=document.createElement("div"),this._originalDomNode.className="editor original",this._originalDomNode.style.position="absolute",this._originalDomNode.style.height="100%",this._containerDomElement.appendChild(this._originalDomNode),this._modifiedDomNode=document.createElement("div"),this._modifiedDomNode.className="editor modified",this._modifiedDomNode.style.position="absolute",this._modifiedDomNode.style.height="100%",this._containerDomElement.appendChild(this._modifiedDomNode),this._beginUpdateDecorationsTimeout=-1,this._currentlyChangingViewZones=!1,this._diffComputationToken=0,this._originalEditorState=new VisualEditorState(yt,ut),this._modifiedEditorState=new VisualEditorState(yt,ut),this._isVisible=!0,this._isHandlingScrollEvent=!1,this._elementSizeObserver=this._register(new ElementSizeObserver(this._containerDomElement,ot.dimension)),this._register(this._elementSizeObserver.onDidChange(()=>this._onDidContainerSizeChanged())),ot.automaticLayout&&this._elementSizeObserver.startObserving(),this._diffComputationResult=null,this._originalEditor=this._createLeftHandSideEditor(ot,rt.originalEditor||{}),this._modifiedEditor=this._createRightHandSideEditor(ot,rt.modifiedEditor||{}),this._originalOverviewRuler=null,this._modifiedOverviewRuler=null,this._reviewPane=pt.createInstance(DiffReview,this),this._containerDomElement.appendChild(this._reviewPane.domNode.domNode),this._containerDomElement.appendChild(this._reviewPane.shadow.domNode),this._containerDomElement.appendChild(this._reviewPane.actionBarContainer.domNode),this._options.renderSideBySide?this._setStrategy(new DiffEditorWidgetSideBySide(this._createDataSource(),this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio)):this._setStrategy(new DiffEditorWidgetInline(this._createDataSource(),this._options.enableSplitViewResizing)),this._register(vt.onDidColorThemeChange(xt=>{this._strategy&&this._strategy.applyColors(xt)&&this._updateDecorationsRunner.schedule(),this._containerDomElement.className=Kn._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)}));const Lt=EditorExtensionsRegistry.getDiffEditorContributions();for(const xt of Lt)try{this._register(pt.createInstance(xt.ctor,this))}catch(It){onUnexpectedError(It)}this._codeEditorService.addDiffEditor(this)}_setState(nt){this._state!==nt&&(this._state=nt,this._updatingDiffProgress&&(this._updatingDiffProgress.done(),this._updatingDiffProgress=null),this._state===1&&(this._updatingDiffProgress=this._editorProgressService.show(!0,1e3)))}diffReviewNext(){this._reviewPane.next()}diffReviewPrev(){this._reviewPane.prev()}static _getClassName(nt,ot){let rt="monaco-diff-editor monaco-editor-background ";return ot&&(rt+="side-by-side "),rt+=getThemeTypeSelector(nt.type),rt}_disposeOverviewRulers(){this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose(),this._originalOverviewRuler=null),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose(),this._modifiedOverviewRuler=null)}_createOverviewRulers(){this._options.renderOverviewRuler&&(ok(!this._originalOverviewRuler&&!this._modifiedOverviewRuler),this._originalEditor.hasModel()&&(this._originalOverviewRuler=this._originalEditor.createOverviewRuler("original diffOverviewRuler"),this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode())),this._modifiedEditor.hasModel()&&(this._modifiedOverviewRuler=this._modifiedEditor.createOverviewRuler("modified diffOverviewRuler"),this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode())),this._layoutOverviewRulers())}_createLeftHandSideEditor(nt,ot){const rt=this._createInnerEditor(this._instantiationService,this._originalDomNode,this._adjustOptionsForLeftHandSide(nt),ot);this._register(rt.onDidScrollChange(gt=>{this._isHandlingScrollEvent||!gt.scrollTopChanged&&!gt.scrollLeftChanged&&!gt.scrollHeightChanged||(this._isHandlingScrollEvent=!0,this._modifiedEditor.setScrollPosition({scrollLeft:gt.scrollLeft,scrollTop:gt.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())})),this._register(rt.onDidChangeViewZones(()=>{this._onViewZonesChanged()})),this._register(rt.onDidChangeConfiguration(gt=>{rt.getModel()&&(gt.hasChanged(48)&&this._updateDecorationsRunner.schedule(),gt.hasChanged(140)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))})),this._register(rt.onDidChangeHiddenAreas(()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()})),this._register(rt.onDidChangeModelContent(()=>{this._isVisible&&this._beginUpdateDecorationsSoon()}));const ut=this._contextKeyService.createKey("isInDiffLeftEditor",rt.hasWidgetFocus());return this._register(rt.onDidFocusEditorWidget(()=>ut.set(!0))),this._register(rt.onDidBlurEditorWidget(()=>ut.set(!1))),this._register(rt.onDidContentSizeChange(gt=>{const pt=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+Kn.ONE_OVERVIEW_WIDTH,mt=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:mt,contentWidth:pt,contentHeightChanged:gt.contentHeightChanged,contentWidthChanged:gt.contentWidthChanged})})),rt}_createRightHandSideEditor(nt,ot){const rt=this._createInnerEditor(this._instantiationService,this._modifiedDomNode,this._adjustOptionsForRightHandSide(nt),ot);this._register(rt.onDidScrollChange(gt=>{this._isHandlingScrollEvent||!gt.scrollTopChanged&&!gt.scrollLeftChanged&&!gt.scrollHeightChanged||(this._isHandlingScrollEvent=!0,this._originalEditor.setScrollPosition({scrollLeft:gt.scrollLeft,scrollTop:gt.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())})),this._register(rt.onDidChangeViewZones(()=>{this._onViewZonesChanged()})),this._register(rt.onDidChangeConfiguration(gt=>{rt.getModel()&&(gt.hasChanged(48)&&this._updateDecorationsRunner.schedule(),gt.hasChanged(140)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))})),this._register(rt.onDidChangeHiddenAreas(()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()})),this._register(rt.onDidChangeModelContent(()=>{this._isVisible&&this._beginUpdateDecorationsSoon()})),this._register(rt.onDidChangeModelOptions(gt=>{gt.tabSize&&this._updateDecorationsRunner.schedule()}));const ut=this._contextKeyService.createKey("isInDiffRightEditor",rt.hasWidgetFocus());return this._register(rt.onDidFocusEditorWidget(()=>ut.set(!0))),this._register(rt.onDidBlurEditorWidget(()=>ut.set(!1))),this._register(rt.onDidContentSizeChange(gt=>{const pt=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+Kn.ONE_OVERVIEW_WIDTH,mt=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:mt,contentWidth:pt,contentHeightChanged:gt.contentHeightChanged,contentWidthChanged:gt.contentWidthChanged})})),this._register(rt.onMouseDown(gt=>{var pt,mt;if(!gt.event.rightButton&&gt.target.position&&(!((pt=gt.target.element)===null||pt===void 0)&&pt.className.includes("arrow-revert-change"))){const vt=gt.target.position.lineNumber,St=gt.target,yt=(mt=this._diffComputationResult)===null||mt===void 0?void 0:mt.changes.find(wt=>(St==null?void 0:St.detail.afterLineNumber)===wt.modifiedStartLineNumber||wt.modifiedEndLineNumber>0&&wt.modifiedStartLineNumber===vt);yt&&this.revertChange(yt),gt.event.stopPropagation(),this._updateDecorations();return}})),rt}revertChange(nt){const ot=this._modifiedEditor,rt=this._originalEditor.getModel(),ut=this._modifiedEditor.getModel();if(!rt||!ut||!ot)return;const gt=nt.originalEndLineNumber>0?new Range$2(nt.originalStartLineNumber,1,nt.originalEndLineNumber,rt.getLineMaxColumn(nt.originalEndLineNumber)):null,pt=gt?rt.getValueInRange(gt):null,mt=nt.modifiedEndLineNumber>0?new Range$2(nt.modifiedStartLineNumber,1,nt.modifiedEndLineNumber,ut.getLineMaxColumn(nt.modifiedEndLineNumber)):null,vt=ut.getEOL();if(nt.originalEndLineNumber===0&&mt){let St=mt;nt.modifiedStartLineNumber>1?St=mt.setStartPosition(nt.modifiedStartLineNumber-1,ut.getLineMaxColumn(nt.modifiedStartLineNumber-1)):nt.modifiedEndLineNumber<ut.getLineCount()&&(St=mt.setEndPosition(nt.modifiedEndLineNumber+1,1)),ot.executeEdits("diffEditor",[{range:St,text:""}])}else if(nt.modifiedEndLineNumber===0&&pt!==null){const St=nt.modifiedStartLineNumber<ut.getLineCount()?new Position$1(nt.modifiedStartLineNumber+1,1):new Position$1(nt.modifiedStartLineNumber,ut.getLineMaxColumn(nt.modifiedStartLineNumber));ot.executeEdits("diffEditor",[{range:Range$2.fromPositions(St,St),text:nt.modifiedStartLineNumber<ut.getLineCount()?pt+vt:vt+pt}])}else mt&&pt!==null&&ot.executeEdits("diffEditor",[{range:mt,text:pt}])}_createInnerEditor(nt,ot,rt,ut){return nt.createInstance(CodeEditorWidget,ot,rt,ut)}dispose(){this._codeEditorService.removeDiffEditor(this),this._beginUpdateDecorationsTimeout!==-1&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._cleanViewZonesAndDecorations(),this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode),this._options.renderOverviewRuler&&this._containerDomElement.removeChild(this._overviewDomElement),this._containerDomElement.removeChild(this._originalDomNode),this._originalEditor.dispose(),this._containerDomElement.removeChild(this._modifiedDomNode),this._modifiedEditor.dispose(),this._strategy.dispose(),this._containerDomElement.removeChild(this._reviewPane.domNode.domNode),this._containerDomElement.removeChild(this._reviewPane.shadow.domNode),this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode),this._reviewPane.dispose(),this._domElement.removeChild(this._containerDomElement),this._onDidDispose.fire(),super.dispose()}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return EditorType.IDiffEditor}getLineChanges(){return this._diffComputationResult?this._diffComputationResult.changes:null}getOriginalEditor(){return this._originalEditor}getModifiedEditor(){return this._modifiedEditor}updateOptions(nt){const ot=validateDiffEditorOptions(nt,this._options),rt=changedDiffEditorOptions(this._options,ot);this._options=ot;const ut=rt.ignoreTrimWhitespace||rt.renderIndicators||rt.renderMarginRevertIcon,gt=this._isVisible&&(rt.maxComputationTime||rt.maxFileSize);this._documentDiffProvider.setOptions(ot),ut?this._beginUpdateDecorations():gt&&this._beginUpdateDecorationsSoon(),this._modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(nt)),this._originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(nt)),this._strategy.setEnableSplitViewResizing(this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio),rt.renderSideBySide&&(this._options.renderSideBySide?this._setStrategy(new DiffEditorWidgetSideBySide(this._createDataSource(),this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio)):this._setStrategy(new DiffEditorWidgetInline(this._createDataSource(),this._options.enableSplitViewResizing)),this._containerDomElement.className=Kn._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)),rt.renderOverviewRuler&&(this._options.renderOverviewRuler?this._containerDomElement.appendChild(this._overviewDomElement):this._containerDomElement.removeChild(this._overviewDomElement))}getModel(){return{original:this._originalEditor.getModel(),modified:this._modifiedEditor.getModel()}}setModel(nt){if(nt&&(!nt.original||!nt.modified))throw new Error(nt.original?"DiffEditorWidget.setModel: Modified model is null":"DiffEditorWidget.setModel: Original model is null");this._cleanViewZonesAndDecorations(),this._disposeOverviewRulers(),this._originalEditor.setModel(nt?nt.original:null),this._modifiedEditor.setModel(nt?nt.modified:null),this._updateDecorationsRunner.cancel(),nt&&(this._originalEditor.setScrollTop(0),this._modifiedEditor.setScrollTop(0)),this._diffComputationResult=null,this._diffComputationToken++,this._setState(0),nt&&(this._createOverviewRulers(),this._beginUpdateDecorations()),this._layoutOverviewViewport(),this._onDidChangeModel.fire()}getContainerDomNode(){return this._domElement}getVisibleColumnFromPosition(nt){return this._modifiedEditor.getVisibleColumnFromPosition(nt)}getPosition(){return this._modifiedEditor.getPosition()}setPosition(nt,ot="api"){this._modifiedEditor.setPosition(nt,ot)}revealLine(nt,ot=0){this._modifiedEditor.revealLine(nt,ot)}revealLineInCenter(nt,ot=0){this._modifiedEditor.revealLineInCenter(nt,ot)}revealLineInCenterIfOutsideViewport(nt,ot=0){this._modifiedEditor.revealLineInCenterIfOutsideViewport(nt,ot)}revealLineNearTop(nt,ot=0){this._modifiedEditor.revealLineNearTop(nt,ot)}revealPosition(nt,ot=0){this._modifiedEditor.revealPosition(nt,ot)}revealPositionInCenter(nt,ot=0){this._modifiedEditor.revealPositionInCenter(nt,ot)}revealPositionInCenterIfOutsideViewport(nt,ot=0){this._modifiedEditor.revealPositionInCenterIfOutsideViewport(nt,ot)}revealPositionNearTop(nt,ot=0){this._modifiedEditor.revealPositionNearTop(nt,ot)}getSelection(){return this._modifiedEditor.getSelection()}getSelections(){return this._modifiedEditor.getSelections()}setSelection(nt,ot="api"){this._modifiedEditor.setSelection(nt,ot)}setSelections(nt,ot="api"){this._modifiedEditor.setSelections(nt,ot)}revealLines(nt,ot,rt=0){this._modifiedEditor.revealLines(nt,ot,rt)}revealLinesInCenter(nt,ot,rt=0){this._modifiedEditor.revealLinesInCenter(nt,ot,rt)}revealLinesInCenterIfOutsideViewport(nt,ot,rt=0){this._modifiedEditor.revealLinesInCenterIfOutsideViewport(nt,ot,rt)}revealLinesNearTop(nt,ot,rt=0){this._modifiedEditor.revealLinesNearTop(nt,ot,rt)}revealRange(nt,ot=0,rt=!1,ut=!0){this._modifiedEditor.revealRange(nt,ot,rt,ut)}revealRangeInCenter(nt,ot=0){this._modifiedEditor.revealRangeInCenter(nt,ot)}revealRangeInCenterIfOutsideViewport(nt,ot=0){this._modifiedEditor.revealRangeInCenterIfOutsideViewport(nt,ot)}revealRangeNearTop(nt,ot=0){this._modifiedEditor.revealRangeNearTop(nt,ot)}revealRangeNearTopIfOutsideViewport(nt,ot=0){this._modifiedEditor.revealRangeNearTopIfOutsideViewport(nt,ot)}revealRangeAtTop(nt,ot=0){this._modifiedEditor.revealRangeAtTop(nt,ot)}getSupportedActions(){return this._modifiedEditor.getSupportedActions()}saveViewState(){const nt=this._originalEditor.saveViewState(),ot=this._modifiedEditor.saveViewState();return{original:nt,modified:ot}}restoreViewState(nt){if(nt&&nt.original&&nt.modified){const ot=nt;this._originalEditor.restoreViewState(ot.original),this._modifiedEditor.restoreViewState(ot.modified)}}layout(nt){this._elementSizeObserver.observe(nt)}focus(){this._modifiedEditor.focus()}hasTextFocus(){return this._originalEditor.hasTextFocus()||this._modifiedEditor.hasTextFocus()}trigger(nt,ot,rt){this._modifiedEditor.trigger(nt,ot,rt)}createDecorationsCollection(nt){return this._modifiedEditor.createDecorationsCollection(nt)}changeDecorations(nt){return this._modifiedEditor.changeDecorations(nt)}_onDidContainerSizeChanged(){this._doLayout()}_getReviewHeight(){return this._reviewPane.isVisible()?this._elementSizeObserver.getHeight():0}_layoutOverviewRulers(){if(!this._options.renderOverviewRuler||!this._originalOverviewRuler||!this._modifiedOverviewRuler)return;const nt=this._elementSizeObserver.getHeight(),ot=this._getReviewHeight(),rt=Kn.ENTIRE_DIFF_OVERVIEW_WIDTH-2*Kn.ONE_OVERVIEW_WIDTH;this._modifiedEditor.getLayoutInfo()&&(this._originalOverviewRuler.setLayout({top:0,width:Kn.ONE_OVERVIEW_WIDTH,right:rt+Kn.ONE_OVERVIEW_WIDTH,height:nt-ot}),this._modifiedOverviewRuler.setLayout({top:0,right:0,width:Kn.ONE_OVERVIEW_WIDTH,height:nt-ot}))}_onViewZonesChanged(){this._currentlyChangingViewZones||this._updateDecorationsRunner.schedule()}_beginUpdateDecorationsSoon(){this._beginUpdateDecorationsTimeout!==-1&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._beginUpdateDecorationsTimeout=window.setTimeout(()=>this._beginUpdateDecorations(),Kn.UPDATE_DIFF_DECORATIONS_DELAY)}static _equals(nt,ot){return!nt&&!ot?!0:!nt||!ot?!1:nt.toString()===ot.toString()}_beginUpdateDecorations(){this._beginUpdateDecorationsTimeout!==-1&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1);const nt=this._originalEditor.getModel(),ot=this._modifiedEditor.getModel();if(!nt||!ot)return;this._diffComputationToken++;const rt=this._diffComputationToken,ut=this._options.maxFileSize*1024*1024,gt=pt=>{const mt=pt.getValueLength();return ut===0||mt<=ut};if(!gt(nt)||!gt(ot)){(!Kn._equals(nt.uri,this._lastOriginalWarning)||!Kn._equals(ot.uri,this._lastModifiedWarning))&&(this._lastOriginalWarning=nt.uri,this._lastModifiedWarning=ot.uri,this._notificationService.warn(localize("diff.tooLarge","Cannot compare files because one file is too large.")));return}this._setState(1),this._documentDiffProvider.computeDiff(nt,ot,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace,maxComputationTimeMs:this._options.maxComputationTime}).then(pt=>{rt===this._diffComputationToken&&nt===this._originalEditor.getModel()&&ot===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult={identical:pt.identical,quitEarly:pt.quitEarly,changes2:pt.changes,changes:pt.changes.map(mt=>{let vt,St,yt,wt,Lt=mt.innerChanges;return mt.originalRange.isEmpty?(vt=mt.originalRange.startLineNumber-1,St=0,Lt=void 0):(vt=mt.originalRange.startLineNumber,St=mt.originalRange.endLineNumberExclusive-1),mt.modifiedRange.isEmpty?(yt=mt.modifiedRange.startLineNumber-1,wt=0,Lt=void 0):(yt=mt.modifiedRange.startLineNumber,wt=mt.modifiedRange.endLineNumberExclusive-1),{originalStartLineNumber:vt,originalEndLineNumber:St,modifiedStartLineNumber:yt,modifiedEndLineNumber:wt,charChanges:Lt==null?void 0:Lt.map(xt=>({originalStartLineNumber:xt.originalRange.startLineNumber,originalStartColumn:xt.originalRange.startColumn,originalEndLineNumber:xt.originalRange.endLineNumber,originalEndColumn:xt.originalRange.endColumn,modifiedStartLineNumber:xt.modifiedRange.startLineNumber,modifiedStartColumn:xt.modifiedRange.startColumn,modifiedEndLineNumber:xt.modifiedRange.endLineNumber,modifiedEndColumn:xt.modifiedRange.endColumn}))}})},this._updateDecorationsRunner.schedule(),this._onDidUpdateDiff.fire())},pt=>{rt===this._diffComputationToken&&nt===this._originalEditor.getModel()&&ot===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=null,this._updateDecorationsRunner.schedule())})}_cleanViewZonesAndDecorations(){this._originalEditorState.clean(this._originalEditor),this._modifiedEditorState.clean(this._modifiedEditor)}_updateDecorations(){if(!this._originalEditor.getModel()||!this._modifiedEditor.getModel())return;const nt=this._diffComputationResult?this._diffComputationResult.changes:[],ot=this._originalEditorState.getForeignViewZones(this._originalEditor.getWhitespaces()),rt=this._modifiedEditorState.getForeignViewZones(this._modifiedEditor.getWhitespaces()),ut=this._options.renderMarginRevertIcon&&!this._modifiedEditor.getOption(87),gt=this._strategy.getEditorsDiffDecorations(nt,this._options.ignoreTrimWhitespace,this._options.renderIndicators,ut,ot,rt);try{this._currentlyChangingViewZones=!0,this._originalEditorState.apply(this._originalEditor,this._originalOverviewRuler,gt.original,!1),this._modifiedEditorState.apply(this._modifiedEditor,this._modifiedOverviewRuler,gt.modified,!0)}finally{this._currentlyChangingViewZones=!1}}_adjustOptionsForSubEditor(nt){const ot=Object.assign({},nt);return ot.inDiffEditor=!0,ot.automaticLayout=!1,ot.scrollbar=Object.assign({},ot.scrollbar||{}),ot.scrollbar.vertical="visible",ot.folding=!1,ot.codeLens=this._options.diffCodeLens,ot.fixedOverflowWidgets=!0,ot.minimap=Object.assign({},ot.minimap||{}),ot.minimap.enabled=!1,ot}_adjustOptionsForLeftHandSide(nt){const ot=this._adjustOptionsForSubEditor(nt);return this._options.renderSideBySide?ot.wordWrapOverride1=this._options.diffWordWrap:(ot.wordWrapOverride1="off",ot.wordWrapOverride2="off"),nt.originalAriaLabel&&(ot.ariaLabel=nt.originalAriaLabel),this._updateAriaLabel(ot),ot.readOnly=!this._options.originalEditable,ot.dropIntoEditor={enabled:!ot.readOnly},ot.extraEditorClassName="original-in-monaco-diff-editor",Object.assign(Object.assign({},ot),{dimension:{height:0,width:0}})}_updateAriaLabel(nt){let ot=nt.ariaLabel;this._options.accessibilityVerbose?ot+=ariaNavigationTip:ot&&(ot=ot.replaceAll(ariaNavigationTip,"")),nt.ariaLabel=ot}_adjustOptionsForRightHandSide(nt){const ot=this._adjustOptionsForSubEditor(nt);return nt.modifiedAriaLabel&&(ot.ariaLabel=nt.modifiedAriaLabel),this._updateAriaLabel(ot),ot.wordWrapOverride1=this._options.diffWordWrap,ot.revealHorizontalRightPadding=EditorOptions.revealHorizontalRightPadding.defaultValue+Kn.ENTIRE_DIFF_OVERVIEW_WIDTH,ot.scrollbar.verticalHasArrows=!1,ot.extraEditorClassName="modified-in-monaco-diff-editor",Object.assign(Object.assign({},ot),{dimension:{height:0,width:0}})}doLayout(){this._elementSizeObserver.observe(),this._doLayout()}_doLayout(){const nt=this._elementSizeObserver.getWidth(),ot=this._elementSizeObserver.getHeight(),rt=this._getReviewHeight(),ut=this._strategy.layout();this._originalDomNode.style.width=ut+"px",this._originalDomNode.style.left="0px",this._modifiedDomNode.style.width=nt-ut+"px",this._modifiedDomNode.style.left=ut+"px",this._overviewDomElement.style.top="0px",this._overviewDomElement.style.height=ot-rt+"px",this._overviewDomElement.style.width=Kn.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewDomElement.style.left=nt-Kn.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewViewportDomElement.setWidth(Kn.ENTIRE_DIFF_OVERVIEW_WIDTH),this._overviewViewportDomElement.setHeight(30),this._originalEditor.layout({width:ut,height:ot-rt}),this._modifiedEditor.layout({width:nt-ut-(this._options.renderOverviewRuler?Kn.ENTIRE_DIFF_OVERVIEW_WIDTH:0),height:ot-rt}),(this._originalOverviewRuler||this._modifiedOverviewRuler)&&this._layoutOverviewRulers(),this._reviewPane.layout(ot-rt,nt,rt),this._layoutOverviewViewport()}_layoutOverviewViewport(){const nt=this._computeOverviewViewport();nt?(this._overviewViewportDomElement.setTop(nt.top),this._overviewViewportDomElement.setHeight(nt.height)):(this._overviewViewportDomElement.setTop(0),this._overviewViewportDomElement.setHeight(0))}_computeOverviewViewport(){const nt=this._modifiedEditor.getLayoutInfo();if(!nt)return null;const ot=this._modifiedEditor.getScrollTop(),rt=this._modifiedEditor.getScrollHeight(),ut=Math.max(0,nt.height),gt=Math.max(0,ut-2*0),pt=rt>0?gt/rt:0,mt=Math.max(0,Math.floor(nt.height*pt)),vt=Math.floor(ot*pt);return{height:mt,top:vt}}_createDataSource(){return{getWidth:()=>this._elementSizeObserver.getWidth(),getHeight:()=>this._elementSizeObserver.getHeight()-this._getReviewHeight(),getOptions:()=>({renderOverviewRuler:this._options.renderOverviewRuler}),getContainerDomNode:()=>this._containerDomElement,relayoutEditors:()=>{this._doLayout()},getOriginalEditor:()=>this._originalEditor,getModifiedEditor:()=>this._modifiedEditor}}_setStrategy(nt){var ot;(ot=this._strategy)===null||ot===void 0||ot.dispose(),this._strategy=nt,this._boundarySashes&&nt.setBoundarySashes(this._boundarySashes),nt.applyColors(this._themeService.getColorTheme()),this._diffComputationResult&&this._updateDecorations(),this._doLayout()}_getLineChangeAtOrBeforeLineNumber(nt,ot){const rt=this._diffComputationResult?this._diffComputationResult.changes:[];if(rt.length===0||nt<ot(rt[0]))return null;let ut=0,gt=rt.length-1;for(;ut<gt;){const pt=Math.floor((ut+gt)/2),mt=ot(rt[pt]),vt=pt+1<=gt?ot(rt[pt+1]):1073741824;nt<mt?gt=pt-1:nt>=vt?ut=pt+1:(ut=pt,gt=pt)}return rt[ut]}_getEquivalentLineForOriginalLineNumber(nt){const ot=this._getLineChangeAtOrBeforeLineNumber(nt,vt=>vt.originalStartLineNumber);if(!ot)return nt;const rt=ot.originalStartLineNumber+(ot.originalEndLineNumber>0?-1:0),ut=ot.modifiedStartLineNumber+(ot.modifiedEndLineNumber>0?-1:0),gt=ot.originalEndLineNumber>0?ot.originalEndLineNumber-ot.originalStartLineNumber+1:0,pt=ot.modifiedEndLineNumber>0?ot.modifiedEndLineNumber-ot.modifiedStartLineNumber+1:0,mt=nt-rt;return mt<=gt?ut+Math.min(mt,pt):ut+pt-gt+mt}_getEquivalentLineForModifiedLineNumber(nt){const ot=this._getLineChangeAtOrBeforeLineNumber(nt,vt=>vt.modifiedStartLineNumber);if(!ot)return nt;const rt=ot.originalStartLineNumber+(ot.originalEndLineNumber>0?-1:0),ut=ot.modifiedStartLineNumber+(ot.modifiedEndLineNumber>0?-1:0),gt=ot.originalEndLineNumber>0?ot.originalEndLineNumber-ot.originalStartLineNumber+1:0,pt=ot.modifiedEndLineNumber>0?ot.modifiedEndLineNumber-ot.modifiedStartLineNumber+1:0,mt=nt-ut;return mt<=pt?rt+Math.min(mt,gt):rt+gt-pt+mt}getDiffLineInformationForOriginal(nt){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForOriginalLineNumber(nt)}:null}getDiffLineInformationForModified(nt){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForModifiedLineNumber(nt)}:null}};DiffEditorWidget.ONE_OVERVIEW_WIDTH=15;DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH=30;DiffEditorWidget.UPDATE_DIFF_DECORATIONS_DELAY=200;DiffEditorWidget=__decorate$1S([__param$1P(3,IClipboardService),__param$1P(4,IContextKeyService),__param$1P(5,IInstantiationService),__param$1P(6,ICodeEditorService),__param$1P(7,IThemeService),__param$1P(8,INotificationService),__param$1P(9,IContextMenuService),__param$1P(10,IEditorProgressService)],DiffEditorWidget);class DiffEditorWidgetStyle extends Disposable{constructor(nt){super(),this._dataSource=nt,this._insertColor=null,this._removeColor=null}applyColors(nt){const ot=nt.getColor(diffOverviewRulerInserted)||(nt.getColor(diffInserted)||defaultInsertColor).transparent(2),rt=nt.getColor(diffOverviewRulerRemoved)||(nt.getColor(diffRemoved)||defaultRemoveColor).transparent(2),ut=!ot.equals(this._insertColor)||!rt.equals(this._removeColor);return this._insertColor=ot,this._removeColor=rt,ut}getEditorsDiffDecorations(nt,ot,rt,ut,gt,pt){pt=pt.sort((yt,wt)=>yt.afterLineNumber-wt.afterLineNumber),gt=gt.sort((yt,wt)=>yt.afterLineNumber-wt.afterLineNumber);const mt=this._getViewZones(nt,gt,pt,rt),vt=this._getOriginalEditorDecorations(mt,nt,ot,rt),St=this._getModifiedEditorDecorations(mt,nt,ot,rt,ut);return{original:{decorations:vt.decorations,overviewZones:vt.overviewZones,zones:mt.original},modified:{decorations:St.decorations,overviewZones:St.overviewZones,zones:mt.modified}}}setBoundarySashes(nt){}}class ForeignViewZonesIterator{constructor(nt){this._source=nt,this._index=-1,this.current=null,this.advance()}advance(){this._index++,this._index<this._source.length?this.current=this._source[this._index]:this.current=null}}class ViewZonesComputer{constructor(nt,ot,rt,ut,gt){this._lineChanges=nt,this._originalForeignVZ=ot,this._modifiedForeignVZ=rt,this._originalEditor=ut,this._modifiedEditor=gt}static _getViewLineCount(nt,ot,rt){const ut=nt.getModel(),gt=nt._getViewModel();if(ut&&gt){const pt=getViewRange(ut,gt,ot,rt);return pt.endLineNumber-pt.startLineNumber+1}return rt-ot+1}getViewZones(){const nt=this._originalEditor.getOption(64),ot=this._modifiedEditor.getOption(64),rt=this._originalEditor.getOption(140).wrappingColumn!==-1,ut=this._modifiedEditor.getOption(140).wrappingColumn!==-1,gt=rt||ut,pt=this._originalEditor.getModel(),mt=this._originalEditor._getViewModel().coordinatesConverter,vt=this._modifiedEditor._getViewModel().coordinatesConverter,St={original:[],modified:[]};let yt=0,wt=0,Lt=0,xt=0,It=0,kt=0;const At=(Kt,Bt)=>Kt.afterLineNumber-Bt.afterLineNumber,Tt=(Kt,Bt)=>{if(Bt.domNode===null&&Kt.length>0){const Ut=Kt[Kt.length-1];if(Ut.afterLineNumber===Bt.afterLineNumber&&Ut.domNode===null){Ut.heightInLines+=Bt.heightInLines;return}}Kt.push(Bt)},Rt=new ForeignViewZonesIterator(this._modifiedForeignVZ),Nt=new ForeignViewZonesIterator(this._originalForeignVZ);let Pt=1,Ft=1;for(let Kt=0,Bt=this._lineChanges.length;Kt<=Bt;Kt++){const Ut=Kt<Bt?this._lineChanges[Kt]:null;Ut!==null?(Lt=Ut.originalStartLineNumber+(Ut.originalEndLineNumber>0?-1:0),xt=Ut.modifiedStartLineNumber+(Ut.modifiedEndLineNumber>0?-1:0),wt=Ut.originalEndLineNumber>0?ViewZonesComputer._getViewLineCount(this._originalEditor,Ut.originalStartLineNumber,Ut.originalEndLineNumber):0,yt=Ut.modifiedEndLineNumber>0?ViewZonesComputer._getViewLineCount(this._modifiedEditor,Ut.modifiedStartLineNumber,Ut.modifiedEndLineNumber):0,It=Math.max(Ut.originalStartLineNumber,Ut.originalEndLineNumber),kt=Math.max(Ut.modifiedStartLineNumber,Ut.modifiedEndLineNumber)):(Lt+=1e7+wt,xt+=1e7+yt,It=Lt,kt=xt);let qt=[],Yt=[];if(gt){let _i;Ut?Ut.originalEndLineNumber>0?_i=Ut.originalStartLineNumber-Pt:_i=Ut.modifiedStartLineNumber-Ft:_i=pt.getLineCount()-Pt+1;for(let nn=0;nn<_i;nn++){const rn=Pt+nn,dn=Ft+nn,bn=mt.getModelLineViewLineCount(rn),un=vt.getModelLineViewLineCount(dn);bn<un?qt.push({afterLineNumber:rn,heightInLines:un-bn,domNode:null,marginDomNode:null}):bn>un&&Yt.push({afterLineNumber:dn,heightInLines:bn-un,domNode:null,marginDomNode:null})}Ut&&(Pt=(Ut.originalEndLineNumber>0?Ut.originalEndLineNumber:Ut.originalStartLineNumber)+1,Ft=(Ut.modifiedEndLineNumber>0?Ut.modifiedEndLineNumber:Ut.modifiedStartLineNumber)+1)}for(;Rt.current&&Rt.current.afterLineNumber<=kt;){let _i;Rt.current.afterLineNumber<=xt?_i=Lt-xt+Rt.current.afterLineNumber:_i=It;let nn=null;Ut&&Ut.modifiedStartLineNumber<=Rt.current.afterLineNumber&&Rt.current.afterLineNumber<=Ut.modifiedEndLineNumber&&(nn=this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion()),qt.push({afterLineNumber:_i,heightInLines:Rt.current.height/ot,domNode:null,marginDomNode:nn}),Rt.advance()}for(;Nt.current&&Nt.current.afterLineNumber<=It;){let _i;Nt.current.afterLineNumber<=Lt?_i=xt-Lt+Nt.current.afterLineNumber:_i=kt,Yt.push({afterLineNumber:_i,heightInLines:Nt.current.height/nt,domNode:null}),Nt.advance()}if(Ut!==null&&isChangeOrInsert(Ut)){const _i=this._produceOriginalFromDiff(Ut,wt,yt);_i&&qt.push(_i)}if(Ut!==null&&isChangeOrDelete(Ut)){const _i=this._produceModifiedFromDiff(Ut,wt,yt);_i&&Yt.push(_i)}let Zt=0,Xt=0;for(qt=qt.sort(At),Yt=Yt.sort(At);Zt<qt.length&&Xt<Yt.length;){const _i=qt[Zt],nn=Yt[Xt],rn=_i.afterLineNumber-Lt,dn=nn.afterLineNumber-xt;rn<dn?(Tt(St.original,_i),Zt++):dn<rn?(Tt(St.modified,nn),Xt++):_i.shouldNotShrink?(Tt(St.original,_i),Zt++):nn.shouldNotShrink?(Tt(St.modified,nn),Xt++):_i.heightInLines>=nn.heightInLines?(_i.heightInLines-=nn.heightInLines,Xt++):(nn.heightInLines-=_i.heightInLines,Zt++)}for(;Zt<qt.length;)Tt(St.original,qt[Zt]),Zt++;for(;Xt<Yt.length;)Tt(St.modified,Yt[Xt]),Xt++}return{original:ViewZonesComputer._ensureDomNodes(St.original),modified:ViewZonesComputer._ensureDomNodes(St.modified)}}static _ensureDomNodes(nt){return nt.map(ot=>(ot.domNode||(ot.domNode=createFakeLinesDiv()),ot))}}function createDecoration(ct,nt,ot,rt,ut){return{range:new Range$2(ct,nt,ot,rt),options:ut}}const DECORATIONS={arrowRevertChange:ModelDecorationOptions.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new MarkdownString(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(localize("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+ThemeIcon.asClassName(Codicon.arrowRight),zIndex:10001}),charDelete:ModelDecorationOptions.register({description:"diff-editor-char-delete",className:"char-delete"}),charDeleteWholeLine:ModelDecorationOptions.register({description:"diff-editor-char-delete-whole-line",className:"char-delete",isWholeLine:!0}),charInsert:ModelDecorationOptions.register({description:"diff-editor-char-insert",className:"char-insert"}),charInsertWholeLine:ModelDecorationOptions.register({description:"diff-editor-char-insert-whole-line",className:"char-insert",isWholeLine:!0}),lineInsert:ModelDecorationOptions.register({description:"diff-editor-line-insert",className:"line-insert",marginClassName:"gutter-insert",isWholeLine:!0}),lineInsertWithSign:ModelDecorationOptions.register({description:"diff-editor-line-insert-with-sign",className:"line-insert",linesDecorationsClassName:"insert-sign "+ThemeIcon.asClassName(diffInsertIcon),marginClassName:"gutter-insert",isWholeLine:!0}),lineDelete:ModelDecorationOptions.register({description:"diff-editor-line-delete",className:"line-delete",marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteWithSign:ModelDecorationOptions.register({description:"diff-editor-line-delete-with-sign",className:"line-delete",linesDecorationsClassName:"delete-sign "+ThemeIcon.asClassName(diffRemoveIcon),marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteMargin:ModelDecorationOptions.register({description:"diff-editor-line-delete-margin",marginClassName:"gutter-delete"})};class DiffEditorWidgetSideBySide extends DiffEditorWidgetStyle{constructor(nt,ot,rt){super(nt),this._disableSash=ot===!1,this._defaultRatio=rt,this._sashRatio=null,this._sashPosition=null,this._startSashPosition=null,this._sash=this._register(new Sash(this._dataSource.getContainerDomNode(),this,{orientation:0})),this._disableSash&&(this._sash.state=0),this._sash.onDidStart(()=>this._onSashDragStart()),this._sash.onDidChange(ut=>this._onSashDrag(ut)),this._sash.onDidEnd(()=>this._onSashDragEnd()),this._sash.onDidReset(()=>this._onSashReset())}setEnableSplitViewResizing(nt,ot){this._defaultRatio=ot;const rt=nt===!1;this._disableSash!==rt&&(this._disableSash=rt,this._sash.state=this._disableSash?0:3)}layout(nt=this._sashRatio||this._defaultRatio){const rt=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH:0);let ut=Math.floor((nt||this._defaultRatio)*rt);const gt=Math.floor(this._defaultRatio*rt);return ut=this._disableSash?gt:ut||gt,rt>DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH*2?(ut<DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH&&(ut=DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH),ut>rt-DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH&&(ut=rt-DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH)):ut=gt,this._sashPosition!==ut&&(this._sashPosition=ut),this._sash.layout(),this._sashPosition}_onSashDragStart(){this._startSashPosition=this._sashPosition}_onSashDrag(nt){const rt=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH:0),ut=this.layout((this._startSashPosition+(nt.currentX-nt.startX))/rt);this._sashRatio=ut/rt,this._dataSource.relayoutEditors()}_onSashDragEnd(){this._sash.layout()}_onSashReset(){this._sashRatio=this._defaultRatio,this._dataSource.relayoutEditors(),this._sash.layout()}getVerticalSashTop(nt){return 0}getVerticalSashLeft(nt){return this._sashPosition}getVerticalSashHeight(nt){return this._dataSource.getHeight()}setBoundarySashes(nt){this._sash.orthogonalEndSash=nt.bottom}_getViewZones(nt,ot,rt){const ut=this._dataSource.getOriginalEditor(),gt=this._dataSource.getModifiedEditor();return new SideBySideViewZonesComputer(nt,ot,rt,ut,gt).getViewZones()}_getOriginalEditorDecorations(nt,ot,rt,ut){const gt=this._dataSource.getOriginalEditor(),pt=String(this._removeColor),mt={decorations:[],overviewZones:[]},vt=gt.getModel(),St=gt._getViewModel();for(const yt of ot)if(isChangeOrDelete(yt)){mt.decorations.push({range:new Range$2(yt.originalStartLineNumber,1,yt.originalEndLineNumber,1073741824),options:ut?DECORATIONS.lineDeleteWithSign:DECORATIONS.lineDelete}),(!isChangeOrInsert(yt)||!yt.charChanges)&&mt.decorations.push(createDecoration(yt.originalStartLineNumber,1,yt.originalEndLineNumber,1073741824,DECORATIONS.charDeleteWholeLine));const wt=getViewRange(vt,St,yt.originalStartLineNumber,yt.originalEndLineNumber);if(mt.overviewZones.push(new OverviewRulerZone(wt.startLineNumber,wt.endLineNumber,0,pt)),yt.charChanges){for(const Lt of yt.charChanges)if(isCharChangeOrDelete(Lt))if(rt)for(let xt=Lt.originalStartLineNumber;xt<=Lt.originalEndLineNumber;xt++){let It,kt;xt===Lt.originalStartLineNumber?It=Lt.originalStartColumn:It=vt.getLineFirstNonWhitespaceColumn(xt),xt===Lt.originalEndLineNumber?kt=Lt.originalEndColumn:kt=vt.getLineLastNonWhitespaceColumn(xt),mt.decorations.push(createDecoration(xt,It,xt,kt,DECORATIONS.charDelete))}else mt.decorations.push(createDecoration(Lt.originalStartLineNumber,Lt.originalStartColumn,Lt.originalEndLineNumber,Lt.originalEndColumn,DECORATIONS.charDelete))}}return mt}_getModifiedEditorDecorations(nt,ot,rt,ut,gt){const pt=this._dataSource.getModifiedEditor(),mt=String(this._insertColor),vt={decorations:[],overviewZones:[]},St=pt.getModel(),yt=pt._getViewModel();for(const wt of ot){if(gt)if(wt.modifiedEndLineNumber>0)vt.decorations.push({range:new Range$2(wt.modifiedStartLineNumber,1,wt.modifiedStartLineNumber,1),options:DECORATIONS.arrowRevertChange});else{const Lt=nt.modified.find(xt=>xt.afterLineNumber===wt.modifiedStartLineNumber);Lt&&(Lt.marginDomNode=createViewZoneMarginArrow())}if(isChangeOrInsert(wt)){vt.decorations.push({range:new Range$2(wt.modifiedStartLineNumber,1,wt.modifiedEndLineNumber,1073741824),options:ut?DECORATIONS.lineInsertWithSign:DECORATIONS.lineInsert}),(!isChangeOrDelete(wt)||!wt.charChanges)&&vt.decorations.push(createDecoration(wt.modifiedStartLineNumber,1,wt.modifiedEndLineNumber,1073741824,DECORATIONS.charInsertWholeLine));const Lt=getViewRange(St,yt,wt.modifiedStartLineNumber,wt.modifiedEndLineNumber);if(vt.overviewZones.push(new OverviewRulerZone(Lt.startLineNumber,Lt.endLineNumber,0,mt)),wt.charChanges){for(const xt of wt.charChanges)if(isCharChangeOrInsert(xt))if(rt)for(let It=xt.modifiedStartLineNumber;It<=xt.modifiedEndLineNumber;It++){let kt,At;It===xt.modifiedStartLineNumber?kt=xt.modifiedStartColumn:kt=St.getLineFirstNonWhitespaceColumn(It),It===xt.modifiedEndLineNumber?At=xt.modifiedEndColumn:At=St.getLineLastNonWhitespaceColumn(It),vt.decorations.push(createDecoration(It,kt,It,At,DECORATIONS.charInsert))}else vt.decorations.push(createDecoration(xt.modifiedStartLineNumber,xt.modifiedStartColumn,xt.modifiedEndLineNumber,xt.modifiedEndColumn,DECORATIONS.charInsert))}}}return vt}}DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH=100;class SideBySideViewZonesComputer extends ViewZonesComputer{constructor(nt,ot,rt,ut,gt){super(nt,ot,rt,ut,gt)}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){return null}_produceOriginalFromDiff(nt,ot,rt){return rt>ot?{afterLineNumber:Math.max(nt.originalStartLineNumber,nt.originalEndLineNumber),heightInLines:rt-ot,domNode:null}:null}_produceModifiedFromDiff(nt,ot,rt){return ot>rt?{afterLineNumber:Math.max(nt.modifiedStartLineNumber,nt.modifiedEndLineNumber),heightInLines:ot-rt,domNode:null}:null}}class DiffEditorWidgetInline extends DiffEditorWidgetStyle{constructor(nt,ot){super(nt),this._decorationsLeft=nt.getOriginalEditor().getLayoutInfo().decorationsLeft,this._register(nt.getOriginalEditor().onDidLayoutChange(rt=>{this._decorationsLeft!==rt.decorationsLeft&&(this._decorationsLeft=rt.decorationsLeft,nt.relayoutEditors())}))}setEnableSplitViewResizing(nt){}_getViewZones(nt,ot,rt,ut){const gt=this._dataSource.getOriginalEditor(),pt=this._dataSource.getModifiedEditor();return new InlineViewZonesComputer(nt,ot,rt,gt,pt,ut).getViewZones()}_getOriginalEditorDecorations(nt,ot,rt,ut){const gt=String(this._removeColor),pt={decorations:[],overviewZones:[]},mt=this._dataSource.getOriginalEditor(),vt=mt.getModel(),St=mt._getViewModel();let yt=0;for(const wt of ot)if(isChangeOrDelete(wt)){for(pt.decorations.push({range:new Range$2(wt.originalStartLineNumber,1,wt.originalEndLineNumber,1073741824),options:DECORATIONS.lineDeleteMargin});yt<nt.modified.length;){const It=nt.modified[yt];if(It.diff&&It.diff.originalStartLineNumber>=wt.originalStartLineNumber)break;yt++}let Lt=0;if(yt<nt.modified.length){const It=nt.modified[yt];It.diff&&It.diff.originalStartLineNumber===wt.originalStartLineNumber&&It.diff.originalEndLineNumber===wt.originalEndLineNumber&&It.diff.modifiedStartLineNumber===wt.modifiedStartLineNumber&&It.diff.modifiedEndLineNumber===wt.modifiedEndLineNumber&&(Lt=It.heightInLines)}const xt=getViewRange(vt,St,wt.originalStartLineNumber,wt.originalEndLineNumber);pt.overviewZones.push(new OverviewRulerZone(xt.startLineNumber,xt.endLineNumber,Lt,gt))}return pt}_getModifiedEditorDecorations(nt,ot,rt,ut,gt){const pt=this._dataSource.getModifiedEditor(),mt=String(this._insertColor),vt={decorations:[],overviewZones:[]},St=pt.getModel(),yt=pt._getViewModel();for(const wt of ot)if(isChangeOrInsert(wt)){vt.decorations.push({range:new Range$2(wt.modifiedStartLineNumber,1,wt.modifiedEndLineNumber,1073741824),options:ut?DECORATIONS.lineInsertWithSign:DECORATIONS.lineInsert});const Lt=getViewRange(St,yt,wt.modifiedStartLineNumber,wt.modifiedEndLineNumber);if(vt.overviewZones.push(new OverviewRulerZone(Lt.startLineNumber,Lt.endLineNumber,0,mt)),wt.charChanges){for(const xt of wt.charChanges)if(isCharChangeOrInsert(xt))if(rt)for(let It=xt.modifiedStartLineNumber;It<=xt.modifiedEndLineNumber;It++){let kt,At;It===xt.modifiedStartLineNumber?kt=xt.modifiedStartColumn:kt=St.getLineFirstNonWhitespaceColumn(It),It===xt.modifiedEndLineNumber?At=xt.modifiedEndColumn:At=St.getLineLastNonWhitespaceColumn(It),vt.decorations.push(createDecoration(It,kt,It,At,DECORATIONS.charInsert))}else vt.decorations.push(createDecoration(xt.modifiedStartLineNumber,xt.modifiedStartColumn,xt.modifiedEndLineNumber,xt.modifiedEndColumn,DECORATIONS.charInsert))}else vt.decorations.push(createDecoration(wt.modifiedStartLineNumber,1,wt.modifiedEndLineNumber,1073741824,DECORATIONS.charInsertWholeLine))}return vt}layout(){return Math.max(5,this._decorationsLeft)}}class InlineViewZonesComputer extends ViewZonesComputer{constructor(nt,ot,rt,ut,gt,pt){super(nt,ot,rt,ut,gt),this._originalModel=ut.getModel(),this._renderIndicators=pt,this._pendingLineChange=[],this._pendingViewZones=[],this._lineBreaksComputer=this._modifiedEditor._getViewModel().createLineBreaksComputer()}getViewZones(){const nt=super.getViewZones();return this._finalize(nt),nt}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){const nt=document.createElement("div");return nt.className="inline-added-margin-view-zone",nt}_produceOriginalFromDiff(nt,ot,rt){const ut=document.createElement("div");return ut.className="inline-added-margin-view-zone",{afterLineNumber:Math.max(nt.originalStartLineNumber,nt.originalEndLineNumber),heightInLines:rt,domNode:document.createElement("div"),marginDomNode:ut}}_produceModifiedFromDiff(nt,ot,rt){const ut=document.createElement("div");ut.className=`view-lines line-delete ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`;const gt=document.createElement("div");gt.className="inline-deleted-margin-view-zone";const pt={shouldNotShrink:!0,afterLineNumber:nt.modifiedEndLineNumber===0?nt.modifiedStartLineNumber:nt.modifiedStartLineNumber-1,heightInLines:ot,minWidthInPx:0,domNode:ut,marginDomNode:gt,diff:{originalStartLineNumber:nt.originalStartLineNumber,originalEndLineNumber:nt.originalEndLineNumber,modifiedStartLineNumber:nt.modifiedStartLineNumber,modifiedEndLineNumber:nt.modifiedEndLineNumber,originalModel:this._originalModel,viewLineCounts:null}};for(let mt=nt.originalStartLineNumber;mt<=nt.originalEndLineNumber;mt++)this._lineBreaksComputer.addRequest(this._originalModel.getLineContent(mt),null,null);return this._pendingLineChange.push(nt),this._pendingViewZones.push(pt),pt}_finalize(nt){const ot=this._modifiedEditor.getOptions(),rt=this._modifiedEditor.getModel().getOptions().tabSize,ut=ot.get(48),gt=ot.get(31),pt=ut.typicalHalfwidthCharacterWidth,mt=ot.get(99),vt=this._originalModel.mightContainNonBasicASCII(),St=this._originalModel.mightContainRTL(),yt=ot.get(64),Lt=ot.get(139).decorationsWidth,xt=ot.get(112),It=ot.get(94),kt=ot.get(89),At=ot.get(49),Tt=this._lineBreaksComputer.finalize();let Rt=0;for(let Nt=0;Nt<this._pendingLineChange.length;Nt++){const Pt=this._pendingLineChange[Nt],Ft=this._pendingViewZones[Nt],Kt=Ft.domNode;applyFontInfo(Kt,ut);const Bt=Ft.marginDomNode;applyFontInfo(Bt,ut);const Ut=[];if(Pt.charChanges)for(const dn of Pt.charChanges)isCharChangeOrDelete(dn)&&Ut.push(new InlineDecoration(new Range$2(dn.originalStartLineNumber,dn.originalStartColumn,dn.originalEndLineNumber,dn.originalEndColumn),"char-delete",0));const qt=Ut.length>0,Yt=new StringBuilder(1e4);let Zt=0,Xt=0,_i=null;for(let dn=Pt.originalStartLineNumber;dn<=Pt.originalEndLineNumber;dn++){const bn=dn-Pt.originalStartLineNumber,un=this._originalModel.tokenization.getLineTokens(dn),an=un.getLineContent(),Cn=Tt[Rt++],_n=LineDecoration.filter(Ut,dn,1,an.length+1);if(Cn){let hn=0;for(const yn of Cn.breakOffsets){const Mn=un.sliceAndInflate(hn,yn,0),Nn=an.substring(hn,yn);Zt=Math.max(Zt,this._renderOriginalLine(Xt++,Nn,Mn,LineDecoration.extractWrapped(_n,hn,yn),qt,vt,St,ut,gt,yt,Lt,xt,It,kt,At,rt,Yt,Bt)),hn=yn}for(_i||(_i=[]);_i.length<bn;)_i[_i.length]=1;_i[bn]=Cn.breakOffsets.length,Ft.heightInLines+=Cn.breakOffsets.length-1;const pn=document.createElement("div");pn.className="gutter-delete",nt.original.push({afterLineNumber:dn,afterColumn:0,heightInLines:Cn.breakOffsets.length-1,domNode:createFakeLinesDiv(),marginDomNode:pn})}else Zt=Math.max(Zt,this._renderOriginalLine(Xt++,an,un,_n,qt,vt,St,ut,gt,yt,Lt,xt,It,kt,At,rt,Yt,Bt))}Zt+=mt;const nn=Yt.build(),rn=ttPolicy$1?ttPolicy$1.createHTML(nn):nn;if(Kt.innerHTML=rn,Ft.minWidthInPx=Zt*pt,_i){const dn=Pt.originalEndLineNumber-Pt.originalStartLineNumber;for(;_i.length<=dn;)_i[_i.length]=1}Ft.diff.viewLineCounts=_i}nt.original.sort((Nt,Pt)=>Nt.afterLineNumber-Pt.afterLineNumber)}_renderOriginalLine(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt,xt,It,kt,At,Tt,Rt){Tt.appendString('<div class="view-line'),gt||Tt.appendString(" char-delete"),Tt.appendString('" style="top:'),Tt.appendString(String(nt*yt)),Tt.appendString('px;width:1000000px;">');const Nt=ViewLineRenderingData.isBasicASCII(ot,pt),Pt=ViewLineRenderingData.containsRTL(ot,Nt,mt),Ft=renderViewLine(new RenderLineInput(vt.isMonospace&&!St,vt.canUseHalfwidthRightwardsArrow,ot,!1,Nt,Pt,0,rt,ut,At,0,vt.spaceWidth,vt.middotWidth,vt.wsmiddotWidth,Lt,xt,It,kt!==EditorFontLigatures.OFF,null),Tt);if(Tt.appendString("</div>"),this._renderIndicators){const Kt=document.createElement("div");Kt.className=`delete-sign ${ThemeIcon.asClassName(diffRemoveIcon)}`,Kt.setAttribute("style",`position:absolute;top:${nt*yt}px;width:${wt}px;height:${yt}px;right:0;`),Rt.appendChild(Kt)}return Ft.characterMapping.getHorizontalOffset(Ft.characterMapping.length)}}function validateDiffWordWrap(ct,nt){return stringSet(ct,nt,["off","on","inherit"])}function isChangeOrInsert(ct){return ct.modifiedEndLineNumber>0}function isChangeOrDelete(ct){return ct.originalEndLineNumber>0}function isCharChangeOrInsert(ct){return ct.modifiedStartLineNumber===ct.modifiedEndLineNumber?ct.modifiedEndColumn-ct.modifiedStartColumn>0:ct.modifiedEndLineNumber-ct.modifiedStartLineNumber>0}function isCharChangeOrDelete(ct){return ct.originalStartLineNumber===ct.originalEndLineNumber?ct.originalEndColumn-ct.originalStartColumn>0:ct.originalEndLineNumber-ct.originalStartLineNumber>0}function createFakeLinesDiv(){const ct=document.createElement("div");return ct.className="diagonal-fill",ct}function createViewZoneMarginArrow(){const ct=document.createElement("div");return ct.className="arrow-revert-change "+ThemeIcon.asClassName(Codicon.arrowRight),$$d("div",{},ct)}function getViewRange(ct,nt,ot,rt){const ut=ct.getLineCount();return ot=Math.min(ut,Math.max(1,ot)),rt=Math.min(ut,Math.max(1,rt)),nt.coordinatesConverter.convertModelRangeToViewRange(new Range$2(ot,ct.getLineMinColumn(ot),rt,ct.getLineMaxColumn(rt)))}function validateDiffEditorOptions(ct,nt){return{enableSplitViewResizing:boolean(ct.enableSplitViewResizing,nt.enableSplitViewResizing),splitViewDefaultRatio:clampedFloat(ct.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:boolean(ct.renderSideBySide,nt.renderSideBySide),renderMarginRevertIcon:boolean(ct.renderMarginRevertIcon,nt.renderMarginRevertIcon),maxComputationTime:clampedInt(ct.maxComputationTime,nt.maxComputationTime,0,1073741824),maxFileSize:clampedInt(ct.maxFileSize,nt.maxFileSize,0,1073741824),ignoreTrimWhitespace:boolean(ct.ignoreTrimWhitespace,nt.ignoreTrimWhitespace),renderIndicators:boolean(ct.renderIndicators,nt.renderIndicators),originalEditable:boolean(ct.originalEditable,nt.originalEditable),diffCodeLens:boolean(ct.diffCodeLens,nt.diffCodeLens),renderOverviewRuler:boolean(ct.renderOverviewRuler,nt.renderOverviewRuler),diffWordWrap:validateDiffWordWrap(ct.diffWordWrap,nt.diffWordWrap),diffAlgorithm:stringSet(ct.diffAlgorithm,nt.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:boolean(ct.accessibilityVerbose,nt.accessibilityVerbose)}}function changedDiffEditorOptions(ct,nt){return{enableSplitViewResizing:ct.enableSplitViewResizing!==nt.enableSplitViewResizing,renderSideBySide:ct.renderSideBySide!==nt.renderSideBySide,renderMarginRevertIcon:ct.renderMarginRevertIcon!==nt.renderMarginRevertIcon,maxComputationTime:ct.maxComputationTime!==nt.maxComputationTime,maxFileSize:ct.maxFileSize!==nt.maxFileSize,ignoreTrimWhitespace:ct.ignoreTrimWhitespace!==nt.ignoreTrimWhitespace,renderIndicators:ct.renderIndicators!==nt.renderIndicators,originalEditable:ct.originalEditable!==nt.originalEditable,diffCodeLens:ct.diffCodeLens!==nt.diffCodeLens,renderOverviewRuler:ct.renderOverviewRuler!==nt.renderOverviewRuler,diffWordWrap:ct.diffWordWrap!==nt.diffWordWrap,diffAlgorithm:ct.diffAlgorithm!==nt.diffAlgorithm,accessibilityVerbose:ct.accessibilityVerbose!==nt.accessibilityVerbose}}registerThemingParticipant((ct,nt)=>{const ot=ct.getColor(diffDiagonalFill);nt.addRule(`
	.monaco-editor .diagonal-fill {
		background-image: linear-gradient(
			-45deg,
			${ot} 12.5%,
			#0000 12.5%, #0000 50%,
			${ot} 50%, ${ot} 62.5%,
			#0000 62.5%, #0000 100%
		);
		background-size: 8px 8px;
	}
	`)});var __decorate$1R=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1O=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$1h=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let AbstractCodeEditorService=class extends Disposable{constructor(nt){super(),this._themeService=nt,this._onWillCreateCodeEditor=this._register(new Emitter$2),this._onCodeEditorAdd=this._register(new Emitter$2),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new Emitter$2),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new Emitter$2),this._onDiffEditorAdd=this._register(new Emitter$2),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new Emitter$2),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new LinkedList,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(nt){this._codeEditors[nt.getId()]=nt,this._onCodeEditorAdd.fire(nt)}removeCodeEditor(nt){delete this._codeEditors[nt.getId()]&&this._onCodeEditorRemove.fire(nt)}listCodeEditors(){return Object.keys(this._codeEditors).map(nt=>this._codeEditors[nt])}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(nt){this._diffEditors[nt.getId()]=nt,this._onDiffEditorAdd.fire(nt)}removeDiffEditor(nt){delete this._diffEditors[nt.getId()]&&this._onDiffEditorRemove.fire(nt)}listDiffEditors(){return Object.keys(this._diffEditors).map(nt=>this._diffEditors[nt])}getFocusedCodeEditor(){let nt=null;const ot=this.listCodeEditors();for(const rt of ot){if(rt.hasTextFocus())return rt;rt.hasWidgetFocus()&&(nt=rt)}return nt}removeDecorationType(nt){const ot=this._decorationOptionProviders.get(nt);ot&&(ot.refCount--,ot.refCount<=0&&(this._decorationOptionProviders.delete(nt),ot.dispose(),this.listCodeEditors().forEach(rt=>rt.removeDecorationsByType(nt))))}setModelProperty(nt,ot,rt){const ut=nt.toString();let gt;this._modelProperties.has(ut)?gt=this._modelProperties.get(ut):(gt=new Map,this._modelProperties.set(ut,gt)),gt.set(ot,rt)}getModelProperty(nt,ot){const rt=nt.toString();if(this._modelProperties.has(rt))return this._modelProperties.get(rt).get(ot)}openCodeEditor(nt,ot,rt){return __awaiter$1h(this,void 0,void 0,function*(){for(const ut of this._codeEditorOpenHandlers){const gt=yield ut(nt,ot,rt);if(gt!==null)return gt}return null})}registerCodeEditorOpenHandler(nt){const ot=this._codeEditorOpenHandlers.unshift(nt);return toDisposable(ot)}};AbstractCodeEditorService=__decorate$1R([__param$1O(0,IThemeService)],AbstractCodeEditorService);var __decorate$1Q=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1N=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$1g=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let StandaloneCodeEditorService=class extends AbstractCodeEditorService{constructor(nt,ot){super(ot),this.onCodeEditorAdd(()=>this._checkContextKey()),this.onCodeEditorRemove(()=>this._checkContextKey()),this._editorIsOpen=nt.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this.registerCodeEditorOpenHandler((rt,ut,gt)=>__awaiter$1g(this,void 0,void 0,function*(){return ut?this.doOpenEditor(ut,rt):null}))}_checkContextKey(){let nt=!1;for(const ot of this.listCodeEditors())if(!ot.isSimpleWidget){nt=!0;break}this._editorIsOpen.set(nt)}setActiveCodeEditor(nt){this._activeCodeEditor=nt}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(nt,ot){if(!this.findModel(nt,ot.resource)){if(ot.resource){const gt=ot.resource.scheme;if(gt===Schemas.http||gt===Schemas.https)return windowOpenNoOpener(ot.resource.toString()),nt}return null}const ut=ot.options?ot.options.selection:null;if(ut)if(typeof ut.endLineNumber=="number"&&typeof ut.endColumn=="number")nt.setSelection(ut),nt.revealRangeInCenter(ut,1);else{const gt={lineNumber:ut.startLineNumber,column:ut.startColumn};nt.setPosition(gt),nt.revealPositionInCenter(gt,1)}return nt}findModel(nt,ot){const rt=nt.getModel();return rt&&rt.uri.toString()!==ot.toString()?null:rt}};StandaloneCodeEditorService=__decorate$1Q([__param$1N(0,IContextKeyService),__param$1N(1,IThemeService)],StandaloneCodeEditorService);registerSingleton(ICodeEditorService,StandaloneCodeEditorService,0);const ILayoutService=createDecorator("layoutService");var __decorate$1P=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1M=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let StandaloneLayoutService=class{get dimension(){return this._dimension||(this._dimension=getClientArea(window.document.body)),this._dimension}get hasContainer(){return!1}get container(){throw new Error("ILayoutService.container is not available in the standalone editor!")}focus(){var nt;(nt=this._codeEditorService.getFocusedCodeEditor())===null||nt===void 0||nt.focus()}constructor(nt){this._codeEditorService=nt,this.onDidLayout=Event.None,this.offset={top:0,quickPickTop:0}}};StandaloneLayoutService=__decorate$1P([__param$1M(0,ICodeEditorService)],StandaloneLayoutService);let EditorScopedLayoutService=class extends StandaloneLayoutService{get hasContainer(){return!1}get container(){return this._container}constructor(nt,ot){super(ot),this._container=nt}};EditorScopedLayoutService=__decorate$1P([__param$1M(1,ICodeEditorService)],EditorScopedLayoutService);registerSingleton(ILayoutService,StandaloneLayoutService,1);const IDialogService=createDecorator("dialogService");var __decorate$1O=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1L=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$1f=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function getResourceLabel(ct){return ct.scheme===Schemas.file?ct.fsPath:ct.path}let stackElementCounter=0;class ResourceStackElement{constructor(nt,ot,rt,ut,gt,pt,mt){this.id=++stackElementCounter,this.type=0,this.actual=nt,this.label=nt.label,this.confirmBeforeUndo=nt.confirmBeforeUndo||!1,this.resourceLabel=ot,this.strResource=rt,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=ut,this.groupOrder=gt,this.sourceId=pt,this.sourceOrder=mt,this.isValid=!0}setValid(nt){this.isValid=nt}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class ResourceReasonPair{constructor(nt,ot){this.resourceLabel=nt,this.reason=ot}}class RemovedResources{constructor(){this.elements=new Map}createMessage(){const nt=[],ot=[];for(const[,ut]of this.elements)(ut.reason===0?nt:ot).push(ut.resourceLabel);const rt=[];return nt.length>0&&rt.push(localize({key:"externalRemoval",comment:["{0} is a list of filenames"]},"The following files have been closed and modified on disk: {0}.",nt.join(", "))),ot.length>0&&rt.push(localize({key:"noParallelUniverses",comment:["{0} is a list of filenames"]},"The following files have been modified in an incompatible way: {0}.",ot.join(", "))),rt.join(`
`)}get size(){return this.elements.size}has(nt){return this.elements.has(nt)}set(nt,ot){this.elements.set(nt,ot)}delete(nt){return this.elements.delete(nt)}}class WorkspaceStackElement{constructor(nt,ot,rt,ut,gt,pt,mt){this.id=++stackElementCounter,this.type=1,this.actual=nt,this.label=nt.label,this.confirmBeforeUndo=nt.confirmBeforeUndo||!1,this.resourceLabels=ot,this.strResources=rt,this.groupId=ut,this.groupOrder=gt,this.sourceId=pt,this.sourceOrder=mt,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(nt,ot,rt){this.removedResources||(this.removedResources=new RemovedResources),this.removedResources.has(ot)||this.removedResources.set(ot,new ResourceReasonPair(nt,rt))}setValid(nt,ot,rt){rt?this.invalidatedResources&&(this.invalidatedResources.delete(ot),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new RemovedResources),this.invalidatedResources.has(ot)||this.invalidatedResources.set(ot,new ResourceReasonPair(nt,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class ResourceEditStack{constructor(nt,ot){this.resourceLabel=nt,this.strResource=ot,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const nt of this._past)nt.type===1&&nt.removeResource(this.resourceLabel,this.strResource,0);for(const nt of this._future)nt.type===1&&nt.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const nt=[];nt.push(`* ${this.strResource}:`);for(let ot=0;ot<this._past.length;ot++)nt.push(`   * [UNDO] ${this._past[ot]}`);for(let ot=this._future.length-1;ot>=0;ot--)nt.push(`   * [REDO] ${this._future[ot]}`);return nt.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(nt,ot){nt.type===1?nt.setValid(this.resourceLabel,this.strResource,ot):nt.setValid(ot)}setElementsValidFlag(nt,ot){for(const rt of this._past)ot(rt.actual)&&this._setElementValidFlag(rt,nt);for(const rt of this._future)ot(rt.actual)&&this._setElementValidFlag(rt,nt)}pushElement(nt){for(const ot of this._future)ot.type===1&&ot.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(nt),this.versionId++}createSnapshot(nt){const ot=[];for(let rt=0,ut=this._past.length;rt<ut;rt++)ot.push(this._past[rt].id);for(let rt=this._future.length-1;rt>=0;rt--)ot.push(this._future[rt].id);return new ResourceEditStackSnapshot(nt,ot)}restoreSnapshot(nt){const ot=nt.elements.length;let rt=!0,ut=0,gt=-1;for(let mt=0,vt=this._past.length;mt<vt;mt++,ut++){const St=this._past[mt];rt&&(ut>=ot||St.id!==nt.elements[ut])&&(rt=!1,gt=0),!rt&&St.type===1&&St.removeResource(this.resourceLabel,this.strResource,0)}let pt=-1;for(let mt=this._future.length-1;mt>=0;mt--,ut++){const vt=this._future[mt];rt&&(ut>=ot||vt.id!==nt.elements[ut])&&(rt=!1,pt=mt),!rt&&vt.type===1&&vt.removeResource(this.resourceLabel,this.strResource,0)}gt!==-1&&(this._past=this._past.slice(0,gt)),pt!==-1&&(this._future=this._future.slice(pt+1)),this.versionId++}getElements(){const nt=[],ot=[];for(const rt of this._past)nt.push(rt.actual);for(const rt of this._future)ot.push(rt.actual);return{past:nt,future:ot}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(nt,ot){for(let rt=this._past.length-1;rt>=0;rt--)if(this._past[rt]===nt){ot.has(this.strResource)?this._past[rt]=ot.get(this.strResource):this._past.splice(rt,1);break}this.versionId++}splitFutureWorkspaceElement(nt,ot){for(let rt=this._future.length-1;rt>=0;rt--)if(this._future[rt]===nt){ot.has(this.strResource)?this._future[rt]=ot.get(this.strResource):this._future.splice(rt,1);break}this.versionId++}moveBackward(nt){this._past.pop(),this._future.push(nt),this.versionId++}moveForward(nt){this._future.pop(),this._past.push(nt),this.versionId++}}class EditStackSnapshot{constructor(nt){this.editStacks=nt,this._versionIds=[];for(let ot=0,rt=this.editStacks.length;ot<rt;ot++)this._versionIds[ot]=this.editStacks[ot].versionId}isValid(){for(let nt=0,ot=this.editStacks.length;nt<ot;nt++)if(this._versionIds[nt]!==this.editStacks[nt].versionId)return!1;return!0}}const missingEditStack=new ResourceEditStack("","");missingEditStack.locked=!0;let UndoRedoService=class{constructor(nt,ot){this._dialogService=nt,this._notificationService=ot,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(nt){for(const ot of this._uriComparisonKeyComputers)if(ot[0]===nt.scheme)return ot[1].getComparisonKey(nt);return nt.toString()}_print(nt){console.log("------------------------------------"),console.log(`AFTER ${nt}: `);const ot=[];for(const rt of this._editStacks)ot.push(rt[1].toString());console.log(ot.join(`
`))}pushElement(nt,ot=UndoRedoGroup.None,rt=UndoRedoSource.None){if(nt.type===0){const ut=getResourceLabel(nt.resource),gt=this.getUriComparisonKey(nt.resource);this._pushElement(new ResourceStackElement(nt,ut,gt,ot.id,ot.nextOrder(),rt.id,rt.nextOrder()))}else{const ut=new Set,gt=[],pt=[];for(const mt of nt.resources){const vt=getResourceLabel(mt),St=this.getUriComparisonKey(mt);ut.has(St)||(ut.add(St),gt.push(vt),pt.push(St))}gt.length===1?this._pushElement(new ResourceStackElement(nt,gt[0],pt[0],ot.id,ot.nextOrder(),rt.id,rt.nextOrder())):this._pushElement(new WorkspaceStackElement(nt,gt,pt,ot.id,ot.nextOrder(),rt.id,rt.nextOrder()))}}_pushElement(nt){for(let ot=0,rt=nt.strResources.length;ot<rt;ot++){const ut=nt.resourceLabels[ot],gt=nt.strResources[ot];let pt;this._editStacks.has(gt)?pt=this._editStacks.get(gt):(pt=new ResourceEditStack(ut,gt),this._editStacks.set(gt,pt)),pt.pushElement(nt)}}getLastElement(nt){const ot=this.getUriComparisonKey(nt);if(this._editStacks.has(ot)){const rt=this._editStacks.get(ot);if(rt.hasFutureElements())return null;const ut=rt.getClosestPastElement();return ut?ut.actual:null}return null}_splitPastWorkspaceElement(nt,ot){const rt=nt.actual.split(),ut=new Map;for(const gt of rt){const pt=getResourceLabel(gt.resource),mt=this.getUriComparisonKey(gt.resource),vt=new ResourceStackElement(gt,pt,mt,0,0,0,0);ut.set(vt.strResource,vt)}for(const gt of nt.strResources){if(ot&&ot.has(gt))continue;this._editStacks.get(gt).splitPastWorkspaceElement(nt,ut)}}_splitFutureWorkspaceElement(nt,ot){const rt=nt.actual.split(),ut=new Map;for(const gt of rt){const pt=getResourceLabel(gt.resource),mt=this.getUriComparisonKey(gt.resource),vt=new ResourceStackElement(gt,pt,mt,0,0,0,0);ut.set(vt.strResource,vt)}for(const gt of nt.strResources){if(ot&&ot.has(gt))continue;this._editStacks.get(gt).splitFutureWorkspaceElement(nt,ut)}}removeElements(nt){const ot=typeof nt=="string"?nt:this.getUriComparisonKey(nt);this._editStacks.has(ot)&&(this._editStacks.get(ot).dispose(),this._editStacks.delete(ot))}setElementsValidFlag(nt,ot,rt){const ut=this.getUriComparisonKey(nt);this._editStacks.has(ut)&&this._editStacks.get(ut).setElementsValidFlag(ot,rt)}createSnapshot(nt){const ot=this.getUriComparisonKey(nt);return this._editStacks.has(ot)?this._editStacks.get(ot).createSnapshot(nt):new ResourceEditStackSnapshot(nt,[])}restoreSnapshot(nt){const ot=this.getUriComparisonKey(nt.resource);if(this._editStacks.has(ot)){const rt=this._editStacks.get(ot);rt.restoreSnapshot(nt),!rt.hasPastElements()&&!rt.hasFutureElements()&&(rt.dispose(),this._editStacks.delete(ot))}}getElements(nt){const ot=this.getUriComparisonKey(nt);return this._editStacks.has(ot)?this._editStacks.get(ot).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(nt){if(!nt)return[null,null];let ot=null,rt=null;for(const[ut,gt]of this._editStacks){const pt=gt.getClosestPastElement();pt&&pt.sourceId===nt&&(!ot||pt.sourceOrder>ot.sourceOrder)&&(ot=pt,rt=ut)}return[ot,rt]}canUndo(nt){if(nt instanceof UndoRedoSource){const[,rt]=this._findClosestUndoElementWithSource(nt.id);return!!rt}const ot=this.getUriComparisonKey(nt);return this._editStacks.has(ot)?this._editStacks.get(ot).hasPastElements():!1}_onError(nt,ot){onUnexpectedError(nt);for(const rt of ot.strResources)this.removeElements(rt);this._notificationService.error(nt)}_acquireLocks(nt){for(const ot of nt.editStacks)if(ot.locked)throw new Error("Cannot acquire edit stack lock");for(const ot of nt.editStacks)ot.locked=!0;return()=>{for(const ot of nt.editStacks)ot.locked=!1}}_safeInvokeWithLocks(nt,ot,rt,ut,gt){const pt=this._acquireLocks(rt);let mt;try{mt=ot()}catch(vt){return pt(),ut.dispose(),this._onError(vt,nt)}return mt?mt.then(()=>(pt(),ut.dispose(),gt()),vt=>(pt(),ut.dispose(),this._onError(vt,nt))):(pt(),ut.dispose(),gt())}_invokeWorkspacePrepare(nt){return __awaiter$1f(this,void 0,void 0,function*(){if(typeof nt.actual.prepareUndoRedo>"u")return Disposable.None;const ot=nt.actual.prepareUndoRedo();return typeof ot>"u"?Disposable.None:ot})}_invokeResourcePrepare(nt,ot){if(nt.actual.type!==1||typeof nt.actual.prepareUndoRedo>"u")return ot(Disposable.None);const rt=nt.actual.prepareUndoRedo();return rt?isDisposable(rt)?ot(rt):rt.then(ut=>ot(ut)):ot(Disposable.None)}_getAffectedEditStacks(nt){const ot=[];for(const rt of nt.strResources)ot.push(this._editStacks.get(rt)||missingEditStack);return new EditStackSnapshot(ot)}_tryToSplitAndUndo(nt,ot,rt,ut){if(ot.canSplit())return this._splitPastWorkspaceElement(ot,rt),this._notificationService.warn(ut),new WorkspaceVerificationError(this._undo(nt,0,!0));for(const gt of ot.strResources)this.removeElements(gt);return this._notificationService.warn(ut),new WorkspaceVerificationError}_checkWorkspaceUndo(nt,ot,rt,ut){if(ot.removedResources)return this._tryToSplitAndUndo(nt,ot,ot.removedResources,localize({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",ot.label,ot.removedResources.createMessage()));if(ut&&ot.invalidatedResources)return this._tryToSplitAndUndo(nt,ot,ot.invalidatedResources,localize({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",ot.label,ot.invalidatedResources.createMessage()));const gt=[];for(const mt of rt.editStacks)mt.getClosestPastElement()!==ot&&gt.push(mt.resourceLabel);if(gt.length>0)return this._tryToSplitAndUndo(nt,ot,null,localize({key:"cannotWorkspaceUndoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because changes were made to {1}",ot.label,gt.join(", ")));const pt=[];for(const mt of rt.editStacks)mt.locked&&pt.push(mt.resourceLabel);return pt.length>0?this._tryToSplitAndUndo(nt,ot,null,localize({key:"cannotWorkspaceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",ot.label,pt.join(", "))):rt.isValid()?null:this._tryToSplitAndUndo(nt,ot,null,localize({key:"cannotWorkspaceUndoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",ot.label))}_workspaceUndo(nt,ot,rt){const ut=this._getAffectedEditStacks(ot),gt=this._checkWorkspaceUndo(nt,ot,ut,!1);return gt?gt.returnValue:this._confirmAndExecuteWorkspaceUndo(nt,ot,ut,rt)}_isPartOfUndoGroup(nt){if(!nt.groupId)return!1;for(const[,ot]of this._editStacks){const rt=ot.getClosestPastElement();if(rt){if(rt===nt){const ut=ot.getSecondClosestPastElement();if(ut&&ut.groupId===nt.groupId)return!0}if(rt.groupId===nt.groupId)return!0}}return!1}_confirmAndExecuteWorkspaceUndo(nt,ot,rt,ut){return __awaiter$1f(this,void 0,void 0,function*(){if(ot.canSplit()&&!this._isPartOfUndoGroup(ot)){let mt;(function(yt){yt[yt.All=0]="All",yt[yt.This=1]="This",yt[yt.Cancel=2]="Cancel"})(mt||(mt={}));const{result:vt}=yield this._dialogService.prompt({type:Severity$2.Info,message:localize("confirmWorkspace","Would you like to undo '{0}' across all files?",ot.label),buttons:[{label:localize({key:"ok",comment:["{0} denotes a number that is > 1, && denotes a mnemonic"]},"&&Undo in {0} Files",rt.editStacks.length),run:()=>mt.All},{label:localize({key:"nok",comment:["&& denotes a mnemonic"]},"Undo this &&File"),run:()=>mt.This}],cancelButton:{run:()=>mt.Cancel}});if(vt===mt.Cancel)return;if(vt===mt.This)return this._splitPastWorkspaceElement(ot,null),this._undo(nt,0,!0);const St=this._checkWorkspaceUndo(nt,ot,rt,!1);if(St)return St.returnValue;ut=!0}let gt;try{gt=yield this._invokeWorkspacePrepare(ot)}catch(mt){return this._onError(mt,ot)}const pt=this._checkWorkspaceUndo(nt,ot,rt,!0);if(pt)return gt.dispose(),pt.returnValue;for(const mt of rt.editStacks)mt.moveBackward(ot);return this._safeInvokeWithLocks(ot,()=>ot.actual.undo(),rt,gt,()=>this._continueUndoInGroup(ot.groupId,ut))})}_resourceUndo(nt,ot,rt){if(!ot.isValid){nt.flushAllElements();return}if(nt.locked){const ut=localize({key:"cannotResourceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not undo '{0}' because there is already an undo or redo operation running.",ot.label);this._notificationService.warn(ut);return}return this._invokeResourcePrepare(ot,ut=>(nt.moveBackward(ot),this._safeInvokeWithLocks(ot,()=>ot.actual.undo(),new EditStackSnapshot([nt]),ut,()=>this._continueUndoInGroup(ot.groupId,rt))))}_findClosestUndoElementInGroup(nt){if(!nt)return[null,null];let ot=null,rt=null;for(const[ut,gt]of this._editStacks){const pt=gt.getClosestPastElement();pt&&pt.groupId===nt&&(!ot||pt.groupOrder>ot.groupOrder)&&(ot=pt,rt=ut)}return[ot,rt]}_continueUndoInGroup(nt,ot){if(!nt)return;const[,rt]=this._findClosestUndoElementInGroup(nt);if(rt)return this._undo(rt,0,ot)}undo(nt){if(nt instanceof UndoRedoSource){const[,ot]=this._findClosestUndoElementWithSource(nt.id);return ot?this._undo(ot,nt.id,!1):void 0}return typeof nt=="string"?this._undo(nt,0,!1):this._undo(this.getUriComparisonKey(nt),0,!1)}_undo(nt,ot=0,rt){if(!this._editStacks.has(nt))return;const ut=this._editStacks.get(nt),gt=ut.getClosestPastElement();if(!gt)return;if(gt.groupId){const[mt,vt]=this._findClosestUndoElementInGroup(gt.groupId);if(gt!==mt&&vt)return this._undo(vt,ot,rt)}if((gt.sourceId!==ot||gt.confirmBeforeUndo)&&!rt)return this._confirmAndContinueUndo(nt,ot,gt);try{return gt.type===1?this._workspaceUndo(nt,gt,rt):this._resourceUndo(ut,gt,rt)}finally{}}_confirmAndContinueUndo(nt,ot,rt){return __awaiter$1f(this,void 0,void 0,function*(){if((yield this._dialogService.confirm({message:localize("confirmDifferentSource","Would you like to undo '{0}'?",rt.label),primaryButton:localize({key:"confirmDifferentSource.yes",comment:["&& denotes a mnemonic"]},"&&Yes"),cancelButton:localize("confirmDifferentSource.no","No")})).confirmed)return this._undo(nt,ot,!0)})}_findClosestRedoElementWithSource(nt){if(!nt)return[null,null];let ot=null,rt=null;for(const[ut,gt]of this._editStacks){const pt=gt.getClosestFutureElement();pt&&pt.sourceId===nt&&(!ot||pt.sourceOrder<ot.sourceOrder)&&(ot=pt,rt=ut)}return[ot,rt]}canRedo(nt){if(nt instanceof UndoRedoSource){const[,rt]=this._findClosestRedoElementWithSource(nt.id);return!!rt}const ot=this.getUriComparisonKey(nt);return this._editStacks.has(ot)?this._editStacks.get(ot).hasFutureElements():!1}_tryToSplitAndRedo(nt,ot,rt,ut){if(ot.canSplit())return this._splitFutureWorkspaceElement(ot,rt),this._notificationService.warn(ut),new WorkspaceVerificationError(this._redo(nt));for(const gt of ot.strResources)this.removeElements(gt);return this._notificationService.warn(ut),new WorkspaceVerificationError}_checkWorkspaceRedo(nt,ot,rt,ut){if(ot.removedResources)return this._tryToSplitAndRedo(nt,ot,ot.removedResources,localize({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",ot.label,ot.removedResources.createMessage()));if(ut&&ot.invalidatedResources)return this._tryToSplitAndRedo(nt,ot,ot.invalidatedResources,localize({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",ot.label,ot.invalidatedResources.createMessage()));const gt=[];for(const mt of rt.editStacks)mt.getClosestFutureElement()!==ot&&gt.push(mt.resourceLabel);if(gt.length>0)return this._tryToSplitAndRedo(nt,ot,null,localize({key:"cannotWorkspaceRedoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because changes were made to {1}",ot.label,gt.join(", ")));const pt=[];for(const mt of rt.editStacks)mt.locked&&pt.push(mt.resourceLabel);return pt.length>0?this._tryToSplitAndRedo(nt,ot,null,localize({key:"cannotWorkspaceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",ot.label,pt.join(", "))):rt.isValid()?null:this._tryToSplitAndRedo(nt,ot,null,localize({key:"cannotWorkspaceRedoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",ot.label))}_workspaceRedo(nt,ot){const rt=this._getAffectedEditStacks(ot),ut=this._checkWorkspaceRedo(nt,ot,rt,!1);return ut?ut.returnValue:this._executeWorkspaceRedo(nt,ot,rt)}_executeWorkspaceRedo(nt,ot,rt){return __awaiter$1f(this,void 0,void 0,function*(){let ut;try{ut=yield this._invokeWorkspacePrepare(ot)}catch(pt){return this._onError(pt,ot)}const gt=this._checkWorkspaceRedo(nt,ot,rt,!0);if(gt)return ut.dispose(),gt.returnValue;for(const pt of rt.editStacks)pt.moveForward(ot);return this._safeInvokeWithLocks(ot,()=>ot.actual.redo(),rt,ut,()=>this._continueRedoInGroup(ot.groupId))})}_resourceRedo(nt,ot){if(!ot.isValid){nt.flushAllElements();return}if(nt.locked){const rt=localize({key:"cannotResourceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not redo '{0}' because there is already an undo or redo operation running.",ot.label);this._notificationService.warn(rt);return}return this._invokeResourcePrepare(ot,rt=>(nt.moveForward(ot),this._safeInvokeWithLocks(ot,()=>ot.actual.redo(),new EditStackSnapshot([nt]),rt,()=>this._continueRedoInGroup(ot.groupId))))}_findClosestRedoElementInGroup(nt){if(!nt)return[null,null];let ot=null,rt=null;for(const[ut,gt]of this._editStacks){const pt=gt.getClosestFutureElement();pt&&pt.groupId===nt&&(!ot||pt.groupOrder<ot.groupOrder)&&(ot=pt,rt=ut)}return[ot,rt]}_continueRedoInGroup(nt){if(!nt)return;const[,ot]=this._findClosestRedoElementInGroup(nt);if(ot)return this._redo(ot)}redo(nt){if(nt instanceof UndoRedoSource){const[,ot]=this._findClosestRedoElementWithSource(nt.id);return ot?this._redo(ot):void 0}return typeof nt=="string"?this._redo(nt):this._redo(this.getUriComparisonKey(nt))}_redo(nt){if(!this._editStacks.has(nt))return;const ot=this._editStacks.get(nt),rt=ot.getClosestFutureElement();if(rt){if(rt.groupId){const[ut,gt]=this._findClosestRedoElementInGroup(rt.groupId);if(rt!==ut&&gt)return this._redo(gt)}try{return rt.type===1?this._workspaceRedo(nt,rt):this._resourceRedo(ot,rt)}finally{}}}};UndoRedoService=__decorate$1O([__param$1L(0,IDialogService),__param$1L(1,INotificationService)],UndoRedoService);class WorkspaceVerificationError{constructor(nt){this.returnValue=nt}}registerSingleton(IUndoRedoService,UndoRedoService,1);const IOpenerService=createDecorator("openerService");function matchesScheme(ct,nt){return URI.isUri(ct)?equalsIgnoreCase(ct.scheme,nt):startsWithIgnoreCase(ct,nt+":")}function matchesSomeScheme(ct,...nt){return nt.some(ot=>matchesScheme(ct,ot))}function extractSelection(ct){let nt;const ot=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(ct.fragment);return ot&&(nt={startLineNumber:parseInt(ot[1]),startColumn:ot[2]?parseInt(ot[2]):1,endLineNumber:ot[4]?parseInt(ot[4]):void 0,endColumn:ot[4]?ot[5]?parseInt(ot[5]):1:void 0},ct=ct.with({fragment:""})),{selection:nt,uri:ct}}var __decorate$1N=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1K=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const ILanguageFeatureDebounceService=createDecorator("ILanguageFeatureDebounceService");var IdentityHash;(function(ct){const nt=new WeakMap;let ot=0;function rt(ut){let gt=nt.get(ut);return gt===void 0&&(gt=++ot,nt.set(ut,gt)),gt}ct.of=rt})(IdentityHash||(IdentityHash={}));class FeatureDebounceInformation{constructor(nt,ot,rt,ut,gt,pt){this._logService=nt,this._name=ot,this._registry=rt,this._default=ut,this._min=gt,this._max=pt,this._cache=new LRUCache(50,.7)}_key(nt){return nt.id+this._registry.all(nt).reduce((ot,rt)=>doHash(IdentityHash.of(rt),ot),0)}get(nt){const ot=this._key(nt),rt=this._cache.get(ot);return rt?clamp(rt.value,this._min,this._max):this.default()}update(nt,ot){const rt=this._key(nt);let ut=this._cache.get(rt);ut||(ut=new SlidingWindowAverage(6),this._cache.set(rt,ut));const gt=clamp(ut.update(ot),this._min,this._max);return matchesScheme(nt.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${nt.uri.toString()} is ${gt}ms`),gt}_overall(){const nt=new MovingAverage;for(const[,ot]of this._cache)nt.update(ot.value);return nt.value}default(){const nt=this._overall()|0||this._default;return clamp(nt,this._min,this._max)}}let LanguageFeatureDebounceService=class{constructor(nt){this._logService=nt,this._data=new Map}for(nt,ot,rt){var ut,gt,pt;const mt=(ut=rt==null?void 0:rt.min)!==null&&ut!==void 0?ut:50,vt=(gt=rt==null?void 0:rt.max)!==null&&gt!==void 0?gt:Math.pow(mt,2),St=(pt=rt==null?void 0:rt.key)!==null&&pt!==void 0?pt:void 0,yt=`${IdentityHash.of(nt)},${mt}${St?","+St:""}`;let wt=this._data.get(yt);return wt||(wt=new FeatureDebounceInformation(this._logService,ot,nt,this._overallAverage()|0||mt*1.5,mt,vt),this._data.set(yt,wt)),wt}_overallAverage(){const nt=new MovingAverage;for(const ot of this._data.values())nt.update(ot.default());return nt.value}};LanguageFeatureDebounceService=__decorate$1N([__param$1K(0,ILogService)],LanguageFeatureDebounceService);registerSingleton(ILanguageFeatureDebounceService,LanguageFeatureDebounceService,1);class SparseMultilineTokens{static create(nt,ot){return new SparseMultilineTokens(nt,new SparseMultilineTokensStorage(ot))}get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._endLineNumber}constructor(nt,ot){this._startLineNumber=nt,this._tokens=ot,this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}toString(){return this._tokens.toString(this._startLineNumber)}_updateEndLineNumber(){this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}isEmpty(){return this._tokens.isEmpty()}getLineTokens(nt){return this._startLineNumber<=nt&&nt<=this._endLineNumber?this._tokens.getLineTokens(nt-this._startLineNumber):null}getRange(){const nt=this._tokens.getRange();return nt&&new Range$2(this._startLineNumber+nt.startLineNumber,nt.startColumn,this._startLineNumber+nt.endLineNumber,nt.endColumn)}removeTokens(nt){const ot=nt.startLineNumber-this._startLineNumber,rt=nt.endLineNumber-this._startLineNumber;this._startLineNumber+=this._tokens.removeTokens(ot,nt.startColumn-1,rt,nt.endColumn-1),this._updateEndLineNumber()}split(nt){const ot=nt.startLineNumber-this._startLineNumber,rt=nt.endLineNumber-this._startLineNumber,[ut,gt,pt]=this._tokens.split(ot,nt.startColumn-1,rt,nt.endColumn-1);return[new SparseMultilineTokens(this._startLineNumber,ut),new SparseMultilineTokens(this._startLineNumber+pt,gt)]}applyEdit(nt,ot){const[rt,ut,gt]=countEOL(ot);this.acceptEdit(nt,rt,ut,gt,ot.length>0?ot.charCodeAt(0):0)}acceptEdit(nt,ot,rt,ut,gt){this._acceptDeleteRange(nt),this._acceptInsertText(new Position$1(nt.startLineNumber,nt.startColumn),ot,rt,ut,gt),this._updateEndLineNumber()}_acceptDeleteRange(nt){if(nt.startLineNumber===nt.endLineNumber&&nt.startColumn===nt.endColumn)return;const ot=nt.startLineNumber-this._startLineNumber,rt=nt.endLineNumber-this._startLineNumber;if(rt<0){const gt=rt-ot;this._startLineNumber-=gt;return}const ut=this._tokens.getMaxDeltaLine();if(!(ot>=ut+1)){if(ot<0&&rt>=ut+1){this._startLineNumber=0,this._tokens.clear();return}if(ot<0){const gt=-ot;this._startLineNumber-=gt,this._tokens.acceptDeleteRange(nt.startColumn-1,0,0,rt,nt.endColumn-1)}else this._tokens.acceptDeleteRange(0,ot,nt.startColumn-1,rt,nt.endColumn-1)}}_acceptInsertText(nt,ot,rt,ut,gt){if(ot===0&&rt===0)return;const pt=nt.lineNumber-this._startLineNumber;if(pt<0){this._startLineNumber+=ot;return}const mt=this._tokens.getMaxDeltaLine();pt>=mt+1||this._tokens.acceptInsertText(pt,nt.column-1,ot,rt,ut,gt)}}class SparseMultilineTokensStorage{constructor(nt){this._tokens=nt,this._tokenCount=nt.length/4}toString(nt){const ot=[];for(let rt=0;rt<this._tokenCount;rt++)ot.push(`(${this._getDeltaLine(rt)+nt},${this._getStartCharacter(rt)}-${this._getEndCharacter(rt)})`);return`[${ot.join(",")}]`}getMaxDeltaLine(){const nt=this._getTokenCount();return nt===0?-1:this._getDeltaLine(nt-1)}getRange(){const nt=this._getTokenCount();if(nt===0)return null;const ot=this._getStartCharacter(0),rt=this._getDeltaLine(nt-1),ut=this._getEndCharacter(nt-1);return new Range$2(0,ot+1,rt,ut+1)}_getTokenCount(){return this._tokenCount}_getDeltaLine(nt){return this._tokens[4*nt]}_getStartCharacter(nt){return this._tokens[4*nt+1]}_getEndCharacter(nt){return this._tokens[4*nt+2]}isEmpty(){return this._getTokenCount()===0}getLineTokens(nt){let ot=0,rt=this._getTokenCount()-1;for(;ot<rt;){const ut=ot+Math.floor((rt-ot)/2),gt=this._getDeltaLine(ut);if(gt<nt)ot=ut+1;else if(gt>nt)rt=ut-1;else{let pt=ut;for(;pt>ot&&this._getDeltaLine(pt-1)===nt;)pt--;let mt=ut;for(;mt<rt&&this._getDeltaLine(mt+1)===nt;)mt++;return new SparseLineTokens(this._tokens.subarray(4*pt,4*mt+4))}}return this._getDeltaLine(ot)===nt?new SparseLineTokens(this._tokens.subarray(4*ot,4*ot+4)):null}clear(){this._tokenCount=0}removeTokens(nt,ot,rt,ut){const gt=this._tokens,pt=this._tokenCount;let mt=0,vt=!1,St=0;for(let yt=0;yt<pt;yt++){const wt=4*yt,Lt=gt[wt],xt=gt[wt+1],It=gt[wt+2],kt=gt[wt+3];if((Lt>nt||Lt===nt&&It>=ot)&&(Lt<rt||Lt===rt&&xt<=ut))vt=!0;else{if(mt===0&&(St=Lt),vt){const At=4*mt;gt[At]=Lt-St,gt[At+1]=xt,gt[At+2]=It,gt[At+3]=kt}mt++}}return this._tokenCount=mt,St}split(nt,ot,rt,ut){const gt=this._tokens,pt=this._tokenCount,mt=[],vt=[];let St=mt,yt=0,wt=0;for(let Lt=0;Lt<pt;Lt++){const xt=4*Lt,It=gt[xt],kt=gt[xt+1],At=gt[xt+2],Tt=gt[xt+3];if(It>nt||It===nt&&At>=ot){if(It<rt||It===rt&&kt<=ut)continue;St!==vt&&(St=vt,yt=0,wt=It)}St[yt++]=It-wt,St[yt++]=kt,St[yt++]=At,St[yt++]=Tt}return[new SparseMultilineTokensStorage(new Uint32Array(mt)),new SparseMultilineTokensStorage(new Uint32Array(vt)),wt]}acceptDeleteRange(nt,ot,rt,ut,gt){const pt=this._tokens,mt=this._tokenCount,vt=ut-ot;let St=0,yt=!1;for(let wt=0;wt<mt;wt++){const Lt=4*wt;let xt=pt[Lt],It=pt[Lt+1],kt=pt[Lt+2];const At=pt[Lt+3];if(xt<ot||xt===ot&&kt<=rt){St++;continue}else if(xt===ot&&It<rt)xt===ut&&kt>gt?kt-=gt-rt:kt=rt;else if(xt===ot&&It===rt)if(xt===ut&&kt>gt)kt-=gt-rt;else{yt=!0;continue}else if(xt<ut||xt===ut&&It<gt)if(xt===ut&&kt>gt)xt=ot,It=rt,kt=It+(kt-gt);else{yt=!0;continue}else if(xt>ut){if(vt===0&&!yt){St=mt;break}xt-=vt}else if(xt===ut&&It>=gt)nt&&xt===0&&(It+=nt,kt+=nt),xt-=vt,It-=gt-rt,kt-=gt-rt;else throw new Error("Not possible!");const Tt=4*St;pt[Tt]=xt,pt[Tt+1]=It,pt[Tt+2]=kt,pt[Tt+3]=At,St++}this._tokenCount=St}acceptInsertText(nt,ot,rt,ut,gt,pt){const mt=rt===0&&ut===1&&(pt>=48&&pt<=57||pt>=65&&pt<=90||pt>=97&&pt<=122),vt=this._tokens,St=this._tokenCount;for(let yt=0;yt<St;yt++){const wt=4*yt;let Lt=vt[wt],xt=vt[wt+1],It=vt[wt+2];if(!(Lt<nt||Lt===nt&&It<ot)){if(Lt===nt&&It===ot)if(mt)It+=1;else continue;else if(Lt===nt&&xt<ot&&ot<It)rt===0?It+=ut:It=ot;else{if(Lt===nt&&xt===ot&&mt)continue;if(Lt===nt)if(Lt+=rt,rt===0)xt+=ut,It+=ut;else{const kt=It-xt;xt=gt+(xt-ot),It=xt+kt}else Lt+=rt}vt[wt]=Lt,vt[wt+1]=xt,vt[wt+2]=It}}}}class SparseLineTokens{constructor(nt){this._tokens=nt}getCount(){return this._tokens.length/4}getStartCharacter(nt){return this._tokens[4*nt+1]}getEndCharacter(nt){return this._tokens[4*nt+2]}getMetadata(nt){return this._tokens[4*nt+3]}}var __decorate$1M=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1J=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let SemanticTokensProviderStyling=class{constructor(nt,ot,rt,ut){this._legend=nt,this._themeService=ot,this._languageService=rt,this._logService=ut,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new HashTable}getMetadata(nt,ot,rt){const ut=this._languageService.languageIdCodec.encodeLanguageId(rt),gt=this._hashTable.get(nt,ot,ut);let pt;if(gt)pt=gt.metadata,this._logService.getLevel()===LogLevel.Trace&&this._logService.trace(`SemanticTokensProviderStyling [CACHED] ${nt} / ${ot}: foreground ${TokenMetadata.getForeground(pt)}, fontStyle ${TokenMetadata.getFontStyle(pt).toString(2)}`);else{let mt=this._legend.tokenTypes[nt];const vt=[];if(mt){let St=ot;for(let wt=0;St>0&&wt<this._legend.tokenModifiers.length;wt++)St&1&&vt.push(this._legend.tokenModifiers[wt]),St=St>>1;St>0&&this._logService.getLevel()===LogLevel.Trace&&(this._logService.trace(`SemanticTokensProviderStyling: unknown token modifier index: ${ot.toString(2)} for legend: ${JSON.stringify(this._legend.tokenModifiers)}`),vt.push("not-in-legend"));const yt=this._themeService.getColorTheme().getTokenStyleMetadata(mt,vt,rt);if(typeof yt>"u")pt=2147483647;else{if(pt=0,typeof yt.italic<"u"){const wt=(yt.italic?1:0)<<11;pt|=wt|1}if(typeof yt.bold<"u"){const wt=(yt.bold?2:0)<<11;pt|=wt|2}if(typeof yt.underline<"u"){const wt=(yt.underline?4:0)<<11;pt|=wt|4}if(typeof yt.strikethrough<"u"){const wt=(yt.strikethrough?8:0)<<11;pt|=wt|8}if(yt.foreground){const wt=yt.foreground<<15;pt|=wt|16}pt===0&&(pt=2147483647)}}else this._logService.getLevel()===LogLevel.Trace&&this._logService.trace(`SemanticTokensProviderStyling: unknown token type index: ${nt} for legend: ${JSON.stringify(this._legend.tokenTypes)}`),pt=2147483647,mt="not-in-legend";this._hashTable.add(nt,ot,ut,pt),this._logService.getLevel()===LogLevel.Trace&&this._logService.trace(`SemanticTokensProviderStyling ${nt} (${mt}) / ${ot} (${vt.join(" ")}): foreground ${TokenMetadata.getForeground(pt)}, fontStyle ${TokenMetadata.getFontStyle(pt).toString(2)}`)}return pt}warnOverlappingSemanticTokens(nt,ot){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,console.warn(`Overlapping semantic tokens detected at lineNumber ${nt}, column ${ot}`))}warnInvalidLengthSemanticTokens(nt,ot){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,console.warn(`Semantic token with invalid length detected at lineNumber ${nt}, column ${ot}`))}warnInvalidEditStart(nt,ot,rt,ut,gt){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,console.warn(`Invalid semantic tokens edit detected (previousResultId: ${nt}, resultId: ${ot}) at edit #${rt}: The provided start offset ${ut} is outside the previous data (length ${gt}).`))}};SemanticTokensProviderStyling=__decorate$1M([__param$1J(1,IThemeService),__param$1J(2,ILanguageService),__param$1J(3,ILogService)],SemanticTokensProviderStyling);function toMultilineTokens2(ct,nt,ot){const rt=ct.data,ut=ct.data.length/5|0,gt=Math.max(Math.ceil(ut/1024),400),pt=[];let mt=0,vt=1,St=0;for(;mt<ut;){const yt=mt;let wt=Math.min(yt+gt,ut);if(wt<ut){let Rt=wt;for(;Rt-1>yt&&rt[5*Rt]===0;)Rt--;if(Rt-1===yt){let Nt=wt;for(;Nt+1<ut&&rt[5*Nt]===0;)Nt++;wt=Nt}else wt=Rt}let Lt=new Uint32Array((wt-yt)*4),xt=0,It=0,kt=0,At=0;for(;mt<wt;){const Rt=5*mt,Nt=rt[Rt],Pt=rt[Rt+1],Ft=vt+Nt|0,Kt=Nt===0?St+Pt|0:Pt,Bt=rt[Rt+2],Ut=Kt+Bt|0,qt=rt[Rt+3],Yt=rt[Rt+4];if(Ut<=Kt)nt.warnInvalidLengthSemanticTokens(Ft,Kt+1);else if(kt===Ft&&At>Kt)nt.warnOverlappingSemanticTokens(Ft,Kt+1);else{const Zt=nt.getMetadata(qt,Yt,ot);Zt!==2147483647&&(It===0&&(It=Ft),Lt[xt]=Ft-It,Lt[xt+1]=Kt,Lt[xt+2]=Ut,Lt[xt+3]=Zt,xt+=4,kt=Ft,At=Ut)}vt=Ft,St=Kt,mt++}xt!==Lt.length&&(Lt=Lt.subarray(0,xt));const Tt=SparseMultilineTokens.create(It,Lt);pt.push(Tt)}return pt}class HashTableEntry{constructor(nt,ot,rt,ut){this.tokenTypeIndex=nt,this.tokenModifierSet=ot,this.languageId=rt,this.metadata=ut,this.next=null}}class HashTable{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=HashTable._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<HashTable._SIZES.length?2/3*this._currentLength:0),this._elements=[],HashTable._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(nt,ot){for(let rt=0;rt<ot;rt++)nt[rt]=null}_hash2(nt,ot){return(nt<<5)-nt+ot|0}_hashFunc(nt,ot,rt){return this._hash2(this._hash2(nt,ot),rt)%this._currentLength}get(nt,ot,rt){const ut=this._hashFunc(nt,ot,rt);let gt=this._elements[ut];for(;gt;){if(gt.tokenTypeIndex===nt&&gt.tokenModifierSet===ot&&gt.languageId===rt)return gt;gt=gt.next}return null}add(nt,ot,rt,ut){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const gt=this._elements;this._currentLengthIndex++,this._currentLength=HashTable._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<HashTable._SIZES.length?2/3*this._currentLength:0),this._elements=[],HashTable._nullOutEntries(this._elements,this._currentLength);for(const pt of gt){let mt=pt;for(;mt;){const vt=mt.next;mt.next=null,this._add(mt),mt=vt}}}this._add(new HashTableEntry(nt,ot,rt,ut))}_add(nt){const ot=this._hashFunc(nt.tokenTypeIndex,nt.tokenModifierSet,nt.languageId);nt.next=this._elements[ot],this._elements[ot]=nt}}HashTable._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];const ISemanticTokensStylingService=createDecorator("semanticTokensStylingService");var __decorate$1L=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1I=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let SemanticTokensStylingService=class extends Disposable{constructor(nt,ot,rt){super(),this._themeService=nt,this._logService=ot,this._languageService=rt,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}getStyling(nt){return this._caches.has(nt)||this._caches.set(nt,new SemanticTokensProviderStyling(nt.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(nt)}};SemanticTokensStylingService=__decorate$1L([__param$1I(0,IThemeService),__param$1I(1,ILogService),__param$1I(2,ILanguageService)],SemanticTokensStylingService);registerSingleton(ISemanticTokensStylingService,SemanticTokensStylingService,1);var __awaiter$1e=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const GLOBSTAR="**",GLOB_SPLIT="/",PATH_REGEX="[/\\\\]",NO_PATH_REGEX="[^/\\\\]",ALL_FORWARD_SLASHES=/\//g;function starsToRegExp(ct,nt){switch(ct){case 0:return"";case 1:return`${NO_PATH_REGEX}*?`;default:return`(?:${PATH_REGEX}|${NO_PATH_REGEX}+${PATH_REGEX}${nt?`|${PATH_REGEX}${NO_PATH_REGEX}+`:""})*?`}}function splitGlobAware(ct,nt){if(!ct)return[];const ot=[];let rt=!1,ut=!1,gt="";for(const pt of ct){switch(pt){case nt:if(!rt&&!ut){ot.push(gt),gt="";continue}break;case"{":rt=!0;break;case"}":rt=!1;break;case"[":ut=!0;break;case"]":ut=!1;break}gt+=pt}return gt&&ot.push(gt),ot}function parseRegExp(ct){if(!ct)return"";let nt="";const ot=splitGlobAware(ct,GLOB_SPLIT);if(ot.every(rt=>rt===GLOBSTAR))nt=".*";else{let rt=!1;ot.forEach((ut,gt)=>{if(ut===GLOBSTAR){if(rt)return;nt+=starsToRegExp(2,gt===ot.length-1)}else{let pt=!1,mt="",vt=!1,St="";for(const yt of ut){if(yt!=="}"&&pt){mt+=yt;continue}if(vt&&(yt!=="]"||!St)){let wt;yt==="-"?wt=yt:(yt==="^"||yt==="!")&&!St?wt="^":yt===GLOB_SPLIT?wt="":wt=escapeRegExpCharacters(yt),St+=wt;continue}switch(yt){case"{":pt=!0;continue;case"[":vt=!0;continue;case"}":{const Lt=`(?:${splitGlobAware(mt,",").map(xt=>parseRegExp(xt)).join("|")})`;nt+=Lt,pt=!1,mt="";break}case"]":{nt+="["+St+"]",vt=!1,St="";break}case"?":nt+=NO_PATH_REGEX;continue;case"*":nt+=starsToRegExp(1);continue;default:nt+=escapeRegExpCharacters(yt)}}gt<ot.length-1&&(ot[gt+1]!==GLOBSTAR||gt+2<ot.length)&&(nt+=PATH_REGEX)}rt=ut===GLOBSTAR})}return nt}const T1=/^\*\*\/\*\.[\w\.-]+$/,T2=/^\*\*\/([\w\.-]+)\/?$/,T3=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,T3_2=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,T4=/^\*\*((\/[\w\.-]+)+)\/?$/,T5=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,CACHE=new LRUCache(1e4),FALSE=function(){return!1},NULL=function(){return null};function parsePattern(ct,nt){if(!ct)return NULL;let ot;typeof ct!="string"?ot=ct.pattern:ot=ct,ot=ot.trim();const rt=`${ot}_${!!nt.trimForExclusions}`;let ut=CACHE.get(rt);if(ut)return wrapRelativePattern(ut,ct);let gt;return T1.test(ot)?ut=trivia1(ot.substr(4),ot):(gt=T2.exec(trimForExclusions(ot,nt)))?ut=trivia2(gt[1],ot):(nt.trimForExclusions?T3_2:T3).test(ot)?ut=trivia3(ot,nt):(gt=T4.exec(trimForExclusions(ot,nt)))?ut=trivia4and5(gt[1].substr(1),ot,!0):(gt=T5.exec(trimForExclusions(ot,nt)))?ut=trivia4and5(gt[1],ot,!1):ut=toRegExp(ot),CACHE.set(rt,ut),wrapRelativePattern(ut,ct)}function wrapRelativePattern(ct,nt){if(typeof nt=="string")return ct;const ot=function(rt,ut){return isEqualOrParent(rt,nt.base,!isLinux)?ct(ltrim(rt.substr(nt.base.length),sep),ut):null};return ot.allBasenames=ct.allBasenames,ot.allPaths=ct.allPaths,ot.basenames=ct.basenames,ot.patterns=ct.patterns,ot}function trimForExclusions(ct,nt){return nt.trimForExclusions&&ct.endsWith("/**")?ct.substr(0,ct.length-2):ct}function trivia1(ct,nt){return function(ot,rt){return typeof ot=="string"&&ot.endsWith(ct)?nt:null}}function trivia2(ct,nt){const ot=`/${ct}`,rt=`\\${ct}`,ut=function(pt,mt){return typeof pt!="string"?null:mt?mt===ct?nt:null:pt===ct||pt.endsWith(ot)||pt.endsWith(rt)?nt:null},gt=[ct];return ut.basenames=gt,ut.patterns=[nt],ut.allBasenames=gt,ut}function trivia3(ct,nt){const ot=aggregateBasenameMatches(ct.slice(1,-1).split(",").map(mt=>parsePattern(mt,nt)).filter(mt=>mt!==NULL),ct),rt=ot.length;if(!rt)return NULL;if(rt===1)return ot[0];const ut=function(mt,vt){for(let St=0,yt=ot.length;St<yt;St++)if(ot[St](mt,vt))return ct;return null},gt=ot.find(mt=>!!mt.allBasenames);gt&&(ut.allBasenames=gt.allBasenames);const pt=ot.reduce((mt,vt)=>vt.allPaths?mt.concat(vt.allPaths):mt,[]);return pt.length&&(ut.allPaths=pt),ut}function trivia4and5(ct,nt,ot){const rt=sep===posix.sep,ut=rt?ct:ct.replace(ALL_FORWARD_SLASHES,sep),gt=sep+ut,pt=posix.sep+ct;let mt;return ot?mt=function(vt,St){return typeof vt=="string"&&(vt===ut||vt.endsWith(gt)||!rt&&(vt===ct||vt.endsWith(pt)))?nt:null}:mt=function(vt,St){return typeof vt=="string"&&(vt===ut||!rt&&vt===ct)?nt:null},mt.allPaths=[(ot?"*/":"./")+ct],mt}function toRegExp(ct){try{const nt=new RegExp(`^${parseRegExp(ct)}$`);return function(ot){return nt.lastIndex=0,typeof ot=="string"&&nt.test(ot)?ct:null}}catch{return NULL}}function match(ct,nt,ot){return!ct||typeof nt!="string"?!1:parse$1(ct)(nt,void 0,ot)}function parse$1(ct,nt={}){if(!ct)return FALSE;if(typeof ct=="string"||isRelativePattern(ct)){const ot=parsePattern(ct,nt);if(ot===NULL)return FALSE;const rt=function(ut,gt){return!!ot(ut,gt)};return ot.allBasenames&&(rt.allBasenames=ot.allBasenames),ot.allPaths&&(rt.allPaths=ot.allPaths),rt}return parsedExpression(ct,nt)}function isRelativePattern(ct){const nt=ct;return nt?typeof nt.base=="string"&&typeof nt.pattern=="string":!1}function parsedExpression(ct,nt){const ot=aggregateBasenameMatches(Object.getOwnPropertyNames(ct).map(mt=>parseExpressionPattern(mt,ct[mt],nt)).filter(mt=>mt!==NULL)),rt=ot.length;if(!rt)return NULL;if(!ot.some(mt=>!!mt.requiresSiblings)){if(rt===1)return ot[0];const mt=function(yt,wt){let Lt;for(let xt=0,It=ot.length;xt<It;xt++){const kt=ot[xt](yt,wt);if(typeof kt=="string")return kt;isThenable$1(kt)&&(Lt||(Lt=[]),Lt.push(kt))}return Lt?(()=>__awaiter$1e(this,void 0,void 0,function*(){for(const xt of Lt){const It=yield xt;if(typeof It=="string")return It}return null}))():null},vt=ot.find(yt=>!!yt.allBasenames);vt&&(mt.allBasenames=vt.allBasenames);const St=ot.reduce((yt,wt)=>wt.allPaths?yt.concat(wt.allPaths):yt,[]);return St.length&&(mt.allPaths=St),mt}const ut=function(mt,vt,St){let yt,wt;for(let Lt=0,xt=ot.length;Lt<xt;Lt++){const It=ot[Lt];It.requiresSiblings&&St&&(vt||(vt=basename$1(mt)),yt||(yt=vt.substr(0,vt.length-extname$1(mt).length)));const kt=It(mt,vt,yt,St);if(typeof kt=="string")return kt;isThenable$1(kt)&&(wt||(wt=[]),wt.push(kt))}return wt?(()=>__awaiter$1e(this,void 0,void 0,function*(){for(const Lt of wt){const xt=yield Lt;if(typeof xt=="string")return xt}return null}))():null},gt=ot.find(mt=>!!mt.allBasenames);gt&&(ut.allBasenames=gt.allBasenames);const pt=ot.reduce((mt,vt)=>vt.allPaths?mt.concat(vt.allPaths):mt,[]);return pt.length&&(ut.allPaths=pt),ut}function parseExpressionPattern(ct,nt,ot){if(nt===!1)return NULL;const rt=parsePattern(ct,ot);if(rt===NULL)return NULL;if(typeof nt=="boolean")return rt;if(nt){const ut=nt.when;if(typeof ut=="string"){const gt=(pt,mt,vt,St)=>{if(!St||!rt(pt,mt))return null;const yt=ut.replace("$(basename)",()=>vt),wt=St(yt);return isThenable$1(wt)?wt.then(Lt=>Lt?ct:null):wt?ct:null};return gt.requiresSiblings=!0,gt}}return rt}function aggregateBasenameMatches(ct,nt){const ot=ct.filter(mt=>!!mt.basenames);if(ot.length<2)return ct;const rt=ot.reduce((mt,vt)=>{const St=vt.basenames;return St?mt.concat(St):mt},[]);let ut;if(nt){ut=[];for(let mt=0,vt=rt.length;mt<vt;mt++)ut.push(nt)}else ut=ot.reduce((mt,vt)=>{const St=vt.patterns;return St?mt.concat(St):mt},[]);const gt=function(mt,vt){if(typeof mt!="string")return null;if(!vt){let yt;for(yt=mt.length;yt>0;yt--){const wt=mt.charCodeAt(yt-1);if(wt===47||wt===92)break}vt=mt.substr(yt)}const St=rt.indexOf(vt);return St!==-1?ut[St]:null};gt.basenames=rt,gt.patterns=ut,gt.allBasenames=rt;const pt=ct.filter(mt=>!mt.basenames);return pt.push(gt),pt}function score(ct,nt,ot,rt,ut,gt){if(Array.isArray(ct)){let pt=0;for(const mt of ct){const vt=score(mt,nt,ot,rt,ut,gt);if(vt===10)return vt;vt>pt&&(pt=vt)}return pt}else{if(typeof ct=="string")return rt?ct==="*"?5:ct===ot?10:0:0;if(ct){const{language:pt,pattern:mt,scheme:vt,hasAccessToAllModels:St,notebookType:yt}=ct;if(!rt&&!St)return 0;yt&&ut&&(nt=ut);let wt=0;if(vt)if(vt===nt.scheme)wt=10;else if(vt==="*")wt=5;else return 0;if(pt)if(pt===ot)wt=10;else if(pt==="*")wt=Math.max(wt,5);else return 0;if(yt)if(yt===gt)wt=10;else if(yt==="*"&&gt!==void 0)wt=Math.max(wt,5);else return 0;if(mt){let Lt;if(typeof mt=="string"?Lt=mt:Lt=Object.assign(Object.assign({},mt),{base:normalize(mt.base)}),Lt===nt.fsPath||match(Lt,nt.fsPath))wt=10;else return 0}return wt}else return 0}}function isExclusive(ct){return typeof ct=="string"?!1:Array.isArray(ct)?ct.every(isExclusive):!!ct.exclusive}class MatchCandidate{constructor(nt,ot,rt,ut){this.uri=nt,this.languageId=ot,this.notebookUri=rt,this.notebookType=ut}equals(nt){var ot,rt;return this.notebookType===nt.notebookType&&this.languageId===nt.languageId&&this.uri.toString()===nt.uri.toString()&&((ot=this.notebookUri)===null||ot===void 0?void 0:ot.toString())===((rt=nt.notebookUri)===null||rt===void 0?void 0:rt.toString())}}class LanguageFeatureRegistry{constructor(nt){this._notebookInfoResolver=nt,this._clock=0,this._entries=[],this._onDidChange=new Emitter$2,this.onDidChange=this._onDidChange.event}register(nt,ot){let rt={selector:nt,provider:ot,_score:-1,_time:this._clock++};return this._entries.push(rt),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),toDisposable(()=>{if(rt){const ut=this._entries.indexOf(rt);ut>=0&&(this._entries.splice(ut,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),rt=void 0)}})}has(nt){return this.all(nt).length>0}all(nt){if(!nt)return[];this._updateScores(nt);const ot=[];for(const rt of this._entries)rt._score>0&&ot.push(rt.provider);return ot}ordered(nt){const ot=[];return this._orderedForEach(nt,rt=>ot.push(rt.provider)),ot}orderedGroups(nt){const ot=[];let rt,ut;return this._orderedForEach(nt,gt=>{rt&&ut===gt._score?rt.push(gt.provider):(ut=gt._score,rt=[gt.provider],ot.push(rt))}),ot}_orderedForEach(nt,ot){this._updateScores(nt);for(const rt of this._entries)rt._score>0&&ot(rt)}_updateScores(nt){var ot,rt;const ut=(ot=this._notebookInfoResolver)===null||ot===void 0?void 0:ot.call(this,nt.uri),gt=ut?new MatchCandidate(nt.uri,nt.getLanguageId(),ut.uri,ut.type):new MatchCandidate(nt.uri,nt.getLanguageId(),void 0,void 0);if(!(!((rt=this._lastCandidate)===null||rt===void 0)&&rt.equals(gt))){this._lastCandidate=gt;for(const pt of this._entries)if(pt._score=score(pt.selector,gt.uri,gt.languageId,shouldSynchronizeModel(nt),gt.notebookUri,gt.notebookType),isExclusive(pt.selector)&&pt._score>0){for(const mt of this._entries)mt._score=0;pt._score=1e3;break}this._entries.sort(LanguageFeatureRegistry._compareByScoreAndTime)}}static _compareByScoreAndTime(nt,ot){return nt._score<ot._score?1:nt._score>ot._score?-1:isBuiltinSelector(nt.selector)&&!isBuiltinSelector(ot.selector)?1:!isBuiltinSelector(nt.selector)&&isBuiltinSelector(ot.selector)?-1:nt._time<ot._time?1:nt._time>ot._time?-1:0}}function isBuiltinSelector(ct){return typeof ct=="string"?!1:Array.isArray(ct)?ct.some(isBuiltinSelector):!!ct.isBuiltin}class LanguageFeaturesService{constructor(){this.referenceProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.renameProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.codeActionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.definitionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.typeDefinitionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.declarationProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.implementationProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentSymbolProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.inlayHintsProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.colorProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.codeLensProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentFormattingEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentRangeFormattingEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.onTypeFormattingEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.signatureHelpProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.hoverProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentHighlightProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.selectionRangeProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.foldingRangeProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.linkProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.inlineCompletionsProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.completionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.linkedEditingRangeProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentSemanticTokensProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentOnDropEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentPasteEditProvider=new LanguageFeatureRegistry(this._score.bind(this))}_score(nt){var ot;return(ot=this._notebookTypeResolver)===null||ot===void 0?void 0:ot.call(this,nt)}}registerSingleton(ILanguageFeaturesService,LanguageFeaturesService,1);const IBulkEditService=createDecorator("IWorkspaceEditService");class ResourceEdit{constructor(nt){this.metadata=nt}static convert(nt){return nt.edits.map(ot=>{if(ResourceTextEdit.is(ot))return ResourceTextEdit.lift(ot);if(ResourceFileEdit.is(ot))return ResourceFileEdit.lift(ot);throw new Error("Unsupported edit")})}}class ResourceTextEdit extends ResourceEdit{static is(nt){return nt instanceof ResourceTextEdit?!0:isObject$1(nt)&&URI.isUri(nt.resource)&&isObject$1(nt.textEdit)}static lift(nt){return nt instanceof ResourceTextEdit?nt:new ResourceTextEdit(nt.resource,nt.textEdit,nt.versionId,nt.metadata)}constructor(nt,ot,rt=void 0,ut){super(ut),this.resource=nt,this.textEdit=ot,this.versionId=rt}}class ResourceFileEdit extends ResourceEdit{static is(nt){return nt instanceof ResourceFileEdit?!0:isObject$1(nt)&&(!!nt.newResource||!!nt.oldResource)}static lift(nt){return nt instanceof ResourceFileEdit?nt:new ResourceFileEdit(nt.oldResource,nt.newResource,nt.options,nt.metadata)}constructor(nt,ot,rt={},ut){super(ut),this.oldResource=nt,this.newResource=ot,this.options=rt}}const editorConfigurationBaseNode=Object.freeze({id:"editor",order:5,type:"object",title:localize("editorConfigurationTitle","Editor"),scope:5}),editorConfiguration=Object.assign(Object.assign({},editorConfigurationBaseNode),{properties:{"editor.tabSize":{type:"number",default:EDITOR_MODEL_DEFAULTS.tabSize,minimum:1,markdownDescription:localize("tabSize","The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:localize("indentSize",'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.insertSpaces,markdownDescription:localize("insertSpaces","Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.detectIndentation,markdownDescription:localize("detectIndentation","Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.trimAutoWhitespace,description:localize("trimAutoWhitespace","Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.largeFileOptimizations,description:localize("largeFileOptimizations","Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{type:"boolean",default:!0,description:localize("wordBasedSuggestions","Controls whether completions should be computed based on words in the document.")},"editor.wordBasedSuggestionsMode":{enum:["currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[localize("wordBasedSuggestionsMode.currentDocument","Only suggest words from the active document."),localize("wordBasedSuggestionsMode.matchingDocuments","Suggest words from all open documents of the same language."),localize("wordBasedSuggestionsMode.allDocuments","Suggest words from all open documents.")],description:localize("wordBasedSuggestionsMode","Controls from which documents word based completions are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[localize("semanticHighlighting.true","Semantic highlighting enabled for all color themes."),localize("semanticHighlighting.false","Semantic highlighting disabled for all color themes."),localize("semanticHighlighting.configuredByTheme","Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:localize("semanticHighlighting.enabled","Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:localize("stablePeek","Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:localize("maxTokenizationLineLength","Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!1,description:localize("editor.experimental.asyncTokenization","Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:localize("editor.experimental.asyncTokenizationLogging","Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:localize("editor.experimental.asyncTokenizationVerification","Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only.")},"editor.language.brackets":{type:["array","null"],default:null,description:localize("schema.brackets","Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:localize("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:localize("schema.closeBracket","The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:localize("schema.colorizedBracketPairs","Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:localize("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:localize("schema.closeBracket","The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:5e3,description:localize("maxComputationTime","Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:50,description:localize("maxFileSize","Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:!0,description:localize("sideBySide","Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:!0,description:localize("renderMarginRevertIcon","When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:!0,description:localize("ignoreTrimWhitespace","When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:!0,description:localize("renderIndicators","Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:!1,description:localize("codeLens","Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:"inherit",markdownEnumDescriptions:[localize("wordWrap.off","Lines will never wrap."),localize("wordWrap.on","Lines will wrap at the viewport width."),localize("wordWrap.inherit","Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:"legacy",markdownEnumDescriptions:[localize("diffAlgorithm.legacy","Uses the legacy diffing algorithm."),localize("diffAlgorithm.advanced","Uses the advanced diffing algorithm.")],tags:["experimental"]}}});function isConfigurationPropertySchema(ct){return typeof ct.type<"u"||typeof ct.anyOf<"u"}for(const ct of editorOptionsRegistry){const nt=ct.schema;if(typeof nt<"u")if(isConfigurationPropertySchema(nt))editorConfiguration.properties[`editor.${ct.name}`]=nt;else for(const ot in nt)Object.hasOwnProperty.call(nt,ot)&&(editorConfiguration.properties[ot]=nt[ot])}let cachedEditorConfigurationKeys=null;function getEditorConfigurationKeys(){return cachedEditorConfigurationKeys===null&&(cachedEditorConfigurationKeys=Object.create(null),Object.keys(editorConfiguration.properties).forEach(ct=>{cachedEditorConfigurationKeys[ct]=!0})),cachedEditorConfigurationKeys}function isEditorConfigurationKey(ct){return getEditorConfigurationKeys()[`editor.${ct}`]||!1}function isDiffEditorConfigurationKey(ct){return getEditorConfigurationKeys()[`diffEditor.${ct}`]||!1}const configurationRegistry$1=Registry.as(Extensions$8.Configuration);configurationRegistry$1.registerConfiguration(editorConfiguration);class EditOperation{static insert(nt,ot){return{range:new Range$2(nt.lineNumber,nt.column,nt.lineNumber,nt.column),text:ot,forceMoveMarkers:!0}}static delete(nt){return{range:nt,text:null}}static replace(nt,ot){return{range:nt,text:ot}}static replaceMove(nt,ot){return{range:nt,text:ot,forceMoveMarkers:!0}}}function freeze(ct){return Object.isFrozen(ct)?ct:deepFreeze(ct)}class ConfigurationModel{constructor(nt={},ot=[],rt=[],ut){this._contents=nt,this._keys=ot,this._overrides=rt,this.raw=ut,this.overrideConfigurations=new Map}get rawConfiguration(){var nt;if(!this._rawConfiguration)if(!((nt=this.raw)===null||nt===void 0)&&nt.length){const ot=this.raw.map(rt=>{if(rt instanceof ConfigurationModel)return rt;const ut=new ConfigurationModelParser("");return ut.parseRaw(rt),ut.configurationModel});this._rawConfiguration=ot.reduce((rt,ut)=>ut===rt?ut:rt.merge(ut),ot[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(nt){return nt?getConfigurationValue(this.contents,nt):this.contents}inspect(nt,ot){const rt=this.rawConfiguration.getValue(nt),ut=ot?this.rawConfiguration.getOverrideValue(nt,ot):void 0,gt=ot?this.rawConfiguration.override(ot).getValue(nt):rt;return{value:rt,override:ut,merged:gt}}getOverrideValue(nt,ot){const rt=this.getContentsForOverrideIdentifer(ot);return rt?nt?getConfigurationValue(rt,nt):rt:void 0}override(nt){let ot=this.overrideConfigurations.get(nt);return ot||(ot=this.createOverrideConfigurationModel(nt),this.overrideConfigurations.set(nt,ot)),ot}merge(...nt){var ot,rt;const ut=deepClone(this.contents),gt=deepClone(this.overrides),pt=[...this.keys],mt=!((ot=this.raw)===null||ot===void 0)&&ot.length?[...this.raw]:[this];for(const vt of nt)if(mt.push(...!((rt=vt.raw)===null||rt===void 0)&&rt.length?vt.raw:[vt]),!vt.isEmpty()){this.mergeContents(ut,vt.contents);for(const St of vt.overrides){const[yt]=gt.filter(wt=>equals$2(wt.identifiers,St.identifiers));yt?(this.mergeContents(yt.contents,St.contents),yt.keys.push(...St.keys),yt.keys=distinct(yt.keys)):gt.push(deepClone(St))}for(const St of vt.keys)pt.indexOf(St)===-1&&pt.push(St)}return new ConfigurationModel(ut,pt,gt,mt.every(vt=>vt instanceof ConfigurationModel)?void 0:mt)}createOverrideConfigurationModel(nt){const ot=this.getContentsForOverrideIdentifer(nt);if(!ot||typeof ot!="object"||!Object.keys(ot).length)return this;const rt={};for(const ut of distinct([...Object.keys(this.contents),...Object.keys(ot)])){let gt=this.contents[ut];const pt=ot[ut];pt&&(typeof gt=="object"&&typeof pt=="object"?(gt=deepClone(gt),this.mergeContents(gt,pt)):gt=pt),rt[ut]=gt}return new ConfigurationModel(rt,this.keys,this.overrides)}mergeContents(nt,ot){for(const rt of Object.keys(ot)){if(rt in nt&&isObject$1(nt[rt])&&isObject$1(ot[rt])){this.mergeContents(nt[rt],ot[rt]);continue}nt[rt]=deepClone(ot[rt])}}getContentsForOverrideIdentifer(nt){let ot=null,rt=null;const ut=gt=>{gt&&(rt?this.mergeContents(rt,gt):rt=deepClone(gt))};for(const gt of this.overrides)equals$2(gt.identifiers,[nt])?ot=gt.contents:gt.identifiers.includes(nt)&&ut(gt.contents);return ut(ot),rt}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(nt,ot){this.updateValue(nt,ot,!0)}setValue(nt,ot){this.updateValue(nt,ot,!1)}removeValue(nt){const ot=this.keys.indexOf(nt);ot!==-1&&(this.keys.splice(ot,1),removeFromValueTree(this.contents,nt),OVERRIDE_PROPERTY_REGEX.test(nt)&&this.overrides.splice(this.overrides.findIndex(rt=>equals$2(rt.identifiers,overrideIdentifiersFromKey(nt))),1))}updateValue(nt,ot,rt){addToValueTree(this.contents,nt,ot,ut=>console.error(ut)),rt=rt||this.keys.indexOf(nt)===-1,rt&&this.keys.push(nt),OVERRIDE_PROPERTY_REGEX.test(nt)&&this.overrides.push({identifiers:overrideIdentifiersFromKey(nt),keys:Object.keys(this.contents[nt]),contents:toValuesTree(this.contents[nt],ut=>console.error(ut))})}}class ConfigurationModelParser{constructor(nt){this._name=nt,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||new ConfigurationModel}parseRaw(nt,ot){this._raw=nt;const{contents:rt,keys:ut,overrides:gt,restricted:pt,hasExcludedProperties:mt}=this.doParseRaw(nt,ot);this._configurationModel=new ConfigurationModel(rt,ut,gt,mt?[nt]:void 0),this._restrictedConfigurations=pt||[]}doParseRaw(nt,ot){const rt=Registry.as(Extensions$8.Configuration).getConfigurationProperties(),ut=this.filter(nt,rt,!0,ot);nt=ut.raw;const gt=toValuesTree(nt,vt=>console.error(`Conflict in settings file ${this._name}: ${vt}`)),pt=Object.keys(nt),mt=this.toOverrides(nt,vt=>console.error(`Conflict in settings file ${this._name}: ${vt}`));return{contents:gt,keys:pt,overrides:mt,restricted:ut.restricted,hasExcludedProperties:ut.hasExcludedProperties}}filter(nt,ot,rt,ut){let gt=!1;if(!(ut!=null&&ut.scopes)&&!(ut!=null&&ut.skipRestricted))return{raw:nt,restricted:[],hasExcludedProperties:gt};const pt={},mt=[];for(const vt in nt)if(OVERRIDE_PROPERTY_REGEX.test(vt)&&rt){const St=this.filter(nt[vt],ot,!1,ut);pt[vt]=St.raw,gt=gt||St.hasExcludedProperties,mt.push(...St.restricted)}else{const St=ot[vt],yt=St?typeof St.scope<"u"?St.scope:3:void 0;St!=null&&St.restricted&&mt.push(vt),(yt===void 0||ut.scopes===void 0||ut.scopes.includes(yt))&&!(ut.skipRestricted&&(St!=null&&St.restricted))?pt[vt]=nt[vt]:gt=!0}return{raw:pt,restricted:mt,hasExcludedProperties:gt}}toOverrides(nt,ot){const rt=[];for(const ut of Object.keys(nt))if(OVERRIDE_PROPERTY_REGEX.test(ut)){const gt={};for(const pt in nt[ut])gt[pt]=nt[ut][pt];rt.push({identifiers:overrideIdentifiersFromKey(ut),keys:Object.keys(gt),contents:toValuesTree(gt,ot)})}return rt}}class ConfigurationInspectValue{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt,xt){this.key=nt,this.overrides=ot,this._value=rt,this.overrideIdentifiers=ut,this.defaultConfiguration=gt,this.policyConfiguration=pt,this.applicationConfiguration=mt,this.userConfiguration=vt,this.localUserConfiguration=St,this.remoteUserConfiguration=yt,this.workspaceConfiguration=wt,this.folderConfigurationModel=Lt,this.memoryConfigurationModel=xt}inspect(nt,ot,rt){const ut=nt.inspect(ot,rt);return{get value(){return freeze(ut.value)},get override(){return freeze(ut.override)},get merged(){return freeze(ut.merged)}}}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.inspect(this.userConfiguration,this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.userInspectValue.value!==void 0||this.userInspectValue.override!==void 0?{value:this.userInspectValue.value,override:this.userInspectValue.override}:void 0}}class Configuration{constructor(nt,ot,rt,ut,gt=new ConfigurationModel,pt=new ConfigurationModel,mt=new ResourceMap,vt=new ConfigurationModel,St=new ResourceMap){this._defaultConfiguration=nt,this._policyConfiguration=ot,this._applicationConfiguration=rt,this._localUserConfiguration=ut,this._remoteUserConfiguration=gt,this._workspaceConfiguration=pt,this._folderConfigurations=mt,this._memoryConfiguration=vt,this._memoryConfigurationByResource=St,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new ResourceMap,this._userConfiguration=null}getValue(nt,ot,rt){return this.getConsolidatedConfigurationModel(nt,ot,rt).getValue(nt)}updateValue(nt,ot,rt={}){let ut;rt.resource?(ut=this._memoryConfigurationByResource.get(rt.resource),ut||(ut=new ConfigurationModel,this._memoryConfigurationByResource.set(rt.resource,ut))):ut=this._memoryConfiguration,ot===void 0?ut.removeValue(nt):ut.setValue(nt,ot),rt.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(nt,ot,rt){const ut=this.getConsolidatedConfigurationModel(nt,ot,rt),gt=this.getFolderConfigurationModelForResource(ot.resource,rt),pt=ot.resource?this._memoryConfigurationByResource.get(ot.resource)||this._memoryConfiguration:this._memoryConfiguration,mt=new Set;for(const vt of ut.overrides)for(const St of vt.identifiers)ut.getOverrideValue(nt,St)!==void 0&&mt.add(St);return new ConfigurationInspectValue(nt,ot,ut.getValue(nt),mt.size?[...mt]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,rt?this._workspaceConfiguration:void 0,gt||void 0,pt)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(nt,ot,rt){let ut=this.getConsolidatedConfigurationModelForResource(ot,rt);return ot.overrideIdentifier&&(ut=ut.override(ot.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(nt)!==void 0&&(ut=ut.merge(this._policyConfiguration)),ut}getConsolidatedConfigurationModelForResource({resource:nt},ot){let rt=this.getWorkspaceConsolidatedConfiguration();if(ot&&nt){const ut=ot.getFolder(nt);ut&&(rt=this.getFolderConsolidatedConfiguration(ut.uri)||rt);const gt=this._memoryConfigurationByResource.get(nt);gt&&(rt=rt.merge(gt))}return rt}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(nt){let ot=this._foldersConsolidatedConfigurations.get(nt);if(!ot){const rt=this.getWorkspaceConsolidatedConfiguration(),ut=this._folderConfigurations.get(nt);ut?(ot=rt.merge(ut),this._foldersConsolidatedConfigurations.set(nt,ot)):ot=rt}return ot}getFolderConfigurationModelForResource(nt,ot){if(ot&&nt){const rt=ot.getFolder(nt);if(rt)return this._folderConfigurations.get(rt.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((nt,ot)=>{const{contents:rt,overrides:ut,keys:gt}=this._folderConfigurations.get(ot);return nt.push([ot,{contents:rt,overrides:ut,keys:gt}]),nt},[])}}static parse(nt){const ot=this.parseConfigurationModel(nt.defaults),rt=this.parseConfigurationModel(nt.policy),ut=this.parseConfigurationModel(nt.application),gt=this.parseConfigurationModel(nt.user),pt=this.parseConfigurationModel(nt.workspace),mt=nt.folders.reduce((vt,St)=>(vt.set(URI.revive(St[0]),this.parseConfigurationModel(St[1])),vt),new ResourceMap);return new Configuration(ot,rt,ut,gt,new ConfigurationModel,pt,mt,new ConfigurationModel,new ResourceMap)}static parseConfigurationModel(nt){return new ConfigurationModel(nt.contents,nt.keys,nt.overrides)}}class ConfigurationChangeEvent{constructor(nt,ot,rt,ut){this.change=nt,this.previous=ot,this.currentConfiguraiton=rt,this.currentWorkspace=ut,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=".".charCodeAt(0),this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const gt of nt.keys)this.affectedKeys.add(gt);for(const[,gt]of nt.overrides)for(const pt of gt)this.affectedKeys.add(pt);this._affectsConfigStr=this._marker;for(const gt of this.affectedKeys)this._affectsConfigStr+=gt+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=Configuration.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(nt,ot){var rt;const ut=this._marker+nt,gt=this._affectsConfigStr.indexOf(ut);if(gt<0)return!1;const pt=gt+ut.length;if(pt>=this._affectsConfigStr.length)return!1;const mt=this._affectsConfigStr.charCodeAt(pt);if(mt!==this._markerCode1&&mt!==this._markerCode2)return!1;if(ot){const vt=this.previousConfiguration?this.previousConfiguration.getValue(nt,ot,(rt=this.previous)===null||rt===void 0?void 0:rt.workspace):void 0,St=this.currentConfiguraiton.getValue(nt,ot,this.currentWorkspace);return!equals$1(vt,St)}return!0}}const HIGH_FREQ_COMMANDS=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class AbstractKeybindingService extends Disposable{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:Event.None}get inChordMode(){return this._currentChords.length>0}constructor(nt,ot,rt,ut,gt){super(),this._contextKeyService=nt,this._commandService=ot,this._telemetryService=rt,this._notificationService=ut,this._logService=gt,this._onDidUpdateKeybindings=this._register(new Emitter$2),this._currentChords=[],this._currentChordChecker=new IntervalTimer,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new TimeoutTimer,this._logging=!1}dispose(){super.dispose()}_log(nt){this._logging&&this._logService.info(`[KeybindingService]: ${nt}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(nt,ot){const rt=this._getResolver().lookupPrimaryKeybinding(nt,ot||this._contextKeyService);if(rt)return rt.resolvedKeybinding}dispatchEvent(nt,ot){return this._dispatch(nt,ot)}softDispatch(nt,ot){this._log("/ Soft dispatching keyboard event");const rt=this.resolveKeyboardEvent(nt);if(rt.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),null;const[ut]=rt.getDispatchChords();if(ut===null)return this._log("\\ Keyboard event cannot be dispatched"),null;const gt=this._contextKeyService.getContext(ot),pt=this._currentChords.map(({keypress:mt})=>mt);return this._getResolver().resolve(gt,pt,ut)}_scheduleLeaveChordMode(){const nt=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-nt>5e3&&this._leaveChordMode()},500)}_expectAnotherChord(nt,ot){switch(this._currentChords.push({keypress:nt,label:ot}),this._currentChords.length){case 0:throw illegalState("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(localize("first.chord","({0}) was pressed. Waiting for second key of chord...",ot));break;default:{const rt=this._currentChords.map(({label:ut})=>ut).join(", ");this._currentChordStatusMessage=this._notificationService.status(localize("next.chord","({0}) was pressed. Waiting for next key of chord...",rt))}}this._scheduleLeaveChordMode(),IME.enabled&&IME.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],IME.enable()}_dispatch(nt,ot){return this._doDispatch(this.resolveKeyboardEvent(nt),ot,!1)}_singleModifierDispatch(nt,ot){const rt=this.resolveKeyboardEvent(nt),[ut]=rt.getSingleModifierDispatchChords();if(ut)return this._ignoreSingleModifiers.has(ut)?(this._log(`+ Ignoring single modifier ${ut} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${ut}.`),this._currentSingleModifier=ut,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):ut===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${ut} ${ut}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(rt,ot,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${ut}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[gt]=rt.getChords();return this._ignoreSingleModifiers=new KeybindingModifierSet(gt),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(nt,ot,rt=!1){var ut;let gt=!1;if(nt.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let pt=null,mt=null;if(rt){const[wt]=nt.getSingleModifierDispatchChords();pt=wt,mt=wt?[wt]:[]}else[pt]=nt.getDispatchChords(),mt=this._currentChords.map(({keypress:wt})=>wt);if(pt===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),gt;const vt=this._contextKeyService.getContext(ot),St=nt.getLabel(),yt=this._getResolver().resolve(vt,mt,pt);switch(yt.kind){case 0:{if(this._logService.trace("KeybindingService#dispatch",St,"[ No matching keybinding ]"),this.inChordMode){const wt=this._currentChords.map(({label:Lt})=>Lt).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${wt}, ${St}".`),this._notificationService.status(localize("missing.chord","The key combination ({0}, {1}) is not a command.",wt,St),{hideAfter:10*1e3}),this._leaveChordMode(),gt=!0}return gt}case 1:return this._logService.trace("KeybindingService#dispatch",St,"[ Several keybindings match - more chords needed ]"),gt=!0,this._expectAnotherChord(pt,St),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),gt;case 2:{if(this._logService.trace("KeybindingService#dispatch",St,`[ Will dispatch command ${yt.commandId} ]`),yt.commandId===null){if(this.inChordMode){const wt=this._currentChords.map(({label:Lt})=>Lt).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${wt}, ${St}".`),this._notificationService.status(localize("missing.chord","The key combination ({0}, {1}) is not a command.",wt,St),{hideAfter:10*1e3}),this._leaveChordMode()}gt=!0}else this.inChordMode&&this._leaveChordMode(),yt.isBubble||(gt=!0),this._log(`+ Invoking command ${yt.commandId}.`),typeof yt.commandArgs>"u"?this._commandService.executeCommand(yt.commandId).then(void 0,wt=>this._notificationService.warn(wt)):this._commandService.executeCommand(yt.commandId,yt.commandArgs).then(void 0,wt=>this._notificationService.warn(wt)),HIGH_FREQ_COMMANDS.test(yt.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:yt.commandId,from:"keybinding",detail:(ut=nt.getUserSettingsLabel())!==null&&ut!==void 0?ut:void 0});return gt}}}mightProducePrintableCharacter(nt){return nt.ctrlKey||nt.metaKey?!1:nt.keyCode>=31&&nt.keyCode<=56||nt.keyCode>=21&&nt.keyCode<=30}}class KeybindingModifierSet{constructor(nt){this._ctrlKey=nt?nt.ctrlKey:!1,this._shiftKey=nt?nt.shiftKey:!1,this._altKey=nt?nt.altKey:!1,this._metaKey=nt?nt.metaKey:!1}has(nt){switch(nt){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}}KeybindingModifierSet.EMPTY=new KeybindingModifierSet(null);const IKeybindingService=createDecorator("keybindingService"),NoMatchingKb={kind:0},MoreChordsNeeded={kind:1};function KbFound(ct,nt,ot){return{kind:2,commandId:ct,commandArgs:nt,isBubble:ot}}class KeybindingResolver{constructor(nt,ot,rt){var ut;this._log=rt,this._defaultKeybindings=nt,this._defaultBoundCommands=new Map;for(const gt of nt){const pt=gt.command;pt&&pt.charAt(0)!=="-"&&this._defaultBoundCommands.set(pt,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=KeybindingResolver.handleRemovals([].concat(nt).concat(ot));for(let gt=0,pt=this._keybindings.length;gt<pt;gt++){const mt=this._keybindings[gt];if(mt.chords.length===0)continue;const vt=(ut=mt.when)===null||ut===void 0?void 0:ut.substituteConstants();vt&&vt.type===0||this._addKeyPress(mt.chords[0],mt)}}static _isTargetedForRemoval(nt,ot,rt){if(ot){for(let ut=0;ut<ot.length;ut++)if(ot[ut]!==nt.chords[ut])return!1}return!(rt&&rt.type!==1&&(!nt.when||!expressionsAreEqualWithConstantSubstitution(rt,nt.when)))}static handleRemovals(nt){const ot=new Map;for(let ut=0,gt=nt.length;ut<gt;ut++){const pt=nt[ut];if(pt.command&&pt.command.charAt(0)==="-"){const mt=pt.command.substring(1);ot.has(mt)?ot.get(mt).push(pt):ot.set(mt,[pt])}}if(ot.size===0)return nt;const rt=[];for(let ut=0,gt=nt.length;ut<gt;ut++){const pt=nt[ut];if(!pt.command||pt.command.length===0){rt.push(pt);continue}if(pt.command.charAt(0)==="-")continue;const mt=ot.get(pt.command);if(!mt||!pt.isDefault){rt.push(pt);continue}let vt=!1;for(const St of mt){const yt=St.when;if(this._isTargetedForRemoval(pt,St.chords,yt)){vt=!0;break}}if(!vt){rt.push(pt);continue}}return rt}_addKeyPress(nt,ot){const rt=this._map.get(nt);if(typeof rt>"u"){this._map.set(nt,[ot]),this._addToLookupMap(ot);return}for(let ut=rt.length-1;ut>=0;ut--){const gt=rt[ut];if(gt.command===ot.command)continue;let pt=!0;for(let mt=1;mt<gt.chords.length&&mt<ot.chords.length;mt++)if(gt.chords[mt]!==ot.chords[mt]){pt=!1;break}pt&&KeybindingResolver.whenIsEntirelyIncluded(gt.when,ot.when)&&this._removeFromLookupMap(gt)}rt.push(ot),this._addToLookupMap(ot)}_addToLookupMap(nt){if(!nt.command)return;let ot=this._lookupMap.get(nt.command);typeof ot>"u"?(ot=[nt],this._lookupMap.set(nt.command,ot)):ot.push(nt)}_removeFromLookupMap(nt){if(!nt.command)return;const ot=this._lookupMap.get(nt.command);if(!(typeof ot>"u")){for(let rt=0,ut=ot.length;rt<ut;rt++)if(ot[rt]===nt){ot.splice(rt,1);return}}}static whenIsEntirelyIncluded(nt,ot){return!ot||ot.type===1?!0:!nt||nt.type===1?!1:implies(nt,ot)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(nt,ot){const rt=this._lookupMap.get(nt);if(typeof rt>"u"||rt.length===0)return null;if(rt.length===1)return rt[0];for(let ut=rt.length-1;ut>=0;ut--){const gt=rt[ut];if(ot.contextMatchesRules(gt.when))return gt}return rt[rt.length-1]}resolve(nt,ot,rt){const ut=[...ot,rt];this._log(`| Resolving ${ut}`);const gt=this._map.get(ut[0]);if(gt===void 0)return this._log("\\ No keybinding entries."),NoMatchingKb;let pt=null;if(ut.length<2)pt=gt;else{pt=[];for(let vt=0,St=gt.length;vt<St;vt++){const yt=gt[vt];if(ut.length>yt.chords.length)continue;let wt=!0;for(let Lt=1;Lt<ut.length;Lt++)if(yt.chords[Lt]!==ut[Lt]){wt=!1;break}wt&&pt.push(yt)}}const mt=this._findCommand(nt,pt);return mt?ut.length<mt.chords.length?(this._log(`\\ From ${pt.length} keybinding entries, awaiting ${mt.chords.length-ut.length} more chord(s), when: ${printWhenExplanation(mt.when)}, source: ${printSourceExplanation(mt)}.`),MoreChordsNeeded):(this._log(`\\ From ${pt.length} keybinding entries, matched ${mt.command}, when: ${printWhenExplanation(mt.when)}, source: ${printSourceExplanation(mt)}.`),KbFound(mt.command,mt.commandArgs,mt.bubble)):(this._log(`\\ From ${pt.length} keybinding entries, no when clauses matched the context.`),NoMatchingKb)}_findCommand(nt,ot){for(let rt=ot.length-1;rt>=0;rt--){const ut=ot[rt];if(KeybindingResolver._contextMatchesRules(nt,ut.when))return ut}return null}static _contextMatchesRules(nt,ot){return ot?ot.evaluate(nt):!0}}function printWhenExplanation(ct){return ct?`${ct.serialize()}`:"no when condition"}function printSourceExplanation(ct){return ct.extensionId?ct.isBuiltinExtension?`built-in extension ${ct.extensionId}`:`user extension ${ct.extensionId}`:ct.isDefault?"built-in":"user"}class ResolvedKeybindingItem{constructor(nt,ot,rt,ut,gt,pt,mt){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=nt,this.chords=nt?toEmptyArrayIfContainsNull(nt.getDispatchChords()):[],nt&&this.chords.length===0&&(this.chords=toEmptyArrayIfContainsNull(nt.getSingleModifierDispatchChords())),this.bubble=ot?ot.charCodeAt(0)===94:!1,this.command=this.bubble?ot.substr(1):ot,this.commandArgs=rt,this.when=ut,this.isDefault=gt,this.extensionId=pt,this.isBuiltinExtension=mt}}function toEmptyArrayIfContainsNull(ct){const nt=[];for(let ot=0,rt=ct.length;ot<rt;ot++){const ut=ct[ot];if(!ut)return[];nt.push(ut)}return nt}class ModifierLabelProvider{constructor(nt,ot,rt=ot){this.modifierLabels=[null],this.modifierLabels[2]=nt,this.modifierLabels[1]=ot,this.modifierLabels[3]=rt}toLabel(nt,ot,rt){if(ot.length===0)return null;const ut=[];for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt],vt=rt(mt);if(vt===null)return null;ut[gt]=_simpleAsString(mt,vt,this.modifierLabels[nt])}return ut.join(" ")}}const UILabelProvider=new ModifierLabelProvider({ctrlKey:"",shiftKey:"",altKey:"",metaKey:"",separator:""},{ctrlKey:localize({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:localize({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:localize({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:localize({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),AriaLabelProvider=new ModifierLabelProvider({ctrlKey:localize({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:localize({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:localize({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:localize({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:localize({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:localize({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:localize({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),ElectronAcceleratorLabelProvider=new ModifierLabelProvider({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),UserSettingsLabelProvider=new ModifierLabelProvider({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function _simpleAsString(ct,nt,ot){if(nt===null)return"";const rt=[];return ct.ctrlKey&&rt.push(ot.ctrlKey),ct.shiftKey&&rt.push(ot.shiftKey),ct.altKey&&rt.push(ot.altKey),ct.metaKey&&rt.push(ot.metaKey),nt!==""&&rt.push(nt),rt.join(ot.separator)}class BaseResolvedKeybinding extends ResolvedKeybinding{constructor(nt,ot){if(super(),ot.length===0)throw illegalArgument("chords");this._os=nt,this._chords=ot}getLabel(){return UILabelProvider.toLabel(this._os,this._chords,nt=>this._getLabel(nt))}getAriaLabel(){return AriaLabelProvider.toLabel(this._os,this._chords,nt=>this._getAriaLabel(nt))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:ElectronAcceleratorLabelProvider.toLabel(this._os,this._chords,nt=>this._getElectronAccelerator(nt))}getUserSettingsLabel(){return UserSettingsLabelProvider.toLabel(this._os,this._chords,nt=>this._getUserSettingsLabel(nt))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map(nt=>this._getChord(nt))}_getChord(nt){return new ResolvedChord(nt.ctrlKey,nt.shiftKey,nt.altKey,nt.metaKey,this._getLabel(nt),this._getAriaLabel(nt))}getDispatchChords(){return this._chords.map(nt=>this._getChordDispatch(nt))}getSingleModifierDispatchChords(){return this._chords.map(nt=>this._getSingleModifierChordDispatch(nt))}}class USLayoutResolvedKeybinding extends BaseResolvedKeybinding{constructor(nt,ot){super(ot,nt)}_keyCodeToUILabel(nt){if(this._os===2)switch(nt){case 15:return"";case 16:return"";case 17:return"";case 18:return""}return KeyCodeUtils.toString(nt)}_getLabel(nt){return nt.isDuplicateModifierCase()?"":this._keyCodeToUILabel(nt.keyCode)}_getAriaLabel(nt){return nt.isDuplicateModifierCase()?"":KeyCodeUtils.toString(nt.keyCode)}_getElectronAccelerator(nt){return KeyCodeUtils.toElectronAccelerator(nt.keyCode)}_getUserSettingsLabel(nt){if(nt.isDuplicateModifierCase())return"";const ot=KeyCodeUtils.toUserSettingsUS(nt.keyCode);return ot&&ot.toLowerCase()}_getChordDispatch(nt){return USLayoutResolvedKeybinding.getDispatchStr(nt)}static getDispatchStr(nt){if(nt.isModifierKey())return null;let ot="";return nt.ctrlKey&&(ot+="ctrl+"),nt.shiftKey&&(ot+="shift+"),nt.altKey&&(ot+="alt+"),nt.metaKey&&(ot+="meta+"),ot+=KeyCodeUtils.toString(nt.keyCode),ot}_getSingleModifierChordDispatch(nt){return nt.keyCode===5&&!nt.shiftKey&&!nt.altKey&&!nt.metaKey?"ctrl":nt.keyCode===4&&!nt.ctrlKey&&!nt.altKey&&!nt.metaKey?"shift":nt.keyCode===6&&!nt.ctrlKey&&!nt.shiftKey&&!nt.metaKey?"alt":nt.keyCode===57&&!nt.ctrlKey&&!nt.shiftKey&&!nt.altKey?"meta":null}static _scanCodeToKeyCode(nt){const ot=IMMUTABLE_CODE_TO_KEY_CODE[nt];if(ot!==-1)return ot;switch(nt){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(nt){if(!nt)return null;if(nt instanceof KeyCodeChord)return nt;const ot=this._scanCodeToKeyCode(nt.scanCode);return ot===0?null:new KeyCodeChord(nt.ctrlKey,nt.shiftKey,nt.altKey,nt.metaKey,ot)}static resolveKeybinding(nt,ot){const rt=toEmptyArrayIfContainsNull(nt.chords.map(ut=>this._toKeyCodeChord(ut)));return rt.length>0?[new USLayoutResolvedKeybinding(rt,ot)]:[]}}const ILabelService=createDecorator("labelService");class StringIterator{constructor(){this._value="",this._pos=0}reset(nt){return this._value=nt,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(nt){const ot=nt.charCodeAt(0),rt=this._value.charCodeAt(this._pos);return ot-rt}value(){return this._value[this._pos]}}class ConfigKeysIterator{constructor(nt=!0){this._caseSensitive=nt}reset(nt){return this._value=nt,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let nt=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(nt)this._from++;else break;else nt=!1;return this}cmp(nt){return this._caseSensitive?compareSubstring(nt,this._value,0,nt.length,this._from,this._to):compareSubstringIgnoreCase(nt,this._value,0,nt.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class PathIterator{constructor(nt=!0,ot=!0){this._splitOnBackslash=nt,this._caseSensitive=ot}reset(nt){this._from=0,this._to=0,this._value=nt,this._valueLen=nt.length;for(let ot=nt.length-1;ot>=0;ot--,this._valueLen--){const rt=this._value.charCodeAt(ot);if(!(rt===47||this._splitOnBackslash&&rt===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let nt=!0;for(;this._to<this._valueLen;this._to++){const ot=this._value.charCodeAt(this._to);if(ot===47||this._splitOnBackslash&&ot===92)if(nt)this._from++;else break;else nt=!1}return this}cmp(nt){return this._caseSensitive?compareSubstring(nt,this._value,0,nt.length,this._from,this._to):compareSubstringIgnoreCase(nt,this._value,0,nt.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class UriIterator{constructor(nt,ot){this._ignorePathCasing=nt,this._ignoreQueryAndFragment=ot,this._states=[],this._stateIdx=0}reset(nt){return this._value=nt,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new PathIterator(!1,!this._ignorePathCasing(nt)),this._pathIterator.reset(nt.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(nt)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(nt){if(this._states[this._stateIdx]===1)return compareIgnoreCase(nt,this._value.scheme);if(this._states[this._stateIdx]===2)return compareIgnoreCase(nt,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(nt);if(this._states[this._stateIdx]===4)return compare(nt,this._value.query);if(this._states[this._stateIdx]===5)return compare(nt,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class TernarySearchTreeNode{constructor(){this.height=1}rotateLeft(){const nt=this.right;return this.right=nt.left,nt.left=this,this.updateHeight(),nt.updateHeight(),nt}rotateRight(){const nt=this.left;return this.left=nt.right,nt.right=this,this.updateHeight(),nt.updateHeight(),nt}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var nt,ot;return(ot=(nt=this.left)===null||nt===void 0?void 0:nt.height)!==null&&ot!==void 0?ot:0}get heightRight(){var nt,ot;return(ot=(nt=this.right)===null||nt===void 0?void 0:nt.height)!==null&&ot!==void 0?ot:0}}class TernarySearchTree{static forUris(nt=()=>!1,ot=()=>!1){return new TernarySearchTree(new UriIterator(nt,ot))}static forStrings(){return new TernarySearchTree(new StringIterator)}static forConfigKeys(){return new TernarySearchTree(new ConfigKeysIterator)}constructor(nt){this._iter=nt}clear(){this._root=void 0}set(nt,ot){const rt=this._iter.reset(nt);let ut;this._root||(this._root=new TernarySearchTreeNode,this._root.segment=rt.value());const gt=[];for(ut=this._root;;){const mt=rt.cmp(ut.segment);if(mt>0)ut.left||(ut.left=new TernarySearchTreeNode,ut.left.segment=rt.value()),gt.push([-1,ut]),ut=ut.left;else if(mt<0)ut.right||(ut.right=new TernarySearchTreeNode,ut.right.segment=rt.value()),gt.push([1,ut]),ut=ut.right;else if(rt.hasNext())rt.next(),ut.mid||(ut.mid=new TernarySearchTreeNode,ut.mid.segment=rt.value()),gt.push([0,ut]),ut=ut.mid;else break}const pt=ut.value;ut.value=ot,ut.key=nt;for(let mt=gt.length-1;mt>=0;mt--){const vt=gt[mt][1];vt.updateHeight();const St=vt.balanceFactor();if(St<-1||St>1){const yt=gt[mt][0],wt=gt[mt+1][0];if(yt===1&&wt===1)gt[mt][1]=vt.rotateLeft();else if(yt===-1&&wt===-1)gt[mt][1]=vt.rotateRight();else if(yt===1&&wt===-1)vt.right=gt[mt+1][1]=gt[mt+1][1].rotateRight(),gt[mt][1]=vt.rotateLeft();else if(yt===-1&&wt===1)vt.left=gt[mt+1][1]=gt[mt+1][1].rotateLeft(),gt[mt][1]=vt.rotateRight();else throw new Error;if(mt>0)switch(gt[mt-1][0]){case-1:gt[mt-1][1].left=gt[mt][1];break;case 1:gt[mt-1][1].right=gt[mt][1];break;case 0:gt[mt-1][1].mid=gt[mt][1];break}else this._root=gt[0][1]}}return pt}get(nt){var ot;return(ot=this._getNode(nt))===null||ot===void 0?void 0:ot.value}_getNode(nt){const ot=this._iter.reset(nt);let rt=this._root;for(;rt;){const ut=ot.cmp(rt.segment);if(ut>0)rt=rt.left;else if(ut<0)rt=rt.right;else if(ot.hasNext())ot.next(),rt=rt.mid;else break}return rt}has(nt){const ot=this._getNode(nt);return!((ot==null?void 0:ot.value)===void 0&&(ot==null?void 0:ot.mid)===void 0)}delete(nt){return this._delete(nt,!1)}deleteSuperstr(nt){return this._delete(nt,!0)}_delete(nt,ot){var rt;const ut=this._iter.reset(nt),gt=[];let pt=this._root;for(;pt;){const mt=ut.cmp(pt.segment);if(mt>0)gt.push([-1,pt]),pt=pt.left;else if(mt<0)gt.push([1,pt]),pt=pt.right;else if(ut.hasNext())ut.next(),gt.push([0,pt]),pt=pt.mid;else break}if(pt){if(ot?(pt.left=void 0,pt.mid=void 0,pt.right=void 0,pt.height=1):(pt.key=void 0,pt.value=void 0),!pt.mid&&!pt.value)if(pt.left&&pt.right){const mt=this._min(pt.right);if(mt.key){const{key:vt,value:St,segment:yt}=mt;this._delete(mt.key,!1),pt.key=vt,pt.value=St,pt.segment=yt}}else{const mt=(rt=pt.left)!==null&&rt!==void 0?rt:pt.right;if(gt.length>0){const[vt,St]=gt[gt.length-1];switch(vt){case-1:St.left=mt;break;case 0:St.mid=mt;break;case 1:St.right=mt;break}}else this._root=mt}for(let mt=gt.length-1;mt>=0;mt--){const vt=gt[mt][1];vt.updateHeight();const St=vt.balanceFactor();if(St>1?(vt.right.balanceFactor()>=0||(vt.right=vt.right.rotateRight()),gt[mt][1]=vt.rotateLeft()):St<-1&&(vt.left.balanceFactor()<=0||(vt.left=vt.left.rotateLeft()),gt[mt][1]=vt.rotateRight()),mt>0)switch(gt[mt-1][0]){case-1:gt[mt-1][1].left=gt[mt][1];break;case 1:gt[mt-1][1].right=gt[mt][1];break;case 0:gt[mt-1][1].mid=gt[mt][1];break}else this._root=gt[0][1]}}}_min(nt){for(;nt.left;)nt=nt.left;return nt}findSubstr(nt){const ot=this._iter.reset(nt);let rt=this._root,ut;for(;rt;){const gt=ot.cmp(rt.segment);if(gt>0)rt=rt.left;else if(gt<0)rt=rt.right;else if(ot.hasNext())ot.next(),ut=rt.value||ut,rt=rt.mid;else break}return rt&&rt.value||ut}findSuperstr(nt){return this._findSuperstrOrElement(nt,!1)}_findSuperstrOrElement(nt,ot){const rt=this._iter.reset(nt);let ut=this._root;for(;ut;){const gt=rt.cmp(ut.segment);if(gt>0)ut=ut.left;else if(gt<0)ut=ut.right;else if(rt.hasNext())rt.next(),ut=ut.mid;else return ut.mid?this._entries(ut.mid):ot?ut.value:void 0}}forEach(nt){for(const[ot,rt]of this)nt(rt,ot)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(nt){const ot=[];return this._dfsEntries(nt,ot),ot[Symbol.iterator]()}_dfsEntries(nt,ot){nt&&(nt.left&&this._dfsEntries(nt.left,ot),nt.value&&ot.push([nt.key,nt.value]),nt.mid&&this._dfsEntries(nt.mid,ot),nt.right&&this._dfsEntries(nt.right,ot))}}const IWorkspaceContextService=createDecorator("contextService");function isSingleFolderWorkspaceIdentifier(ct){const nt=ct;return typeof(nt==null?void 0:nt.id)=="string"&&URI.isUri(nt.uri)}function isEmptyWorkspaceIdentifier(ct){const nt=ct;return typeof(nt==null?void 0:nt.id)=="string"&&!isSingleFolderWorkspaceIdentifier(ct)&&!isWorkspaceIdentifier(ct)}const EXTENSION_DEVELOPMENT_EMPTY_WINDOW_WORKSPACE={id:"ext-dev"},UNKNOWN_EMPTY_WINDOW_WORKSPACE={id:"empty-window"};function toWorkspaceIdentifier(ct,nt){if(typeof ct=="string"||typeof ct>"u")return typeof ct=="string"?{id:basename$1(ct)}:nt?EXTENSION_DEVELOPMENT_EMPTY_WINDOW_WORKSPACE:UNKNOWN_EMPTY_WINDOW_WORKSPACE;const ot=ct;return ot.configuration?{id:ot.id,configPath:ot.configuration}:ot.folders.length===1?{id:ot.id,uri:ot.folders[0].uri}:{id:ot.id}}function isWorkspaceIdentifier(ct){const nt=ct;return typeof(nt==null?void 0:nt.id)=="string"&&URI.isUri(nt.configPath)}class WorkspaceFolder{constructor(nt,ot){this.raw=ot,this.uri=nt.uri,this.index=nt.index,this.name=nt.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const WORKSPACE_EXTENSION="code-workspace";localize("codeWorkspace","Code Workspace");const STANDALONE_EDITOR_WORKSPACE_ID="4064f6ec-cb38-4ad0-af64-ee6467e63c82";function isStandaloneEditorWorkspace(ct){return ct.id===STANDALONE_EDITOR_WORKSPACE_ID}var AccessibilityHelpNLS;(function(ct){ct.noSelection=localize("noSelection","No selection"),ct.singleSelectionRange=localize("singleSelectionRange","Line {0}, Column {1} ({2} selected)"),ct.singleSelection=localize("singleSelection","Line {0}, Column {1}"),ct.multiSelectionRange=localize("multiSelectionRange","{0} selections ({1} characters selected)"),ct.multiSelection=localize("multiSelection","{0} selections"),ct.emergencyConfOn=localize("emergencyConfOn","Now changing the setting `accessibilitySupport` to 'on'."),ct.openingDocs=localize("openingDocs","Now opening the Editor Accessibility documentation page."),ct.readonlyDiffEditor=localize("readonlyDiffEditor"," in a read-only pane of a diff editor."),ct.editableDiffEditor=localize("editableDiffEditor"," in a pane of a diff editor."),ct.readonlyEditor=localize("readonlyEditor"," in a read-only code editor"),ct.editableEditor=localize("editableEditor"," in a code editor"),ct.changeConfigToOnMac=localize("changeConfigToOnMac","To configure the editor to be optimized for usage with a Screen Reader press Command+E now."),ct.changeConfigToOnWinLinux=localize("changeConfigToOnWinLinux","To configure the editor to be optimized for usage with a Screen Reader press Control+E now."),ct.auto_on=localize("auto_on","The editor is configured to be optimized for usage with a Screen Reader."),ct.auto_off=localize("auto_off","The editor is configured to never be optimized for usage with a Screen Reader, which is not the case at this time."),ct.tabFocusModeOnMsg=localize("tabFocusModeOnMsg","Pressing Tab in the current editor will move focus to the next focusable element. Toggle this behavior by pressing {0}."),ct.tabFocusModeOnMsgNoKb=localize("tabFocusModeOnMsgNoKb","Pressing Tab in the current editor will move focus to the next focusable element. The command {0} is currently not triggerable by a keybinding."),ct.tabFocusModeOffMsg=localize("tabFocusModeOffMsg","Pressing Tab in the current editor will insert the tab character. Toggle this behavior by pressing {0}."),ct.tabFocusModeOffMsgNoKb=localize("tabFocusModeOffMsgNoKb","Pressing Tab in the current editor will insert the tab character. The command {0} is currently not triggerable by a keybinding."),ct.openDocMac=localize("openDocMac","Press Command+H now to open a browser window with more information related to editor accessibility."),ct.openDocWinLinux=localize("openDocWinLinux","Press Control+H now to open a browser window with more information related to editor accessibility."),ct.outroMsg=localize("outroMsg","You can dismiss this tooltip and return to the editor by pressing Escape or Shift+Escape."),ct.showAccessibilityHelpAction=localize("showAccessibilityHelpAction","Show Accessibility Help"),ct.accessibilityHelpTitle=localize("accessibilityHelpTitle","Accessibility Help")})(AccessibilityHelpNLS||(AccessibilityHelpNLS={}));var InspectTokensNLS;(function(ct){ct.inspectTokensAction=localize("inspectTokens","Developer: Inspect Tokens")})(InspectTokensNLS||(InspectTokensNLS={}));var GoToLineNLS;(function(ct){ct.gotoLineActionLabel=localize("gotoLineActionLabel","Go to Line/Column...")})(GoToLineNLS||(GoToLineNLS={}));var QuickHelpNLS;(function(ct){ct.helpQuickAccessActionLabel=localize("helpQuickAccess","Show all Quick Access Providers")})(QuickHelpNLS||(QuickHelpNLS={}));var QuickCommandNLS;(function(ct){ct.quickCommandActionLabel=localize("quickCommandActionLabel","Command Palette"),ct.quickCommandHelp=localize("quickCommandActionHelp","Show And Run Commands")})(QuickCommandNLS||(QuickCommandNLS={}));var QuickOutlineNLS;(function(ct){ct.quickOutlineActionLabel=localize("quickOutlineActionLabel","Go to Symbol..."),ct.quickOutlineByCategoryActionLabel=localize("quickOutlineByCategoryActionLabel","Go to Symbol by Category...")})(QuickOutlineNLS||(QuickOutlineNLS={}));var StandaloneCodeEditorNLS;(function(ct){ct.editorViewAccessibleLabel=localize("editorViewAccessibleLabel","Editor content"),ct.accessibilityHelpMessage=localize("accessibilityHelpMessage","Press Alt+F1 for Accessibility Options.")})(StandaloneCodeEditorNLS||(StandaloneCodeEditorNLS={}));var ToggleHighContrastNLS;(function(ct){ct.toggleHighContrast=localize("toggleHighContrast","Toggle High Contrast Theme")})(ToggleHighContrastNLS||(ToggleHighContrastNLS={}));var StandaloneServicesNLS;(function(ct){ct.bulkEditServiceSummary=localize("bulkEditServiceSummary","Made {0} edits in {1} files")})(StandaloneServicesNLS||(StandaloneServicesNLS={}));const IWorkspaceTrustManagementService=createDecorator("workspaceTrustManagementService"),contextview="";var LayoutAnchorMode;(function(ct){ct[ct.AVOID=0]="AVOID",ct[ct.ALIGN=1]="ALIGN"})(LayoutAnchorMode||(LayoutAnchorMode={}));function layout(ct,nt,ot){const rt=ot.mode===LayoutAnchorMode.ALIGN?ot.offset:ot.offset+ot.size,ut=ot.mode===LayoutAnchorMode.ALIGN?ot.offset+ot.size:ot.offset;return ot.position===0?nt<=ct-rt?rt:nt<=ut?ut-nt:Math.max(ct-nt,0):nt<=ut?ut-nt:nt<=ct-rt?rt:0}class ContextView extends Disposable{constructor(nt,ot){super(),this.container=null,this.delegate=null,this.toDisposeOnClean=Disposable.None,this.toDisposeOnSetContainer=Disposable.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=$$d(".context-view"),this.useFixedPosition=!1,this.useShadowDOM=!1,hide(this.view),this.setContainer(nt,ot),this._register(toDisposable(()=>this.setContainer(null,1)))}setContainer(nt,ot){var rt;if(this.container&&(this.toDisposeOnSetContainer.dispose(),this.shadowRoot?(this.shadowRoot.removeChild(this.view),this.shadowRoot=null,(rt=this.shadowRootHostElement)===null||rt===void 0||rt.remove(),this.shadowRootHostElement=null):this.container.removeChild(this.view),this.container=null),nt){if(this.container=nt,this.useFixedPosition=ot!==1,this.useShadowDOM=ot===3,this.useShadowDOM){this.shadowRootHostElement=$$d(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const gt=document.createElement("style");gt.textContent=SHADOW_ROOT_CSS,this.shadowRoot.appendChild(gt),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild($$d("slot"))}else this.container.appendChild(this.view);const ut=new DisposableStore;ContextView.BUBBLE_UP_EVENTS.forEach(gt=>{ut.add(addStandardDisposableListener(this.container,gt,pt=>{this.onDOMEvent(pt,!1)}))}),ContextView.BUBBLE_DOWN_EVENTS.forEach(gt=>{ut.add(addStandardDisposableListener(this.container,gt,pt=>{this.onDOMEvent(pt,!0)},!0))}),this.toDisposeOnSetContainer=ut}}show(nt){var ot,rt;this.isVisible()&&this.hide(),clearNode(this.view),this.view.className="context-view",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex="2575",this.view.style.position=this.useFixedPosition?"fixed":"absolute",show(this.view),this.toDisposeOnClean=nt.render(this.view)||Disposable.None,this.delegate=nt,this.doLayout(),(rt=(ot=this.delegate).focus)===null||rt===void 0||rt.call(ot)}getViewElement(){return this.view}layout(){if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(isIOS&&BrowserFeatures.pointerEvents)){this.hide();return}this.delegate.layout&&this.delegate.layout(),this.doLayout()}}doLayout(){if(!this.isVisible())return;const nt=this.delegate.getAnchor();let ot;if(isHTMLElement(nt)){const wt=getDomNodePagePosition(nt),Lt=getDomNodeZoomLevel(nt);ot={top:wt.top*Lt,left:wt.left*Lt,width:wt.width*Lt,height:wt.height*Lt}}else ot={top:nt.y,left:nt.x,width:nt.width||1,height:nt.height||2};const rt=getTotalWidth(this.view),ut=getTotalHeight(this.view),gt=this.delegate.anchorPosition||0,pt=this.delegate.anchorAlignment||0,mt=this.delegate.anchorAxisAlignment||0;let vt,St;if(mt===0){const wt={offset:ot.top-window.pageYOffset,size:ot.height,position:gt===0?0:1},Lt={offset:ot.left,size:ot.width,position:pt===0?0:1,mode:LayoutAnchorMode.ALIGN};vt=layout(window.innerHeight,ut,wt)+window.pageYOffset,Range$1.intersects({start:vt,end:vt+ut},{start:wt.offset,end:wt.offset+wt.size})&&(Lt.mode=LayoutAnchorMode.AVOID),St=layout(window.innerWidth,rt,Lt)}else{const wt={offset:ot.left,size:ot.width,position:pt===0?0:1},Lt={offset:ot.top,size:ot.height,position:gt===0?0:1,mode:LayoutAnchorMode.ALIGN};St=layout(window.innerWidth,rt,wt),Range$1.intersects({start:St,end:St+rt},{start:wt.offset,end:wt.offset+wt.size})&&(Lt.mode=LayoutAnchorMode.AVOID),vt=layout(window.innerHeight,ut,Lt)+window.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(gt===0?"bottom":"top"),this.view.classList.add(pt===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const yt=getDomNodePagePosition(this.container);this.view.style.top=`${vt-(this.useFixedPosition?getDomNodePagePosition(this.view).top:yt.top)}px`,this.view.style.left=`${St-(this.useFixedPosition?getDomNodePagePosition(this.view).left:yt.left)}px`,this.view.style.width="initial"}hide(nt){const ot=this.delegate;this.delegate=null,ot!=null&&ot.onHide&&ot.onHide(nt),this.toDisposeOnClean.dispose(),hide(this.view)}isVisible(){return!!this.delegate}onDOMEvent(nt,ot){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(nt,document.activeElement):ot&&!isAncestor$1(nt.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}}ContextView.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"];ContextView.BUBBLE_DOWN_EVENTS=["click"];const SHADOW_ROOT_CSS=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var __decorate$1K=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1H=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let ContextViewService=class extends Disposable{constructor(nt){super(),this.layoutService=nt,this.currentViewDisposable=Disposable.None,this.container=nt.hasContainer?nt.container:null,this.contextView=this._register(new ContextView(this.container,1)),this.layout(),this._register(nt.onDidLayout(()=>this.layout()))}setContainer(nt,ot){this.contextView.setContainer(nt,ot||1)}showContextView(nt,ot,rt){ot?(ot!==this.container||this.shadowRoot!==rt)&&(this.container=ot,this.setContainer(ot,rt?3:2)):this.layoutService.hasContainer&&this.container!==this.layoutService.container&&(this.container=this.layoutService.container,this.setContainer(this.container,1)),this.shadowRoot=rt,this.contextView.show(nt);const ut=toDisposable(()=>{this.currentViewDisposable===ut&&this.hideContextView()});return this.currentViewDisposable=ut,ut}getContextViewElement(){return this.contextView.getViewElement()}layout(){this.contextView.layout()}hideContextView(nt){this.contextView.hide(nt)}};ContextViewService=__decorate$1K([__param$1H(0,ILayoutService)],ContextViewService);let registeredAssociations=[],nonUserRegisteredAssociations=[],userRegisteredAssociations=[];function registerPlatformLanguageAssociation(ct,nt=!1){_registerLanguageAssociation(ct,!1,nt)}function _registerLanguageAssociation(ct,nt,ot){const rt=toLanguageAssociationItem(ct,nt);registeredAssociations.push(rt),rt.userConfigured?userRegisteredAssociations.push(rt):nonUserRegisteredAssociations.push(rt),ot&&!rt.userConfigured&&registeredAssociations.forEach(ut=>{ut.mime===rt.mime||ut.userConfigured||(rt.extension&&ut.extension===rt.extension&&console.warn(`Overwriting extension <<${rt.extension}>> to now point to mime <<${rt.mime}>>`),rt.filename&&ut.filename===rt.filename&&console.warn(`Overwriting filename <<${rt.filename}>> to now point to mime <<${rt.mime}>>`),rt.filepattern&&ut.filepattern===rt.filepattern&&console.warn(`Overwriting filepattern <<${rt.filepattern}>> to now point to mime <<${rt.mime}>>`),rt.firstline&&ut.firstline===rt.firstline&&console.warn(`Overwriting firstline <<${rt.firstline}>> to now point to mime <<${rt.mime}>>`))})}function toLanguageAssociationItem(ct,nt){return{id:ct.id,mime:ct.mime,filename:ct.filename,extension:ct.extension,filepattern:ct.filepattern,firstline:ct.firstline,userConfigured:nt,filenameLowercase:ct.filename?ct.filename.toLowerCase():void 0,extensionLowercase:ct.extension?ct.extension.toLowerCase():void 0,filepatternLowercase:ct.filepattern?parse$1(ct.filepattern.toLowerCase()):void 0,filepatternOnPath:ct.filepattern?ct.filepattern.indexOf(posix.sep)>=0:!1}}function clearPlatformLanguageAssociations(){registeredAssociations=registeredAssociations.filter(ct=>ct.userConfigured),nonUserRegisteredAssociations=[]}function getLanguageIds(ct,nt){return getAssociations(ct,nt).map(ot=>ot.id)}function getAssociations(ct,nt){let ot;if(ct)switch(ct.scheme){case Schemas.file:ot=ct.fsPath;break;case Schemas.data:{ot=DataUri.parseMetaData(ct).get(DataUri.META_DATA_LABEL);break}case Schemas.vscodeNotebookCell:ot=void 0;break;default:ot=ct.path}if(!ot)return[{id:"unknown",mime:Mimes.unknown}];ot=ot.toLowerCase();const rt=basename$1(ot),ut=getAssociationByPath(ot,rt,userRegisteredAssociations);if(ut)return[ut,{id:PLAINTEXT_LANGUAGE_ID,mime:Mimes.text}];const gt=getAssociationByPath(ot,rt,nonUserRegisteredAssociations);if(gt)return[gt,{id:PLAINTEXT_LANGUAGE_ID,mime:Mimes.text}];if(nt){const pt=getAssociationByFirstline(nt);if(pt)return[pt,{id:PLAINTEXT_LANGUAGE_ID,mime:Mimes.text}]}return[{id:"unknown",mime:Mimes.unknown}]}function getAssociationByPath(ct,nt,ot){var rt;let ut,gt,pt;for(let mt=ot.length-1;mt>=0;mt--){const vt=ot[mt];if(nt===vt.filenameLowercase){ut=vt;break}if(vt.filepattern&&(!gt||vt.filepattern.length>gt.filepattern.length)){const St=vt.filepatternOnPath?ct:nt;!((rt=vt.filepatternLowercase)===null||rt===void 0)&&rt.call(vt,St)&&(gt=vt)}vt.extension&&(!pt||vt.extension.length>pt.extension.length)&&nt.endsWith(vt.extensionLowercase)&&(pt=vt)}if(ut)return ut;if(gt)return gt;if(pt)return pt}function getAssociationByFirstline(ct){if(startsWithUTF8BOM(ct)&&(ct=ct.substr(1)),ct.length>0)for(let nt=registeredAssociations.length-1;nt>=0;nt--){const ot=registeredAssociations[nt];if(!ot.firstline)continue;const rt=ct.match(ot.firstline);if(rt&&rt.length>0)return ot}}const hasOwnProperty=Object.prototype.hasOwnProperty,NULL_LANGUAGE_ID="vs.editor.nullLanguage";class LanguageIdCodec{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(NULL_LANGUAGE_ID,0),this._register(PLAINTEXT_LANGUAGE_ID,1),this._nextLanguageId=2}_register(nt,ot){this._languageIdToLanguage[ot]=nt,this._languageToLanguageId.set(nt,ot)}register(nt){if(this._languageToLanguageId.has(nt))return;const ot=this._nextLanguageId++;this._register(nt,ot)}encodeLanguageId(nt){return this._languageToLanguageId.get(nt)||0}decodeLanguageId(nt){return this._languageIdToLanguage[nt]||NULL_LANGUAGE_ID}}class LanguagesRegistry extends Disposable{constructor(nt=!0,ot=!1){super(),this._onDidChange=this._register(new Emitter$2),this.onDidChange=this._onDidChange.event,LanguagesRegistry.instanceCount++,this._warnOnOverwrite=ot,this.languageIdCodec=new LanguageIdCodec,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},nt&&(this._initializeFromRegistry(),this._register(ModesRegistry.onDidChangeLanguages(rt=>{this._initializeFromRegistry()})))}dispose(){LanguagesRegistry.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},clearPlatformLanguageAssociations();const nt=[].concat(ModesRegistry.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(nt)}_registerLanguages(nt){for(const ot of nt)this._registerLanguage(ot);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(ot=>{const rt=this._languages[ot];rt.name&&(this._nameMap[rt.name]=rt.identifier),rt.aliases.forEach(ut=>{this._lowercaseNameMap[ut.toLowerCase()]=rt.identifier}),rt.mimetypes.forEach(ut=>{this._mimeTypesMap[ut]=rt.identifier})}),Registry.as(Extensions$8.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(nt){const ot=nt.id;let rt;hasOwnProperty.call(this._languages,ot)?rt=this._languages[ot]:(this.languageIdCodec.register(ot),rt={identifier:ot,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[ot]=rt),this._mergeLanguage(rt,nt)}_mergeLanguage(nt,ot){const rt=ot.id;let ut=null;if(Array.isArray(ot.mimetypes)&&ot.mimetypes.length>0&&(nt.mimetypes.push(...ot.mimetypes),ut=ot.mimetypes[0]),ut||(ut=`text/x-${rt}`,nt.mimetypes.push(ut)),Array.isArray(ot.extensions)){ot.configuration?nt.extensions=ot.extensions.concat(nt.extensions):nt.extensions=nt.extensions.concat(ot.extensions);for(const mt of ot.extensions)registerPlatformLanguageAssociation({id:rt,mime:ut,extension:mt},this._warnOnOverwrite)}if(Array.isArray(ot.filenames))for(const mt of ot.filenames)registerPlatformLanguageAssociation({id:rt,mime:ut,filename:mt},this._warnOnOverwrite),nt.filenames.push(mt);if(Array.isArray(ot.filenamePatterns))for(const mt of ot.filenamePatterns)registerPlatformLanguageAssociation({id:rt,mime:ut,filepattern:mt},this._warnOnOverwrite);if(typeof ot.firstLine=="string"&&ot.firstLine.length>0){let mt=ot.firstLine;mt.charAt(0)!=="^"&&(mt="^"+mt);try{const vt=new RegExp(mt);regExpLeadsToEndlessLoop(vt)||registerPlatformLanguageAssociation({id:rt,mime:ut,firstline:vt},this._warnOnOverwrite)}catch(vt){console.warn(`[${ot.id}]: Invalid regular expression \`${mt}\`: `,vt)}}nt.aliases.push(rt);let gt=null;if(typeof ot.aliases<"u"&&Array.isArray(ot.aliases)&&(ot.aliases.length===0?gt=[null]:gt=ot.aliases),gt!==null)for(const mt of gt)!mt||mt.length===0||nt.aliases.push(mt);const pt=gt!==null&&gt.length>0;if(!(pt&&gt[0]===null)){const mt=(pt?gt[0]:null)||rt;(pt||!nt.name)&&(nt.name=mt)}ot.configuration&&nt.configurationFiles.push(ot.configuration),ot.icon&&nt.icons.push(ot.icon)}isRegisteredLanguageId(nt){return nt?hasOwnProperty.call(this._languages,nt):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(nt){const ot=nt.toLowerCase();return hasOwnProperty.call(this._lowercaseNameMap,ot)?this._lowercaseNameMap[ot]:null}getLanguageIdByMimeType(nt){return nt&&hasOwnProperty.call(this._mimeTypesMap,nt)?this._mimeTypesMap[nt]:null}guessLanguageIdByFilepathOrFirstLine(nt,ot){return!nt&&!ot?[]:getLanguageIds(nt,ot)}}LanguagesRegistry.instanceCount=0;class LanguageService extends Disposable{constructor(nt=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new Emitter$2),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new Emitter$2),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new Emitter$2({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,LanguageService.instanceCount++,this._registry=this._register(new LanguagesRegistry(!0,nt)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){LanguageService.instanceCount--,super.dispose()}isRegisteredLanguageId(nt){return this._registry.isRegisteredLanguageId(nt)}getLanguageIdByLanguageName(nt){return this._registry.getLanguageIdByLanguageName(nt)}getLanguageIdByMimeType(nt){return this._registry.getLanguageIdByMimeType(nt)}guessLanguageIdByFilepathOrFirstLine(nt,ot){const rt=this._registry.guessLanguageIdByFilepathOrFirstLine(nt,ot);return firstOrDefault(rt,null)}createById(nt){return new LanguageSelection(this.onDidChange,()=>this._createAndGetLanguageIdentifier(nt))}createByFilepathOrFirstLine(nt,ot){return new LanguageSelection(this.onDidChange,()=>{const rt=this.guessLanguageIdByFilepathOrFirstLine(nt,ot);return this._createAndGetLanguageIdentifier(rt)})}_createAndGetLanguageIdentifier(nt){return(!nt||!this.isRegisteredLanguageId(nt))&&(nt=PLAINTEXT_LANGUAGE_ID),nt}requestBasicLanguageFeatures(nt){this._requestedBasicLanguages.has(nt)||(this._requestedBasicLanguages.add(nt),this._onDidRequestBasicLanguageFeatures.fire(nt))}requestRichLanguageFeatures(nt){this._requestedRichLanguages.has(nt)||(this._requestedRichLanguages.add(nt),this.requestBasicLanguageFeatures(nt),TokenizationRegistry.getOrCreate(nt),this._onDidRequestRichLanguageFeatures.fire(nt))}}LanguageService.instanceCount=0;class LanguageSelection{constructor(nt,ot){this._onDidChangeLanguages=nt,this._selector=ot,this._listener=null,this._emitter=null,this.languageId=this._selector()}_dispose(){this._listener&&(this._listener.dispose(),this._listener=null),this._emitter&&(this._emitter.dispose(),this._emitter=null)}get onDidChange(){return this._listener||(this._listener=this._onDidChangeLanguages(()=>this._evaluate())),this._emitter||(this._emitter=new Emitter$2({onDidRemoveLastListener:()=>{this._dispose()}})),this._emitter.event}_evaluate(){var nt;const ot=this._selector();ot!==this.languageId&&(this.languageId=ot,(nt=this._emitter)===null||nt===void 0||nt.fire(this.languageId))}}const dropdown="";class BaseDropdown extends ActionRunner{constructor(nt,ot){super(),this._onDidChangeVisibility=this._register(new Emitter$2),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=append$1(nt,$$d(".monaco-dropdown")),this._label=append$1(this._element,$$d(".dropdown-label"));let rt=ot.labelRenderer;rt||(rt=gt=>(gt.textContent=ot.label||"",null));for(const gt of[EventType$1.CLICK,EventType$1.MOUSE_DOWN,EventType.Tap])this._register(addDisposableListener(this.element,gt,pt=>EventHelper.stop(pt,!0)));for(const gt of[EventType$1.MOUSE_DOWN,EventType.Tap])this._register(addDisposableListener(this._label,gt,pt=>{pt instanceof MouseEvent&&(pt.detail>1||pt.button!==0)||(this.visible?this.hide():this.show())}));this._register(addDisposableListener(this._label,EventType$1.KEY_UP,gt=>{const pt=new StandardKeyboardEvent(gt);(pt.equals(3)||pt.equals(10))&&(EventHelper.stop(gt,!0),this.visible?this.hide():this.show())}));const ut=rt(this._label);ut&&this._register(ut),this._register(Gesture.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class DropdownMenu extends BaseDropdown{constructor(nt,ot){super(nt,ot),this._actions=[],this._contextMenuProvider=ot.contextMenuProvider,this.actions=ot.actions||[],this.actionProvider=ot.actionProvider,this.menuClassName=ot.menuClassName||"",this.menuAsChild=!!ot.menuAsChild}set menuOptions(nt){this._menuOptions=nt}get menuOptions(){return this._menuOptions}get actions(){return this.actionProvider?this.actionProvider.getActions():this._actions}set actions(nt){this._actions=nt}show(){super.show(),this.element.classList.add("active"),this._contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(nt,ot)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(nt,ot):void 0,getKeyBinding:nt=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(nt):void 0,getMenuClassName:()=>this.menuClassName,onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this.menuAsChild?this.element:void 0})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class DropdownMenuActionViewItem extends BaseActionViewItem{constructor(nt,ot,rt,ut=Object.create(null)){super(null,nt,ut),this.actionItem=null,this._onDidChangeVisibility=this._register(new Emitter$2),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this.menuActionsOrProvider=ot,this.contextMenuProvider=rt,this.options=ut,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(nt){this.actionItem=nt;const ot=gt=>{this.element=append$1(gt,$$d("a.action-label"));let pt=[];return typeof this.options.classNames=="string"?pt=this.options.classNames.split(/\s+/g).filter(mt=>!!mt):this.options.classNames&&(pt=this.options.classNames),pt.find(mt=>mt==="icon")||pt.push("codicon"),this.element.classList.add(...pt),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this.element.title=this._action.label||"",this.element.ariaLabel=this._action.label||"",null},rt=Array.isArray(this.menuActionsOrProvider),ut={contextMenuProvider:this.contextMenuProvider,labelRenderer:ot,menuAsChild:this.options.menuAsChild,actions:rt?this.menuActionsOrProvider:void 0,actionProvider:rt?void 0:this.menuActionsOrProvider};if(this.dropdownMenu=this._register(new DropdownMenu(nt,ut)),this._register(this.dropdownMenu.onDidChangeVisibility(gt=>{var pt;(pt=this.element)===null||pt===void 0||pt.setAttribute("aria-expanded",`${gt}`),this._onDidChangeVisibility.fire(gt)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const gt=this;this.dropdownMenu.menuOptions=Object.assign(Object.assign({},this.dropdownMenu.menuOptions),{get anchorAlignment(){return gt.options.anchorAlignmentProvider()}})}this.updateTooltip(),this.updateEnabled()}getTooltip(){let nt=null;return this.action.tooltip?nt=this.action.tooltip:this.action.label&&(nt=this.action.label),nt??void 0}setActionContext(nt){super.setActionContext(nt),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=nt:this.dropdownMenu.menuOptions={context:nt})}show(){var nt;(nt=this.dropdownMenu)===null||nt===void 0||nt.show()}updateEnabled(){var nt,ot;const rt=!this.action.enabled;(nt=this.actionItem)===null||nt===void 0||nt.classList.toggle("disabled",rt),(ot=this.element)===null||ot===void 0||ot.classList.toggle("disabled",rt)}}const menuEntryActionViewItem="";function isICommandActionToggleInfo(ct){return ct?ct.condition!==void 0:!1}var __awaiter$1d=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},StorageHint;(function(ct){ct[ct.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",ct[ct.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(StorageHint||(StorageHint={}));var StorageState;(function(ct){ct[ct.None=0]="None",ct[ct.Initialized=1]="Initialized",ct[ct.Closed=2]="Closed"})(StorageState||(StorageState={}));class Storage extends Disposable{constructor(nt,ot=Object.create(null)){super(),this.database=nt,this.options=ot,this._onDidChangeStorage=this._register(new Emitter$2),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=StorageState.None,this.cache=new Map,this.flushDelayer=new ThrottledDelayer(Storage.DEFAULT_FLUSH_DELAY),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(nt=>this.onDidChangeItemsExternal(nt)))}onDidChangeItemsExternal(nt){var ot,rt;(ot=nt.changed)===null||ot===void 0||ot.forEach((ut,gt)=>this.accept(gt,ut)),(rt=nt.deleted)===null||rt===void 0||rt.forEach(ut=>this.accept(ut,void 0))}accept(nt,ot){if(this.state===StorageState.Closed)return;let rt=!1;isUndefinedOrNull(ot)?rt=this.cache.delete(nt):this.cache.get(nt)!==ot&&(this.cache.set(nt,ot),rt=!0),rt&&this._onDidChangeStorage.fire(nt)}get(nt,ot){const rt=this.cache.get(nt);return isUndefinedOrNull(rt)?ot:rt}getBoolean(nt,ot){const rt=this.get(nt);return isUndefinedOrNull(rt)?ot:rt==="true"}getNumber(nt,ot){const rt=this.get(nt);return isUndefinedOrNull(rt)?ot:parseInt(rt,10)}set(nt,ot){return __awaiter$1d(this,void 0,void 0,function*(){if(this.state===StorageState.Closed)return;if(isUndefinedOrNull(ot))return this.delete(nt);const rt=String(ot);if(this.cache.get(nt)!==rt)return this.cache.set(nt,rt),this.pendingInserts.set(nt,rt),this.pendingDeletes.delete(nt),this._onDidChangeStorage.fire(nt),this.doFlush()})}delete(nt){return __awaiter$1d(this,void 0,void 0,function*(){if(!(this.state===StorageState.Closed||!this.cache.delete(nt)))return this.pendingDeletes.has(nt)||this.pendingDeletes.add(nt),this.pendingInserts.delete(nt),this._onDidChangeStorage.fire(nt),this.doFlush()})}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}flushPending(){return __awaiter$1d(this,void 0,void 0,function*(){if(!this.hasPending)return;const nt={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(nt).finally(()=>{var ot;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)(ot=this.whenFlushedCallbacks.pop())===null||ot===void 0||ot()})})}doFlush(nt){return __awaiter$1d(this,void 0,void 0,function*(){return this.flushDelayer.trigger(()=>this.flushPending(),nt)})}dispose(){this.flushDelayer.dispose(),super.dispose()}}Storage.DEFAULT_FLUSH_DELAY=100;class InMemoryStorageDatabase{constructor(){this.onDidChangeItemsExternal=Event.None,this.items=new Map}updateItems(nt){var ot,rt;return __awaiter$1d(this,void 0,void 0,function*(){(ot=nt.insert)===null||ot===void 0||ot.forEach((ut,gt)=>this.items.set(gt,ut)),(rt=nt.delete)===null||rt===void 0||rt.forEach(ut=>this.items.delete(ut))})}}const TARGET_KEY="__$__targetStorageMarker",IStorageService=createDecorator("storageService");var WillSaveStateReason;(function(ct){ct[ct.NONE=0]="NONE",ct[ct.SHUTDOWN=1]="SHUTDOWN"})(WillSaveStateReason||(WillSaveStateReason={}));function loadKeyTargets(ct){const nt=ct.get(TARGET_KEY);if(nt)try{return JSON.parse(nt)}catch{}return Object.create(null)}class AbstractStorageService extends Disposable{constructor(nt={flushInterval:AbstractStorageService.DEFAULT_FLUSH_INTERVAL}){super(),this.options=nt,this._onDidChangeValue=this._register(new PauseableEmitter),this.onDidChangeValue=this._onDidChangeValue.event,this._onDidChangeTarget=this._register(new PauseableEmitter),this._onWillSaveState=this._register(new Emitter$2),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0}emitDidChangeValue(nt,ot){if(ot===TARGET_KEY){switch(nt){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:nt})}else this._onDidChangeValue.fire({scope:nt,key:ot,target:this.getKeyTargets(nt)[ot]})}get(nt,ot,rt){var ut;return(ut=this.getStorage(ot))===null||ut===void 0?void 0:ut.get(nt,rt)}getBoolean(nt,ot,rt){var ut;return(ut=this.getStorage(ot))===null||ut===void 0?void 0:ut.getBoolean(nt,rt)}getNumber(nt,ot,rt){var ut;return(ut=this.getStorage(ot))===null||ut===void 0?void 0:ut.getNumber(nt,rt)}store(nt,ot,rt,ut){if(isUndefinedOrNull(ot)){this.remove(nt,rt);return}this.withPausedEmitters(()=>{var gt;this.updateKeyTarget(nt,rt,ut),(gt=this.getStorage(rt))===null||gt===void 0||gt.set(nt,ot)})}remove(nt,ot){this.withPausedEmitters(()=>{var rt;this.updateKeyTarget(nt,ot,void 0),(rt=this.getStorage(ot))===null||rt===void 0||rt.delete(nt)})}withPausedEmitters(nt){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{nt()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(nt,ot,rt){var ut,gt;const pt=this.getKeyTargets(ot);typeof rt=="number"?pt[nt]!==rt&&(pt[nt]=rt,(ut=this.getStorage(ot))===null||ut===void 0||ut.set(TARGET_KEY,JSON.stringify(pt))):typeof pt[nt]=="number"&&(delete pt[nt],(gt=this.getStorage(ot))===null||gt===void 0||gt.set(TARGET_KEY,JSON.stringify(pt)))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(nt){switch(nt){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(nt){const ot=this.getStorage(nt);return ot?loadKeyTargets(ot):Object.create(null)}}AbstractStorageService.DEFAULT_FLUSH_INTERVAL=60*1e3;class InMemoryStorageService extends AbstractStorageService{constructor(){super(),this.applicationStorage=this._register(new Storage(new InMemoryStorageDatabase,{hint:StorageHint.STORAGE_IN_MEMORY})),this.profileStorage=this._register(new Storage(new InMemoryStorageDatabase,{hint:StorageHint.STORAGE_IN_MEMORY})),this.workspaceStorage=this._register(new Storage(new InMemoryStorageDatabase,{hint:StorageHint.STORAGE_IN_MEMORY})),this._register(this.workspaceStorage.onDidChangeStorage(nt=>this.emitDidChangeValue(1,nt))),this._register(this.profileStorage.onDidChangeStorage(nt=>this.emitDidChangeValue(0,nt))),this._register(this.applicationStorage.onDidChangeStorage(nt=>this.emitDidChangeValue(-1,nt)))}getStorage(nt){switch(nt){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}}function overrideStyles(ct,nt){const ot=Object.assign({},nt);for(const rt in ct){const ut=ct[rt];ot[rt]=ut!==void 0?asCssVariable(ut):void 0}return ot}const defaultKeybindingLabelStyles={keybindingLabelBackground:asCssVariable(keybindingLabelBackground),keybindingLabelForeground:asCssVariable(keybindingLabelForeground),keybindingLabelBorder:asCssVariable(keybindingLabelBorder),keybindingLabelBottomBorder:asCssVariable(keybindingLabelBottomBorder),keybindingLabelShadow:asCssVariable(widgetShadow)},defaultButtonStyles={buttonForeground:asCssVariable(buttonForeground),buttonSeparator:asCssVariable(buttonSeparator),buttonBackground:asCssVariable(buttonBackground),buttonHoverBackground:asCssVariable(buttonHoverBackground),buttonSecondaryForeground:asCssVariable(buttonSecondaryForeground),buttonSecondaryBackground:asCssVariable(buttonSecondaryBackground),buttonSecondaryHoverBackground:asCssVariable(buttonSecondaryHoverBackground),buttonBorder:asCssVariable(buttonBorder)},defaultProgressBarStyles={progressBarBackground:asCssVariable(progressBarBackground)},defaultToggleStyles={inputActiveOptionBorder:asCssVariable(inputActiveOptionBorder),inputActiveOptionForeground:asCssVariable(inputActiveOptionForeground),inputActiveOptionBackground:asCssVariable(inputActiveOptionBackground)};asCssVariable(checkboxBackground),asCssVariable(checkboxBorder),asCssVariable(checkboxForeground);asCssVariable(editorWidgetBackground),asCssVariable(editorWidgetForeground),asCssVariable(widgetShadow),asCssVariable(contrastBorder),asCssVariable(problemsErrorIconForeground),asCssVariable(problemsWarningIconForeground),asCssVariable(problemsInfoIconForeground),asCssVariable(textLinkForeground);const defaultInputBoxStyles={inputBackground:asCssVariable(inputBackground),inputForeground:asCssVariable(inputForeground),inputBorder:asCssVariable(inputBorder),inputValidationInfoBorder:asCssVariable(inputValidationInfoBorder),inputValidationInfoBackground:asCssVariable(inputValidationInfoBackground),inputValidationInfoForeground:asCssVariable(inputValidationInfoForeground),inputValidationWarningBorder:asCssVariable(inputValidationWarningBorder),inputValidationWarningBackground:asCssVariable(inputValidationWarningBackground),inputValidationWarningForeground:asCssVariable(inputValidationWarningForeground),inputValidationErrorBorder:asCssVariable(inputValidationErrorBorder),inputValidationErrorBackground:asCssVariable(inputValidationErrorBackground),inputValidationErrorForeground:asCssVariable(inputValidationErrorForeground)},defaultFindWidgetStyles={listFilterWidgetBackground:asCssVariable(listFilterWidgetBackground),listFilterWidgetOutline:asCssVariable(listFilterWidgetOutline),listFilterWidgetNoMatchesOutline:asCssVariable(listFilterWidgetNoMatchesOutline),listFilterWidgetShadow:asCssVariable(listFilterWidgetShadow),inputBoxStyles:defaultInputBoxStyles,toggleStyles:defaultToggleStyles},defaultCountBadgeStyles={badgeBackground:asCssVariable(badgeBackground),badgeForeground:asCssVariable(badgeForeground),badgeBorder:asCssVariable(contrastBorder)};asCssVariable(breadcrumbsBackground),asCssVariable(breadcrumbsForeground),asCssVariable(breadcrumbsFocusForeground),asCssVariable(breadcrumbsFocusForeground),asCssVariable(breadcrumbsActiveSelectionForeground);const defaultListStyles={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:asCssVariable(listFocusBackground),listFocusForeground:asCssVariable(listFocusForeground),listFocusOutline:asCssVariable(listFocusOutline),listActiveSelectionBackground:asCssVariable(listActiveSelectionBackground),listActiveSelectionForeground:asCssVariable(listActiveSelectionForeground),listActiveSelectionIconForeground:asCssVariable(listActiveSelectionIconForeground),listFocusAndSelectionOutline:asCssVariable(listFocusAndSelectionOutline),listFocusAndSelectionBackground:asCssVariable(listActiveSelectionBackground),listFocusAndSelectionForeground:asCssVariable(listActiveSelectionForeground),listInactiveSelectionBackground:asCssVariable(listInactiveSelectionBackground),listInactiveSelectionIconForeground:asCssVariable(listInactiveSelectionIconForeground),listInactiveSelectionForeground:asCssVariable(listInactiveSelectionForeground),listInactiveFocusBackground:asCssVariable(listInactiveFocusBackground),listInactiveFocusOutline:asCssVariable(listInactiveFocusOutline),listHoverBackground:asCssVariable(listHoverBackground),listHoverForeground:asCssVariable(listHoverForeground),listDropBackground:asCssVariable(listDropBackground),listSelectionOutline:asCssVariable(activeContrastBorder),listHoverOutline:asCssVariable(activeContrastBorder),treeIndentGuidesStroke:asCssVariable(treeIndentGuidesStroke),treeInactiveIndentGuidesStroke:asCssVariable(treeInactiveIndentGuidesStroke),tableColumnsBorder:asCssVariable(tableColumnsBorder),tableOddRowsBackgroundColor:asCssVariable(tableOddRowsBackgroundColor)};function getListStyles(ct){return overrideStyles(ct,defaultListStyles)}const defaultSelectBoxStyles={selectBackground:asCssVariable(selectBackground),selectListBackground:asCssVariable(selectListBackground),selectForeground:asCssVariable(selectForeground),decoratorRightForeground:asCssVariable(pickerGroupForeground),selectBorder:asCssVariable(selectBorder),focusBorder:asCssVariable(focusBorder),listFocusBackground:asCssVariable(quickInputListFocusBackground),listInactiveSelectionIconForeground:asCssVariable(quickInputListFocusIconForeground),listFocusForeground:asCssVariable(quickInputListFocusForeground),listFocusOutline:asCssVariableWithDefault(activeContrastBorder,Color.transparent.toString()),listHoverBackground:asCssVariable(listHoverBackground),listHoverForeground:asCssVariable(listHoverForeground),listHoverOutline:asCssVariable(activeContrastBorder),selectListBorder:asCssVariable(editorWidgetBorder),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0},defaultMenuStyles={shadowColor:asCssVariable(widgetShadow),borderColor:asCssVariable(menuBorder),foregroundColor:asCssVariable(menuForeground),backgroundColor:asCssVariable(menuBackground),selectionForegroundColor:asCssVariable(menuSelectionForeground),selectionBackgroundColor:asCssVariable(menuSelectionBackground),selectionBorderColor:asCssVariable(menuSelectionBorder),separatorColor:asCssVariable(menuSeparatorBackground),scrollbarShadow:asCssVariable(scrollbarShadow),scrollbarSliderBackground:asCssVariable(scrollbarSliderBackground),scrollbarSliderHoverBackground:asCssVariable(scrollbarSliderHoverBackground),scrollbarSliderActiveBackground:asCssVariable(scrollbarSliderActiveBackground)};var __decorate$1J=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1G=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$1c=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function createAndFillInContextMenuActions(ct,nt,ot,rt){const ut=ct.getActions(nt),gt=ModifierKeyEmitter.getInstance(),pt=gt.keyStatus.altKey||(isWindows||isLinux)&&gt.keyStatus.shiftKey;fillInActions(ut,ot,pt,rt?mt=>mt===rt:mt=>mt==="navigation")}function createAndFillInActionBarActions(ct,nt,ot,rt,ut,gt){const pt=ct.getActions(nt);fillInActions(pt,ot,!1,typeof rt=="string"?vt=>vt===rt:rt,ut,gt)}function fillInActions(ct,nt,ot,rt=pt=>pt==="navigation",ut=()=>!1,gt=!1){let pt,mt;Array.isArray(nt)?(pt=nt,mt=nt):(pt=nt.primary,mt=nt.secondary);const vt=new Set;for(const[St,yt]of ct){let wt;rt(St)?(wt=pt,wt.length>0&&gt&&wt.push(new Separator)):(wt=mt,wt.length>0&&wt.push(new Separator));for(let Lt of yt){ot&&(Lt=Lt instanceof MenuItemAction&&Lt.alt?Lt.alt:Lt);const xt=wt.push(Lt);Lt instanceof SubmenuAction&&vt.add({group:St,action:Lt,index:xt-1})}}for(const{group:St,action:yt,index:wt}of vt){const Lt=rt(St)?pt:mt,xt=yt.actions;xt.length<=1&&ut(yt,St,Lt.length)&&Lt.splice(wt,1,...xt)}}let MenuEntryActionViewItem=class extends ActionViewItem{constructor(nt,ot,rt,ut,gt,pt,mt){super(void 0,nt,{icon:!!(nt.class||nt.item.icon),label:!nt.class&&!nt.item.icon,draggable:ot==null?void 0:ot.draggable,keybinding:ot==null?void 0:ot.keybinding,hoverDelegate:ot==null?void 0:ot.hoverDelegate}),this._keybindingService=rt,this._notificationService=ut,this._contextKeyService=gt,this._themeService=pt,this._contextMenuService=mt,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new MutableDisposable),this._altKey=ModifierKeyEmitter.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}onClick(nt){return __awaiter$1c(this,void 0,void 0,function*(){nt.preventDefault(),nt.stopPropagation();try{yield this.actionRunner.run(this._commandAction,this._context)}catch(ot){this._notificationService.error(ot)}})}render(nt){super.render(nt),nt.classList.add("menu-entry"),this._updateItemClass(this._menuItemAction.item);let ot=!1,rt=this._altKey.keyStatus.altKey||(isWindows||isLinux)&&this._altKey.keyStatus.shiftKey;const ut=()=>{var gt;const pt=ot&&rt&&!!(!((gt=this._commandAction.alt)===null||gt===void 0)&&gt.enabled);pt!==this._wantsAltCommand&&(this._wantsAltCommand=pt,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._menuItemAction.alt&&this._register(this._altKey.event(gt=>{rt=gt.altKey||(isWindows||isLinux)&&gt.shiftKey,ut()})),this._register(addDisposableListener(nt,"mouseleave",gt=>{ot=!1,ut()})),this._register(addDisposableListener(nt,"mouseenter",gt=>{ot=!0,ut()}))}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){var nt;const ot=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),rt=ot&&ot.getLabel(),ut=this._commandAction.tooltip||this._commandAction.label;let gt=rt?localize("titleAndKb","{0} ({1})",ut,rt):ut;if(!this._wantsAltCommand&&(!((nt=this._menuItemAction.alt)===null||nt===void 0)&&nt.enabled)){const pt=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,mt=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),vt=mt&&mt.getLabel(),St=vt?localize("titleAndKb","{0} ({1})",pt,vt):pt;gt=localize("titleAndKbAndAlt",`{0}
[{1}] {2}`,gt,UILabelProvider.modifierLabels[OS].altKey,St)}return gt}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(nt){this._itemClassDispose.value=void 0;const{element:ot,label:rt}=this;if(!ot||!rt)return;const ut=this._commandAction.checked&&isICommandActionToggleInfo(nt.toggled)&&nt.toggled.icon?nt.toggled.icon:nt.icon;if(ut)if(ThemeIcon.isThemeIcon(ut)){const gt=ThemeIcon.asClassNameArray(ut);rt.classList.add(...gt),this._itemClassDispose.value=toDisposable(()=>{rt.classList.remove(...gt)})}else rt.style.backgroundImage=isDark(this._themeService.getColorTheme().type)?asCSSUrl(ut.dark):asCSSUrl(ut.light),rt.classList.add("icon"),this._itemClassDispose.value=combinedDisposable(toDisposable(()=>{rt.style.backgroundImage="",rt.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};MenuEntryActionViewItem=__decorate$1J([__param$1G(2,IKeybindingService),__param$1G(3,INotificationService),__param$1G(4,IContextKeyService),__param$1G(5,IThemeService),__param$1G(6,IContextMenuService)],MenuEntryActionViewItem);let SubmenuEntryActionViewItem=class extends DropdownMenuActionViewItem{constructor(nt,ot,rt,ut,gt){var pt,mt,vt;const St=Object.assign(Object.assign({},ot),{menuAsChild:(pt=ot==null?void 0:ot.menuAsChild)!==null&&pt!==void 0?pt:!1,classNames:(mt=ot==null?void 0:ot.classNames)!==null&&mt!==void 0?mt:ThemeIcon.isThemeIcon(nt.item.icon)?ThemeIcon.asClassName(nt.item.icon):void 0,keybindingProvider:(vt=ot==null?void 0:ot.keybindingProvider)!==null&&vt!==void 0?vt:yt=>rt.lookupKeybinding(yt.id)});super(nt,{getActions:()=>nt.actions},ut,St),this._keybindingService=rt,this._contextMenuService=ut,this._themeService=gt}render(nt){super.render(nt),assertType(this.element),nt.classList.add("menu-entry");const ot=this._action,{icon:rt}=ot.item;if(rt&&!ThemeIcon.isThemeIcon(rt)){this.element.classList.add("icon");const ut=()=>{this.element&&(this.element.style.backgroundImage=isDark(this._themeService.getColorTheme().type)?asCSSUrl(rt.dark):asCSSUrl(rt.light))};ut(),this._register(this._themeService.onDidColorThemeChange(()=>{ut()}))}}};SubmenuEntryActionViewItem=__decorate$1J([__param$1G(2,IKeybindingService),__param$1G(3,IContextMenuService),__param$1G(4,IThemeService)],SubmenuEntryActionViewItem);let DropdownWithDefaultActionViewItem=class extends BaseActionViewItem{constructor(nt,ot,rt,ut,gt,pt,mt,vt){var St,yt,wt;super(null,nt),this._keybindingService=rt,this._notificationService=ut,this._contextMenuService=gt,this._menuService=pt,this._instaService=mt,this._storageService=vt,this._container=null,this._options=ot,this._storageKey=`${nt.item.submenu.id}_lastActionId`;let Lt;const xt=vt.get(this._storageKey,1);xt&&(Lt=nt.actions.find(kt=>xt===kt.id)),Lt||(Lt=nt.actions[0]),this._defaultAction=this._instaService.createInstance(MenuEntryActionViewItem,Lt,{keybinding:this._getDefaultActionKeybindingLabel(Lt)});const It=Object.assign({},ot??Object.create(null),{menuAsChild:(St=ot==null?void 0:ot.menuAsChild)!==null&&St!==void 0?St:!0,classNames:(yt=ot==null?void 0:ot.classNames)!==null&&yt!==void 0?yt:["codicon","codicon-chevron-down"],actionRunner:(wt=ot==null?void 0:ot.actionRunner)!==null&&wt!==void 0?wt:new ActionRunner});this._dropdown=new DropdownMenuActionViewItem(nt,nt.actions,this._contextMenuService,It),this._dropdown.actionRunner.onDidRun(kt=>{kt.action instanceof MenuItemAction&&this.update(kt.action)})}update(nt){this._storageService.store(this._storageKey,nt.id,1,0),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(MenuEntryActionViewItem,nt,{keybinding:this._getDefaultActionKeybindingLabel(nt)}),this._defaultAction.actionRunner=new class extends ActionRunner{runAction(ot,rt){return __awaiter$1c(this,void 0,void 0,function*(){yield ot.run(void 0)})}},this._container&&this._defaultAction.render(prepend$1(this._container,$$d(".action-container")))}_getDefaultActionKeybindingLabel(nt){var ot;let rt;if(!((ot=this._options)===null||ot===void 0)&&ot.renderKeybindingWithDefaultActionLabel){const ut=this._keybindingService.lookupKeybinding(nt.id);ut&&(rt=`(${ut.getLabel()})`)}return rt}setActionContext(nt){super.setActionContext(nt),this._defaultAction.setActionContext(nt),this._dropdown.setActionContext(nt)}render(nt){this._container=nt,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const ot=$$d(".action-container");this._defaultAction.render(append$1(this._container,ot)),this._register(addDisposableListener(ot,EventType$1.KEY_DOWN,ut=>{const gt=new StandardKeyboardEvent(ut);gt.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),gt.stopPropagation())}));const rt=$$d(".dropdown-action-container");this._dropdown.render(append$1(this._container,rt)),this._register(addDisposableListener(rt,EventType$1.KEY_DOWN,ut=>{var gt;const pt=new StandardKeyboardEvent(ut);pt.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),(gt=this._defaultAction.element)===null||gt===void 0||gt.focus(),pt.stopPropagation())}))}focus(nt){nt?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(nt){nt?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};DropdownWithDefaultActionViewItem=__decorate$1J([__param$1G(2,IKeybindingService),__param$1G(3,INotificationService),__param$1G(4,IContextMenuService),__param$1G(5,IMenuService),__param$1G(6,IInstantiationService),__param$1G(7,IStorageService)],DropdownWithDefaultActionViewItem);let SubmenuEntrySelectActionViewItem=class extends SelectActionViewItem{constructor(nt,ot){super(null,nt,nt.actions.map(rt=>({text:rt.id===Separator.ID?"":rt.label,isDisabled:!rt.enabled})),0,ot,defaultSelectBoxStyles,{ariaLabel:nt.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,nt.actions.findIndex(rt=>rt.checked)))}render(nt){super.render(nt),nt.style.borderColor=asCssVariable(selectBorder)}runAction(nt,ot){const rt=this.action.actions[ot];rt&&this.actionRunner.run(rt)}};SubmenuEntrySelectActionViewItem=__decorate$1J([__param$1G(1,IContextViewService)],SubmenuEntrySelectActionViewItem);function createActionViewItem(ct,nt,ot){return nt instanceof MenuItemAction?ct.createInstance(MenuEntryActionViewItem,nt,ot):nt instanceof SubmenuItemAction?nt.item.isSelection?ct.createInstance(SubmenuEntrySelectActionViewItem,nt):nt.item.rememberDefaultAction?ct.createInstance(DropdownWithDefaultActionViewItem,nt,ot):ct.createInstance(SubmenuEntryActionViewItem,nt,ot):void 0}const MENU_MNEMONIC_REGEX=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,MENU_ESCAPED_MNEMONIC_REGEX=/(&amp;)?(&amp;)([^\s&])/g;var Direction;(function(ct){ct[ct.Right=0]="Right",ct[ct.Left=1]="Left"})(Direction||(Direction={}));class Menu extends ActionBar{constructor(nt,ot,rt,ut){nt.classList.add("monaco-menu-container"),nt.setAttribute("role","presentation");const gt=document.createElement("div");gt.classList.add("monaco-menu"),gt.setAttribute("role","presentation"),super(gt,{orientation:1,actionViewItemProvider:vt=>this.doGetActionViewItem(vt,rt,pt),context:rt.context,actionRunner:rt.actionRunner,ariaLabel:rt.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...isMacintosh||isLinux?[10]:[]],keyDown:!0}}),this.menuStyles=ut,this.menuElement=gt,this.actionsList.tabIndex=0,this.menuDisposables=this._register(new DisposableStore),this.initializeOrUpdateStyleSheet(nt,ut),this._register(Gesture.addTarget(gt)),addDisposableListener(gt,EventType$1.KEY_DOWN,vt=>{new StandardKeyboardEvent(vt).equals(2)&&vt.preventDefault()}),rt.enableMnemonics&&this.menuDisposables.add(addDisposableListener(gt,EventType$1.KEY_DOWN,vt=>{const St=vt.key.toLocaleLowerCase();if(this.mnemonics.has(St)){EventHelper.stop(vt,!0);const yt=this.mnemonics.get(St);if(yt.length===1&&(yt[0]instanceof SubmenuMenuActionViewItem&&yt[0].container&&this.focusItemByElement(yt[0].container),yt[0].onClick(vt)),yt.length>1){const wt=yt.shift();wt&&wt.container&&(this.focusItemByElement(wt.container),yt.push(wt)),this.mnemonics.set(St,yt)}}})),isLinux&&this._register(addDisposableListener(gt,EventType$1.KEY_DOWN,vt=>{const St=new StandardKeyboardEvent(vt);St.equals(14)||St.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),EventHelper.stop(vt,!0)):(St.equals(13)||St.equals(12))&&(this.focusedItem=0,this.focusPrevious(),EventHelper.stop(vt,!0))})),this._register(addDisposableListener(this.domNode,EventType$1.MOUSE_OUT,vt=>{const St=vt.relatedTarget;isAncestor$1(St,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),vt.stopPropagation())})),this._register(addDisposableListener(this.actionsList,EventType$1.MOUSE_OVER,vt=>{let St=vt.target;if(!(!St||!isAncestor$1(St,this.actionsList)||St===this.actionsList)){for(;St.parentElement!==this.actionsList&&St.parentElement!==null;)St=St.parentElement;if(St.classList.contains("action-item")){const yt=this.focusedItem;this.setFocusedItem(St),yt!==this.focusedItem&&this.updateFocus()}}})),this._register(Gesture.addTarget(this.actionsList)),this._register(addDisposableListener(this.actionsList,EventType.Tap,vt=>{let St=vt.initialTarget;if(!(!St||!isAncestor$1(St,this.actionsList)||St===this.actionsList)){for(;St.parentElement!==this.actionsList&&St.parentElement!==null;)St=St.parentElement;if(St.classList.contains("action-item")){const yt=this.focusedItem;this.setFocusedItem(St),yt!==this.focusedItem&&this.updateFocus()}}}));const pt={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new DomScrollableElement(gt,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const mt=this.scrollableElement.getDomNode();mt.style.position="",this.styleScrollElement(mt,ut),this._register(addDisposableListener(gt,EventType.Change,vt=>{EventHelper.stop(vt,!0);const St=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:St-vt.translationY})})),this._register(addDisposableListener(mt,EventType$1.MOUSE_UP,vt=>{vt.preventDefault()})),gt.style.maxHeight=`${Math.max(10,window.innerHeight-nt.getBoundingClientRect().top-35)}px`,ot=ot.filter(vt=>{var St;return!((St=rt.submenuIds)===null||St===void 0)&&St.has(vt.id)?(console.warn(`Found submenu cycle: ${vt.id}`),!1):!0}),this.push(ot,{icon:!0,label:!0,isMenu:!0}),nt.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(vt=>!(vt instanceof MenuSeparatorActionViewItem)).forEach((vt,St,yt)=>{vt.updatePositionInSet(St+1,yt.length)})}initializeOrUpdateStyleSheet(nt,ot){this.styleSheet||(isInShadowDOM(nt)?this.styleSheet=createStyleSheet(nt):(Menu.globalStyleSheet||(Menu.globalStyleSheet=createStyleSheet()),this.styleSheet=Menu.globalStyleSheet)),this.styleSheet.textContent=getMenuWidgetCSS(ot,isInShadowDOM(nt))}styleScrollElement(nt,ot){var rt,ut;const gt=(rt=ot.foregroundColor)!==null&&rt!==void 0?rt:"",pt=(ut=ot.backgroundColor)!==null&&ut!==void 0?ut:"",mt=ot.borderColor?`1px solid ${ot.borderColor}`:"",vt="5px",St=ot.shadowColor?`0 2px 8px ${ot.shadowColor}`:"";nt.style.outline=mt,nt.style.borderRadius=vt,nt.style.color=gt,nt.style.backgroundColor=pt,nt.style.boxShadow=St}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(nt){const ot=this.focusedItem;this.setFocusedItem(nt),ot!==this.focusedItem&&this.updateFocus()}setFocusedItem(nt){for(let ot=0;ot<this.actionsList.children.length;ot++){const rt=this.actionsList.children[ot];if(nt===rt){this.focusedItem=ot;break}}}updateFocus(nt){super.updateFocus(nt,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(nt,ot,rt){if(nt instanceof Separator)return new MenuSeparatorActionViewItem(ot.context,nt,{icon:!0},this.menuStyles);if(nt instanceof SubmenuAction){const ut=new SubmenuMenuActionViewItem(nt,nt.actions,rt,Object.assign(Object.assign({},ot),{submenuIds:new Set([...ot.submenuIds||[],nt.id])}),this.menuStyles);if(ot.enableMnemonics){const gt=ut.getMnemonic();if(gt&&ut.isEnabled()){let pt=[];this.mnemonics.has(gt)&&(pt=this.mnemonics.get(gt)),pt.push(ut),this.mnemonics.set(gt,pt)}}return ut}else{const ut={enableMnemonics:ot.enableMnemonics,useEventAsContext:ot.useEventAsContext};if(ot.getKeyBinding){const pt=ot.getKeyBinding(nt);if(pt){const mt=pt.getLabel();mt&&(ut.keybinding=mt)}}const gt=new BaseMenuActionViewItem(ot.context,nt,ut,this.menuStyles);if(ot.enableMnemonics){const pt=gt.getMnemonic();if(pt&&gt.isEnabled()){let mt=[];this.mnemonics.has(pt)&&(mt=this.mnemonics.get(pt)),mt.push(gt),this.mnemonics.set(pt,mt)}}return gt}}}class BaseMenuActionViewItem extends BaseActionViewItem{constructor(nt,ot,rt,ut){if(rt.isMenu=!0,super(ot,ot,rt),this.menuStyle=ut,this.options=rt,this.options.icon=rt.icon!==void 0?rt.icon:!1,this.options.label=rt.label!==void 0?rt.label:!0,this.cssClass="",this.options.label&&rt.enableMnemonics){const gt=this.action.label;if(gt){const pt=MENU_MNEMONIC_REGEX.exec(gt);pt&&(this.mnemonic=(pt[1]?pt[1]:pt[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new RunOnceScheduler(()=>{this.element&&(this._register(addDisposableListener(this.element,EventType$1.MOUSE_UP,gt=>{if(EventHelper.stop(gt,!0),isFirefox){if(new StandardMouseEvent(gt).rightButton)return;this.onClick(gt)}else setTimeout(()=>{this.onClick(gt)},0)})),this._register(addDisposableListener(this.element,EventType$1.CONTEXT_MENU,gt=>{EventHelper.stop(gt,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(nt){super.render(nt),this.element&&(this.container=nt,this.item=append$1(this.element,$$d("a.action-menu-item")),this._action.id===Separator.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=append$1(this.item,$$d("span.menu-item-check"+ThemeIcon.asCSSSelector(Codicon.menuSelection))),this.check.setAttribute("role","none"),this.label=append$1(this.item,$$d("span.action-label")),this.options.label&&this.options.keybinding&&(append$1(this.item,$$d("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){var nt;super.focus(),(nt=this.item)===null||nt===void 0||nt.focus(),this.applyStyle()}updatePositionInSet(nt,ot){this.item&&(this.item.setAttribute("aria-posinset",`${nt}`),this.item.setAttribute("aria-setsize",`${ot}`))}updateLabel(){var nt;if(this.label&&this.options.label){clearNode(this.label);let ot=stripIcons(this.action.label);if(ot){const rt=cleanMnemonic(ot);this.options.enableMnemonics||(ot=rt),this.label.setAttribute("aria-label",rt.replace(/&&/g,"&"));const ut=MENU_MNEMONIC_REGEX.exec(ot);if(ut){ot=escape$1(ot),MENU_ESCAPED_MNEMONIC_REGEX.lastIndex=0;let gt=MENU_ESCAPED_MNEMONIC_REGEX.exec(ot);for(;gt&&gt[1];)gt=MENU_ESCAPED_MNEMONIC_REGEX.exec(ot);const pt=mt=>mt.replace(/&amp;&amp;/g,"&amp;");gt?this.label.append(ltrim(pt(ot.substr(0,gt.index))," "),$$d("u",{"aria-hidden":"true"},gt[3]),rtrim(pt(ot.substr(gt.index+gt[0].length))," ")):this.label.innerText=pt(ot).trim(),(nt=this.item)===null||nt===void 0||nt.setAttribute("aria-keyshortcuts",(ut[1]?ut[1]:ut[3]).toLocaleLowerCase())}else this.label.innerText=ot.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const nt=this.action.checked;this.item.classList.toggle("checked",!!nt),nt!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",nt?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const nt=this.element&&this.element.classList.contains("focused"),ot=nt&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,rt=nt&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,ut=nt&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",gt=nt&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=ot??"",this.item.style.backgroundColor=rt??"",this.item.style.outline=ut,this.item.style.outlineOffset=gt),this.check&&(this.check.style.color=ot??"")}}class SubmenuMenuActionViewItem extends BaseMenuActionViewItem{constructor(nt,ot,rt,ut,gt){super(nt,nt,ut,gt),this.submenuActions=ot,this.parentData=rt,this.submenuOptions=ut,this.mysubmenu=null,this.submenuDisposables=this._register(new DisposableStore),this.mouseOver=!1,this.expandDirection=ut&&ut.expandDirection!==void 0?ut.expandDirection:Direction.Right,this.showScheduler=new RunOnceScheduler(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new RunOnceScheduler(()=>{this.element&&!isAncestor$1(getActiveElement(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(nt){super.render(nt),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=append$1(this.item,$$d("span.submenu-indicator"+ThemeIcon.asCSSSelector(Codicon.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(addDisposableListener(this.element,EventType$1.KEY_UP,ot=>{const rt=new StandardKeyboardEvent(ot);(rt.equals(17)||rt.equals(3))&&(EventHelper.stop(ot,!0),this.createSubmenu(!0))})),this._register(addDisposableListener(this.element,EventType$1.KEY_DOWN,ot=>{const rt=new StandardKeyboardEvent(ot);getActiveElement()===this.item&&(rt.equals(17)||rt.equals(3))&&EventHelper.stop(ot,!0)})),this._register(addDisposableListener(this.element,EventType$1.MOUSE_OVER,ot=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(addDisposableListener(this.element,EventType$1.MOUSE_LEAVE,ot=>{this.mouseOver=!1})),this._register(addDisposableListener(this.element,EventType$1.FOCUS_OUT,ot=>{this.element&&!isAncestor$1(getActiveElement(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(nt){EventHelper.stop(nt,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(nt){if(this.parentData.submenu&&(nt||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(nt,ot,rt,ut){const gt={top:0,left:0};return gt.left=layout(nt.width,ot.width,{position:ut===Direction.Right?0:1,offset:rt.left,size:rt.width}),gt.left>=rt.left&&gt.left<rt.left+rt.width&&(rt.left+10+ot.width<=nt.width&&(gt.left=rt.left+10),rt.top+=10,rt.height=0),gt.top=layout(nt.height,ot.height,{position:0,offset:rt.top,size:0}),gt.top+ot.height===rt.top&&gt.top+rt.height+ot.height<=nt.height&&(gt.top+=rt.height),gt}createSubmenu(nt=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=append$1(this.element,$$d("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const ot=getComputedStyle(this.parentData.parent.domNode),rt=parseFloat(ot.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new Menu(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new EmptySubmenuAction],this.submenuOptions,this.menuStyle);const ut=this.element.getBoundingClientRect(),gt={top:ut.top-rt,left:ut.left,height:ut.height+2*rt,width:ut.width},pt=this.submenuContainer.getBoundingClientRect(),{top:mt,left:vt}=this.calculateSubmenuMenuLayout(new Dimension(window.innerWidth,window.innerHeight),Dimension.lift(pt),gt,this.expandDirection);this.submenuContainer.style.left=`${vt-pt.left}px`,this.submenuContainer.style.top=`${mt-pt.top}px`,this.submenuDisposables.add(addDisposableListener(this.submenuContainer,EventType$1.KEY_UP,St=>{new StandardKeyboardEvent(St).equals(15)&&(EventHelper.stop(St,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(addDisposableListener(this.submenuContainer,EventType$1.KEY_DOWN,St=>{new StandardKeyboardEvent(St).equals(15)&&EventHelper.stop(St,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(nt),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(nt){var ot;this.item&&((ot=this.item)===null||ot===void 0||ot.setAttribute("aria-expanded",nt))}applyStyle(){super.applyStyle();const ot=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=ot??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class MenuSeparatorActionViewItem extends ActionViewItem{constructor(nt,ot,rt,ut){super(nt,ot,rt),this.menuStyles=ut}render(nt){super.render(nt),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function cleanMnemonic(ct){const nt=MENU_MNEMONIC_REGEX,ot=nt.exec(ct);if(!ot)return ct;const rt=!ot[1];return ct.replace(nt,rt?"$2$3":"").trim()}function formatRule(ct){const nt=getCodiconFontCharacters()[ct.id];return`.codicon-${ct.id}:before { content: '\\${nt.toString(16)}'; }`}function getMenuWidgetCSS(ct,nt){let ot=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${formatRule(Codicon.menuSelection)}
${formatRule(Codicon.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar.animated .action-item.active {
	transform: scale(1.272019649, 1.272019649); /* 1.272019649 =  */
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(nt){ot+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
		`;const rt=ct.scrollbarShadow;rt&&(ot+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${rt} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${rt} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${rt} 6px 6px 6px -6px inset;
				}
			`);const ut=ct.scrollbarSliderBackground;ut&&(ot+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${ut};
				}
			`);const gt=ct.scrollbarSliderHoverBackground;gt&&(ot+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${gt};
				}
			`);const pt=ct.scrollbarSliderActiveBackground;pt&&(ot+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${pt};
				}
			`)}return ot}class ContextMenuHandler{constructor(nt,ot,rt,ut){this.contextViewService=nt,this.telemetryService=ot,this.notificationService=rt,this.keybindingService=ut,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(nt){this.options=nt}showContextMenu(nt){const ot=nt.getActions();if(!ot.length)return;this.focusToReturn=document.activeElement;let rt;const ut=isHTMLElement(nt.domForShadowRoot)?nt.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>nt.getAnchor(),canRelayout:!1,anchorAlignment:nt.anchorAlignment,anchorAxisAlignment:nt.anchorAxisAlignment,render:gt=>{var pt;this.lastContainer=gt;const mt=nt.getMenuClassName?nt.getMenuClassName():"";mt&&(gt.className+=" "+mt),this.options.blockMouse&&(this.block=gt.appendChild($$d(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",(pt=this.blockDisposable)===null||pt===void 0||pt.dispose(),this.blockDisposable=addDisposableListener(this.block,EventType$1.MOUSE_DOWN,yt=>yt.stopPropagation()));const vt=new DisposableStore,St=nt.actionRunner||new ActionRunner;return St.onWillRun(yt=>this.onActionRun(yt,!nt.skipTelemetry),this,vt),St.onDidRun(this.onDidActionRun,this,vt),rt=new Menu(gt,ot,{actionViewItemProvider:nt.getActionViewItem,context:nt.getActionsContext?nt.getActionsContext():null,actionRunner:St,getKeyBinding:nt.getKeyBinding?nt.getKeyBinding:yt=>this.keybindingService.lookupKeybinding(yt.id)},defaultMenuStyles),rt.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,vt),rt.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,vt),vt.add(addDisposableListener(window,EventType$1.BLUR,()=>this.contextViewService.hideContextView(!0))),vt.add(addDisposableListener(window,EventType$1.MOUSE_DOWN,yt=>{if(yt.defaultPrevented)return;const wt=new StandardMouseEvent(yt);let Lt=wt.target;if(!wt.rightButton){for(;Lt;){if(Lt===gt)return;Lt=Lt.parentElement}this.contextViewService.hideContextView(!0)}})),combinedDisposable(vt,rt)},focus:()=>{rt==null||rt.focus(!!nt.autoSelectFirstItem)},onHide:gt=>{var pt,mt,vt;(pt=nt.onHide)===null||pt===void 0||pt.call(nt,!!gt),this.block&&(this.block.remove(),this.block=null),(mt=this.blockDisposable)===null||mt===void 0||mt.dispose(),this.blockDisposable=null,this.lastContainer&&(getActiveElement()===this.lastContainer||isAncestor$1(getActiveElement(),this.lastContainer))&&((vt=this.focusToReturn)===null||vt===void 0||vt.focus()),this.lastContainer=null}},ut,!!ut)}onActionRun(nt,ot){ot&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:nt.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(nt){nt.error&&!isCancellationError(nt.error)&&this.notificationService.error(nt.error)}}var __decorate$1I=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1F=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let ContextMenuService=class extends Disposable{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new ContextMenuHandler(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(nt,ot,rt,ut,gt,pt){super(),this.telemetryService=nt,this.notificationService=ot,this.contextViewService=rt,this.keybindingService=ut,this.menuService=gt,this.contextKeyService=pt,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new Emitter$2),this._onDidHideContextMenu=this._store.add(new Emitter$2)}configure(nt){this.contextMenuHandler.configure(nt)}showContextMenu(nt){nt=ContextMenuMenuDelegate.transform(nt,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu(Object.assign(Object.assign({},nt),{onHide:ot=>{var rt;(rt=nt.onHide)===null||rt===void 0||rt.call(nt,ot),this._onDidHideContextMenu.fire()}})),ModifierKeyEmitter.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};ContextMenuService=__decorate$1I([__param$1F(0,ITelemetryService),__param$1F(1,INotificationService),__param$1F(2,IContextViewService),__param$1F(3,IKeybindingService),__param$1F(4,IMenuService),__param$1F(5,IContextKeyService)],ContextMenuService);var ContextMenuMenuDelegate;(function(ct){function nt(rt){return rt&&rt.menuId instanceof MenuId}function ot(rt,ut,gt){if(!nt(rt))return rt;const{menuId:pt,menuActionOptions:mt,contextKeyService:vt}=rt;return Object.assign(Object.assign({},rt),{getActions:()=>{const St=[];if(pt){const yt=ut.createMenu(pt,vt??gt);createAndFillInContextMenuActions(yt,mt,St),yt.dispose()}return rt.getActions?Separator.join(rt.getActions(),St):St}})}ct.transform=ot})(ContextMenuMenuDelegate||(ContextMenuMenuDelegate={}));var EditorOpenSource;(function(ct){ct[ct.API=0]="API",ct[ct.USER=1]="USER"})(EditorOpenSource||(EditorOpenSource={}));var __decorate$1H=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1E=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$1b=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let CommandOpener=class{constructor(nt){this._commandService=nt}open(nt,ot){return __awaiter$1b(this,void 0,void 0,function*(){if(!matchesScheme(nt,Schemas.command))return!1;if(!(ot!=null&&ot.allowCommands)||(typeof nt=="string"&&(nt=URI.parse(nt)),Array.isArray(ot.allowCommands)&&!ot.allowCommands.includes(nt.path)))return!0;let rt=[];try{rt=parse$2(decodeURIComponent(nt.query))}catch{try{rt=parse$2(nt.query)}catch{}}return Array.isArray(rt)||(rt=[rt]),yield this._commandService.executeCommand(nt.path,...rt),!0})}};CommandOpener=__decorate$1H([__param$1E(0,ICommandService)],CommandOpener);let EditorOpener=class{constructor(nt){this._editorService=nt}open(nt,ot){return __awaiter$1b(this,void 0,void 0,function*(){typeof nt=="string"&&(nt=URI.parse(nt));const{selection:rt,uri:ut}=extractSelection(nt);return nt=ut,nt.scheme===Schemas.file&&(nt=normalizePath(nt)),yield this._editorService.openCodeEditor({resource:nt,options:Object.assign({selection:rt,source:ot!=null&&ot.fromUserGesture?EditorOpenSource.USER:EditorOpenSource.API},ot==null?void 0:ot.editorOptions)},this._editorService.getFocusedCodeEditor(),ot==null?void 0:ot.openToSide),!0})}};EditorOpener=__decorate$1H([__param$1E(0,ICodeEditorService)],EditorOpener);let OpenerService=class{constructor(nt,ot){this._openers=new LinkedList,this._validators=new LinkedList,this._resolvers=new LinkedList,this._resolvedUriTargets=new ResourceMap(rt=>rt.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new LinkedList,this._defaultExternalOpener={openExternal:rt=>__awaiter$1b(this,void 0,void 0,function*(){return matchesSomeScheme(rt,Schemas.http,Schemas.https)?windowOpenNoOpener(rt):window.location.href=rt,!0})},this._openers.push({open:(rt,ut)=>__awaiter$1b(this,void 0,void 0,function*(){return ut!=null&&ut.openExternal||matchesSomeScheme(rt,Schemas.mailto,Schemas.http,Schemas.https,Schemas.vsls)?(yield this._doOpenExternal(rt,ut),!0):!1})}),this._openers.push(new CommandOpener(ot)),this._openers.push(new EditorOpener(nt))}registerOpener(nt){return{dispose:this._openers.unshift(nt)}}open(nt,ot){var rt;return __awaiter$1b(this,void 0,void 0,function*(){const ut=typeof nt=="string"?URI.parse(nt):nt,gt=(rt=this._resolvedUriTargets.get(ut))!==null&&rt!==void 0?rt:nt;for(const pt of this._validators)if(!(yield pt.shouldOpen(gt,ot)))return!1;for(const pt of this._openers)if(yield pt.open(nt,ot))return!0;return!1})}resolveExternalUri(nt,ot){return __awaiter$1b(this,void 0,void 0,function*(){for(const rt of this._resolvers)try{const ut=yield rt.resolveExternalUri(nt,ot);if(ut)return this._resolvedUriTargets.has(ut.resolved)||this._resolvedUriTargets.set(ut.resolved,nt),ut}catch{}throw new Error("Could not resolve external URI: "+nt.toString())})}_doOpenExternal(nt,ot){return __awaiter$1b(this,void 0,void 0,function*(){const rt=typeof nt=="string"?URI.parse(nt):nt;let ut;try{ut=(yield this.resolveExternalUri(rt,ot)).resolved}catch{ut=rt}let gt;if(typeof nt=="string"&&rt.toString()===ut.toString()?gt=nt:gt=encodeURI(ut.toString(!0)),ot!=null&&ot.allowContributedOpeners){const pt=typeof(ot==null?void 0:ot.allowContributedOpeners)=="string"?ot==null?void 0:ot.allowContributedOpeners:void 0;for(const mt of this._externalOpeners)if(yield mt.openExternal(gt,{sourceUri:rt,preferredOpenerId:pt},CancellationToken.None))return!0}return this._defaultExternalOpener.openExternal(gt,{sourceUri:rt},CancellationToken.None)})}dispose(){this._validators.clear()}};OpenerService=__decorate$1H([__param$1E(0,ICodeEditorService),__param$1E(1,ICommandService)],OpenerService);var MarkerSeverity$1;(function(ct){ct[ct.Hint=1]="Hint",ct[ct.Info=2]="Info",ct[ct.Warning=4]="Warning",ct[ct.Error=8]="Error"})(MarkerSeverity$1||(MarkerSeverity$1={}));(function(ct){function nt(pt,mt){return mt-pt}ct.compare=nt;const ot=Object.create(null);ot[ct.Error]=localize("sev.error","Error"),ot[ct.Warning]=localize("sev.warning","Warning"),ot[ct.Info]=localize("sev.info","Info");function rt(pt){return ot[pt]||""}ct.toString=rt;function ut(pt){switch(pt){case Severity$2.Error:return ct.Error;case Severity$2.Warning:return ct.Warning;case Severity$2.Info:return ct.Info;case Severity$2.Ignore:return ct.Hint}}ct.fromSeverity=ut;function gt(pt){switch(pt){case ct.Error:return Severity$2.Error;case ct.Warning:return Severity$2.Warning;case ct.Info:return Severity$2.Info;case ct.Hint:return Severity$2.Ignore}}ct.toSeverity=gt})(MarkerSeverity$1||(MarkerSeverity$1={}));var IMarkerData;(function(ct){const nt="";function ot(ut){return rt(ut,!0)}ct.makeKey=ot;function rt(ut,gt){const pt=[nt];return ut.source?pt.push(ut.source.replace("","\\")):pt.push(nt),ut.code?typeof ut.code=="string"?pt.push(ut.code.replace("","\\")):pt.push(ut.code.value.replace("","\\")):pt.push(nt),ut.severity!==void 0&&ut.severity!==null?pt.push(MarkerSeverity$1.toString(ut.severity)):pt.push(nt),ut.message&&gt?pt.push(ut.message.replace("","\\")):pt.push(nt),ut.startLineNumber!==void 0&&ut.startLineNumber!==null?pt.push(ut.startLineNumber.toString()):pt.push(nt),ut.startColumn!==void 0&&ut.startColumn!==null?pt.push(ut.startColumn.toString()):pt.push(nt),ut.endLineNumber!==void 0&&ut.endLineNumber!==null?pt.push(ut.endLineNumber.toString()):pt.push(nt),ut.endColumn!==void 0&&ut.endColumn!==null?pt.push(ut.endColumn.toString()):pt.push(nt),pt.push(nt),pt.join("")}ct.makeKeyOptionalMessage=rt})(IMarkerData||(IMarkerData={}));const IMarkerService=createDecorator("markerService");var __decorate$1G=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1D=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};class MarkerDecorations extends Disposable{constructor(nt){super(),this.model=nt,this._markersData=new Map,this._register(toDisposable(()=>{this.model.deltaDecorations([...this._markersData.keys()],[]),this._markersData.clear()}))}update(nt,ot){const rt=[...this._markersData.keys()];this._markersData.clear();const ut=this.model.deltaDecorations(rt,ot);for(let gt=0;gt<ut.length;gt++)this._markersData.set(ut[gt],nt[gt]);return rt.length!==0||ut.length!==0}getMarker(nt){return this._markersData.get(nt.id)}}let MarkerDecorationsService=class extends Disposable{constructor(nt,ot){super(),this._markerService=ot,this._onDidChangeMarker=this._register(new Emitter$2),this._markerDecorations=new ResourceMap,nt.getModels().forEach(rt=>this._onModelAdded(rt)),this._register(nt.onModelAdded(this._onModelAdded,this)),this._register(nt.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(nt=>nt.dispose()),this._markerDecorations.clear()}getMarker(nt,ot){const rt=this._markerDecorations.get(nt);return rt&&rt.getMarker(ot)||null}_handleMarkerChange(nt){nt.forEach(ot=>{const rt=this._markerDecorations.get(ot);rt&&this._updateDecorations(rt)})}_onModelAdded(nt){const ot=new MarkerDecorations(nt);this._markerDecorations.set(nt.uri,ot),this._updateDecorations(ot)}_onModelRemoved(nt){var ot;const rt=this._markerDecorations.get(nt.uri);rt&&(rt.dispose(),this._markerDecorations.delete(nt.uri)),(nt.uri.scheme===Schemas.inMemory||nt.uri.scheme===Schemas.internal||nt.uri.scheme===Schemas.vscode)&&((ot=this._markerService)===null||ot===void 0||ot.read({resource:nt.uri}).map(ut=>ut.owner).forEach(ut=>this._markerService.remove(ut,[nt.uri])))}_updateDecorations(nt){const ot=this._markerService.read({resource:nt.model.uri,take:500}),rt=ot.map(ut=>({range:this._createDecorationRange(nt.model,ut),options:this._createDecorationOption(ut)}));nt.update(ot,rt)&&this._onDidChangeMarker.fire(nt.model)}_createDecorationRange(nt,ot){let rt=Range$2.lift(ot);if(ot.severity===MarkerSeverity$1.Hint&&!this._hasMarkerTag(ot,1)&&!this._hasMarkerTag(ot,2)&&(rt=rt.setEndPosition(rt.startLineNumber,rt.startColumn+2)),rt=nt.validateRange(rt),rt.isEmpty()){const ut=nt.getLineLastNonWhitespaceColumn(rt.startLineNumber)||nt.getLineMaxColumn(rt.startLineNumber);if(ut===1||rt.endColumn>=ut)return rt;const gt=nt.getWordAtPosition(rt.getStartPosition());gt&&(rt=new Range$2(rt.startLineNumber,gt.startColumn,rt.endLineNumber,gt.endColumn))}else if(ot.endColumn===Number.MAX_VALUE&&ot.startColumn===1&&rt.startLineNumber===rt.endLineNumber){const ut=nt.getLineFirstNonWhitespaceColumn(ot.startLineNumber);ut<rt.endColumn&&(rt=new Range$2(rt.startLineNumber,ut,rt.endLineNumber,rt.endColumn),ot.startColumn=ut)}return rt}_createDecorationOption(nt){let ot,rt,ut,gt,pt;switch(nt.severity){case MarkerSeverity$1.Hint:this._hasMarkerTag(nt,2)?ot=void 0:this._hasMarkerTag(nt,1)?ot="squiggly-unnecessary":ot="squiggly-hint",ut=0;break;case MarkerSeverity$1.Warning:ot="squiggly-warning",rt=themeColorFromId(overviewRulerWarning),ut=20,pt={color:themeColorFromId(minimapWarning),position:MinimapPosition.Inline};break;case MarkerSeverity$1.Info:ot="squiggly-info",rt=themeColorFromId(overviewRulerInfo),ut=10;break;case MarkerSeverity$1.Error:default:ot="squiggly-error",rt=themeColorFromId(overviewRulerError),ut=30,pt={color:themeColorFromId(minimapError),position:MinimapPosition.Inline};break}return nt.tags&&(nt.tags.indexOf(1)!==-1&&(gt="squiggly-inline-unnecessary"),nt.tags.indexOf(2)!==-1&&(gt="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:ot,showIfCollapsed:!0,overviewRuler:{color:rt,position:OverviewRulerLane.Right},minimap:pt,zIndex:ut,inlineClassName:gt}}_hasMarkerTag(nt,ot){return nt.tags?nt.tags.indexOf(ot)>=0:!1}};MarkerDecorationsService=__decorate$1G([__param$1D(0,IModelService),__param$1D(1,IMarkerService)],MarkerDecorationsService);var __decorate$1F=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1C=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};function MODEL_ID(ct){return ct.toString()}function computeModelSha1(ct){const nt=new StringSHA1,ot=ct.createSnapshot();let rt;for(;rt=ot.read();)nt.update(rt);return nt.digest()}class ModelData{constructor(nt,ot,rt){this.model=nt,this._modelEventListeners=new DisposableStore,this.model=nt,this._modelEventListeners.add(nt.onWillDispose(()=>ot(nt))),this._modelEventListeners.add(nt.onDidChangeLanguage(ut=>rt(nt,ut)))}dispose(){this._modelEventListeners.dispose()}}const DEFAULT_EOL=isLinux||isMacintosh?1:2;class DisposedModelInfo{constructor(nt,ot,rt,ut,gt,pt,mt,vt){this.uri=nt,this.initialUndoRedoSnapshot=ot,this.time=rt,this.sharesUndoRedoStack=ut,this.heapSize=gt,this.sha1=pt,this.versionId=mt,this.alternativeVersionId=vt}}let ModelService=class Lo extends Disposable{constructor(nt,ot,rt,ut,gt){super(),this._configurationService=nt,this._resourcePropertiesService=ot,this._undoRedoService=rt,this._languageService=ut,this._languageConfigurationService=gt,this._onModelAdded=this._register(new Emitter$2),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new Emitter$2),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new Emitter$2),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration(pt=>this._updateModelOptions(pt))),this._updateModelOptions(void 0)}static _readModelOptions(nt,ot){var rt;let ut=EDITOR_MODEL_DEFAULTS.tabSize;if(nt.editor&&typeof nt.editor.tabSize<"u"){const xt=parseInt(nt.editor.tabSize,10);isNaN(xt)||(ut=xt),ut<1&&(ut=1)}let gt="tabSize";if(nt.editor&&typeof nt.editor.indentSize<"u"&&nt.editor.indentSize!=="tabSize"){const xt=parseInt(nt.editor.indentSize,10);isNaN(xt)||(gt=Math.max(xt,1))}let pt=EDITOR_MODEL_DEFAULTS.insertSpaces;nt.editor&&typeof nt.editor.insertSpaces<"u"&&(pt=nt.editor.insertSpaces==="false"?!1:!!nt.editor.insertSpaces);let mt=DEFAULT_EOL;const vt=nt.eol;vt===`\r
`?mt=2:vt===`
`&&(mt=1);let St=EDITOR_MODEL_DEFAULTS.trimAutoWhitespace;nt.editor&&typeof nt.editor.trimAutoWhitespace<"u"&&(St=nt.editor.trimAutoWhitespace==="false"?!1:!!nt.editor.trimAutoWhitespace);let yt=EDITOR_MODEL_DEFAULTS.detectIndentation;nt.editor&&typeof nt.editor.detectIndentation<"u"&&(yt=nt.editor.detectIndentation==="false"?!1:!!nt.editor.detectIndentation);let wt=EDITOR_MODEL_DEFAULTS.largeFileOptimizations;nt.editor&&typeof nt.editor.largeFileOptimizations<"u"&&(wt=nt.editor.largeFileOptimizations==="false"?!1:!!nt.editor.largeFileOptimizations);let Lt=EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions;return!((rt=nt.editor)===null||rt===void 0)&&rt.bracketPairColorization&&typeof nt.editor.bracketPairColorization=="object"&&(Lt={enabled:!!nt.editor.bracketPairColorization.enabled,independentColorPoolPerBracketType:!!nt.editor.bracketPairColorization.independentColorPoolPerBracketType}),{isForSimpleWidget:ot,tabSize:ut,indentSize:gt,insertSpaces:pt,detectIndentation:yt,defaultEOL:mt,trimAutoWhitespace:St,largeFileOptimizations:wt,bracketPairColorizationOptions:Lt}}_getEOL(nt,ot){if(nt)return this._resourcePropertiesService.getEOL(nt,ot);const rt=this._configurationService.getValue("files.eol",{overrideIdentifier:ot});return rt&&typeof rt=="string"&&rt!=="auto"?rt:OS===3||OS===2?`
`:`\r
`}_shouldRestoreUndoStack(){const nt=this._configurationService.getValue("files.restoreUndoStack");return typeof nt=="boolean"?nt:!0}getCreationOptions(nt,ot,rt){const ut=typeof nt=="string"?nt:nt.languageId;let gt=this._modelCreationOptionsByLanguageAndResource[ut+ot];if(!gt){const pt=this._configurationService.getValue("editor",{overrideIdentifier:ut,resource:ot}),mt=this._getEOL(ot,ut);gt=Lo._readModelOptions({editor:pt,eol:mt},rt),this._modelCreationOptionsByLanguageAndResource[ut+ot]=gt}return gt}_updateModelOptions(nt){const ot=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const rt=Object.keys(this._models);for(let ut=0,gt=rt.length;ut<gt;ut++){const pt=rt[ut],mt=this._models[pt],vt=mt.model.getLanguageId(),St=mt.model.uri;if(nt&&!nt.affectsConfiguration("editor",{overrideIdentifier:vt,resource:St})&&!nt.affectsConfiguration("files.eol",{overrideIdentifier:vt,resource:St}))continue;const yt=ot[vt+St],wt=this.getCreationOptions(vt,St,mt.model.isForSimpleWidget);Lo._setModelOptionsForModel(mt.model,wt,yt)}}static _setModelOptionsForModel(nt,ot,rt){rt&&rt.defaultEOL!==ot.defaultEOL&&nt.getLineCount()===1&&nt.setEOL(ot.defaultEOL===1?0:1),!(rt&&rt.detectIndentation===ot.detectIndentation&&rt.insertSpaces===ot.insertSpaces&&rt.tabSize===ot.tabSize&&rt.indentSize===ot.indentSize&&rt.trimAutoWhitespace===ot.trimAutoWhitespace&&equals$1(rt.bracketPairColorizationOptions,ot.bracketPairColorizationOptions))&&(ot.detectIndentation?(nt.detectIndentation(ot.insertSpaces,ot.tabSize),nt.updateOptions({trimAutoWhitespace:ot.trimAutoWhitespace,bracketColorizationOptions:ot.bracketPairColorizationOptions})):nt.updateOptions({insertSpaces:ot.insertSpaces,tabSize:ot.tabSize,indentSize:ot.indentSize,trimAutoWhitespace:ot.trimAutoWhitespace,bracketColorizationOptions:ot.bracketPairColorizationOptions}))}_insertDisposedModel(nt){this._disposedModels.set(MODEL_ID(nt.uri),nt),this._disposedModelsHeapSize+=nt.heapSize}_removeDisposedModel(nt){const ot=this._disposedModels.get(MODEL_ID(nt));return ot&&(this._disposedModelsHeapSize-=ot.heapSize),this._disposedModels.delete(MODEL_ID(nt)),ot}_ensureDisposedModelsHeapSize(nt){if(this._disposedModelsHeapSize>nt){const ot=[];for(this._disposedModels.forEach(rt=>{rt.sharesUndoRedoStack||ot.push(rt)}),ot.sort((rt,ut)=>rt.time-ut.time);ot.length>0&&this._disposedModelsHeapSize>nt;){const rt=ot.shift();this._removeDisposedModel(rt.uri),rt.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(rt.initialUndoRedoSnapshot)}}}_createModelData(nt,ot,rt,ut){const gt=this.getCreationOptions(ot,rt,ut),pt=new TextModel(nt,ot,gt,rt,this._undoRedoService,this._languageService,this._languageConfigurationService);if(rt&&this._disposedModels.has(MODEL_ID(rt))){const St=this._removeDisposedModel(rt),yt=this._undoRedoService.getElements(rt),wt=computeModelSha1(pt)===St.sha1;if(wt||St.sharesUndoRedoStack){for(const Lt of yt.past)isEditStackElement(Lt)&&Lt.matchesResource(rt)&&Lt.setModel(pt);for(const Lt of yt.future)isEditStackElement(Lt)&&Lt.matchesResource(rt)&&Lt.setModel(pt);this._undoRedoService.setElementsValidFlag(rt,!0,Lt=>isEditStackElement(Lt)&&Lt.matchesResource(rt)),wt&&(pt._overwriteVersionId(St.versionId),pt._overwriteAlternativeVersionId(St.alternativeVersionId),pt._overwriteInitialUndoRedoSnapshot(St.initialUndoRedoSnapshot))}else St.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(St.initialUndoRedoSnapshot)}const mt=MODEL_ID(pt.uri);if(this._models[mt])throw new Error("ModelService: Cannot add model because it already exists!");const vt=new ModelData(pt,St=>this._onWillDispose(St),(St,yt)=>this._onDidChangeLanguage(St,yt));return this._models[mt]=vt,vt}createModel(nt,ot,rt,ut=!1){let gt;return ot?gt=this._createModelData(nt,ot,rt,ut):gt=this._createModelData(nt,PLAINTEXT_LANGUAGE_ID,rt,ut),this._onModelAdded.fire(gt.model),gt.model}getModels(){const nt=[],ot=Object.keys(this._models);for(let rt=0,ut=ot.length;rt<ut;rt++){const gt=ot[rt];nt.push(this._models[gt].model)}return nt}getModel(nt){const ot=MODEL_ID(nt),rt=this._models[ot];return rt?rt.model:null}_schemaShouldMaintainUndoRedoElements(nt){return nt.scheme===Schemas.file||nt.scheme===Schemas.vscodeRemote||nt.scheme===Schemas.vscodeUserData||nt.scheme===Schemas.vscodeNotebookCell||nt.scheme==="fake-fs"}_onWillDispose(nt){const ot=MODEL_ID(nt.uri),rt=this._models[ot],ut=this._undoRedoService.getUriComparisonKey(nt.uri)!==nt.uri.toString();let gt=!1,pt=0;if(ut||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(nt.uri)){const vt=this._undoRedoService.getElements(nt.uri);if(vt.past.length>0||vt.future.length>0){for(const St of vt.past)isEditStackElement(St)&&St.matchesResource(nt.uri)&&(gt=!0,pt+=St.heapSize(nt.uri),St.setModel(nt.uri));for(const St of vt.future)isEditStackElement(St)&&St.matchesResource(nt.uri)&&(gt=!0,pt+=St.heapSize(nt.uri),St.setModel(nt.uri))}}const mt=Lo.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK;if(gt)if(!ut&&pt>mt){const vt=rt.model.getInitialUndoRedoSnapshot();vt!==null&&this._undoRedoService.restoreSnapshot(vt)}else this._ensureDisposedModelsHeapSize(mt-pt),this._undoRedoService.setElementsValidFlag(nt.uri,!1,vt=>isEditStackElement(vt)&&vt.matchesResource(nt.uri)),this._insertDisposedModel(new DisposedModelInfo(nt.uri,rt.model.getInitialUndoRedoSnapshot(),Date.now(),ut,pt,computeModelSha1(nt),nt.getVersionId(),nt.getAlternativeVersionId()));else if(!ut){const vt=rt.model.getInitialUndoRedoSnapshot();vt!==null&&this._undoRedoService.restoreSnapshot(vt)}delete this._models[ot],rt.dispose(),delete this._modelCreationOptionsByLanguageAndResource[nt.getLanguageId()+nt.uri],this._onModelRemoved.fire(nt)}_onDidChangeLanguage(nt,ot){const rt=ot.oldLanguage,ut=nt.getLanguageId(),gt=this.getCreationOptions(rt,nt.uri,nt.isForSimpleWidget),pt=this.getCreationOptions(ut,nt.uri,nt.isForSimpleWidget);Lo._setModelOptionsForModel(nt,pt,gt),this._onModelModeChanged.fire({model:nt,oldLanguageId:rt})}};ModelService.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024;ModelService=__decorate$1F([__param$1C(0,IConfigurationService),__param$1C(1,ITextResourcePropertiesService),__param$1C(2,IUndoRedoService),__param$1C(3,ILanguageService),__param$1C(4,ILanguageConfigurationService)],ModelService);const standaloneQuickInput="";class PagedRenderer{get templateId(){return this.renderer.templateId}constructor(nt,ot){this.renderer=nt,this.modelProvider=ot}renderTemplate(nt){return{data:this.renderer.renderTemplate(nt),disposable:Disposable.None}}renderElement(nt,ot,rt,ut){var gt;if((gt=rt.disposable)===null||gt===void 0||gt.dispose(),!rt.data)return;const pt=this.modelProvider();if(pt.isResolved(nt))return this.renderer.renderElement(pt.get(nt),nt,rt.data,ut);const mt=new CancellationTokenSource$1,vt=pt.resolve(nt,mt.token);rt.disposable={dispose:()=>mt.cancel()},this.renderer.renderPlaceholder(nt,rt.data),vt.then(St=>this.renderer.renderElement(St,nt,rt.data,ut))}disposeTemplate(nt){nt.disposable&&(nt.disposable.dispose(),nt.disposable=void 0),nt.data&&(this.renderer.disposeTemplate(nt.data),nt.data=void 0)}}class PagedAccessibilityProvider{constructor(nt,ot){this.modelProvider=nt,this.accessibilityProvider=ot}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(nt){const ot=this.modelProvider();return ot.isResolved(nt)?this.accessibilityProvider.getAriaLabel(ot.get(nt)):null}}function fromPagedListOptions(ct,nt){return Object.assign(Object.assign({},nt),{accessibilityProvider:nt.accessibilityProvider&&new PagedAccessibilityProvider(ct,nt.accessibilityProvider)})}class PagedList{constructor(nt,ot,rt,ut,gt={}){const pt=()=>this.model,mt=ut.map(vt=>new PagedRenderer(vt,pt));this.list=new List(nt,ot,rt,mt,fromPagedListOptions(pt,gt))}updateOptions(nt){this.list.updateOptions(nt)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return Event.map(this.list.onMouseDblClick,({element:nt,index:ot,browserEvent:rt})=>({element:nt===void 0?void 0:this._model.get(nt),index:ot,browserEvent:rt}))}get onPointer(){return Event.map(this.list.onPointer,({element:nt,index:ot,browserEvent:rt})=>({element:nt===void 0?void 0:this._model.get(nt),index:ot,browserEvent:rt}))}get onDidChangeSelection(){return Event.map(this.list.onDidChangeSelection,({elements:nt,indexes:ot,browserEvent:rt})=>({elements:nt.map(ut=>this._model.get(ut)),indexes:ot,browserEvent:rt}))}get model(){return this._model}set model(nt){this._model=nt,this.list.splice(0,this.list.length,range(nt.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(nt=>this.model.get(nt))}style(nt){this.list.style(nt)}dispose(){this.list.dispose()}}const splitview="",defaultStyles={separatorBorder:Color.transparent};class ViewItem{set size(nt){this._size=nt}get size(){return this._size}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(nt,ot){var rt,ut;nt!==this.visible&&(nt?(this.size=clamp(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof ot=="number"?ot:this.size,this.size=0),this.container.classList.toggle("visible",nt),(ut=(rt=this.view).setVisible)===null||ut===void 0||ut.call(rt,nt))}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){var nt;return(nt=this.view.proportionalLayout)!==null&&nt!==void 0?nt:!0}get snap(){return!!this.view.snap}set enabled(nt){this.container.style.pointerEvents=nt?"":"none"}constructor(nt,ot,rt,ut){this.container=nt,this.view=ot,this.disposable=ut,this._cachedVisibleSize=void 0,typeof rt=="number"?(this._size=rt,this._cachedVisibleSize=void 0,nt.classList.add("visible")):(this._size=0,this._cachedVisibleSize=rt.cachedVisibleSize)}layout(nt,ot){this.layoutContainer(nt),this.view.layout(this.size,nt,ot)}dispose(){return this.disposable.dispose(),this.view}}class VerticalViewItem extends ViewItem{layoutContainer(nt){this.container.style.top=`${nt}px`,this.container.style.height=`${this.size}px`}}class HorizontalViewItem extends ViewItem{layoutContainer(nt){this.container.style.left=`${nt}px`,this.container.style.width=`${this.size}px`}}var State;(function(ct){ct[ct.Idle=0]="Idle",ct[ct.Busy=1]="Busy"})(State||(State={}));var Sizing;(function(ct){ct.Distribute={type:"distribute"};function nt(rt){return{type:"split",index:rt}}ct.Split=nt;function ot(rt){return{type:"invisible",cachedVisibleSize:rt}}ct.Invisible=ot})(Sizing||(Sizing={}));class SplitView extends Disposable{get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(nt){for(const ot of this.sashItems)ot.sash.orthogonalStartSash=nt;this._orthogonalStartSash=nt}set orthogonalEndSash(nt){for(const ot of this.sashItems)ot.sash.orthogonalEndSash=nt;this._orthogonalEndSash=nt}set startSnappingEnabled(nt){this._startSnappingEnabled!==nt&&(this._startSnappingEnabled=nt,this.updateSashEnablement())}set endSnappingEnabled(nt){this._endSnappingEnabled!==nt&&(this._endSnappingEnabled=nt,this.updateSashEnablement())}constructor(nt,ot={}){var rt,ut,gt,pt,mt;super(),this.size=0,this.contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=State.Idle,this._onDidSashChange=this._register(new Emitter$2),this._onDidSashReset=this._register(new Emitter$2),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=(rt=ot.orientation)!==null&&rt!==void 0?rt:0,this.inverseAltBehavior=(ut=ot.inverseAltBehavior)!==null&&ut!==void 0?ut:!1,this.proportionalLayout=(gt=ot.proportionalLayout)!==null&&gt!==void 0?gt:!0,this.getSashOrthogonalSize=ot.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),nt.appendChild(this.el),this.sashContainer=append$1(this.el,$$d(".sash-container")),this.viewContainer=$$d(".split-view-container"),this.scrollable=new Scrollable({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame}),this.scrollableElement=this._register(new SmoothScrollableElement(this.viewContainer,{vertical:this.orientation===0?(pt=ot.scrollbarVisibility)!==null&&pt!==void 0?pt:1:2,horizontal:this.orientation===1?(mt=ot.scrollbarVisibility)!==null&&mt!==void 0?mt:1:2},this.scrollable));const vt=this._register(new DomEmitter(this.viewContainer,"scroll")).event;this._register(vt(St=>{const yt=this.scrollableElement.getScrollPosition(),wt=Math.abs(this.viewContainer.scrollLeft-yt.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,Lt=Math.abs(this.viewContainer.scrollTop-yt.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(wt!==void 0||Lt!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:wt,scrollTop:Lt})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(St=>{St.scrollTopChanged&&(this.viewContainer.scrollTop=St.scrollTop),St.scrollLeftChanged&&(this.viewContainer.scrollLeft=St.scrollLeft)})),append$1(this.el,this.scrollableElement.getDomNode()),this.style(ot.styles||defaultStyles),ot.descriptor&&(this.size=ot.descriptor.size,ot.descriptor.views.forEach((St,yt)=>{const wt=isUndefined(St.visible)||St.visible?St.size:{type:"invisible",cachedVisibleSize:St.size},Lt=St.view;this.doAddView(Lt,wt,yt,!0)}),this.contentSize=this.viewItems.reduce((St,yt)=>St+yt.size,0),this.saveProportions())}style(nt){nt.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",nt.separatorBorder.toString()))}addView(nt,ot,rt=this.viewItems.length,ut){this.doAddView(nt,ot,rt,ut)}layout(nt,ot){const rt=Math.max(this.size,this.contentSize);if(this.size=nt,this.layoutContext=ot,this.proportions){let ut=0;for(let gt=0;gt<this.viewItems.length;gt++){const pt=this.viewItems[gt],mt=this.proportions[gt];typeof mt=="number"?ut+=mt:nt-=pt.size}for(let gt=0;gt<this.viewItems.length;gt++){const pt=this.viewItems[gt],mt=this.proportions[gt];typeof mt=="number"&&(pt.size=clamp(Math.round(mt*nt/ut),pt.minimumSize,pt.maximumSize))}}else{const ut=range(this.viewItems.length),gt=ut.filter(mt=>this.viewItems[mt].priority===1),pt=ut.filter(mt=>this.viewItems[mt].priority===2);this.resize(this.viewItems.length-1,nt-rt,void 0,gt,pt)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this.contentSize>0&&(this.proportions=this.viewItems.map(nt=>nt.proportionalLayout?nt.size/this.contentSize:void 0))}onSashStart({sash:nt,start:ot,alt:rt}){for(const mt of this.viewItems)mt.enabled=!1;const ut=this.sashItems.findIndex(mt=>mt.sash===nt),gt=combinedDisposable(addDisposableListener(document.body,"keydown",mt=>pt(this.sashDragState.current,mt.altKey)),addDisposableListener(document.body,"keyup",()=>pt(this.sashDragState.current,!1))),pt=(mt,vt)=>{const St=this.viewItems.map(It=>It.size);let yt=Number.NEGATIVE_INFINITY,wt=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(vt=!vt),vt)if(ut===this.sashItems.length-1){const kt=this.viewItems[ut];yt=(kt.minimumSize-kt.size)/2,wt=(kt.maximumSize-kt.size)/2}else{const kt=this.viewItems[ut+1];yt=(kt.size-kt.maximumSize)/2,wt=(kt.size-kt.minimumSize)/2}let Lt,xt;if(!vt){const It=range(ut,-1),kt=range(ut+1,this.viewItems.length),At=It.reduce((Ut,qt)=>Ut+(this.viewItems[qt].minimumSize-St[qt]),0),Tt=It.reduce((Ut,qt)=>Ut+(this.viewItems[qt].viewMaximumSize-St[qt]),0),Rt=kt.length===0?Number.POSITIVE_INFINITY:kt.reduce((Ut,qt)=>Ut+(St[qt]-this.viewItems[qt].minimumSize),0),Nt=kt.length===0?Number.NEGATIVE_INFINITY:kt.reduce((Ut,qt)=>Ut+(St[qt]-this.viewItems[qt].viewMaximumSize),0),Pt=Math.max(At,Nt),Ft=Math.min(Rt,Tt),Kt=this.findFirstSnapIndex(It),Bt=this.findFirstSnapIndex(kt);if(typeof Kt=="number"){const Ut=this.viewItems[Kt],qt=Math.floor(Ut.viewMinimumSize/2);Lt={index:Kt,limitDelta:Ut.visible?Pt-qt:Pt+qt,size:Ut.size}}if(typeof Bt=="number"){const Ut=this.viewItems[Bt],qt=Math.floor(Ut.viewMinimumSize/2);xt={index:Bt,limitDelta:Ut.visible?Ft+qt:Ft-qt,size:Ut.size}}}this.sashDragState={start:mt,current:mt,index:ut,sizes:St,minDelta:yt,maxDelta:wt,alt:vt,snapBefore:Lt,snapAfter:xt,disposable:gt}};pt(ot,rt)}onSashChange({current:nt}){const{index:ot,start:rt,sizes:ut,alt:gt,minDelta:pt,maxDelta:mt,snapBefore:vt,snapAfter:St}=this.sashDragState;this.sashDragState.current=nt;const yt=nt-rt,wt=this.resize(ot,yt,ut,void 0,void 0,pt,mt,vt,St);if(gt){const Lt=ot===this.sashItems.length-1,xt=this.viewItems.map(Nt=>Nt.size),It=Lt?ot:ot+1,kt=this.viewItems[It],At=kt.size-kt.maximumSize,Tt=kt.size-kt.minimumSize,Rt=Lt?ot-1:ot+1;this.resize(Rt,-wt,xt,void 0,void 0,At,Tt)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(nt){this._onDidSashChange.fire(nt),this.sashDragState.disposable.dispose(),this.saveProportions();for(const ot of this.viewItems)ot.enabled=!0}onViewChange(nt,ot){const rt=this.viewItems.indexOf(nt);rt<0||rt>=this.viewItems.length||(ot=typeof ot=="number"?ot:nt.size,ot=clamp(ot,nt.minimumSize,nt.maximumSize),this.inverseAltBehavior&&rt>0?(this.resize(rt-1,Math.floor((nt.size-ot)/2)),this.distributeEmptySpace(),this.layoutViews()):(nt.size=ot,this.relayout([rt],void 0)))}resizeView(nt,ot){if(this.state!==State.Idle)throw new Error("Cant modify splitview");if(this.state=State.Busy,nt<0||nt>=this.viewItems.length)return;const rt=range(this.viewItems.length).filter(mt=>mt!==nt),ut=[...rt.filter(mt=>this.viewItems[mt].priority===1),nt],gt=rt.filter(mt=>this.viewItems[mt].priority===2),pt=this.viewItems[nt];ot=Math.round(ot),ot=clamp(ot,pt.minimumSize,Math.min(pt.maximumSize,this.size)),pt.size=ot,this.relayout(ut,gt),this.state=State.Idle}distributeViewSizes(){const nt=[];let ot=0;for(const mt of this.viewItems)mt.maximumSize-mt.minimumSize>0&&(nt.push(mt),ot+=mt.size);const rt=Math.floor(ot/nt.length);for(const mt of nt)mt.size=clamp(rt,mt.minimumSize,mt.maximumSize);const ut=range(this.viewItems.length),gt=ut.filter(mt=>this.viewItems[mt].priority===1),pt=ut.filter(mt=>this.viewItems[mt].priority===2);this.relayout(gt,pt)}getViewSize(nt){return nt<0||nt>=this.viewItems.length?-1:this.viewItems[nt].size}doAddView(nt,ot,rt=this.viewItems.length,ut){if(this.state!==State.Idle)throw new Error("Cant modify splitview");this.state=State.Busy;const gt=$$d(".split-view-view");rt===this.viewItems.length?this.viewContainer.appendChild(gt):this.viewContainer.insertBefore(gt,this.viewContainer.children.item(rt));const pt=nt.onDidChange(Lt=>this.onViewChange(yt,Lt)),mt=toDisposable(()=>this.viewContainer.removeChild(gt)),vt=combinedDisposable(pt,mt);let St;typeof ot=="number"?St=ot:ot.type==="split"?St=this.getViewSize(ot.index)/2:ot.type==="invisible"?St={cachedVisibleSize:ot.cachedVisibleSize}:St=nt.minimumSize;const yt=this.orientation===0?new VerticalViewItem(gt,nt,St,vt):new HorizontalViewItem(gt,nt,St,vt);if(this.viewItems.splice(rt,0,yt),this.viewItems.length>1){const Lt={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},xt=this.orientation===0?new Sash(this.sashContainer,{getHorizontalSashTop:Ut=>this.getSashPosition(Ut),getHorizontalSashWidth:this.getSashOrthogonalSize},Object.assign(Object.assign({},Lt),{orientation:1})):new Sash(this.sashContainer,{getVerticalSashLeft:Ut=>this.getSashPosition(Ut),getVerticalSashHeight:this.getSashOrthogonalSize},Object.assign(Object.assign({},Lt),{orientation:0})),It=this.orientation===0?Ut=>({sash:xt,start:Ut.startY,current:Ut.currentY,alt:Ut.altKey}):Ut=>({sash:xt,start:Ut.startX,current:Ut.currentX,alt:Ut.altKey}),At=Event.map(xt.onDidStart,It)(this.onSashStart,this),Rt=Event.map(xt.onDidChange,It)(this.onSashChange,this),Pt=Event.map(xt.onDidEnd,()=>this.sashItems.findIndex(Ut=>Ut.sash===xt))(this.onSashEnd,this),Ft=xt.onDidReset(()=>{const Ut=this.sashItems.findIndex(_i=>_i.sash===xt),qt=range(Ut,-1),Yt=range(Ut+1,this.viewItems.length),Zt=this.findFirstSnapIndex(qt),Xt=this.findFirstSnapIndex(Yt);typeof Zt=="number"&&!this.viewItems[Zt].visible||typeof Xt=="number"&&!this.viewItems[Xt].visible||this._onDidSashReset.fire(Ut)}),Kt=combinedDisposable(At,Rt,Pt,Ft,xt),Bt={sash:xt,disposable:Kt};this.sashItems.splice(rt-1,0,Bt)}gt.appendChild(nt.element);let wt;typeof ot!="number"&&ot.type==="split"&&(wt=[ot.index]),ut||this.relayout([rt],wt),this.state=State.Idle,!ut&&typeof ot!="number"&&ot.type==="distribute"&&this.distributeViewSizes()}relayout(nt,ot){const rt=this.viewItems.reduce((ut,gt)=>ut+gt.size,0);this.resize(this.viewItems.length-1,this.size-rt,void 0,nt,ot),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(nt,ot,rt=this.viewItems.map(yt=>yt.size),ut,gt,pt=Number.NEGATIVE_INFINITY,mt=Number.POSITIVE_INFINITY,vt,St){if(nt<0||nt>=this.viewItems.length)return 0;const yt=range(nt,-1),wt=range(nt+1,this.viewItems.length);if(gt)for(const Bt of gt)pushToStart(yt,Bt),pushToStart(wt,Bt);if(ut)for(const Bt of ut)pushToEnd(yt,Bt),pushToEnd(wt,Bt);const Lt=yt.map(Bt=>this.viewItems[Bt]),xt=yt.map(Bt=>rt[Bt]),It=wt.map(Bt=>this.viewItems[Bt]),kt=wt.map(Bt=>rt[Bt]),At=yt.reduce((Bt,Ut)=>Bt+(this.viewItems[Ut].minimumSize-rt[Ut]),0),Tt=yt.reduce((Bt,Ut)=>Bt+(this.viewItems[Ut].maximumSize-rt[Ut]),0),Rt=wt.length===0?Number.POSITIVE_INFINITY:wt.reduce((Bt,Ut)=>Bt+(rt[Ut]-this.viewItems[Ut].minimumSize),0),Nt=wt.length===0?Number.NEGATIVE_INFINITY:wt.reduce((Bt,Ut)=>Bt+(rt[Ut]-this.viewItems[Ut].maximumSize),0),Pt=Math.max(At,Nt,pt),Ft=Math.min(Rt,Tt,mt);let Kt=!1;if(vt){const Bt=this.viewItems[vt.index],Ut=ot>=vt.limitDelta;Kt=Ut!==Bt.visible,Bt.setVisible(Ut,vt.size)}if(!Kt&&St){const Bt=this.viewItems[St.index],Ut=ot<St.limitDelta;Kt=Ut!==Bt.visible,Bt.setVisible(Ut,St.size)}if(Kt)return this.resize(nt,ot,rt,ut,gt,pt,mt);ot=clamp(ot,Pt,Ft);for(let Bt=0,Ut=ot;Bt<Lt.length;Bt++){const qt=Lt[Bt],Yt=clamp(xt[Bt]+Ut,qt.minimumSize,qt.maximumSize),Zt=Yt-xt[Bt];Ut-=Zt,qt.size=Yt}for(let Bt=0,Ut=ot;Bt<It.length;Bt++){const qt=It[Bt],Yt=clamp(kt[Bt]-Ut,qt.minimumSize,qt.maximumSize),Zt=Yt-kt[Bt];Ut+=Zt,qt.size=Yt}return ot}distributeEmptySpace(nt){const ot=this.viewItems.reduce((mt,vt)=>mt+vt.size,0);let rt=this.size-ot;const ut=range(this.viewItems.length-1,-1),gt=ut.filter(mt=>this.viewItems[mt].priority===1),pt=ut.filter(mt=>this.viewItems[mt].priority===2);for(const mt of pt)pushToStart(ut,mt);for(const mt of gt)pushToEnd(ut,mt);typeof nt=="number"&&pushToEnd(ut,nt);for(let mt=0;rt!==0&&mt<ut.length;mt++){const vt=this.viewItems[ut[mt]],St=clamp(vt.size+rt,vt.minimumSize,vt.maximumSize),yt=St-vt.size;rt-=yt,vt.size=St}}layoutViews(){this.contentSize=this.viewItems.reduce((ot,rt)=>ot+rt.size,0);let nt=0;for(const ot of this.viewItems)ot.layout(nt,this.layoutContext),nt+=ot.size;this.sashItems.forEach(ot=>ot.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this.contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this.contentSize})}updateSashEnablement(){let nt=!1;const ot=this.viewItems.map(vt=>nt=vt.size-vt.minimumSize>0||nt);nt=!1;const rt=this.viewItems.map(vt=>nt=vt.maximumSize-vt.size>0||nt),ut=[...this.viewItems].reverse();nt=!1;const gt=ut.map(vt=>nt=vt.size-vt.minimumSize>0||nt).reverse();nt=!1;const pt=ut.map(vt=>nt=vt.maximumSize-vt.size>0||nt).reverse();let mt=0;for(let vt=0;vt<this.sashItems.length;vt++){const{sash:St}=this.sashItems[vt],yt=this.viewItems[vt];mt+=yt.size;const wt=!(ot[vt]&&pt[vt+1]),Lt=!(rt[vt]&&gt[vt+1]);if(wt&&Lt){const xt=range(vt,-1),It=range(vt+1,this.viewItems.length),kt=this.findFirstSnapIndex(xt),At=this.findFirstSnapIndex(It),Tt=typeof kt=="number"&&!this.viewItems[kt].visible,Rt=typeof At=="number"&&!this.viewItems[At].visible;Tt&&gt[vt]&&(mt>0||this.startSnappingEnabled)?St.state=1:Rt&&ot[vt]&&(mt<this.contentSize||this.endSnappingEnabled)?St.state=2:St.state=0}else wt&&!Lt?St.state=1:!wt&&Lt?St.state=2:St.state=3}}getSashPosition(nt){let ot=0;for(let rt=0;rt<this.sashItems.length;rt++)if(ot+=this.viewItems[rt].size,this.sashItems[rt].sash===nt)return ot;return 0}findFirstSnapIndex(nt){for(const ot of nt){const rt=this.viewItems[ot];if(rt.visible&&rt.snap)return ot}for(const ot of nt){const rt=this.viewItems[ot];if(rt.visible&&rt.maximumSize-rt.minimumSize>0)return;if(!rt.visible&&rt.snap)return ot}}dispose(){var nt;(nt=this.sashDragState)===null||nt===void 0||nt.disposable.dispose(),dispose(this.viewItems),this.viewItems=[],this.sashItems.forEach(ot=>ot.disposable.dispose()),this.sashItems=[],super.dispose()}}const table="";class TableListRenderer{constructor(nt,ot,rt){this.columns=nt,this.getColumnSize=rt,this.templateId=TableListRenderer.TemplateId,this.renderedTemplates=new Set;const ut=new Map(ot.map(gt=>[gt.templateId,gt]));this.renderers=[];for(const gt of nt){const pt=ut.get(gt.templateId);if(!pt)throw new Error(`Table cell renderer for template id ${gt.templateId} not found.`);this.renderers.push(pt)}}renderTemplate(nt){const ot=append$1(nt,$$d(".monaco-table-tr")),rt=[],ut=[];for(let pt=0;pt<this.columns.length;pt++){const mt=this.renderers[pt],vt=append$1(ot,$$d(".monaco-table-td",{"data-col-index":pt}));vt.style.width=`${this.getColumnSize(pt)}px`,rt.push(vt),ut.push(mt.renderTemplate(vt))}const gt={container:nt,cellContainers:rt,cellTemplateData:ut};return this.renderedTemplates.add(gt),gt}renderElement(nt,ot,rt,ut){for(let gt=0;gt<this.columns.length;gt++){const mt=this.columns[gt].project(nt);this.renderers[gt].renderElement(mt,ot,rt.cellTemplateData[gt],ut)}}disposeElement(nt,ot,rt,ut){for(let gt=0;gt<this.columns.length;gt++){const pt=this.renderers[gt];if(pt.disposeElement){const vt=this.columns[gt].project(nt);pt.disposeElement(vt,ot,rt.cellTemplateData[gt],ut)}}}disposeTemplate(nt){for(let ot=0;ot<this.columns.length;ot++)this.renderers[ot].disposeTemplate(nt.cellTemplateData[ot]);clearNode(nt.container),this.renderedTemplates.delete(nt)}layoutColumn(nt,ot){for(const{cellContainers:rt}of this.renderedTemplates)rt[nt].style.width=`${ot}px`}}TableListRenderer.TemplateId="row";function asListVirtualDelegate(ct){return{getHeight(nt){return ct.getHeight(nt)},getTemplateId(){return TableListRenderer.TemplateId}}}class ColumnHeader{get minimumSize(){var nt;return(nt=this.column.minimumWidth)!==null&&nt!==void 0?nt:120}get maximumSize(){var nt;return(nt=this.column.maximumWidth)!==null&&nt!==void 0?nt:Number.POSITIVE_INFINITY}get onDidChange(){var nt;return(nt=this.column.onDidChangeWidthConstraints)!==null&&nt!==void 0?nt:Event.None}constructor(nt,ot){this.column=nt,this.index=ot,this._onDidLayout=new Emitter$2,this.onDidLayout=this._onDidLayout.event,this.element=$$d(".monaco-table-th",{"data-col-index":ot,title:nt.tooltip},nt.label)}layout(nt){this._onDidLayout.fire([this.index,nt])}}class Table{get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get onDidDispose(){return this.list.onDidDispose}constructor(nt,ot,rt,ut,gt,pt){this.virtualDelegate=rt,this.domId=`table_id_${++Table.InstanceCount}`,this.disposables=new DisposableStore,this.cachedWidth=0,this.cachedHeight=0,this.domNode=append$1(ot,$$d(`.monaco-table.${this.domId}`));const mt=ut.map((yt,wt)=>new ColumnHeader(yt,wt)),vt={size:mt.reduce((yt,wt)=>yt+wt.column.weight,0),views:mt.map(yt=>({size:yt.column.weight,view:yt}))};this.splitview=this.disposables.add(new SplitView(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:vt})),this.splitview.el.style.height=`${rt.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${rt.headerRowHeight}px`;const St=new TableListRenderer(ut,gt,yt=>this.splitview.getViewSize(yt));this.list=this.disposables.add(new List(nt,this.domNode,asListVirtualDelegate(rt),[St],pt)),Event.any(...mt.map(yt=>yt.onDidLayout))(([yt,wt])=>St.layoutColumn(yt,wt),null,this.disposables),this.splitview.onDidSashReset(yt=>{const wt=ut.reduce((xt,It)=>xt+It.weight,0),Lt=ut[yt].weight/wt*this.cachedWidth;this.splitview.resizeView(yt,Lt)},null,this.disposables),this.styleElement=createStyleSheet(this.domNode),this.style(unthemedListStyles)}updateOptions(nt){this.list.updateOptions(nt)}splice(nt,ot,rt=[]){this.list.splice(nt,ot,rt)}getHTMLElement(){return this.domNode}style(nt){const ot=[];ot.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=ot.join(`
`),this.list.style(nt)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}}Table.InstanceCount=0;const toggle="";class Toggle extends Widget$1{constructor(nt){super(),this._onChange=this._register(new Emitter$2),this.onChange=this._onChange.event,this._onKeyDown=this._register(new Emitter$2),this.onKeyDown=this._onKeyDown.event,this._opts=nt,this._checked=this._opts.isChecked;const ot=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,ot.push(...ThemeIcon.asClassNameArray(this._icon))),this._opts.actionClassName&&ot.push(...this._opts.actionClassName.split(" ")),this._checked&&ot.push("checked"),this.domNode=document.createElement("div"),this.domNode.title=this._opts.title,this.domNode.classList.add(...ot),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,rt=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),rt.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,rt=>{if(rt.keyCode===10||rt.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),rt.preventDefault(),rt.stopPropagation();return}this._onKeyDown.fire(rt)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(nt){this._checked=nt,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 2+2+2+16}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}const NLS_CASE_SENSITIVE_TOGGLE_LABEL=localize("caseDescription","Match Case"),NLS_WHOLE_WORD_TOGGLE_LABEL=localize("wordsDescription","Match Whole Word"),NLS_REGEX_TOGGLE_LABEL=localize("regexDescription","Use Regular Expression");class CaseSensitiveToggle extends Toggle{constructor(nt){super({icon:Codicon.caseSensitive,title:NLS_CASE_SENSITIVE_TOGGLE_LABEL+nt.appendTitle,isChecked:nt.isChecked,inputActiveOptionBorder:nt.inputActiveOptionBorder,inputActiveOptionForeground:nt.inputActiveOptionForeground,inputActiveOptionBackground:nt.inputActiveOptionBackground})}}class WholeWordsToggle extends Toggle{constructor(nt){super({icon:Codicon.wholeWord,title:NLS_WHOLE_WORD_TOGGLE_LABEL+nt.appendTitle,isChecked:nt.isChecked,inputActiveOptionBorder:nt.inputActiveOptionBorder,inputActiveOptionForeground:nt.inputActiveOptionForeground,inputActiveOptionBackground:nt.inputActiveOptionBackground})}}class RegexToggle extends Toggle{constructor(nt){super({icon:Codicon.regex,title:NLS_REGEX_TOGGLE_LABEL+nt.appendTitle,isChecked:nt.isChecked,inputActiveOptionBorder:nt.inputActiveOptionBorder,inputActiveOptionForeground:nt.inputActiveOptionForeground,inputActiveOptionBackground:nt.inputActiveOptionBackground})}}class ArrayNavigator{constructor(nt,ot=0,rt=nt.length,ut=ot-1){this.items=nt,this.start=ot,this.end=rt,this.index=ut}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class HistoryNavigator{constructor(nt=[],ot=10){this._initialize(nt),this._limit=ot,this._onChange()}getHistory(){return this._elements}add(nt){this._history.delete(nt),this._history.add(nt),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(nt){return this._history.has(nt)}_onChange(){this._reduceToLimit();const nt=this._elements;this._navigator=new ArrayNavigator(nt,0,nt.length,nt.length)}_reduceToLimit(){const nt=this._elements;nt.length>this._limit&&this._initialize(nt.slice(nt.length-this._limit))}_currentPosition(){const nt=this._navigator.current();return nt?this._elements.indexOf(nt):-1}_initialize(nt){this._history=new Set;for(const ot of nt)this._history.add(ot)}get _elements(){const nt=[];return this._history.forEach(ot=>nt.push(ot)),nt}}const inputBox="",$$b=$$d;let InputBox$1=class extends Widget$1{constructor(nt,ot,rt){var ut;super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new Emitter$2),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new Emitter$2),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=ot,this.options=rt,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=(ut=this.options.tooltip)!==null&&ut!==void 0?ut:this.placeholder||"",this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=append$1(nt,$$b(".monaco-inputbox.idle"));const gt=this.options.flexibleHeight?"textarea":"input",pt=append$1(this.element,$$b(".ibwrapper"));if(this.input=append$1(pt,$$b(gt+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=append$1(pt,$$b("div.mirror")),this.mirror.innerText="",this.scrollableElement=new ScrollableElement(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),append$1(nt,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(St=>this.input.scrollTop=St.scrollTop));const mt=this._register(new DomEmitter(document,"selectionchange")),vt=Event.filter(mt.event,()=>{const St=document.getSelection();return(St==null?void 0:St.anchorNode)===pt});this._register(vt(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new ActionBar(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(nt){this.placeholder=nt,this.input.setAttribute("placeholder",nt)}setTooltip(nt){this.tooltip=nt,this.input.title=nt}get inputElement(){return this.input}get value(){return this.input.value}set value(nt){this.input.value!==nt&&(this.input.value=nt,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:getTotalHeight(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return document.activeElement===this.input}select(nt=null){this.input.select(),nt&&(this.input.setSelectionRange(nt.start,nt.end),nt.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}set paddingRight(nt){this.input.style.width=`calc(100% - ${nt}px)`,this.mirror&&(this.mirror.style.paddingRight=nt+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const nt=this.cachedContentHeight,ot=this.cachedHeight,rt=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:nt,height:ot}),this.scrollableElement.setScrollPosition({scrollTop:rt})}showMessage(nt,ot){if(this.state==="open"&&equals$1(this.message,nt))return;this.message=nt,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(nt.type));const rt=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${asCssValueWithDefault(rt.border,"transparent")}`,this.message.content&&(this.hasFocus()||ot)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let nt=null;return this.validation&&(nt=this.validation(this.value),nt?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(nt)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),nt==null?void 0:nt.type}stylesForType(nt){const ot=this.options.inputBoxStyles;switch(nt){case 1:return{border:ot.inputValidationInfoBorder,background:ot.inputValidationInfoBackground,foreground:ot.inputValidationInfoForeground};case 2:return{border:ot.inputValidationWarningBorder,background:ot.inputValidationWarningBackground,foreground:ot.inputValidationWarningForeground};default:return{border:ot.inputValidationErrorBorder,background:ot.inputValidationErrorBackground,foreground:ot.inputValidationErrorForeground}}}classForType(nt){switch(nt){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let nt;const ot=()=>nt.style.width=getTotalWidth(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:ut=>{var gt,pt;if(!this.message)return null;nt=append$1(ut,$$b(".monaco-inputbox-container")),ot();const mt={inline:!0,className:"monaco-inputbox-message"},vt=this.message.formatContent?renderFormattedText(this.message.content,mt):renderText(this.message.content,mt);vt.classList.add(this.classForType(this.message.type));const St=this.stylesForType(this.message.type);return vt.style.backgroundColor=(gt=St.background)!==null&&gt!==void 0?gt:"",vt.style.color=(pt=St.foreground)!==null&&pt!==void 0?pt:"",vt.style.border=St.border?`1px solid ${St.border}`:"",append$1(nt,vt),null},onHide:()=>{this.state="closed"},layout:ot});let rt;this.message.type===3?rt=localize("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?rt=localize("alertWarningMessage","Warning: {0}",this.message.content):rt=localize("alertInfoMessage","Info: {0}",this.message.content),alert(rt),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const nt=this.value,rt=nt.charCodeAt(nt.length-1)===10?" ":"";(nt+rt).replace(/\u000c/g,"")?this.mirror.textContent=nt+rt:this.mirror.innerText="",this.layout()}applyStyles(){var nt,ot,rt;const ut=this.options.inputBoxStyles,gt=(nt=ut.inputBackground)!==null&&nt!==void 0?nt:"",pt=(ot=ut.inputForeground)!==null&&ot!==void 0?ot:"",mt=(rt=ut.inputBorder)!==null&&rt!==void 0?rt:"";this.element.style.backgroundColor=gt,this.element.style.color=pt,this.input.style.backgroundColor="inherit",this.input.style.color=pt,this.element.style.border=`1px solid ${asCssValueWithDefault(mt,"transparent")}`}layout(){if(!this.mirror)return;const nt=this.cachedContentHeight;this.cachedContentHeight=getTotalHeight(this.mirror),nt!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(nt){const ot=this.inputElement,rt=ot.selectionStart,ut=ot.selectionEnd,gt=ot.value;rt!==null&&ut!==null&&(this.value=gt.substr(0,rt)+nt+gt.substr(ut),ot.setSelectionRange(rt+1,rt+1),this.layout())}dispose(){var nt;this._hideMessage(),this.message=null,(nt=this.actionbar)===null||nt===void 0||nt.dispose(),super.dispose()}};class HistoryInputBox extends InputBox$1{constructor(nt,ot,rt){const ut=localize({key:"history.inputbox.hint",comment:["Text will be prefixed with  plus a single space, then used as a hint where input field keeps history"]},"for history"),gt=` or  ${ut}`,pt=` ( ${ut})`;super(nt,ot,rt),this._onDidFocus=this._register(new Emitter$2),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new Emitter$2),this.onDidBlur=this._onDidBlur.event,this.history=new HistoryNavigator(rt.history,100);const mt=()=>{if(rt.showHistoryHint&&rt.showHistoryHint()&&!this.placeholder.endsWith(gt)&&!this.placeholder.endsWith(pt)&&this.history.getHistory().length){const vt=this.placeholder.endsWith(")")?gt:pt,St=this.placeholder+vt;rt.showPlaceholderOnFocus&&document.activeElement!==this.input?this.placeholder=St:this.setPlaceHolder(St)}};this.observer=new MutationObserver((vt,St)=>{vt.forEach(yt=>{yt.target.textContent||mt()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>mt()),this.onblur(this.input,()=>{const vt=St=>{if(this.placeholder.endsWith(St)){const yt=this.placeholder.slice(0,this.placeholder.length-St.length);return rt.showPlaceholderOnFocus?this.placeholder=yt:this.setPlaceHolder(yt),!0}else return!1};vt(pt)||vt(gt)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(nt){this.value&&(nt||this.value!==this.getCurrentValue())&&this.history.add(this.value)}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let nt=this.getNextValue();nt&&(nt=nt===this.value?this.getNextValue():nt),this.value=nt??"",status(this.value?this.value:localize("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let nt=this.getPreviousValue();nt&&(nt=nt===this.value?this.getPreviousValue():nt),nt&&(this.value=nt,status(this.value))}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let nt=this.history.current();return nt||(nt=this.history.last(),this.history.next()),nt}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}}const findInput="",NLS_DEFAULT_LABEL$1=localize("defaultLabel","input");class FindInput extends Widget$1{constructor(nt,ot,rt){super(),this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this.additionalTogglesDisposables=new DisposableStore,this.additionalToggles=[],this._onDidOptionChange=this._register(new Emitter$2),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new Emitter$2),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new Emitter$2),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new Emitter$2),this._onKeyUp=this._register(new Emitter$2),this._onCaseSensitiveKeyDown=this._register(new Emitter$2),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new Emitter$2),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.placeholder=rt.placeholder||"",this.validation=rt.validation,this.label=rt.label||NLS_DEFAULT_LABEL$1,this.showCommonFindToggles=!!rt.showCommonFindToggles;const ut=rt.appendCaseSensitiveLabel||"",gt=rt.appendWholeWordsLabel||"",pt=rt.appendRegexLabel||"",mt=rt.history||[],vt=!!rt.flexibleHeight,St=!!rt.flexibleWidth,yt=rt.flexibleMaxHeight;if(this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new HistoryInputBox(this.domNode,ot,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:mt,showHistoryHint:rt.showHistoryHint,flexibleHeight:vt,flexibleWidth:St,flexibleMaxHeight:yt,inputBoxStyles:rt.inputBoxStyles})),this.showCommonFindToggles){this.regex=this._register(new RegexToggle(Object.assign({appendTitle:pt,isChecked:!1},rt.toggleStyles))),this._register(this.regex.onChange(Lt=>{this._onDidOptionChange.fire(Lt),!Lt&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(Lt=>{this._onRegexKeyDown.fire(Lt)})),this.wholeWords=this._register(new WholeWordsToggle(Object.assign({appendTitle:gt,isChecked:!1},rt.toggleStyles))),this._register(this.wholeWords.onChange(Lt=>{this._onDidOptionChange.fire(Lt),!Lt&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new CaseSensitiveToggle(Object.assign({appendTitle:ut,isChecked:!1},rt.toggleStyles))),this._register(this.caseSensitive.onChange(Lt=>{this._onDidOptionChange.fire(Lt),!Lt&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(Lt=>{this._onCaseSensitiveKeyDown.fire(Lt)}));const wt=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,Lt=>{if(Lt.equals(15)||Lt.equals(17)||Lt.equals(9)){const xt=wt.indexOf(document.activeElement);if(xt>=0){let It=-1;Lt.equals(17)?It=(xt+1)%wt.length:Lt.equals(15)&&(xt===0?It=wt.length-1:It=xt-1),Lt.equals(9)?(wt[xt].blur(),this.inputBox.focus()):It>=0&&wt[It].focus(),EventHelper.stop(Lt,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(rt==null?void 0:rt.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),nt==null||nt.appendChild(this.domNode),this._register(addDisposableListener(this.inputBox.inputElement,"compositionstart",wt=>{this.imeSessionInProgress=!0})),this._register(addDisposableListener(this.inputBox.inputElement,"compositionend",wt=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,wt=>this._onKeyDown.fire(wt)),this.onkeyup(this.inputBox.inputElement,wt=>this._onKeyUp.fire(wt)),this.oninput(this.inputBox.inputElement,wt=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,wt=>this._onMouseDown.fire(wt))}get onDidChange(){return this.inputBox.onDidChange}layout(nt){this.inputBox.layout(),this.updateInputBoxPadding(nt.collapsedFindWidget)}enable(){var nt,ot,rt;this.domNode.classList.remove("disabled"),this.inputBox.enable(),(nt=this.regex)===null||nt===void 0||nt.enable(),(ot=this.wholeWords)===null||ot===void 0||ot.enable(),(rt=this.caseSensitive)===null||rt===void 0||rt.enable();for(const ut of this.additionalToggles)ut.enable()}disable(){var nt,ot,rt;this.domNode.classList.add("disabled"),this.inputBox.disable(),(nt=this.regex)===null||nt===void 0||nt.disable(),(ot=this.wholeWords)===null||ot===void 0||ot.disable(),(rt=this.caseSensitive)===null||rt===void 0||rt.disable();for(const ut of this.additionalToggles)ut.disable()}setFocusInputOnOptionClick(nt){this.fixFocusOnOptionClickEnabled=nt}setEnabled(nt){nt?this.enable():this.disable()}setAdditionalToggles(nt){for(const ot of this.additionalToggles)ot.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.dispose(),this.additionalTogglesDisposables=new DisposableStore;for(const ot of nt??[])this.additionalTogglesDisposables.add(ot),this.controls.appendChild(ot.domNode),this.additionalTogglesDisposables.add(ot.onChange(rt=>{this._onDidOptionChange.fire(rt),!rt&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(ot);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(nt=!1){var ot,rt,ut,gt,pt,mt;nt?this.inputBox.paddingRight=0:this.inputBox.paddingRight=((rt=(ot=this.caseSensitive)===null||ot===void 0?void 0:ot.width())!==null&&rt!==void 0?rt:0)+((gt=(ut=this.wholeWords)===null||ut===void 0?void 0:ut.width())!==null&&gt!==void 0?gt:0)+((mt=(pt=this.regex)===null||pt===void 0?void 0:pt.width())!==null&&mt!==void 0?mt:0)+this.additionalToggles.reduce((vt,St)=>vt+St.width(),0)}getValue(){return this.inputBox.value}setValue(nt){this.inputBox.value!==nt&&(this.inputBox.value=nt)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){var nt,ot;return(ot=(nt=this.caseSensitive)===null||nt===void 0?void 0:nt.checked)!==null&&ot!==void 0?ot:!1}setCaseSensitive(nt){this.caseSensitive&&(this.caseSensitive.checked=nt)}getWholeWords(){var nt,ot;return(ot=(nt=this.wholeWords)===null||nt===void 0?void 0:nt.checked)!==null&&ot!==void 0?ot:!1}setWholeWords(nt){this.wholeWords&&(this.wholeWords.checked=nt)}getRegex(){var nt,ot;return(ot=(nt=this.regex)===null||nt===void 0?void 0:nt.checked)!==null&&ot!==void 0?ot:!1}setRegex(nt){this.regex&&(this.regex.checked=nt,this.validate())}focusOnCaseSensitive(){var nt;(nt=this.caseSensitive)===null||nt===void 0||nt.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(nt){this.inputBox.showMessage(nt)}clearMessage(){this.inputBox.hideMessage()}}var ObjectTreeElementCollapseState;(function(ct){ct[ct.Expanded=0]="Expanded",ct[ct.Collapsed=1]="Collapsed",ct[ct.PreserveOrExpanded=2]="PreserveOrExpanded",ct[ct.PreserveOrCollapsed=3]="PreserveOrCollapsed"})(ObjectTreeElementCollapseState||(ObjectTreeElementCollapseState={}));var TreeMouseEventTarget;(function(ct){ct[ct.Unknown=0]="Unknown",ct[ct.Twistie=1]="Twistie",ct[ct.Element=2]="Element",ct[ct.Filter=3]="Filter"})(TreeMouseEventTarget||(TreeMouseEventTarget={}));class TreeError extends Error{constructor(nt,ot){super(`TreeError [${nt}] ${ot}`)}}class WeakMapper{constructor(nt){this.fn=nt,this._map=new WeakMap}map(nt){let ot=this._map.get(nt);return ot||(ot=this.fn(nt),this._map.set(nt,ot)),ot}}function isFilterResult(ct){return typeof ct=="object"&&"visibility"in ct&&"data"in ct}function getVisibleState(ct){switch(ct){case!0:return 1;case!1:return 0;default:return ct}}function isCollapsibleStateUpdate(ct){return typeof ct.collapsible=="boolean"}class IndexTreeModel{constructor(nt,ot,rt,ut={}){this.user=nt,this.list=ot,this.rootRef=[],this.eventBufferer=new EventBufferer,this._onDidChangeCollapseState=new Emitter$2,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new Emitter$2,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new Emitter$2,this.onDidSplice=this._onDidSplice.event,this.refilterDelayer=new Delayer(MicrotaskDelay),this.collapseByDefault=typeof ut.collapseByDefault>"u"?!1:ut.collapseByDefault,this.filter=ut.filter,this.autoExpandSingleChildren=typeof ut.autoExpandSingleChildren>"u"?!1:ut.autoExpandSingleChildren,this.root={parent:void 0,element:rt,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(nt,ot,rt=Iterable.empty(),ut={}){if(nt.length===0)throw new TreeError(this.user,"Invalid tree location");ut.diffIdentityProvider?this.spliceSmart(ut.diffIdentityProvider,nt,ot,rt,ut):this.spliceSimple(nt,ot,rt,ut)}spliceSmart(nt,ot,rt,ut,gt,pt){var mt;ut===void 0&&(ut=Iterable.empty()),pt===void 0&&(pt=(mt=gt.diffDepth)!==null&&mt!==void 0?mt:0);const{parentNode:vt}=this.getParentNodeWithListIndex(ot);if(!vt.lastDiffIds)return this.spliceSimple(ot,rt,ut,gt);const St=[...ut],yt=ot[ot.length-1],wt=new LcsDiff({getElements:()=>vt.lastDiffIds},{getElements:()=>[...vt.children.slice(0,yt),...St,...vt.children.slice(yt+rt)].map(At=>nt.getId(At.element).toString())}).ComputeDiff(!1);if(wt.quitEarly)return vt.lastDiffIds=void 0,this.spliceSimple(ot,rt,St,gt);const Lt=ot.slice(0,-1),xt=(At,Tt,Rt)=>{if(pt>0)for(let Nt=0;Nt<Rt;Nt++)At--,Tt--,this.spliceSmart(nt,[...Lt,At,0],Number.MAX_SAFE_INTEGER,St[Tt].children,gt,pt-1)};let It=Math.min(vt.children.length,yt+rt),kt=St.length;for(const At of wt.changes.sort((Tt,Rt)=>Rt.originalStart-Tt.originalStart))xt(It,kt,It-(At.originalStart+At.originalLength)),It=At.originalStart,kt=At.modifiedStart-yt,this.spliceSimple([...Lt,It],At.originalLength,Iterable.slice(St,kt,kt+At.modifiedLength),gt);xt(It,kt,It)}spliceSimple(nt,ot,rt=Iterable.empty(),{onDidCreateNode:ut,onDidDeleteNode:gt,diffIdentityProvider:pt}){const{parentNode:mt,listIndex:vt,revealed:St,visible:yt}=this.getParentNodeWithListIndex(nt),wt=[],Lt=Iterable.map(rt,Bt=>this.createTreeNode(Bt,mt,mt.visible?1:0,St,wt,ut)),xt=nt[nt.length-1],It=mt.children.length>0;let kt=0;for(let Bt=xt;Bt>=0&&Bt<mt.children.length;Bt--){const Ut=mt.children[Bt];if(Ut.visible){kt=Ut.visibleChildIndex;break}}const At=[];let Tt=0,Rt=0;for(const Bt of Lt)At.push(Bt),Rt+=Bt.renderNodeCount,Bt.visible&&(Bt.visibleChildIndex=kt+Tt++);const Nt=splice$1(mt.children,xt,ot,At);pt?mt.lastDiffIds?splice$1(mt.lastDiffIds,xt,ot,At.map(Bt=>pt.getId(Bt.element).toString())):mt.lastDiffIds=mt.children.map(Bt=>pt.getId(Bt.element).toString()):mt.lastDiffIds=void 0;let Pt=0;for(const Bt of Nt)Bt.visible&&Pt++;if(Pt!==0)for(let Bt=xt+At.length;Bt<mt.children.length;Bt++){const Ut=mt.children[Bt];Ut.visible&&(Ut.visibleChildIndex-=Pt)}if(mt.visibleChildrenCount+=Tt-Pt,St&&yt){const Bt=Nt.reduce((Ut,qt)=>Ut+(qt.visible?qt.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(mt,Rt-Bt),this.list.splice(vt,Bt,wt)}if(Nt.length>0&&gt){const Bt=Ut=>{gt(Ut),Ut.children.forEach(Bt)};Nt.forEach(Bt)}this._onDidSplice.fire({insertedNodes:At,deletedNodes:Nt});const Ft=mt.children.length>0;It!==Ft&&this.setCollapsible(nt.slice(0,-1),Ft);let Kt=mt;for(;Kt;){if(Kt.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}Kt=Kt.parent}}rerender(nt){if(nt.length===0)throw new TreeError(this.user,"Invalid tree location");const{node:ot,listIndex:rt,revealed:ut}=this.getTreeNodeWithListIndex(nt);ot.visible&&ut&&this.list.splice(rt,1,[ot])}has(nt){return this.hasTreeNode(nt)}getListIndex(nt){const{listIndex:ot,visible:rt,revealed:ut}=this.getTreeNodeWithListIndex(nt);return rt&&ut?ot:-1}getListRenderCount(nt){return this.getTreeNode(nt).renderNodeCount}isCollapsible(nt){return this.getTreeNode(nt).collapsible}setCollapsible(nt,ot){const rt=this.getTreeNode(nt);typeof ot>"u"&&(ot=!rt.collapsible);const ut={collapsible:ot};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(nt,ut))}isCollapsed(nt){return this.getTreeNode(nt).collapsed}setCollapsed(nt,ot,rt){const ut=this.getTreeNode(nt);typeof ot>"u"&&(ot=!ut.collapsed);const gt={collapsed:ot,recursive:rt||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(nt,gt))}_setCollapseState(nt,ot){const{node:rt,listIndex:ut,revealed:gt}=this.getTreeNodeWithListIndex(nt),pt=this._setListNodeCollapseState(rt,ut,gt,ot);if(rt!==this.root&&this.autoExpandSingleChildren&&pt&&!isCollapsibleStateUpdate(ot)&&rt.collapsible&&!rt.collapsed&&!ot.recursive){let mt=-1;for(let vt=0;vt<rt.children.length;vt++)if(rt.children[vt].visible)if(mt>-1){mt=-1;break}else mt=vt;mt>-1&&this._setCollapseState([...nt,mt],ot)}return pt}_setListNodeCollapseState(nt,ot,rt,ut){const gt=this._setNodeCollapseState(nt,ut,!1);if(!rt||!nt.visible||!gt)return gt;const pt=nt.renderNodeCount,mt=this.updateNodeAfterCollapseChange(nt),vt=pt-(ot===-1?0:1);return this.list.splice(ot+1,vt,mt.slice(1)),gt}_setNodeCollapseState(nt,ot,rt){let ut;if(nt===this.root?ut=!1:(isCollapsibleStateUpdate(ot)?(ut=nt.collapsible!==ot.collapsible,nt.collapsible=ot.collapsible):nt.collapsible?(ut=nt.collapsed!==ot.collapsed,nt.collapsed=ot.collapsed):ut=!1,ut&&this._onDidChangeCollapseState.fire({node:nt,deep:rt})),!isCollapsibleStateUpdate(ot)&&ot.recursive)for(const gt of nt.children)ut=this._setNodeCollapseState(gt,ot,!0)||ut;return ut}expandTo(nt){this.eventBufferer.bufferEvents(()=>{let ot=this.getTreeNode(nt);for(;ot.parent;)ot=ot.parent,nt=nt.slice(0,nt.length-1),ot.collapsed&&this._setCollapseState(nt,{collapsed:!1,recursive:!1})})}refilter(){const nt=this.root.renderNodeCount,ot=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,nt,ot),this.refilterDelayer.cancel()}createTreeNode(nt,ot,rt,ut,gt,pt){const mt={parent:ot,element:nt.element,children:[],depth:ot.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof nt.collapsible=="boolean"?nt.collapsible:typeof nt.collapsed<"u",collapsed:typeof nt.collapsed>"u"?this.collapseByDefault:nt.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},vt=this._filterNode(mt,rt);mt.visibility=vt,ut&&gt.push(mt);const St=nt.children||Iterable.empty(),yt=ut&&vt!==0&&!mt.collapsed;let wt=0,Lt=1;for(const xt of St){const It=this.createTreeNode(xt,mt,vt,yt,gt,pt);mt.children.push(It),Lt+=It.renderNodeCount,It.visible&&(It.visibleChildIndex=wt++)}return mt.collapsible=mt.collapsible||mt.children.length>0,mt.visibleChildrenCount=wt,mt.visible=vt===2?wt>0:vt===1,mt.visible?mt.collapsed||(mt.renderNodeCount=Lt):(mt.renderNodeCount=0,ut&&gt.pop()),pt==null||pt(mt),mt}updateNodeAfterCollapseChange(nt){const ot=nt.renderNodeCount,rt=[];return this._updateNodeAfterCollapseChange(nt,rt),this._updateAncestorsRenderNodeCount(nt.parent,rt.length-ot),rt}_updateNodeAfterCollapseChange(nt,ot){if(nt.visible===!1)return 0;if(ot.push(nt),nt.renderNodeCount=1,!nt.collapsed)for(const rt of nt.children)nt.renderNodeCount+=this._updateNodeAfterCollapseChange(rt,ot);return this._onDidChangeRenderNodeCount.fire(nt),nt.renderNodeCount}updateNodeAfterFilterChange(nt){const ot=nt.renderNodeCount,rt=[];return this._updateNodeAfterFilterChange(nt,nt.visible?1:0,rt),this._updateAncestorsRenderNodeCount(nt.parent,rt.length-ot),rt}_updateNodeAfterFilterChange(nt,ot,rt,ut=!0){let gt;if(nt!==this.root){if(gt=this._filterNode(nt,ot),gt===0)return nt.visible=!1,nt.renderNodeCount=0,!1;ut&&rt.push(nt)}const pt=rt.length;nt.renderNodeCount=nt===this.root?0:1;let mt=!1;if(!nt.collapsed||gt!==0){let vt=0;for(const St of nt.children)mt=this._updateNodeAfterFilterChange(St,gt,rt,ut&&!nt.collapsed)||mt,St.visible&&(St.visibleChildIndex=vt++);nt.visibleChildrenCount=vt}else nt.visibleChildrenCount=0;return nt!==this.root&&(nt.visible=gt===2?mt:gt===1,nt.visibility=gt),nt.visible?nt.collapsed||(nt.renderNodeCount+=rt.length-pt):(nt.renderNodeCount=0,ut&&rt.pop()),this._onDidChangeRenderNodeCount.fire(nt),nt.visible}_updateAncestorsRenderNodeCount(nt,ot){if(ot!==0)for(;nt;)nt.renderNodeCount+=ot,this._onDidChangeRenderNodeCount.fire(nt),nt=nt.parent}_filterNode(nt,ot){const rt=this.filter?this.filter.filter(nt.element,ot):1;return typeof rt=="boolean"?(nt.filterData=void 0,rt?1:0):isFilterResult(rt)?(nt.filterData=rt.data,getVisibleState(rt.visibility)):(nt.filterData=void 0,getVisibleState(rt))}hasTreeNode(nt,ot=this.root){if(!nt||nt.length===0)return!0;const[rt,...ut]=nt;return rt<0||rt>ot.children.length?!1:this.hasTreeNode(ut,ot.children[rt])}getTreeNode(nt,ot=this.root){if(!nt||nt.length===0)return ot;const[rt,...ut]=nt;if(rt<0||rt>ot.children.length)throw new TreeError(this.user,"Invalid tree location");return this.getTreeNode(ut,ot.children[rt])}getTreeNodeWithListIndex(nt){if(nt.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:ot,listIndex:rt,revealed:ut,visible:gt}=this.getParentNodeWithListIndex(nt),pt=nt[nt.length-1];if(pt<0||pt>ot.children.length)throw new TreeError(this.user,"Invalid tree location");const mt=ot.children[pt];return{node:mt,listIndex:rt,revealed:ut,visible:gt&&mt.visible}}getParentNodeWithListIndex(nt,ot=this.root,rt=0,ut=!0,gt=!0){const[pt,...mt]=nt;if(pt<0||pt>ot.children.length)throw new TreeError(this.user,"Invalid tree location");for(let vt=0;vt<pt;vt++)rt+=ot.children[vt].renderNodeCount;return ut=ut&&!ot.collapsed,gt=gt&&ot.visible,mt.length===0?{parentNode:ot,listIndex:rt,revealed:ut,visible:gt}:this.getParentNodeWithListIndex(mt,ot.children[pt],rt+1,ut,gt)}getNode(nt=[]){return this.getTreeNode(nt)}getNodeLocation(nt){const ot=[];let rt=nt;for(;rt.parent;)ot.push(rt.parent.children.indexOf(rt)),rt=rt.parent;return ot.reverse()}getParentNodeLocation(nt){if(nt.length!==0)return nt.length===1?[]:tail2(nt)[0]}getFirstElementChild(nt){const ot=this.getTreeNode(nt);if(ot.children.length!==0)return ot.children[0].element}}class SetMap{constructor(){this.map=new Map}add(nt,ot){let rt=this.map.get(nt);rt||(rt=new Set,this.map.set(nt,rt)),rt.add(ot)}delete(nt,ot){const rt=this.map.get(nt);rt&&(rt.delete(ot),rt.size===0&&this.map.delete(nt))}forEach(nt,ot){const rt=this.map.get(nt);rt&&rt.forEach(ot)}}const tree="";globalThis&&globalThis.__awaiter;class TreeElementsDragAndDropData extends ElementsDragAndDropData{constructor(nt){super(nt.elements.map(ot=>ot.element)),this.data=nt}}function asTreeDragAndDropData(ct){return ct instanceof ElementsDragAndDropData?new TreeElementsDragAndDropData(ct):ct}class TreeNodeListDragAndDrop{constructor(nt,ot){this.modelProvider=nt,this.dnd=ot,this.autoExpandDisposable=Disposable.None}getDragURI(nt){return this.dnd.getDragURI(nt.element)}getDragLabel(nt,ot){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(nt.map(rt=>rt.element),ot)}onDragStart(nt,ot){var rt,ut;(ut=(rt=this.dnd).onDragStart)===null||ut===void 0||ut.call(rt,asTreeDragAndDropData(nt),ot)}onDragOver(nt,ot,rt,ut,gt=!0){const pt=this.dnd.onDragOver(asTreeDragAndDropData(nt),ot&&ot.element,rt,ut),mt=this.autoExpandNode!==ot;if(mt&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=ot),typeof ot>"u")return pt;if(mt&&typeof pt!="boolean"&&pt.autoExpand&&(this.autoExpandDisposable=disposableTimeout(()=>{const Lt=this.modelProvider(),xt=Lt.getNodeLocation(ot);Lt.isCollapsed(xt)&&Lt.setCollapsed(xt,!1),this.autoExpandNode=void 0},500)),typeof pt=="boolean"||!pt.accept||typeof pt.bubble>"u"||pt.feedback){if(!gt){const Lt=typeof pt=="boolean"?pt:pt.accept,xt=typeof pt=="boolean"?void 0:pt.effect;return{accept:Lt,effect:xt,feedback:[rt]}}return pt}if(pt.bubble===1){const Lt=this.modelProvider(),xt=Lt.getNodeLocation(ot),It=Lt.getParentNodeLocation(xt),kt=Lt.getNode(It),At=It&&Lt.getListIndex(It);return this.onDragOver(nt,kt,At,ut,!1)}const vt=this.modelProvider(),St=vt.getNodeLocation(ot),yt=vt.getListIndex(St),wt=vt.getListRenderCount(St);return Object.assign(Object.assign({},pt),{feedback:range(yt,yt+wt)})}drop(nt,ot,rt,ut){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(asTreeDragAndDropData(nt),ot&&ot.element,rt,ut)}onDragEnd(nt){var ot,rt;(rt=(ot=this.dnd).onDragEnd)===null||rt===void 0||rt.call(ot,nt)}}function asListOptions(ct,nt){return nt&&Object.assign(Object.assign({},nt),{identityProvider:nt.identityProvider&&{getId(ot){return nt.identityProvider.getId(ot.element)}},dnd:nt.dnd&&new TreeNodeListDragAndDrop(ct,nt.dnd),multipleSelectionController:nt.multipleSelectionController&&{isSelectionSingleChangeEvent(ot){return nt.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},ot),{element:ot.element}))},isSelectionRangeChangeEvent(ot){return nt.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},ot),{element:ot.element}))}},accessibilityProvider:nt.accessibilityProvider&&Object.assign(Object.assign({},nt.accessibilityProvider),{getSetSize(ot){const rt=ct(),ut=rt.getNodeLocation(ot),gt=rt.getParentNodeLocation(ut);return rt.getNode(gt).visibleChildrenCount},getPosInSet(ot){return ot.visibleChildIndex+1},isChecked:nt.accessibilityProvider&&nt.accessibilityProvider.isChecked?ot=>nt.accessibilityProvider.isChecked(ot.element):void 0,getRole:nt.accessibilityProvider&&nt.accessibilityProvider.getRole?ot=>nt.accessibilityProvider.getRole(ot.element):()=>"treeitem",getAriaLabel(ot){return nt.accessibilityProvider.getAriaLabel(ot.element)},getWidgetAriaLabel(){return nt.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:nt.accessibilityProvider&&nt.accessibilityProvider.getWidgetRole?()=>nt.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:nt.accessibilityProvider&&nt.accessibilityProvider.getAriaLevel?ot=>nt.accessibilityProvider.getAriaLevel(ot.element):ot=>ot.depth,getActiveDescendantId:nt.accessibilityProvider.getActiveDescendantId&&(ot=>nt.accessibilityProvider.getActiveDescendantId(ot.element))}),keyboardNavigationLabelProvider:nt.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},nt.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel(ot){return nt.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(ot.element)}})})}class ComposedTreeDelegate{constructor(nt){this.delegate=nt}getHeight(nt){return this.delegate.getHeight(nt.element)}getTemplateId(nt){return this.delegate.getTemplateId(nt.element)}hasDynamicHeight(nt){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(nt.element)}setDynamicHeight(nt,ot){var rt,ut;(ut=(rt=this.delegate).setDynamicHeight)===null||ut===void 0||ut.call(rt,nt.element,ot)}}var RenderIndentGuides;(function(ct){ct.None="none",ct.OnHover="onHover",ct.Always="always"})(RenderIndentGuides||(RenderIndentGuides={}));class EventCollection{get elements(){return this._elements}constructor(nt,ot=[]){this._elements=ot,this.disposables=new DisposableStore,this.onDidChange=Event.forEach(nt,rt=>this._elements=rt,this.disposables)}dispose(){this.disposables.dispose()}}class TreeRenderer{constructor(nt,ot,rt,ut,gt,pt={}){var mt;this.renderer=nt,this.modelProvider=ot,this.activeNodes=ut,this.renderedIndentGuides=gt,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=TreeRenderer.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=Disposable.None,this.disposables=new DisposableStore,this.templateId=nt.templateId,this.updateOptions(pt),Event.map(rt,vt=>vt.node)(this.onDidChangeNodeTwistieState,this,this.disposables),(mt=nt.onDidChangeTwistieState)===null||mt===void 0||mt.call(nt,this.onDidChangeTwistieState,this,this.disposables)}updateOptions(nt={}){if(typeof nt.indent<"u"){const ot=clamp(nt.indent,0,40);if(ot!==this.indent){this.indent=ot;for(const[rt,ut]of this.renderedNodes)this.renderTreeElement(rt,ut)}}if(typeof nt.renderIndentGuides<"u"){const ot=nt.renderIndentGuides!==RenderIndentGuides.None;if(ot!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=ot;for(const[rt,ut]of this.renderedNodes)this._renderIndentGuides(rt,ut);if(this.indentGuidesDisposable.dispose(),ot){const rt=new DisposableStore;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,rt),this.indentGuidesDisposable=rt,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof nt.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=nt.hideTwistiesOfChildlessElements)}renderTemplate(nt){const ot=append$1(nt,$$d(".monaco-tl-row")),rt=append$1(ot,$$d(".monaco-tl-indent")),ut=append$1(ot,$$d(".monaco-tl-twistie")),gt=append$1(ot,$$d(".monaco-tl-contents")),pt=this.renderer.renderTemplate(gt);return{container:nt,indent:rt,twistie:ut,indentGuidesDisposable:Disposable.None,templateData:pt}}renderElement(nt,ot,rt,ut){this.renderedNodes.set(nt,rt),this.renderedElements.set(nt.element,nt),this.renderTreeElement(nt,rt),this.renderer.renderElement(nt,ot,rt.templateData,ut)}disposeElement(nt,ot,rt,ut){var gt,pt;rt.indentGuidesDisposable.dispose(),(pt=(gt=this.renderer).disposeElement)===null||pt===void 0||pt.call(gt,nt,ot,rt.templateData,ut),typeof ut=="number"&&(this.renderedNodes.delete(nt),this.renderedElements.delete(nt.element))}disposeTemplate(nt){this.renderer.disposeTemplate(nt.templateData)}onDidChangeTwistieState(nt){const ot=this.renderedElements.get(nt);ot&&this.onDidChangeNodeTwistieState(ot)}onDidChangeNodeTwistieState(nt){const ot=this.renderedNodes.get(nt);ot&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(nt,ot))}renderTreeElement(nt,ot){const rt=TreeRenderer.DefaultIndent+(nt.depth-1)*this.indent;ot.twistie.style.paddingLeft=`${rt}px`,ot.indent.style.width=`${rt+this.indent-16}px`,nt.collapsible?ot.container.setAttribute("aria-expanded",String(!nt.collapsed)):ot.container.removeAttribute("aria-expanded"),ot.twistie.classList.remove(...ThemeIcon.asClassNameArray(Codicon.treeItemExpanded));let ut=!1;this.renderer.renderTwistie&&(ut=this.renderer.renderTwistie(nt.element,ot.twistie)),nt.collapsible&&(!this.hideTwistiesOfChildlessElements||nt.visibleChildrenCount>0)?(ut||ot.twistie.classList.add(...ThemeIcon.asClassNameArray(Codicon.treeItemExpanded)),ot.twistie.classList.add("collapsible"),ot.twistie.classList.toggle("collapsed",nt.collapsed)):ot.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(nt,ot)}_renderIndentGuides(nt,ot){if(clearNode(ot.indent),ot.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const rt=new DisposableStore,ut=this.modelProvider();for(;;){const gt=ut.getNodeLocation(nt),pt=ut.getParentNodeLocation(gt);if(!pt)break;const mt=ut.getNode(pt),vt=$$d(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(mt)&&vt.classList.add("active"),ot.indent.childElementCount===0?ot.indent.appendChild(vt):ot.indent.insertBefore(vt,ot.indent.firstElementChild),this.renderedIndentGuides.add(mt,vt),rt.add(toDisposable(()=>this.renderedIndentGuides.delete(mt,vt))),nt=mt}ot.indentGuidesDisposable=rt}_onDidChangeActiveNodes(nt){if(!this.shouldRenderIndentGuides)return;const ot=new Set,rt=this.modelProvider();nt.forEach(ut=>{const gt=rt.getNodeLocation(ut);try{const pt=rt.getParentNodeLocation(gt);ut.collapsible&&ut.children.length>0&&!ut.collapsed?ot.add(ut):pt&&ot.add(rt.getNode(pt))}catch{}}),this.activeIndentNodes.forEach(ut=>{ot.has(ut)||this.renderedIndentGuides.forEach(ut,gt=>gt.classList.remove("active"))}),ot.forEach(ut=>{this.activeIndentNodes.has(ut)||this.renderedIndentGuides.forEach(ut,gt=>gt.classList.add("active"))}),this.activeIndentNodes=ot}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),dispose(this.disposables)}}TreeRenderer.DefaultIndent=8;class FindFilter{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}constructor(nt,ot,rt){this.tree=nt,this.keyboardNavigationLabelProvider=ot,this._filter=rt,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new DisposableStore,nt.onWillRefilter(this.reset,this,this.disposables)}filter(nt,ot){let rt=1;if(this._filter){const pt=this._filter.filter(nt,ot);if(typeof pt=="boolean"?rt=pt?1:0:isFilterResult(pt)?rt=getVisibleState(pt.visibility):rt=pt,rt===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:FuzzyScore.Default,visibility:rt};const ut=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(nt),gt=Array.isArray(ut)?ut:[ut];for(const pt of gt){const mt=pt&&pt.toString();if(typeof mt>"u")return{data:FuzzyScore.Default,visibility:rt};let vt;if(this.tree.findMatchType===TreeFindMatchType.Contiguous){const St=mt.toLowerCase().indexOf(this._lowercasePattern);if(St>-1){vt=[Number.MAX_SAFE_INTEGER,0];for(let yt=this._lowercasePattern.length;yt>0;yt--)vt.push(St+yt-1)}}else vt=fuzzyScore(this._pattern,this._lowercasePattern,0,mt,mt.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(vt)return this._matchCount++,gt.length===1?{data:vt,visibility:rt}:{data:{label:mt,score:vt},visibility:rt}}return this.tree.findMode===TreeFindMode.Filter?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(nt):2:{data:FuzzyScore.Default,visibility:rt}}reset(){this._totalCount=0,this._matchCount=0}dispose(){dispose(this.disposables)}}var TreeFindMode;(function(ct){ct[ct.Highlight=0]="Highlight",ct[ct.Filter=1]="Filter"})(TreeFindMode||(TreeFindMode={}));var TreeFindMatchType;(function(ct){ct[ct.Fuzzy=0]="Fuzzy",ct[ct.Contiguous=1]="Contiguous"})(TreeFindMatchType||(TreeFindMatchType={}));let FindController$1=class{get pattern(){return this._pattern}get mode(){return this._mode}set mode(nt){nt!==this._mode&&(this._mode=nt,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(nt))}get matchType(){return this._matchType}set matchType(nt){nt!==this._matchType&&(this._matchType=nt,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(nt))}constructor(nt,ot,rt,ut,gt,pt={}){var mt,vt;this.tree=nt,this.view=rt,this.filter=ut,this.contextViewProvider=gt,this.options=pt,this._pattern="",this.width=0,this._onDidChangeMode=new Emitter$2,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new Emitter$2,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this._onDidChangePattern=new Emitter$2,this._onDidChangeOpenState=new Emitter$2,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new DisposableStore,this.disposables=new DisposableStore,this._mode=(mt=nt.options.defaultFindMode)!==null&&mt!==void 0?mt:TreeFindMode.Highlight,this._matchType=(vt=nt.options.defaultFindMatchType)!==null&&vt!==void 0?vt:TreeFindMatchType.Fuzzy,ot.onDidSplice(this.onDidSpliceModel,this,this.disposables)}updateOptions(nt={}){nt.defaultFindMode!==void 0&&(this.mode=nt.defaultFindMode),nt.defaultFindMatchType!==void 0&&(this.matchType=nt.defaultFindMatchType)}onDidSpliceModel(){!this.widget||this.pattern.length===0||(this.tree.refilter(),this.render())}render(){var nt,ot,rt,ut;const gt=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&gt?!((nt=this.tree.options.showNotFoundMessage)!==null&&nt!==void 0)||nt?(ot=this.widget)===null||ot===void 0||ot.showMessage({type:2,content:localize("not found","No elements found.")}):(rt=this.widget)===null||rt===void 0||rt.showMessage({type:2}):(ut=this.widget)===null||ut===void 0||ut.clearMessage()}shouldAllowFocus(nt){return!this.widget||!this.pattern||this._mode===TreeFindMode.Filter||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!FuzzyScore.isDefault(nt.filterData)}layout(nt){var ot;this.width=nt,(ot=this.widget)===null||ot===void 0||ot.layout(nt)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function asTreeMouseEvent$1(ct){let nt=TreeMouseEventTarget.Unknown;return hasParentWithClass(ct.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?nt=TreeMouseEventTarget.Twistie:hasParentWithClass(ct.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?nt=TreeMouseEventTarget.Element:hasParentWithClass(ct.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(nt=TreeMouseEventTarget.Filter),{browserEvent:ct.browserEvent,element:ct.element?ct.element.element:null,target:nt}}function dfs$1(ct,nt){nt(ct),ct.children.forEach(ot=>dfs$1(ot,nt))}class Trait{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(nt,ot){this.getFirstViewElementWithTrait=nt,this.identityProvider=ot,this.nodes=[],this._onDidChange=new Emitter$2,this.onDidChange=this._onDidChange.event}set(nt,ot){!(ot!=null&&ot.__forceEvent)&&equals$2(this.nodes,nt)||this._set(nt,!1,ot)}_set(nt,ot,rt){if(this.nodes=[...nt],this.elements=void 0,this._nodeSet=void 0,!ot){const ut=this;this._onDidChange.fire({get elements(){return ut.get()},browserEvent:rt})}}get(){return this.elements||(this.elements=this.nodes.map(nt=>nt.element)),[...this.elements]}getNodes(){return this.nodes}has(nt){return this.nodeSet.has(nt)}onDidModelSplice({insertedNodes:nt,deletedNodes:ot}){if(!this.identityProvider){const vt=this.createNodeSet(),St=yt=>vt.delete(yt);ot.forEach(yt=>dfs$1(yt,St)),this.set([...vt.values()]);return}const rt=new Set,ut=vt=>rt.add(this.identityProvider.getId(vt.element).toString());ot.forEach(vt=>dfs$1(vt,ut));const gt=new Map,pt=vt=>gt.set(this.identityProvider.getId(vt.element).toString(),vt);nt.forEach(vt=>dfs$1(vt,pt));const mt=[];for(const vt of this.nodes){const St=this.identityProvider.getId(vt.element).toString();if(!rt.has(St))mt.push(vt);else{const wt=gt.get(St);wt&&wt.visible&&mt.push(wt)}}if(this.nodes.length>0&&mt.length===0){const vt=this.getFirstViewElementWithTrait();vt&&mt.push(vt)}this._set(mt,!0)}createNodeSet(){const nt=new Set;for(const ot of this.nodes)nt.add(ot);return nt}}class TreeNodeListMouseController extends MouseController{constructor(nt,ot){super(nt),this.tree=ot}onViewPointer(nt){if(isButton(nt.browserEvent.target)||isInputElement(nt.browserEvent.target)||isMonacoEditor(nt.browserEvent.target))return;const ot=nt.element;if(!ot)return super.onViewPointer(nt);if(this.isSelectionRangeChangeEvent(nt)||this.isSelectionSingleChangeEvent(nt))return super.onViewPointer(nt);const rt=nt.browserEvent.target,ut=rt.classList.contains("monaco-tl-twistie")||rt.classList.contains("monaco-icon-label")&&rt.classList.contains("folder-icon")&&nt.browserEvent.offsetX<16;let gt=!1;if(typeof this.tree.expandOnlyOnTwistieClick=="function"?gt=this.tree.expandOnlyOnTwistieClick(ot.element):gt=!!this.tree.expandOnlyOnTwistieClick,gt&&!ut&&nt.browserEvent.detail!==2)return super.onViewPointer(nt);if(!this.tree.expandOnDoubleClick&&nt.browserEvent.detail===2)return super.onViewPointer(nt);if(ot.collapsible){const pt=this.tree.getNodeLocation(ot),mt=nt.browserEvent.altKey;if(this.tree.setFocus([pt]),this.tree.toggleCollapsed(pt,mt),gt&&ut)return}super.onViewPointer(nt)}onDoubleClick(nt){nt.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||super.onDoubleClick(nt)}}class TreeNodeList extends List{constructor(nt,ot,rt,ut,gt,pt,mt,vt){super(nt,ot,rt,ut,vt),this.focusTrait=gt,this.selectionTrait=pt,this.anchorTrait=mt}createMouseController(nt){return new TreeNodeListMouseController(this,nt.tree)}splice(nt,ot,rt=[]){if(super.splice(nt,ot,rt),rt.length===0)return;const ut=[],gt=[];let pt;rt.forEach((mt,vt)=>{this.focusTrait.has(mt)&&ut.push(nt+vt),this.selectionTrait.has(mt)&&gt.push(nt+vt),this.anchorTrait.has(mt)&&(pt=nt+vt)}),ut.length>0&&super.setFocus(distinct([...super.getFocus(),...ut])),gt.length>0&&super.setSelection(distinct([...super.getSelection(),...gt])),typeof pt=="number"&&super.setAnchor(pt)}setFocus(nt,ot,rt=!1){super.setFocus(nt,ot),rt||this.focusTrait.set(nt.map(ut=>this.element(ut)),ot)}setSelection(nt,ot,rt=!1){super.setSelection(nt,ot),rt||this.selectionTrait.set(nt.map(ut=>this.element(ut)),ot)}setAnchor(nt,ot=!1){super.setAnchor(nt),ot||(typeof nt>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(nt)]))}}class AbstractTree{get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return Event.filter(Event.map(this.view.onMouseDblClick,asTreeMouseEvent$1),nt=>nt.target!==TreeMouseEventTarget.Filter)}get onPointer(){return Event.map(this.view.onPointer,asTreeMouseEvent$1)}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return Event.signal(this.model.onDidSplice)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get findMode(){var nt,ot;return(ot=(nt=this.findController)===null||nt===void 0?void 0:nt.mode)!==null&&ot!==void 0?ot:TreeFindMode.Highlight}set findMode(nt){this.findController&&(this.findController.mode=nt)}get findMatchType(){var nt,ot;return(ot=(nt=this.findController)===null||nt===void 0?void 0:nt.matchType)!==null&&ot!==void 0?ot:TreeFindMatchType.Fuzzy}set findMatchType(nt){this.findController&&(this.findController.matchType=nt)}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(nt,ot,rt,ut,gt={}){var pt;this._user=nt,this._options=gt,this.eventBufferer=new EventBufferer,this.onDidChangeFindOpenState=Event.None,this.disposables=new DisposableStore,this._onWillRefilter=new Emitter$2,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new Emitter$2;const mt=new ComposedTreeDelegate(rt),vt=new Relay,St=new Relay,yt=this.disposables.add(new EventCollection(St.event)),wt=new SetMap;this.renderers=ut.map(It=>new TreeRenderer(It,()=>this.model,vt.event,yt,wt,gt));for(const It of this.renderers)this.disposables.add(It);let Lt;gt.keyboardNavigationLabelProvider&&(Lt=new FindFilter(this,gt.keyboardNavigationLabelProvider,gt.filter),gt=Object.assign(Object.assign({},gt),{filter:Lt}),this.disposables.add(Lt)),this.focus=new Trait(()=>this.view.getFocusedElements()[0],gt.identityProvider),this.selection=new Trait(()=>this.view.getSelectedElements()[0],gt.identityProvider),this.anchor=new Trait(()=>this.view.getAnchorElement(),gt.identityProvider),this.view=new TreeNodeList(nt,ot,mt,this.renderers,this.focus,this.selection,this.anchor,Object.assign(Object.assign({},asListOptions(()=>this.model,gt)),{tree:this})),this.model=this.createModel(nt,this.view,gt),vt.input=this.model.onDidChangeCollapseState;const xt=Event.forEach(this.model.onDidSplice,It=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(It),this.selection.onDidModelSplice(It)})},this.disposables);if(xt(()=>null,null,this.disposables),St.input=Event.chain(Event.any(xt,this.focus.onDidChange,this.selection.onDidChange)).debounce(()=>null,0).map(()=>{const It=new Set;for(const kt of this.focus.getNodes())It.add(kt);for(const kt of this.selection.getNodes())It.add(kt);return[...It.values()]}).event,gt.keyboardSupport!==!1){const It=Event.chain(this.view.onKeyDown).filter(kt=>!isInputElement(kt.target)).map(kt=>new StandardKeyboardEvent(kt));It.filter(kt=>kt.keyCode===15).on(this.onLeftArrow,this,this.disposables),It.filter(kt=>kt.keyCode===17).on(this.onRightArrow,this,this.disposables),It.filter(kt=>kt.keyCode===10).on(this.onSpace,this,this.disposables)}if((!((pt=gt.findWidgetEnabled)!==null&&pt!==void 0)||pt)&&gt.keyboardNavigationLabelProvider&&gt.contextViewProvider){const It=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new FindController$1(this,this.model,this.view,Lt,gt.contextViewProvider,It),this.focusNavigationFilter=kt=>this.findController.shouldAllowFocus(kt),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=Event.None,this.onDidChangeFindMatchType=Event.None;this.styleElement=createStyleSheet(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===RenderIndentGuides.Always)}updateOptions(nt={}){var ot;this._options=Object.assign(Object.assign({},this._options),nt);for(const rt of this.renderers)rt.updateOptions(nt);this.view.updateOptions(this._options),(ot=this.findController)===null||ot===void 0||ot.updateOptions(nt),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===RenderIndentGuides.Always)}get options(){return this._options}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(nt){this.view.scrollTop=nt}domFocus(){this.view.domFocus()}layout(nt,ot){var rt;this.view.layout(nt,ot),isNumber$1(ot)&&((rt=this.findController)===null||rt===void 0||rt.layout(ot))}style(nt){const ot=`.${this.view.domId}`,rt=[];nt.treeIndentGuidesStroke&&(rt.push(`.monaco-list${ot}:hover .monaco-tl-indent > .indent-guide, .monaco-list${ot}.always .monaco-tl-indent > .indent-guide  { border-color: ${nt.treeInactiveIndentGuidesStroke}; }`),rt.push(`.monaco-list${ot} .monaco-tl-indent > .indent-guide.active { border-color: ${nt.treeIndentGuidesStroke}; }`)),this.styleElement.textContent=rt.join(`
`),this.view.style(nt)}getParentElement(nt){const ot=this.model.getParentNodeLocation(nt);return this.model.getNode(ot).element}getFirstElementChild(nt){return this.model.getFirstElementChild(nt)}getNode(nt){return this.model.getNode(nt)}getNodeLocation(nt){return this.model.getNodeLocation(nt)}collapse(nt,ot=!1){return this.model.setCollapsed(nt,!0,ot)}expand(nt,ot=!1){return this.model.setCollapsed(nt,!1,ot)}toggleCollapsed(nt,ot=!1){return this.model.setCollapsed(nt,void 0,ot)}isCollapsible(nt){return this.model.isCollapsible(nt)}setCollapsible(nt,ot){return this.model.setCollapsible(nt,ot)}isCollapsed(nt){return this.model.isCollapsed(nt)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(nt,ot){const rt=nt.map(gt=>this.model.getNode(gt));this.selection.set(rt,ot);const ut=nt.map(gt=>this.model.getListIndex(gt)).filter(gt=>gt>-1);this.view.setSelection(ut,ot,!0)}getSelection(){return this.selection.get()}setFocus(nt,ot){const rt=nt.map(gt=>this.model.getNode(gt));this.focus.set(rt,ot);const ut=nt.map(gt=>this.model.getListIndex(gt)).filter(gt=>gt>-1);this.view.setFocus(ut,ot,!0)}getFocus(){return this.focus.get()}reveal(nt,ot){this.model.expandTo(nt);const rt=this.model.getListIndex(nt);rt!==-1&&this.view.reveal(rt,ot)}onLeftArrow(nt){nt.preventDefault(),nt.stopPropagation();const ot=this.view.getFocusedElements();if(ot.length===0)return;const rt=ot[0],ut=this.model.getNodeLocation(rt);if(!this.model.setCollapsed(ut,!0)){const pt=this.model.getParentNodeLocation(ut);if(!pt)return;const mt=this.model.getListIndex(pt);this.view.reveal(mt),this.view.setFocus([mt])}}onRightArrow(nt){nt.preventDefault(),nt.stopPropagation();const ot=this.view.getFocusedElements();if(ot.length===0)return;const rt=ot[0],ut=this.model.getNodeLocation(rt);if(!this.model.setCollapsed(ut,!1)){if(!rt.children.some(vt=>vt.visible))return;const[pt]=this.view.getFocus(),mt=pt+1;this.view.reveal(mt),this.view.setFocus([mt])}}onSpace(nt){nt.preventDefault(),nt.stopPropagation();const ot=this.view.getFocusedElements();if(ot.length===0)return;const rt=ot[0],ut=this.model.getNodeLocation(rt),gt=nt.browserEvent.altKey;this.model.setCollapsed(ut,void 0,gt)}dispose(){dispose(this.disposables),this.view.dispose()}}class ObjectTreeModel{constructor(nt,ot,rt={}){this.user=nt,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new IndexTreeModel(nt,ot,null,rt),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,rt.sorter&&(this.sorter={compare(ut,gt){return rt.sorter.compare(ut.element,gt.element)}}),this.identityProvider=rt.identityProvider}setChildren(nt,ot=Iterable.empty(),rt={}){const ut=this.getElementLocation(nt);this._setChildren(ut,this.preserveCollapseState(ot),rt)}_setChildren(nt,ot=Iterable.empty(),rt){const ut=new Set,gt=new Set,pt=vt=>{var St;if(vt.element===null)return;const yt=vt;if(ut.add(yt.element),this.nodes.set(yt.element,yt),this.identityProvider){const wt=this.identityProvider.getId(yt.element).toString();gt.add(wt),this.nodesByIdentity.set(wt,yt)}(St=rt.onDidCreateNode)===null||St===void 0||St.call(rt,yt)},mt=vt=>{var St;if(vt.element===null)return;const yt=vt;if(ut.has(yt.element)||this.nodes.delete(yt.element),this.identityProvider){const wt=this.identityProvider.getId(yt.element).toString();gt.has(wt)||this.nodesByIdentity.delete(wt)}(St=rt.onDidDeleteNode)===null||St===void 0||St.call(rt,yt)};this.model.splice([...nt,0],Number.MAX_VALUE,ot,Object.assign(Object.assign({},rt),{onDidCreateNode:pt,onDidDeleteNode:mt}))}preserveCollapseState(nt=Iterable.empty()){return this.sorter&&(nt=[...nt].sort(this.sorter.compare.bind(this.sorter))),Iterable.map(nt,ot=>{let rt=this.nodes.get(ot.element);if(!rt&&this.identityProvider){const pt=this.identityProvider.getId(ot.element).toString();rt=this.nodesByIdentity.get(pt)}if(!rt){let pt;return typeof ot.collapsed>"u"?pt=void 0:ot.collapsed===ObjectTreeElementCollapseState.Collapsed||ot.collapsed===ObjectTreeElementCollapseState.PreserveOrCollapsed?pt=!0:ot.collapsed===ObjectTreeElementCollapseState.Expanded||ot.collapsed===ObjectTreeElementCollapseState.PreserveOrExpanded?pt=!1:pt=!!ot.collapsed,Object.assign(Object.assign({},ot),{children:this.preserveCollapseState(ot.children),collapsed:pt})}const ut=typeof ot.collapsible=="boolean"?ot.collapsible:rt.collapsible;let gt;return typeof ot.collapsed>"u"||ot.collapsed===ObjectTreeElementCollapseState.PreserveOrCollapsed||ot.collapsed===ObjectTreeElementCollapseState.PreserveOrExpanded?gt=rt.collapsed:ot.collapsed===ObjectTreeElementCollapseState.Collapsed?gt=!0:ot.collapsed===ObjectTreeElementCollapseState.Expanded?gt=!1:gt=!!ot.collapsed,Object.assign(Object.assign({},ot),{collapsible:ut,collapsed:gt,children:this.preserveCollapseState(ot.children)})})}rerender(nt){const ot=this.getElementLocation(nt);this.model.rerender(ot)}getFirstElementChild(nt=null){const ot=this.getElementLocation(nt);return this.model.getFirstElementChild(ot)}has(nt){return this.nodes.has(nt)}getListIndex(nt){const ot=this.getElementLocation(nt);return this.model.getListIndex(ot)}getListRenderCount(nt){const ot=this.getElementLocation(nt);return this.model.getListRenderCount(ot)}isCollapsible(nt){const ot=this.getElementLocation(nt);return this.model.isCollapsible(ot)}setCollapsible(nt,ot){const rt=this.getElementLocation(nt);return this.model.setCollapsible(rt,ot)}isCollapsed(nt){const ot=this.getElementLocation(nt);return this.model.isCollapsed(ot)}setCollapsed(nt,ot,rt){const ut=this.getElementLocation(nt);return this.model.setCollapsed(ut,ot,rt)}expandTo(nt){const ot=this.getElementLocation(nt);this.model.expandTo(ot)}refilter(){this.model.refilter()}getNode(nt=null){if(nt===null)return this.model.getNode(this.model.rootRef);const ot=this.nodes.get(nt);if(!ot)throw new TreeError(this.user,`Tree element not found: ${nt}`);return ot}getNodeLocation(nt){return nt.element}getParentNodeLocation(nt){if(nt===null)throw new TreeError(this.user,"Invalid getParentNodeLocation call");const ot=this.nodes.get(nt);if(!ot)throw new TreeError(this.user,`Tree element not found: ${nt}`);const rt=this.model.getNodeLocation(ot),ut=this.model.getParentNodeLocation(rt);return this.model.getNode(ut).element}getElementLocation(nt){if(nt===null)return[];const ot=this.nodes.get(nt);if(!ot)throw new TreeError(this.user,`Tree element not found: ${nt}`);return this.model.getNodeLocation(ot)}}function noCompress(ct){const nt=[ct.element],ot=ct.incompressible||!1;return{element:{elements:nt,incompressible:ot},children:Iterable.map(Iterable.from(ct.children),noCompress),collapsible:ct.collapsible,collapsed:ct.collapsed}}function compress(ct){const nt=[ct.element],ot=ct.incompressible||!1;let rt,ut;for(;[ut,rt]=Iterable.consume(Iterable.from(ct.children),2),!(ut.length!==1||ut[0].incompressible);)ct=ut[0],nt.push(ct.element);return{element:{elements:nt,incompressible:ot},children:Iterable.map(Iterable.concat(ut,rt),compress),collapsible:ct.collapsible,collapsed:ct.collapsed}}function _decompress(ct,nt=0){let ot;return nt<ct.element.elements.length-1?ot=[_decompress(ct,nt+1)]:ot=Iterable.map(Iterable.from(ct.children),rt=>_decompress(rt,0)),nt===0&&ct.element.incompressible?{element:ct.element.elements[nt],children:ot,incompressible:!0,collapsible:ct.collapsible,collapsed:ct.collapsed}:{element:ct.element.elements[nt],children:ot,collapsible:ct.collapsible,collapsed:ct.collapsed}}function decompress(ct){return _decompress(ct,0)}function splice(ct,nt,ot){return ct.element===nt?Object.assign(Object.assign({},ct),{children:ot}):Object.assign(Object.assign({},ct),{children:Iterable.map(Iterable.from(ct.children),rt=>splice(rt,nt,ot))})}const wrapIdentityProvider=ct=>({getId(nt){return nt.elements.map(ot=>ct.getId(ot).toString()).join("\0")}});class CompressedObjectTreeModel{get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(nt,ot,rt={}){this.user=nt,this.rootRef=null,this.nodes=new Map,this.model=new ObjectTreeModel(nt,ot,rt),this.enabled=typeof rt.compressionEnabled>"u"?!0:rt.compressionEnabled,this.identityProvider=rt.identityProvider}setChildren(nt,ot=Iterable.empty(),rt){const ut=rt.diffIdentityProvider&&wrapIdentityProvider(rt.diffIdentityProvider);if(nt===null){const xt=Iterable.map(ot,this.enabled?compress:noCompress);this._setChildren(null,xt,{diffIdentityProvider:ut,diffDepth:1/0});return}const gt=this.nodes.get(nt);if(!gt)throw new TreeError(this.user,"Unknown compressed tree node");const pt=this.model.getNode(gt),mt=this.model.getParentNodeLocation(gt),vt=this.model.getNode(mt),St=decompress(pt),yt=splice(St,nt,ot),wt=(this.enabled?compress:noCompress)(yt),Lt=vt.children.map(xt=>xt===pt?wt:xt);this._setChildren(vt.element,Lt,{diffIdentityProvider:ut,diffDepth:pt.depth-vt.depth})}setCompressionEnabled(nt){if(nt===this.enabled)return;this.enabled=nt;const rt=this.model.getNode().children,ut=Iterable.map(rt,decompress),gt=Iterable.map(ut,nt?compress:noCompress);this._setChildren(null,gt,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(nt,ot,rt){const ut=new Set,gt=mt=>{for(const vt of mt.element.elements)ut.add(vt),this.nodes.set(vt,mt.element)},pt=mt=>{for(const vt of mt.element.elements)ut.has(vt)||this.nodes.delete(vt)};this.model.setChildren(nt,ot,Object.assign(Object.assign({},rt),{onDidCreateNode:gt,onDidDeleteNode:pt}))}has(nt){return this.nodes.has(nt)}getListIndex(nt){const ot=this.getCompressedNode(nt);return this.model.getListIndex(ot)}getListRenderCount(nt){const ot=this.getCompressedNode(nt);return this.model.getListRenderCount(ot)}getNode(nt){if(typeof nt>"u")return this.model.getNode();const ot=this.getCompressedNode(nt);return this.model.getNode(ot)}getNodeLocation(nt){const ot=this.model.getNodeLocation(nt);return ot===null?null:ot.elements[ot.elements.length-1]}getParentNodeLocation(nt){const ot=this.getCompressedNode(nt),rt=this.model.getParentNodeLocation(ot);return rt===null?null:rt.elements[rt.elements.length-1]}getFirstElementChild(nt){const ot=this.getCompressedNode(nt);return this.model.getFirstElementChild(ot)}isCollapsible(nt){const ot=this.getCompressedNode(nt);return this.model.isCollapsible(ot)}setCollapsible(nt,ot){const rt=this.getCompressedNode(nt);return this.model.setCollapsible(rt,ot)}isCollapsed(nt){const ot=this.getCompressedNode(nt);return this.model.isCollapsed(ot)}setCollapsed(nt,ot,rt){const ut=this.getCompressedNode(nt);return this.model.setCollapsed(ut,ot,rt)}expandTo(nt){const ot=this.getCompressedNode(nt);this.model.expandTo(ot)}rerender(nt){const ot=this.getCompressedNode(nt);this.model.rerender(ot)}refilter(){this.model.refilter()}getCompressedNode(nt){if(nt===null)return null;const ot=this.nodes.get(nt);if(!ot)throw new TreeError(this.user,`Tree element not found: ${nt}`);return ot}}const DefaultElementMapper=ct=>ct[ct.length-1];class CompressedTreeNodeWrapper{get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(nt=>new CompressedTreeNodeWrapper(this.unwrapper,nt))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(nt,ot){this.unwrapper=nt,this.node=ot}}function mapList(ct,nt){return{splice(ot,rt,ut){nt.splice(ot,rt,ut.map(gt=>ct.map(gt)))},updateElementHeight(ot,rt){nt.updateElementHeight(ot,rt)}}}function mapOptions(ct,nt){return Object.assign(Object.assign({},nt),{identityProvider:nt.identityProvider&&{getId(ot){return nt.identityProvider.getId(ct(ot))}},sorter:nt.sorter&&{compare(ot,rt){return nt.sorter.compare(ot.elements[0],rt.elements[0])}},filter:nt.filter&&{filter(ot,rt){return nt.filter.filter(ct(ot),rt)}}})}class CompressibleObjectTreeModel{get onDidSplice(){return Event.map(this.model.onDidSplice,({insertedNodes:nt,deletedNodes:ot})=>({insertedNodes:nt.map(rt=>this.nodeMapper.map(rt)),deletedNodes:ot.map(rt=>this.nodeMapper.map(rt))}))}get onDidChangeCollapseState(){return Event.map(this.model.onDidChangeCollapseState,({node:nt,deep:ot})=>({node:this.nodeMapper.map(nt),deep:ot}))}get onDidChangeRenderNodeCount(){return Event.map(this.model.onDidChangeRenderNodeCount,nt=>this.nodeMapper.map(nt))}constructor(nt,ot,rt={}){this.rootRef=null,this.elementMapper=rt.elementMapper||DefaultElementMapper;const ut=gt=>this.elementMapper(gt.elements);this.nodeMapper=new WeakMapper(gt=>new CompressedTreeNodeWrapper(ut,gt)),this.model=new CompressedObjectTreeModel(nt,mapList(this.nodeMapper,ot),mapOptions(ut,rt))}setChildren(nt,ot=Iterable.empty(),rt={}){this.model.setChildren(nt,ot,rt)}setCompressionEnabled(nt){this.model.setCompressionEnabled(nt)}has(nt){return this.model.has(nt)}getListIndex(nt){return this.model.getListIndex(nt)}getListRenderCount(nt){return this.model.getListRenderCount(nt)}getNode(nt){return this.nodeMapper.map(this.model.getNode(nt))}getNodeLocation(nt){return nt.element}getParentNodeLocation(nt){return this.model.getParentNodeLocation(nt)}getFirstElementChild(nt){const ot=this.model.getFirstElementChild(nt);return ot===null||typeof ot>"u"?ot:this.elementMapper(ot.elements)}isCollapsible(nt){return this.model.isCollapsible(nt)}setCollapsible(nt,ot){return this.model.setCollapsible(nt,ot)}isCollapsed(nt){return this.model.isCollapsed(nt)}setCollapsed(nt,ot,rt){return this.model.setCollapsed(nt,ot,rt)}expandTo(nt){return this.model.expandTo(nt)}rerender(nt){return this.model.rerender(nt)}refilter(){return this.model.refilter()}getCompressedTreeNode(nt=null){return this.model.getNode(nt)}}var __decorate$1E=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt};class ObjectTree extends AbstractTree{get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}constructor(nt,ot,rt,ut,gt={}){super(nt,ot,rt,ut,gt),this.user=nt}setChildren(nt,ot=Iterable.empty(),rt){this.model.setChildren(nt,ot,rt)}rerender(nt){if(nt===void 0){this.view.rerender();return}this.model.rerender(nt)}hasElement(nt){return this.model.has(nt)}createModel(nt,ot,rt){return new ObjectTreeModel(nt,ot,rt)}}class CompressibleRenderer{get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}constructor(nt,ot){this._compressedTreeNodeProvider=nt,this.renderer=ot,this.templateId=ot.templateId,ot.onDidChangeTwistieState&&(this.onDidChangeTwistieState=ot.onDidChangeTwistieState)}renderTemplate(nt){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(nt)}}renderElement(nt,ot,rt,ut){const gt=this.compressedTreeNodeProvider.getCompressedTreeNode(nt.element);gt.element.elements.length===1?(rt.compressedTreeNode=void 0,this.renderer.renderElement(nt,ot,rt.data,ut)):(rt.compressedTreeNode=gt,this.renderer.renderCompressedElements(gt,ot,rt.data,ut))}disposeElement(nt,ot,rt,ut){var gt,pt,mt,vt;rt.compressedTreeNode?(pt=(gt=this.renderer).disposeCompressedElements)===null||pt===void 0||pt.call(gt,rt.compressedTreeNode,ot,rt.data,ut):(vt=(mt=this.renderer).disposeElement)===null||vt===void 0||vt.call(mt,nt,ot,rt.data,ut)}disposeTemplate(nt){this.renderer.disposeTemplate(nt.data)}renderTwistie(nt,ot){return this.renderer.renderTwistie?this.renderer.renderTwistie(nt,ot):!1}}__decorate$1E([memoize],CompressibleRenderer.prototype,"compressedTreeNodeProvider",null);function asObjectTreeOptions$1(ct,nt){return nt&&Object.assign(Object.assign({},nt),{keyboardNavigationLabelProvider:nt.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(ot){let rt;try{rt=ct().getCompressedTreeNode(ot)}catch{return nt.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(ot)}return rt.element.elements.length===1?nt.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(ot):nt.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(rt.element.elements)}}})}class CompressibleObjectTree extends ObjectTree{constructor(nt,ot,rt,ut,gt={}){const pt=()=>this,mt=ut.map(vt=>new CompressibleRenderer(pt,vt));super(nt,ot,rt,mt,asObjectTreeOptions$1(pt,gt))}setChildren(nt,ot=Iterable.empty(),rt){this.model.setChildren(nt,ot,rt)}createModel(nt,ot,rt){return new CompressibleObjectTreeModel(nt,ot,rt)}updateOptions(nt={}){super.updateOptions(nt),typeof nt.compressionEnabled<"u"&&this.model.setCompressionEnabled(nt.compressionEnabled)}getCompressedTreeNode(nt=null){return this.model.getCompressedTreeNode(nt)}}var __awaiter$1a=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function createAsyncDataTreeNode(ct){return Object.assign(Object.assign({},ct),{children:[],refreshPromise:void 0,stale:!0,slow:!1,collapsedByDefault:void 0})}function isAncestor(ct,nt){return nt.parent?nt.parent===ct?!0:isAncestor(ct,nt.parent):!1}function intersects(ct,nt){return ct===nt||isAncestor(ct,nt)||isAncestor(nt,ct)}class AsyncDataTreeNodeWrapper{get element(){return this.node.element.element}get children(){return this.node.children.map(nt=>new AsyncDataTreeNodeWrapper(nt))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(nt){this.node=nt}}class AsyncDataTreeRenderer{constructor(nt,ot,rt){this.renderer=nt,this.nodeMapper=ot,this.onDidChangeTwistieState=rt,this.renderedNodes=new Map,this.templateId=nt.templateId}renderTemplate(nt){return{templateData:this.renderer.renderTemplate(nt)}}renderElement(nt,ot,rt,ut){this.renderer.renderElement(this.nodeMapper.map(nt),ot,rt.templateData,ut)}renderTwistie(nt,ot){return nt.slow?(ot.classList.add(...ThemeIcon.asClassNameArray(Codicon.treeItemLoading)),!0):(ot.classList.remove(...ThemeIcon.asClassNameArray(Codicon.treeItemLoading)),!1)}disposeElement(nt,ot,rt,ut){var gt,pt;(pt=(gt=this.renderer).disposeElement)===null||pt===void 0||pt.call(gt,this.nodeMapper.map(nt),ot,rt.templateData,ut)}disposeTemplate(nt){this.renderer.disposeTemplate(nt.templateData)}dispose(){this.renderedNodes.clear()}}function asTreeEvent(ct){return{browserEvent:ct.browserEvent,elements:ct.elements.map(nt=>nt.element)}}function asTreeMouseEvent(ct){return{browserEvent:ct.browserEvent,element:ct.element&&ct.element.element,target:ct.target}}class AsyncDataTreeElementsDragAndDropData extends ElementsDragAndDropData{constructor(nt){super(nt.elements.map(ot=>ot.element)),this.data=nt}}function asAsyncDataTreeDragAndDropData(ct){return ct instanceof ElementsDragAndDropData?new AsyncDataTreeElementsDragAndDropData(ct):ct}class AsyncDataTreeNodeListDragAndDrop{constructor(nt){this.dnd=nt}getDragURI(nt){return this.dnd.getDragURI(nt.element)}getDragLabel(nt,ot){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(nt.map(rt=>rt.element),ot)}onDragStart(nt,ot){var rt,ut;(ut=(rt=this.dnd).onDragStart)===null||ut===void 0||ut.call(rt,asAsyncDataTreeDragAndDropData(nt),ot)}onDragOver(nt,ot,rt,ut,gt=!0){return this.dnd.onDragOver(asAsyncDataTreeDragAndDropData(nt),ot&&ot.element,rt,ut)}drop(nt,ot,rt,ut){this.dnd.drop(asAsyncDataTreeDragAndDropData(nt),ot&&ot.element,rt,ut)}onDragEnd(nt){var ot,rt;(rt=(ot=this.dnd).onDragEnd)===null||rt===void 0||rt.call(ot,nt)}}function asObjectTreeOptions(ct){return ct&&Object.assign(Object.assign({},ct),{collapseByDefault:!0,identityProvider:ct.identityProvider&&{getId(nt){return ct.identityProvider.getId(nt.element)}},dnd:ct.dnd&&new AsyncDataTreeNodeListDragAndDrop(ct.dnd),multipleSelectionController:ct.multipleSelectionController&&{isSelectionSingleChangeEvent(nt){return ct.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},nt),{element:nt.element}))},isSelectionRangeChangeEvent(nt){return ct.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},nt),{element:nt.element}))}},accessibilityProvider:ct.accessibilityProvider&&Object.assign(Object.assign({},ct.accessibilityProvider),{getPosInSet:void 0,getSetSize:void 0,getRole:ct.accessibilityProvider.getRole?nt=>ct.accessibilityProvider.getRole(nt.element):()=>"treeitem",isChecked:ct.accessibilityProvider.isChecked?nt=>{var ot;return!!(!((ot=ct.accessibilityProvider)===null||ot===void 0)&&ot.isChecked(nt.element))}:void 0,getAriaLabel(nt){return ct.accessibilityProvider.getAriaLabel(nt.element)},getWidgetAriaLabel(){return ct.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:ct.accessibilityProvider.getWidgetRole?()=>ct.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:ct.accessibilityProvider.getAriaLevel&&(nt=>ct.accessibilityProvider.getAriaLevel(nt.element)),getActiveDescendantId:ct.accessibilityProvider.getActiveDescendantId&&(nt=>ct.accessibilityProvider.getActiveDescendantId(nt.element))}),filter:ct.filter&&{filter(nt,ot){return ct.filter.filter(nt.element,ot)}},keyboardNavigationLabelProvider:ct.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},ct.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel(nt){return ct.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(nt.element)}}),sorter:void 0,expandOnlyOnTwistieClick:typeof ct.expandOnlyOnTwistieClick>"u"?void 0:typeof ct.expandOnlyOnTwistieClick!="function"?ct.expandOnlyOnTwistieClick:nt=>ct.expandOnlyOnTwistieClick(nt.element),defaultFindVisibility:nt=>nt.hasChildren&&nt.stale?1:typeof ct.defaultFindVisibility=="number"?ct.defaultFindVisibility:typeof ct.defaultFindVisibility>"u"?2:ct.defaultFindVisibility(nt.element)})}function dfs(ct,nt){nt(ct),ct.children.forEach(ot=>dfs(ot,nt))}class AsyncDataTree{get onDidChangeFocus(){return Event.map(this.tree.onDidChangeFocus,asTreeEvent)}get onDidChangeSelection(){return Event.map(this.tree.onDidChangeSelection,asTreeEvent)}get onMouseDblClick(){return Event.map(this.tree.onMouseDblClick,asTreeMouseEvent)}get onPointer(){return Event.map(this.tree.onPointer,asTreeMouseEvent)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidDispose(){return this.tree.onDidDispose}constructor(nt,ot,rt,ut,gt,pt={}){this.user=nt,this.dataSource=gt,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new Emitter$2,this._onDidChangeNodeSlowState=new Emitter$2,this.nodeMapper=new WeakMapper(mt=>new AsyncDataTreeNodeWrapper(mt)),this.disposables=new DisposableStore,this.identityProvider=pt.identityProvider,this.autoExpandSingleChildren=typeof pt.autoExpandSingleChildren>"u"?!1:pt.autoExpandSingleChildren,this.sorter=pt.sorter,this.collapseByDefault=pt.collapseByDefault,this.tree=this.createTree(nt,ot,rt,ut,pt),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.root=createAsyncDataTreeNode({element:void 0,parent:null,hasChildren:!0}),this.identityProvider&&(this.root=Object.assign(Object.assign({},this.root),{id:null})),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}createTree(nt,ot,rt,ut,gt){const pt=new ComposedTreeDelegate(rt),mt=ut.map(St=>new AsyncDataTreeRenderer(St,this.nodeMapper,this._onDidChangeNodeSlowState.event)),vt=asObjectTreeOptions(gt)||{};return new ObjectTree(nt,ot,pt,mt,vt)}updateOptions(nt={}){this.tree.updateOptions(nt)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(nt){this.tree.scrollTop=nt}domFocus(){this.tree.domFocus()}layout(nt,ot){this.tree.layout(nt,ot)}style(nt){this.tree.style(nt)}getInput(){return this.root.element}setInput(nt,ot){return __awaiter$1a(this,void 0,void 0,function*(){this.refreshPromises.forEach(ut=>ut.cancel()),this.refreshPromises.clear(),this.root.element=nt;const rt=ot&&{viewState:ot,focus:[],selection:[]};yield this._updateChildren(nt,!0,!1,rt),rt&&(this.tree.setFocus(rt.focus),this.tree.setSelection(rt.selection)),ot&&typeof ot.scrollTop=="number"&&(this.scrollTop=ot.scrollTop)})}_updateChildren(nt=this.root.element,ot=!0,rt=!1,ut,gt){return __awaiter$1a(this,void 0,void 0,function*(){if(typeof this.root.element>"u")throw new TreeError(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield Event.toPromise(this._onDidRender.event));const pt=this.getDataNode(nt);if(yield this.refreshAndRenderNode(pt,ot,ut,gt),rt)try{this.tree.rerender(pt)}catch{}})}rerender(nt){if(nt===void 0||nt===this.root.element){this.tree.rerender();return}const ot=this.getDataNode(nt);this.tree.rerender(ot)}getNode(nt=this.root.element){const ot=this.getDataNode(nt),rt=this.tree.getNode(ot===this.root?null:ot);return this.nodeMapper.map(rt)}collapse(nt,ot=!1){const rt=this.getDataNode(nt);return this.tree.collapse(rt===this.root?null:rt,ot)}expand(nt,ot=!1){return __awaiter$1a(this,void 0,void 0,function*(){if(typeof this.root.element>"u")throw new TreeError(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield Event.toPromise(this._onDidRender.event));const rt=this.getDataNode(nt);if(this.tree.hasElement(rt)&&!this.tree.isCollapsible(rt)||(rt.refreshPromise&&(yield this.root.refreshPromise,yield Event.toPromise(this._onDidRender.event)),rt!==this.root&&!rt.refreshPromise&&!this.tree.isCollapsed(rt)))return!1;const ut=this.tree.expand(rt===this.root?null:rt,ot);return rt.refreshPromise&&(yield this.root.refreshPromise,yield Event.toPromise(this._onDidRender.event)),ut})}setSelection(nt,ot){const rt=nt.map(ut=>this.getDataNode(ut));this.tree.setSelection(rt,ot)}getSelection(){return this.tree.getSelection().map(ot=>ot.element)}setFocus(nt,ot){const rt=nt.map(ut=>this.getDataNode(ut));this.tree.setFocus(rt,ot)}getFocus(){return this.tree.getFocus().map(ot=>ot.element)}reveal(nt,ot){this.tree.reveal(this.getDataNode(nt),ot)}getParentElement(nt){const ot=this.tree.getParentElement(this.getDataNode(nt));return ot&&ot.element}getFirstElementChild(nt=this.root.element){const ot=this.getDataNode(nt),rt=this.tree.getFirstElementChild(ot===this.root?null:ot);return rt&&rt.element}getDataNode(nt){const ot=this.nodes.get(nt===this.root.element?null:nt);if(!ot)throw new TreeError(this.user,`Data tree node not found: ${nt}`);return ot}refreshAndRenderNode(nt,ot,rt,ut){return __awaiter$1a(this,void 0,void 0,function*(){yield this.refreshNode(nt,ot,rt),this.render(nt,rt,ut)})}refreshNode(nt,ot,rt){return __awaiter$1a(this,void 0,void 0,function*(){let ut;if(this.subTreeRefreshPromises.forEach((gt,pt)=>{!ut&&intersects(pt,nt)&&(ut=gt.then(()=>this.refreshNode(nt,ot,rt)))}),ut)return ut;if(nt!==this.root&&this.tree.getNode(nt).collapsed){nt.hasChildren=!!this.dataSource.hasChildren(nt.element),nt.stale=!0;return}return this.doRefreshSubTree(nt,ot,rt)})}doRefreshSubTree(nt,ot,rt){return __awaiter$1a(this,void 0,void 0,function*(){let ut;nt.refreshPromise=new Promise(gt=>ut=gt),this.subTreeRefreshPromises.set(nt,nt.refreshPromise),nt.refreshPromise.finally(()=>{nt.refreshPromise=void 0,this.subTreeRefreshPromises.delete(nt)});try{const gt=yield this.doRefreshNode(nt,ot,rt);nt.stale=!1,yield Promises.settled(gt.map(pt=>this.doRefreshSubTree(pt,ot,rt)))}finally{ut()}})}doRefreshNode(nt,ot,rt){return __awaiter$1a(this,void 0,void 0,function*(){nt.hasChildren=!!this.dataSource.hasChildren(nt.element);let ut;if(!nt.hasChildren)ut=Promise.resolve(Iterable.empty());else{const gt=this.doGetChildren(nt);if(isIterable(gt))ut=Promise.resolve(gt);else{const pt=timeout(800);pt.then(()=>{nt.slow=!0,this._onDidChangeNodeSlowState.fire(nt)},mt=>null),ut=gt.finally(()=>pt.cancel())}}try{const gt=yield ut;return this.setChildren(nt,gt,ot,rt)}catch(gt){if(nt!==this.root&&this.tree.hasElement(nt)&&this.tree.collapse(nt),isCancellationError(gt))return[];throw gt}finally{nt.slow&&(nt.slow=!1,this._onDidChangeNodeSlowState.fire(nt))}})}doGetChildren(nt){let ot=this.refreshPromises.get(nt);if(ot)return ot;const rt=this.dataSource.getChildren(nt.element);return isIterable(rt)?this.processChildren(rt):(ot=createCancelablePromise(()=>__awaiter$1a(this,void 0,void 0,function*(){return this.processChildren(yield rt)})),this.refreshPromises.set(nt,ot),ot.finally(()=>{this.refreshPromises.delete(nt)}))}_onDidChangeCollapseState({node:nt,deep:ot}){nt.element!==null&&!nt.collapsed&&nt.element.stale&&(ot?this.collapse(nt.element.element):this.refreshAndRenderNode(nt.element,!1).catch(onUnexpectedError))}setChildren(nt,ot,rt,ut){const gt=[...ot];if(nt.children.length===0&&gt.length===0)return[];const pt=new Map,mt=new Map;for(const yt of nt.children)if(pt.set(yt.element,yt),this.identityProvider){const wt=this.tree.isCollapsed(yt);mt.set(yt.id,{node:yt,collapsed:wt})}const vt=[],St=gt.map(yt=>{const wt=!!this.dataSource.hasChildren(yt);if(!this.identityProvider){const kt=createAsyncDataTreeNode({element:yt,parent:nt,hasChildren:wt});return wt&&this.collapseByDefault&&!this.collapseByDefault(yt)&&(kt.collapsedByDefault=!1,vt.push(kt)),kt}const Lt=this.identityProvider.getId(yt).toString(),xt=mt.get(Lt);if(xt){const kt=xt.node;return pt.delete(kt.element),this.nodes.delete(kt.element),this.nodes.set(yt,kt),kt.element=yt,kt.hasChildren=wt,rt?xt.collapsed?(kt.children.forEach(At=>dfs(At,Tt=>this.nodes.delete(Tt.element))),kt.children.splice(0,kt.children.length),kt.stale=!0):vt.push(kt):wt&&this.collapseByDefault&&!this.collapseByDefault(yt)&&(kt.collapsedByDefault=!1,vt.push(kt)),kt}const It=createAsyncDataTreeNode({element:yt,parent:nt,id:Lt,hasChildren:wt});return ut&&ut.viewState.focus&&ut.viewState.focus.indexOf(Lt)>-1&&ut.focus.push(It),ut&&ut.viewState.selection&&ut.viewState.selection.indexOf(Lt)>-1&&ut.selection.push(It),ut&&ut.viewState.expanded&&ut.viewState.expanded.indexOf(Lt)>-1?vt.push(It):wt&&this.collapseByDefault&&!this.collapseByDefault(yt)&&(It.collapsedByDefault=!1,vt.push(It)),It});for(const yt of pt.values())dfs(yt,wt=>this.nodes.delete(wt.element));for(const yt of St)this.nodes.set(yt.element,yt);return nt.children.splice(0,nt.children.length,...St),nt!==this.root&&this.autoExpandSingleChildren&&St.length===1&&vt.length===0&&(St[0].collapsedByDefault=!1,vt.push(St[0])),vt}render(nt,ot,rt){const ut=nt.children.map(pt=>this.asTreeElement(pt,ot)),gt=rt&&Object.assign(Object.assign({},rt),{diffIdentityProvider:rt.diffIdentityProvider&&{getId(pt){return rt.diffIdentityProvider.getId(pt.element)}}});this.tree.setChildren(nt===this.root?null:nt,ut,gt),nt!==this.root&&this.tree.setCollapsible(nt,nt.hasChildren),this._onDidRender.fire()}asTreeElement(nt,ot){if(nt.stale)return{element:nt,collapsible:nt.hasChildren,collapsed:!0};let rt;return ot&&ot.viewState.expanded&&nt.id&&ot.viewState.expanded.indexOf(nt.id)>-1?rt=!1:rt=nt.collapsedByDefault,nt.collapsedByDefault=void 0,{element:nt,children:nt.hasChildren?Iterable.map(nt.children,ut=>this.asTreeElement(ut,ot)):[],collapsible:nt.hasChildren,collapsed:rt}}processChildren(nt){return this.sorter&&(nt=[...nt].sort(this.sorter.compare.bind(this.sorter))),nt}dispose(){this.disposables.dispose()}}class CompressibleAsyncDataTreeNodeWrapper{get element(){return{elements:this.node.element.elements.map(nt=>nt.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(nt=>new CompressibleAsyncDataTreeNodeWrapper(nt))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(nt){this.node=nt}}class CompressibleAsyncDataTreeRenderer{constructor(nt,ot,rt,ut){this.renderer=nt,this.nodeMapper=ot,this.compressibleNodeMapperProvider=rt,this.onDidChangeTwistieState=ut,this.renderedNodes=new Map,this.disposables=[],this.templateId=nt.templateId}renderTemplate(nt){return{templateData:this.renderer.renderTemplate(nt)}}renderElement(nt,ot,rt,ut){this.renderer.renderElement(this.nodeMapper.map(nt),ot,rt.templateData,ut)}renderCompressedElements(nt,ot,rt,ut){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(nt),ot,rt.templateData,ut)}renderTwistie(nt,ot){return nt.slow?(ot.classList.add(...ThemeIcon.asClassNameArray(Codicon.treeItemLoading)),!0):(ot.classList.remove(...ThemeIcon.asClassNameArray(Codicon.treeItemLoading)),!1)}disposeElement(nt,ot,rt,ut){var gt,pt;(pt=(gt=this.renderer).disposeElement)===null||pt===void 0||pt.call(gt,this.nodeMapper.map(nt),ot,rt.templateData,ut)}disposeCompressedElements(nt,ot,rt,ut){var gt,pt;(pt=(gt=this.renderer).disposeCompressedElements)===null||pt===void 0||pt.call(gt,this.compressibleNodeMapperProvider().map(nt),ot,rt.templateData,ut)}disposeTemplate(nt){this.renderer.disposeTemplate(nt.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=dispose(this.disposables)}}function asCompressibleObjectTreeOptions(ct){const nt=ct&&asObjectTreeOptions(ct);return nt&&Object.assign(Object.assign({},nt),{keyboardNavigationLabelProvider:nt.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},nt.keyboardNavigationLabelProvider),{getCompressedNodeKeyboardNavigationLabel(ot){return ct.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(ot.map(rt=>rt.element))}})})}class CompressibleAsyncDataTree extends AsyncDataTree{constructor(nt,ot,rt,ut,gt,pt,mt={}){super(nt,ot,rt,gt,pt,mt),this.compressionDelegate=ut,this.compressibleNodeMapper=new WeakMapper(vt=>new CompressibleAsyncDataTreeNodeWrapper(vt)),this.filter=mt.filter}createTree(nt,ot,rt,ut,gt){const pt=new ComposedTreeDelegate(rt),mt=ut.map(St=>new CompressibleAsyncDataTreeRenderer(St,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),vt=asCompressibleObjectTreeOptions(gt)||{};return new CompressibleObjectTree(nt,ot,pt,mt,vt)}asTreeElement(nt,ot){return Object.assign({incompressible:this.compressionDelegate.isIncompressible(nt.element)},super.asTreeElement(nt,ot))}updateOptions(nt={}){this.tree.updateOptions(nt)}render(nt,ot){if(!this.identityProvider)return super.render(nt,ot);const rt=Lt=>this.identityProvider.getId(Lt).toString(),ut=Lt=>{const xt=new Set;for(const It of Lt){const kt=this.tree.getCompressedTreeNode(It===this.root?null:It);if(kt.element)for(const At of kt.element.elements)xt.add(rt(At.element))}return xt},gt=ut(this.tree.getSelection()),pt=ut(this.tree.getFocus());super.render(nt,ot);const mt=this.getSelection();let vt=!1;const St=this.getFocus();let yt=!1;const wt=Lt=>{const xt=Lt.element;if(xt)for(let It=0;It<xt.elements.length;It++){const kt=rt(xt.elements[It].element),At=xt.elements[xt.elements.length-1].element;gt.has(kt)&&mt.indexOf(At)===-1&&(mt.push(At),vt=!0),pt.has(kt)&&St.indexOf(At)===-1&&(St.push(At),yt=!0)}Lt.children.forEach(wt)};wt(this.tree.getCompressedTreeNode(nt===this.root?null:nt)),vt&&this.setSelection(mt),yt&&this.setFocus(St)}processChildren(nt){return this.filter&&(nt=Iterable.filter(nt,ot=>{const rt=this.filter.filter(ot,1),ut=getVisibility(rt);if(ut===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return ut===1})),super.processChildren(nt)}}function getVisibility(ct){return typeof ct=="boolean"?ct?1:0:isFilterResult(ct)?getVisibleState(ct.visibility):getVisibleState(ct)}class DataTree extends AbstractTree{constructor(nt,ot,rt,ut,gt,pt={}){super(nt,ot,rt,ut,pt),this.user=nt,this.dataSource=gt,this.identityProvider=pt.identityProvider}createModel(nt,ot,rt){return new ObjectTreeModel(nt,ot,rt)}}new RawContextKey("isMac",isMacintosh,localize("isMac","Whether the operating system is macOS"));new RawContextKey("isLinux",isLinux,localize("isLinux","Whether the operating system is Linux"));const IsWindowsContext=new RawContextKey("isWindows",isWindows,localize("isWindows","Whether the operating system is Windows"));new RawContextKey("isWeb",isWeb,localize("isWeb","Whether the platform is a web browser"));new RawContextKey("isMacNative",isMacintosh&&!isWeb,localize("isMacNative","Whether the operating system is macOS on a non-browser platform"));new RawContextKey("isIOS",isIOS,localize("isIOS","Whether the operating system is iOS"));new RawContextKey("isMobile",isMobile,localize("isMobile","Whether the platform is a mobile web browser"));new RawContextKey("isDevelopment",!1,!0);new RawContextKey("productQualityType","",localize("productQualityType","Quality type of VS Code"));const InputFocusedContextKey="inputFocus";new RawContextKey(InputFocusedContextKey,!1,localize("inputFocus","Whether keyboard focus is inside an input box"));var __decorate$1D=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1B=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const IListService=createDecorator("listService");class ListService{get lastFocusedList(){return this._lastFocusedWidget}constructor(){this.disposables=new DisposableStore,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}setLastFocusedList(nt){var ot,rt;nt!==this._lastFocusedWidget&&((ot=this._lastFocusedWidget)===null||ot===void 0||ot.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=nt,(rt=this._lastFocusedWidget)===null||rt===void 0||rt.getHTMLElement().classList.add("last-focused"))}register(nt,ot){if(this._hasCreatedStyleController||(this._hasCreatedStyleController=!0,new DefaultStyleController(createStyleSheet(),"").style(defaultListStyles)),this.lists.some(ut=>ut.widget===nt))throw new Error("Cannot register the same widget multiple times");const rt={widget:nt,extraContextKeys:ot};return this.lists.push(rt),nt.getHTMLElement()===document.activeElement&&this.setLastFocusedList(nt),combinedDisposable(nt.onDidFocus(()=>this.setLastFocusedList(nt)),toDisposable(()=>this.lists.splice(this.lists.indexOf(rt),1)),nt.onDidDispose(()=>{this.lists=this.lists.filter(ut=>ut!==rt),this._lastFocusedWidget===nt&&this.setLastFocusedList(void 0)}))}dispose(){this.disposables.dispose()}}const RawWorkbenchListFocusContextKey=new RawContextKey("listFocus",!0),WorkbenchListSupportsMultiSelectContextKey=new RawContextKey("listSupportsMultiselect",!0),WorkbenchListFocusContextKey=ContextKeyExpr.and(RawWorkbenchListFocusContextKey,ContextKeyExpr.not(InputFocusedContextKey)),WorkbenchListHasSelectionOrFocus=new RawContextKey("listHasSelectionOrFocus",!1),WorkbenchListDoubleSelection=new RawContextKey("listDoubleSelection",!1),WorkbenchListMultiSelection=new RawContextKey("listMultiSelection",!1),WorkbenchListSelectionNavigation=new RawContextKey("listSelectionNavigation",!1),WorkbenchListSupportsFind=new RawContextKey("listSupportsFind",!0),WorkbenchTreeElementCanCollapse=new RawContextKey("treeElementCanCollapse",!1),WorkbenchTreeElementHasParent=new RawContextKey("treeElementHasParent",!1),WorkbenchTreeElementCanExpand=new RawContextKey("treeElementCanExpand",!1),WorkbenchTreeElementHasChild=new RawContextKey("treeElementHasChild",!1),WorkbenchTreeFindOpen=new RawContextKey("treeFindOpen",!1),WorkbenchListTypeNavigationModeKey="listTypeNavigationMode",WorkbenchListAutomaticKeyboardNavigationLegacyKey="listAutomaticKeyboardNavigation";function createScopedContextKeyService(ct,nt){const ot=ct.createScoped(nt.getHTMLElement());return RawWorkbenchListFocusContextKey.bindTo(ot),ot}const multiSelectModifierSettingKey="workbench.list.multiSelectModifier",openModeSettingKey="workbench.list.openMode",horizontalScrollingKey="workbench.list.horizontalScrolling",defaultFindModeSettingKey="workbench.list.defaultFindMode",typeNavigationModeSettingKey="workbench.list.typeNavigationMode",keyboardNavigationSettingKey="workbench.list.keyboardNavigation",scrollByPageKey="workbench.list.scrollByPage",defaultFindMatchTypeSettingKey="workbench.list.defaultFindMatchType",treeIndentKey="workbench.tree.indent",treeRenderIndentGuidesKey="workbench.tree.renderIndentGuides",listSmoothScrolling="workbench.list.smoothScrolling",mouseWheelScrollSensitivityKey="workbench.list.mouseWheelScrollSensitivity",fastScrollSensitivityKey="workbench.list.fastScrollSensitivity",treeExpandMode="workbench.tree.expandMode";function useAltAsMultipleSelectionModifier(ct){return ct.getValue(multiSelectModifierSettingKey)==="alt"}class MultipleSelectionController extends Disposable{constructor(nt){super(),this.configurationService=nt,this.useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(nt),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(nt=>{nt.affectsConfiguration(multiSelectModifierSettingKey)&&(this.useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(this.configurationService))}))}isSelectionSingleChangeEvent(nt){return this.useAltAsMultipleSelectionModifier?nt.browserEvent.altKey:isSelectionSingleChangeEvent(nt)}isSelectionRangeChangeEvent(nt){return isSelectionRangeChangeEvent(nt)}}function toWorkbenchListOptions(ct,nt){var ot;const rt=ct.get(IConfigurationService),ut=ct.get(IKeybindingService),gt=new DisposableStore;return[Object.assign(Object.assign({},nt),{keyboardNavigationDelegate:{mightProducePrintableCharacter(mt){return ut.mightProducePrintableCharacter(mt)}},smoothScrolling:!!rt.getValue(listSmoothScrolling),mouseWheelScrollSensitivity:rt.getValue(mouseWheelScrollSensitivityKey),fastScrollSensitivity:rt.getValue(fastScrollSensitivityKey),multipleSelectionController:(ot=nt.multipleSelectionController)!==null&&ot!==void 0?ot:gt.add(new MultipleSelectionController(rt)),keyboardNavigationEventFilter:createKeyboardNavigationEventFilter(ut),scrollByPage:!!rt.getValue(scrollByPageKey)}),gt]}let WorkbenchList=class extends List{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St){const yt=typeof gt.horizontalScrolling<"u"?gt.horizontalScrolling:!!vt.getValue(horizontalScrollingKey),[wt,Lt]=St.invokeFunction(toWorkbenchListOptions,gt);super(nt,ot,rt,ut,Object.assign(Object.assign({keyboardSupport:!1},wt),{horizontalScrolling:yt})),this.disposables.add(Lt),this.contextKeyService=createScopedContextKeyService(pt,this),this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(gt.multipleSelectionSupport!==!1),WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(!!gt.selectionNavigation),this.listHasSelectionOrFocus=WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.listDoubleSelection=WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.listMultiSelection=WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.horizontalScrolling=gt.horizontalScrolling,this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(vt),this.disposables.add(this.contextKeyService),this.disposables.add(mt.register(this)),this.updateStyles(gt.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const It=this.getSelection(),kt=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(It.length>0||kt.length>0),this.listMultiSelection.set(It.length>1),this.listDoubleSelection.set(It.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const It=this.getSelection(),kt=this.getFocus();this.listHasSelectionOrFocus.set(It.length>0||kt.length>0)})),this.disposables.add(vt.onDidChangeConfiguration(It=>{It.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(vt));let kt={};if(It.affectsConfiguration(horizontalScrollingKey)&&this.horizontalScrolling===void 0){const At=!!vt.getValue(horizontalScrollingKey);kt=Object.assign(Object.assign({},kt),{horizontalScrolling:At})}if(It.affectsConfiguration(scrollByPageKey)){const At=!!vt.getValue(scrollByPageKey);kt=Object.assign(Object.assign({},kt),{scrollByPage:At})}if(It.affectsConfiguration(listSmoothScrolling)){const At=!!vt.getValue(listSmoothScrolling);kt=Object.assign(Object.assign({},kt),{smoothScrolling:At})}if(It.affectsConfiguration(mouseWheelScrollSensitivityKey)){const At=vt.getValue(mouseWheelScrollSensitivityKey);kt=Object.assign(Object.assign({},kt),{mouseWheelScrollSensitivity:At})}if(It.affectsConfiguration(fastScrollSensitivityKey)){const At=vt.getValue(fastScrollSensitivityKey);kt=Object.assign(Object.assign({},kt),{fastScrollSensitivity:At})}Object.keys(kt).length>0&&this.updateOptions(kt)})),this.navigator=new ListResourceNavigator(this,Object.assign({configurationService:vt},gt)),this.disposables.add(this.navigator)}updateOptions(nt){super.updateOptions(nt),nt.overrideStyles!==void 0&&this.updateStyles(nt.overrideStyles),nt.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!nt.multipleSelectionSupport)}updateStyles(nt){this.style(nt?getListStyles(nt):defaultListStyles)}};WorkbenchList=__decorate$1D([__param$1B(5,IContextKeyService),__param$1B(6,IListService),__param$1B(7,IConfigurationService),__param$1B(8,IInstantiationService)],WorkbenchList);let WorkbenchPagedList=class extends PagedList{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St){const yt=typeof gt.horizontalScrolling<"u"?gt.horizontalScrolling:!!vt.getValue(horizontalScrollingKey),[wt,Lt]=St.invokeFunction(toWorkbenchListOptions,gt);super(nt,ot,rt,ut,Object.assign(Object.assign({keyboardSupport:!1},wt),{horizontalScrolling:yt})),this.disposables=new DisposableStore,this.disposables.add(Lt),this.contextKeyService=createScopedContextKeyService(pt,this),this.horizontalScrolling=gt.horizontalScrolling,this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(gt.multipleSelectionSupport!==!1),WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(!!gt.selectionNavigation),this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(vt),this.disposables.add(this.contextKeyService),this.disposables.add(mt.register(this)),this.updateStyles(gt.overrideStyles),this.disposables.add(vt.onDidChangeConfiguration(It=>{It.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(vt));let kt={};if(It.affectsConfiguration(horizontalScrollingKey)&&this.horizontalScrolling===void 0){const At=!!vt.getValue(horizontalScrollingKey);kt=Object.assign(Object.assign({},kt),{horizontalScrolling:At})}if(It.affectsConfiguration(scrollByPageKey)){const At=!!vt.getValue(scrollByPageKey);kt=Object.assign(Object.assign({},kt),{scrollByPage:At})}if(It.affectsConfiguration(listSmoothScrolling)){const At=!!vt.getValue(listSmoothScrolling);kt=Object.assign(Object.assign({},kt),{smoothScrolling:At})}if(It.affectsConfiguration(mouseWheelScrollSensitivityKey)){const At=vt.getValue(mouseWheelScrollSensitivityKey);kt=Object.assign(Object.assign({},kt),{mouseWheelScrollSensitivity:At})}if(It.affectsConfiguration(fastScrollSensitivityKey)){const At=vt.getValue(fastScrollSensitivityKey);kt=Object.assign(Object.assign({},kt),{fastScrollSensitivity:At})}Object.keys(kt).length>0&&this.updateOptions(kt)})),this.navigator=new ListResourceNavigator(this,Object.assign({configurationService:vt},gt)),this.disposables.add(this.navigator)}updateOptions(nt){super.updateOptions(nt),nt.overrideStyles!==void 0&&this.updateStyles(nt.overrideStyles),nt.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!nt.multipleSelectionSupport)}updateStyles(nt){this.style(nt?getListStyles(nt):defaultListStyles)}dispose(){this.disposables.dispose(),super.dispose()}};WorkbenchPagedList=__decorate$1D([__param$1B(5,IContextKeyService),__param$1B(6,IListService),__param$1B(7,IConfigurationService),__param$1B(8,IInstantiationService)],WorkbenchPagedList);let WorkbenchTable=class extends Table{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt){const wt=typeof pt.horizontalScrolling<"u"?pt.horizontalScrolling:!!St.getValue(horizontalScrollingKey),[Lt,xt]=yt.invokeFunction(toWorkbenchListOptions,pt);super(nt,ot,rt,ut,gt,Object.assign(Object.assign({keyboardSupport:!1},Lt),{horizontalScrolling:wt})),this.disposables.add(xt),this.contextKeyService=createScopedContextKeyService(mt,this),this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(pt.multipleSelectionSupport!==!1),WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(!!pt.selectionNavigation),this.listHasSelectionOrFocus=WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.listDoubleSelection=WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.listMultiSelection=WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.horizontalScrolling=pt.horizontalScrolling,this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(St),this.disposables.add(this.contextKeyService),this.disposables.add(vt.register(this)),this.updateStyles(pt.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const kt=this.getSelection(),At=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(kt.length>0||At.length>0),this.listMultiSelection.set(kt.length>1),this.listDoubleSelection.set(kt.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const kt=this.getSelection(),At=this.getFocus();this.listHasSelectionOrFocus.set(kt.length>0||At.length>0)})),this.disposables.add(St.onDidChangeConfiguration(kt=>{kt.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(St));let At={};if(kt.affectsConfiguration(horizontalScrollingKey)&&this.horizontalScrolling===void 0){const Tt=!!St.getValue(horizontalScrollingKey);At=Object.assign(Object.assign({},At),{horizontalScrolling:Tt})}if(kt.affectsConfiguration(scrollByPageKey)){const Tt=!!St.getValue(scrollByPageKey);At=Object.assign(Object.assign({},At),{scrollByPage:Tt})}if(kt.affectsConfiguration(listSmoothScrolling)){const Tt=!!St.getValue(listSmoothScrolling);At=Object.assign(Object.assign({},At),{smoothScrolling:Tt})}if(kt.affectsConfiguration(mouseWheelScrollSensitivityKey)){const Tt=St.getValue(mouseWheelScrollSensitivityKey);At=Object.assign(Object.assign({},At),{mouseWheelScrollSensitivity:Tt})}if(kt.affectsConfiguration(fastScrollSensitivityKey)){const Tt=St.getValue(fastScrollSensitivityKey);At=Object.assign(Object.assign({},At),{fastScrollSensitivity:Tt})}Object.keys(At).length>0&&this.updateOptions(At)})),this.navigator=new TableResourceNavigator(this,Object.assign({configurationService:St},pt)),this.disposables.add(this.navigator)}updateOptions(nt){super.updateOptions(nt),nt.overrideStyles!==void 0&&this.updateStyles(nt.overrideStyles),nt.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!nt.multipleSelectionSupport)}updateStyles(nt){this.style(nt?getListStyles(nt):defaultListStyles)}dispose(){this.disposables.dispose(),super.dispose()}};WorkbenchTable=__decorate$1D([__param$1B(6,IContextKeyService),__param$1B(7,IListService),__param$1B(8,IConfigurationService),__param$1B(9,IInstantiationService)],WorkbenchTable);class ResourceNavigator extends Disposable{constructor(nt,ot){var rt;super(),this.widget=nt,this._onDidOpen=this._register(new Emitter$2),this.onDidOpen=this._onDidOpen.event,this._register(Event.filter(this.widget.onDidChangeSelection,ut=>ut.browserEvent instanceof KeyboardEvent)(ut=>this.onSelectionFromKeyboard(ut))),this._register(this.widget.onPointer(ut=>this.onPointer(ut.element,ut.browserEvent))),this._register(this.widget.onMouseDblClick(ut=>this.onMouseDblClick(ut.element,ut.browserEvent))),typeof(ot==null?void 0:ot.openOnSingleClick)!="boolean"&&(ot!=null&&ot.configurationService)?(this.openOnSingleClick=(ot==null?void 0:ot.configurationService.getValue(openModeSettingKey))!=="doubleClick",this._register(ot==null?void 0:ot.configurationService.onDidChangeConfiguration(ut=>{ut.affectsConfiguration(openModeSettingKey)&&(this.openOnSingleClick=(ot==null?void 0:ot.configurationService.getValue(openModeSettingKey))!=="doubleClick")}))):this.openOnSingleClick=(rt=ot==null?void 0:ot.openOnSingleClick)!==null&&rt!==void 0?rt:!0}onSelectionFromKeyboard(nt){if(nt.elements.length!==1)return;const ot=nt.browserEvent,rt=typeof ot.preserveFocus=="boolean"?ot.preserveFocus:!0,ut=typeof ot.pinned=="boolean"?ot.pinned:!rt,gt=!1;this._open(this.getSelectedElement(),rt,ut,gt,nt.browserEvent)}onPointer(nt,ot){if(!this.openOnSingleClick||ot.detail===2)return;const ut=ot.button===1,gt=!0,pt=ut,mt=ot.ctrlKey||ot.metaKey||ot.altKey;this._open(nt,gt,pt,mt,ot)}onMouseDblClick(nt,ot){if(!ot)return;const rt=ot.target;if(rt.classList.contains("monaco-tl-twistie")||rt.classList.contains("monaco-icon-label")&&rt.classList.contains("folder-icon")&&ot.offsetX<16)return;const gt=!1,pt=!0,mt=ot.ctrlKey||ot.metaKey||ot.altKey;this._open(nt,gt,pt,mt,ot)}_open(nt,ot,rt,ut,gt){nt&&this._onDidOpen.fire({editorOptions:{preserveFocus:ot,pinned:rt,revealIfVisible:!0},sideBySide:ut,element:nt,browserEvent:gt})}}class ListResourceNavigator extends ResourceNavigator{constructor(nt,ot){super(nt,ot),this.widget=nt}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class TableResourceNavigator extends ResourceNavigator{constructor(nt,ot){super(nt,ot)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class TreeResourceNavigator extends ResourceNavigator{constructor(nt,ot){super(nt,ot)}getSelectedElement(){var nt;return(nt=this.widget.getSelection()[0])!==null&&nt!==void 0?nt:void 0}}function createKeyboardNavigationEventFilter(ct){let nt=!1;return ot=>{if(ot.toKeyCodeChord().isModifierKey())return!1;if(nt)return nt=!1,!1;const rt=ct.softDispatch(ot,ot.target);return(rt==null?void 0:rt.kind)===1?(nt=!0,!1):(nt=!1,!rt)}}let WorkbenchObjectTree=class extends ObjectTree{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St){const{options:yt,getTypeNavigationMode:wt,disposable:Lt}=pt.invokeFunction(workbenchTreeDataPreamble,gt);super(nt,ot,rt,ut,yt),this.disposables.add(Lt),this.internals=new WorkbenchTreeInternals(this,gt,wt,gt.overrideStyles,mt,vt,St),this.disposables.add(this.internals)}updateOptions(nt){super.updateOptions(nt),this.internals.updateOptions(nt)}};WorkbenchObjectTree=__decorate$1D([__param$1B(5,IInstantiationService),__param$1B(6,IContextKeyService),__param$1B(7,IListService),__param$1B(8,IConfigurationService)],WorkbenchObjectTree);let WorkbenchCompressibleObjectTree=class extends CompressibleObjectTree{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St){const{options:yt,getTypeNavigationMode:wt,disposable:Lt}=pt.invokeFunction(workbenchTreeDataPreamble,gt);super(nt,ot,rt,ut,yt),this.disposables.add(Lt),this.internals=new WorkbenchTreeInternals(this,gt,wt,gt.overrideStyles,mt,vt,St),this.disposables.add(this.internals)}updateOptions(nt={}){super.updateOptions(nt),nt.overrideStyles&&this.internals.updateStyleOverrides(nt.overrideStyles),this.internals.updateOptions(nt)}};WorkbenchCompressibleObjectTree=__decorate$1D([__param$1B(5,IInstantiationService),__param$1B(6,IContextKeyService),__param$1B(7,IListService),__param$1B(8,IConfigurationService)],WorkbenchCompressibleObjectTree);let WorkbenchDataTree=class extends DataTree{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt){const{options:wt,getTypeNavigationMode:Lt,disposable:xt}=mt.invokeFunction(workbenchTreeDataPreamble,pt);super(nt,ot,rt,ut,gt,wt),this.disposables.add(xt),this.internals=new WorkbenchTreeInternals(this,pt,Lt,pt.overrideStyles,vt,St,yt),this.disposables.add(this.internals)}updateOptions(nt={}){super.updateOptions(nt),nt.overrideStyles!==void 0&&this.internals.updateStyleOverrides(nt.overrideStyles),this.internals.updateOptions(nt)}};WorkbenchDataTree=__decorate$1D([__param$1B(6,IInstantiationService),__param$1B(7,IContextKeyService),__param$1B(8,IListService),__param$1B(9,IConfigurationService)],WorkbenchDataTree);let WorkbenchAsyncDataTree=class extends AsyncDataTree{get onDidOpen(){return this.internals.onDidOpen}constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt){const{options:wt,getTypeNavigationMode:Lt,disposable:xt}=mt.invokeFunction(workbenchTreeDataPreamble,pt);super(nt,ot,rt,ut,gt,wt),this.disposables.add(xt),this.internals=new WorkbenchTreeInternals(this,pt,Lt,pt.overrideStyles,vt,St,yt),this.disposables.add(this.internals)}updateOptions(nt={}){super.updateOptions(nt),nt.overrideStyles&&this.internals.updateStyleOverrides(nt.overrideStyles),this.internals.updateOptions(nt)}};WorkbenchAsyncDataTree=__decorate$1D([__param$1B(6,IInstantiationService),__param$1B(7,IContextKeyService),__param$1B(8,IListService),__param$1B(9,IConfigurationService)],WorkbenchAsyncDataTree);let WorkbenchCompressibleAsyncDataTree=class extends CompressibleAsyncDataTree{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt){const{options:Lt,getTypeNavigationMode:xt,disposable:It}=vt.invokeFunction(workbenchTreeDataPreamble,mt);super(nt,ot,rt,ut,gt,pt,Lt),this.disposables.add(It),this.internals=new WorkbenchTreeInternals(this,mt,xt,mt.overrideStyles,St,yt,wt),this.disposables.add(this.internals)}updateOptions(nt){super.updateOptions(nt),this.internals.updateOptions(nt)}};WorkbenchCompressibleAsyncDataTree=__decorate$1D([__param$1B(7,IInstantiationService),__param$1B(8,IContextKeyService),__param$1B(9,IListService),__param$1B(10,IConfigurationService)],WorkbenchCompressibleAsyncDataTree);function getDefaultTreeFindMode(ct){const nt=ct.getValue(defaultFindModeSettingKey);if(nt==="highlight")return TreeFindMode.Highlight;if(nt==="filter")return TreeFindMode.Filter;const ot=ct.getValue(keyboardNavigationSettingKey);if(ot==="simple"||ot==="highlight")return TreeFindMode.Highlight;if(ot==="filter")return TreeFindMode.Filter}function getDefaultTreeFindMatchType(ct){const nt=ct.getValue(defaultFindMatchTypeSettingKey);if(nt==="fuzzy")return TreeFindMatchType.Fuzzy;if(nt==="contiguous")return TreeFindMatchType.Contiguous}function workbenchTreeDataPreamble(ct,nt){var ot;const rt=ct.get(IConfigurationService),ut=ct.get(IContextViewService),gt=ct.get(IContextKeyService),pt=ct.get(IInstantiationService),mt=()=>{const xt=gt.getContextKeyValue(WorkbenchListTypeNavigationModeKey);if(xt==="automatic")return TypeNavigationMode.Automatic;if(xt==="trigger"||gt.getContextKeyValue(WorkbenchListAutomaticKeyboardNavigationLegacyKey)===!1)return TypeNavigationMode.Trigger;const kt=rt.getValue(typeNavigationModeSettingKey);if(kt==="automatic")return TypeNavigationMode.Automatic;if(kt==="trigger")return TypeNavigationMode.Trigger},vt=nt.horizontalScrolling!==void 0?nt.horizontalScrolling:!!rt.getValue(horizontalScrollingKey),[St,yt]=pt.invokeFunction(toWorkbenchListOptions,nt),wt=nt.additionalScrollHeight,Lt=nt.renderIndentGuides!==void 0?nt.renderIndentGuides:rt.getValue(treeRenderIndentGuidesKey);return{getTypeNavigationMode:mt,disposable:yt,options:Object.assign(Object.assign({keyboardSupport:!1},St),{indent:typeof rt.getValue(treeIndentKey)=="number"?rt.getValue(treeIndentKey):void 0,renderIndentGuides:Lt,smoothScrolling:!!rt.getValue(listSmoothScrolling),defaultFindMode:getDefaultTreeFindMode(rt),defaultFindMatchType:getDefaultTreeFindMatchType(rt),horizontalScrolling:vt,scrollByPage:!!rt.getValue(scrollByPageKey),additionalScrollHeight:wt,hideTwistiesOfChildlessElements:nt.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:(ot=nt.expandOnlyOnTwistieClick)!==null&&ot!==void 0?ot:rt.getValue(treeExpandMode)==="doubleClick",contextViewProvider:ut,findWidgetStyles:defaultFindWidgetStyles})}}let WorkbenchTreeInternals=class{get onDidOpen(){return this.navigator.onDidOpen}constructor(nt,ot,rt,ut,gt,pt,mt){var vt;this.tree=nt,this.disposables=[],this.contextKeyService=createScopedContextKeyService(gt,nt),this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(ot.multipleSelectionSupport!==!1),WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(!!ot.selectionNavigation),this.listSupportFindWidget=WorkbenchListSupportsFind.bindTo(this.contextKeyService),this.listSupportFindWidget.set((vt=ot.findWidgetEnabled)!==null&&vt!==void 0?vt:!0),this.hasSelectionOrFocus=WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.hasDoubleSelection=WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.hasMultiSelection=WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.treeElementCanCollapse=WorkbenchTreeElementCanCollapse.bindTo(this.contextKeyService),this.treeElementHasParent=WorkbenchTreeElementHasParent.bindTo(this.contextKeyService),this.treeElementCanExpand=WorkbenchTreeElementCanExpand.bindTo(this.contextKeyService),this.treeElementHasChild=WorkbenchTreeElementHasChild.bindTo(this.contextKeyService),this.treeFindOpen=WorkbenchTreeFindOpen.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(mt),this.updateStyleOverrides(ut);const yt=()=>{const Lt=nt.getFocus()[0];if(!Lt)return;const xt=nt.getNode(Lt);this.treeElementCanCollapse.set(xt.collapsible&&!xt.collapsed),this.treeElementHasParent.set(!!nt.getParentElement(Lt)),this.treeElementCanExpand.set(xt.collapsible&&xt.collapsed),this.treeElementHasChild.set(!!nt.getFirstElementChild(Lt))},wt=new Set;wt.add(WorkbenchListTypeNavigationModeKey),wt.add(WorkbenchListAutomaticKeyboardNavigationLegacyKey),this.disposables.push(this.contextKeyService,pt.register(nt),nt.onDidChangeSelection(()=>{const Lt=nt.getSelection(),xt=nt.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(Lt.length>0||xt.length>0),this.hasMultiSelection.set(Lt.length>1),this.hasDoubleSelection.set(Lt.length===2)})}),nt.onDidChangeFocus(()=>{const Lt=nt.getSelection(),xt=nt.getFocus();this.hasSelectionOrFocus.set(Lt.length>0||xt.length>0),yt()}),nt.onDidChangeCollapseState(yt),nt.onDidChangeModel(yt),nt.onDidChangeFindOpenState(Lt=>this.treeFindOpen.set(Lt)),mt.onDidChangeConfiguration(Lt=>{let xt={};if(Lt.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(mt)),Lt.affectsConfiguration(treeIndentKey)){const It=mt.getValue(treeIndentKey);xt=Object.assign(Object.assign({},xt),{indent:It})}if(Lt.affectsConfiguration(treeRenderIndentGuidesKey)&&ot.renderIndentGuides===void 0){const It=mt.getValue(treeRenderIndentGuidesKey);xt=Object.assign(Object.assign({},xt),{renderIndentGuides:It})}if(Lt.affectsConfiguration(listSmoothScrolling)){const It=!!mt.getValue(listSmoothScrolling);xt=Object.assign(Object.assign({},xt),{smoothScrolling:It})}if(Lt.affectsConfiguration(defaultFindModeSettingKey)||Lt.affectsConfiguration(keyboardNavigationSettingKey)){const It=getDefaultTreeFindMode(mt);xt=Object.assign(Object.assign({},xt),{defaultFindMode:It})}if(Lt.affectsConfiguration(typeNavigationModeSettingKey)||Lt.affectsConfiguration(keyboardNavigationSettingKey)){const It=rt();xt=Object.assign(Object.assign({},xt),{typeNavigationMode:It})}if(Lt.affectsConfiguration(defaultFindMatchTypeSettingKey)){const It=getDefaultTreeFindMatchType(mt);xt=Object.assign(Object.assign({},xt),{defaultFindMatchType:It})}if(Lt.affectsConfiguration(horizontalScrollingKey)&&ot.horizontalScrolling===void 0){const It=!!mt.getValue(horizontalScrollingKey);xt=Object.assign(Object.assign({},xt),{horizontalScrolling:It})}if(Lt.affectsConfiguration(scrollByPageKey)){const It=!!mt.getValue(scrollByPageKey);xt=Object.assign(Object.assign({},xt),{scrollByPage:It})}if(Lt.affectsConfiguration(treeExpandMode)&&ot.expandOnlyOnTwistieClick===void 0&&(xt=Object.assign(Object.assign({},xt),{expandOnlyOnTwistieClick:mt.getValue(treeExpandMode)==="doubleClick"})),Lt.affectsConfiguration(mouseWheelScrollSensitivityKey)){const It=mt.getValue(mouseWheelScrollSensitivityKey);xt=Object.assign(Object.assign({},xt),{mouseWheelScrollSensitivity:It})}if(Lt.affectsConfiguration(fastScrollSensitivityKey)){const It=mt.getValue(fastScrollSensitivityKey);xt=Object.assign(Object.assign({},xt),{fastScrollSensitivity:It})}Object.keys(xt).length>0&&nt.updateOptions(xt)}),this.contextKeyService.onDidChangeContext(Lt=>{Lt.affectsSome(wt)&&nt.updateOptions({typeNavigationMode:rt()})})),this.navigator=new TreeResourceNavigator(nt,Object.assign({configurationService:mt},ot)),this.disposables.push(this.navigator)}updateOptions(nt){nt.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!nt.multipleSelectionSupport)}updateStyleOverrides(nt){this.tree.style(nt?getListStyles(nt):defaultListStyles)}dispose(){this.disposables=dispose(this.disposables)}};WorkbenchTreeInternals=__decorate$1D([__param$1B(4,IContextKeyService),__param$1B(5,IListService),__param$1B(6,IConfigurationService)],WorkbenchTreeInternals);const configurationRegistry=Registry.as(Extensions$8.Configuration);configurationRegistry.registerConfiguration({id:"workbench",order:7,title:localize("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[multiSelectModifierSettingKey]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[localize("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),localize("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:localize({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[openModeSettingKey]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:localize({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[horizontalScrollingKey]:{type:"boolean",default:!1,description:localize("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[scrollByPageKey]:{type:"boolean",default:!1,description:localize("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[treeIndentKey]:{type:"number",default:8,minimum:4,maximum:40,description:localize("tree indent setting","Controls tree indentation in pixels.")},[treeRenderIndentGuidesKey]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:localize("render tree indent guides","Controls whether the tree should render indent guides.")},[listSmoothScrolling]:{type:"boolean",default:!1,description:localize("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[mouseWheelScrollSensitivityKey]:{type:"number",default:1,markdownDescription:localize("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[fastScrollSensitivityKey]:{type:"number",default:5,markdownDescription:localize("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[defaultFindModeSettingKey]:{type:"string",enum:["highlight","filter"],enumDescriptions:[localize("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),localize("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:localize("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[keyboardNavigationSettingKey]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[localize("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),localize("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),localize("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:localize("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:localize("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[defaultFindMatchTypeSettingKey]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[localize("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),localize("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:localize("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[treeExpandMode]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:localize("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[typeNavigationModeSettingKey]:{type:"string",enum:["automatic","trigger"],default:"automatic",description:localize("typeNavigationMode","Controls the how type navigation works in lists and trees in the workbench. When set to 'trigger', type navigation begins once the 'list.triggerTypeNavigation' command is run.")}}});var DefaultQuickAccessFilterValue;(function(ct){ct[ct.PRESERVE=0]="PRESERVE",ct[ct.LAST=1]="LAST"})(DefaultQuickAccessFilterValue||(DefaultQuickAccessFilterValue={}));const Extensions$1={Quickaccess:"workbench.contributions.quickaccess"};class QuickAccessRegistry{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(nt){return nt.prefix.length===0?this.defaultProvider=nt:this.providers.push(nt),this.providers.sort((ot,rt)=>rt.prefix.length-ot.prefix.length),toDisposable(()=>{this.providers.splice(this.providers.indexOf(nt),1),this.defaultProvider===nt&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return coalesce([this.defaultProvider,...this.providers])}getQuickAccessProvider(nt){return nt&&this.providers.find(rt=>nt.startsWith(rt.prefix))||void 0||this.defaultProvider}}Registry.add(Extensions$1.Quickaccess,new QuickAccessRegistry);const NO_KEY_MODS={ctrlCmd:!1,alt:!1};var QuickInputHideReason;(function(ct){ct[ct.Blur=1]="Blur",ct[ct.Gesture=2]="Gesture",ct[ct.Other=3]="Other"})(QuickInputHideReason||(QuickInputHideReason={}));var ItemActivation;(function(ct){ct[ct.NONE=0]="NONE",ct[ct.FIRST=1]="FIRST",ct[ct.SECOND=2]="SECOND",ct[ct.LAST=3]="LAST"})(ItemActivation||(ItemActivation={}));const IQuickInputService=createDecorator("quickInputService");var __decorate$1C=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1A=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let QuickAccessController=class extends Disposable{constructor(nt,ot){super(),this.quickInputService=nt,this.instantiationService=ot,this.registry=Registry.as(Extensions$1.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(nt="",ot){this.doShowOrPick(nt,!1,ot)}doShowOrPick(nt,ot,rt){var ut;const[gt,pt]=this.getOrInstantiateProvider(nt),mt=this.visibleQuickAccess,vt=mt==null?void 0:mt.descriptor;if(mt&&pt&&vt===pt){nt!==pt.prefix&&!(rt!=null&&rt.preserveValue)&&(mt.picker.value=nt),this.adjustValueSelection(mt.picker,pt,rt);return}if(pt&&!(rt!=null&&rt.preserveValue)){let xt;if(mt&&vt&&vt!==pt){const It=mt.value.substr(vt.prefix.length);It&&(xt=`${pt.prefix}${It}`)}if(!xt){const It=gt==null?void 0:gt.defaultFilterValue;It===DefaultQuickAccessFilterValue.LAST?xt=this.lastAcceptedPickerValues.get(pt):typeof It=="string"&&(xt=`${pt.prefix}${It}`)}typeof xt=="string"&&(nt=xt)}const St=new DisposableStore,yt=St.add(this.quickInputService.createQuickPick());yt.value=nt,this.adjustValueSelection(yt,pt,rt),yt.placeholder=pt==null?void 0:pt.placeholder,yt.quickNavigate=rt==null?void 0:rt.quickNavigateConfiguration,yt.hideInput=!!yt.quickNavigate&&!mt,(typeof(rt==null?void 0:rt.itemActivation)=="number"||rt!=null&&rt.quickNavigateConfiguration)&&(yt.itemActivation=(ut=rt==null?void 0:rt.itemActivation)!==null&&ut!==void 0?ut:ItemActivation.SECOND),yt.contextKey=pt==null?void 0:pt.contextKey,yt.filterValue=xt=>xt.substring(pt?pt.prefix.length:0);let wt;ot&&(wt=new DeferredPromise,St.add(once$1(yt.onWillAccept)(xt=>{xt.veto(),yt.hide()}))),St.add(this.registerPickerListeners(yt,gt,pt,nt,rt==null?void 0:rt.providerOptions));const Lt=St.add(new CancellationTokenSource$1);if(gt&&St.add(gt.provide(yt,Lt.token,rt==null?void 0:rt.providerOptions)),once$1(yt.onDidHide)(()=>{yt.selectedItems.length===0&&Lt.cancel(),St.dispose(),wt==null||wt.complete(yt.selectedItems.slice(0))}),yt.show(),ot)return wt==null?void 0:wt.p}adjustValueSelection(nt,ot,rt){var ut;let gt;rt!=null&&rt.preserveValue?gt=[nt.value.length,nt.value.length]:gt=[(ut=ot==null?void 0:ot.prefix.length)!==null&&ut!==void 0?ut:0,nt.value.length],nt.valueSelection=gt}registerPickerListeners(nt,ot,rt,ut,gt){const pt=new DisposableStore,mt=this.visibleQuickAccess={picker:nt,descriptor:rt,value:ut};return pt.add(toDisposable(()=>{mt===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),pt.add(nt.onDidChangeValue(vt=>{const[St]=this.getOrInstantiateProvider(vt);St!==ot?this.show(vt,{preserveValue:!0,providerOptions:gt}):mt.value=vt})),rt&&pt.add(nt.onDidAccept(()=>{this.lastAcceptedPickerValues.set(rt,nt.value)})),pt}getOrInstantiateProvider(nt){const ot=this.registry.getQuickAccessProvider(nt);if(!ot)return[void 0,void 0];let rt=this.mapProviderToDescriptor.get(ot);return rt||(rt=this.instantiationService.createInstance(ot.ctor),this.mapProviderToDescriptor.set(ot,rt)),[rt,ot]}};QuickAccessController=__decorate$1C([__param$1A(0,IQuickInputService),__param$1A(1,IInstantiationService)],QuickAccessController);const button="";Color.white.toString(),Color.white.toString();class Button extends Disposable{get onDidClick(){return this._onDidClick.event}constructor(nt,ot){super(),this._label="",this._onDidClick=this._register(new Emitter$2),this.options=ot,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button");const rt=ot.secondary?ot.buttonSecondaryBackground:ot.buttonBackground,ut=ot.secondary?ot.buttonSecondaryForeground:ot.buttonForeground;this._element.style.color=ut||"",this._element.style.backgroundColor=rt||"",ot.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),nt.appendChild(this._element),this._register(Gesture.addTarget(this._element)),[EventType$1.CLICK,EventType.Tap].forEach(gt=>{this._register(addDisposableListener(this._element,gt,pt=>{if(!this.enabled){EventHelper.stop(pt);return}this._onDidClick.fire(pt)}))}),this._register(addDisposableListener(this._element,EventType$1.KEY_DOWN,gt=>{const pt=new StandardKeyboardEvent(gt);let mt=!1;this.enabled&&(pt.equals(3)||pt.equals(10))?(this._onDidClick.fire(gt),mt=!0):pt.equals(9)&&(this._element.blur(),mt=!0),mt&&EventHelper.stop(pt,!0)})),this._register(addDisposableListener(this._element,EventType$1.MOUSE_OVER,gt=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(addDisposableListener(this._element,EventType$1.MOUSE_OUT,gt=>{this.updateBackground(!1)})),this.focusTracker=this._register(trackFocus(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}getContentElements(nt){const ot=[];for(let rt of renderLabelWithIcons(nt))if(typeof rt=="string"){if(rt=rt.trim(),rt==="")continue;const ut=document.createElement("span");ut.textContent=rt,ot.push(ut)}else ot.push(rt);return ot}updateBackground(nt){let ot;this.options.secondary?ot=nt?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:ot=nt?this.options.buttonHoverBackground:this.options.buttonBackground,ot&&(this._element.style.backgroundColor=ot)}get element(){return this._element}set label(nt){var ot;if(this._label===nt||isMarkdownString(this._label)&&isMarkdownString(nt)&&markdownStringEqual(this._label,nt))return;this._element.classList.add("monaco-text-button");const rt=this.options.supportShortLabel?this._labelElement:this._element;if(isMarkdownString(nt)){const ut=renderMarkdown(nt,{inline:!0});ut.dispose();const gt=(ot=ut.element.querySelector("p"))===null||ot===void 0?void 0:ot.innerHTML;if(gt){const pt=sanitize(gt,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});rt.innerHTML=pt}else reset(rt)}else this.options.supportIcons?reset(rt,...this.getContentElements(nt)):rt.textContent=nt;typeof this.options.title=="string"?this._element.title=this.options.title:this.options.title&&(this._element.title=renderStringAsPlaintext(nt)),this._label=nt}get label(){return this._label}set enabled(nt){nt?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}}const countBadge="";class CountBadge{constructor(nt,ot,rt){this.options=ot,this.styles=rt,this.count=0,this.element=append$1(nt,$$d(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(nt){this.count=nt,this.render()}setTitleFormat(nt){this.titleFormat=nt,this.render()}render(){var nt,ot;this.element.textContent=format(this.countFormat,this.count),this.element.title=format(this.titleFormat,this.count),this.element.style.backgroundColor=(nt=this.styles.badgeBackground)!==null&&nt!==void 0?nt:"",this.element.style.color=(ot=this.styles.badgeForeground)!==null&&ot!==void 0?ot:"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}}const progressbar="",CSS_DONE="done",CSS_ACTIVE="active",CSS_INFINITE="infinite",CSS_INFINITE_LONG_RUNNING="infinite-long-running",CSS_DISCRETE="discrete";class ProgressBar extends Disposable{constructor(nt,ot){super(),this.workedVal=0,this.showDelayedScheduler=this._register(new RunOnceScheduler(()=>show(this.element),0)),this.longRunningScheduler=this._register(new RunOnceScheduler(()=>this.infiniteLongRunning(),ProgressBar.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(nt,ot)}create(nt,ot){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),nt.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=(ot==null?void 0:ot.progressBarBackground)||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(CSS_ACTIVE,CSS_INFINITE,CSS_INFINITE_LONG_RUNNING,CSS_DISCRETE),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel()}stop(){return this.doDone(!1)}doDone(nt){return this.element.classList.add(CSS_DONE),this.element.classList.contains(CSS_INFINITE)?(this.bit.style.opacity="0",nt?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",nt?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(CSS_DISCRETE,CSS_DONE,CSS_INFINITE_LONG_RUNNING),this.element.classList.add(CSS_ACTIVE,CSS_INFINITE),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(CSS_INFINITE_LONG_RUNNING)}getContainer(){return this.element}}ProgressBar.LONG_RUNNING_INFINITE_THRESHOLD=1e4;const quickInput="",$$a=$$d;class QuickInputBox extends Disposable{constructor(nt,ot,rt){super(),this.parent=nt,this.onKeyDown=gt=>addDisposableListener(this.findInput.inputBox.inputElement,EventType$1.KEY_DOWN,pt=>{gt(new StandardKeyboardEvent(pt))}),this.onMouseDown=gt=>addDisposableListener(this.findInput.inputBox.inputElement,EventType$1.MOUSE_DOWN,pt=>{gt(new StandardMouseEvent(pt))}),this.onDidChange=gt=>this.findInput.onDidChange(gt),this.container=append$1(this.parent,$$a(".quick-input-box")),this.findInput=this._register(new FindInput(this.container,void 0,{label:"",inputBoxStyles:ot,toggleStyles:rt}));const ut=this.findInput.inputBox.inputElement;ut.role="combobox",ut.ariaHasPopup="menu",ut.ariaAutoComplete="list",ut.ariaExpanded="true"}get value(){return this.findInput.getValue()}set value(nt){this.findInput.setValue(nt)}select(nt=null){this.findInput.inputBox.select(nt)}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(nt){this.findInput.inputBox.setPlaceHolder(nt)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(nt){this.findInput.inputBox.inputElement.type=nt?"password":"text"}set enabled(nt){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!nt)}set toggles(nt){this.findInput.setAdditionalToggles(nt)}setAttribute(nt,ot){this.findInput.inputBox.inputElement.setAttribute(nt,ot)}showDecoration(nt){nt===Severity$2.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:nt===Severity$2.Info?1:nt===Severity$2.Warning?2:3,content:""})}stylesForType(nt){return this.findInput.inputBox.stylesForType(nt===Severity$2.Info?1:nt===Severity$2.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}const iconlabel="";class HighlightedLabel{constructor(nt,ot){var rt;this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.supportIcons=(rt=ot==null?void 0:ot.supportIcons)!==null&&rt!==void 0?rt:!1,this.domNode=append$1(nt,$$d("span.monaco-highlighted-label"))}get element(){return this.domNode}set(nt,ot=[],rt="",ut){nt||(nt=""),ut&&(nt=HighlightedLabel.escapeNewLines(nt,ot)),!(this.didEverRender&&this.text===nt&&this.title===rt&&equals$1(this.highlights,ot))&&(this.text=nt,this.title=rt,this.highlights=ot,this.render())}render(){const nt=[];let ot=0;for(const rt of this.highlights){if(rt.end===rt.start)continue;if(ot<rt.start){const pt=this.text.substring(ot,rt.start);this.supportIcons?nt.push(...renderLabelWithIcons(pt)):nt.push(pt),ot=rt.start}const ut=this.text.substring(ot,rt.end),gt=$$d("span.highlight",void 0,...this.supportIcons?renderLabelWithIcons(ut):[ut]);rt.extraClasses&&gt.classList.add(...rt.extraClasses),nt.push(gt),ot=rt.end}if(ot<this.text.length){const rt=this.text.substring(ot);this.supportIcons?nt.push(...renderLabelWithIcons(rt)):nt.push(rt)}reset(this.domNode,...nt),this.title?this.domNode.title=this.title:this.domNode.removeAttribute("title"),this.didEverRender=!0}static escapeNewLines(nt,ot){let rt=0,ut=0;return nt.replace(/\r\n|\r|\n/g,(gt,pt)=>{ut=gt===`\r
`?-1:0,pt+=rt;for(const mt of ot)mt.end<=pt||(mt.start>=pt&&(mt.start+=ut),mt.end>=pt&&(mt.end+=ut));return rt+=ut,""})}}class FastLabelNode{constructor(nt){this._element=nt}get element(){return this._element}set textContent(nt){this.disposed||nt===this._textContent||(this._textContent=nt,this._element.textContent=nt)}set className(nt){this.disposed||nt===this._className||(this._className=nt,this._element.className=nt)}set empty(nt){this.disposed||nt===this._empty||(this._empty=nt,this._element.style.marginLeft=nt?"0":"")}dispose(){this.disposed=!0}}class IconLabel extends Disposable{constructor(nt,ot){super(),this.customHovers=new Map,this.creationOptions=ot,this.domNode=this._register(new FastLabelNode(append$1(nt,$$d(".monaco-icon-label")))),this.labelContainer=append$1(this.domNode.element,$$d(".monaco-icon-label-container"));const rt=append$1(this.labelContainer,$$d("span.monaco-icon-name-container"));ot!=null&&ot.supportHighlights||ot!=null&&ot.supportIcons?this.nameNode=new LabelWithHighlights(rt,!!ot.supportIcons):this.nameNode=new Label(rt),this.hoverDelegate=ot==null?void 0:ot.hoverDelegate}get element(){return this.domNode.element}setLabel(nt,ot,rt){const ut=["monaco-icon-label"],gt=["monaco-icon-label-container"];if(rt&&(rt.extraClasses&&ut.push(...rt.extraClasses),rt.italic&&ut.push("italic"),rt.strikethrough&&ut.push("strikethrough"),rt.disabledCommand&&gt.push("disabled")),this.domNode.className=ut.join(" "),this.labelContainer.className=gt.join(" "),this.setupHover(rt!=null&&rt.descriptionTitle?this.labelContainer:this.element,rt==null?void 0:rt.title),this.nameNode.setLabel(nt,rt),ot||this.descriptionNode){const pt=this.getOrCreateDescriptionNode();pt instanceof HighlightedLabel?(pt.set(ot||"",rt?rt.descriptionMatches:void 0,void 0,rt==null?void 0:rt.labelEscapeNewLines),this.setupHover(pt.element,rt==null?void 0:rt.descriptionTitle)):(pt.textContent=ot&&(rt!=null&&rt.labelEscapeNewLines)?HighlightedLabel.escapeNewLines(ot,[]):ot||"",this.setupHover(pt.element,(rt==null?void 0:rt.descriptionTitle)||""),pt.empty=!ot)}}setupHover(nt,ot){const rt=this.customHovers.get(nt);if(rt&&(rt.dispose(),this.customHovers.delete(nt)),!ot){nt.removeAttribute("title");return}if(!this.hoverDelegate)setupNativeHover(nt,ot);else{const ut=setupCustomHover(this.hoverDelegate,nt,ot);ut&&this.customHovers.set(nt,ut)}}dispose(){super.dispose();for(const nt of this.customHovers.values())nt.dispose();this.customHovers.clear()}getOrCreateDescriptionNode(){var nt;if(!this.descriptionNode){const ot=this._register(new FastLabelNode(append$1(this.labelContainer,$$d("span.monaco-icon-description-container"))));!((nt=this.creationOptions)===null||nt===void 0)&&nt.supportDescriptionHighlights?this.descriptionNode=new HighlightedLabel(append$1(ot.element,$$d("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons}):this.descriptionNode=this._register(new FastLabelNode(append$1(ot.element,$$d("span.label-description"))))}return this.descriptionNode}}class Label{constructor(nt){this.container=nt,this.label=void 0,this.singleLabel=void 0}setLabel(nt,ot){if(!(this.label===nt&&equals$1(this.options,ot)))if(this.label=nt,this.options=ot,typeof nt=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=append$1(this.container,$$d("a.label-name",{id:ot==null?void 0:ot.domId}))),this.singleLabel.textContent=nt;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let rt=0;rt<nt.length;rt++){const ut=nt[rt],gt=(ot==null?void 0:ot.domId)&&`${ot==null?void 0:ot.domId}_${rt}`;append$1(this.container,$$d("a.label-name",{id:gt,"data-icon-label-count":nt.length,"data-icon-label-index":rt,role:"treeitem"},ut)),rt<nt.length-1&&append$1(this.container,$$d("span.label-separator",void 0,(ot==null?void 0:ot.separator)||"/"))}}}}function splitMatches(ct,nt,ot){if(!ot)return;let rt=0;return ct.map(ut=>{const gt={start:rt,end:rt+ut.length},pt=ot.map(mt=>Range$1.intersect(gt,mt)).filter(mt=>!Range$1.isEmpty(mt)).map(({start:mt,end:vt})=>({start:mt-rt,end:vt-rt}));return rt=gt.end+nt.length,pt})}class LabelWithHighlights{constructor(nt,ot){this.container=nt,this.supportIcons=ot,this.label=void 0,this.singleLabel=void 0}setLabel(nt,ot){if(!(this.label===nt&&equals$1(this.options,ot)))if(this.label=nt,this.options=ot,typeof nt=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=new HighlightedLabel(append$1(this.container,$$d("a.label-name",{id:ot==null?void 0:ot.domId})),{supportIcons:this.supportIcons})),this.singleLabel.set(nt,ot==null?void 0:ot.matches,void 0,ot==null?void 0:ot.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const rt=(ot==null?void 0:ot.separator)||"/",ut=splitMatches(nt,rt,ot==null?void 0:ot.matches);for(let gt=0;gt<nt.length;gt++){const pt=nt[gt],mt=ut?ut[gt]:void 0,vt=(ot==null?void 0:ot.domId)&&`${ot==null?void 0:ot.domId}_${gt}`,St=$$d("a.label-name",{id:vt,"data-icon-label-count":nt.length,"data-icon-label-index":gt,role:"treeitem"});new HighlightedLabel(append$1(this.container,St),{supportIcons:this.supportIcons}).set(pt,mt,void 0,ot==null?void 0:ot.labelEscapeNewLines),gt<nt.length-1&&append$1(St,$$d("span.label-separator",void 0,rt))}}}}const keybindingLabel="",$$9=$$d,unthemedKeybindingLabelOptions={keybindingLabelBackground:void 0,keybindingLabelForeground:void 0,keybindingLabelBorder:void 0,keybindingLabelBottomBorder:void 0,keybindingLabelShadow:void 0};class KeybindingLabel{constructor(nt,ot,rt){this.os=ot,this.keyElements=new Set,this.options=rt||Object.create(null);const ut=this.options.keybindingLabelForeground;this.domNode=append$1(nt,$$9(".monaco-keybinding")),ut&&(this.domNode.style.color=ut),this.didEverRender=!1,nt.appendChild(this.domNode)}get element(){return this.domNode}set(nt,ot){this.didEverRender&&this.keybinding===nt&&KeybindingLabel.areSame(this.matches,ot)||(this.keybinding=nt,this.matches=ot,this.render())}render(){var nt;if(this.clear(),this.keybinding){const ot=this.keybinding.getChords();ot[0]&&this.renderChord(this.domNode,ot[0],this.matches?this.matches.firstPart:null);for(let ut=1;ut<ot.length;ut++)append$1(this.domNode,$$9("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,ot[ut],this.matches?this.matches.chordPart:null);const rt=(nt=this.options.disableTitle)!==null&&nt!==void 0&&nt?void 0:this.keybinding.getAriaLabel()||void 0;rt!==void 0?this.domNode.title=rt:this.domNode.removeAttribute("title")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){clearNode(this.domNode),this.keyElements.clear()}renderChord(nt,ot,rt){const ut=UILabelProvider.modifierLabels[this.os];ot.ctrlKey&&this.renderKey(nt,ut.ctrlKey,!!(rt!=null&&rt.ctrlKey),ut.separator),ot.shiftKey&&this.renderKey(nt,ut.shiftKey,!!(rt!=null&&rt.shiftKey),ut.separator),ot.altKey&&this.renderKey(nt,ut.altKey,!!(rt!=null&&rt.altKey),ut.separator),ot.metaKey&&this.renderKey(nt,ut.metaKey,!!(rt!=null&&rt.metaKey),ut.separator);const gt=ot.keyLabel;gt&&this.renderKey(nt,gt,!!(rt!=null&&rt.keyCode),"")}renderKey(nt,ot,rt,ut){append$1(nt,this.createKeyElement(ot,rt?".highlight":"")),ut&&append$1(nt,$$9("span.monaco-keybinding-key-separator",void 0,ut))}renderUnbound(nt){append$1(nt,this.createKeyElement(localize("unbound","Unbound")))}createKeyElement(nt,ot=""){const rt=$$9("span.monaco-keybinding-key"+ot,void 0,nt);return this.keyElements.add(rt),this.options.keybindingLabelBackground&&(rt.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(rt.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(rt.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(rt.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),rt}static areSame(nt,ot){return nt===ot||!nt&&!ot?!0:!!nt&&!!ot&&equals$1(nt.firstPart,ot.firstPart)&&equals$1(nt.chordPart,ot.chordPart)}}const intlFileNameCollatorBaseNumeric=new Lazy(()=>{const ct=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:ct,collatorIsNumeric:ct.resolvedOptions().numeric}});function compareFileNames(ct,nt,ot=!1){const rt=ct||"",ut=nt||"",gt=intlFileNameCollatorBaseNumeric.value.collator.compare(rt,ut);return intlFileNameCollatorBaseNumeric.value.collatorIsNumeric&&gt===0&&rt!==ut?rt<ut?-1:1:gt}function compareAnything(ct,nt,ot){const rt=ct.toLowerCase(),ut=nt.toLowerCase(),gt=compareByPrefix(ct,nt,ot);if(gt)return gt;const pt=rt.endsWith(ot),mt=ut.endsWith(ot);if(pt!==mt)return pt?-1:1;const vt=compareFileNames(rt,ut);return vt!==0?vt:rt.localeCompare(ut)}function compareByPrefix(ct,nt,ot){const rt=ct.toLowerCase(),ut=nt.toLowerCase(),gt=rt.startsWith(ot),pt=ut.startsWith(ot);if(gt!==pt)return gt?-1:1;if(gt&&pt){if(rt.length<ut.length)return-1;if(rt.length>ut.length)return 1}return 0}var __decorate$1B=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt};class LinkedText{constructor(nt){this.nodes=nt}toString(){return this.nodes.map(nt=>typeof nt=="string"?nt:nt.label).join("")}}__decorate$1B([memoize],LinkedText.prototype,"toString",null);const LINK_REGEX=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function parseLinkedText(ct){const nt=[];let ot=0,rt;for(;rt=LINK_REGEX.exec(ct);){rt.index-ot>0&&nt.push(ct.substring(ot,rt.index));const[,ut,gt,,pt]=rt;pt?nt.push({label:ut,href:gt,title:pt}):nt.push({label:ut,href:gt}),ot=rt.index+rt[0].length}return ot<ct.length&&nt.push(ct.substring(ot)),new LinkedText(nt)}const iconPathToClass={},iconClassGenerator=new IdGenerator("quick-input-button-icon-");function getIconClass(ct){if(!ct)return;let nt;const ot=ct.dark.toString();return iconPathToClass[ot]?nt=iconPathToClass[ot]:(nt=iconClassGenerator.nextId(),createCSSRule(`.${nt}, .hc-light .${nt}`,`background-image: ${asCSSUrl(ct.light||ct.dark)}`),createCSSRule(`.vs-dark .${nt}, .hc-black .${nt}`,`background-image: ${asCSSUrl(ct.dark)}`),iconPathToClass[ot]=nt),nt}function renderQuickInputDescription(ct,nt,ot){reset(nt);const rt=parseLinkedText(ct);let ut=0;for(const gt of rt.nodes)if(typeof gt=="string")nt.append(...renderLabelWithIcons(gt));else{let pt=gt.title;!pt&&gt.href.startsWith("command:")?pt=localize("executeCommand","Click to execute command '{0}'",gt.href.substring(8)):pt||(pt=gt.href);const mt=$$d("a",{href:gt.href,title:pt,tabIndex:ut++},gt.label);mt.style.textDecoration="underline";const vt=xt=>{isEventLike(xt)&&EventHelper.stop(xt,!0),ot.callback(gt.href)},St=ot.disposables.add(new DomEmitter(mt,EventType$1.CLICK)).event,yt=ot.disposables.add(new DomEmitter(mt,EventType$1.KEY_DOWN)).event,wt=ot.disposables.add(Event.chain(yt)).filter(xt=>{const It=new StandardKeyboardEvent(xt);return It.equals(10)||It.equals(3)}).event;ot.disposables.add(Gesture.addTarget(mt));const Lt=ot.disposables.add(new DomEmitter(mt,EventType.Tap)).event;Event.any(St,Lt,wt)(vt,null,ot.disposables),nt.appendChild(mt)}}var __decorate$1A=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__awaiter$19=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const $$8=$$d;class ListElement{get checked(){return!!this._checked}set checked(nt){nt!==this._checked&&(this._checked=nt,this._onChecked.fire(nt))}constructor(nt){this.hidden=!1,this._onChecked=new Emitter$2,this.onChecked=this._onChecked.event,Object.assign(this,nt)}dispose(){this._onChecked.dispose()}}class ListElementRenderer{get templateId(){return ListElementRenderer.ID}renderTemplate(nt){const ot=Object.create(null);ot.toDisposeElement=[],ot.toDisposeTemplate=[],ot.entry=append$1(nt,$$8(".quick-input-list-entry"));const rt=append$1(ot.entry,$$8("label.quick-input-list-label"));ot.toDisposeTemplate.push(addStandardDisposableListener(rt,EventType$1.CLICK,St=>{ot.checkbox.offsetParent||St.preventDefault()})),ot.checkbox=append$1(rt,$$8("input.quick-input-list-checkbox")),ot.checkbox.type="checkbox",ot.toDisposeTemplate.push(addStandardDisposableListener(ot.checkbox,EventType$1.CHANGE,St=>{ot.element.checked=ot.checkbox.checked}));const ut=append$1(rt,$$8(".quick-input-list-rows")),gt=append$1(ut,$$8(".quick-input-list-row")),pt=append$1(ut,$$8(".quick-input-list-row"));ot.label=new IconLabel(gt,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0});const mt=append$1(gt,$$8(".quick-input-list-entry-keybinding"));ot.keybinding=new KeybindingLabel(mt,OS);const vt=append$1(pt,$$8(".quick-input-list-label-meta"));return ot.detail=new IconLabel(vt,{supportHighlights:!0,supportIcons:!0}),ot.separator=append$1(ot.entry,$$8(".quick-input-list-separator")),ot.actionBar=new ActionBar(ot.entry),ot.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),ot.toDisposeTemplate.push(ot.actionBar),ot}renderElement(nt,ot,rt){rt.element=nt,nt.element=withNullAsUndefined(rt.entry);const ut=nt.item?nt.item:nt.separator;rt.checkbox.checked=nt.checked,rt.toDisposeElement.push(nt.onChecked(yt=>rt.checkbox.checked=yt));const{labelHighlights:gt,descriptionHighlights:pt,detailHighlights:mt}=nt,vt=Object.create(null);vt.matches=gt||[],vt.descriptionTitle=nt.saneDescription,vt.descriptionMatches=pt||[],ut.type!=="separator"?(vt.extraClasses=ut.iconClasses,vt.italic=ut.italic,vt.strikethrough=ut.strikethrough,rt.entry.classList.remove("quick-input-list-separator-as-item")):rt.entry.classList.add("quick-input-list-separator-as-item"),rt.label.setLabel(nt.saneLabel,nt.saneDescription,vt),rt.keybinding.set(ut.type==="separator"?void 0:ut.keybinding),nt.saneDetail&&rt.detail.setLabel(nt.saneDetail,void 0,{matches:mt,title:nt.saneDetail}),nt.item&&nt.separator&&nt.separator.label?(rt.separator.textContent=nt.separator.label,rt.separator.style.display=""):rt.separator.style.display="none",rt.entry.classList.toggle("quick-input-list-separator-border",!!nt.separator);const St=ut.buttons;St&&St.length?(rt.actionBar.push(St.map((yt,wt)=>{let Lt=yt.iconClass||(yt.iconPath?getIconClass(yt.iconPath):void 0);return yt.alwaysVisible&&(Lt=Lt?`${Lt} always-visible`:"always-visible"),{id:`id-${wt}`,class:Lt,enabled:!0,label:"",tooltip:yt.tooltip||"",run:()=>{ut.type!=="separator"?nt.fireButtonTriggered({button:yt,item:ut}):nt.fireSeparatorButtonTriggered({button:yt,separator:ut})}}}),{icon:!0,label:!1}),rt.entry.classList.add("has-actions")):rt.entry.classList.remove("has-actions")}disposeElement(nt,ot,rt){rt.toDisposeElement=dispose(rt.toDisposeElement),rt.actionBar.clear()}disposeTemplate(nt){nt.toDisposeElement=dispose(nt.toDisposeElement),nt.toDisposeTemplate=dispose(nt.toDisposeTemplate)}}ListElementRenderer.ID="listelement";class ListElementDelegate{getHeight(nt){return nt.item?nt.saneDetail?44:22:24}getTemplateId(nt){return ListElementRenderer.ID}}var QuickInputListFocus;(function(ct){ct[ct.First=1]="First",ct[ct.Second=2]="Second",ct[ct.Last=3]="Last",ct[ct.Next=4]="Next",ct[ct.Previous=5]="Previous",ct[ct.NextPage=6]="NextPage",ct[ct.PreviousPage=7]="PreviousPage"})(QuickInputListFocus||(QuickInputListFocus={}));class QuickInputList{constructor(nt,ot,rt){this.parent=nt,this.options=rt,this.inputElements=[],this.elements=[],this.elementsToIndexes=new Map,this.matchOnDescription=!1,this.matchOnDetail=!1,this.matchOnLabel=!0,this.matchOnLabelMode="fuzzy",this.matchOnMeta=!0,this.sortByLabel=!0,this._onChangedAllVisibleChecked=new Emitter$2,this.onChangedAllVisibleChecked=this._onChangedAllVisibleChecked.event,this._onChangedCheckedCount=new Emitter$2,this.onChangedCheckedCount=this._onChangedCheckedCount.event,this._onChangedVisibleCount=new Emitter$2,this.onChangedVisibleCount=this._onChangedVisibleCount.event,this._onChangedCheckedElements=new Emitter$2,this.onChangedCheckedElements=this._onChangedCheckedElements.event,this._onButtonTriggered=new Emitter$2,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new Emitter$2,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._onKeyDown=new Emitter$2,this.onKeyDown=this._onKeyDown.event,this._onLeave=new Emitter$2,this.onLeave=this._onLeave.event,this._fireCheckedEvents=!0,this.elementDisposables=[],this.disposables=[],this.id=ot,this.container=append$1(this.parent,$$8(".quick-input-list"));const ut=new ListElementDelegate,gt=new QuickInputAccessibilityProvider;this.list=rt.createList("QuickInput",this.container,ut,[new ListElementRenderer],{identityProvider:{getId:mt=>mt.saneLabel},setRowLineHeight:!1,multipleSelectionSupport:!1,horizontalScrolling:!1,accessibilityProvider:gt}),this.list.getHTMLElement().id=ot,this.disposables.push(this.list),this.disposables.push(this.list.onKeyDown(mt=>{const vt=new StandardKeyboardEvent(mt);switch(vt.keyCode){case 10:this.toggleCheckbox();break;case 31:(isMacintosh?mt.metaKey:mt.ctrlKey)&&this.list.setFocus(range(this.list.length));break;case 16:{const St=this.list.getFocus();St.length===1&&St[0]===0&&this._onLeave.fire();break}case 18:{const St=this.list.getFocus();St.length===1&&St[0]===this.list.length-1&&this._onLeave.fire();break}}this._onKeyDown.fire(vt)})),this.disposables.push(this.list.onMouseDown(mt=>{mt.browserEvent.button!==2&&mt.browserEvent.preventDefault()})),this.disposables.push(addDisposableListener(this.container,EventType$1.CLICK,mt=>{(mt.x||mt.y)&&this._onLeave.fire()})),this.disposables.push(this.list.onMouseMiddleClick(mt=>{this._onLeave.fire()})),this.disposables.push(this.list.onContextMenu(mt=>{typeof mt.index=="number"&&(mt.browserEvent.preventDefault(),this.list.setSelection([mt.index]))}));const pt=new ThrottledDelayer(rt.hoverDelegate.delay);this.disposables.push(this.list.onMouseOver(mt=>__awaiter$19(this,void 0,void 0,function*(){var vt;if(mt.browserEvent.target instanceof HTMLAnchorElement){pt.cancel();return}if(!(!(mt.browserEvent.relatedTarget instanceof HTMLAnchorElement)&&isAncestor$1(mt.browserEvent.relatedTarget,(vt=mt.element)===null||vt===void 0?void 0:vt.element)))try{yield pt.trigger(()=>__awaiter$19(this,void 0,void 0,function*(){mt.element&&this.showHover(mt.element)}))}catch(St){if(!isCancellationError(St))throw St}}))),this.disposables.push(this.list.onMouseOut(mt=>{var vt;isAncestor$1(mt.browserEvent.relatedTarget,(vt=mt.element)===null||vt===void 0?void 0:vt.element)||pt.cancel()})),this.disposables.push(this._onChangedAllVisibleChecked,this._onChangedCheckedCount,this._onChangedVisibleCount,this._onChangedCheckedElements,this._onButtonTriggered,this._onSeparatorButtonTriggered,this._onLeave,this._onKeyDown,pt)}get onDidChangeFocus(){return Event.map(this.list.onDidChangeFocus,nt=>nt.elements.map(ot=>ot.item))}get onDidChangeSelection(){return Event.map(this.list.onDidChangeSelection,nt=>({items:nt.elements.map(ot=>ot.item),event:nt.browserEvent}))}get scrollTop(){return this.list.scrollTop}set scrollTop(nt){this.list.scrollTop=nt}get ariaLabel(){return this.list.getHTMLElement().ariaLabel}set ariaLabel(nt){this.list.getHTMLElement().ariaLabel=nt}getAllVisibleChecked(){return this.allVisibleChecked(this.elements,!1)}allVisibleChecked(nt,ot=!0){for(let rt=0,ut=nt.length;rt<ut;rt++){const gt=nt[rt];if(!gt.hidden)if(gt.checked)ot=!0;else return!1}return ot}getCheckedCount(){let nt=0;const ot=this.elements;for(let rt=0,ut=ot.length;rt<ut;rt++)ot[rt].checked&&nt++;return nt}getVisibleCount(){let nt=0;const ot=this.elements;for(let rt=0,ut=ot.length;rt<ut;rt++)ot[rt].hidden||nt++;return nt}setAllVisibleChecked(nt){try{this._fireCheckedEvents=!1,this.elements.forEach(ot=>{ot.hidden||(ot.checked=nt)})}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}setElements(nt){this.elementDisposables=dispose(this.elementDisposables);const ot=ut=>this.fireButtonTriggered(ut),rt=ut=>this.fireSeparatorButtonTriggered(ut);this.inputElements=nt,this.elements=nt.reduce((ut,gt,pt)=>{var mt,vt,St;const yt=pt&&nt[pt-1],wt=gt.label?gt.label.replace(/\r?\n/g," "):"",Lt=parseLabelWithIcons(wt).text.trim();let xt,It,kt,At,Tt,Rt,Nt;gt.type!=="separator"&&(xt=gt.meta&&gt.meta.replace(/\r?\n/g," "),It=gt.description&&gt.description.replace(/\r?\n/g," "),kt=gt.detail&&gt.detail.replace(/\r?\n/g," "),At=(mt=gt.highlights)===null||mt===void 0?void 0:mt.label,Tt=(vt=gt.highlights)===null||vt===void 0?void 0:vt.description,Rt=(St=gt.highlights)===null||St===void 0?void 0:St.detail,Nt=gt.tooltip);const Pt=gt.ariaLabel||[wt,It,kt].map(Ut=>getCodiconAriaLabel(Ut)).filter(Ut=>!!Ut).join(", "),Ft=this.parent.classList.contains("show-checkboxes");let Kt;if(gt.type==="separator"){if(!gt.buttons)return ut;Kt=gt}else yt&&yt.type==="separator"&&!yt.buttons&&(Kt=yt);const Bt=new ListElement({hasCheckbox:Ft,index:pt,item:gt.type!=="separator"?gt:void 0,saneLabel:wt,saneSortLabel:Lt,saneMeta:xt,saneAriaLabel:Pt,saneDescription:It,saneDetail:kt,saneTooltip:Nt,labelHighlights:At,descriptionHighlights:Tt,detailHighlights:Rt,checked:!1,separator:Kt,fireButtonTriggered:ot,fireSeparatorButtonTriggered:rt});return this.elementDisposables.push(Bt),this.elementDisposables.push(Bt.onChecked(()=>this.fireCheckedEvents())),ut.push(Bt),ut},[]),this.elementsToIndexes=this.elements.reduce((ut,gt,pt)=>{var mt;return ut.set((mt=gt.item)!==null&&mt!==void 0?mt:gt.separator,pt),ut},new Map),this.list.splice(0,this.list.length),this.list.splice(0,this.list.length,this.elements),this._onChangedVisibleCount.fire(this.elements.length)}getFocusedElements(){return this.list.getFocusedElements().map(nt=>nt.item)}setFocusedElements(nt){if(this.list.setFocus(nt.filter(ot=>this.elementsToIndexes.has(ot)).map(ot=>this.elementsToIndexes.get(ot))),nt.length>0){const ot=this.list.getFocus()[0];typeof ot=="number"&&this.list.reveal(ot)}}getActiveDescendant(){return this.list.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(nt){this.list.setSelection(nt.filter(ot=>this.elementsToIndexes.has(ot)).map(ot=>this.elementsToIndexes.get(ot)))}getCheckedElements(){return this.elements.filter(nt=>nt.checked).map(nt=>nt.item).filter(nt=>!!nt)}setCheckedElements(nt){try{this._fireCheckedEvents=!1;const ot=new Set;for(const rt of nt)ot.add(rt);for(const rt of this.elements)rt.checked=ot.has(rt.item)}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}set enabled(nt){this.list.getHTMLElement().style.pointerEvents=nt?"":"none"}focus(nt){if(!this.list.length)return;switch(nt===QuickInputListFocus.Second&&this.list.length<2&&(nt=QuickInputListFocus.First),nt){case QuickInputListFocus.First:this.list.scrollTop=0,this.list.focusFirst(void 0,rt=>!!rt.item);break;case QuickInputListFocus.Second:this.list.scrollTop=0,this.list.focusNth(1,void 0,rt=>!!rt.item);break;case QuickInputListFocus.Last:this.list.scrollTop=this.list.scrollHeight,this.list.focusLast(void 0,rt=>!!rt.item);break;case QuickInputListFocus.Next:{this.list.focusNext(void 0,!0,void 0,ut=>!!ut.item);const rt=this.list.getFocus()[0];rt!==0&&!this.elements[rt-1].item&&this.list.firstVisibleIndex>rt-1&&this.list.reveal(rt-1);break}case QuickInputListFocus.Previous:{this.list.focusPrevious(void 0,!0,void 0,ut=>!!ut.item);const rt=this.list.getFocus()[0];rt!==0&&!this.elements[rt-1].item&&this.list.firstVisibleIndex>rt-1&&this.list.reveal(rt-1);break}case QuickInputListFocus.NextPage:this.list.focusNextPage(void 0,rt=>!!rt.item);break;case QuickInputListFocus.PreviousPage:this.list.focusPreviousPage(void 0,rt=>!!rt.item);break}const ot=this.list.getFocus()[0];typeof ot=="number"&&this.list.reveal(ot)}clearFocus(){this.list.setFocus([])}domFocus(){this.list.domFocus()}showHover(nt){var ot,rt,ut;this._lastHover&&!this._lastHover.isDisposed&&((rt=(ot=this.options.hoverDelegate).onDidHideHover)===null||rt===void 0||rt.call(ot),(ut=this._lastHover)===null||ut===void 0||ut.dispose()),!(!nt.element||!nt.saneTooltip)&&(this._lastHover=this.options.hoverDelegate.showHover({content:nt.saneTooltip,target:nt.element,linkHandler:gt=>{this.options.linkOpenerDelegate(gt)},showPointer:!0,container:this.container,hoverPosition:1},!1))}layout(nt){this.list.getHTMLElement().style.maxHeight=nt?`${Math.floor(nt/44)*44+6}px`:"",this.list.layout()}filter(nt){if(!(this.sortByLabel||this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))return this.list.layout(),!1;const ot=nt;if(nt=nt.trim(),!nt||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this.elements.forEach(ut=>{ut.labelHighlights=void 0,ut.descriptionHighlights=void 0,ut.detailHighlights=void 0,ut.hidden=!1;const gt=ut.index&&this.inputElements[ut.index-1];ut.item&&(ut.separator=gt&&gt.type==="separator"&&!gt.buttons?gt:void 0)});else{let ut;this.elements.forEach(gt=>{let pt;this.matchOnLabelMode==="fuzzy"?pt=this.matchOnLabel?withNullAsUndefined(matchesFuzzyIconAware(nt,parseLabelWithIcons(gt.saneLabel))):void 0:pt=this.matchOnLabel?withNullAsUndefined(matchesContiguousIconAware(ot,parseLabelWithIcons(gt.saneLabel))):void 0;const mt=this.matchOnDescription?withNullAsUndefined(matchesFuzzyIconAware(nt,parseLabelWithIcons(gt.saneDescription||""))):void 0,vt=this.matchOnDetail?withNullAsUndefined(matchesFuzzyIconAware(nt,parseLabelWithIcons(gt.saneDetail||""))):void 0,St=this.matchOnMeta?withNullAsUndefined(matchesFuzzyIconAware(nt,parseLabelWithIcons(gt.saneMeta||""))):void 0;if(pt||mt||vt||St?(gt.labelHighlights=pt,gt.descriptionHighlights=mt,gt.detailHighlights=vt,gt.hidden=!1):(gt.labelHighlights=void 0,gt.descriptionHighlights=void 0,gt.detailHighlights=void 0,gt.hidden=gt.item?!gt.item.alwaysShow:!0),!this.sortByLabel){const yt=gt.index&&this.inputElements[gt.index-1];ut=yt&&yt.type==="separator"?yt:ut,ut&&!gt.hidden&&(gt.separator=ut,ut=void 0)}})}const rt=this.elements.filter(ut=>!ut.hidden);if(this.sortByLabel&&nt){const ut=nt.toLowerCase();rt.sort((gt,pt)=>compareEntries(gt,pt,ut))}return this.elementsToIndexes=rt.reduce((ut,gt,pt)=>{var mt;return ut.set((mt=gt.item)!==null&&mt!==void 0?mt:gt.separator,pt),ut},new Map),this.list.splice(0,this.list.length,rt),this.list.setFocus([]),this.list.layout(),this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedVisibleCount.fire(rt.length),!0}toggleCheckbox(){try{this._fireCheckedEvents=!1;const nt=this.list.getFocusedElements(),ot=this.allVisibleChecked(nt);for(const rt of nt)rt.checked=!ot}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}display(nt){this.container.style.display=nt?"":"none"}isDisplayed(){return this.container.style.display!=="none"}dispose(){this.elementDisposables=dispose(this.elementDisposables),this.disposables=dispose(this.disposables)}fireCheckedEvents(){this._fireCheckedEvents&&(this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedCheckedCount.fire(this.getCheckedCount()),this._onChangedCheckedElements.fire(this.getCheckedElements()))}fireButtonTriggered(nt){this._onButtonTriggered.fire(nt)}fireSeparatorButtonTriggered(nt){this._onSeparatorButtonTriggered.fire(nt)}style(nt){this.list.style(nt)}toggleHover(){if(!this.list.getFocusedElements()[0].saneTooltip)return;if(this._lastHover&&!this._lastHover.isDisposed){this._lastHover.dispose();return}const ot=this.list.getFocusedElements()[0];if(!ot)return;this.showHover(ot);const rt=new DisposableStore;rt.add(this.list.onDidChangeFocus(ut=>{ut.indexes.length&&this.showHover(ut.elements[0])})),this._lastHover&&rt.add(this._lastHover),this._toggleHover=rt,this.elementDisposables.push(this._toggleHover)}}__decorate$1A([memoize],QuickInputList.prototype,"onDidChangeFocus",null);__decorate$1A([memoize],QuickInputList.prototype,"onDidChangeSelection",null);function matchesContiguousIconAware(ct,nt){const{text:ot,iconOffsets:rt}=nt;if(!rt||rt.length===0)return matchesContiguous(ct,ot);const ut=ltrim(ot," "),gt=ot.length-ut.length,pt=matchesContiguous(ct,ut);if(pt)for(const mt of pt){const vt=rt[mt.start+gt]+gt;mt.start+=vt,mt.end+=vt}return pt}function matchesContiguous(ct,nt){const ot=nt.toLowerCase().indexOf(ct.toLowerCase());return ot!==-1?[{start:ot,end:ot+ct.length}]:null}function compareEntries(ct,nt,ot){const rt=ct.labelHighlights||[],ut=nt.labelHighlights||[];return rt.length&&!ut.length?-1:!rt.length&&ut.length?1:rt.length===0&&ut.length===0?0:compareAnything(ct.saneSortLabel,nt.saneSortLabel,ot)}class QuickInputAccessibilityProvider{getWidgetAriaLabel(){return localize("quickInput","Quick Input")}getAriaLabel(nt){var ot;return!((ot=nt.separator)===null||ot===void 0)&&ot.label?`${nt.saneAriaLabel}, ${nt.separator.label}`:nt.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(nt){return nt.hasCheckbox?"checkbox":"option"}isChecked(nt){if(nt.hasCheckbox)return{value:nt.checked,onDidChange:nt.onChecked}}}var __awaiter$18=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const $$7=$$d,backButton={iconClass:ThemeIcon.asClassName(Codicon.quickInputBack),tooltip:localize("quickInput.back","Back"),handle:-1};class QuickInput extends Disposable{constructor(nt){super(),this.ui=nt,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._buttons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=QuickInput.noPromptMessage,this._severity=Severity$2.Ignore,this.onDidTriggerButtonEmitter=this._register(new Emitter$2),this.onDidHideEmitter=this._register(new Emitter$2),this.onDisposeEmitter=this._register(new Emitter$2),this.visibleDisposables=this._register(new DisposableStore),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(nt){this._title=nt,this.update()}get description(){return this._description}set description(nt){this._description=nt,this.update()}get step(){return this._steps}set step(nt){this._steps=nt,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(nt){this._totalSteps=nt,this.update()}get enabled(){return this._enabled}set enabled(nt){this._enabled=nt,this.update()}get contextKey(){return this._contextKey}set contextKey(nt){this._contextKey=nt,this.update()}get busy(){return this._busy}set busy(nt){this._busy=nt,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(nt){const ot=this._ignoreFocusOut!==nt&&!isIOS;this._ignoreFocusOut=nt&&!isIOS,ot&&this.update()}get buttons(){return this._buttons}set buttons(nt){this._buttons=nt,this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(nt){this._toggles=nt??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(nt){this._validationMessage=nt,this.update()}get severity(){return this._severity}set severity(nt){this._severity=nt,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(nt=>{this.buttons.indexOf(nt)!==-1&&this.onDidTriggerButtonEmitter.fire(nt)})),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(nt=QuickInputHideReason.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:nt})}update(){var nt,ot;if(!this.visible)return;const rt=this.getTitle();rt&&this.ui.title.textContent!==rt?this.ui.title.textContent=rt:!rt&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText="");const ut=this.getDescription();if(this.ui.description1.textContent!==ut&&(this.ui.description1.textContent=ut),this.ui.description2.textContent!==ut&&(this.ui.description2.textContent=ut),this.busy&&!this.busyDelay&&(this.busyDelay=new TimeoutTimer,this.busyDelay.setIfNotSet(()=>{this.visible&&this.ui.progressBar.infinite()},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const pt=this.buttons.filter(vt=>vt===backButton);this.ui.leftActionBar.push(pt.map((vt,St)=>{const yt=new Action(`id-${St}`,"",vt.iconClass||getIconClass(vt.iconPath),!0,()=>__awaiter$18(this,void 0,void 0,function*(){this.onDidTriggerButtonEmitter.fire(vt)}));return yt.tooltip=vt.tooltip||"",yt}),{icon:!0,label:!1}),this.ui.rightActionBar.clear();const mt=this.buttons.filter(vt=>vt!==backButton);this.ui.rightActionBar.push(mt.map((vt,St)=>{const yt=new Action(`id-${St}`,"",vt.iconClass||getIconClass(vt.iconPath),!0,()=>__awaiter$18(this,void 0,void 0,function*(){this.onDidTriggerButtonEmitter.fire(vt)}));return yt.tooltip=vt.tooltip||"",yt}),{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const pt=(ot=(nt=this.toggles)===null||nt===void 0?void 0:nt.filter(mt=>mt instanceof Toggle))!==null&&ot!==void 0?ot:[];this.ui.inputBox.toggles=pt}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const gt=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==gt&&(this._lastValidationMessage=gt,reset(this.ui.message),renderQuickInputDescription(gt,this.ui.message,{callback:pt=>{this.ui.linkOpenerDelegate(pt)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?localize("quickInput.steps","{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(nt){if(this.ui.inputBox.showDecoration(nt),nt!==Severity$2.Ignore){const ot=this.ui.inputBox.stylesForType(nt);this.ui.message.style.color=ot.foreground?`${ot.foreground}`:"",this.ui.message.style.backgroundColor=ot.background?`${ot.background}`:"",this.ui.message.style.border=ot.border?`1px solid ${ot.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}}QuickInput.noPromptMessage=localize("inputModeEntry","Press 'Enter' to confirm your input or 'Escape' to cancel");class QuickPick extends QuickInput{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new Emitter$2),this.onWillAcceptEmitter=this._register(new Emitter$2),this.onDidAcceptEmitter=this._register(new Emitter$2),this.onDidCustomEmitter=this._register(new Emitter$2),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._autoFocusOnList=!0,this._keepScrollPosition=!1,this._itemActivation=ItemActivation.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new Emitter$2),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new Emitter$2),this.onDidTriggerItemButtonEmitter=this._register(new Emitter$2),this.onDidTriggerSeparatorButtonEmitter=this._register(new Emitter$2),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this.filterValue=nt=>nt,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(nt){this._quickNavigate=nt,this.update()}get value(){return this._value}set value(nt){this.doSetValue(nt)}doSetValue(nt,ot){this._value!==nt&&(this._value=nt,ot||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(nt){this._ariaLabel=nt,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(nt){this._placeholder=nt,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(nt){this.ui.list.scrollTop=nt}set items(nt){this._items=nt,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(nt){this._canSelectMany=nt,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(nt){this._canAcceptInBackground=nt}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(nt){this._matchOnDescription=nt,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(nt){this._matchOnDetail=nt,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(nt){this._matchOnLabel=nt,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(nt){this._matchOnLabelMode=nt,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(nt){this._sortByLabel=nt,this.update()}get autoFocusOnList(){return this._autoFocusOnList}set autoFocusOnList(nt){this._autoFocusOnList=nt,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(nt){this._keepScrollPosition=nt}get itemActivation(){return this._itemActivation}set itemActivation(nt){this._itemActivation=nt}get activeItems(){return this._activeItems}set activeItems(nt){this._activeItems=nt,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(nt){this._selectedItems=nt,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?NO_KEY_MODS:this.ui.keyMods}set valueSelection(nt){this._valueSelection=nt,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(nt){this._customButton=nt,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(nt){this._customButtonLabel=nt,this.update()}get customHover(){return this._customButtonHover}set customHover(nt){this._customButtonHover=nt,this.update()}get ok(){return this._ok}set ok(nt){this._ok=nt,this.update()}get hideInput(){return!!this._hideInput}set hideInput(nt){this._hideInput=nt,this.update()}trySelectFirst(){this.autoFocusOnList&&(this.canSelectMany||this.ui.list.focus(QuickInputListFocus.First))}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(nt=>{this.doSetValue(nt,!0)})),this.visibleDisposables.add(this.ui.inputBox.onMouseDown(nt=>{this.autoFocusOnList||this.ui.list.clearFocus()})),this.visibleDisposables.add((this._hideInput?this.ui.list:this.ui.inputBox).onKeyDown(nt=>{switch(nt.keyCode){case 18:this.ui.list.focus(QuickInputListFocus.Next),this.canSelectMany&&this.ui.list.domFocus(),EventHelper.stop(nt,!0);break;case 16:this.ui.list.getFocusedElements().length?this.ui.list.focus(QuickInputListFocus.Previous):this.ui.list.focus(QuickInputListFocus.Last),this.canSelectMany&&this.ui.list.domFocus(),EventHelper.stop(nt,!0);break;case 12:this.ui.list.focus(QuickInputListFocus.NextPage),this.canSelectMany&&this.ui.list.domFocus(),EventHelper.stop(nt,!0);break;case 11:this.ui.list.focus(QuickInputListFocus.PreviousPage),this.canSelectMany&&this.ui.list.domFocus(),EventHelper.stop(nt,!0);break;case 17:if(!this._canAcceptInBackground||!this.ui.inputBox.isSelectionAtEnd())return;this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!0));break;case 14:(nt.ctrlKey||nt.metaKey)&&!nt.shiftKey&&!nt.altKey&&(this.ui.list.focus(QuickInputListFocus.First),EventHelper.stop(nt,!0));break;case 13:(nt.ctrlKey||nt.metaKey)&&!nt.shiftKey&&!nt.altKey&&(this.ui.list.focus(QuickInputListFocus.Last),EventHelper.stop(nt,!0));break}})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this.ui.list.onDidChangeFocus(nt=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&equals$2(nt,this._activeItems,(ot,rt)=>ot===rt)||(this._activeItems=nt,this.onDidChangeActiveEmitter.fire(nt))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:nt,event:ot})=>{if(this.canSelectMany){nt.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&equals$2(nt,this._selectedItems,(rt,ut)=>rt===ut)||(this._selectedItems=nt,this.onDidChangeSelectionEmitter.fire(nt),nt.length&&this.handleAccept(ot instanceof MouseEvent&&ot.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(nt=>{this.canSelectMany&&(this.selectedItemsToConfirm!==this._selectedItems&&equals$2(nt,this._selectedItems,(ot,rt)=>ot===rt)||(this._selectedItems=nt,this.onDidChangeSelectionEmitter.fire(nt)))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(nt=>this.onDidTriggerItemButtonEmitter.fire(nt))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered(nt=>this.onDidTriggerSeparatorButtonEmitter.fire(nt))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(nt){let ot=!1;this.onWillAcceptEmitter.fire({veto:()=>ot=!0}),ot||this.onDidAcceptEmitter.fire({inBackground:nt})}registerQuickNavigation(){return addDisposableListener(this.ui.container,EventType$1.KEY_UP,nt=>{if(this.canSelectMany||!this._quickNavigate)return;const ot=new StandardKeyboardEvent(nt),rt=ot.keyCode;this._quickNavigate.keybindings.some(pt=>{const mt=pt.getChords();return mt.length>1?!1:mt[0].shiftKey&&rt===4?!(ot.ctrlKey||ot.altKey||ot.metaKey):!!(mt[0].altKey&&rt===6||mt[0].ctrlKey&&rt===5||mt[0].metaKey&&rt===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const nt=this.keepScrollPosition?this.scrollTop:0,ot=!!this.description,rt={title:!!this.title||!!this.step||!!this.buttons.length,description:ot,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||ot,visibleCount:!0,count:this.canSelectMany,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(rt),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let ut=this.ariaLabel;if(!ut&&rt.inputBox&&(ut=this.placeholder||QuickPick.DEFAULT_ARIA_LABEL,this.title&&(ut+=` - ${this.title}`)),this.ui.list.ariaLabel!==ut&&(this.ui.list.ariaLabel=withUndefinedAsNull(ut)),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated)switch(this.itemsUpdated=!1,this.ui.list.setElements(this.items),this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this.ui.checkAll.checked=this.ui.list.getAllVisibleChecked(),this.ui.visibleCount.setCount(this.ui.list.getVisibleCount()),this.ui.count.setCount(this.ui.list.getCheckedCount()),this._itemActivation){case ItemActivation.NONE:this._itemActivation=ItemActivation.FIRST;break;case ItemActivation.SECOND:this.ui.list.focus(QuickInputListFocus.Second),this._itemActivation=ItemActivation.FIRST;break;case ItemActivation.LAST:this.ui.list.focus(QuickInputListFocus.Last),this._itemActivation=ItemActivation.FIRST;break;default:this.trySelectFirst();break}this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",rt.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(QuickInputListFocus.First)),this.keepScrollPosition&&(this.scrollTop=nt)}}QuickPick.DEFAULT_ARIA_LABEL=localize("quickInputBox.ariaLabel","Type to narrow down results.");class InputBox extends QuickInput{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new Emitter$2),this.onDidAcceptEmitter=this._register(new Emitter$2),this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(nt){this._value=nt||"",this.update()}get placeholder(){return this._placeholder}set placeholder(nt){this._placeholder=nt,this.update()}get password(){return this._password}set password(nt){this._password=nt,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(nt=>{nt!==this.value&&(this._value=nt,this.onDidValueChangeEmitter.fire(nt))})),this.visibleDisposables.add(this.ui.onDidAccept(()=>this.onDidAcceptEmitter.fire())),this.valueSelectionUpdated=!0),super.show()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const nt={title:!!this.title||!!this.step||!!this.buttons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0};this.ui.setVisibilities(nt),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password)}}class QuickInputController extends Disposable{constructor(nt){super(),this.options=nt,this.enabled=!0,this.onDidAcceptEmitter=this._register(new Emitter$2),this.onDidCustomEmitter=this._register(new Emitter$2),this.onDidTriggerButtonEmitter=this._register(new Emitter$2),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new Emitter$2),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new Emitter$2),this.onHide=this.onHideEmitter.event,this.idPrefix=nt.idPrefix,this.parentElement=nt.container,this.styles=nt.styles,this.registerKeyModsListeners()}registerKeyModsListeners(){const nt=ot=>{this.keyMods.ctrlCmd=ot.ctrlKey||ot.metaKey,this.keyMods.alt=ot.altKey};this._register(addDisposableListener(window,EventType$1.KEY_DOWN,nt,!0)),this._register(addDisposableListener(window,EventType$1.KEY_UP,nt,!0)),this._register(addDisposableListener(window,EventType$1.MOUSE_DOWN,nt,!0))}getUI(){if(this.ui)return this.ui;const nt=append$1(this.parentElement,$$7(".quick-input-widget.show-file-icons"));nt.tabIndex=-1,nt.style.display="none";const ot=createStyleSheet(nt),rt=append$1(nt,$$7(".quick-input-titlebar")),ut=this._register(new ActionBar(rt));ut.domNode.classList.add("quick-input-left-action-bar");const gt=append$1(rt,$$7(".quick-input-title")),pt=this._register(new ActionBar(rt));pt.domNode.classList.add("quick-input-right-action-bar");const mt=append$1(nt,$$7(".quick-input-description")),vt=append$1(nt,$$7(".quick-input-header")),St=append$1(vt,$$7("input.quick-input-check-all"));St.type="checkbox",St.setAttribute("aria-label",localize("quickInput.checkAll","Toggle all checkboxes")),this._register(addStandardDisposableListener(St,EventType$1.CHANGE,Zt=>{const Xt=St.checked;qt.setAllVisibleChecked(Xt)})),this._register(addDisposableListener(St,EventType$1.CLICK,Zt=>{(Zt.x||Zt.y)&&xt.setFocus()}));const yt=append$1(vt,$$7(".quick-input-description")),wt=append$1(vt,$$7(".quick-input-and-message")),Lt=append$1(wt,$$7(".quick-input-filter")),xt=this._register(new QuickInputBox(Lt,this.styles.inputBox,this.styles.toggle));xt.setAttribute("aria-describedby",`${this.idPrefix}message`);const It=append$1(Lt,$$7(".quick-input-visible-count"));It.setAttribute("aria-live","polite"),It.setAttribute("aria-atomic","true");const kt=new CountBadge(It,{countFormat:localize({key:"quickInput.visibleCount",comment:["This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers."]},"{0} Results")},this.styles.countBadge),At=append$1(Lt,$$7(".quick-input-count"));At.setAttribute("aria-live","polite");const Tt=new CountBadge(At,{countFormat:localize({key:"quickInput.countSelected",comment:["This tells the user how many items are selected in a list of items to select from. The items can be anything."]},"{0} Selected")},this.styles.countBadge),Rt=append$1(vt,$$7(".quick-input-action")),Nt=new Button(Rt,this.styles.button);Nt.label=localize("ok","OK"),this._register(Nt.onDidClick(Zt=>{this.onDidAcceptEmitter.fire()}));const Pt=append$1(vt,$$7(".quick-input-action")),Ft=new Button(Pt,this.styles.button);Ft.label=localize("custom","Custom"),this._register(Ft.onDidClick(Zt=>{this.onDidCustomEmitter.fire()}));const Kt=append$1(wt,$$7(`#${this.idPrefix}message.quick-input-message`)),Bt=new ProgressBar(nt,this.styles.progressBar);Bt.getContainer().classList.add("quick-input-progress");const Ut=this.idPrefix+"list",qt=this._register(new QuickInputList(nt,Ut,this.options));xt.setAttribute("aria-controls",Ut),this._register(qt.onDidChangeFocus(()=>{var Zt;xt.setAttribute("aria-activedescendant",(Zt=qt.getActiveDescendant())!==null&&Zt!==void 0?Zt:"")})),this._register(qt.onChangedAllVisibleChecked(Zt=>{St.checked=Zt})),this._register(qt.onChangedVisibleCount(Zt=>{kt.setCount(Zt)})),this._register(qt.onChangedCheckedCount(Zt=>{Tt.setCount(Zt)})),this._register(qt.onLeave(()=>{setTimeout(()=>{xt.setFocus(),this.controller instanceof QuickPick&&this.controller.canSelectMany&&qt.clearFocus()},0)}));const Yt=trackFocus(nt);return this._register(Yt),this._register(addDisposableListener(nt,EventType$1.FOCUS,Zt=>{this.previousFocusElement=Zt.relatedTarget instanceof HTMLElement?Zt.relatedTarget:void 0},!0)),this._register(Yt.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(QuickInputHideReason.Blur),this.previousFocusElement=void 0})),this._register(addDisposableListener(nt,EventType$1.FOCUS,Zt=>{xt.setFocus()})),this._register(addDisposableListener(nt,EventType$1.KEY_DOWN,Zt=>{const Xt=new StandardKeyboardEvent(Zt);switch(Xt.keyCode){case 3:EventHelper.stop(Zt,!0),this.enabled&&this.onDidAcceptEmitter.fire();break;case 9:EventHelper.stop(Zt,!0),this.hide(QuickInputHideReason.Gesture);break;case 2:if(!Xt.altKey&&!Xt.ctrlKey&&!Xt.metaKey){const _i=[".action-label.codicon"];nt.classList.contains("show-checkboxes")?_i.push("input"):_i.push("input[type=text]"),this.getUI().list.isDisplayed()&&_i.push(".monaco-list"),this.getUI().message&&_i.push(".quick-input-message a");const nn=nt.querySelectorAll(_i.join(", "));Xt.shiftKey&&Xt.target===nn[0]?(EventHelper.stop(Zt,!0),qt.clearFocus()):!Xt.shiftKey&&Xt.target===nn[nn.length-1]&&(EventHelper.stop(Zt,!0),nn[0].focus())}break;case 10:Xt.ctrlKey&&(EventHelper.stop(Zt,!0),this.getUI().list.toggleHover());break}})),this.ui={container:nt,styleSheet:ot,leftActionBar:ut,titleBar:rt,title:gt,description1:mt,description2:yt,rightActionBar:pt,checkAll:St,filterContainer:Lt,inputBox:xt,visibleCountContainer:It,visibleCount:kt,countContainer:At,count:Tt,okContainer:Rt,ok:Nt,message:Kt,customButtonContainer:Pt,customButton:Ft,list:qt,progressBar:Bt,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:Zt=>this.show(Zt),hide:()=>this.hide(),setVisibilities:Zt=>this.setVisibilities(Zt),setEnabled:Zt=>this.setEnabled(Zt),setContextKey:Zt=>this.options.setContextKey(Zt),linkOpenerDelegate:Zt=>this.options.linkOpenerDelegate(Zt)},this.updateStyles(),this.ui}pick(nt,ot={},rt=CancellationToken.None){return new Promise((ut,gt)=>{let pt=yt=>{var wt;pt=ut,(wt=ot.onKeyMods)===null||wt===void 0||wt.call(ot,mt.keyMods),ut(yt)};if(rt.isCancellationRequested){pt(void 0);return}const mt=this.createQuickPick();let vt;const St=[mt,mt.onDidAccept(()=>{if(mt.canSelectMany)pt(mt.selectedItems.slice()),mt.hide();else{const yt=mt.activeItems[0];yt&&(pt(yt),mt.hide())}}),mt.onDidChangeActive(yt=>{const wt=yt[0];wt&&ot.onDidFocus&&ot.onDidFocus(wt)}),mt.onDidChangeSelection(yt=>{if(!mt.canSelectMany){const wt=yt[0];wt&&(pt(wt),mt.hide())}}),mt.onDidTriggerItemButton(yt=>ot.onDidTriggerItemButton&&ot.onDidTriggerItemButton(Object.assign(Object.assign({},yt),{removeItem:()=>{const wt=mt.items.indexOf(yt.item);if(wt!==-1){const Lt=mt.items.slice(),xt=Lt.splice(wt,1),It=mt.activeItems.filter(At=>At!==xt[0]),kt=mt.keepScrollPosition;mt.keepScrollPosition=!0,mt.items=Lt,It&&(mt.activeItems=It),mt.keepScrollPosition=kt}}}))),mt.onDidTriggerSeparatorButton(yt=>{var wt;return(wt=ot.onDidTriggerSeparatorButton)===null||wt===void 0?void 0:wt.call(ot,yt)}),mt.onDidChangeValue(yt=>{vt&&!yt&&(mt.activeItems.length!==1||mt.activeItems[0]!==vt)&&(mt.activeItems=[vt])}),rt.onCancellationRequested(()=>{mt.hide()}),mt.onDidHide(()=>{dispose(St),pt(void 0)})];mt.title=ot.title,mt.canSelectMany=!!ot.canPickMany,mt.placeholder=ot.placeHolder,mt.ignoreFocusOut=!!ot.ignoreFocusLost,mt.matchOnDescription=!!ot.matchOnDescription,mt.matchOnDetail=!!ot.matchOnDetail,mt.matchOnLabel=ot.matchOnLabel===void 0||ot.matchOnLabel,mt.autoFocusOnList=ot.autoFocusOnList===void 0||ot.autoFocusOnList,mt.quickNavigate=ot.quickNavigate,mt.hideInput=!!ot.hideInput,mt.contextKey=ot.contextKey,mt.busy=!0,Promise.all([nt,ot.activeItem]).then(([yt,wt])=>{vt=wt,mt.busy=!1,mt.items=yt,mt.canSelectMany&&(mt.selectedItems=yt.filter(Lt=>Lt.type!=="separator"&&Lt.picked)),vt&&(mt.activeItems=[vt])}),mt.show(),Promise.resolve(nt).then(void 0,yt=>{gt(yt),mt.hide()})})}createQuickPick(){const nt=this.getUI();return new QuickPick(nt)}createInputBox(){const nt=this.getUI();return new InputBox(nt)}show(nt){const ot=this.getUI();this.onShowEmitter.fire();const rt=this.controller;this.controller=nt,rt==null||rt.didHide(),this.setEnabled(!0),ot.leftActionBar.clear(),ot.title.textContent="",ot.description1.textContent="",ot.description2.textContent="",ot.rightActionBar.clear(),ot.checkAll.checked=!1,ot.inputBox.placeholder="",ot.inputBox.password=!1,ot.inputBox.showDecoration(Severity$2.Ignore),ot.visibleCount.setCount(0),ot.count.setCount(0),reset(ot.message),ot.progressBar.stop(),ot.list.setElements([]),ot.list.matchOnDescription=!1,ot.list.matchOnDetail=!1,ot.list.matchOnLabel=!0,ot.list.sortByLabel=!0,ot.ignoreFocusOut=!1,ot.inputBox.toggles=void 0;const ut=this.options.backKeybindingLabel();backButton.tooltip=ut?localize("quickInput.backWithKeybinding","Back ({0})",ut):localize("quickInput.back","Back"),ot.container.style.display="",this.updateLayout(),ot.inputBox.setFocus()}setVisibilities(nt){const ot=this.getUI();ot.title.style.display=nt.title?"":"none",ot.description1.style.display=nt.description&&(nt.inputBox||nt.checkAll)?"":"none",ot.description2.style.display=nt.description&&!(nt.inputBox||nt.checkAll)?"":"none",ot.checkAll.style.display=nt.checkAll?"":"none",ot.filterContainer.style.display=nt.inputBox?"":"none",ot.visibleCountContainer.style.display=nt.visibleCount?"":"none",ot.countContainer.style.display=nt.count?"":"none",ot.okContainer.style.display=nt.ok?"":"none",ot.customButtonContainer.style.display=nt.customButton?"":"none",ot.message.style.display=nt.message?"":"none",ot.progressBar.getContainer().style.display=nt.progressBar?"":"none",ot.list.display(!!nt.list),ot.container.classList.toggle("show-checkboxes",!!nt.checkBox),ot.container.classList.toggle("hidden-input",!nt.inputBox&&!nt.description),this.updateLayout()}setEnabled(nt){if(nt!==this.enabled){this.enabled=nt;for(const ot of this.getUI().leftActionBar.viewItems)ot.action.enabled=nt;for(const ot of this.getUI().rightActionBar.viewItems)ot.action.enabled=nt;this.getUI().checkAll.disabled=!nt,this.getUI().inputBox.enabled=nt,this.getUI().ok.enabled=nt,this.getUI().list.enabled=nt}}hide(nt){var ot;const rt=this.controller;if(rt){const ut=!(!((ot=this.ui)===null||ot===void 0)&&ot.container.contains(document.activeElement));if(this.controller=null,this.onHideEmitter.fire(),this.getUI().container.style.display="none",!ut){let gt=this.previousFocusElement;for(;gt&&!gt.offsetParent;)gt=withNullAsUndefined(gt.parentElement);gt!=null&&gt.offsetParent?(gt.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}rt.didHide(nt)}}layout(nt,ot){this.dimension=nt,this.titleBarOffset=ot,this.updateLayout()}updateLayout(){if(this.ui&&this.isDisplayed()){this.ui.container.style.top=`${this.titleBarOffset}px`;const nt=this.ui.container.style,ot=Math.min(this.dimension.width*.62,QuickInputController.MAX_WIDTH);nt.width=ot+"px",nt.marginLeft="-"+ot/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(nt){this.styles=nt,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:nt,quickInputBackground:ot,quickInputForeground:rt,widgetBorder:ut,widgetShadow:gt}=this.styles.widget;this.ui.titleBar.style.backgroundColor=nt??"",this.ui.container.style.backgroundColor=ot??"",this.ui.container.style.color=rt??"",this.ui.container.style.border=ut?`1px solid ${ut}`:"",this.ui.container.style.boxShadow=gt?`0 0 8px 2px ${gt}`:"",this.ui.list.style(this.styles.list);const pt=[];this.styles.pickerGroup.pickerGroupBorder&&pt.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&pt.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&pt.push(`.quick-input-list .quick-input-list-separator-as-item { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(pt.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&pt.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&pt.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&pt.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&pt.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&pt.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),pt.push("}"));const mt=pt.join(`
`);mt!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=mt)}}isDisplayed(){return this.ui&&this.ui.container.style.display!=="none"}}QuickInputController.MAX_WIDTH=600;var __decorate$1z=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1z=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let QuickInputService=class extends Themable{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(QuickAccessController))),this._quickAccess}constructor(nt,ot,rt,ut){super(rt),this.instantiationService=nt,this.contextKeyService=ot,this.layoutService=ut,this._onShow=this._register(new Emitter$2),this._onHide=this._register(new Emitter$2),this.contexts=new Map}createController(nt=this.layoutService,ot){const rt={idPrefix:"quickInput_",container:nt.container,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:gt=>this.setContextKey(gt),linkOpenerDelegate:gt=>{this.instantiationService.invokeFunction(pt=>{pt.get(IOpenerService).open(gt,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>nt.focus(),createList:(gt,pt,mt,vt,St)=>this.instantiationService.createInstance(WorkbenchList,gt,pt,mt,vt,St),hoverDelegate:{showHover(gt,pt){},delay:200},styles:this.computeStyles()},ut=this._register(new QuickInputController(Object.assign(Object.assign({},rt),ot)));return ut.layout(nt.dimension,nt.offset.quickPickTop),this._register(nt.onDidLayout(gt=>ut.layout(gt,nt.offset.quickPickTop))),this._register(ut.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(ut.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),ut}setContextKey(nt){let ot;nt&&(ot=this.contexts.get(nt),ot||(ot=new RawContextKey(nt,!1).bindTo(this.contextKeyService),this.contexts.set(nt,ot))),!(ot&&ot.get())&&(this.resetContextKeys(),ot==null||ot.set(!0))}resetContextKeys(){this.contexts.forEach(nt=>{nt.get()&&nt.reset()})}pick(nt,ot={},rt=CancellationToken.None){return this.controller.pick(nt,ot,rt)}createQuickPick(){return this.controller.createQuickPick()}createInputBox(){return this.controller.createInputBox()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:asCssVariable(quickInputBackground),quickInputForeground:asCssVariable(quickInputForeground),quickInputTitleBackground:asCssVariable(quickInputTitleBackground),widgetBorder:asCssVariable(widgetBorder),widgetShadow:asCssVariable(widgetShadow)},inputBox:defaultInputBoxStyles,toggle:defaultToggleStyles,countBadge:defaultCountBadgeStyles,button:defaultButtonStyles,progressBar:defaultProgressBarStyles,keybindingLabel:defaultKeybindingLabelStyles,list:getListStyles({listBackground:quickInputBackground,listFocusBackground:quickInputListFocusBackground,listFocusForeground:quickInputListFocusForeground,listInactiveFocusForeground:quickInputListFocusForeground,listInactiveSelectionIconForeground:quickInputListFocusIconForeground,listInactiveFocusBackground:quickInputListFocusBackground,listFocusOutline:activeContrastBorder,listInactiveFocusOutline:activeContrastBorder}),pickerGroup:{pickerGroupBorder:asCssVariable(pickerGroupBorder),pickerGroupForeground:asCssVariable(pickerGroupForeground)}}}};QuickInputService=__decorate$1z([__param$1z(0,IInstantiationService),__param$1z(1,IContextKeyService),__param$1z(2,IThemeService),__param$1z(3,ILayoutService)],QuickInputService);var __decorate$1y=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1y=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let EditorScopedQuickInputService=class extends QuickInputService{constructor(nt,ot,rt,ut,gt){super(ot,rt,ut,new EditorScopedLayoutService(nt.getContainerDomNode(),gt)),this.host=void 0;const pt=QuickInputEditorContribution.get(nt);if(pt){const mt=pt.widget;this.host={_serviceBrand:void 0,get hasContainer(){return!0},get container(){return mt.getDomNode()},get dimension(){return nt.getLayoutInfo()},get onDidLayout(){return nt.onDidLayoutChange},focus:()=>nt.focus(),offset:{top:0,quickPickTop:0}}}else this.host=void 0}createController(){return super.createController(this.host)}};EditorScopedQuickInputService=__decorate$1y([__param$1y(1,IInstantiationService),__param$1y(2,IContextKeyService),__param$1y(3,IThemeService),__param$1y(4,ICodeEditorService)],EditorScopedQuickInputService);let StandaloneQuickInputService=class{get activeService(){const nt=this.codeEditorService.getFocusedCodeEditor();if(!nt)throw new Error("Quick input service needs a focused editor to work.");let ot=this.mapEditorToService.get(nt);if(!ot){const rt=ot=this.instantiationService.createInstance(EditorScopedQuickInputService,nt);this.mapEditorToService.set(nt,ot),once$1(nt.onDidDispose)(()=>{rt.dispose(),this.mapEditorToService.delete(nt)})}return ot}get quickAccess(){return this.activeService.quickAccess}constructor(nt,ot){this.instantiationService=nt,this.codeEditorService=ot,this.mapEditorToService=new Map}pick(nt,ot={},rt=CancellationToken.None){return this.activeService.pick(nt,ot,rt)}createQuickPick(){return this.activeService.createQuickPick()}createInputBox(){return this.activeService.createInputBox()}};StandaloneQuickInputService=__decorate$1y([__param$1y(0,IInstantiationService),__param$1y(1,ICodeEditorService)],StandaloneQuickInputService);class QuickInputEditorContribution{static get(nt){return nt.getContribution(QuickInputEditorContribution.ID)}constructor(nt){this.editor=nt,this.widget=new QuickInputEditorWidget(this.editor)}dispose(){this.widget.dispose()}}QuickInputEditorContribution.ID="editor.controller.quickInput";class QuickInputEditorWidget{constructor(nt){this.codeEditor=nt,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return QuickInputEditorWidget.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}QuickInputEditorWidget.ID="editor.contrib.quickInputWidget";registerEditorContribution(QuickInputEditorContribution.ID,QuickInputEditorContribution,4);class ParsedTokenThemeRule{constructor(nt,ot,rt,ut,gt){this._parsedThemeRuleBrand=void 0,this.token=nt,this.index=ot,this.fontStyle=rt,this.foreground=ut,this.background=gt}}function parseTokenTheme(ct){if(!ct||!Array.isArray(ct))return[];const nt=[];let ot=0;for(let rt=0,ut=ct.length;rt<ut;rt++){const gt=ct[rt];let pt=-1;if(typeof gt.fontStyle=="string"){pt=0;const St=gt.fontStyle.split(" ");for(let yt=0,wt=St.length;yt<wt;yt++)switch(St[yt]){case"italic":pt=pt|1;break;case"bold":pt=pt|2;break;case"underline":pt=pt|4;break;case"strikethrough":pt=pt|8;break}}let mt=null;typeof gt.foreground=="string"&&(mt=gt.foreground);let vt=null;typeof gt.background=="string"&&(vt=gt.background),nt[ot++]=new ParsedTokenThemeRule(gt.token||"",rt,pt,mt,vt)}return nt}function resolveParsedTokenThemeRules(ct,nt){ct.sort((yt,wt)=>{const Lt=strcmp(yt.token,wt.token);return Lt!==0?Lt:yt.index-wt.index});let ot=0,rt="000000",ut="ffffff";for(;ct.length>=1&&ct[0].token==="";){const yt=ct.shift();yt.fontStyle!==-1&&(ot=yt.fontStyle),yt.foreground!==null&&(rt=yt.foreground),yt.background!==null&&(ut=yt.background)}const gt=new ColorMap;for(const yt of nt)gt.getId(yt);const pt=gt.getId(rt),mt=gt.getId(ut),vt=new ThemeTrieElementRule(ot,pt,mt),St=new ThemeTrieElement(vt);for(let yt=0,wt=ct.length;yt<wt;yt++){const Lt=ct[yt];St.insert(Lt.token,Lt.fontStyle,gt.getId(Lt.foreground),gt.getId(Lt.background))}return new TokenTheme(gt,St)}const colorRegExp=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class ColorMap{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(nt){if(nt===null)return 0;const ot=nt.match(colorRegExp);if(!ot)throw new Error("Illegal value for token color: "+nt);nt=ot[1].toUpperCase();let rt=this._color2id.get(nt);return rt||(rt=++this._lastColorId,this._color2id.set(nt,rt),this._id2color[rt]=Color.fromHex("#"+nt),rt)}getColorMap(){return this._id2color.slice(0)}}class TokenTheme{static createFromRawTokenTheme(nt,ot){return this.createFromParsedTokenTheme(parseTokenTheme(nt),ot)}static createFromParsedTokenTheme(nt,ot){return resolveParsedTokenThemeRules(nt,ot)}constructor(nt,ot){this._colorMap=nt,this._root=ot,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(nt){return this._root.match(nt)}match(nt,ot){let rt=this._cache.get(ot);if(typeof rt>"u"){const ut=this._match(ot),gt=toStandardTokenType(ot);rt=(ut.metadata|gt<<8)>>>0,this._cache.set(ot,rt)}return(rt|nt<<0)>>>0}}const STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|regexp)\b/;function toStandardTokenType(ct){const nt=ct.match(STANDARD_TOKEN_TYPE_REGEXP);if(!nt)return 0;switch(nt[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function strcmp(ct,nt){return ct<nt?-1:ct>nt?1:0}class ThemeTrieElementRule{constructor(nt,ot,rt){this._themeTrieElementRuleBrand=void 0,this._fontStyle=nt,this._foreground=ot,this._background=rt,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new ThemeTrieElementRule(this._fontStyle,this._foreground,this._background)}acceptOverwrite(nt,ot,rt){nt!==-1&&(this._fontStyle=nt),ot!==0&&(this._foreground=ot),rt!==0&&(this._background=rt),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class ThemeTrieElement{constructor(nt){this._themeTrieElementBrand=void 0,this._mainRule=nt,this._children=new Map}match(nt){if(nt==="")return this._mainRule;const ot=nt.indexOf(".");let rt,ut;ot===-1?(rt=nt,ut=""):(rt=nt.substring(0,ot),ut=nt.substring(ot+1));const gt=this._children.get(rt);return typeof gt<"u"?gt.match(ut):this._mainRule}insert(nt,ot,rt,ut){if(nt===""){this._mainRule.acceptOverwrite(ot,rt,ut);return}const gt=nt.indexOf(".");let pt,mt;gt===-1?(pt=nt,mt=""):(pt=nt.substring(0,gt),mt=nt.substring(gt+1));let vt=this._children.get(pt);typeof vt>"u"&&(vt=new ThemeTrieElement(this._mainRule.clone()),this._children.set(pt,vt)),vt.insert(mt,ot,rt,ut)}}function generateTokensCSSForColorMap(ct){const nt=[];for(let ot=1,rt=ct.length;ot<rt;ot++){const ut=ct[ot];nt[ot]=`.mtk${ot} { color: ${ut}; }`}return nt.push(".mtki { font-style: italic; }"),nt.push(".mtkb { font-weight: bold; }"),nt.push(".mtku { text-decoration: underline; text-underline-position: under; }"),nt.push(".mtks { text-decoration: line-through; }"),nt.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),nt.join(`
`)}const vs={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[editorBackground]:"#FFFFFE",[editorForeground]:"#000000",[editorInactiveSelection]:"#E5EBF1",[editorIndentGuides]:"#D3D3D3",[editorActiveIndentGuides]:"#939393",[editorSelectionHighlight]:"#ADD6FF4D"}},vs_dark={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[editorBackground]:"#1E1E1E",[editorForeground]:"#D4D4D4",[editorInactiveSelection]:"#3A3D41",[editorIndentGuides]:"#404040",[editorActiveIndentGuides]:"#707070",[editorSelectionHighlight]:"#ADD6FF26"}},hc_black={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[editorBackground]:"#000000",[editorForeground]:"#FFFFFF",[editorIndentGuides]:"#FFFFFF",[editorActiveIndentGuides]:"#FFFFFF"}},hc_light={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[editorBackground]:"#FFFFFF",[editorForeground]:"#292929",[editorIndentGuides]:"#292929",[editorActiveIndentGuides]:"#292929"}};function getIconsStyleSheet(ct){const nt=new Emitter$2,ot=getIconRegistry();return ot.onDidChange(()=>nt.fire()),ct==null||ct.onDidProductIconThemeChange(()=>nt.fire()),{onDidChange:nt.event,getCSS(){const rt=ct?ct.getProductIconTheme():new UnthemedProductIconTheme,ut={},gt=mt=>{const vt=rt.getIcon(mt);if(!vt)return;const St=vt.font;return St?(ut[St.id]=St.definition,`.codicon-${mt.id}:before { content: '${vt.fontCharacter}'; font-family: ${asCSSPropertyValue(St.id)}; }`):`.codicon-${mt.id}:before { content: '${vt.fontCharacter}'; }`},pt=[];for(const mt of ot.getIcons()){const vt=gt(mt);vt&&pt.push(vt)}for(const mt in ut){const vt=ut[mt],St=vt.weight?`font-weight: ${vt.weight};`:"",yt=vt.style?`font-style: ${vt.style};`:"",wt=vt.src.map(Lt=>`${asCSSUrl(Lt.location)} format('${Lt.format}')`).join(", ");pt.push(`@font-face { src: ${wt}; font-family: ${asCSSPropertyValue(mt)};${St}${yt} font-display: block; }`)}return pt.join(`
`)}}}class UnthemedProductIconTheme{getIcon(nt){const ot=getIconRegistry();let rt=nt.defaults;for(;ThemeIcon.isThemeIcon(rt);){const ut=ot.getIcon(rt.id);if(!ut)return;rt=ut.defaults}return rt}}const VS_LIGHT_THEME_NAME="vs",VS_DARK_THEME_NAME="vs-dark",HC_BLACK_THEME_NAME="hc-black",HC_LIGHT_THEME_NAME="hc-light",colorRegistry=Registry.as(Extensions$4.ColorContribution),themingRegistry=Registry.as(Extensions$3.ThemingContribution);class StandaloneTheme{constructor(nt,ot){this.semanticHighlighting=!1,this.themeData=ot;const rt=ot.base;nt.length>0?(isBuiltinTheme(nt)?this.id=nt:this.id=rt+" "+nt,this.themeName=nt):(this.id=rt,this.themeName=rt),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const nt=new Map;for(const ot in this.themeData.colors)nt.set(ot,Color.fromHex(this.themeData.colors[ot]));if(this.themeData.inherit){const ot=getBuiltinRules(this.themeData.base);for(const rt in ot.colors)nt.has(rt)||nt.set(rt,Color.fromHex(ot.colors[rt]))}this.colors=nt}return this.colors}getColor(nt,ot){const rt=this.getColors().get(nt);if(rt)return rt;if(ot!==!1)return this.getDefault(nt)}getDefault(nt){let ot=this.defaultColors[nt];return ot||(ot=colorRegistry.resolveDefaultColor(nt,this),this.defaultColors[nt]=ot,ot)}defines(nt){return this.getColors().has(nt)}get type(){switch(this.base){case VS_LIGHT_THEME_NAME:return ColorScheme.LIGHT;case HC_BLACK_THEME_NAME:return ColorScheme.HIGH_CONTRAST_DARK;case HC_LIGHT_THEME_NAME:return ColorScheme.HIGH_CONTRAST_LIGHT;default:return ColorScheme.DARK}}get tokenTheme(){if(!this._tokenTheme){let nt=[],ot=[];if(this.themeData.inherit){const gt=getBuiltinRules(this.themeData.base);nt=gt.rules,gt.encodedTokensColors&&(ot=gt.encodedTokensColors)}const rt=this.themeData.colors["editor.foreground"],ut=this.themeData.colors["editor.background"];if(rt||ut){const gt={token:""};rt&&(gt.foreground=rt),ut&&(gt.background=ut),nt.push(gt)}nt=nt.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(ot=this.themeData.encodedTokensColors),this._tokenTheme=TokenTheme.createFromRawTokenTheme(nt,ot)}return this._tokenTheme}getTokenStyleMetadata(nt,ot,rt){const gt=this.tokenTheme._match([nt].concat(ot).join(".")).metadata,pt=TokenMetadata.getForeground(gt),mt=TokenMetadata.getFontStyle(gt);return{foreground:pt,italic:!!(mt&1),bold:!!(mt&2),underline:!!(mt&4),strikethrough:!!(mt&8)}}}function isBuiltinTheme(ct){return ct===VS_LIGHT_THEME_NAME||ct===VS_DARK_THEME_NAME||ct===HC_BLACK_THEME_NAME||ct===HC_LIGHT_THEME_NAME}function getBuiltinRules(ct){switch(ct){case VS_LIGHT_THEME_NAME:return vs;case VS_DARK_THEME_NAME:return vs_dark;case HC_BLACK_THEME_NAME:return hc_black;case HC_LIGHT_THEME_NAME:return hc_light}}function newBuiltInTheme(ct){const nt=getBuiltinRules(ct);return new StandaloneTheme(ct,nt)}class StandaloneThemeService extends Disposable{constructor(){super(),this._onColorThemeChange=this._register(new Emitter$2),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new Emitter$2),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new UnthemedProductIconTheme,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(VS_LIGHT_THEME_NAME,newBuiltInTheme(VS_LIGHT_THEME_NAME)),this._knownThemes.set(VS_DARK_THEME_NAME,newBuiltInTheme(VS_DARK_THEME_NAME)),this._knownThemes.set(HC_BLACK_THEME_NAME,newBuiltInTheme(HC_BLACK_THEME_NAME)),this._knownThemes.set(HC_LIGHT_THEME_NAME,newBuiltInTheme(HC_LIGHT_THEME_NAME));const nt=getIconsStyleSheet(this);this._codiconCSS=nt.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(VS_LIGHT_THEME_NAME),this._onOSSchemeChanged(),nt.onDidChange(()=>{this._codiconCSS=nt.getCSS(),this._updateCSS()}),addMatchMediaChangeListener("(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(nt){return isInShadowDOM(nt)?this._registerShadowDomContainer(nt):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=createStyleSheet(void 0,nt=>{nt.className="monaco-colors",nt.textContent=this._allCSS}),this._styleElements.push(this._globalStyleElement)),Disposable.None}_registerShadowDomContainer(nt){const ot=createStyleSheet(nt,rt=>{rt.className="monaco-colors",rt.textContent=this._allCSS});return this._styleElements.push(ot),{dispose:()=>{for(let rt=0;rt<this._styleElements.length;rt++)if(this._styleElements[rt]===ot){this._styleElements.splice(rt,1);return}}}}defineTheme(nt,ot){if(!/^[a-z0-9\-]+$/i.test(nt))throw new Error("Illegal theme name!");if(!isBuiltinTheme(ot.base)&&!isBuiltinTheme(nt))throw new Error("Illegal theme base!");this._knownThemes.set(nt,new StandaloneTheme(nt,ot)),isBuiltinTheme(nt)&&this._knownThemes.forEach(rt=>{rt.base===nt&&rt.notifyBaseUpdated()}),this._theme.themeName===nt&&this.setTheme(nt)}getColorTheme(){return this._theme}setColorMapOverride(nt){this._colorMapOverride=nt,this._updateThemeOrColorMap()}setTheme(nt){let ot;this._knownThemes.has(nt)?ot=this._knownThemes.get(nt):ot=this._knownThemes.get(VS_LIGHT_THEME_NAME),this._updateActualTheme(ot)}_updateActualTheme(nt){!nt||this._theme===nt||(this._theme=nt,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const nt=window.matchMedia("(forced-colors: active)").matches;if(nt!==isHighContrast(this._theme.type)){let ot;isDark(this._theme.type)?ot=nt?HC_BLACK_THEME_NAME:VS_DARK_THEME_NAME:ot=nt?HC_LIGHT_THEME_NAME:VS_LIGHT_THEME_NAME,this._updateActualTheme(this._knownThemes.get(ot))}}}setAutoDetectHighContrast(nt){this._autoDetectHighContrast=nt,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const nt=[],ot={},rt={addRule:pt=>{ot[pt]||(nt.push(pt),ot[pt]=!0)}};themingRegistry.getThemingParticipants().forEach(pt=>pt(this._theme,rt,this._environment));const ut=[];for(const pt of colorRegistry.getColors()){const mt=this._theme.getColor(pt.id,!0);mt&&ut.push(`${asCssVariableName(pt.id)}: ${mt.toString()};`)}rt.addRule(`.monaco-editor { ${ut.join(`
`)} }`);const gt=this._colorMapOverride||this._theme.tokenTheme.getColorMap();rt.addRule(generateTokensCSSForColorMap(gt)),this._themeCSS=nt.join(`
`),this._updateCSS(),TokenizationRegistry.setColorMap(gt),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(nt=>nt.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const IStandaloneThemeService=createDecorator("themeService");var __decorate$1x=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1x=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let AccessibilityService=class extends Disposable{constructor(nt,ot,rt){super(),this._contextKeyService=nt,this._layoutService=ot,this._configurationService=rt,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new Emitter$2,this._onDidChangeReducedMotion=new Emitter$2,this._accessibilityModeEnabledContext=CONTEXT_ACCESSIBILITY_MODE_ENABLED.bindTo(this._contextKeyService);const ut=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(pt=>{pt.affectsConfiguration("editor.accessibilitySupport")&&(ut(),this._onDidChangeScreenReaderOptimized.fire()),pt.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),ut(),this._register(this.onDidChangeScreenReaderOptimized(()=>ut()));const gt=window.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=gt.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this.initReducedMotionListeners(gt)}initReducedMotionListeners(nt){if(!this._layoutService.hasContainer)return;this._register(addDisposableListener(nt,"change",()=>{this._systemMotionReduced=nt.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const ot=()=>{const rt=this.isMotionReduced();this._layoutService.container.classList.toggle("reduce-motion",rt),this._layoutService.container.classList.toggle("enable-motion",!rt)};ot(),this._register(this.onDidChangeReducedMotion(()=>ot()))}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const nt=this._configurationService.getValue("editor.accessibilitySupport");return nt==="on"||nt==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const nt=this._configMotionReduced;return nt==="on"||nt==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};AccessibilityService=__decorate$1x([__param$1x(0,IContextKeyService),__param$1x(1,ILayoutService),__param$1x(2,IConfigurationService)],AccessibilityService);var __decorate$1w=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1w=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let MenuService=class{constructor(nt,ot){this._commandService=nt,this._hiddenStates=new PersistedMenuHideState(ot)}createMenu(nt,ot,rt){return new MenuImpl(nt,this._hiddenStates,Object.assign({emitEventsForSubmenuChanges:!1,eventDebounceDelay:50},rt),this._commandService,ot)}resetHiddenStates(nt){this._hiddenStates.reset(nt)}};MenuService=__decorate$1w([__param$1w(0,ICommandService),__param$1w(1,IStorageService)],MenuService);let PersistedMenuHideState=class Do{constructor(nt){this._storageService=nt,this._disposables=new DisposableStore,this._onDidChange=new Emitter$2,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1,this._hiddenByDefaultCache=new Map;try{const ot=nt.get(Do._key,0,"{}");this._data=JSON.parse(ot)}catch{this._data=Object.create(null)}this._disposables.add(nt.onDidChangeValue(ot=>{if(ot.key===Do._key){if(!this._ignoreChangeEvent)try{const rt=nt.get(Do._key,0,"{}");this._data=JSON.parse(rt)}catch(rt){console.log("FAILED to read storage after UPDATE",rt)}this._onDidChange.fire()}}))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(nt,ot){var rt;return(rt=this._hiddenByDefaultCache.get(`${nt.id}/${ot}`))!==null&&rt!==void 0?rt:!1}setDefaultState(nt,ot,rt){this._hiddenByDefaultCache.set(`${nt.id}/${ot}`,rt)}isHidden(nt,ot){var rt,ut;const gt=this._isHiddenByDefault(nt,ot),pt=(ut=(rt=this._data[nt.id])===null||rt===void 0?void 0:rt.includes(ot))!==null&&ut!==void 0?ut:!1;return gt?!pt:pt}updateHidden(nt,ot,rt){this._isHiddenByDefault(nt,ot)&&(rt=!rt);const gt=this._data[nt.id];if(rt)gt?gt.indexOf(ot)<0&&gt.push(ot):this._data[nt.id]=[ot];else if(gt){const pt=gt.indexOf(ot);pt>=0&&removeFastWithoutKeepingOrder(gt,pt),gt.length===0&&delete this._data[nt.id]}this._persist()}reset(nt){if(nt===void 0)this._data=Object.create(null),this._persist();else{for(const{id:ot}of nt)this._data[ot]&&delete this._data[ot];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;const nt=JSON.stringify(this._data);this._storageService.store(Do._key,nt,0,0)}finally{this._ignoreChangeEvent=!1}}};PersistedMenuHideState._key="menu.hiddenCommands";PersistedMenuHideState=__decorate$1w([__param$1w(0,IStorageService)],PersistedMenuHideState);let MenuInfo=class po{constructor(nt,ot,rt,ut,gt){this._id=nt,this._hiddenStates=ot,this._collectContextKeysForSubmenus=rt,this._commandService=ut,this._contextKeyService=gt,this._menuGroups=[],this._structureContextKeys=new Set,this._preconditionContextKeys=new Set,this._toggledContextKeys=new Set,this.refresh()}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();const nt=MenuRegistry.getMenuItems(this._id);let ot;nt.sort(po._compareMenuItems);for(const rt of nt){const ut=rt.group||"";(!ot||ot[0]!==ut)&&(ot=[ut,[]],this._menuGroups.push(ot)),ot[1].push(rt),this._collectContextKeys(rt)}}_collectContextKeys(nt){if(po._fillInKbExprKeys(nt.when,this._structureContextKeys),isIMenuItem(nt)){if(nt.command.precondition&&po._fillInKbExprKeys(nt.command.precondition,this._preconditionContextKeys),nt.command.toggled){const ot=nt.command.toggled.condition||nt.command.toggled;po._fillInKbExprKeys(ot,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&MenuRegistry.getMenuItems(nt.submenu).forEach(this._collectContextKeys,this)}createActionGroups(nt){const ot=[];for(const rt of this._menuGroups){const[ut,gt]=rt,pt=[];for(const mt of gt)if(this._contextKeyService.contextMatchesRules(mt.when)){const vt=isIMenuItem(mt);vt&&this._hiddenStates.setDefaultState(this._id,mt.command.id,!!mt.isHiddenByDefault);const St=createMenuHide(this._id,vt?mt.command:mt,this._hiddenStates);if(vt)pt.push(new MenuItemAction(mt.command,mt.alt,nt,St,this._contextKeyService,this._commandService));else{const yt=new po(mt.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._contextKeyService).createActionGroups(nt),wt=Separator.join(...yt.map(Lt=>Lt[1]));wt.length>0&&pt.push(new SubmenuItemAction(mt,St,wt))}}pt.length>0&&ot.push([ut,pt])}return ot}static _fillInKbExprKeys(nt,ot){if(nt)for(const rt of nt.keys())ot.add(rt)}static _compareMenuItems(nt,ot){const rt=nt.group,ut=ot.group;if(rt!==ut){if(rt){if(!ut)return-1}else return 1;if(rt==="navigation")return-1;if(ut==="navigation")return 1;const mt=rt.localeCompare(ut);if(mt!==0)return mt}const gt=nt.order||0,pt=ot.order||0;return gt<pt?-1:gt>pt?1:po._compareTitles(isIMenuItem(nt)?nt.command.title:nt.title,isIMenuItem(ot)?ot.command.title:ot.title)}static _compareTitles(nt,ot){const rt=typeof nt=="string"?nt:nt.original,ut=typeof ot=="string"?ot:ot.original;return rt.localeCompare(ut)}};MenuInfo=__decorate$1w([__param$1w(3,ICommandService),__param$1w(4,IContextKeyService)],MenuInfo);let MenuImpl=class{constructor(nt,ot,rt,ut,gt){this._disposables=new DisposableStore,this._menuInfo=new MenuInfo(nt,ot,rt.emitEventsForSubmenuChanges,ut,gt);const pt=new RunOnceScheduler(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},rt.eventDebounceDelay);this._disposables.add(pt),this._disposables.add(MenuRegistry.onDidChangeMenu(yt=>{yt.has(nt)&&pt.schedule()}));const mt=this._disposables.add(new DisposableStore),vt=yt=>{let wt=!1,Lt=!1,xt=!1;for(const It of yt)if(wt=wt||It.isStructuralChange,Lt=Lt||It.isEnablementChange,xt=xt||It.isToggleChange,wt&&Lt&&xt)break;return{menu:this,isStructuralChange:wt,isEnablementChange:Lt,isToggleChange:xt}},St=()=>{mt.add(gt.onDidChangeContext(yt=>{const wt=yt.affectsSome(this._menuInfo.structureContextKeys),Lt=yt.affectsSome(this._menuInfo.preconditionContextKeys),xt=yt.affectsSome(this._menuInfo.toggledContextKeys);(wt||Lt||xt)&&this._onDidChange.fire({menu:this,isStructuralChange:wt,isEnablementChange:Lt,isToggleChange:xt})})),mt.add(ot.onDidChange(yt=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new DebounceEmitter({onWillAddFirstListener:St,onDidRemoveLastListener:mt.clear.bind(mt),delay:rt.eventDebounceDelay,merge:vt}),this.onDidChange=this._onDidChange.event}getActions(nt){return this._menuInfo.createActionGroups(nt)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};MenuImpl=__decorate$1w([__param$1w(3,ICommandService),__param$1w(4,IContextKeyService)],MenuImpl);function createMenuHide(ct,nt,ot){const rt=isISubmenuItem(nt)?nt.submenu.id:nt.id,ut=typeof nt.title=="string"?nt.title:nt.title.value,gt=toAction({id:`hide/${ct.id}/${rt}`,label:localize("hide.label","Hide '{0}'",ut),run(){ot.updateHidden(ct,rt,!0)}}),pt=toAction({id:`toggle/${ct.id}/${rt}`,label:ut,get checked(){return!ot.isHidden(ct,rt)},run(){ot.updateHidden(ct,rt,!!this.checked)}});return{hide:gt,toggle:pt,get isHidden(){return!pt.checked}}}var __decorate$1v=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1v=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$17=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let BrowserClipboardService=class extends Disposable{constructor(nt,ot){super(),this.layoutService=nt,this.logService=ot,this.mapTextToType=new Map,this.findText="",this.resources=[],(isSafari||isWebkitWebView)&&this.installWebKitWriteTextWorkaround()}installWebKitWriteTextWorkaround(){const nt=()=>{const ot=new DeferredPromise;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=ot,navigator.clipboard.write([new ClipboardItem({"text/plain":ot.p})]).catch(rt=>__awaiter$17(this,void 0,void 0,function*(){(!(rt instanceof Error)||rt.name!=="NotAllowedError"||!ot.isRejected)&&this.logService.error(rt)}))};this.layoutService.hasContainer&&(this._register(addDisposableListener(this.layoutService.container,"click",nt)),this._register(addDisposableListener(this.layoutService.container,"keydown",nt)))}writeText(nt,ot){return __awaiter$17(this,void 0,void 0,function*(){if(ot){this.mapTextToType.set(ot,nt);return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(nt);try{return yield navigator.clipboard.writeText(nt)}catch(gt){console.error(gt)}const rt=document.activeElement,ut=document.body.appendChild($$d("textarea",{"aria-hidden":!0}));ut.style.height="1px",ut.style.width="1px",ut.style.position="absolute",ut.value=nt,ut.focus(),ut.select(),document.execCommand("copy"),rt instanceof HTMLElement&&rt.focus(),document.body.removeChild(ut)})}readText(nt){return __awaiter$17(this,void 0,void 0,function*(){if(nt)return this.mapTextToType.get(nt)||"";try{return yield navigator.clipboard.readText()}catch(ot){return console.error(ot),""}})}readFindText(){return __awaiter$17(this,void 0,void 0,function*(){return this.findText})}writeFindText(nt){return __awaiter$17(this,void 0,void 0,function*(){this.findText=nt})}readResources(){return __awaiter$17(this,void 0,void 0,function*(){return this.resources})}};BrowserClipboardService=__decorate$1v([__param$1v(0,ILayoutService),__param$1v(1,ILogService)],BrowserClipboardService);var __decorate$1u=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1u=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const KEYBINDING_CONTEXT_ATTR="data-keybinding-context";let Context$2=class{constructor(nt,ot){this._id=nt,this._parent=ot,this._value=Object.create(null),this._value._contextId=nt}get value(){return Object.assign({},this._value)}setValue(nt,ot){return this._value[nt]!==ot?(this._value[nt]=ot,!0):!1}removeValue(nt){return nt in this._value?(delete this._value[nt],!0):!1}getValue(nt){const ot=this._value[nt];return typeof ot>"u"&&this._parent?this._parent.getValue(nt):ot}};class NullContext extends Context$2{constructor(){super(-1,null)}setValue(nt,ot){return!1}removeValue(nt){return!1}getValue(nt){}}NullContext.INSTANCE=new NullContext;class ConfigAwareContextValuesContainer extends Context$2{constructor(nt,ot,rt){super(nt,null),this._configurationService=ot,this._values=TernarySearchTree.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(ut=>{if(ut.source===7){const gt=Array.from(this._values,([pt])=>pt);this._values.clear(),rt.fire(new ArrayContextKeyChangeEvent(gt))}else{const gt=[];for(const pt of ut.affectedKeys){const mt=`config.${pt}`,vt=this._values.findSuperstr(mt);vt!==void 0&&(gt.push(...Iterable.map(vt,([St])=>St)),this._values.deleteSuperstr(mt)),this._values.has(mt)&&(gt.push(mt),this._values.delete(mt))}rt.fire(new ArrayContextKeyChangeEvent(gt))}})}dispose(){this._listener.dispose()}getValue(nt){if(nt.indexOf(ConfigAwareContextValuesContainer._keyPrefix)!==0)return super.getValue(nt);if(this._values.has(nt))return this._values.get(nt);const ot=nt.substr(ConfigAwareContextValuesContainer._keyPrefix.length),rt=this._configurationService.getValue(ot);let ut;switch(typeof rt){case"number":case"boolean":case"string":ut=rt;break;default:Array.isArray(rt)?ut=JSON.stringify(rt):ut=rt}return this._values.set(nt,ut),ut}setValue(nt,ot){return super.setValue(nt,ot)}removeValue(nt){return super.removeValue(nt)}}ConfigAwareContextValuesContainer._keyPrefix="config.";class ContextKey{constructor(nt,ot,rt){this._service=nt,this._key=ot,this._defaultValue=rt,this.reset()}set(nt){this._service.setContext(this._key,nt)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class SimpleContextKeyChangeEvent{constructor(nt){this.key=nt}affectsSome(nt){return nt.has(this.key)}allKeysContainedIn(nt){return this.affectsSome(nt)}}class ArrayContextKeyChangeEvent{constructor(nt){this.keys=nt}affectsSome(nt){for(const ot of this.keys)if(nt.has(ot))return!0;return!1}allKeysContainedIn(nt){return this.keys.every(ot=>nt.has(ot))}}class CompositeContextKeyChangeEvent{constructor(nt){this.events=nt}affectsSome(nt){for(const ot of this.events)if(ot.affectsSome(nt))return!0;return!1}allKeysContainedIn(nt){return this.events.every(ot=>ot.allKeysContainedIn(nt))}}function allEventKeysInContext(ct,nt){return ct.allKeysContainedIn(new Set(Object.keys(nt)))}class AbstractContextKeyService{constructor(nt){this._onDidChangeContext=new PauseableEmitter({merge:ot=>new CompositeContextKeyChangeEvent(ot)}),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=nt}createKey(nt,ot){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new ContextKey(this,nt,ot)}bufferChangeEvents(nt){this._onDidChangeContext.pause();try{nt()}finally{this._onDidChangeContext.resume()}}createScoped(nt){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new ScopedContextKeyService(this,nt)}contextMatchesRules(nt){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const ot=this.getContextValuesContainer(this._myContextId);return nt?nt.evaluate(ot):!0}getContextKeyValue(nt){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(nt)}setContext(nt,ot){if(this._isDisposed)return;const rt=this.getContextValuesContainer(this._myContextId);rt&&rt.setValue(nt,ot)&&this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(nt))}removeContext(nt){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(nt)&&this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(nt))}getContext(nt){return this._isDisposed?NullContext.INSTANCE:this.getContextValuesContainer(findContextAttr(nt))}}let ContextKeyService=class extends AbstractContextKeyService{constructor(nt){super(0),this._contexts=new Map,this._toDispose=new DisposableStore,this._lastContextId=0;const ot=new ConfigAwareContextValuesContainer(this._myContextId,nt,this._onDidChangeContext);this._contexts.set(this._myContextId,ot),this._toDispose.add(ot)}dispose(){this._onDidChangeContext.dispose(),this._isDisposed=!0,this._toDispose.dispose()}getContextValuesContainer(nt){return this._isDisposed?NullContext.INSTANCE:this._contexts.get(nt)||NullContext.INSTANCE}createChildContext(nt=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const ot=++this._lastContextId;return this._contexts.set(ot,new Context$2(ot,this.getContextValuesContainer(nt))),ot}disposeContext(nt){this._isDisposed||this._contexts.delete(nt)}};ContextKeyService=__decorate$1u([__param$1u(0,IConfigurationService)],ContextKeyService);class ScopedContextKeyService extends AbstractContextKeyService{constructor(nt,ot){if(super(nt.createChildContext()),this._parentChangeListener=new MutableDisposable,this._parent=nt,this._updateParentChangeListener(),this._domNode=ot,this._domNode.hasAttribute(KEYBINDING_CONTEXT_ATTR)){let rt="";this._domNode.classList&&(rt=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${rt?": "+rt:""}`)}this._domNode.setAttribute(KEYBINDING_CONTEXT_ATTR,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(nt=>{const rt=this._parent.getContextValuesContainer(this._myContextId).value;allEventKeysInContext(nt,rt)||this._onDidChangeContext.fire(nt)})}dispose(){this._isDisposed||(this._onDidChangeContext.dispose(),this._parent.disposeContext(this._myContextId),this._parentChangeListener.dispose(),this._domNode.removeAttribute(KEYBINDING_CONTEXT_ATTR),this._isDisposed=!0)}getContextValuesContainer(nt){return this._isDisposed?NullContext.INSTANCE:this._parent.getContextValuesContainer(nt)}createChildContext(nt=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(nt)}disposeContext(nt){this._isDisposed||this._parent.disposeContext(nt)}}function findContextAttr(ct){for(;ct;){if(ct.hasAttribute(KEYBINDING_CONTEXT_ATTR)){const nt=ct.getAttribute(KEYBINDING_CONTEXT_ATTR);return nt?parseInt(nt,10):NaN}ct=ct.parentElement}return 0}function setContext(ct,nt,ot){ct.get(IContextKeyService).createKey(String(nt),stringifyURIs(ot))}function stringifyURIs(ct){return cloneAndChange(ct,nt=>{if(typeof nt=="object"&&nt.$mid===1)return URI.revive(nt).toString();if(nt instanceof URI)return nt.toString()})}CommandsRegistry.registerCommand("_setContext",setContext);CommandsRegistry.registerCommand({id:"getContextKeyInfo",handler(){return[...RawContextKey.all()].sort((ct,nt)=>ct.key.localeCompare(nt.key))},description:{description:localize("getContextKeyInfo","A command that returns information about context keys"),args:[]}});CommandsRegistry.registerCommand("_generateContextKeyInfo",function(){const ct=[],nt=new Set;for(const ot of RawContextKey.all())nt.has(ot.key)||(nt.add(ot.key),ct.push(ot));ct.sort((ot,rt)=>ot.key.localeCompare(rt.key)),console.log(JSON.stringify(ct,void 0,2))});let Node$1=class{constructor(nt,ot){this.key=nt,this.data=ot,this.incoming=new Map,this.outgoing=new Map}};class Graph{constructor(nt){this._hashFn=nt,this._nodes=new Map}roots(){const nt=[];for(const ot of this._nodes.values())ot.outgoing.size===0&&nt.push(ot);return nt}insertEdge(nt,ot){const rt=this.lookupOrInsertNode(nt),ut=this.lookupOrInsertNode(ot);rt.outgoing.set(ut.key,ut),ut.incoming.set(rt.key,rt)}removeNode(nt){const ot=this._hashFn(nt);this._nodes.delete(ot);for(const rt of this._nodes.values())rt.outgoing.delete(ot),rt.incoming.delete(ot)}lookupOrInsertNode(nt){const ot=this._hashFn(nt);let rt=this._nodes.get(ot);return rt||(rt=new Node$1(ot,nt),this._nodes.set(ot,rt)),rt}isEmpty(){return this._nodes.size===0}toString(){const nt=[];for(const[ot,rt]of this._nodes)nt.push(`${ot}
	(-> incoming)[${[...rt.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...rt.outgoing.keys()].join(",")}]
`);return nt.join(`
`)}findCycleSlow(){for(const[nt,ot]of this._nodes){const rt=new Set([nt]),ut=this._findCycle(ot,rt);if(ut)return ut}}_findCycle(nt,ot){for(const[rt,ut]of nt.outgoing){if(ot.has(rt))return[...ot,rt].join(" -> ");ot.add(rt);const gt=this._findCycle(ut,ot);if(gt)return gt;ot.delete(rt)}}}const _enableAllTracing=!1;class CyclicDependencyError extends Error{constructor(nt){var ot;super("cyclic dependency between services"),this.message=(ot=nt.findCycleSlow())!==null&&ot!==void 0?ot:`UNABLE to detect cycle, dumping graph: 
${nt.toString()}`}}class InstantiationService{constructor(nt=new ServiceCollection,ot=!1,rt,ut=_enableAllTracing){var gt;this._services=nt,this._strict=ot,this._parent=rt,this._enableTracing=ut,this._activeInstantiations=new Set,this._services.set(IInstantiationService,this),this._globalGraph=ut?(gt=rt==null?void 0:rt._globalGraph)!==null&&gt!==void 0?gt:new Graph(pt=>pt):void 0}createChild(nt){return new InstantiationService(nt,this._strict,this,this._enableTracing)}invokeFunction(nt,...ot){const rt=Trace.traceInvocation(this._enableTracing,nt);let ut=!1;try{return nt({get:pt=>{if(ut)throw illegalState("service accessor is only valid during the invocation of its target method");const mt=this._getOrCreateServiceInstance(pt,rt);if(!mt)throw new Error(`[invokeFunction] unknown service '${pt}'`);return mt}},...ot)}finally{ut=!0,rt.stop()}}createInstance(nt,...ot){let rt,ut;return nt instanceof SyncDescriptor?(rt=Trace.traceCreation(this._enableTracing,nt.ctor),ut=this._createInstance(nt.ctor,nt.staticArguments.concat(ot),rt)):(rt=Trace.traceCreation(this._enableTracing,nt),ut=this._createInstance(nt,ot,rt)),rt.stop(),ut}_createInstance(nt,ot=[],rt){const ut=_util.getServiceDependencies(nt).sort((mt,vt)=>mt.index-vt.index),gt=[];for(const mt of ut){const vt=this._getOrCreateServiceInstance(mt.id,rt);vt||this._throwIfStrict(`[createInstance] ${nt.name} depends on UNKNOWN service ${mt.id}.`,!1),gt.push(vt)}const pt=ut.length>0?ut[0].index:ot.length;if(ot.length!==pt){console.trace(`[createInstance] First service dependency of ${nt.name} at position ${pt+1} conflicts with ${ot.length} static arguments`);const mt=pt-ot.length;mt>0?ot=ot.concat(new Array(mt)):ot=ot.slice(0,pt)}return Reflect.construct(nt,ot.concat(gt))}_setServiceInstance(nt,ot){if(this._services.get(nt)instanceof SyncDescriptor)this._services.set(nt,ot);else if(this._parent)this._parent._setServiceInstance(nt,ot);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(nt){const ot=this._services.get(nt);return!ot&&this._parent?this._parent._getServiceInstanceOrDescriptor(nt):ot}_getOrCreateServiceInstance(nt,ot){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(nt));const rt=this._getServiceInstanceOrDescriptor(nt);return rt instanceof SyncDescriptor?this._safeCreateAndCacheServiceInstance(nt,rt,ot.branch(nt,!0)):(ot.branch(nt,!1),rt)}_safeCreateAndCacheServiceInstance(nt,ot,rt){if(this._activeInstantiations.has(nt))throw new Error(`illegal state - RECURSIVELY instantiating service '${nt}'`);this._activeInstantiations.add(nt);try{return this._createAndCacheServiceInstance(nt,ot,rt)}finally{this._activeInstantiations.delete(nt)}}_createAndCacheServiceInstance(nt,ot,rt){var ut;const gt=new Graph(vt=>vt.id.toString());let pt=0;const mt=[{id:nt,desc:ot,_trace:rt}];for(;mt.length;){const vt=mt.pop();if(gt.lookupOrInsertNode(vt),pt++>1e3)throw new CyclicDependencyError(gt);for(const St of _util.getServiceDependencies(vt.desc.ctor)){const yt=this._getServiceInstanceOrDescriptor(St.id);if(yt||this._throwIfStrict(`[createInstance] ${nt} depends on ${St.id} which is NOT registered.`,!0),(ut=this._globalGraph)===null||ut===void 0||ut.insertEdge(String(vt.id),String(St.id)),yt instanceof SyncDescriptor){const wt={id:St.id,desc:yt,_trace:vt._trace.branch(St.id,!0)};gt.insertEdge(vt,wt),mt.push(wt)}}}for(;;){const vt=gt.roots();if(vt.length===0){if(!gt.isEmpty())throw new CyclicDependencyError(gt);break}for(const{data:St}of vt){if(this._getServiceInstanceOrDescriptor(St.id)instanceof SyncDescriptor){const wt=this._createServiceInstanceWithOwner(St.id,St.desc.ctor,St.desc.staticArguments,St.desc.supportsDelayedInstantiation,St._trace);this._setServiceInstance(St.id,wt)}gt.removeNode(St)}}return this._getServiceInstanceOrDescriptor(nt)}_createServiceInstanceWithOwner(nt,ot,rt=[],ut,gt){if(this._services.get(nt)instanceof SyncDescriptor)return this._createServiceInstance(nt,ot,rt,ut,gt);if(this._parent)return this._parent._createServiceInstanceWithOwner(nt,ot,rt,ut,gt);throw new Error(`illegalState - creating UNKNOWN service instance ${ot.name}`)}_createServiceInstance(nt,ot,rt=[],ut,gt){if(ut){const pt=new InstantiationService(void 0,this._strict,this,this._enableTracing);pt._globalGraphImplicitDependency=String(nt);const mt=new Map,vt=new IdleValue(()=>{const St=pt._createInstance(ot,rt,gt);for(const[yt,wt]of mt){const Lt=St[yt];if(typeof Lt=="function")for(const xt of wt)Lt.apply(St,xt)}return mt.clear(),St});return new Proxy(Object.create(null),{get(St,yt){if(!vt.isInitialized&&typeof yt=="string"&&(yt.startsWith("onDid")||yt.startsWith("onWill"))){let xt=mt.get(yt);return xt||(xt=new LinkedList,mt.set(yt,xt)),(kt,At,Tt)=>{const Rt=xt.push([kt,At,Tt]);return toDisposable(Rt)}}if(yt in St)return St[yt];const wt=vt.value;let Lt=wt[yt];return typeof Lt!="function"||(Lt=Lt.bind(wt),St[yt]=Lt),Lt},set(St,yt,wt){return vt.value[yt]=wt,!0},getPrototypeOf(St){return ot.prototype}})}else return this._createInstance(ot,rt,gt)}_throwIfStrict(nt,ot){if(ot&&console.warn(nt),this._strict)throw new Error(nt)}}class Trace{static traceInvocation(nt,ot){return nt?new Trace(2,ot.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):Trace._None}static traceCreation(nt,ot){return nt?new Trace(1,ot.name):Trace._None}constructor(nt,ot){this.type=nt,this.name=ot,this._start=Date.now(),this._dep=[]}branch(nt,ot){const rt=new Trace(3,nt.toString());return this._dep.push([nt,ot,rt]),rt}stop(){const nt=Date.now()-this._start;Trace._totals+=nt;let ot=!1;function rt(gt,pt){const mt=[],vt=new Array(gt+1).join("	");for(const[St,yt,wt]of pt._dep)if(yt&&wt){ot=!0,mt.push(`${vt}CREATES -> ${St}`);const Lt=rt(gt+1,wt);Lt&&mt.push(Lt)}else mt.push(`${vt}uses -> ${St}`);return mt.join(`
`)}const ut=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${rt(1,this)}`,`DONE, took ${nt.toFixed(2)}ms (grand total ${Trace._totals.toFixed(2)}ms)`];(nt>2||ot)&&Trace.all.add(ut.join(`
`))}}Trace.all=new Set;Trace._None=new class extends Trace{constructor(){super(0,null)}stop(){}branch(){return this}};Trace._totals=0;const unsupportedSchemas=new Set([Schemas.inMemory,Schemas.vscodeSourceControl,Schemas.walkThrough,Schemas.walkThroughSnippet]);class DoubleResourceMap{constructor(){this._byResource=new ResourceMap,this._byOwner=new Map}set(nt,ot,rt){let ut=this._byResource.get(nt);ut||(ut=new Map,this._byResource.set(nt,ut)),ut.set(ot,rt);let gt=this._byOwner.get(ot);gt||(gt=new ResourceMap,this._byOwner.set(ot,gt)),gt.set(nt,rt)}get(nt,ot){const rt=this._byResource.get(nt);return rt==null?void 0:rt.get(ot)}delete(nt,ot){let rt=!1,ut=!1;const gt=this._byResource.get(nt);gt&&(rt=gt.delete(ot));const pt=this._byOwner.get(ot);if(pt&&(ut=pt.delete(nt)),rt!==ut)throw new Error("illegal state");return rt&&ut}values(nt){var ot,rt,ut,gt;return typeof nt=="string"?(rt=(ot=this._byOwner.get(nt))===null||ot===void 0?void 0:ot.values())!==null&&rt!==void 0?rt:Iterable.empty():URI.isUri(nt)?(gt=(ut=this._byResource.get(nt))===null||ut===void 0?void 0:ut.values())!==null&&gt!==void 0?gt:Iterable.empty():Iterable.map(Iterable.concat(...this._byOwner.values()),pt=>pt[1])}}class MarkerStats{constructor(nt){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new ResourceMap,this._service=nt,this._subscription=nt.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(nt){for(const ot of nt){const rt=this._data.get(ot);rt&&this._substract(rt);const ut=this._resourceStats(ot);this._add(ut),this._data.set(ot,ut)}}_resourceStats(nt){const ot={errors:0,warnings:0,infos:0,unknowns:0};if(unsupportedSchemas.has(nt.scheme))return ot;for(const{severity:rt}of this._service.read({resource:nt}))rt===MarkerSeverity$1.Error?ot.errors+=1:rt===MarkerSeverity$1.Warning?ot.warnings+=1:rt===MarkerSeverity$1.Info?ot.infos+=1:ot.unknowns+=1;return ot}_substract(nt){this.errors-=nt.errors,this.warnings-=nt.warnings,this.infos-=nt.infos,this.unknowns-=nt.unknowns}_add(nt){this.errors+=nt.errors,this.warnings+=nt.warnings,this.infos+=nt.infos,this.unknowns+=nt.unknowns}}class MarkerService{constructor(){this._onMarkerChanged=new DebounceEmitter({delay:0,merge:MarkerService._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new DoubleResourceMap,this._stats=new MarkerStats(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(nt,ot){for(const rt of ot||[])this.changeOne(nt,rt,[])}changeOne(nt,ot,rt){if(isFalsyOrEmpty(rt))this._data.delete(ot,nt)&&this._onMarkerChanged.fire([ot]);else{const ut=[];for(const gt of rt){const pt=MarkerService._toMarker(nt,ot,gt);pt&&ut.push(pt)}this._data.set(ot,nt,ut),this._onMarkerChanged.fire([ot])}}static _toMarker(nt,ot,rt){let{code:ut,severity:gt,message:pt,source:mt,startLineNumber:vt,startColumn:St,endLineNumber:yt,endColumn:wt,relatedInformation:Lt,tags:xt}=rt;if(pt)return vt=vt>0?vt:1,St=St>0?St:1,yt=yt>=vt?yt:vt,wt=wt>0?wt:St,{resource:ot,owner:nt,code:ut,severity:gt,message:pt,source:mt,startLineNumber:vt,startColumn:St,endLineNumber:yt,endColumn:wt,relatedInformation:Lt,tags:xt}}changeAll(nt,ot){const rt=[],ut=this._data.values(nt);if(ut)for(const gt of ut){const pt=Iterable.first(gt);pt&&(rt.push(pt.resource),this._data.delete(pt.resource,nt))}if(isNonEmptyArray(ot)){const gt=new ResourceMap;for(const{resource:pt,marker:mt}of ot){const vt=MarkerService._toMarker(nt,pt,mt);if(!vt)continue;const St=gt.get(pt);St?St.push(vt):(gt.set(pt,[vt]),rt.push(pt))}for(const[pt,mt]of gt)this._data.set(pt,nt,mt)}rt.length>0&&this._onMarkerChanged.fire(rt)}read(nt=Object.create(null)){let{owner:ot,resource:rt,severities:ut,take:gt}=nt;if((!gt||gt<0)&&(gt=-1),ot&&rt){const pt=this._data.get(rt,ot);if(pt){const mt=[];for(const vt of pt)if(MarkerService._accept(vt,ut)){const St=mt.push(vt);if(gt>0&&St===gt)break}return mt}else return[]}else if(!ot&&!rt){const pt=[];for(const mt of this._data.values())for(const vt of mt)if(MarkerService._accept(vt,ut)){const St=pt.push(vt);if(gt>0&&St===gt)return pt}return pt}else{const pt=this._data.values(rt??ot),mt=[];for(const vt of pt)for(const St of vt)if(MarkerService._accept(St,ut)){const yt=mt.push(St);if(gt>0&&yt===gt)return mt}return mt}}static _accept(nt,ot){return ot===void 0||(ot&nt.severity)===nt.severity}static _merge(nt){const ot=new ResourceMap;for(const rt of nt)for(const ut of rt)ot.set(ut,!0);return Array.from(ot.keys())}}class DefaultConfiguration extends Disposable{constructor(){super(...arguments),this._configurationModel=new ConfigurationModel}get configurationModel(){return this._configurationModel}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=new ConfigurationModel;const nt=Registry.as(Extensions$8.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(nt),nt)}updateConfigurationModel(nt,ot){const rt=this.getConfigurationDefaultOverrides();for(const ut of nt){const gt=rt[ut],pt=ot[ut];gt!==void 0?this._configurationModel.addValue(ut,gt):pt?this._configurationModel.addValue(ut,pt.default):this._configurationModel.removeValue(ut)}}}class LogService extends Disposable{constructor(nt,ot=[]){super(),this.logger=new MultiplexLogger([nt,...ot]),this._register(nt.onDidChangeLogLevel(rt=>this.setLevel(rt)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(nt){this.logger.setLevel(nt)}getLevel(){return this.logger.getLevel()}trace(nt,...ot){this.logger.trace(nt,...ot)}debug(nt,...ot){this.logger.debug(nt,...ot)}info(nt,...ot){this.logger.info(nt,...ot)}error(nt,...ot){this.logger.error(nt,...ot)}}const editorFeatures=[];function registerEditorFeature(ct){editorFeatures.push(ct)}function getEditorFeatures(){return editorFeatures.slice(0)}var __decorate$1t=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1t=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$16=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class SimpleModel{constructor(nt){this.disposed=!1,this.model=nt,this._onWillDispose=new Emitter$2}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let StandaloneTextModelService=class{constructor(nt){this.modelService=nt}createModelReference(nt){const ot=this.modelService.getModel(nt);return ot?Promise.resolve(new ImmortalReference(new SimpleModel(ot))):Promise.reject(new Error("Model not found"))}};StandaloneTextModelService=__decorate$1t([__param$1t(0,IModelService)],StandaloneTextModelService);class StandaloneEditorProgressService{show(){return StandaloneEditorProgressService.NULL_PROGRESS_RUNNER}showWhile(nt,ot){return __awaiter$16(this,void 0,void 0,function*(){yield nt})}}StandaloneEditorProgressService.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};class StandaloneProgressService{}class StandaloneDialogService{confirm(nt){return __awaiter$16(this,void 0,void 0,function*(){return{confirmed:this.doConfirm(nt.message,nt.detail),checkboxChecked:!1}})}doConfirm(nt,ot){let rt=nt;return ot&&(rt=rt+`

`+ot),window.confirm(rt)}prompt(nt){var ot,rt;return __awaiter$16(this,void 0,void 0,function*(){let ut;if(this.doConfirm(nt.message,nt.detail)){const pt=[...(ot=nt.buttons)!==null&&ot!==void 0?ot:[]];nt.cancelButton&&typeof nt.cancelButton!="string"&&typeof nt.cancelButton!="boolean"&&pt.push(nt.cancelButton),ut=yield(rt=pt[0])===null||rt===void 0?void 0:rt.run({checkboxChecked:!1})}return{result:ut}})}error(nt,ot){return __awaiter$16(this,void 0,void 0,function*(){yield this.prompt({type:Severity$2.Error,message:nt,detail:ot})})}}class StandaloneNotificationService{info(nt){return this.notify({severity:Severity$2.Info,message:nt})}warn(nt){return this.notify({severity:Severity$2.Warning,message:nt})}error(nt){return this.notify({severity:Severity$2.Error,message:nt})}notify(nt){switch(nt.severity){case Severity$2.Error:console.error(nt.message);break;case Severity$2.Warning:console.warn(nt.message);break;default:console.log(nt.message);break}return StandaloneNotificationService.NO_OP}prompt(nt,ot,rt,ut){return StandaloneNotificationService.NO_OP}status(nt,ot){return Disposable.None}}StandaloneNotificationService.NO_OP=new NoOpNotification;let StandaloneCommandService=class{constructor(nt){this._onWillExecuteCommand=new Emitter$2,this._onDidExecuteCommand=new Emitter$2,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=nt}executeCommand(nt,...ot){const rt=CommandsRegistry.getCommand(nt);if(!rt)return Promise.reject(new Error(`command '${nt}' not found`));try{this._onWillExecuteCommand.fire({commandId:nt,args:ot});const ut=this._instantiationService.invokeFunction.apply(this._instantiationService,[rt.handler,...ot]);return this._onDidExecuteCommand.fire({commandId:nt,args:ot}),Promise.resolve(ut)}catch(ut){return Promise.reject(ut)}}};StandaloneCommandService=__decorate$1t([__param$1t(0,IInstantiationService)],StandaloneCommandService);let StandaloneKeybindingService=class extends AbstractKeybindingService{constructor(nt,ot,rt,ut,gt,pt){super(nt,ot,rt,ut,gt),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const mt=xt=>{const It=new DisposableStore;It.add(addDisposableListener(xt,EventType$1.KEY_DOWN,kt=>{const At=new StandardKeyboardEvent(kt);this._dispatch(At,At.target)&&(At.preventDefault(),At.stopPropagation())})),It.add(addDisposableListener(xt,EventType$1.KEY_UP,kt=>{const At=new StandardKeyboardEvent(kt);this._singleModifierDispatch(At,At.target)&&At.preventDefault()})),this._domNodeListeners.push(new DomNodeListeners(xt,It))},vt=xt=>{for(let It=0;It<this._domNodeListeners.length;It++){const kt=this._domNodeListeners[It];kt.domNode===xt&&(this._domNodeListeners.splice(It,1),kt.dispose())}},St=xt=>{xt.getOption(59)||mt(xt.getContainerDomNode())},yt=xt=>{xt.getOption(59)||vt(xt.getContainerDomNode())};this._register(pt.onCodeEditorAdd(St)),this._register(pt.onCodeEditorRemove(yt)),pt.listCodeEditors().forEach(St);const wt=xt=>{mt(xt.getContainerDomNode())},Lt=xt=>{vt(xt.getContainerDomNode())};this._register(pt.onDiffEditorAdd(wt)),this._register(pt.onDiffEditorRemove(Lt)),pt.listDiffEditors().forEach(wt)}addDynamicKeybinding(nt,ot,rt,ut){return combinedDisposable(CommandsRegistry.registerCommand(nt,rt),this.addDynamicKeybindings([{keybinding:ot,command:nt,when:ut}]))}addDynamicKeybindings(nt){const ot=nt.map(rt=>{var ut;return{keybinding:decodeKeybinding(rt.keybinding,OS),command:(ut=rt.command)!==null&&ut!==void 0?ut:null,commandArgs:rt.commandArgs,when:rt.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}});return this._dynamicKeybindings=this._dynamicKeybindings.concat(ot),this.updateResolver(),toDisposable(()=>{for(let rt=0;rt<this._dynamicKeybindings.length;rt++)if(this._dynamicKeybindings[rt]===ot[0]){this._dynamicKeybindings.splice(rt,ot.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const nt=this._toNormalizedKeybindingItems(KeybindingsRegistry.getDefaultKeybindings(),!0),ot=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new KeybindingResolver(nt,ot,rt=>this._log(rt))}return this._cachedResolver}_documentHasFocus(){return document.hasFocus()}_toNormalizedKeybindingItems(nt,ot){const rt=[];let ut=0;for(const gt of nt){const pt=gt.when||void 0,mt=gt.keybinding;if(!mt)rt[ut++]=new ResolvedKeybindingItem(void 0,gt.command,gt.commandArgs,pt,ot,null,!1);else{const vt=USLayoutResolvedKeybinding.resolveKeybinding(mt,OS);for(const St of vt)rt[ut++]=new ResolvedKeybindingItem(St,gt.command,gt.commandArgs,pt,ot,null,!1)}}return rt}resolveKeyboardEvent(nt){const ot=new KeyCodeChord(nt.ctrlKey,nt.shiftKey,nt.altKey,nt.metaKey,nt.keyCode);return new USLayoutResolvedKeybinding([ot],OS)}};StandaloneKeybindingService=__decorate$1t([__param$1t(0,IContextKeyService),__param$1t(1,ICommandService),__param$1t(2,ITelemetryService),__param$1t(3,INotificationService),__param$1t(4,ILogService),__param$1t(5,ICodeEditorService)],StandaloneKeybindingService);class DomNodeListeners extends Disposable{constructor(nt,ot){super(),this.domNode=nt,this._register(ot)}}function isConfigurationOverrides(ct){return ct&&typeof ct=="object"&&(!ct.overrideIdentifier||typeof ct.overrideIdentifier=="string")&&(!ct.resource||ct.resource instanceof URI)}class StandaloneConfigurationService{constructor(){this._onDidChangeConfiguration=new Emitter$2,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const nt=new DefaultConfiguration;this._configuration=new Configuration(nt.reload(),new ConfigurationModel,new ConfigurationModel,new ConfigurationModel),nt.dispose()}getValue(nt,ot){const rt=typeof nt=="string"?nt:void 0,ut=isConfigurationOverrides(nt)?nt:isConfigurationOverrides(ot)?ot:{};return this._configuration.getValue(rt,ut,void 0)}updateValues(nt){const ot={data:this._configuration.toData()},rt=[];for(const ut of nt){const[gt,pt]=ut;this.getValue(gt)!==pt&&(this._configuration.updateValue(gt,pt),rt.push(gt))}if(rt.length>0){const ut=new ConfigurationChangeEvent({keys:rt,overrides:[]},ot,this._configuration);ut.source=8,ut.sourceConfig=null,this._onDidChangeConfiguration.fire(ut)}return Promise.resolve()}updateValue(nt,ot,rt,ut){return this.updateValues([[nt,ot]])}inspect(nt,ot={}){return this._configuration.inspect(nt,ot,void 0)}}let StandaloneResourceConfigurationService=class{constructor(nt,ot,rt){this.configurationService=nt,this.modelService=ot,this.languageService=rt,this._onDidChangeConfiguration=new Emitter$2,this.configurationService.onDidChangeConfiguration(ut=>{this._onDidChangeConfiguration.fire({affectedKeys:ut.affectedKeys,affectsConfiguration:(gt,pt)=>ut.affectsConfiguration(pt)})})}getValue(nt,ot,rt){const ut=Position$1.isIPosition(ot)?ot:null,gt=ut?typeof rt=="string"?rt:void 0:typeof ot=="string"?ot:void 0,pt=nt?this.getLanguage(nt,ut):void 0;return typeof gt>"u"?this.configurationService.getValue({resource:nt,overrideIdentifier:pt}):this.configurationService.getValue(gt,{resource:nt,overrideIdentifier:pt})}getLanguage(nt,ot){const rt=this.modelService.getModel(nt);return rt?ot?rt.getLanguageIdAtPosition(ot.lineNumber,ot.column):rt.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(nt)}};StandaloneResourceConfigurationService=__decorate$1t([__param$1t(0,IConfigurationService),__param$1t(1,IModelService),__param$1t(2,ILanguageService)],StandaloneResourceConfigurationService);let StandaloneResourcePropertiesService=class{constructor(nt){this.configurationService=nt}getEOL(nt,ot){const rt=this.configurationService.getValue("files.eol",{overrideIdentifier:ot,resource:nt});return rt&&typeof rt=="string"&&rt!=="auto"?rt:isLinux||isMacintosh?`
`:`\r
`}};StandaloneResourcePropertiesService=__decorate$1t([__param$1t(0,IConfigurationService)],StandaloneResourcePropertiesService);class StandaloneTelemetryService{publicLog2(){}}class StandaloneWorkspaceContextService{constructor(){const nt=URI.from({scheme:StandaloneWorkspaceContextService.SCHEME,authority:"model",path:"/"});this.workspace={id:STANDALONE_EDITOR_WORKSPACE_ID,folders:[new WorkspaceFolder({uri:nt,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(nt){return nt&&nt.scheme===StandaloneWorkspaceContextService.SCHEME?this.workspace.folders[0]:null}}StandaloneWorkspaceContextService.SCHEME="inmemory";function updateConfigurationService(ct,nt,ot){if(!nt||!(ct instanceof StandaloneConfigurationService))return;const rt=[];Object.keys(nt).forEach(ut=>{isEditorConfigurationKey(ut)&&rt.push([`editor.${ut}`,nt[ut]]),ot&&isDiffEditorConfigurationKey(ut)&&rt.push([`diffEditor.${ut}`,nt[ut]])}),rt.length>0&&ct.updateValues(rt)}let StandaloneBulkEditService=class{constructor(nt){this._modelService=nt}hasPreviewHandler(){return!1}apply(nt,ot){return __awaiter$16(this,void 0,void 0,function*(){const rt=Array.isArray(nt)?nt:ResourceEdit.convert(nt),ut=new Map;for(const mt of rt){if(!(mt instanceof ResourceTextEdit))throw new Error("bad edit - only text edits are supported");const vt=this._modelService.getModel(mt.resource);if(!vt)throw new Error("bad edit - model not found");if(typeof mt.versionId=="number"&&vt.getVersionId()!==mt.versionId)throw new Error("bad state - model changed in the meantime");let St=ut.get(vt);St||(St=[],ut.set(vt,St)),St.push(EditOperation.replaceMove(Range$2.lift(mt.textEdit.range),mt.textEdit.text))}let gt=0,pt=0;for(const[mt,vt]of ut)mt.pushStackElement(),mt.pushEditOperations([],vt,()=>[]),mt.pushStackElement(),pt+=1,gt+=vt.length;return{ariaSummary:format(StandaloneServicesNLS.bulkEditServiceSummary,gt,pt),isApplied:gt>0}})}};StandaloneBulkEditService=__decorate$1t([__param$1t(0,IModelService)],StandaloneBulkEditService);class StandaloneUriLabelService{getUriLabel(nt,ot){return nt.scheme==="file"?nt.fsPath:nt.path}getUriBasenameLabel(nt){return basename(nt)}}let StandaloneContextViewService=class extends ContextViewService{constructor(nt,ot){super(nt),this._codeEditorService=ot}showContextView(nt,ot,rt){if(!ot){const ut=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();ut&&(ot=ut.getContainerDomNode())}return super.showContextView(nt,ot,rt)}};StandaloneContextViewService=__decorate$1t([__param$1t(0,ILayoutService),__param$1t(1,ICodeEditorService)],StandaloneContextViewService);class StandaloneWorkspaceTrustManagementService{constructor(){this._neverEmitter=new Emitter$2,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class StandaloneLanguageService extends LanguageService{constructor(){super()}}class StandaloneLogService extends LogService{constructor(){super(new ConsoleLogger)}}let StandaloneContextMenuService=class extends ContextMenuService{constructor(nt,ot,rt,ut,gt,pt){super(nt,ot,rt,ut,gt,pt),this.configure({blockMouse:!1})}};StandaloneContextMenuService=__decorate$1t([__param$1t(0,ITelemetryService),__param$1t(1,INotificationService),__param$1t(2,IContextViewService),__param$1t(3,IKeybindingService),__param$1t(4,IMenuService),__param$1t(5,IContextKeyService)],StandaloneContextMenuService);class StandaloneAudioService{playAudioCue(nt,ot){return __awaiter$16(this,void 0,void 0,function*(){})}}registerSingleton(IConfigurationService,StandaloneConfigurationService,0);registerSingleton(ITextResourceConfigurationService,StandaloneResourceConfigurationService,0);registerSingleton(ITextResourcePropertiesService,StandaloneResourcePropertiesService,0);registerSingleton(IWorkspaceContextService,StandaloneWorkspaceContextService,0);registerSingleton(ILabelService,StandaloneUriLabelService,0);registerSingleton(ITelemetryService,StandaloneTelemetryService,0);registerSingleton(IDialogService,StandaloneDialogService,0);registerSingleton(INotificationService,StandaloneNotificationService,0);registerSingleton(IMarkerService,MarkerService,0);registerSingleton(ILanguageService,StandaloneLanguageService,0);registerSingleton(IStandaloneThemeService,StandaloneThemeService,0);registerSingleton(ILogService,StandaloneLogService,0);registerSingleton(IModelService,ModelService,0);registerSingleton(IMarkerDecorationsService,MarkerDecorationsService,0);registerSingleton(IContextKeyService,ContextKeyService,0);registerSingleton(IProgressService,StandaloneProgressService,0);registerSingleton(IEditorProgressService,StandaloneEditorProgressService,0);registerSingleton(IStorageService,InMemoryStorageService,0);registerSingleton(IEditorWorkerService,EditorWorkerService,0);registerSingleton(IBulkEditService,StandaloneBulkEditService,0);registerSingleton(IWorkspaceTrustManagementService,StandaloneWorkspaceTrustManagementService,0);registerSingleton(ITextModelService,StandaloneTextModelService,0);registerSingleton(IAccessibilityService,AccessibilityService,0);registerSingleton(IListService,ListService,0);registerSingleton(ICommandService,StandaloneCommandService,0);registerSingleton(IKeybindingService,StandaloneKeybindingService,0);registerSingleton(IQuickInputService,StandaloneQuickInputService,0);registerSingleton(IContextViewService,StandaloneContextViewService,0);registerSingleton(IOpenerService,OpenerService,0);registerSingleton(IClipboardService,BrowserClipboardService,0);registerSingleton(IContextMenuService,StandaloneContextMenuService,0);registerSingleton(IMenuService,MenuService,0);registerSingleton(IAudioCueService,StandaloneAudioService,0);var StandaloneServices;(function(ct){const nt=new ServiceCollection;for(const[pt,mt]of getSingletonServiceDescriptors())nt.set(pt,mt);const ot=new InstantiationService(nt,!0);nt.set(IInstantiationService,ot);function rt(pt){const mt=nt.get(pt);if(!mt)throw new Error("Missing service "+pt);return mt instanceof SyncDescriptor?ot.invokeFunction(vt=>vt.get(pt)):mt}ct.get=rt;let ut=!1;function gt(pt){if(ut)return ot;ut=!0;for(const[vt,St]of getSingletonServiceDescriptors())nt.get(vt)||nt.set(vt,St);for(const vt in pt)if(pt.hasOwnProperty(vt)){const St=createDecorator(vt);nt.get(St)instanceof SyncDescriptor&&nt.set(St,pt[vt])}const mt=getEditorFeatures();for(const vt of mt)try{ot.createInstance(vt)}catch(St){onUnexpectedError(St)}return ot}ct.initialize=gt})(StandaloneServices||(StandaloneServices={}));var __decorate$1s=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1s=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let LAST_GENERATED_COMMAND_ID=0,ariaDomNodeCreated=!1;function createAriaDomNode(ct){if(!ct){if(ariaDomNodeCreated)return;ariaDomNodeCreated=!0}setARIAContainer(ct||document.body)}let StandaloneCodeEditor=class extends CodeEditorWidget{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt){const xt=Object.assign({},ot);xt.ariaLabel=xt.ariaLabel||StandaloneCodeEditorNLS.editorViewAccessibleLabel,xt.ariaLabel=xt.ariaLabel+";"+StandaloneCodeEditorNLS.accessibilityHelpMessage,super(nt,xt,{},rt,ut,gt,pt,vt,St,yt,wt,Lt),mt instanceof StandaloneKeybindingService?this._standaloneKeybindingService=mt:this._standaloneKeybindingService=null,createAriaDomNode(xt.ariaContainerElement)}addCommand(nt,ot,rt){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const ut="DYNAMIC_"+ ++LAST_GENERATED_COMMAND_ID,gt=ContextKeyExpr.deserialize(rt);return this._standaloneKeybindingService.addDynamicKeybinding(ut,nt,ot,gt),ut}createContextKey(nt,ot){return this._contextKeyService.createKey(nt,ot)}addAction(nt){if(typeof nt.id!="string"||typeof nt.label!="string"||typeof nt.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),Disposable.None;const ot=nt.id,rt=nt.label,ut=ContextKeyExpr.and(ContextKeyExpr.equals("editorId",this.getId()),ContextKeyExpr.deserialize(nt.precondition)),gt=nt.keybindings,pt=ContextKeyExpr.and(ut,ContextKeyExpr.deserialize(nt.keybindingContext)),mt=nt.contextMenuGroupId||null,vt=nt.contextMenuOrder||0,St=(xt,...It)=>Promise.resolve(nt.run(this,...It)),yt=new DisposableStore,wt=this.getId()+":"+ot;if(yt.add(CommandsRegistry.registerCommand(wt,St)),mt){const xt={command:{id:wt,title:rt},when:ut,group:mt,order:vt};yt.add(MenuRegistry.appendMenuItem(MenuId.EditorContext,xt))}if(Array.isArray(gt))for(const xt of gt)yt.add(this._standaloneKeybindingService.addDynamicKeybinding(wt,xt,St,pt));const Lt=new InternalEditorAction(wt,rt,rt,ut,(...xt)=>Promise.resolve(nt.run(this,...xt)),this._contextKeyService);return this._actions.set(ot,Lt),yt.add(toDisposable(()=>{this._actions.delete(ot)})),yt}_triggerCommand(nt,ot){if(this._codeEditorService instanceof StandaloneCodeEditorService)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(nt,ot)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(nt,ot)}};StandaloneCodeEditor=__decorate$1s([__param$1s(2,IInstantiationService),__param$1s(3,ICodeEditorService),__param$1s(4,ICommandService),__param$1s(5,IContextKeyService),__param$1s(6,IKeybindingService),__param$1s(7,IThemeService),__param$1s(8,INotificationService),__param$1s(9,IAccessibilityService),__param$1s(10,ILanguageConfigurationService),__param$1s(11,ILanguageFeaturesService)],StandaloneCodeEditor);let StandaloneEditor=class extends StandaloneCodeEditor{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt,xt,It,kt){const At=Object.assign({},ot);updateConfigurationService(yt,At,!1);const Tt=vt.registerEditorContainer(nt);typeof At.theme=="string"&&vt.setTheme(At.theme),typeof At.autoDetectHighContrast<"u"&&vt.setAutoDetectHighContrast(!!At.autoDetectHighContrast);const Rt=At.model;delete At.model,super(nt,At,rt,ut,gt,pt,mt,vt,St,wt,It,kt),this._configurationService=yt,this._standaloneThemeService=vt,this._register(Tt);let Nt;if(typeof Rt>"u"){const Pt=xt.getLanguageIdByMimeType(At.language)||At.language||PLAINTEXT_LANGUAGE_ID;Nt=createTextModel(Lt,xt,At.value||"",Pt,void 0),this._ownsModel=!0}else Nt=Rt,this._ownsModel=!1;if(this._attachModel(Nt),Nt){const Pt={oldModelUrl:null,newModelUrl:Nt.uri};this._onDidChangeModel.fire(Pt)}}dispose(){super.dispose()}updateOptions(nt){updateConfigurationService(this._configurationService,nt,!1),typeof nt.theme=="string"&&this._standaloneThemeService.setTheme(nt.theme),typeof nt.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!nt.autoDetectHighContrast),super.updateOptions(nt)}_postDetachModelCleanup(nt){super._postDetachModelCleanup(nt),nt&&this._ownsModel&&(nt.dispose(),this._ownsModel=!1)}};StandaloneEditor=__decorate$1s([__param$1s(2,IInstantiationService),__param$1s(3,ICodeEditorService),__param$1s(4,ICommandService),__param$1s(5,IContextKeyService),__param$1s(6,IKeybindingService),__param$1s(7,IStandaloneThemeService),__param$1s(8,INotificationService),__param$1s(9,IConfigurationService),__param$1s(10,IAccessibilityService),__param$1s(11,IModelService),__param$1s(12,ILanguageService),__param$1s(13,ILanguageConfigurationService),__param$1s(14,ILanguageFeaturesService)],StandaloneEditor);let StandaloneDiffEditor=class extends DiffEditorWidget{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt){const Lt=Object.assign({},ot);updateConfigurationService(vt,Lt,!0);const xt=pt.registerEditorContainer(nt);typeof Lt.theme=="string"&&pt.setTheme(Lt.theme),typeof Lt.autoDetectHighContrast<"u"&&pt.setAutoDetectHighContrast(!!Lt.autoDetectHighContrast),super(nt,Lt,{},wt,ut,rt,gt,pt,mt,St,yt),this._configurationService=vt,this._standaloneThemeService=pt,this._register(xt)}dispose(){super.dispose()}updateOptions(nt){updateConfigurationService(this._configurationService,nt,!0),typeof nt.theme=="string"&&this._standaloneThemeService.setTheme(nt.theme),typeof nt.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!nt.autoDetectHighContrast),super.updateOptions(nt)}_createInnerEditor(nt,ot,rt){return nt.createInstance(StandaloneCodeEditor,ot,rt)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(nt,ot,rt){return this.getModifiedEditor().addCommand(nt,ot,rt)}createContextKey(nt,ot){return this.getModifiedEditor().createContextKey(nt,ot)}addAction(nt){return this.getModifiedEditor().addAction(nt)}};StandaloneDiffEditor=__decorate$1s([__param$1s(2,IInstantiationService),__param$1s(3,IContextKeyService),__param$1s(4,ICodeEditorService),__param$1s(5,IStandaloneThemeService),__param$1s(6,INotificationService),__param$1s(7,IConfigurationService),__param$1s(8,IContextMenuService),__param$1s(9,IEditorProgressService),__param$1s(10,IClipboardService)],StandaloneDiffEditor);function createTextModel(ct,nt,ot,rt,ut){if(ot=ot||"",!rt){const gt=ot.indexOf(`
`);let pt=ot;return gt!==-1&&(pt=ot.substring(0,gt)),doCreateModel(ct,ot,nt.createByFilepathOrFirstLine(ut||null,pt),ut)}return doCreateModel(ct,ot,nt.createById(rt),ut)}function doCreateModel(ct,nt,ot,rt){return ct.createModel(nt,ot,rt)}var __awaiter$15=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function create(ct,nt,ot){return StandaloneServices.initialize(ot||{}).createInstance(StandaloneEditor,ct,nt)}function onDidCreateEditor(ct){return StandaloneServices.get(ICodeEditorService).onCodeEditorAdd(ot=>{ct(ot)})}function onDidCreateDiffEditor(ct){return StandaloneServices.get(ICodeEditorService).onDiffEditorAdd(ot=>{ct(ot)})}function getEditors(){return StandaloneServices.get(ICodeEditorService).listCodeEditors()}function getDiffEditors(){return StandaloneServices.get(ICodeEditorService).listDiffEditors()}function createDiffEditor(ct,nt,ot){return StandaloneServices.initialize(ot||{}).createInstance(StandaloneDiffEditor,ct,nt)}function createDiffNavigator(ct,nt){return StandaloneServices.initialize({}).createInstance(DiffNavigator,ct,nt)}function addCommand(ct){if(typeof ct.id!="string"||typeof ct.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return CommandsRegistry.registerCommand(ct.id,ct.run)}function addEditorAction(ct){if(typeof ct.id!="string"||typeof ct.label!="string"||typeof ct.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const nt=ContextKeyExpr.deserialize(ct.precondition),ot=(ut,...gt)=>EditorCommand.runEditorCommand(ut,gt,nt,(pt,mt,vt)=>Promise.resolve(ct.run(mt,...vt))),rt=new DisposableStore;if(rt.add(CommandsRegistry.registerCommand(ct.id,ot)),ct.contextMenuGroupId){const ut={command:{id:ct.id,title:ct.label},when:nt,group:ct.contextMenuGroupId,order:ct.contextMenuOrder||0};rt.add(MenuRegistry.appendMenuItem(MenuId.EditorContext,ut))}if(Array.isArray(ct.keybindings)){const ut=StandaloneServices.get(IKeybindingService);if(!(ut instanceof StandaloneKeybindingService))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const gt=ContextKeyExpr.and(nt,ContextKeyExpr.deserialize(ct.keybindingContext));rt.add(ut.addDynamicKeybindings(ct.keybindings.map(pt=>({keybinding:pt,command:ct.id,when:gt}))))}}return rt}function addKeybindingRule(ct){return addKeybindingRules([ct])}function addKeybindingRules(ct){const nt=StandaloneServices.get(IKeybindingService);return nt instanceof StandaloneKeybindingService?nt.addDynamicKeybindings(ct.map(ot=>({keybinding:ot.keybinding,command:ot.command,commandArgs:ot.commandArgs,when:ContextKeyExpr.deserialize(ot.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),Disposable.None)}function createModel(ct,nt,ot){const rt=StandaloneServices.get(ILanguageService),ut=rt.getLanguageIdByMimeType(nt)||nt;return createTextModel(StandaloneServices.get(IModelService),rt,ct,ut,ot)}function setModelLanguage(ct,nt){const ot=StandaloneServices.get(ILanguageService),rt=ot.getLanguageIdByMimeType(nt)||nt||PLAINTEXT_LANGUAGE_ID;ct.setLanguage(ot.createById(rt))}function setModelMarkers(ct,nt,ot){ct&&StandaloneServices.get(IMarkerService).changeOne(nt,ct.uri,ot)}function removeAllMarkers(ct){StandaloneServices.get(IMarkerService).changeAll(ct,[])}function getModelMarkers(ct){return StandaloneServices.get(IMarkerService).read(ct)}function onDidChangeMarkers(ct){return StandaloneServices.get(IMarkerService).onMarkerChanged(ct)}function getModel(ct){return StandaloneServices.get(IModelService).getModel(ct)}function getModels(){return StandaloneServices.get(IModelService).getModels()}function onDidCreateModel(ct){return StandaloneServices.get(IModelService).onModelAdded(ct)}function onWillDisposeModel(ct){return StandaloneServices.get(IModelService).onModelRemoved(ct)}function onDidChangeModelLanguage(ct){return StandaloneServices.get(IModelService).onModelLanguageChanged(ot=>{ct({model:ot.model,oldLanguage:ot.oldLanguageId})})}function createWebWorker(ct){return createWebWorker$1(StandaloneServices.get(IModelService),StandaloneServices.get(ILanguageConfigurationService),ct)}function colorizeElement(ct,nt){const ot=StandaloneServices.get(ILanguageService),rt=StandaloneServices.get(IStandaloneThemeService);return rt.registerEditorContainer(ct),Colorizer.colorizeElement(rt,ot,ct,nt)}function colorize(ct,nt,ot){const rt=StandaloneServices.get(ILanguageService);return StandaloneServices.get(IStandaloneThemeService).registerEditorContainer(document.body),Colorizer.colorize(rt,ct,nt,ot)}function colorizeModelLine(ct,nt,ot=4){return StandaloneServices.get(IStandaloneThemeService).registerEditorContainer(document.body),Colorizer.colorizeModelLine(ct,nt,ot)}function getSafeTokenizationSupport$1(ct){const nt=TokenizationRegistry.get(ct);return nt||{getInitialState:()=>NullState,tokenize:(ot,rt,ut)=>nullTokenize(ct,ut)}}function tokenize(ct,nt){TokenizationRegistry.getOrCreate(nt);const ot=getSafeTokenizationSupport$1(nt),rt=splitLines(ct),ut=[];let gt=ot.getInitialState();for(let pt=0,mt=rt.length;pt<mt;pt++){const vt=rt[pt],St=ot.tokenize(vt,!0,gt);ut[pt]=St.tokens,gt=St.endState}return ut}function defineTheme(ct,nt){StandaloneServices.get(IStandaloneThemeService).defineTheme(ct,nt)}function setTheme(ct){StandaloneServices.get(IStandaloneThemeService).setTheme(ct)}function remeasureFonts(){FontMeasurements.clearAllFontInfos()}function registerCommand$1(ct,nt){return CommandsRegistry.registerCommand({id:ct,handler:nt})}function registerLinkOpener(ct){return StandaloneServices.get(IOpenerService).registerOpener({open(ot){return __awaiter$15(this,void 0,void 0,function*(){return typeof ot=="string"&&(ot=URI.parse(ot)),ct.open(ot)})}})}function registerEditorOpener(ct){return StandaloneServices.get(ICodeEditorService).registerCodeEditorOpenHandler((ot,rt,ut)=>__awaiter$15(this,void 0,void 0,function*(){var gt;if(!rt)return null;const pt=(gt=ot.options)===null||gt===void 0?void 0:gt.selection;let mt;return pt&&typeof pt.endLineNumber=="number"&&typeof pt.endColumn=="number"?mt=pt:pt&&(mt={lineNumber:pt.startLineNumber,column:pt.startColumn}),(yield ct.openCodeEditor(rt,ot.resource,mt))?rt:null}))}function createMonacoEditorAPI(){return{create,getEditors,getDiffEditors,onDidCreateEditor,onDidCreateDiffEditor,createDiffEditor,createDiffNavigator,addCommand,addEditorAction,addKeybindingRule,addKeybindingRules,createModel,setModelLanguage,setModelMarkers,getModelMarkers,removeAllMarkers,onDidChangeMarkers,getModels,getModel,onDidCreateModel,onWillDisposeModel,onDidChangeModelLanguage,createWebWorker,colorizeElement,colorize,colorizeModelLine,tokenize,defineTheme,setTheme,remeasureFonts,registerCommand:registerCommand$1,registerLinkOpener,registerEditorOpener,AccessibilitySupport,ContentWidgetPositionPreference,CursorChangeReason,DefaultEndOfLine,EditorAutoIndentStrategy,EditorOption,EndOfLinePreference,EndOfLineSequence,MinimapPosition:MinimapPosition$1,MouseTargetType,OverlayWidgetPositionPreference,OverviewRulerLane:OverviewRulerLane$1,GlyphMarginLane:GlyphMarginLane$1,RenderLineNumbersType,RenderMinimap,ScrollbarVisibility,ScrollType,TextEditorCursorBlinkingStyle,TextEditorCursorStyle,TrackedRangeStickiness,WrappingIndent,InjectedTextCursorStops:InjectedTextCursorStops$1,PositionAffinity,ConfigurationChangedEvent,BareFontInfo,FontInfo,TextModelResolvedOptions,FindMatch,ApplyUpdateResult,LineRange:LineRange$1,LineRangeMapping,RangeMapping,EditorZoom,EditorType,EditorOptions}}function isArrayOf(ct,nt){if(!nt||!Array.isArray(nt))return!1;for(const ot of nt)if(!ct(ot))return!1;return!0}function bool(ct,nt){return typeof ct=="boolean"?ct:nt}function string(ct,nt){return typeof ct=="string"?ct:nt}function arrayToHash(ct){const nt={};for(const ot of ct)nt[ot]=!0;return nt}function createKeywordMatcher(ct,nt=!1){nt&&(ct=ct.map(function(rt){return rt.toLowerCase()}));const ot=arrayToHash(ct);return nt?function(rt){return ot[rt.toLowerCase()]!==void 0&&ot.hasOwnProperty(rt.toLowerCase())}:function(rt){return ot[rt]!==void 0&&ot.hasOwnProperty(rt)}}function compileRegExp(ct,nt){nt=nt.replace(/@@/g,"");let ot=0,rt;do rt=!1,nt=nt.replace(/@(\w+)/g,function(gt,pt){rt=!0;let mt="";if(typeof ct[pt]=="string")mt=ct[pt];else if(ct[pt]&&ct[pt]instanceof RegExp)mt=ct[pt].source;else throw ct[pt]===void 0?createError(ct,"language definition does not contain attribute '"+pt+"', used at: "+nt):createError(ct,"attribute reference '"+pt+"' must be a string, used at: "+nt);return empty$1(mt)?"":"(?:"+mt+")"}),ot++;while(rt&&ot<5);nt=nt.replace(/\x01/g,"@");const ut=(ct.ignoreCase?"i":"")+(ct.unicode?"u":"");return new RegExp(nt,ut)}function selectScrutinee(ct,nt,ot,rt){if(rt<0)return ct;if(rt<nt.length)return nt[rt];if(rt>=100){rt=rt-100;const ut=ot.split(".");if(ut.unshift(ot),rt<ut.length)return ut[rt]}return null}function createGuard(ct,nt,ot,rt){let ut=-1,gt=ot,pt=ot.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);pt&&(pt[3]&&(ut=parseInt(pt[3]),pt[2]&&(ut=ut+100)),gt=pt[4]);let mt="~",vt=gt;!gt||gt.length===0?(mt="!=",vt=""):/^\w*$/.test(vt)?mt="==":(pt=gt.match(/^(@|!@|~|!~|==|!=)(.*)$/),pt&&(mt=pt[1],vt=pt[2]));let St;if((mt==="~"||mt==="!~")&&/^(\w|\|)*$/.test(vt)){const yt=createKeywordMatcher(vt.split("|"),ct.ignoreCase);St=function(wt){return mt==="~"?yt(wt):!yt(wt)}}else if(mt==="@"||mt==="!@"){const yt=ct[vt];if(!yt)throw createError(ct,"the @ match target '"+vt+"' is not defined, in rule: "+nt);if(!isArrayOf(function(Lt){return typeof Lt=="string"},yt))throw createError(ct,"the @ match target '"+vt+"' must be an array of strings, in rule: "+nt);const wt=createKeywordMatcher(yt,ct.ignoreCase);St=function(Lt){return mt==="@"?wt(Lt):!wt(Lt)}}else if(mt==="~"||mt==="!~")if(vt.indexOf("$")<0){const yt=compileRegExp(ct,"^"+vt+"$");St=function(wt){return mt==="~"?yt.test(wt):!yt.test(wt)}}else St=function(yt,wt,Lt,xt){return compileRegExp(ct,"^"+substituteMatches(ct,vt,wt,Lt,xt)+"$").test(yt)};else if(vt.indexOf("$")<0){const yt=fixCase(ct,vt);St=function(wt){return mt==="=="?wt===yt:wt!==yt}}else{const yt=fixCase(ct,vt);St=function(wt,Lt,xt,It,kt){const At=substituteMatches(ct,yt,Lt,xt,It);return mt==="=="?wt===At:wt!==At}}return ut===-1?{name:ot,value:rt,test:function(yt,wt,Lt,xt){return St(yt,yt,wt,Lt,xt)}}:{name:ot,value:rt,test:function(yt,wt,Lt,xt){const It=selectScrutinee(yt,wt,Lt,ut);return St(It||"",yt,wt,Lt,xt)}}}function compileAction(ct,nt,ot){if(ot){if(typeof ot=="string")return ot;if(ot.token||ot.token===""){if(typeof ot.token!="string")throw createError(ct,"a 'token' attribute must be of type string, in rule: "+nt);{const rt={token:ot.token};if(ot.token.indexOf("$")>=0&&(rt.tokenSubst=!0),typeof ot.bracket=="string")if(ot.bracket==="@open")rt.bracket=1;else if(ot.bracket==="@close")rt.bracket=-1;else throw createError(ct,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+nt);if(ot.next){if(typeof ot.next!="string")throw createError(ct,"the next state must be a string value in rule: "+nt);{let ut=ot.next;if(!/^(@pop|@push|@popall)$/.test(ut)&&(ut[0]==="@"&&(ut=ut.substr(1)),ut.indexOf("$")<0&&!stateExists(ct,substituteMatches(ct,ut,"",[],""))))throw createError(ct,"the next state '"+ot.next+"' is not defined in rule: "+nt);rt.next=ut}}return typeof ot.goBack=="number"&&(rt.goBack=ot.goBack),typeof ot.switchTo=="string"&&(rt.switchTo=ot.switchTo),typeof ot.log=="string"&&(rt.log=ot.log),typeof ot.nextEmbedded=="string"&&(rt.nextEmbedded=ot.nextEmbedded,ct.usesEmbedded=!0),rt}}else if(Array.isArray(ot)){const rt=[];for(let ut=0,gt=ot.length;ut<gt;ut++)rt[ut]=compileAction(ct,nt,ot[ut]);return{group:rt}}else if(ot.cases){const rt=[];for(const gt in ot.cases)if(ot.cases.hasOwnProperty(gt)){const pt=compileAction(ct,nt,ot.cases[gt]);gt==="@default"||gt==="@"||gt===""?rt.push({test:void 0,value:pt,name:gt}):gt==="@eos"?rt.push({test:function(mt,vt,St,yt){return yt},value:pt,name:gt}):rt.push(createGuard(ct,nt,gt,pt))}const ut=ct.defaultToken;return{test:function(gt,pt,mt,vt){for(const St of rt)if(!St.test||St.test(gt,pt,mt,vt))return St.value;return ut}}}else throw createError(ct,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+nt)}else return{token:""}}class Rule{constructor(nt){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=nt}setRegex(nt,ot){let rt;if(typeof ot=="string")rt=ot;else if(ot instanceof RegExp)rt=ot.source;else throw createError(nt,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=rt.length>0&&rt[0]==="^",this.name=this.name+": "+rt,this.regex=compileRegExp(nt,"^(?:"+(this.matchOnlyAtLineStart?rt.substr(1):rt)+")")}setAction(nt,ot){this.action=compileAction(nt,this.name,ot)}}function compile(ct,nt){if(!nt||typeof nt!="object")throw new Error("Monarch: expecting a language definition object");const ot={};ot.languageId=ct,ot.includeLF=bool(nt.includeLF,!1),ot.noThrow=!1,ot.maxStack=100,ot.start=typeof nt.start=="string"?nt.start:null,ot.ignoreCase=bool(nt.ignoreCase,!1),ot.unicode=bool(nt.unicode,!1),ot.tokenPostfix=string(nt.tokenPostfix,"."+ot.languageId),ot.defaultToken=string(nt.defaultToken,"source"),ot.usesEmbedded=!1;const rt=nt;rt.languageId=ct,rt.includeLF=ot.includeLF,rt.ignoreCase=ot.ignoreCase,rt.unicode=ot.unicode,rt.noThrow=ot.noThrow,rt.usesEmbedded=ot.usesEmbedded,rt.stateNames=nt.tokenizer,rt.defaultToken=ot.defaultToken;function ut(pt,mt,vt){for(const St of vt){let yt=St.include;if(yt){if(typeof yt!="string")throw createError(ot,"an 'include' attribute must be a string at: "+pt);if(yt[0]==="@"&&(yt=yt.substr(1)),!nt.tokenizer[yt])throw createError(ot,"include target '"+yt+"' is not defined at: "+pt);ut(pt+"."+yt,mt,nt.tokenizer[yt])}else{const wt=new Rule(pt);if(Array.isArray(St)&&St.length>=1&&St.length<=3)if(wt.setRegex(rt,St[0]),St.length>=3)if(typeof St[1]=="string")wt.setAction(rt,{token:St[1],next:St[2]});else if(typeof St[1]=="object"){const Lt=St[1];Lt.next=St[2],wt.setAction(rt,Lt)}else throw createError(ot,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+pt);else wt.setAction(rt,St[1]);else{if(!St.regex)throw createError(ot,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+pt);St.name&&typeof St.name=="string"&&(wt.name=St.name),St.matchOnlyAtStart&&(wt.matchOnlyAtLineStart=bool(St.matchOnlyAtLineStart,!1)),wt.setRegex(rt,St.regex),wt.setAction(rt,St.action)}mt.push(wt)}}}if(!nt.tokenizer||typeof nt.tokenizer!="object")throw createError(ot,"a language definition must define the 'tokenizer' attribute as an object");ot.tokenizer=[];for(const pt in nt.tokenizer)if(nt.tokenizer.hasOwnProperty(pt)){ot.start||(ot.start=pt);const mt=nt.tokenizer[pt];ot.tokenizer[pt]=new Array,ut("tokenizer."+pt,ot.tokenizer[pt],mt)}if(ot.usesEmbedded=rt.usesEmbedded,nt.brackets){if(!Array.isArray(nt.brackets))throw createError(ot,"the 'brackets' attribute must be defined as an array")}else nt.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const gt=[];for(const pt of nt.brackets){let mt=pt;if(mt&&Array.isArray(mt)&&mt.length===3&&(mt={token:mt[2],open:mt[0],close:mt[1]}),mt.open===mt.close)throw createError(ot,"open and close brackets in a 'brackets' attribute must be different: "+mt.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof mt.open=="string"&&typeof mt.token=="string"&&typeof mt.close=="string")gt.push({token:mt.token+ot.tokenPostfix,open:fixCase(ot,mt.open),close:fixCase(ot,mt.close)});else throw createError(ot,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return ot.brackets=gt,ot.noThrow=!0,ot}var __awaiter$14=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function register(ct){ModesRegistry.registerLanguage(ct)}function getLanguages(){let ct=[];return ct=ct.concat(ModesRegistry.getLanguages()),ct}function getEncodedLanguageId(ct){return StandaloneServices.get(ILanguageService).languageIdCodec.encodeLanguageId(ct)}function onLanguage(ct,nt){const rt=StandaloneServices.get(ILanguageService).onDidRequestRichLanguageFeatures(ut=>{ut===ct&&(rt.dispose(),nt())});return rt}function onLanguageEncountered(ct,nt){const rt=StandaloneServices.get(ILanguageService).onDidRequestBasicLanguageFeatures(ut=>{ut===ct&&(rt.dispose(),nt())});return rt}function setLanguageConfiguration(ct,nt){if(!StandaloneServices.get(ILanguageService).isRegisteredLanguageId(ct))throw new Error(`Cannot set configuration for unknown language ${ct}`);return StandaloneServices.get(ILanguageConfigurationService).register(ct,nt,100)}class EncodedTokenizationSupportAdapter{constructor(nt,ot){this._languageId=nt,this._actual=ot}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(nt,ot,rt){if(typeof this._actual.tokenize=="function")return TokenizationSupportAdapter.adaptTokenize(this._languageId,this._actual,nt,rt);throw new Error("Not supported!")}tokenizeEncoded(nt,ot,rt){const ut=this._actual.tokenizeEncoded(nt,rt);return new EncodedTokenizationResult(ut.tokens,ut.endState)}}class TokenizationSupportAdapter{constructor(nt,ot,rt,ut){this._languageId=nt,this._actual=ot,this._languageService=rt,this._standaloneThemeService=ut}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(nt,ot){const rt=[];let ut=0;for(let gt=0,pt=nt.length;gt<pt;gt++){const mt=nt[gt];let vt=mt.startIndex;gt===0?vt=0:vt<ut&&(vt=ut),rt[gt]=new Token$2(vt,mt.scopes,ot),ut=vt}return rt}static adaptTokenize(nt,ot,rt,ut){const gt=ot.tokenize(rt,ut),pt=TokenizationSupportAdapter._toClassicTokens(gt.tokens,nt);let mt;return gt.endState.equals(ut)?mt=ut:mt=gt.endState,new TokenizationResult(pt,mt)}tokenize(nt,ot,rt){return TokenizationSupportAdapter.adaptTokenize(this._languageId,this._actual,nt,rt)}_toBinaryTokens(nt,ot){const rt=nt.encodeLanguageId(this._languageId),ut=this._standaloneThemeService.getColorTheme().tokenTheme,gt=[];let pt=0,mt=0;for(let St=0,yt=ot.length;St<yt;St++){const wt=ot[St],Lt=ut.match(rt,wt.scopes)|1024;if(pt>0&&gt[pt-1]===Lt)continue;let xt=wt.startIndex;St===0?xt=0:xt<mt&&(xt=mt),gt[pt++]=xt,gt[pt++]=Lt,mt=xt}const vt=new Uint32Array(pt);for(let St=0;St<pt;St++)vt[St]=gt[St];return vt}tokenizeEncoded(nt,ot,rt){const ut=this._actual.tokenize(nt,rt),gt=this._toBinaryTokens(this._languageService.languageIdCodec,ut.tokens);let pt;return ut.endState.equals(rt)?pt=rt:pt=ut.endState,new EncodedTokenizationResult(gt,pt)}}function isATokensProvider(ct){return typeof ct.getInitialState=="function"}function isEncodedTokensProvider(ct){return"tokenizeEncoded"in ct}function isThenable(ct){return ct&&typeof ct.then=="function"}function setColorMap(ct){const nt=StandaloneServices.get(IStandaloneThemeService);if(ct){const ot=[null];for(let rt=1,ut=ct.length;rt<ut;rt++)ot[rt]=Color.fromHex(ct[rt]);nt.setColorMapOverride(ot)}else nt.setColorMapOverride(null)}function createTokenizationSupportAdapter(ct,nt){return isEncodedTokensProvider(nt)?new EncodedTokenizationSupportAdapter(ct,nt):new TokenizationSupportAdapter(ct,nt,StandaloneServices.get(ILanguageService),StandaloneServices.get(IStandaloneThemeService))}function registerTokensProviderFactory(ct,nt){const ot=new LazyTokenizationSupport(()=>__awaiter$14(this,void 0,void 0,function*(){const rt=yield Promise.resolve(nt.create());return rt?isATokensProvider(rt)?createTokenizationSupportAdapter(ct,rt):new MonarchTokenizer(StandaloneServices.get(ILanguageService),StandaloneServices.get(IStandaloneThemeService),ct,compile(ct,rt),StandaloneServices.get(IConfigurationService)):null}));return TokenizationRegistry.registerFactory(ct,ot)}function setTokensProvider(ct,nt){if(!StandaloneServices.get(ILanguageService).isRegisteredLanguageId(ct))throw new Error(`Cannot set tokens provider for unknown language ${ct}`);return isThenable(nt)?registerTokensProviderFactory(ct,{create:()=>nt}):TokenizationRegistry.register(ct,createTokenizationSupportAdapter(ct,nt))}function setMonarchTokensProvider(ct,nt){const ot=rt=>new MonarchTokenizer(StandaloneServices.get(ILanguageService),StandaloneServices.get(IStandaloneThemeService),ct,compile(ct,rt),StandaloneServices.get(IConfigurationService));return isThenable(nt)?registerTokensProviderFactory(ct,{create:()=>nt}):TokenizationRegistry.register(ct,ot(nt))}function registerReferenceProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).referenceProvider.register(ct,nt)}function registerRenameProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).renameProvider.register(ct,nt)}function registerSignatureHelpProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).signatureHelpProvider.register(ct,nt)}function registerHoverProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).hoverProvider.register(ct,{provideHover:(rt,ut,gt)=>{const pt=rt.getWordAtPosition(ut);return Promise.resolve(nt.provideHover(rt,ut,gt)).then(mt=>{if(mt)return!mt.range&&pt&&(mt.range=new Range$2(ut.lineNumber,pt.startColumn,ut.lineNumber,pt.endColumn)),mt.range||(mt.range=new Range$2(ut.lineNumber,ut.column,ut.lineNumber,ut.column)),mt})}})}function registerDocumentSymbolProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).documentSymbolProvider.register(ct,nt)}function registerDocumentHighlightProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).documentHighlightProvider.register(ct,nt)}function registerLinkedEditingRangeProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).linkedEditingRangeProvider.register(ct,nt)}function registerDefinitionProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).definitionProvider.register(ct,nt)}function registerImplementationProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).implementationProvider.register(ct,nt)}function registerTypeDefinitionProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).typeDefinitionProvider.register(ct,nt)}function registerCodeLensProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).codeLensProvider.register(ct,nt)}function registerCodeActionProvider(ct,nt,ot){return StandaloneServices.get(ILanguageFeaturesService).codeActionProvider.register(ct,{providedCodeActionKinds:ot==null?void 0:ot.providedCodeActionKinds,documentation:ot==null?void 0:ot.documentation,provideCodeActions:(ut,gt,pt,mt)=>{const St=StandaloneServices.get(IMarkerService).read({resource:ut.uri}).filter(yt=>Range$2.areIntersectingOrTouching(yt,gt));return nt.provideCodeActions(ut,gt,{markers:St,only:pt.only,trigger:pt.trigger},mt)},resolveCodeAction:nt.resolveCodeAction})}function registerDocumentFormattingEditProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).documentFormattingEditProvider.register(ct,nt)}function registerDocumentRangeFormattingEditProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).documentRangeFormattingEditProvider.register(ct,nt)}function registerOnTypeFormattingEditProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).onTypeFormattingEditProvider.register(ct,nt)}function registerLinkProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).linkProvider.register(ct,nt)}function registerCompletionItemProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).completionProvider.register(ct,nt)}function registerColorProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).colorProvider.register(ct,nt)}function registerFoldingRangeProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).foldingRangeProvider.register(ct,nt)}function registerDeclarationProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).declarationProvider.register(ct,nt)}function registerSelectionRangeProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).selectionRangeProvider.register(ct,nt)}function registerDocumentSemanticTokensProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).documentSemanticTokensProvider.register(ct,nt)}function registerDocumentRangeSemanticTokensProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).documentRangeSemanticTokensProvider.register(ct,nt)}function registerInlineCompletionsProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).inlineCompletionsProvider.register(ct,nt)}function registerInlayHintsProvider(ct,nt){return StandaloneServices.get(ILanguageFeaturesService).inlayHintsProvider.register(ct,nt)}function createMonacoLanguagesAPI(){return{register,getLanguages,onLanguage,onLanguageEncountered,getEncodedLanguageId,setLanguageConfiguration,setColorMap,registerTokensProviderFactory,setTokensProvider,setMonarchTokensProvider,registerReferenceProvider,registerRenameProvider,registerCompletionItemProvider,registerSignatureHelpProvider,registerHoverProvider,registerDocumentSymbolProvider,registerDocumentHighlightProvider,registerLinkedEditingRangeProvider,registerDefinitionProvider,registerImplementationProvider,registerTypeDefinitionProvider,registerCodeLensProvider,registerCodeActionProvider,registerDocumentFormattingEditProvider,registerDocumentRangeFormattingEditProvider,registerOnTypeFormattingEditProvider,registerLinkProvider,registerColorProvider,registerFoldingRangeProvider,registerDeclarationProvider,registerSelectionRangeProvider,registerDocumentSemanticTokensProvider,registerDocumentRangeSemanticTokensProvider,registerInlineCompletionsProvider,registerInlayHintsProvider,DocumentHighlightKind,CompletionItemKind,CompletionItemTag,CompletionItemInsertTextRule,SymbolKind,SymbolTag,IndentAction:IndentAction$1,CompletionTriggerKind,SignatureHelpTriggerKind,InlayHintKind,InlineCompletionTriggerKind,CodeActionTriggerType,FoldingRangeKind,SelectedSuggestionInfo}}const IEditorCancellationTokens=createDecorator("IEditorCancelService"),ctxCancellableOperation=new RawContextKey("cancellableOperation",!1,localize("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));registerSingleton(IEditorCancellationTokens,class{constructor(){this._tokens=new WeakMap}add(ct,nt){let ot=this._tokens.get(ct);ot||(ot=ct.invokeWithinContext(ut=>{const gt=ctxCancellableOperation.bindTo(ut.get(IContextKeyService)),pt=new LinkedList;return{key:gt,tokens:pt}}),this._tokens.set(ct,ot));let rt;return ot.key.set(!0),rt=ot.tokens.push(nt),()=>{rt&&(rt(),ot.key.set(!ot.tokens.isEmpty()),rt=void 0)}}cancel(ct){const nt=this._tokens.get(ct);if(!nt)return;const ot=nt.tokens.pop();ot&&(ot.cancel(),nt.key.set(!nt.tokens.isEmpty()))}},1);class EditorKeybindingCancellationTokenSource extends CancellationTokenSource$1{constructor(nt,ot){super(ot),this.editor=nt,this._unregister=nt.invokeWithinContext(rt=>rt.get(IEditorCancellationTokens).add(nt,this))}dispose(){this._unregister(),super.dispose()}}registerEditorCommand(new class extends EditorCommand{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:ctxCancellableOperation})}runEditorCommand(ct,nt){ct.get(IEditorCancellationTokens).cancel(nt)}});let EditorState$1=class Uo{constructor(nt,ot){if(this.flags=ot,this.flags&1){const rt=nt.getModel();this.modelVersionId=rt?format("{0}#{1}",rt.uri.toString(),rt.getVersionId()):null}else this.modelVersionId=null;this.flags&4?this.position=nt.getPosition():this.position=null,this.flags&2?this.selection=nt.getSelection():this.selection=null,this.flags&8?(this.scrollLeft=nt.getScrollLeft(),this.scrollTop=nt.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(nt){if(!(nt instanceof Uo))return!1;const ot=nt;return!(this.modelVersionId!==ot.modelVersionId||this.scrollLeft!==ot.scrollLeft||this.scrollTop!==ot.scrollTop||!this.position&&ot.position||this.position&&!ot.position||this.position&&ot.position&&!this.position.equals(ot.position)||!this.selection&&ot.selection||this.selection&&!ot.selection||this.selection&&ot.selection&&!this.selection.equalsRange(ot.selection))}validate(nt){return this._equals(new Uo(nt,this.flags))}};class EditorStateCancellationTokenSource extends EditorKeybindingCancellationTokenSource{constructor(nt,ot,rt,ut){super(nt,ut),this._listener=new DisposableStore,ot&4&&this._listener.add(nt.onDidChangeCursorPosition(gt=>{(!rt||!Range$2.containsPosition(rt,gt.position))&&this.cancel()})),ot&2&&this._listener.add(nt.onDidChangeCursorSelection(gt=>{(!rt||!Range$2.containsRange(rt,gt.selection))&&this.cancel()})),ot&8&&this._listener.add(nt.onDidScrollChange(gt=>this.cancel())),ot&1&&(this._listener.add(nt.onDidChangeModel(gt=>this.cancel())),this._listener.add(nt.onDidChangeModelContent(gt=>this.cancel())))}dispose(){this._listener.dispose(),super.dispose()}}class TextModelCancellationTokenSource extends CancellationTokenSource$1{constructor(nt,ot){super(ot),this._listener=nt.onDidChangeContent(()=>this.cancel())}dispose(){this._listener.dispose(),super.dispose()}}function isCodeEditor(ct){return ct&&typeof ct.getEditorType=="function"?ct.getEditorType()===EditorType.ICodeEditor:!1}function isDiffEditor(ct){return ct&&typeof ct.getEditorType=="function"?ct.getEditorType()===EditorType.IDiffEditor:!1}function isCompositeEditor(ct){return!!ct&&typeof ct=="object"&&typeof ct.onDidChangeActiveEditor=="function"}function getCodeEditor(ct){return isCodeEditor(ct)?ct:isDiffEditor(ct)?ct.getModifiedEditor():isCompositeEditor(ct)&&isCodeEditor(ct.activeCodeEditor)?ct.activeCodeEditor:null}class FormattingEdit{static _handleEolEdits(nt,ot){let rt;const ut=[];for(const gt of ot)typeof gt.eol=="number"&&(rt=gt.eol),gt.range&&typeof gt.text=="string"&&ut.push(gt);return typeof rt=="number"&&nt.hasModel()&&nt.getModel().pushEOL(rt),ut}static _isFullModelReplaceEdit(nt,ot){if(!nt.hasModel())return!1;const rt=nt.getModel(),ut=rt.validateRange(ot.range);return rt.getFullModelRange().equalsRange(ut)}static execute(nt,ot,rt){rt&&nt.pushUndoStop();const ut=StableEditorScrollState.capture(nt),gt=FormattingEdit._handleEolEdits(nt,ot);gt.length===1&&FormattingEdit._isFullModelReplaceEdit(nt,gt[0])?nt.executeEdits("formatEditsCommand",gt.map(pt=>EditOperation.replace(Range$2.lift(pt.range),pt.text))):nt.executeEdits("formatEditsCommand",gt.map(pt=>EditOperation.replaceMove(Range$2.lift(pt.range),pt.text))),rt&&nt.pushUndoStop(),ut.restoreRelativeVerticalPositionOfCursor(nt)}}class ExtensionIdentifier{constructor(nt){this.value=nt,this._lower=nt.toLowerCase()}static toKey(nt){return typeof nt=="string"?nt.toLowerCase():nt._lower}}class ExtensionIdentifierSet{constructor(nt){if(this._set=new Set,nt)for(const ot of nt)this.add(ot)}add(nt){this._set.add(ExtensionIdentifier.toKey(nt))}has(nt){return this._set.has(ExtensionIdentifier.toKey(nt))}}var __awaiter$13=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function alertFormattingEdits(ct){if(ct=ct.filter(ut=>ut.range),!ct.length)return;let{range:nt}=ct[0];for(let ut=1;ut<ct.length;ut++)nt=Range$2.plusRange(nt,ct[ut].range);const{startLineNumber:ot,endLineNumber:rt}=nt;ot===rt?ct.length===1?alert(localize("hint11","Made 1 formatting edit on line {0}",ot)):alert(localize("hintn1","Made {0} formatting edits on line {1}",ct.length,ot)):ct.length===1?alert(localize("hint1n","Made 1 formatting edit between lines {0} and {1}",ot,rt)):alert(localize("hintnn","Made {0} formatting edits between lines {1} and {2}",ct.length,ot,rt))}function getRealAndSyntheticDocumentFormattersOrdered(ct,nt,ot){const rt=[],ut=new ExtensionIdentifierSet,gt=ct.ordered(ot);for(const mt of gt)rt.push(mt),mt.extensionId&&ut.add(mt.extensionId);const pt=nt.ordered(ot);for(const mt of pt){if(mt.extensionId){if(ut.has(mt.extensionId))continue;ut.add(mt.extensionId)}rt.push({displayName:mt.displayName,extensionId:mt.extensionId,provideDocumentFormattingEdits(vt,St,yt){return mt.provideDocumentRangeFormattingEdits(vt,vt.getFullModelRange(),St,yt)}})}return rt}class FormattingConflicts{static setFormatterSelector(nt){return{dispose:FormattingConflicts._selectors.unshift(nt)}}static select(nt,ot,rt){return __awaiter$13(this,void 0,void 0,function*(){if(nt.length===0)return;const ut=Iterable.first(FormattingConflicts._selectors);if(ut)return yield ut(nt,ot,rt)})}}FormattingConflicts._selectors=new LinkedList;function formatDocumentRangesWithSelectedProvider(ct,nt,ot,rt,ut,gt){return __awaiter$13(this,void 0,void 0,function*(){const pt=ct.get(IInstantiationService),{documentRangeFormattingEditProvider:mt}=ct.get(ILanguageFeaturesService),vt=isCodeEditor(nt)?nt.getModel():nt,St=mt.ordered(vt),yt=yield FormattingConflicts.select(St,vt,rt);yt&&(ut.report(yt),yield pt.invokeFunction(formatDocumentRangesWithProvider,yt,nt,ot,gt))})}function formatDocumentRangesWithProvider(ct,nt,ot,rt,ut){var gt,pt;return __awaiter$13(this,void 0,void 0,function*(){const mt=ct.get(IEditorWorkerService),vt=ct.get(ILogService);let St,yt;isCodeEditor(ot)?(St=ot.getModel(),yt=new EditorStateCancellationTokenSource(ot,5,void 0,ut)):(St=ot,yt=new TextModelCancellationTokenSource(ot,ut));const wt=[];let Lt=0;for(const Tt of asArray(rt).sort(Range$2.compareRangesUsingStarts))Lt>0&&Range$2.areIntersectingOrTouching(wt[Lt-1],Tt)?wt[Lt-1]=Range$2.fromPositions(wt[Lt-1].getStartPosition(),Tt.getEndPosition()):Lt=wt.push(Tt);const xt=Tt=>__awaiter$13(this,void 0,void 0,function*(){var Rt,Nt;vt.trace("[format][provideDocumentRangeFormattingEdits] (request)",(Rt=nt.extensionId)===null||Rt===void 0?void 0:Rt.value,Tt);const Pt=(yield nt.provideDocumentRangeFormattingEdits(St,Tt,St.getFormattingOptions(),yt.token))||[];return vt.trace("[format][provideDocumentRangeFormattingEdits] (response)",(Nt=nt.extensionId)===null||Nt===void 0?void 0:Nt.value,Pt),Pt}),It=(Tt,Rt)=>{if(!Tt.length||!Rt.length)return!1;const Nt=Tt.reduce((Pt,Ft)=>Range$2.plusRange(Pt,Ft.range),Tt[0].range);if(!Rt.some(Pt=>Range$2.intersectRanges(Nt,Pt.range)))return!1;for(const Pt of Tt)for(const Ft of Rt)if(Range$2.intersectRanges(Pt.range,Ft.range))return!0;return!1},kt=[],At=[];try{if(typeof nt.provideDocumentRangesFormattingEdits=="function"){vt.trace("[format][provideDocumentRangeFormattingEdits] (request)",(gt=nt.extensionId)===null||gt===void 0?void 0:gt.value,wt);const Tt=(yield nt.provideDocumentRangesFormattingEdits(St,wt,St.getFormattingOptions(),yt.token))||[];vt.trace("[format][provideDocumentRangeFormattingEdits] (response)",(pt=nt.extensionId)===null||pt===void 0?void 0:pt.value,Tt),At.push(Tt)}else{for(const Tt of wt){if(yt.token.isCancellationRequested)return!0;At.push(yield xt(Tt))}for(let Tt=0;Tt<wt.length;++Tt)for(let Rt=Tt+1;Rt<wt.length;++Rt){if(yt.token.isCancellationRequested)return!0;if(It(At[Tt],At[Rt])){const Nt=Range$2.plusRange(wt[Tt],wt[Rt]),Pt=yield xt(Nt);wt.splice(Rt,1),wt.splice(Tt,1),wt.push(Nt),At.splice(Rt,1),At.splice(Tt,1),At.push(Pt),Tt=0,Rt=0}}}for(const Tt of At){if(yt.token.isCancellationRequested)return!0;const Rt=yield mt.computeMoreMinimalEdits(St.uri,Tt);Rt&&kt.push(...Rt)}}finally{yt.dispose()}if(kt.length===0)return!1;if(isCodeEditor(ot))FormattingEdit.execute(ot,kt,!0),alertFormattingEdits(kt),ot.revealPositionInCenterIfOutsideViewport(ot.getPosition(),1);else{const[{range:Tt}]=kt,Rt=new Selection$1(Tt.startLineNumber,Tt.startColumn,Tt.endLineNumber,Tt.endColumn);St.pushEditOperations([Rt],kt.map(Nt=>({text:Nt.text,range:Range$2.lift(Nt.range),forceMoveMarkers:!0})),Nt=>{for(const{range:Pt}of Nt)if(Range$2.areIntersectingOrTouching(Pt,Rt))return[new Selection$1(Pt.startLineNumber,Pt.startColumn,Pt.endLineNumber,Pt.endColumn)];return null})}return!0})}function formatDocumentWithSelectedProvider(ct,nt,ot,rt,ut){return __awaiter$13(this,void 0,void 0,function*(){const gt=ct.get(IInstantiationService),pt=ct.get(ILanguageFeaturesService),mt=isCodeEditor(nt)?nt.getModel():nt,vt=getRealAndSyntheticDocumentFormattersOrdered(pt.documentFormattingEditProvider,pt.documentRangeFormattingEditProvider,mt),St=yield FormattingConflicts.select(vt,mt,ot);St&&(rt.report(St),yield gt.invokeFunction(formatDocumentWithProvider,St,nt,ot,ut))})}function formatDocumentWithProvider(ct,nt,ot,rt,ut){return __awaiter$13(this,void 0,void 0,function*(){const gt=ct.get(IEditorWorkerService);let pt,mt;isCodeEditor(ot)?(pt=ot.getModel(),mt=new EditorStateCancellationTokenSource(ot,5,void 0,ut)):(pt=ot,mt=new TextModelCancellationTokenSource(ot,ut));let vt;try{const St=yield nt.provideDocumentFormattingEdits(pt,pt.getFormattingOptions(),mt.token);if(vt=yield gt.computeMoreMinimalEdits(pt.uri,St),mt.token.isCancellationRequested)return!0}finally{mt.dispose()}if(!vt||vt.length===0)return!1;if(isCodeEditor(ot))FormattingEdit.execute(ot,vt,rt!==2),rt!==2&&(alertFormattingEdits(vt),ot.revealPositionInCenterIfOutsideViewport(ot.getPosition(),1));else{const[{range:St}]=vt,yt=new Selection$1(St.startLineNumber,St.startColumn,St.endLineNumber,St.endColumn);pt.pushEditOperations([yt],vt.map(wt=>({text:wt.text,range:Range$2.lift(wt.range),forceMoveMarkers:!0})),wt=>{for(const{range:Lt}of wt)if(Range$2.areIntersectingOrTouching(Lt,yt))return[new Selection$1(Lt.startLineNumber,Lt.startColumn,Lt.endLineNumber,Lt.endColumn)];return null})}return!0})}function getDocumentRangeFormattingEditsUntilResult(ct,nt,ot,rt,ut,gt){return __awaiter$13(this,void 0,void 0,function*(){const pt=nt.documentRangeFormattingEditProvider.ordered(ot);for(const mt of pt){const vt=yield Promise.resolve(mt.provideDocumentRangeFormattingEdits(ot,rt,ut,gt)).catch(onUnexpectedExternalError);if(isNonEmptyArray(vt))return yield ct.computeMoreMinimalEdits(ot.uri,vt)}})}function getDocumentFormattingEditsUntilResult(ct,nt,ot,rt,ut){return __awaiter$13(this,void 0,void 0,function*(){const gt=getRealAndSyntheticDocumentFormattersOrdered(nt.documentFormattingEditProvider,nt.documentRangeFormattingEditProvider,ot);for(const pt of gt){const mt=yield Promise.resolve(pt.provideDocumentFormattingEdits(ot,rt,ut)).catch(onUnexpectedExternalError);if(isNonEmptyArray(mt))return yield ct.computeMoreMinimalEdits(ot.uri,mt)}})}function getOnTypeFormattingEdits(ct,nt,ot,rt,ut,gt,pt){const mt=nt.onTypeFormattingEditProvider.ordered(ot);return mt.length===0||mt[0].autoFormatTriggerCharacters.indexOf(ut)<0?Promise.resolve(void 0):Promise.resolve(mt[0].provideOnTypeFormattingEdits(ot,rt,ut,gt,pt)).catch(onUnexpectedExternalError).then(vt=>ct.computeMoreMinimalEdits(ot.uri,vt))}CommandsRegistry.registerCommand("_executeFormatRangeProvider",function(ct,...nt){return __awaiter$13(this,void 0,void 0,function*(){const[ot,rt,ut]=nt;assertType(URI.isUri(ot)),assertType(Range$2.isIRange(rt));const gt=ct.get(ITextModelService),pt=ct.get(IEditorWorkerService),mt=ct.get(ILanguageFeaturesService),vt=yield gt.createModelReference(ot);try{return getDocumentRangeFormattingEditsUntilResult(pt,mt,vt.object.textEditorModel,Range$2.lift(rt),ut,CancellationToken.None)}finally{vt.dispose()}})});CommandsRegistry.registerCommand("_executeFormatDocumentProvider",function(ct,...nt){return __awaiter$13(this,void 0,void 0,function*(){const[ot,rt]=nt;assertType(URI.isUri(ot));const ut=ct.get(ITextModelService),gt=ct.get(IEditorWorkerService),pt=ct.get(ILanguageFeaturesService),mt=yield ut.createModelReference(ot);try{return getDocumentFormattingEditsUntilResult(gt,pt,mt.object.textEditorModel,rt,CancellationToken.None)}finally{mt.dispose()}})});CommandsRegistry.registerCommand("_executeFormatOnTypeProvider",function(ct,...nt){return __awaiter$13(this,void 0,void 0,function*(){const[ot,rt,ut,gt]=nt;assertType(URI.isUri(ot)),assertType(Position$1.isIPosition(rt)),assertType(typeof ut=="string");const pt=ct.get(ITextModelService),mt=ct.get(IEditorWorkerService),vt=ct.get(ILanguageFeaturesService),St=yield pt.createModelReference(ot);try{return getOnTypeFormattingEdits(mt,vt,St.object.textEditorModel,Position$1.lift(rt),ut,gt,CancellationToken.None)}finally{St.dispose()}})});EditorOptions.wrappingIndent.defaultValue=0;EditorOptions.glyphMargin.defaultValue=!1;EditorOptions.autoIndent.defaultValue=3;EditorOptions.overviewRulerLanes.defaultValue=2;FormattingConflicts.setFormatterSelector((ct,nt,ot)=>Promise.resolve(ct[0]));const api=createMonacoBaseAPI();api.editor=createMonacoEditorAPI();api.languages=createMonacoLanguagesAPI();const CancellationTokenSource=api.CancellationTokenSource,Emitter$1=api.Emitter,KeyCode=api.KeyCode,KeyMod=api.KeyMod,Position=api.Position,Range=api.Range,Selection=api.Selection,SelectionDirection=api.SelectionDirection,MarkerSeverity=api.MarkerSeverity,MarkerTag=api.MarkerTag,Uri=api.Uri,Token=api.Token,editor=api.editor,languages=api.languages,monacoEnvironment=globalThis.MonacoEnvironment;(monacoEnvironment!=null&&monacoEnvironment.globalAPI||typeof define=="function"&&define.amd)&&(globalThis.monaco=api);typeof globalThis.require<"u"&&typeof globalThis.require.config=="function"&&globalThis.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const monaco_editor_core_star=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource,Emitter:Emitter$1,KeyCode,KeyMod,MarkerSeverity,MarkerTag,Position,Range,Selection,SelectionDirection,Token,Uri,editor,languages},Symbol.toStringTag,{value:"Module"})),scriptRel="modulepreload",assetsURL=function(ct){return"/"+ct},seen={},__vitePreload=function(nt,ot,rt){if(!ot||ot.length===0)return nt();const ut=document.getElementsByTagName("link");return Promise.all(ot.map(gt=>{if(gt=assetsURL(gt),gt in seen)return;seen[gt]=!0;const pt=gt.endsWith(".css"),mt=pt?'[rel="stylesheet"]':"";if(!!rt)for(let yt=ut.length-1;yt>=0;yt--){const wt=ut[yt];if(wt.href===gt&&(!pt||wt.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${gt}"]${mt}`))return;const St=document.createElement("link");if(St.rel=pt?"stylesheet":scriptRel,pt||(St.as="script",St.crossOrigin=""),St.href=gt,document.head.appendChild(St),pt)return new Promise((yt,wt)=>{St.addEventListener("load",yt),St.addEventListener("error",()=>wt(new Error(`Unable to preload CSS for ${gt}`)))})})).then(()=>nt())};/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.38.0(0e330ae453813de4e6cf272460fb79c7117073d0)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var __defProp$4=Object.defineProperty,__getOwnPropDesc$4=Object.getOwnPropertyDescriptor,__getOwnPropNames$4=Object.getOwnPropertyNames,__hasOwnProp$4=Object.prototype.hasOwnProperty,__copyProps$4=(ct,nt,ot,rt)=>{if(nt&&typeof nt=="object"||typeof nt=="function")for(let ut of __getOwnPropNames$4(nt))!__hasOwnProp$4.call(ct,ut)&&ut!==ot&&__defProp$4(ct,ut,{get:()=>nt[ut],enumerable:!(rt=__getOwnPropDesc$4(nt,ut))||rt.enumerable});return ct},__reExport$4=(ct,nt,ot)=>(__copyProps$4(ct,nt,"default"),ot&&__copyProps$4(ot,nt,"default")),monaco_editor_core_exports$4={};__reExport$4(monaco_editor_core_exports$4,monaco_editor_core_star);var languageDefinitions={},lazyLanguageLoaders={},LazyLanguageLoader=class{constructor(ct){$n(this,"_languageId");$n(this,"_loadingTriggered");$n(this,"_lazyLoadPromise");$n(this,"_lazyLoadPromiseResolve");$n(this,"_lazyLoadPromiseReject");this._languageId=ct,this._loadingTriggered=!1,this._lazyLoadPromise=new Promise((nt,ot)=>{this._lazyLoadPromiseResolve=nt,this._lazyLoadPromiseReject=ot})}static getOrCreate(ct){return lazyLanguageLoaders[ct]||(lazyLanguageLoaders[ct]=new LazyLanguageLoader(ct)),lazyLanguageLoaders[ct]}load(){return this._loadingTriggered||(this._loadingTriggered=!0,languageDefinitions[this._languageId].loader().then(ct=>this._lazyLoadPromiseResolve(ct),ct=>this._lazyLoadPromiseReject(ct))),this._lazyLoadPromise}};function registerLanguage(ct){const nt=ct.id;languageDefinitions[nt]=ct,monaco_editor_core_exports$4.languages.register(ct);const ot=LazyLanguageLoader.getOrCreate(nt);monaco_editor_core_exports$4.languages.registerTokensProviderFactory(nt,{create:async()=>(await ot.load()).language}),monaco_editor_core_exports$4.languages.onLanguageEncountered(nt,async()=>{const rt=await ot.load();monaco_editor_core_exports$4.languages.setLanguageConfiguration(nt,rt.conf)})}registerLanguage({id:"abap",extensions:[".abap"],aliases:["abap","ABAP"],loader:()=>__vitePreload(()=>import("./abap-b1ef16d9.js"),[])});registerLanguage({id:"apex",extensions:[".cls"],aliases:["Apex","apex"],mimetypes:["text/x-apex-source","text/x-apex"],loader:()=>__vitePreload(()=>import("./apex-cfc8f5f9.js"),[])});registerLanguage({id:"azcli",extensions:[".azcli"],aliases:["Azure CLI","azcli"],loader:()=>__vitePreload(()=>import("./azcli-3065b420.js"),[])});registerLanguage({id:"bat",extensions:[".bat",".cmd"],aliases:["Batch","bat"],loader:()=>__vitePreload(()=>import("./bat-49811178.js"),[])});registerLanguage({id:"bicep",extensions:[".bicep"],aliases:["Bicep"],loader:()=>__vitePreload(()=>import("./bicep-8839222a.js"),[])});registerLanguage({id:"cameligo",extensions:[".mligo"],aliases:["Cameligo"],loader:()=>__vitePreload(()=>import("./cameligo-00c3a1ec.js"),[])});registerLanguage({id:"clojure",extensions:[".clj",".cljs",".cljc",".edn"],aliases:["clojure","Clojure"],loader:()=>__vitePreload(()=>import("./clojure-5ec8141f.js"),[])});registerLanguage({id:"coffeescript",extensions:[".coffee"],aliases:["CoffeeScript","coffeescript","coffee"],mimetypes:["text/x-coffeescript","text/coffeescript"],loader:()=>__vitePreload(()=>import("./coffee-f5637df1.js"),[])});registerLanguage({id:"c",extensions:[".c",".h"],aliases:["C","c"],loader:()=>__vitePreload(()=>import("./cpp-3eb1409c.js"),[])});registerLanguage({id:"cpp",extensions:[".cpp",".cc",".cxx",".hpp",".hh",".hxx"],aliases:["C++","Cpp","cpp"],loader:()=>__vitePreload(()=>import("./cpp-3eb1409c.js"),[])});registerLanguage({id:"csharp",extensions:[".cs",".csx",".cake"],aliases:["C#","csharp"],loader:()=>__vitePreload(()=>import("./csharp-e152e032.js"),[])});registerLanguage({id:"csp",extensions:[],aliases:["CSP","csp"],loader:()=>__vitePreload(()=>import("./csp-bcd686a9.js"),[])});registerLanguage({id:"css",extensions:[".css"],aliases:["CSS","css"],mimetypes:["text/css"],loader:()=>__vitePreload(()=>import("./css-2c363889.js"),[])});registerLanguage({id:"cypher",extensions:[".cypher",".cyp"],aliases:["Cypher","OpenCypher"],loader:()=>__vitePreload(()=>import("./cypher-c8c514a1.js"),[])});registerLanguage({id:"dart",extensions:[".dart"],aliases:["Dart","dart"],mimetypes:["text/x-dart-source","text/x-dart"],loader:()=>__vitePreload(()=>import("./dart-20b7370c.js"),[])});registerLanguage({id:"dockerfile",extensions:[".dockerfile"],filenames:["Dockerfile"],aliases:["Dockerfile"],loader:()=>__vitePreload(()=>import("./dockerfile-3862148c.js"),[])});registerLanguage({id:"ecl",extensions:[".ecl"],aliases:["ECL","Ecl","ecl"],loader:()=>__vitePreload(()=>import("./ecl-4151d6b3.js"),[])});registerLanguage({id:"elixir",extensions:[".ex",".exs"],aliases:["Elixir","elixir","ex"],loader:()=>__vitePreload(()=>import("./elixir-93db603e.js"),[])});registerLanguage({id:"flow9",extensions:[".flow"],aliases:["Flow9","Flow","flow9","flow"],loader:()=>__vitePreload(()=>import("./flow9-dd227f65.js"),[])});registerLanguage({id:"fsharp",extensions:[".fs",".fsi",".ml",".mli",".fsx",".fsscript"],aliases:["F#","FSharp","fsharp"],loader:()=>__vitePreload(()=>import("./fsharp-86578ff6.js"),[])});registerLanguage({id:"freemarker2",extensions:[".ftl",".ftlh",".ftlx"],aliases:["FreeMarker2","Apache FreeMarker2"],loader:()=>__vitePreload(()=>import("./freemarker2-7a00ff37.js"),[]).then(ct=>ct.TagAutoInterpolationDollar)});registerLanguage({id:"freemarker2.tag-angle.interpolation-dollar",aliases:["FreeMarker2 (Angle/Dollar)","Apache FreeMarker2 (Angle/Dollar)"],loader:()=>__vitePreload(()=>import("./freemarker2-7a00ff37.js"),[]).then(ct=>ct.TagAngleInterpolationDollar)});registerLanguage({id:"freemarker2.tag-bracket.interpolation-dollar",aliases:["FreeMarker2 (Bracket/Dollar)","Apache FreeMarker2 (Bracket/Dollar)"],loader:()=>__vitePreload(()=>import("./freemarker2-7a00ff37.js"),[]).then(ct=>ct.TagBracketInterpolationDollar)});registerLanguage({id:"freemarker2.tag-angle.interpolation-bracket",aliases:["FreeMarker2 (Angle/Bracket)","Apache FreeMarker2 (Angle/Bracket)"],loader:()=>__vitePreload(()=>import("./freemarker2-7a00ff37.js"),[]).then(ct=>ct.TagAngleInterpolationBracket)});registerLanguage({id:"freemarker2.tag-bracket.interpolation-bracket",aliases:["FreeMarker2 (Bracket/Bracket)","Apache FreeMarker2 (Bracket/Bracket)"],loader:()=>__vitePreload(()=>import("./freemarker2-7a00ff37.js"),[]).then(ct=>ct.TagBracketInterpolationBracket)});registerLanguage({id:"freemarker2.tag-auto.interpolation-dollar",aliases:["FreeMarker2 (Auto/Dollar)","Apache FreeMarker2 (Auto/Dollar)"],loader:()=>__vitePreload(()=>import("./freemarker2-7a00ff37.js"),[]).then(ct=>ct.TagAutoInterpolationDollar)});registerLanguage({id:"freemarker2.tag-auto.interpolation-bracket",aliases:["FreeMarker2 (Auto/Bracket)","Apache FreeMarker2 (Auto/Bracket)"],loader:()=>__vitePreload(()=>import("./freemarker2-7a00ff37.js"),[]).then(ct=>ct.TagAutoInterpolationBracket)});registerLanguage({id:"go",extensions:[".go"],aliases:["Go"],loader:()=>__vitePreload(()=>import("./go-7384bc86.js"),[])});registerLanguage({id:"graphql",extensions:[".graphql",".gql"],aliases:["GraphQL","graphql","gql"],mimetypes:["application/graphql"],loader:()=>__vitePreload(()=>import("./graphql-fa9affca.js"),[])});registerLanguage({id:"handlebars",extensions:[".handlebars",".hbs"],aliases:["Handlebars","handlebars","hbs"],mimetypes:["text/x-handlebars-template"],loader:()=>__vitePreload(()=>import("./handlebars-51486c17.js"),[])});registerLanguage({id:"hcl",extensions:[".tf",".tfvars",".hcl"],aliases:["Terraform","tf","HCL","hcl"],loader:()=>__vitePreload(()=>import("./hcl-b8ae35e9.js"),[])});registerLanguage({id:"html",extensions:[".html",".htm",".shtml",".xhtml",".mdoc",".jsp",".asp",".aspx",".jshtm"],aliases:["HTML","htm","html","xhtml"],mimetypes:["text/html","text/x-jshtm","text/template","text/ng-template"],loader:()=>__vitePreload(()=>import("./html-1c9d66d2.js"),[])});registerLanguage({id:"ini",extensions:[".ini",".properties",".gitconfig"],filenames:["config",".gitattributes",".gitconfig",".editorconfig"],aliases:["Ini","ini"],loader:()=>__vitePreload(()=>import("./ini-890acc80.js"),[])});registerLanguage({id:"java",extensions:[".java",".jav"],aliases:["Java","java"],mimetypes:["text/x-java-source","text/x-java"],loader:()=>__vitePreload(()=>import("./java-049a60a4.js"),[])});registerLanguage({id:"javascript",extensions:[".js",".es6",".jsx",".mjs",".cjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:()=>__vitePreload(()=>import("./javascript-5c0f8a3a.js"),["assets/javascript-5c0f8a3a.js","assets/typescript-0fe88053.js"])});registerLanguage({id:"julia",extensions:[".jl"],aliases:["julia","Julia"],loader:()=>__vitePreload(()=>import("./julia-191b0a82.js"),[])});registerLanguage({id:"kotlin",extensions:[".kt",".kts"],aliases:["Kotlin","kotlin"],mimetypes:["text/x-kotlin-source","text/x-kotlin"],loader:()=>__vitePreload(()=>import("./kotlin-e9db0c5a.js"),[])});registerLanguage({id:"less",extensions:[".less"],aliases:["Less","less"],mimetypes:["text/x-less","text/less"],loader:()=>__vitePreload(()=>import("./less-ba21524a.js"),[])});registerLanguage({id:"lexon",extensions:[".lex"],aliases:["Lexon"],loader:()=>__vitePreload(()=>import("./lexon-9ea3fed0.js"),[])});registerLanguage({id:"lua",extensions:[".lua"],aliases:["Lua","lua"],loader:()=>__vitePreload(()=>import("./lua-33bafe35.js"),[])});registerLanguage({id:"liquid",extensions:[".liquid",".html.liquid"],aliases:["Liquid","liquid"],mimetypes:["application/liquid"],loader:()=>__vitePreload(()=>import("./liquid-f67e03c3.js"),[])});registerLanguage({id:"m3",extensions:[".m3",".i3",".mg",".ig"],aliases:["Modula-3","Modula3","modula3","m3"],loader:()=>__vitePreload(()=>import("./m3-1d7365f7.js"),[])});registerLanguage({id:"markdown",extensions:[".md",".markdown",".mdown",".mkdn",".mkd",".mdwn",".mdtxt",".mdtext"],aliases:["Markdown","markdown"],loader:()=>__vitePreload(()=>import("./markdown-eaf1630d.js"),[])});registerLanguage({id:"mips",extensions:[".s"],aliases:["MIPS","MIPS-V"],mimetypes:["text/x-mips","text/mips","text/plaintext"],loader:()=>__vitePreload(()=>import("./mips-178efc05.js"),[])});registerLanguage({id:"msdax",extensions:[".dax",".msdax"],aliases:["DAX","MSDAX"],loader:()=>__vitePreload(()=>import("./msdax-d7ff9ae6.js"),[])});registerLanguage({id:"mysql",extensions:[],aliases:["MySQL","mysql"],loader:()=>__vitePreload(()=>import("./mysql-9dbe03dd.js"),[])});registerLanguage({id:"objective-c",extensions:[".m"],aliases:["Objective-C"],loader:()=>__vitePreload(()=>import("./objective-c-23977cd5.js"),[])});registerLanguage({id:"pascal",extensions:[".pas",".p",".pp"],aliases:["Pascal","pas"],mimetypes:["text/x-pascal-source","text/x-pascal"],loader:()=>__vitePreload(()=>import("./pascal-347ec7c4.js"),[])});registerLanguage({id:"pascaligo",extensions:[".ligo"],aliases:["Pascaligo","ligo"],loader:()=>__vitePreload(()=>import("./pascaligo-fb1e63fa.js"),[])});registerLanguage({id:"perl",extensions:[".pl",".pm"],aliases:["Perl","pl"],loader:()=>__vitePreload(()=>import("./perl-2fa94092.js"),[])});registerLanguage({id:"pgsql",extensions:[],aliases:["PostgreSQL","postgres","pg","postgre"],loader:()=>__vitePreload(()=>import("./pgsql-1d172e37.js"),[])});registerLanguage({id:"php",extensions:[".php",".php4",".php5",".phtml",".ctp"],aliases:["PHP","php"],mimetypes:["application/x-php"],loader:()=>__vitePreload(()=>import("./php-f4bc522d.js"),[])});registerLanguage({id:"pla",extensions:[".pla"],loader:()=>__vitePreload(()=>import("./pla-d1f69c74.js"),[])});registerLanguage({id:"postiats",extensions:[".dats",".sats",".hats"],aliases:["ATS","ATS/Postiats"],loader:()=>__vitePreload(()=>import("./postiats-8d97b332.js"),[])});registerLanguage({id:"powerquery",extensions:[".pq",".pqm"],aliases:["PQ","M","Power Query","Power Query M"],loader:()=>__vitePreload(()=>import("./powerquery-e21c5cbe.js"),[])});registerLanguage({id:"powershell",extensions:[".ps1",".psm1",".psd1"],aliases:["PowerShell","powershell","ps","ps1"],loader:()=>__vitePreload(()=>import("./powershell-d0a72f46.js"),[])});registerLanguage({id:"proto",extensions:[".proto"],aliases:["protobuf","Protocol Buffers"],loader:()=>__vitePreload(()=>import("./protobuf-b2d1908d.js"),[])});registerLanguage({id:"pug",extensions:[".jade",".pug"],aliases:["Pug","Jade","jade"],loader:()=>__vitePreload(()=>import("./pug-49898a0c.js"),[])});registerLanguage({id:"python",extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi"],aliases:["Python","py"],firstLine:"^#!/.*\\bpython[0-9.-]*\\b",loader:()=>__vitePreload(()=>import("./python-f0652e40.js"),[])});registerLanguage({id:"qsharp",extensions:[".qs"],aliases:["Q#","qsharp"],loader:()=>__vitePreload(()=>import("./qsharp-23f836f6.js"),[])});registerLanguage({id:"r",extensions:[".r",".rhistory",".rmd",".rprofile",".rt"],aliases:["R","r"],loader:()=>__vitePreload(()=>import("./r-0e40c708.js"),[])});registerLanguage({id:"razor",extensions:[".cshtml"],aliases:["Razor","razor"],mimetypes:["text/x-cshtml"],loader:()=>__vitePreload(()=>import("./razor-c375bbfa.js"),[])});registerLanguage({id:"redis",extensions:[".redis"],aliases:["redis"],loader:()=>__vitePreload(()=>import("./redis-12380799.js"),[])});registerLanguage({id:"redshift",extensions:[],aliases:["Redshift","redshift"],loader:()=>__vitePreload(()=>import("./redshift-b3d29d59.js"),[])});registerLanguage({id:"restructuredtext",extensions:[".rst"],aliases:["reStructuredText","restructuredtext"],loader:()=>__vitePreload(()=>import("./restructuredtext-c082bb1f.js"),[])});registerLanguage({id:"ruby",extensions:[".rb",".rbx",".rjs",".gemspec",".pp"],filenames:["rakefile","Gemfile"],aliases:["Ruby","rb"],loader:()=>__vitePreload(()=>import("./ruby-60abc7e3.js"),[])});registerLanguage({id:"rust",extensions:[".rs",".rlib"],aliases:["Rust","rust"],loader:()=>__vitePreload(()=>import("./rust-5082ca98.js"),[])});registerLanguage({id:"sb",extensions:[".sb"],aliases:["Small Basic","sb"],loader:()=>__vitePreload(()=>import("./sb-aa16a8ad.js"),[])});registerLanguage({id:"scala",extensions:[".scala",".sc",".sbt"],aliases:["Scala","scala","SBT","Sbt","sbt","Dotty","dotty"],mimetypes:["text/x-scala-source","text/x-scala","text/x-sbt","text/x-dotty"],loader:()=>__vitePreload(()=>import("./scala-5ccbc32b.js"),[])});registerLanguage({id:"scheme",extensions:[".scm",".ss",".sch",".rkt"],aliases:["scheme","Scheme"],loader:()=>__vitePreload(()=>import("./scheme-28488157.js"),[])});registerLanguage({id:"scss",extensions:[".scss"],aliases:["Sass","sass","scss"],mimetypes:["text/x-scss","text/scss"],loader:()=>__vitePreload(()=>import("./scss-7398ee1f.js"),[])});registerLanguage({id:"shell",extensions:[".sh",".bash"],aliases:["Shell","sh"],loader:()=>__vitePreload(()=>import("./shell-98094e4a.js"),[])});registerLanguage({id:"sol",extensions:[".sol"],aliases:["sol","solidity","Solidity"],loader:()=>__vitePreload(()=>import("./solidity-0e63250a.js"),[])});registerLanguage({id:"aes",extensions:[".aes"],aliases:["aes","sophia","Sophia"],loader:()=>__vitePreload(()=>import("./sophia-e9f55b13.js"),[])});registerLanguage({id:"sparql",extensions:[".rq"],aliases:["sparql","SPARQL"],loader:()=>__vitePreload(()=>import("./sparql-a1a1d9ea.js"),[])});registerLanguage({id:"sql",extensions:[".sql"],aliases:["SQL"],loader:()=>__vitePreload(()=>import("./sql-d85b307f.js"),[])});registerLanguage({id:"st",extensions:[".st",".iecst",".iecplc",".lc3lib"],aliases:["StructuredText","scl","stl"],loader:()=>__vitePreload(()=>import("./st-db5fc7d7.js"),[])});registerLanguage({id:"swift",aliases:["Swift","swift"],extensions:[".swift"],mimetypes:["text/swift"],loader:()=>__vitePreload(()=>import("./swift-8a14485e.js"),[])});registerLanguage({id:"systemverilog",extensions:[".sv",".svh"],aliases:["SV","sv","SystemVerilog","systemverilog"],loader:()=>__vitePreload(()=>import("./systemverilog-2a70b217.js"),[])});registerLanguage({id:"verilog",extensions:[".v",".vh"],aliases:["V","v","Verilog","verilog"],loader:()=>__vitePreload(()=>import("./systemverilog-2a70b217.js"),[])});registerLanguage({id:"tcl",extensions:[".tcl"],aliases:["tcl","Tcl","tcltk","TclTk","tcl/tk","Tcl/Tk"],loader:()=>__vitePreload(()=>import("./tcl-7e0fc706.js"),[])});registerLanguage({id:"twig",extensions:[".twig"],aliases:["Twig","twig"],mimetypes:["text/x-twig"],loader:()=>__vitePreload(()=>import("./twig-19bf3459.js"),[])});registerLanguage({id:"typescript",extensions:[".ts",".tsx",".cts",".mts"],aliases:["TypeScript","ts","typescript"],mimetypes:["text/typescript"],loader:()=>__vitePreload(()=>import("./typescript-0fe88053.js"),[])});registerLanguage({id:"vb",extensions:[".vb"],aliases:["Visual Basic","vb"],loader:()=>__vitePreload(()=>import("./vb-0af9cc51.js"),[])});registerLanguage({id:"wgsl",extensions:[".wgsl"],aliases:["WebGPU Shading Language","WGSL","wgsl"],loader:()=>__vitePreload(()=>import("./wgsl-1cc19b4d.js"),[])});registerLanguage({id:"xml",extensions:[".xml",".xsd",".dtd",".ascx",".csproj",".config",".props",".targets",".wxi",".wxl",".wxs",".xaml",".svg",".svgz",".opf",".xslt",".xsl"],firstLine:"(\\<\\?xml.*)|(\\<svg)|(\\<\\!doctype\\s+svg)",aliases:["XML","xml"],mimetypes:["text/xml","application/xml","application/xaml+xml","application/xml-dtd"],loader:()=>__vitePreload(()=>import("./xml-5f0c0ac6.js"),[])});registerLanguage({id:"yaml",extensions:[".yaml",".yml"],aliases:["YAML","yaml","YML","yml"],mimetypes:["application/x-yaml","text/x-yaml"],loader:()=>__vitePreload(()=>import("./yaml-052c68ee.js"),[])});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.38.0(0e330ae453813de4e6cf272460fb79c7117073d0)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var __defProp$3=Object.defineProperty,__getOwnPropDesc$3=Object.getOwnPropertyDescriptor,__getOwnPropNames$3=Object.getOwnPropertyNames,__hasOwnProp$3=Object.prototype.hasOwnProperty,__copyProps$3=(ct,nt,ot,rt)=>{if(nt&&typeof nt=="object"||typeof nt=="function")for(let ut of __getOwnPropNames$3(nt))!__hasOwnProp$3.call(ct,ut)&&ut!==ot&&__defProp$3(ct,ut,{get:()=>nt[ut],enumerable:!(rt=__getOwnPropDesc$3(nt,ut))||rt.enumerable});return ct},__reExport$3=(ct,nt,ot)=>(__copyProps$3(ct,nt,"default"),ot&&__copyProps$3(ot,nt,"default")),monaco_editor_core_exports$3={};__reExport$3(monaco_editor_core_exports$3,monaco_editor_core_star);var LanguageServiceDefaultsImpl$3=class{constructor(nt,ot,rt){$n(this,"_onDidChange",new monaco_editor_core_exports$3.Emitter);$n(this,"_options");$n(this,"_modeConfiguration");$n(this,"_languageId");this._languageId=nt,this.setOptions(ot),this.setModeConfiguration(rt)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this.options}get options(){return this._options}setOptions(nt){this._options=nt||Object.create(null),this._onDidChange.fire(this)}setDiagnosticsOptions(nt){this.setOptions(nt)}setModeConfiguration(nt){this._modeConfiguration=nt||Object.create(null),this._onDidChange.fire(this)}},optionsDefault$1={validate:!0,lint:{compatibleVendorPrefixes:"ignore",vendorPrefix:"warning",duplicateProperties:"warning",emptyRules:"warning",importStatement:"ignore",boxModel:"ignore",universalSelector:"ignore",zeroUnits:"ignore",fontFaceProperties:"warning",hexColorLength:"error",argumentsInColorFunction:"error",unknownProperties:"warning",ieHack:"ignore",unknownVendorSpecificProperties:"ignore",propertyIgnoredDueToDisplay:"warning",important:"ignore",float:"ignore",idSelector:"ignore"},data:{useDefaultDataProvider:!0},format:{newlineBetweenSelectors:!0,newlineBetweenRules:!0,spaceAroundSelectorSeparator:!1,braceStyle:"collapse",maxPreserveNewLines:void 0,preserveNewLines:!0}},modeConfigurationDefault$2={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0,documentFormattingEdits:!0,documentRangeFormattingEdits:!0},cssDefaults=new LanguageServiceDefaultsImpl$3("css",optionsDefault$1,modeConfigurationDefault$2),scssDefaults=new LanguageServiceDefaultsImpl$3("scss",optionsDefault$1,modeConfigurationDefault$2),lessDefaults=new LanguageServiceDefaultsImpl$3("less",optionsDefault$1,modeConfigurationDefault$2);monaco_editor_core_exports$3.languages.css={cssDefaults,lessDefaults,scssDefaults};function getMode$3(){return __vitePreload(()=>import("./cssMode-28c859b9.js"),[])}monaco_editor_core_exports$3.languages.onLanguage("less",()=>{getMode$3().then(ct=>ct.setupMode(lessDefaults))});monaco_editor_core_exports$3.languages.onLanguage("scss",()=>{getMode$3().then(ct=>ct.setupMode(scssDefaults))});monaco_editor_core_exports$3.languages.onLanguage("css",()=>{getMode$3().then(ct=>ct.setupMode(cssDefaults))});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.38.0(0e330ae453813de4e6cf272460fb79c7117073d0)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var __defProp$2=Object.defineProperty,__getOwnPropDesc$2=Object.getOwnPropertyDescriptor,__getOwnPropNames$2=Object.getOwnPropertyNames,__hasOwnProp$2=Object.prototype.hasOwnProperty,__copyProps$2=(ct,nt,ot,rt)=>{if(nt&&typeof nt=="object"||typeof nt=="function")for(let ut of __getOwnPropNames$2(nt))!__hasOwnProp$2.call(ct,ut)&&ut!==ot&&__defProp$2(ct,ut,{get:()=>nt[ut],enumerable:!(rt=__getOwnPropDesc$2(nt,ut))||rt.enumerable});return ct},__reExport$2=(ct,nt,ot)=>(__copyProps$2(ct,nt,"default"),ot&&__copyProps$2(ot,nt,"default")),monaco_editor_core_exports$2={};__reExport$2(monaco_editor_core_exports$2,monaco_editor_core_star);var LanguageServiceDefaultsImpl$2=class{constructor(nt,ot,rt){$n(this,"_onDidChange",new monaco_editor_core_exports$2.Emitter);$n(this,"_options");$n(this,"_modeConfiguration");$n(this,"_languageId");this._languageId=nt,this.setOptions(ot),this.setModeConfiguration(rt)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get options(){return this._options}get modeConfiguration(){return this._modeConfiguration}setOptions(nt){this._options=nt||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(nt){this._modeConfiguration=nt||Object.create(null),this._onDidChange.fire(this)}},formatDefaults={tabSize:4,insertSpaces:!1,wrapLineLength:120,unformatted:'default": "a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',contentUnformatted:"pre",indentInnerHtml:!1,preserveNewLines:!0,maxPreserveNewLines:void 0,indentHandlebars:!1,endWithNewline:!1,extraLiners:"head, body, /html",wrapAttributes:"auto"},optionsDefault={format:formatDefaults,suggest:{},data:{useDefaultDataProvider:!0}};function getConfigurationDefault(ct){return{completionItems:!0,hovers:!0,documentSymbols:!0,links:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,selectionRanges:!0,diagnostics:ct===htmlLanguageId,documentFormattingEdits:ct===htmlLanguageId,documentRangeFormattingEdits:ct===htmlLanguageId}}var htmlLanguageId="html",handlebarsLanguageId="handlebars",razorLanguageId="razor",htmlLanguageService=registerHTMLLanguageService(htmlLanguageId,optionsDefault,getConfigurationDefault(htmlLanguageId)),htmlDefaults=htmlLanguageService.defaults,handlebarLanguageService=registerHTMLLanguageService(handlebarsLanguageId,optionsDefault,getConfigurationDefault(handlebarsLanguageId)),handlebarDefaults=handlebarLanguageService.defaults,razorLanguageService=registerHTMLLanguageService(razorLanguageId,optionsDefault,getConfigurationDefault(razorLanguageId)),razorDefaults=razorLanguageService.defaults;monaco_editor_core_exports$2.languages.html={htmlDefaults,razorDefaults,handlebarDefaults,htmlLanguageService,handlebarLanguageService,razorLanguageService,registerHTMLLanguageService};function getMode$2(){return __vitePreload(()=>import("./htmlMode-9a691705.js"),[])}function registerHTMLLanguageService(ct,nt=optionsDefault,ot=getConfigurationDefault(ct)){const rt=new LanguageServiceDefaultsImpl$2(ct,nt,ot);let ut;const gt=monaco_editor_core_exports$2.languages.onLanguage(ct,async()=>{ut=(await getMode$2()).setupMode(rt)});return{defaults:rt,dispose(){gt.dispose(),ut==null||ut.dispose(),ut=void 0}}}/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.38.0(0e330ae453813de4e6cf272460fb79c7117073d0)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var __defProp$1=Object.defineProperty,__getOwnPropDesc$1=Object.getOwnPropertyDescriptor,__getOwnPropNames$1=Object.getOwnPropertyNames,__hasOwnProp$1=Object.prototype.hasOwnProperty,__copyProps$1=(ct,nt,ot,rt)=>{if(nt&&typeof nt=="object"||typeof nt=="function")for(let ut of __getOwnPropNames$1(nt))!__hasOwnProp$1.call(ct,ut)&&ut!==ot&&__defProp$1(ct,ut,{get:()=>nt[ut],enumerable:!(rt=__getOwnPropDesc$1(nt,ut))||rt.enumerable});return ct},__reExport$1=(ct,nt,ot)=>(__copyProps$1(ct,nt,"default"),ot&&__copyProps$1(ot,nt,"default")),monaco_editor_core_exports$1={};__reExport$1(monaco_editor_core_exports$1,monaco_editor_core_star);var LanguageServiceDefaultsImpl$1=class{constructor(nt,ot,rt){$n(this,"_onDidChange",new monaco_editor_core_exports$1.Emitter);$n(this,"_diagnosticsOptions");$n(this,"_modeConfiguration");$n(this,"_languageId");this._languageId=nt,this.setDiagnosticsOptions(ot),this.setModeConfiguration(rt)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(nt){this._diagnosticsOptions=nt||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(nt){this._modeConfiguration=nt||Object.create(null),this._onDidChange.fire(this)}},diagnosticDefault={validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning",comments:"error",trailingCommas:"error"},modeConfigurationDefault$1={documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},jsonDefaults=new LanguageServiceDefaultsImpl$1("json",diagnosticDefault,modeConfigurationDefault$1);monaco_editor_core_exports$1.languages.json={jsonDefaults};function getMode$1(){return __vitePreload(()=>import("./jsonMode-5f2bb771.js"),[])}monaco_editor_core_exports$1.languages.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]});monaco_editor_core_exports$1.languages.onLanguage("json",()=>{getMode$1().then(ct=>ct.setupMode(jsonDefaults))});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.38.0(0e330ae453813de4e6cf272460fb79c7117073d0)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__copyProps=(ct,nt,ot,rt)=>{if(nt&&typeof nt=="object"||typeof nt=="function")for(let ut of __getOwnPropNames(nt))!__hasOwnProp.call(ct,ut)&&ut!==ot&&__defProp(ct,ut,{get:()=>nt[ut],enumerable:!(rt=__getOwnPropDesc(nt,ut))||rt.enumerable});return ct},__reExport=(ct,nt,ot)=>(__copyProps(ct,nt,"default"),ot&&__copyProps(ot,nt,"default")),typescriptVersion="5.0.2",monaco_editor_core_exports={};__reExport(monaco_editor_core_exports,monaco_editor_core_star);var ModuleKind=(ct=>(ct[ct.None=0]="None",ct[ct.CommonJS=1]="CommonJS",ct[ct.AMD=2]="AMD",ct[ct.UMD=3]="UMD",ct[ct.System=4]="System",ct[ct.ES2015=5]="ES2015",ct[ct.ESNext=99]="ESNext",ct))(ModuleKind||{}),JsxEmit=(ct=>(ct[ct.None=0]="None",ct[ct.Preserve=1]="Preserve",ct[ct.React=2]="React",ct[ct.ReactNative=3]="ReactNative",ct[ct.ReactJSX=4]="ReactJSX",ct[ct.ReactJSXDev=5]="ReactJSXDev",ct))(JsxEmit||{}),NewLineKind=(ct=>(ct[ct.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",ct[ct.LineFeed=1]="LineFeed",ct))(NewLineKind||{}),ScriptTarget=(ct=>(ct[ct.ES3=0]="ES3",ct[ct.ES5=1]="ES5",ct[ct.ES2015=2]="ES2015",ct[ct.ES2016=3]="ES2016",ct[ct.ES2017=4]="ES2017",ct[ct.ES2018=5]="ES2018",ct[ct.ES2019=6]="ES2019",ct[ct.ES2020=7]="ES2020",ct[ct.ESNext=99]="ESNext",ct[ct.JSON=100]="JSON",ct[ct.Latest=99]="Latest",ct))(ScriptTarget||{}),ModuleResolutionKind=(ct=>(ct[ct.Classic=1]="Classic",ct[ct.NodeJs=2]="NodeJs",ct))(ModuleResolutionKind||{}),LanguageServiceDefaultsImpl=class{constructor(ct,nt,ot,rt,ut){$n(this,"_onDidChange",new monaco_editor_core_exports.Emitter);$n(this,"_onDidExtraLibsChange",new monaco_editor_core_exports.Emitter);$n(this,"_extraLibs");$n(this,"_removedExtraLibs");$n(this,"_eagerModelSync");$n(this,"_compilerOptions");$n(this,"_diagnosticsOptions");$n(this,"_workerOptions");$n(this,"_onDidExtraLibsChangeTimeout");$n(this,"_inlayHintsOptions");$n(this,"_modeConfiguration");this._extraLibs=Object.create(null),this._removedExtraLibs=Object.create(null),this._eagerModelSync=!1,this.setCompilerOptions(ct),this.setDiagnosticsOptions(nt),this.setWorkerOptions(ot),this.setInlayHintsOptions(rt),this.setModeConfiguration(ut),this._onDidExtraLibsChangeTimeout=-1}get onDidChange(){return this._onDidChange.event}get onDidExtraLibsChange(){return this._onDidExtraLibsChange.event}get modeConfiguration(){return this._modeConfiguration}get workerOptions(){return this._workerOptions}get inlayHintsOptions(){return this._inlayHintsOptions}getExtraLibs(){return this._extraLibs}addExtraLib(ct,nt){let ot;if(typeof nt>"u"?ot=`ts:extralib-${Math.random().toString(36).substring(2,15)}`:ot=nt,this._extraLibs[ot]&&this._extraLibs[ot].content===ct)return{dispose:()=>{}};let rt=1;return this._removedExtraLibs[ot]&&(rt=this._removedExtraLibs[ot]+1),this._extraLibs[ot]&&(rt=this._extraLibs[ot].version+1),this._extraLibs[ot]={content:ct,version:rt},this._fireOnDidExtraLibsChangeSoon(),{dispose:()=>{let ut=this._extraLibs[ot];ut&&ut.version===rt&&(delete this._extraLibs[ot],this._removedExtraLibs[ot]=rt,this._fireOnDidExtraLibsChangeSoon())}}}setExtraLibs(ct){for(const nt in this._extraLibs)this._removedExtraLibs[nt]=this._extraLibs[nt].version;if(this._extraLibs=Object.create(null),ct&&ct.length>0)for(const nt of ct){const ot=nt.filePath||`ts:extralib-${Math.random().toString(36).substring(2,15)}`,rt=nt.content;let ut=1;this._removedExtraLibs[ot]&&(ut=this._removedExtraLibs[ot]+1),this._extraLibs[ot]={content:rt,version:ut}}this._fireOnDidExtraLibsChangeSoon()}_fireOnDidExtraLibsChangeSoon(){this._onDidExtraLibsChangeTimeout===-1&&(this._onDidExtraLibsChangeTimeout=window.setTimeout(()=>{this._onDidExtraLibsChangeTimeout=-1,this._onDidExtraLibsChange.fire(void 0)},0))}getCompilerOptions(){return this._compilerOptions}setCompilerOptions(ct){this._compilerOptions=ct||Object.create(null),this._onDidChange.fire(void 0)}getDiagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(ct){this._diagnosticsOptions=ct||Object.create(null),this._onDidChange.fire(void 0)}setWorkerOptions(ct){this._workerOptions=ct||Object.create(null),this._onDidChange.fire(void 0)}setInlayHintsOptions(ct){this._inlayHintsOptions=ct||Object.create(null),this._onDidChange.fire(void 0)}setMaximumWorkerIdleTime(ct){}setEagerModelSync(ct){this._eagerModelSync=ct}getEagerModelSync(){return this._eagerModelSync}setModeConfiguration(ct){this._modeConfiguration=ct||Object.create(null),this._onDidChange.fire(void 0)}},typescriptVersion2=typescriptVersion,modeConfigurationDefault={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,diagnostics:!0,documentRangeFormattingEdits:!0,signatureHelp:!0,onTypeFormattingEdits:!0,codeActions:!0,inlayHints:!0},typescriptDefaults=new LanguageServiceDefaultsImpl({allowNonTsExtensions:!0,target:99},{noSemanticValidation:!1,noSyntaxValidation:!1,onlyVisible:!1},{},{},modeConfigurationDefault),javascriptDefaults=new LanguageServiceDefaultsImpl({allowNonTsExtensions:!0,allowJs:!0,target:99},{noSemanticValidation:!0,noSyntaxValidation:!1,onlyVisible:!1},{},{},modeConfigurationDefault),getTypeScriptWorker=()=>getMode().then(ct=>ct.getTypeScriptWorker()),getJavaScriptWorker=()=>getMode().then(ct=>ct.getJavaScriptWorker());monaco_editor_core_exports.languages.typescript={ModuleKind,JsxEmit,NewLineKind,ScriptTarget,ModuleResolutionKind,typescriptVersion:typescriptVersion2,typescriptDefaults,javascriptDefaults,getTypeScriptWorker,getJavaScriptWorker};function getMode(){return __vitePreload(()=>import("./tsMode-8cf5d16d.js"),[])}monaco_editor_core_exports.languages.onLanguage("typescript",()=>getMode().then(ct=>ct.setupTypeScript(typescriptDefaults)));monaco_editor_core_exports.languages.onLanguage("javascript",()=>getMode().then(ct=>ct.setupJavaScript(javascriptDefaults)));const anchorSelect="";var __decorate$1r=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1r=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$12=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const SelectionAnchorSet=new RawContextKey("selectionAnchorSet",!1);let SelectionAnchorController=class ar{static get(nt){return nt.getContribution(ar.ID)}constructor(nt,ot){this.editor=nt,this.selectionAnchorSetContextKey=SelectionAnchorSet.bindTo(ot),this.modelChangeListener=nt.onDidChangeModel(()=>this.selectionAnchorSetContextKey.reset())}setSelectionAnchor(){if(this.editor.hasModel()){const nt=this.editor.getPosition();this.editor.changeDecorations(ot=>{this.decorationId&&ot.removeDecoration(this.decorationId),this.decorationId=ot.addDecoration(Selection$1.fromPositions(nt,nt),{description:"selection-anchor",stickiness:1,hoverMessage:new MarkdownString().appendText(localize("selectionAnchor","Selection Anchor")),className:"selection-anchor"})}),this.selectionAnchorSetContextKey.set(!!this.decorationId),alert(localize("anchorSet","Anchor set at {0}:{1}",nt.lineNumber,nt.column))}}goToSelectionAnchor(){if(this.editor.hasModel()&&this.decorationId){const nt=this.editor.getModel().getDecorationRange(this.decorationId);nt&&this.editor.setPosition(nt.getStartPosition())}}selectFromAnchorToCursor(){if(this.editor.hasModel()&&this.decorationId){const nt=this.editor.getModel().getDecorationRange(this.decorationId);if(nt){const ot=this.editor.getPosition();this.editor.setSelection(Selection$1.fromPositions(nt.getStartPosition(),ot)),this.cancelSelectionAnchor()}}}cancelSelectionAnchor(){if(this.decorationId){const nt=this.decorationId;this.editor.changeDecorations(ot=>{ot.removeDecoration(nt),this.decorationId=void 0}),this.selectionAnchorSetContextKey.set(!1)}}dispose(){this.cancelSelectionAnchor(),this.modelChangeListener.dispose()}};SelectionAnchorController.ID="editor.contrib.selectionAnchorController";SelectionAnchorController=__decorate$1r([__param$1r(1,IContextKeyService)],SelectionAnchorController);class SetSelectionAnchor extends EditorAction{constructor(){super({id:"editor.action.setSelectionAnchor",label:localize("setSelectionAnchor","Set Selection Anchor"),alias:"Set Selection Anchor",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2080),weight:100}})}run(nt,ot){var rt;return __awaiter$12(this,void 0,void 0,function*(){(rt=SelectionAnchorController.get(ot))===null||rt===void 0||rt.setSelectionAnchor()})}}class GoToSelectionAnchor extends EditorAction{constructor(){super({id:"editor.action.goToSelectionAnchor",label:localize("goToSelectionAnchor","Go to Selection Anchor"),alias:"Go to Selection Anchor",precondition:SelectionAnchorSet})}run(nt,ot){var rt;return __awaiter$12(this,void 0,void 0,function*(){(rt=SelectionAnchorController.get(ot))===null||rt===void 0||rt.goToSelectionAnchor()})}}class SelectFromAnchorToCursor extends EditorAction{constructor(){super({id:"editor.action.selectFromAnchorToCursor",label:localize("selectFromAnchorToCursor","Select from Anchor to Cursor"),alias:"Select from Anchor to Cursor",precondition:SelectionAnchorSet,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2089),weight:100}})}run(nt,ot){var rt;return __awaiter$12(this,void 0,void 0,function*(){(rt=SelectionAnchorController.get(ot))===null||rt===void 0||rt.selectFromAnchorToCursor()})}}class CancelSelectionAnchor extends EditorAction{constructor(){super({id:"editor.action.cancelSelectionAnchor",label:localize("cancelSelectionAnchor","Cancel Selection Anchor"),alias:"Cancel Selection Anchor",precondition:SelectionAnchorSet,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:9,weight:100}})}run(nt,ot){var rt;return __awaiter$12(this,void 0,void 0,function*(){(rt=SelectionAnchorController.get(ot))===null||rt===void 0||rt.cancelSelectionAnchor()})}}registerEditorContribution(SelectionAnchorController.ID,SelectionAnchorController,4);registerEditorAction(SetSelectionAnchor);registerEditorAction(GoToSelectionAnchor);registerEditorAction(SelectFromAnchorToCursor);registerEditorAction(CancelSelectionAnchor);const bracketMatching="",overviewRulerBracketMatchForeground=registerColor("editorOverviewRuler.bracketMatchForeground",{dark:"#A0A0A0",light:"#A0A0A0",hcDark:"#A0A0A0",hcLight:"#A0A0A0"},localize("overviewRulerBracketMatchForeground","Overview ruler marker color for matching brackets."));class JumpToBracketAction extends EditorAction{constructor(){super({id:"editor.action.jumpToBracket",label:localize("smartSelect.jumpBracket","Go to Bracket"),alias:"Go to Bracket",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3165,weight:100}})}run(nt,ot){var rt;(rt=BracketMatchingController.get(ot))===null||rt===void 0||rt.jumpToBracket()}}class SelectToBracketAction extends EditorAction{constructor(){super({id:"editor.action.selectToBracket",label:localize("smartSelect.selectToBracket","Select to Bracket"),alias:"Select to Bracket",precondition:void 0,description:{description:"Select to Bracket",args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(nt,ot,rt){var ut;let gt=!0;rt&&rt.selectBrackets===!1&&(gt=!1),(ut=BracketMatchingController.get(ot))===null||ut===void 0||ut.selectToBracket(gt)}}class RemoveBracketsAction extends EditorAction{constructor(){super({id:"editor.action.removeBrackets",label:localize("smartSelect.removeBrackets","Remove Brackets"),alias:"Remove Brackets",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2561,weight:100}})}run(nt,ot){var rt;(rt=BracketMatchingController.get(ot))===null||rt===void 0||rt.removeBrackets(this.id)}}class BracketsData{constructor(nt,ot,rt){this.position=nt,this.brackets=ot,this.options=rt}}class BracketMatchingController extends Disposable{static get(nt){return nt.getContribution(BracketMatchingController.ID)}constructor(nt){super(),this._editor=nt,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=this._editor.createDecorationsCollection(),this._updateBracketsSoon=this._register(new RunOnceScheduler(()=>this._updateBrackets(),50)),this._matchBrackets=this._editor.getOption(69),this._updateBracketsSoon.schedule(),this._register(nt.onDidChangeCursorPosition(ot=>{this._matchBrackets!=="never"&&this._updateBracketsSoon.schedule()})),this._register(nt.onDidChangeModelContent(ot=>{this._updateBracketsSoon.schedule()})),this._register(nt.onDidChangeModel(ot=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(nt.onDidChangeModelLanguageConfiguration(ot=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(nt.onDidChangeConfiguration(ot=>{ot.hasChanged(69)&&(this._matchBrackets=this._editor.getOption(69),this._decorations.clear(),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())})),this._register(nt.onDidBlurEditorWidget(()=>{this._updateBracketsSoon.schedule()})),this._register(nt.onDidFocusEditorWidget(()=>{this._updateBracketsSoon.schedule()}))}jumpToBracket(){if(!this._editor.hasModel())return;const nt=this._editor.getModel(),ot=this._editor.getSelections().map(rt=>{const ut=rt.getStartPosition(),gt=nt.bracketPairs.matchBracket(ut);let pt=null;if(gt)gt[0].containsPosition(ut)&&!gt[1].containsPosition(ut)?pt=gt[1].getStartPosition():gt[1].containsPosition(ut)&&(pt=gt[0].getStartPosition());else{const mt=nt.bracketPairs.findEnclosingBrackets(ut);if(mt)pt=mt[1].getStartPosition();else{const vt=nt.bracketPairs.findNextBracket(ut);vt&&vt.range&&(pt=vt.range.getStartPosition())}}return pt?new Selection$1(pt.lineNumber,pt.column,pt.lineNumber,pt.column):new Selection$1(ut.lineNumber,ut.column,ut.lineNumber,ut.column)});this._editor.setSelections(ot),this._editor.revealRange(ot[0])}selectToBracket(nt){if(!this._editor.hasModel())return;const ot=this._editor.getModel(),rt=[];this._editor.getSelections().forEach(ut=>{const gt=ut.getStartPosition();let pt=ot.bracketPairs.matchBracket(gt);if(!pt&&(pt=ot.bracketPairs.findEnclosingBrackets(gt),!pt)){const St=ot.bracketPairs.findNextBracket(gt);St&&St.range&&(pt=ot.bracketPairs.matchBracket(St.range.getStartPosition()))}let mt=null,vt=null;if(pt){pt.sort(Range$2.compareRangesUsingStarts);const[St,yt]=pt;if(mt=nt?St.getStartPosition():St.getEndPosition(),vt=nt?yt.getEndPosition():yt.getStartPosition(),yt.containsPosition(gt)){const wt=mt;mt=vt,vt=wt}}mt&&vt&&rt.push(new Selection$1(mt.lineNumber,mt.column,vt.lineNumber,vt.column))}),rt.length>0&&(this._editor.setSelections(rt),this._editor.revealRange(rt[0]))}removeBrackets(nt){if(!this._editor.hasModel())return;const ot=this._editor.getModel();this._editor.getSelections().forEach(rt=>{const ut=rt.getPosition();let gt=ot.bracketPairs.matchBracket(ut);gt||(gt=ot.bracketPairs.findEnclosingBrackets(ut)),gt&&(this._editor.pushUndoStop(),this._editor.executeEdits(nt,[{range:gt[0],text:""},{range:gt[1],text:""}]),this._editor.pushUndoStop())})}_updateBrackets(){if(this._matchBrackets==="never")return;this._recomputeBrackets();const nt=[];let ot=0;for(const rt of this._lastBracketsData){const ut=rt.brackets;ut&&(nt[ot++]={range:ut[0],options:rt.options},nt[ot++]={range:ut[1],options:rt.options})}this._decorations.set(nt)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus()){this._lastBracketsData=[],this._lastVersionId=0;return}const nt=this._editor.getSelections();if(nt.length>100){this._lastBracketsData=[],this._lastVersionId=0;return}const ot=this._editor.getModel(),rt=ot.getVersionId();let ut=[];this._lastVersionId===rt&&(ut=this._lastBracketsData);const gt=[];let pt=0;for(let wt=0,Lt=nt.length;wt<Lt;wt++){const xt=nt[wt];xt.isEmpty()&&(gt[pt++]=xt.getStartPosition())}gt.length>1&&gt.sort(Position$1.compare);const mt=[];let vt=0,St=0;const yt=ut.length;for(let wt=0,Lt=gt.length;wt<Lt;wt++){const xt=gt[wt];for(;St<yt&&ut[St].position.isBefore(xt);)St++;if(St<yt&&ut[St].position.equals(xt))mt[vt++]=ut[St];else{let It=ot.bracketPairs.matchBracket(xt,20),kt=BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;!It&&this._matchBrackets==="always"&&(It=ot.bracketPairs.findEnclosingBrackets(xt,20),kt=BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),mt[vt++]=new BracketsData(xt,It,kt)}}this._lastBracketsData=mt,this._lastVersionId=rt}}BracketMatchingController.ID="editor.contrib.bracketMatchingController";BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=ModelDecorationOptions.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:themeColorFromId(overviewRulerBracketMatchForeground),position:OverviewRulerLane.Center}});BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=ModelDecorationOptions.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"});registerEditorContribution(BracketMatchingController.ID,BracketMatchingController,1);registerEditorAction(SelectToBracketAction);registerEditorAction(JumpToBracketAction);registerEditorAction(RemoveBracketsAction);MenuRegistry.appendMenuItem(MenuId.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:localize({key:"miGoToBracket",comment:["&& denotes a mnemonic"]},"Go to &&Bracket")},order:2});class MoveCaretCommand{constructor(nt,ot){this._selection=nt,this._isMovingLeft=ot}getEditOperations(nt,ot){if(this._selection.startLineNumber!==this._selection.endLineNumber||this._selection.isEmpty())return;const rt=this._selection.startLineNumber,ut=this._selection.startColumn,gt=this._selection.endColumn;if(!(this._isMovingLeft&&ut===1)&&!(!this._isMovingLeft&&gt===nt.getLineMaxColumn(rt)))if(this._isMovingLeft){const pt=new Range$2(rt,ut-1,rt,ut),mt=nt.getValueInRange(pt);ot.addEditOperation(pt,null),ot.addEditOperation(new Range$2(rt,gt,rt,gt),mt)}else{const pt=new Range$2(rt,gt,rt,gt+1),mt=nt.getValueInRange(pt);ot.addEditOperation(pt,null),ot.addEditOperation(new Range$2(rt,ut,rt,ut),mt)}}computeCursorState(nt,ot){return this._isMovingLeft?new Selection$1(this._selection.startLineNumber,this._selection.startColumn-1,this._selection.endLineNumber,this._selection.endColumn-1):new Selection$1(this._selection.startLineNumber,this._selection.startColumn+1,this._selection.endLineNumber,this._selection.endColumn+1)}}class MoveCaretAction extends EditorAction{constructor(nt,ot){super(ot),this.left=nt}run(nt,ot){if(!ot.hasModel())return;const rt=[],ut=ot.getSelections();for(const gt of ut)rt.push(new MoveCaretCommand(gt,this.left));ot.pushUndoStop(),ot.executeCommands(this.id,rt),ot.pushUndoStop()}}class MoveCaretLeftAction extends MoveCaretAction{constructor(){super(!0,{id:"editor.action.moveCarretLeftAction",label:localize("caret.moveLeft","Move Selected Text Left"),alias:"Move Selected Text Left",precondition:EditorContextKeys.writable})}}class MoveCaretRightAction extends MoveCaretAction{constructor(){super(!1,{id:"editor.action.moveCarretRightAction",label:localize("caret.moveRight","Move Selected Text Right"),alias:"Move Selected Text Right",precondition:EditorContextKeys.writable})}}registerEditorAction(MoveCaretLeftAction);registerEditorAction(MoveCaretRightAction);class TransposeLettersAction extends EditorAction{constructor(){super({id:"editor.action.transposeLetters",label:localize("transposeLetters.label","Transpose Letters"),alias:"Transpose Letters",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:306},weight:100}})}run(nt,ot){if(!ot.hasModel())return;const rt=ot.getModel(),ut=[],gt=ot.getSelections();for(const pt of gt){if(!pt.isEmpty())continue;const mt=pt.startLineNumber,vt=pt.startColumn,St=rt.getLineMaxColumn(mt);if(mt===1&&(vt===1||vt===2&&St===2))continue;const yt=vt===St?pt.getPosition():MoveOperations.rightPosition(rt,pt.getPosition().lineNumber,pt.getPosition().column),wt=MoveOperations.leftPosition(rt,yt),Lt=MoveOperations.leftPosition(rt,wt),xt=rt.getValueInRange(Range$2.fromPositions(Lt,wt)),It=rt.getValueInRange(Range$2.fromPositions(wt,yt)),kt=Range$2.fromPositions(Lt,yt);ut.push(new ReplaceCommand(kt,It+xt))}ut.length>0&&(ot.pushUndoStop(),ot.executeCommands(this.id,ut),ot.pushUndoStop())}}registerEditorAction(TransposeLettersAction);var __awaiter$11=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const CLIPBOARD_CONTEXT_MENU_GROUP="9_cutcopypaste",supportsCut=isNative||document.queryCommandSupported("cut"),supportsCopy=isNative||document.queryCommandSupported("copy"),supportsPaste=typeof navigator.clipboard>"u"||isFirefox?document.queryCommandSupported("paste"):!0;function registerCommand(ct){return ct.register(),ct}const CutAction=supportsCut?registerCommand(new MultiCommand({id:"editor.action.clipboardCutAction",precondition:void 0,kbOpts:isNative?{primary:2102,win:{primary:2102,secondary:[1044]},weight:100}:void 0,menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"2_ccp",title:localize({key:"miCut",comment:["&& denotes a mnemonic"]},"Cu&&t"),order:1},{menuId:MenuId.EditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.cutLabel","Cut"),when:EditorContextKeys.writable,order:1},{menuId:MenuId.CommandPalette,group:"",title:localize("actions.clipboard.cutLabel","Cut"),order:1},{menuId:MenuId.SimpleEditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.cutLabel","Cut"),when:EditorContextKeys.writable,order:1}]})):void 0,CopyAction=supportsCopy?registerCommand(new MultiCommand({id:"editor.action.clipboardCopyAction",precondition:void 0,kbOpts:isNative?{primary:2081,win:{primary:2081,secondary:[2067]},weight:100}:void 0,menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"2_ccp",title:localize({key:"miCopy",comment:["&& denotes a mnemonic"]},"&&Copy"),order:2},{menuId:MenuId.EditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.copyLabel","Copy"),order:2},{menuId:MenuId.CommandPalette,group:"",title:localize("actions.clipboard.copyLabel","Copy"),order:1},{menuId:MenuId.SimpleEditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.copyLabel","Copy"),order:2}]})):void 0;MenuRegistry.appendMenuItem(MenuId.MenubarEditMenu,{submenu:MenuId.MenubarCopy,title:{value:localize("copy as","Copy As"),original:"Copy As"},group:"2_ccp",order:3});MenuRegistry.appendMenuItem(MenuId.EditorContext,{submenu:MenuId.EditorContextCopy,title:{value:localize("copy as","Copy As"),original:"Copy As"},group:CLIPBOARD_CONTEXT_MENU_GROUP,order:3});MenuRegistry.appendMenuItem(MenuId.EditorContext,{submenu:MenuId.EditorContextShare,title:{value:localize("share","Share"),original:"Share"},group:"11_share",order:-1,when:ContextKeyExpr.and(ContextKeyExpr.notEquals("resourceScheme","output"),EditorContextKeys.editorTextFocus)});MenuRegistry.appendMenuItem(MenuId.EditorTitleContext,{submenu:MenuId.EditorTitleContextShare,title:{value:localize("share","Share"),original:"Share"},group:"11_share",order:-1});MenuRegistry.appendMenuItem(MenuId.ExplorerContext,{submenu:MenuId.ExplorerContextShare,title:{value:localize("share","Share"),original:"Share"},group:"11_share",order:-1});const PasteAction=supportsPaste?registerCommand(new MultiCommand({id:"editor.action.clipboardPasteAction",precondition:void 0,kbOpts:isNative?{primary:2100,win:{primary:2100,secondary:[1043]},linux:{primary:2100,secondary:[1043]},weight:100}:void 0,menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"2_ccp",title:localize({key:"miPaste",comment:["&& denotes a mnemonic"]},"&&Paste"),order:4},{menuId:MenuId.EditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.pasteLabel","Paste"),when:EditorContextKeys.writable,order:4},{menuId:MenuId.CommandPalette,group:"",title:localize("actions.clipboard.pasteLabel","Paste"),order:1},{menuId:MenuId.SimpleEditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.pasteLabel","Paste"),when:EditorContextKeys.writable,order:4}]})):void 0;class ExecCommandCopyWithSyntaxHighlightingAction extends EditorAction{constructor(){super({id:"editor.action.clipboardCopyWithSyntaxHighlightingAction",label:localize("actions.clipboard.copyWithSyntaxHighlightingLabel","Copy With Syntax Highlighting"),alias:"Copy With Syntax Highlighting",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,weight:100}})}run(nt,ot){!ot.hasModel()||!ot.getOption(35)&&ot.getSelection().isEmpty()||(CopyOptions.forceCopyWithSyntaxHighlighting=!0,ot.focus(),document.execCommand("copy"),CopyOptions.forceCopyWithSyntaxHighlighting=!1)}}function registerExecCommandImpl(ct,nt){ct&&(ct.addImplementation(1e4,"code-editor",(ot,rt)=>{const ut=ot.get(ICodeEditorService).getFocusedCodeEditor();if(ut&&ut.hasTextFocus()){const gt=ut.getOption(35),pt=ut.getSelection();return pt&&pt.isEmpty()&&!gt||document.execCommand(nt),!0}return!1}),ct.addImplementation(0,"generic-dom",(ot,rt)=>(document.execCommand(nt),!0)))}registerExecCommandImpl(CutAction,"cut");registerExecCommandImpl(CopyAction,"copy");PasteAction&&(PasteAction.addImplementation(1e4,"code-editor",(ct,nt)=>{const ot=ct.get(ICodeEditorService),rt=ct.get(IClipboardService),ut=ot.getFocusedCodeEditor();return ut&&ut.hasTextFocus()?!document.execCommand("paste")&&isWeb?(()=>__awaiter$11(void 0,void 0,void 0,function*(){const pt=yield rt.readText();if(pt!==""){const mt=InMemoryClipboardMetadataManager.INSTANCE.get(pt);let vt=!1,St=null,yt=null;mt&&(vt=ut.getOption(35)&&!!mt.isFromEmptySelection,St=typeof mt.multicursorText<"u"?mt.multicursorText:null,yt=mt.mode),ut.trigger("keyboard","paste",{text:pt,pasteOnNewLine:vt,multicursorText:St,mode:yt})}}))():!0:!1}),PasteAction.addImplementation(0,"generic-dom",(ct,nt)=>(document.execCommand("paste"),!0)));supportsCopy&&registerEditorAction(ExecCommandCopyWithSyntaxHighlightingAction);var __awaiter$10=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class CodeActionKind{constructor(nt){this.value=nt}equals(nt){return this.value===nt.value}contains(nt){return this.equals(nt)||this.value===""||nt.value.startsWith(this.value+CodeActionKind.sep)}intersects(nt){return this.contains(nt)||nt.contains(this)}append(nt){return new CodeActionKind(this.value+CodeActionKind.sep+nt)}}CodeActionKind.sep=".";CodeActionKind.None=new CodeActionKind("@@none@@");CodeActionKind.Empty=new CodeActionKind("");CodeActionKind.QuickFix=new CodeActionKind("quickfix");CodeActionKind.Refactor=new CodeActionKind("refactor");CodeActionKind.RefactorExtract=CodeActionKind.Refactor.append("extract");CodeActionKind.RefactorInline=CodeActionKind.Refactor.append("inline");CodeActionKind.RefactorMove=CodeActionKind.Refactor.append("move");CodeActionKind.RefactorRewrite=CodeActionKind.Refactor.append("rewrite");CodeActionKind.Source=new CodeActionKind("source");CodeActionKind.SourceOrganizeImports=CodeActionKind.Source.append("organizeImports");CodeActionKind.SourceFixAll=CodeActionKind.Source.append("fixAll");CodeActionKind.SurroundWith=CodeActionKind.Refactor.append("surround");var CodeActionTriggerSource;(function(ct){ct.Refactor="refactor",ct.RefactorPreview="refactor preview",ct.Lightbulb="lightbulb",ct.Default="other (default)",ct.SourceAction="source action",ct.QuickFix="quick fix action",ct.FixAll="fix all",ct.OrganizeImports="organize imports",ct.AutoFix="auto fix",ct.QuickFixHover="quick fix hover window",ct.OnSave="save participants",ct.ProblemsView="problems view"})(CodeActionTriggerSource||(CodeActionTriggerSource={}));function mayIncludeActionsOfKind(ct,nt){return!(ct.include&&!ct.include.intersects(nt)||ct.excludes&&ct.excludes.some(ot=>excludesAction(nt,ot,ct.include))||!ct.includeSourceActions&&CodeActionKind.Source.contains(nt))}function filtersAction(ct,nt){const ot=nt.kind?new CodeActionKind(nt.kind):void 0;return!(ct.include&&(!ot||!ct.include.contains(ot))||ct.excludes&&ot&&ct.excludes.some(rt=>excludesAction(ot,rt,ct.include))||!ct.includeSourceActions&&ot&&CodeActionKind.Source.contains(ot)||ct.onlyIncludePreferredActions&&!nt.isPreferred)}function excludesAction(ct,nt,ot){return!(!nt.contains(ct)||ot&&nt.contains(ot))}class CodeActionCommandArgs{static fromUser(nt,ot){return!nt||typeof nt!="object"?new CodeActionCommandArgs(ot.kind,ot.apply,!1):new CodeActionCommandArgs(CodeActionCommandArgs.getKindFromUser(nt,ot.kind),CodeActionCommandArgs.getApplyFromUser(nt,ot.apply),CodeActionCommandArgs.getPreferredUser(nt))}static getApplyFromUser(nt,ot){switch(typeof nt.apply=="string"?nt.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return ot}}static getKindFromUser(nt,ot){return typeof nt.kind=="string"?new CodeActionKind(nt.kind):ot}static getPreferredUser(nt){return typeof nt.preferred=="boolean"?nt.preferred:!1}constructor(nt,ot,rt){this.kind=nt,this.apply=ot,this.preferred=rt}}class CodeActionItem{constructor(nt,ot){this.action=nt,this.provider=ot}resolve(nt){var ot;return __awaiter$10(this,void 0,void 0,function*(){if(!((ot=this.provider)===null||ot===void 0)&&ot.resolveCodeAction&&!this.action.edit){let rt;try{rt=yield this.provider.resolveCodeAction(this.action,nt)}catch(ut){onUnexpectedExternalError(ut)}rt&&(this.action.edit=rt.edit)}return this})}}var __awaiter$$=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const codeActionCommandId="editor.action.codeAction",quickFixCommandId="editor.action.quickFix",autoFixCommandId="editor.action.autoFix",refactorCommandId="editor.action.refactor",sourceActionCommandId="editor.action.sourceAction",organizeImportsCommandId="editor.action.organizeImports",fixAllCommandId="editor.action.fixAll";class ManagedCodeActionSet extends Disposable{static codeActionsPreferredComparator(nt,ot){return nt.isPreferred&&!ot.isPreferred?-1:!nt.isPreferred&&ot.isPreferred?1:0}static codeActionsComparator({action:nt},{action:ot}){return isNonEmptyArray(nt.diagnostics)?isNonEmptyArray(ot.diagnostics)?ManagedCodeActionSet.codeActionsPreferredComparator(nt,ot):-1:isNonEmptyArray(ot.diagnostics)?1:ManagedCodeActionSet.codeActionsPreferredComparator(nt,ot)}constructor(nt,ot,rt){super(),this.documentation=ot,this._register(rt),this.allActions=[...nt].sort(ManagedCodeActionSet.codeActionsComparator),this.validActions=this.allActions.filter(({action:ut})=>!ut.disabled)}get hasAutoFix(){return this.validActions.some(({action:nt})=>!!nt.kind&&CodeActionKind.QuickFix.contains(new CodeActionKind(nt.kind))&&!!nt.isPreferred)}}const emptyCodeActionsResponse={actions:[],documentation:void 0};function getCodeActions(ct,nt,ot,rt,ut,gt){var pt;return __awaiter$$(this,void 0,void 0,function*(){const mt=rt.filter||{},vt={only:(pt=mt.include)===null||pt===void 0?void 0:pt.value,trigger:rt.type},St=new TextModelCancellationTokenSource(nt,gt),yt=getCodeActionProviders(ct,nt,mt),wt=new DisposableStore,Lt=yt.map(It=>__awaiter$$(this,void 0,void 0,function*(){try{ut.report(It);const kt=yield It.provideCodeActions(nt,ot,vt,St.token);if(kt&&wt.add(kt),St.token.isCancellationRequested)return emptyCodeActionsResponse;const At=((kt==null?void 0:kt.actions)||[]).filter(Rt=>Rt&&filtersAction(mt,Rt)),Tt=getDocumentationFromProvider(It,At,mt.include);return{actions:At.map(Rt=>new CodeActionItem(Rt,It)),documentation:Tt}}catch(kt){if(isCancellationError(kt))throw kt;return onUnexpectedExternalError(kt),emptyCodeActionsResponse}})),xt=ct.onDidChange(()=>{const It=ct.all(nt);equals$2(It,yt)||St.cancel()});try{const It=yield Promise.all(Lt),kt=It.map(Tt=>Tt.actions).flat(),At=[...coalesce(It.map(Tt=>Tt.documentation)),...getAdditionalDocumentationForShowingActions(ct,nt,rt,kt)];return new ManagedCodeActionSet(kt,At,wt)}finally{xt.dispose(),St.dispose()}})}function getCodeActionProviders(ct,nt,ot){return ct.all(nt).filter(rt=>rt.providedCodeActionKinds?rt.providedCodeActionKinds.some(ut=>mayIncludeActionsOfKind(ot,new CodeActionKind(ut))):!0)}function*getAdditionalDocumentationForShowingActions(ct,nt,ot,rt){var ut,gt,pt;if(nt&&rt.length)for(const mt of ct.all(nt))mt._getAdditionalMenuItems&&(yield*(ut=mt._getAdditionalMenuItems)===null||ut===void 0?void 0:ut.call(mt,{trigger:ot.type,only:(pt=(gt=ot.filter)===null||gt===void 0?void 0:gt.include)===null||pt===void 0?void 0:pt.value},rt.map(vt=>vt.action)))}function getDocumentationFromProvider(ct,nt,ot){if(!ct.documentation)return;const rt=ct.documentation.map(ut=>({kind:new CodeActionKind(ut.kind),command:ut.command}));if(ot){let ut;for(const gt of rt)gt.kind.contains(ot)&&(ut?ut.kind.contains(gt.kind)&&(ut=gt):ut=gt);if(ut)return ut==null?void 0:ut.command}for(const ut of nt)if(ut.kind){for(const gt of rt)if(gt.kind.contains(new CodeActionKind(ut.kind)))return gt.command}}var ApplyCodeActionReason;(function(ct){ct.OnSave="onSave",ct.FromProblemsView="fromProblemsView",ct.FromCodeActions="fromCodeActions"})(ApplyCodeActionReason||(ApplyCodeActionReason={}));function applyCodeAction(ct,nt,ot,rt,ut=CancellationToken.None){var gt;return __awaiter$$(this,void 0,void 0,function*(){const pt=ct.get(IBulkEditService),mt=ct.get(ICommandService),vt=ct.get(ITelemetryService),St=ct.get(INotificationService);if(vt.publicLog2("codeAction.applyCodeAction",{codeActionTitle:nt.action.title,codeActionKind:nt.action.kind,codeActionIsPreferred:!!nt.action.isPreferred,reason:ot}),yield nt.resolve(ut),!ut.isCancellationRequested&&!(!((gt=nt.action.edit)===null||gt===void 0)&&gt.edits.length&&!(yield pt.apply(nt.action.edit,{editor:rt==null?void 0:rt.editor,label:nt.action.title,quotableLabel:nt.action.title,code:"undoredo.codeAction",respectAutoSaveConfig:ot!==ApplyCodeActionReason.OnSave,showPreview:rt==null?void 0:rt.preview})).isApplied)&&nt.action.command)try{yield mt.executeCommand(nt.action.command.id,...nt.action.command.arguments||[])}catch(yt){const wt=asMessage(yt);St.error(typeof wt=="string"?wt:localize("applyCodeActionFailed","An unknown error occurred while applying the code action"))}})}function asMessage(ct){return typeof ct=="string"?ct:ct instanceof Error&&typeof ct.message=="string"?ct.message:void 0}CommandsRegistry.registerCommand("_executeCodeActionProvider",function(ct,nt,ot,rt,ut){return __awaiter$$(this,void 0,void 0,function*(){if(!(nt instanceof URI))throw illegalArgument();const{codeActionProvider:gt}=ct.get(ILanguageFeaturesService),pt=ct.get(IModelService).getModel(nt);if(!pt)throw illegalArgument();const mt=Selection$1.isISelection(ot)?Selection$1.liftSelection(ot):Range$2.isIRange(ot)?pt.validateRange(ot):void 0;if(!mt)throw illegalArgument();const vt=typeof rt=="string"?new CodeActionKind(rt):void 0,St=yield getCodeActions(gt,pt,mt,{type:1,triggerAction:CodeActionTriggerSource.Default,filter:{includeSourceActions:!0,include:vt}},Progress.None,CancellationToken.None),yt=[],wt=Math.min(St.validActions.length,typeof ut=="number"?ut:0);for(let Lt=0;Lt<wt;Lt++)yt.push(St.validActions[Lt].resolve(CancellationToken.None));try{return yield Promise.all(yt),St.validActions.map(Lt=>Lt.action)}finally{setTimeout(()=>St.dispose(),100)}})});var __decorate$1q=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1q=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let CodeActionKeybindingResolver=class lr{constructor(nt){this.keybindingService=nt}getResolver(){const nt=new Lazy(()=>this.keybindingService.getKeybindings().filter(ot=>lr.codeActionCommands.indexOf(ot.command)>=0).filter(ot=>ot.resolvedKeybinding).map(ot=>{let rt=ot.commandArgs;return ot.command===organizeImportsCommandId?rt={kind:CodeActionKind.SourceOrganizeImports.value}:ot.command===fixAllCommandId&&(rt={kind:CodeActionKind.SourceFixAll.value}),Object.assign({resolvedKeybinding:ot.resolvedKeybinding},CodeActionCommandArgs.fromUser(rt,{kind:CodeActionKind.None,apply:"never"}))}));return ot=>{if(ot.kind){const rt=this.bestKeybindingForCodeAction(ot,nt.value);return rt==null?void 0:rt.resolvedKeybinding}}}bestKeybindingForCodeAction(nt,ot){if(!nt.kind)return;const rt=new CodeActionKind(nt.kind);return ot.filter(ut=>ut.kind.contains(rt)).filter(ut=>ut.preferred?nt.isPreferred:!0).reduceRight((ut,gt)=>ut?ut.kind.contains(gt.kind)?gt:ut:gt,void 0)}};CodeActionKeybindingResolver.codeActionCommands=[refactorCommandId,codeActionCommandId,sourceActionCommandId,organizeImportsCommandId,fixAllCommandId];CodeActionKeybindingResolver=__decorate$1q([__param$1q(0,IKeybindingService)],CodeActionKeybindingResolver);const codicon="",codiconModifiers="",symbolIcons="";registerColor("symbolIcon.arrayForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.booleanForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},localize("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.colorForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.constantForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},localize("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},localize("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},localize("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},localize("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},localize("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.fileForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.folderForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},localize("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},localize("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.keyForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.keywordForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},localize("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.moduleForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.namespaceForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.nullForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.numberForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.objectForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.operatorForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.packageForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.propertyForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.referenceForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.snippetForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.stringForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.structForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.textForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.typeParameterForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.unitForeground",{dark:foreground,light:foreground,hcDark:foreground,hcLight:foreground},localize("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},localize("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));const uncategorizedCodeActionGroup=Object.freeze({kind:CodeActionKind.Empty,title:localize("codeAction.widget.id.more","More Actions...")}),codeActionGroups=Object.freeze([{kind:CodeActionKind.QuickFix,title:localize("codeAction.widget.id.quickfix","Quick Fix...")},{kind:CodeActionKind.RefactorExtract,title:localize("codeAction.widget.id.extract","Extract..."),icon:Codicon.wrench},{kind:CodeActionKind.RefactorInline,title:localize("codeAction.widget.id.inline","Inline..."),icon:Codicon.wrench},{kind:CodeActionKind.RefactorRewrite,title:localize("codeAction.widget.id.convert","Rewrite..."),icon:Codicon.wrench},{kind:CodeActionKind.RefactorMove,title:localize("codeAction.widget.id.move","Move..."),icon:Codicon.wrench},{kind:CodeActionKind.SurroundWith,title:localize("codeAction.widget.id.surround","Surround With..."),icon:Codicon.symbolSnippet},{kind:CodeActionKind.Source,title:localize("codeAction.widget.id.source","Source Action..."),icon:Codicon.symbolFile},uncategorizedCodeActionGroup]);function toMenuItems(ct,nt,ot){if(!nt)return ct.map(gt=>({kind:"action",item:gt,group:uncategorizedCodeActionGroup,disabled:!!gt.action.disabled,label:gt.action.disabled||gt.action.title}));const rt=codeActionGroups.map(gt=>({group:gt,actions:[]}));for(const gt of ct){const pt=gt.action.kind?new CodeActionKind(gt.action.kind):CodeActionKind.None;for(const mt of rt)if(mt.group.kind.contains(pt)){mt.actions.push(gt);break}}const ut=[];for(const gt of rt)if(gt.actions.length){ut.push({kind:"header",group:gt.group});for(const pt of gt.actions)ut.push({kind:"action",item:pt,group:gt.group,label:pt.action.title,disabled:!!pt.action.disabled,keybinding:ot(pt.action)})}return ut}const messageController="";var __decorate$1p=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1p=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let MessageController=class Ko{static get(nt){return nt.getContribution(Ko.ID)}constructor(nt,ot){this._messageWidget=new MutableDisposable,this._messageListeners=new DisposableStore,this._editor=nt,this._visible=Ko.MESSAGE_VISIBLE.bindTo(ot)}dispose(){this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(nt,ot){alert(nt),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._messageWidget.value=new MessageWidget$1(this._editor,ot,nt),this._messageListeners.add(this._editor.onDidBlurEditorText(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeCursorPosition(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidDispose(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeModel(()=>this.closeMessage())),this._messageListeners.add(new TimeoutTimer(()=>this.closeMessage(),3e3));let rt;this._messageListeners.add(this._editor.onMouseMove(ut=>{ut.target.position&&(rt?rt.containsPosition(ut.target.position)||this.closeMessage():rt=new Range$2(ot.lineNumber-3,1,ut.target.position.lineNumber+3,1))}))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(MessageWidget$1.fadeOut(this._messageWidget.value))}};MessageController.ID="editor.contrib.messageController";MessageController.MESSAGE_VISIBLE=new RawContextKey("messageVisible",!1,localize("messageVisible","Whether the editor is currently showing an inline message"));MessageController=__decorate$1p([__param$1p(1,IContextKeyService)],MessageController);const MessageCommand=EditorCommand.bindToContribution(MessageController.get);registerEditorCommand(new MessageCommand({id:"leaveEditorMessage",precondition:MessageController.MESSAGE_VISIBLE,handler:ct=>ct.closeMessage(),kbOpts:{weight:100+30,primary:9}}));let MessageWidget$1=class{static fadeOut(nt){const ot=()=>{nt.dispose(),clearTimeout(rt),nt.getDomNode().removeEventListener("animationend",ot)},rt=setTimeout(ot,110);return nt.getDomNode().addEventListener("animationend",ot),nt.getDomNode().classList.add("fadeOut"),{dispose:ot}}constructor(nt,{lineNumber:ot,column:rt},ut){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=nt,this._editor.revealLinesInCenterIfOutsideViewport(ot,ot,0),this._position={lineNumber:ot,column:rt},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage"),this._domNode.style.marginLeft="-6px";const gt=document.createElement("div");gt.classList.add("anchor","top"),this._domNode.appendChild(gt);const pt=document.createElement("div");pt.classList.add("message"),pt.textContent=ut,this._domNode.appendChild(pt);const mt=document.createElement("div");mt.classList.add("anchor","below"),this._domNode.appendChild(mt),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2],positionAffinity:1}}afterRender(nt){this._domNode.classList.toggle("below",nt===2)}};registerEditorContribution(MessageController.ID,MessageController,4);const actionWidget="";var __decorate$1o=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1o=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const acceptSelectedActionCommand="acceptSelectedCodeAction",previewSelectedActionCommand="previewSelectedCodeAction";class HeaderRenderer{get templateId(){return"header"}renderTemplate(nt){nt.classList.add("group-header");const ot=document.createElement("span");return nt.append(ot),{container:nt,text:ot}}renderElement(nt,ot,rt){var ut,gt;rt.text.textContent=(gt=(ut=nt.group)===null||ut===void 0?void 0:ut.title)!==null&&gt!==void 0?gt:""}disposeTemplate(nt){}}let ActionItemRenderer=class{get templateId(){return"action"}constructor(nt,ot){this._supportsPreview=nt,this._keybindingService=ot}renderTemplate(nt){nt.classList.add(this.templateId);const ot=document.createElement("div");ot.className="icon",nt.append(ot);const rt=document.createElement("span");rt.className="title",nt.append(rt);const ut=new KeybindingLabel(nt,OS);return{container:nt,icon:ot,text:rt,keybinding:ut}}renderElement(nt,ot,rt){var ut,gt,pt;if(!((ut=nt.group)===null||ut===void 0)&&ut.icon?(rt.icon.className=ThemeIcon.asClassName(nt.group.icon),nt.group.icon.color&&(rt.icon.style.color=asCssVariable(nt.group.icon.color.id))):(rt.icon.className=ThemeIcon.asClassName(Codicon.lightBulb),rt.icon.style.color="var(--vscode-editorLightBulb-foreground)"),!nt.item||!nt.label)return;rt.text.textContent=stripNewlines(nt.label),rt.keybinding.set(nt.keybinding),setVisibility(!!nt.keybinding,rt.keybinding.element);const mt=(gt=this._keybindingService.lookupKeybinding(acceptSelectedActionCommand))===null||gt===void 0?void 0:gt.getLabel(),vt=(pt=this._keybindingService.lookupKeybinding(previewSelectedActionCommand))===null||pt===void 0?void 0:pt.getLabel();rt.container.classList.toggle("option-disabled",nt.disabled),nt.disabled?rt.container.title=nt.label:mt&&vt?this._supportsPreview?rt.container.title=localize({key:"label-preview",comment:['placeholders are keybindings, e.g "F2 to apply, Shift+F2 to preview"']},"{0} to apply, {1} to preview",mt,vt):rt.container.title=localize({key:"label",comment:['placeholder is a keybinding, e.g "F2 to apply"']},"{0} to apply",mt):rt.container.title=""}disposeTemplate(nt){}};ActionItemRenderer=__decorate$1o([__param$1o(1,IKeybindingService)],ActionItemRenderer);class AcceptSelectedEvent extends UIEvent{constructor(){super("acceptSelectedAction")}}class PreviewSelectedEvent extends UIEvent{constructor(){super("previewSelectedAction")}}let ActionList=class extends Disposable{constructor(nt,ot,rt,ut,gt,pt){super(),this._delegate=ut,this._contextViewService=gt,this._keybindingService=pt,this._actionLineHeight=24,this._headerLineHeight=26,this.domNode=document.createElement("div"),this.domNode.classList.add("actionList");const mt={getHeight:vt=>vt.kind==="header"?this._headerLineHeight:this._actionLineHeight,getTemplateId:vt=>vt.kind};this._list=this._register(new List(nt,this.domNode,mt,[new ActionItemRenderer(ot,this._keybindingService),new HeaderRenderer],{keyboardSupport:!1,accessibilityProvider:{getAriaLabel:vt=>{if(vt.kind==="action"){let St=vt.label?stripNewlines(vt==null?void 0:vt.label):"";return vt.disabled&&(St=localize({key:"customQuickFixWidget.labels",comment:["Action widget labels for accessibility."]},"{0}, Disabled Reason: {1}",St,vt.disabled)),St}return null},getWidgetAriaLabel:()=>localize({key:"customQuickFixWidget",comment:["An action widget option"]},"Action Widget"),getRole:vt=>vt.kind==="action"?"option":"separator",getWidgetRole:()=>"listbox"}})),this._list.style(defaultListStyles),this._register(this._list.onMouseClick(vt=>this.onListClick(vt))),this._register(this._list.onMouseOver(vt=>this.onListHover(vt))),this._register(this._list.onDidChangeFocus(()=>this._list.domFocus())),this._register(this._list.onDidChangeSelection(vt=>this.onListSelection(vt))),this._allMenuItems=rt,this._list.splice(0,this._list.length,this._allMenuItems),this._list.length&&this.focusNext()}focusCondition(nt){return!nt.disabled&&nt.kind==="action"}hide(nt){this._delegate.onHide(nt),this._contextViewService.hideContextView()}layout(nt){const ot=this._allMenuItems.filter(St=>St.kind==="header").length,ut=this._allMenuItems.length*this._actionLineHeight+ot*this._headerLineHeight-ot*this._actionLineHeight;this._list.layout(ut);const gt=this._allMenuItems.map((St,yt)=>{const wt=document.getElementById(this._list.getElementID(yt));if(wt){wt.style.width="auto";const Lt=wt.getBoundingClientRect().width;return wt.style.width="",Lt}return 0}),pt=Math.max(...gt,nt),mt=.7,vt=Math.min(ut,document.body.clientHeight*mt);return this._list.layout(vt,pt),this.domNode.style.height=`${vt}px`,this._list.domFocus(),pt}focusPrevious(){this._list.focusPrevious(1,!0,void 0,this.focusCondition)}focusNext(){this._list.focusNext(1,!0,void 0,this.focusCondition)}acceptSelected(nt){const ot=this._list.getFocus();if(ot.length===0)return;const rt=ot[0],ut=this._list.element(rt);if(!this.focusCondition(ut))return;const gt=nt?new PreviewSelectedEvent:new AcceptSelectedEvent;this._list.setSelection([rt],gt)}onListSelection(nt){if(!nt.elements.length)return;const ot=nt.elements[0];ot.item&&this.focusCondition(ot)?this._delegate.onSelect(ot.item,nt.browserEvent instanceof PreviewSelectedEvent):this._list.setSelection([])}onListHover(nt){this._list.setFocus(typeof nt.index=="number"?[nt.index]:[])}onListClick(nt){nt.element&&this.focusCondition(nt.element)&&this._list.setFocus([])}};ActionList=__decorate$1o([__param$1o(4,IContextViewService),__param$1o(5,IKeybindingService)],ActionList);function stripNewlines(ct){return ct.replace(/\r\n|\r|\n/g," ")}var __decorate$1n=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1n=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const ActionWidgetContextKeys={Visible:new RawContextKey("codeActionMenuVisible",!1,localize("codeActionMenuVisible","Whether the action widget list is visible"))},IActionWidgetService=createDecorator("actionWidgetService");let ActionWidgetService=class extends Disposable{get isVisible(){return ActionWidgetContextKeys.Visible.getValue(this._contextKeyService)||!1}constructor(nt,ot,rt){super(),this._contextViewService=nt,this._contextKeyService=ot,this._instantiationService=rt,this._list=this._register(new MutableDisposable)}show(nt,ot,rt,ut,gt,pt,mt){const vt=ActionWidgetContextKeys.Visible.bindTo(this._contextKeyService),St=this._instantiationService.createInstance(ActionList,nt,ot,rt,ut);this._contextViewService.showContextView({getAnchor:()=>gt,render:yt=>(vt.set(!0),this._renderWidget(yt,St,mt??[])),onHide:yt=>{vt.reset(),this._onWidgetClosed(yt)}},pt,!1)}acceptSelected(nt){var ot;(ot=this._list.value)===null||ot===void 0||ot.acceptSelected(nt)}focusPrevious(){var nt,ot;(ot=(nt=this._list)===null||nt===void 0?void 0:nt.value)===null||ot===void 0||ot.focusPrevious()}focusNext(){var nt,ot;(ot=(nt=this._list)===null||nt===void 0?void 0:nt.value)===null||ot===void 0||ot.focusNext()}hide(){var nt;(nt=this._list.value)===null||nt===void 0||nt.hide(),this._list.clear()}_renderWidget(nt,ot,rt){var ut;const gt=document.createElement("div");if(gt.classList.add("action-widget"),nt.appendChild(gt),this._list.value=ot,this._list.value)gt.appendChild(this._list.value.domNode);else throw new Error("List has no value");const pt=new DisposableStore,mt=document.createElement("div"),vt=nt.appendChild(mt);vt.classList.add("context-view-block"),pt.add(addDisposableListener(vt,EventType$1.MOUSE_DOWN,It=>It.stopPropagation()));const St=document.createElement("div"),yt=nt.appendChild(St);yt.classList.add("context-view-pointerBlock"),pt.add(addDisposableListener(yt,EventType$1.POINTER_MOVE,()=>yt.remove())),pt.add(addDisposableListener(yt,EventType$1.MOUSE_DOWN,()=>yt.remove()));let wt=0;if(rt.length){const It=this._createActionBar(".action-widget-action-bar",rt);It&&(gt.appendChild(It.getContainer().parentElement),pt.add(It),wt=It.getContainer().offsetWidth)}const Lt=(ut=this._list.value)===null||ut===void 0?void 0:ut.layout(wt);gt.style.width=`${Lt}px`;const xt=pt.add(trackFocus(nt));return pt.add(xt.onDidBlur(()=>this.hide())),pt}_createActionBar(nt,ot){if(!ot.length)return;const rt=$$d(nt),ut=new ActionBar(rt);return ut.push(ot,{icon:!1,label:!0}),ut}_onWidgetClosed(nt){var ot;(ot=this._list.value)===null||ot===void 0||ot.hide(nt)}};ActionWidgetService=__decorate$1n([__param$1n(0,IContextViewService),__param$1n(1,IContextKeyService),__param$1n(2,IInstantiationService)],ActionWidgetService);registerSingleton(IActionWidgetService,ActionWidgetService,1);const weight$3=100+1e3;registerAction2(class extends Action2{constructor(){super({id:"hideCodeActionWidget",title:{value:localize("hideCodeActionWidget.title","Hide action widget"),original:"Hide action widget"},precondition:ActionWidgetContextKeys.Visible,keybinding:{weight:weight$3,primary:9,secondary:[1033]}})}run(ct){ct.get(IActionWidgetService).hide()}});registerAction2(class extends Action2{constructor(){super({id:"selectPrevCodeAction",title:{value:localize("selectPrevCodeAction.title","Select previous action"),original:"Select previous action"},precondition:ActionWidgetContextKeys.Visible,keybinding:{weight:weight$3,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})}run(ct){const nt=ct.get(IActionWidgetService);nt instanceof ActionWidgetService&&nt.focusPrevious()}});registerAction2(class extends Action2{constructor(){super({id:"selectNextCodeAction",title:{value:localize("selectNextCodeAction.title","Select next action"),original:"Select next action"},precondition:ActionWidgetContextKeys.Visible,keybinding:{weight:weight$3,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})}run(ct){const nt=ct.get(IActionWidgetService);nt instanceof ActionWidgetService&&nt.focusNext()}});registerAction2(class extends Action2{constructor(){super({id:acceptSelectedActionCommand,title:{value:localize("acceptSelected.title","Accept selected action"),original:"Accept selected action"},precondition:ActionWidgetContextKeys.Visible,keybinding:{weight:weight$3,primary:3,secondary:[2137]}})}run(ct){const nt=ct.get(IActionWidgetService);nt instanceof ActionWidgetService&&nt.acceptSelected()}});registerAction2(class extends Action2{constructor(){super({id:previewSelectedActionCommand,title:{value:localize("previewSelected.title","Preview selected action"),original:"Preview selected action"},precondition:ActionWidgetContextKeys.Visible,keybinding:{weight:weight$3,primary:2051}})}run(ct){const nt=ct.get(IActionWidgetService);nt instanceof ActionWidgetService&&nt.acceptSelected(!0)}});const lightBulbWidget="";var __decorate$1m=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1m=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},LightBulbState;(function(ct){ct.Hidden={type:0};class nt{constructor(rt,ut,gt,pt){this.actions=rt,this.trigger=ut,this.editorPosition=gt,this.widgetPosition=pt,this.type=1}}ct.Showing=nt})(LightBulbState||(LightBulbState={}));let LightBulbWidget=class cr extends Disposable{constructor(nt,ot){super(),this._editor=nt,this._onClick=this._register(new Emitter$2),this.onClick=this._onClick.event,this._state=LightBulbState.Hidden,this._domNode=$$d("div.lightBulbWidget"),this._register(Gesture.ignoreTarget(this._domNode)),this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent(rt=>{const ut=this._editor.getModel();(this.state.type!==1||!ut||this.state.editorPosition.lineNumber>=ut.getLineCount())&&this.hide()})),this._register(addStandardDisposableGenericMouseDownListener(this._domNode,rt=>{if(this.state.type!==1)return;this._editor.focus(),rt.preventDefault();const{top:ut,height:gt}=getDomNodePagePosition(this._domNode),pt=this._editor.getOption(64);let mt=Math.floor(pt/3);this.state.widgetPosition.position!==null&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(mt+=pt),this._onClick.fire({x:rt.posx,y:ut+gt+mt,actions:this.state.actions,trigger:this.state.trigger})})),this._register(addDisposableListener(this._domNode,"mouseenter",rt=>{(rt.buttons&1)===1&&this.hide()})),this._register(this._editor.onDidChangeConfiguration(rt=>{rt.hasChanged(62)&&!this._editor.getOption(62).enabled&&this.hide()})),this._register(Event.runAndSubscribe(ot.onDidUpdateKeybindings,()=>{var rt,ut;this._preferredKbLabel=withNullAsUndefined((rt=ot.lookupKeybinding(autoFixCommandId))===null||rt===void 0?void 0:rt.getLabel()),this._quickFixKbLabel=withNullAsUndefined((ut=ot.lookupKeybinding(quickFixCommandId))===null||ut===void 0?void 0:ut.getLabel()),this._updateLightBulbTitleAndIcon()}))}dispose(){super.dispose(),this._editor.removeContentWidget(this)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return this._state.type===1?this._state.widgetPosition:null}update(nt,ot,rt){if(nt.validActions.length<=0)return this.hide();const ut=this._editor.getOptions();if(!ut.get(62).enabled)return this.hide();const gt=this._editor.getModel();if(!gt)return this.hide();const{lineNumber:pt,column:mt}=gt.validatePosition(rt),vt=gt.getOptions().tabSize,St=ut.get(48),yt=gt.getLineContent(pt),wt=computeIndentLevel(yt,vt),Lt=St.spaceWidth*wt>22,xt=kt=>kt>2&&this._editor.getTopForLineNumber(kt)===this._editor.getTopForLineNumber(kt-1);let It=pt;if(!Lt){if(pt>1&&!xt(pt-1))It-=1;else if(!xt(pt+1))It+=1;else if(mt*St.spaceWidth<22)return this.hide()}this.state=new LightBulbState.Showing(nt,ot,rt,{position:{lineNumber:It,column:1},preference:cr._posPref}),this._editor.layoutContentWidget(this)}hide(){this.state!==LightBulbState.Hidden&&(this.state=LightBulbState.Hidden,this._editor.layoutContentWidget(this))}get state(){return this._state}set state(nt){this._state=nt,this._updateLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(this.state.type===1&&this.state.actions.hasAutoFix&&(this._domNode.classList.remove(...ThemeIcon.asClassNameArray(Codicon.lightBulb)),this._domNode.classList.add(...ThemeIcon.asClassNameArray(Codicon.lightbulbAutofix)),this._preferredKbLabel)){this.title=localize("preferredcodeActionWithKb","Show Code Actions. Preferred Quick Fix Available ({0})",this._preferredKbLabel);return}this._domNode.classList.remove(...ThemeIcon.asClassNameArray(Codicon.lightbulbAutofix)),this._domNode.classList.add(...ThemeIcon.asClassNameArray(Codicon.lightBulb)),this._quickFixKbLabel?this.title=localize("codeActionWithKb","Show Code Actions ({0})",this._quickFixKbLabel):this.title=localize("codeAction","Show Code Actions")}set title(nt){this._domNode.title=nt}};LightBulbWidget.ID="editor.contrib.lightbulbWidget";LightBulbWidget._posPref=[0];LightBulbWidget=__decorate$1m([__param$1m(1,IKeybindingService)],LightBulbWidget);var __decorate$1l=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1l=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$_=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},__classPrivateFieldSet$1=globalThis&&globalThis.__classPrivateFieldSet||function(ct,nt,ot,rt,ut){if(rt==="m")throw new TypeError("Private method is not writable");if(rt==="a"&&!ut)throw new TypeError("Private accessor was defined without a setter");if(typeof nt=="function"?ct!==nt||!ut:!nt.has(ct))throw new TypeError("Cannot write private member to an object whose class did not declare it");return rt==="a"?ut.call(ct,ot):ut?ut.value=ot:nt.set(ct,ot),ot},__classPrivateFieldGet$1=globalThis&&globalThis.__classPrivateFieldGet||function(ct,nt,ot,rt){if(ot==="a"&&!rt)throw new TypeError("Private accessor was defined without a getter");if(typeof nt=="function"?ct!==nt||!rt:!nt.has(ct))throw new TypeError("Cannot read private member from an object whose class did not declare it");return ot==="m"?rt:ot==="a"?rt.call(ct):rt?rt.value:nt.get(ct)},_CodeActionUi_disposed;let CodeActionUi=class extends Disposable{constructor(nt,ot,rt,ut,gt,pt){super(),this._editor=nt,this.delegate=ot,this._configurationService=ut,this._actionWidgetService=gt,this._commandService=pt,this._activeCodeActions=this._register(new MutableDisposable),_CodeActionUi_disposed.set(this,!1),this._showDisabled=!1,this._lightBulbWidget=new Lazy(()=>{const mt=this._editor.getContribution(LightBulbWidget.ID);return mt&&this._register(mt.onClick(vt=>this.showCodeActionList(vt.actions,vt,{includeDisabledActions:!1,fromLightbulb:!0}))),mt}),this._resolver=rt.createInstance(CodeActionKeybindingResolver),this._register(this._editor.onDidLayoutChange(()=>this._actionWidgetService.hide()))}dispose(){__classPrivateFieldSet$1(this,_CodeActionUi_disposed,!0,"f"),super.dispose()}update(nt){var ot,rt,ut,gt,pt,mt,vt;return __awaiter$_(this,void 0,void 0,function*(){if(nt.type!==1){(ot=this._lightBulbWidget.rawValue)===null||ot===void 0||ot.hide();return}let St;try{St=yield nt.actions}catch(yt){onUnexpectedError(yt);return}if(!__classPrivateFieldGet$1(this,_CodeActionUi_disposed,"f"))if((rt=this._lightBulbWidget.value)===null||rt===void 0||rt.update(St,nt.trigger,nt.position),nt.trigger.type===1){if(!((ut=nt.trigger.filter)===null||ut===void 0)&&ut.include){const wt=this.tryGetValidActionToApply(nt.trigger,St);if(wt){try{(gt=this._lightBulbWidget.value)===null||gt===void 0||gt.hide(),yield this.delegate.applyCodeAction(wt,!1,!1)}finally{St.dispose()}return}if(nt.trigger.context){const Lt=this.getInvalidActionThatWouldHaveBeenApplied(nt.trigger,St);if(Lt&&Lt.action.disabled){(pt=MessageController.get(this._editor))===null||pt===void 0||pt.showMessage(Lt.action.disabled,nt.trigger.context.position),St.dispose();return}}}const yt=!!(!((mt=nt.trigger.filter)===null||mt===void 0)&&mt.include);if(nt.trigger.context&&(!St.allActions.length||!yt&&!St.validActions.length)){(vt=MessageController.get(this._editor))===null||vt===void 0||vt.showMessage(nt.trigger.context.notAvailableMessage,nt.trigger.context.position),this._activeCodeActions.value=St,St.dispose();return}this._activeCodeActions.value=St,this.showCodeActionList(St,this.toCoords(nt.position),{includeDisabledActions:yt,fromLightbulb:!1})}else this._actionWidgetService.isVisible?St.dispose():this._activeCodeActions.value=St})}getInvalidActionThatWouldHaveBeenApplied(nt,ot){if(ot.allActions.length&&(nt.autoApply==="first"&&ot.validActions.length===0||nt.autoApply==="ifSingle"&&ot.allActions.length===1))return ot.allActions.find(({action:rt})=>rt.disabled)}tryGetValidActionToApply(nt,ot){if(ot.validActions.length&&(nt.autoApply==="first"&&ot.validActions.length>0||nt.autoApply==="ifSingle"&&ot.validActions.length===1))return ot.validActions[0]}showCodeActionList(nt,ot,rt){return __awaiter$_(this,void 0,void 0,function*(){const ut=this._editor.getDomNode();if(!ut)return;const gt=rt.includeDisabledActions&&(this._showDisabled||nt.validActions.length===0)?nt.allActions:nt.validActions;if(!gt.length)return;const pt=Position$1.isIPosition(ot)?this.toCoords(ot):ot,mt={onSelect:(vt,St)=>__awaiter$_(this,void 0,void 0,function*(){this.delegate.applyCodeAction(vt,!0,!!St),this._actionWidgetService.hide()}),onHide:()=>{var vt;(vt=this._editor)===null||vt===void 0||vt.focus()}};this._actionWidgetService.show("codeActionWidget",!0,toMenuItems(gt,this._shouldShowHeaders(),this._resolver.getResolver()),mt,pt,ut,this._getActionBarActions(nt,ot,rt))})}toCoords(nt){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(nt,1),this._editor.render();const ot=this._editor.getScrolledVisiblePosition(nt),rt=getDomNodePagePosition(this._editor.getDomNode()),ut=rt.left+ot.left,gt=rt.top+ot.top+ot.height;return{x:ut,y:gt}}_shouldShowHeaders(){var nt;const ot=(nt=this._editor)===null||nt===void 0?void 0:nt.getModel();return this._configurationService.getValue("editor.codeActionWidget.showHeaders",{resource:ot==null?void 0:ot.uri})}_getActionBarActions(nt,ot,rt){if(rt.fromLightbulb)return[];const ut=nt.documentation.map(gt=>{var pt;return{id:gt.id,label:gt.title,tooltip:(pt=gt.tooltip)!==null&&pt!==void 0?pt:"",class:void 0,enabled:!0,run:()=>{var mt;return this._commandService.executeCommand(gt.id,...(mt=gt.arguments)!==null&&mt!==void 0?mt:[])}}});return rt.includeDisabledActions&&nt.validActions.length>0&&nt.allActions.length!==nt.validActions.length&&ut.push(this._showDisabled?{id:"hideMoreActions",label:localize("hideMoreActions","Hide Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!1,this.showCodeActionList(nt,ot,rt))}:{id:"showMoreActions",label:localize("showMoreActions","Show Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!0,this.showCodeActionList(nt,ot,rt))}),ut}};_CodeActionUi_disposed=new WeakMap;CodeActionUi=__decorate$1l([__param$1l(2,IInstantiationService),__param$1l(3,IConfigurationService),__param$1l(4,IActionWidgetService),__param$1l(5,ICommandService)],CodeActionUi);var __classPrivateFieldGet=globalThis&&globalThis.__classPrivateFieldGet||function(ct,nt,ot,rt){if(ot==="a"&&!rt)throw new TypeError("Private accessor was defined without a getter");if(typeof nt=="function"?ct!==nt||!rt:!nt.has(ct))throw new TypeError("Cannot read private member from an object whose class did not declare it");return ot==="m"?rt:ot==="a"?rt.call(ct):rt?rt.value:nt.get(ct)},__classPrivateFieldSet=globalThis&&globalThis.__classPrivateFieldSet||function(ct,nt,ot,rt,ut){if(rt==="m")throw new TypeError("Private method is not writable");if(rt==="a"&&!ut)throw new TypeError("Private accessor was defined without a setter");if(typeof nt=="function"?ct!==nt||!ut:!nt.has(ct))throw new TypeError("Cannot write private member to an object whose class did not declare it");return rt==="a"?ut.call(ct,ot):ut?ut.value=ot:nt.set(ct,ot),ot},_CodeActionModel_isDisposed;const SUPPORTED_CODE_ACTIONS=new RawContextKey("supportedCodeAction","");class CodeActionOracle extends Disposable{constructor(nt,ot,rt,ut=250){super(),this._editor=nt,this._markerService=ot,this._signalChange=rt,this._delay=ut,this._autoTriggerTimer=this._register(new TimeoutTimer),this._register(this._markerService.onMarkerChanged(gt=>this._onMarkerChanges(gt))),this._register(this._editor.onDidChangeCursorPosition(()=>this._tryAutoTrigger()))}trigger(nt){const ot=this._getRangeOfSelectionUnlessWhitespaceEnclosed(nt);this._signalChange(ot?{trigger:nt,selection:ot}:void 0)}_onMarkerChanges(nt){const ot=this._editor.getModel();ot&&nt.some(rt=>isEqual(rt,ot.uri))&&this._tryAutoTrigger()}_tryAutoTrigger(){this._autoTriggerTimer.cancelAndSet(()=>{this.trigger({type:2,triggerAction:CodeActionTriggerSource.Default})},this._delay)}_getRangeOfSelectionUnlessWhitespaceEnclosed(nt){if(!this._editor.hasModel())return;const ot=this._editor.getModel(),rt=this._editor.getSelection();if(rt.isEmpty()&&nt.type===2){const{lineNumber:ut,column:gt}=rt.getPosition(),pt=ot.getLineContent(ut);if(pt.length===0)return;if(gt===1){if(/\s/.test(pt[0]))return}else if(gt===ot.getLineMaxColumn(ut)){if(/\s/.test(pt[pt.length-1]))return}else if(/\s/.test(pt[gt-2])&&/\s/.test(pt[gt-1]))return}return rt}}var CodeActionsState;(function(ct){ct.Empty={type:0};class nt{constructor(rt,ut,gt){this.trigger=rt,this.position=ut,this._cancellablePromise=gt,this.type=1,this.actions=gt.catch(pt=>{if(isCancellationError(pt))return emptyCodeActionSet;throw pt})}cancel(){this._cancellablePromise.cancel()}}ct.Triggered=nt})(CodeActionsState||(CodeActionsState={}));const emptyCodeActionSet=Object.freeze({allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1});class CodeActionModel extends Disposable{constructor(nt,ot,rt,ut,gt){super(),this._editor=nt,this._registry=ot,this._markerService=rt,this._progressService=gt,this._codeActionOracle=this._register(new MutableDisposable),this._state=CodeActionsState.Empty,this._onDidChangeState=this._register(new Emitter$2),this.onDidChangeState=this._onDidChangeState.event,_CodeActionModel_isDisposed.set(this,!1),this._supportedCodeActions=SUPPORTED_CODE_ACTIONS.bindTo(ut),this._register(this._editor.onDidChangeModel(()=>this._update())),this._register(this._editor.onDidChangeModelLanguage(()=>this._update())),this._register(this._registry.onDidChange(()=>this._update())),this._update()}dispose(){__classPrivateFieldGet(this,_CodeActionModel_isDisposed,"f")||(__classPrivateFieldSet(this,_CodeActionModel_isDisposed,!0,"f"),super.dispose(),this.setState(CodeActionsState.Empty,!0))}_update(){if(__classPrivateFieldGet(this,_CodeActionModel_isDisposed,"f"))return;this._codeActionOracle.value=void 0,this.setState(CodeActionsState.Empty);const nt=this._editor.getModel();if(nt&&this._registry.has(nt)&&!this._editor.getOption(87)){const ot=this._registry.all(nt).flatMap(rt=>{var ut;return(ut=rt.providedCodeActionKinds)!==null&&ut!==void 0?ut:[]});this._supportedCodeActions.set(ot.join(" ")),this._codeActionOracle.value=new CodeActionOracle(this._editor,this._markerService,rt=>{var ut;if(!rt){this.setState(CodeActionsState.Empty);return}const gt=createCancelablePromise(pt=>getCodeActions(this._registry,nt,rt.selection,rt.trigger,Progress.None,pt));rt.trigger.type===1&&((ut=this._progressService)===null||ut===void 0||ut.showWhile(gt,250)),this.setState(new CodeActionsState.Triggered(rt.trigger,rt.selection.getStartPosition(),gt))},void 0),this._codeActionOracle.value.trigger({type:2,triggerAction:CodeActionTriggerSource.Default})}else this._supportedCodeActions.reset()}trigger(nt){var ot;(ot=this._codeActionOracle.value)===null||ot===void 0||ot.trigger(nt)}setState(nt,ot){nt!==this._state&&(this._state.type===1&&this._state.cancel(),this._state=nt,!ot&&!__classPrivateFieldGet(this,_CodeActionModel_isDisposed,"f")&&this._onDidChangeState.fire(nt))}}_CodeActionModel_isDisposed=new WeakMap;var __decorate$1k=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1k=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$Z=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let CodeActionController=class dr extends Disposable{static get(nt){return nt.getContribution(dr.ID)}constructor(nt,ot,rt,ut,gt,pt){super(),this._instantiationService=gt,this._editor=nt,this._model=this._register(new CodeActionModel(this._editor,pt.codeActionProvider,ot,rt,ut)),this._register(this._model.onDidChangeState(mt=>this._ui.value.update(mt))),this._ui=new Lazy(()=>this._register(gt.createInstance(CodeActionUi,nt,{applyCodeAction:(mt,vt,St)=>__awaiter$Z(this,void 0,void 0,function*(){try{yield this._applyCodeAction(mt,St)}finally{vt&&this._trigger({type:2,triggerAction:CodeActionTriggerSource.QuickFix,filter:{}})}})})))}showCodeActions(nt,ot,rt){return this._ui.value.showCodeActionList(ot,rt,{includeDisabledActions:!1,fromLightbulb:!1})}manualTriggerAtCurrentPosition(nt,ot,rt,ut){var gt;if(!this._editor.hasModel())return;(gt=MessageController.get(this._editor))===null||gt===void 0||gt.closeMessage();const pt=this._editor.getPosition();this._trigger({type:1,triggerAction:ot,filter:rt,autoApply:ut,context:{notAvailableMessage:nt,position:pt}})}_trigger(nt){return this._model.trigger(nt)}_applyCodeAction(nt,ot){return this._instantiationService.invokeFunction(applyCodeAction,nt,ApplyCodeActionReason.FromCodeActions,{preview:ot,editor:this._editor})}};CodeActionController.ID="editor.contrib.codeActionController";CodeActionController=__decorate$1k([__param$1k(1,IMarkerService),__param$1k(2,IContextKeyService),__param$1k(3,IEditorProgressService),__param$1k(4,IInstantiationService),__param$1k(5,ILanguageFeaturesService)],CodeActionController);function contextKeyForSupportedActions(ct){return ContextKeyExpr.regex(SUPPORTED_CODE_ACTIONS.keys()[0],new RegExp("(\\s|^)"+escapeRegExpCharacters(ct.value)+"\\b"))}const argsSchema={type:"object",defaultSnippets:[{body:{kind:""}}],properties:{kind:{type:"string",description:localize("args.schema.kind","Kind of the code action to run.")},apply:{type:"string",description:localize("args.schema.apply","Controls when the returned actions are applied."),default:"ifSingle",enum:["first","ifSingle","never"],enumDescriptions:[localize("args.schema.apply.first","Always apply the first returned code action."),localize("args.schema.apply.ifSingle","Apply the first returned code action if it is the only one."),localize("args.schema.apply.never","Do not apply the returned code actions.")]},preferred:{type:"boolean",default:!1,description:localize("args.schema.preferred","Controls if only preferred code actions should be returned.")}}};function triggerCodeActionsForEditorSelection(ct,nt,ot,rt,ut=CodeActionTriggerSource.Default){if(ct.hasModel()){const gt=CodeActionController.get(ct);gt==null||gt.manualTriggerAtCurrentPosition(nt,ut,ot,rt)}}class QuickFixAction extends EditorAction{constructor(){super({id:quickFixCommandId,label:localize("quickfix.trigger.label","Quick Fix..."),alias:"Quick Fix...",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasCodeActionsProvider),kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2137,weight:100}})}run(nt,ot){return triggerCodeActionsForEditorSelection(ot,localize("editor.action.quickFix.noneMessage","No code actions available"),void 0,void 0,CodeActionTriggerSource.QuickFix)}}class CodeActionCommand extends EditorCommand{constructor(){super({id:codeActionCommandId,precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasCodeActionsProvider),description:{description:"Trigger a code action",args:[{name:"args",schema:argsSchema}]}})}runEditorCommand(nt,ot,rt){const ut=CodeActionCommandArgs.fromUser(rt,{kind:CodeActionKind.Empty,apply:"ifSingle"});return triggerCodeActionsForEditorSelection(ot,typeof(rt==null?void 0:rt.kind)=="string"?ut.preferred?localize("editor.action.codeAction.noneMessage.preferred.kind","No preferred code actions for '{0}' available",rt.kind):localize("editor.action.codeAction.noneMessage.kind","No code actions for '{0}' available",rt.kind):ut.preferred?localize("editor.action.codeAction.noneMessage.preferred","No preferred code actions available"):localize("editor.action.codeAction.noneMessage","No code actions available"),{include:ut.kind,includeSourceActions:!0,onlyIncludePreferredActions:ut.preferred},ut.apply)}}class RefactorAction extends EditorAction{constructor(){super({id:refactorCommandId,label:localize("refactor.label","Refactor..."),alias:"Refactor...",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasCodeActionsProvider),kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:3120,mac:{primary:1328},weight:100},contextMenuOpts:{group:"1_modification",order:2,when:ContextKeyExpr.and(EditorContextKeys.writable,contextKeyForSupportedActions(CodeActionKind.Refactor))},description:{description:"Refactor...",args:[{name:"args",schema:argsSchema}]}})}run(nt,ot,rt){const ut=CodeActionCommandArgs.fromUser(rt,{kind:CodeActionKind.Refactor,apply:"never"});return triggerCodeActionsForEditorSelection(ot,typeof(rt==null?void 0:rt.kind)=="string"?ut.preferred?localize("editor.action.refactor.noneMessage.preferred.kind","No preferred refactorings for '{0}' available",rt.kind):localize("editor.action.refactor.noneMessage.kind","No refactorings for '{0}' available",rt.kind):ut.preferred?localize("editor.action.refactor.noneMessage.preferred","No preferred refactorings available"):localize("editor.action.refactor.noneMessage","No refactorings available"),{include:CodeActionKind.Refactor.contains(ut.kind)?ut.kind:CodeActionKind.None,onlyIncludePreferredActions:ut.preferred},ut.apply,CodeActionTriggerSource.Refactor)}}class SourceAction extends EditorAction{constructor(){super({id:sourceActionCommandId,label:localize("source.label","Source Action..."),alias:"Source Action...",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasCodeActionsProvider),contextMenuOpts:{group:"1_modification",order:2.1,when:ContextKeyExpr.and(EditorContextKeys.writable,contextKeyForSupportedActions(CodeActionKind.Source))},description:{description:"Source Action...",args:[{name:"args",schema:argsSchema}]}})}run(nt,ot,rt){const ut=CodeActionCommandArgs.fromUser(rt,{kind:CodeActionKind.Source,apply:"never"});return triggerCodeActionsForEditorSelection(ot,typeof(rt==null?void 0:rt.kind)=="string"?ut.preferred?localize("editor.action.source.noneMessage.preferred.kind","No preferred source actions for '{0}' available",rt.kind):localize("editor.action.source.noneMessage.kind","No source actions for '{0}' available",rt.kind):ut.preferred?localize("editor.action.source.noneMessage.preferred","No preferred source actions available"):localize("editor.action.source.noneMessage","No source actions available"),{include:CodeActionKind.Source.contains(ut.kind)?ut.kind:CodeActionKind.None,includeSourceActions:!0,onlyIncludePreferredActions:ut.preferred},ut.apply,CodeActionTriggerSource.SourceAction)}}class OrganizeImportsAction extends EditorAction{constructor(){super({id:organizeImportsCommandId,label:localize("organizeImports.label","Organize Imports"),alias:"Organize Imports",precondition:ContextKeyExpr.and(EditorContextKeys.writable,contextKeyForSupportedActions(CodeActionKind.SourceOrganizeImports)),kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:1581,weight:100}})}run(nt,ot){return triggerCodeActionsForEditorSelection(ot,localize("editor.action.organize.noneMessage","No organize imports action available"),{include:CodeActionKind.SourceOrganizeImports,includeSourceActions:!0},"ifSingle",CodeActionTriggerSource.OrganizeImports)}}class FixAllAction extends EditorAction{constructor(){super({id:fixAllCommandId,label:localize("fixAll.label","Fix All"),alias:"Fix All",precondition:ContextKeyExpr.and(EditorContextKeys.writable,contextKeyForSupportedActions(CodeActionKind.SourceFixAll))})}run(nt,ot){return triggerCodeActionsForEditorSelection(ot,localize("fixAll.noneMessage","No fix all action available"),{include:CodeActionKind.SourceFixAll,includeSourceActions:!0},"ifSingle",CodeActionTriggerSource.FixAll)}}class AutoFixAction extends EditorAction{constructor(){super({id:autoFixCommandId,label:localize("autoFix.label","Auto Fix..."),alias:"Auto Fix...",precondition:ContextKeyExpr.and(EditorContextKeys.writable,contextKeyForSupportedActions(CodeActionKind.QuickFix)),kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:1625,mac:{primary:2649},weight:100}})}run(nt,ot){return triggerCodeActionsForEditorSelection(ot,localize("editor.action.autoFix.noneMessage","No auto fixes available"),{include:CodeActionKind.QuickFix,onlyIncludePreferredActions:!0},"ifSingle",CodeActionTriggerSource.AutoFix)}}registerEditorContribution(CodeActionController.ID,CodeActionController,3);registerEditorContribution(LightBulbWidget.ID,LightBulbWidget,4);registerEditorAction(QuickFixAction);registerEditorAction(RefactorAction);registerEditorAction(SourceAction);registerEditorAction(OrganizeImportsAction);registerEditorAction(AutoFixAction);registerEditorAction(FixAllAction);registerEditorCommand(new CodeActionCommand);Registry.as(Extensions$8.Configuration).registerConfiguration(Object.assign(Object.assign({},editorConfigurationBaseNode),{properties:{"editor.codeActionWidget.showHeaders":{type:"boolean",scope:5,description:localize("showCodeActionHeaders","Enable/disable showing group headers in the Code Action menu."),default:!0}}}));var __awaiter$Y=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class CodeLensModel{constructor(){this.lenses=[],this._disposables=new DisposableStore}dispose(){this._disposables.dispose()}get isDisposed(){return this._disposables.isDisposed}add(nt,ot){this._disposables.add(nt);for(const rt of nt.lenses)this.lenses.push({symbol:rt,provider:ot})}}function getCodeLensModel(ct,nt,ot){return __awaiter$Y(this,void 0,void 0,function*(){const rt=ct.ordered(nt),ut=new Map,gt=new CodeLensModel,pt=rt.map((mt,vt)=>__awaiter$Y(this,void 0,void 0,function*(){ut.set(mt,vt);try{const St=yield Promise.resolve(mt.provideCodeLenses(nt,ot));St&&gt.add(St,mt)}catch(St){onUnexpectedExternalError(St)}}));return yield Promise.all(pt),gt.lenses=gt.lenses.sort((mt,vt)=>mt.symbol.range.startLineNumber<vt.symbol.range.startLineNumber?-1:mt.symbol.range.startLineNumber>vt.symbol.range.startLineNumber?1:ut.get(mt.provider)<ut.get(vt.provider)?-1:ut.get(mt.provider)>ut.get(vt.provider)?1:mt.symbol.range.startColumn<vt.symbol.range.startColumn?-1:mt.symbol.range.startColumn>vt.symbol.range.startColumn?1:0),gt})}CommandsRegistry.registerCommand("_executeCodeLensProvider",function(ct,...nt){let[ot,rt]=nt;assertType(URI.isUri(ot)),assertType(typeof rt=="number"||!rt);const{codeLensProvider:ut}=ct.get(ILanguageFeaturesService),gt=ct.get(IModelService).getModel(ot);if(!gt)throw illegalArgument();const pt=[],mt=new DisposableStore;return getCodeLensModel(ut,gt,CancellationToken.None).then(vt=>{mt.add(vt);const St=[];for(const yt of vt.lenses)rt==null||yt.symbol.command?pt.push(yt.symbol):rt-- >0&&yt.provider.resolveCodeLens&&St.push(Promise.resolve(yt.provider.resolveCodeLens(gt,yt.symbol,CancellationToken.None)).then(wt=>pt.push(wt||yt.symbol)));return Promise.all(St)}).then(()=>pt).finally(()=>{setTimeout(()=>mt.dispose(),100)})});var __decorate$1j=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1j=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const ICodeLensCache=createDecorator("ICodeLensCache");class CacheItem{constructor(nt,ot){this.lineCount=nt,this.data=ot}}let CodeLensCache=class{constructor(nt){this._fakeProvider=new class{provideCodeLenses(){throw new Error("not supported")}},this._cache=new LRUCache(20,.75);const ot="codelens/cache";runWhenIdle(()=>nt.remove(ot,1));const rt="codelens/cache2",ut=nt.get(rt,1,"{}");this._deserialize(ut),once$1(nt.onWillSaveState)(gt=>{gt.reason===WillSaveStateReason.SHUTDOWN&&nt.store(rt,this._serialize(),1,1)})}put(nt,ot){const rt=ot.lenses.map(pt=>{var mt;return{range:pt.symbol.range,command:pt.symbol.command&&{id:"",title:(mt=pt.symbol.command)===null||mt===void 0?void 0:mt.title}}}),ut=new CodeLensModel;ut.add({lenses:rt,dispose:()=>{}},this._fakeProvider);const gt=new CacheItem(nt.getLineCount(),ut);this._cache.set(nt.uri.toString(),gt)}get(nt){const ot=this._cache.get(nt.uri.toString());return ot&&ot.lineCount===nt.getLineCount()?ot.data:void 0}delete(nt){this._cache.delete(nt.uri.toString())}_serialize(){const nt=Object.create(null);for(const[ot,rt]of this._cache){const ut=new Set;for(const gt of rt.data.lenses)ut.add(gt.symbol.range.startLineNumber);nt[ot]={lineCount:rt.lineCount,lines:[...ut.values()]}}return JSON.stringify(nt)}_deserialize(nt){try{const ot=JSON.parse(nt);for(const rt in ot){const ut=ot[rt],gt=[];for(const mt of ut.lines)gt.push({range:new Range$2(mt,1,mt,11)});const pt=new CodeLensModel;pt.add({lenses:gt,dispose(){}},this._fakeProvider),this._cache.set(rt,new CacheItem(ut.lineCount,pt))}}catch{}}};CodeLensCache=__decorate$1j([__param$1j(0,IStorageService)],CodeLensCache);registerSingleton(ICodeLensCache,CodeLensCache,1);const codelensWidget="";class CodeLensViewZone{constructor(nt,ot,rt){this.afterColumn=1073741824,this.afterLineNumber=nt,this.heightInPx=ot,this._onHeight=rt,this.suppressMouseDown=!0,this.domNode=document.createElement("div")}onComputedHeight(nt){this._lastHeight===void 0?this._lastHeight=nt:this._lastHeight!==nt&&(this._lastHeight=nt,this._onHeight())}isVisible(){return this._lastHeight!==0&&this.domNode.hasAttribute("monaco-visible-view-zone")}}class CodeLensContentWidget{constructor(nt,ot){this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this._commands=new Map,this._isEmpty=!0,this._editor=nt,this._id=`codelens.widget-${CodeLensContentWidget._idPool++}`,this.updatePosition(ot),this._domNode=document.createElement("span"),this._domNode.className="codelens-decoration"}withCommands(nt,ot){this._commands.clear();const rt=[];let ut=!1;for(let gt=0;gt<nt.length;gt++){const pt=nt[gt];if(pt&&(ut=!0,pt.command)){const mt=renderLabelWithIcons(pt.command.title.trim());pt.command.id?(rt.push($$d("a",{id:String(gt),title:pt.command.tooltip,role:"button"},...mt)),this._commands.set(String(gt),pt.command)):rt.push($$d("span",{title:pt.command.tooltip},...mt)),gt+1<nt.length&&rt.push($$d("span",void 0,"|"))}}ut?(reset(this._domNode,...rt),this._isEmpty&&ot&&this._domNode.classList.add("fadein"),this._isEmpty=!1):reset(this._domNode,$$d("span",void 0,"no commands"))}getCommand(nt){return nt.parentElement===this._domNode?this._commands.get(nt.id):void 0}getId(){return this._id}getDomNode(){return this._domNode}updatePosition(nt){const ot=this._editor.getModel().getLineFirstNonWhitespaceColumn(nt);this._widgetPosition={position:{lineNumber:nt,column:ot},preference:[1]}}getPosition(){return this._widgetPosition||null}}CodeLensContentWidget._idPool=0;class CodeLensHelper{constructor(){this._removeDecorations=[],this._addDecorations=[],this._addDecorationsCallbacks=[]}addDecoration(nt,ot){this._addDecorations.push(nt),this._addDecorationsCallbacks.push(ot)}removeDecoration(nt){this._removeDecorations.push(nt)}commit(nt){const ot=nt.deltaDecorations(this._removeDecorations,this._addDecorations);for(let rt=0,ut=ot.length;rt<ut;rt++)this._addDecorationsCallbacks[rt](ot[rt])}}const codeLensDecorationOptions=ModelDecorationOptions.register({collapseOnReplaceEdit:!0,description:"codelens"});class CodeLensWidget{constructor(nt,ot,rt,ut,gt,pt){this._isDisposed=!1,this._editor=ot,this._data=nt,this._decorationIds=[];let mt;const vt=[];this._data.forEach((St,yt)=>{St.symbol.command&&vt.push(St.symbol),rt.addDecoration({range:St.symbol.range,options:codeLensDecorationOptions},wt=>this._decorationIds[yt]=wt),mt?mt=Range$2.plusRange(mt,St.symbol.range):mt=Range$2.lift(St.symbol.range)}),this._viewZone=new CodeLensViewZone(mt.startLineNumber-1,gt,pt),this._viewZoneId=ut.addZone(this._viewZone),vt.length>0&&(this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(vt,!1))}_createContentWidgetIfNecessary(){this._contentWidget?this._editor.layoutContentWidget(this._contentWidget):(this._contentWidget=new CodeLensContentWidget(this._editor,this._viewZone.afterLineNumber+1),this._editor.addContentWidget(this._contentWidget))}dispose(nt,ot){this._decorationIds.forEach(nt.removeDecoration,nt),this._decorationIds=[],ot==null||ot.removeZone(this._viewZoneId),this._contentWidget&&(this._editor.removeContentWidget(this._contentWidget),this._contentWidget=void 0),this._isDisposed=!0}isDisposed(){return this._isDisposed}isValid(){return this._decorationIds.some((nt,ot)=>{const rt=this._editor.getModel().getDecorationRange(nt),ut=this._data[ot].symbol;return!!(rt&&Range$2.isEmpty(ut.range)===rt.isEmpty())})}updateCodeLensSymbols(nt,ot){this._decorationIds.forEach(ot.removeDecoration,ot),this._decorationIds=[],this._data=nt,this._data.forEach((rt,ut)=>{ot.addDecoration({range:rt.symbol.range,options:codeLensDecorationOptions},gt=>this._decorationIds[ut]=gt)})}updateHeight(nt,ot){this._viewZone.heightInPx=nt,ot.layoutZone(this._viewZoneId),this._contentWidget&&this._editor.layoutContentWidget(this._contentWidget)}computeIfNecessary(nt){if(!this._viewZone.isVisible())return null;for(let ot=0;ot<this._decorationIds.length;ot++){const rt=nt.getDecorationRange(this._decorationIds[ot]);rt&&(this._data[ot].symbol.range=rt)}return this._data}updateCommands(nt){this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(nt,!0);for(let ot=0;ot<this._data.length;ot++){const rt=nt[ot];if(rt){const{symbol:ut}=this._data[ot];ut.command=rt.command||ut.command}}}getCommand(nt){var ot;return(ot=this._contentWidget)===null||ot===void 0?void 0:ot.getCommand(nt)}getLineNumber(){const nt=this._editor.getModel().getDecorationRange(this._decorationIds[0]);return nt?nt.startLineNumber:-1}update(nt){if(this.isValid()){const ot=this._editor.getModel().getDecorationRange(this._decorationIds[0]);ot&&(this._viewZone.afterLineNumber=ot.startLineNumber-1,nt.layoutZone(this._viewZoneId),this._contentWidget&&(this._contentWidget.updatePosition(ot.startLineNumber),this._editor.layoutContentWidget(this._contentWidget)))}}}var __decorate$1i=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1i=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$X=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let CodeLensContribution=class{constructor(nt,ot,rt,ut,gt,pt){this._editor=nt,this._languageFeaturesService=ot,this._commandService=ut,this._notificationService=gt,this._codeLensCache=pt,this._disposables=new DisposableStore,this._localToDispose=new DisposableStore,this._lenses=[],this._oldCodeLensModels=new DisposableStore,this._provideCodeLensDebounce=rt.for(ot.codeLensProvider,"CodeLensProvide",{min:250}),this._resolveCodeLensesDebounce=rt.for(ot.codeLensProvider,"CodeLensResolve",{min:250,salt:"resolve"}),this._resolveCodeLensesScheduler=new RunOnceScheduler(()=>this._resolveCodeLensesInViewport(),this._resolveCodeLensesDebounce.default()),this._disposables.add(this._editor.onDidChangeModel(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeConfiguration(mt=>{(mt.hasChanged(48)||mt.hasChanged(17)||mt.hasChanged(16))&&this._updateLensStyle(),mt.hasChanged(15)&&this._onModelChange()})),this._disposables.add(ot.codeLensProvider.onDidChange(this._onModelChange,this)),this._onModelChange(),this._updateLensStyle()}dispose(){var nt;this._localDispose(),this._disposables.dispose(),this._oldCodeLensModels.dispose(),(nt=this._currentCodeLensModel)===null||nt===void 0||nt.dispose()}_getLayoutInfo(){const nt=Math.max(1.3,this._editor.getOption(64)/this._editor.getOption(50));let ot=this._editor.getOption(17);return(!ot||ot<5)&&(ot=this._editor.getOption(50)*.9|0),{fontSize:ot,codeLensHeight:ot*nt|0}}_updateLensStyle(){const{codeLensHeight:nt,fontSize:ot}=this._getLayoutInfo(),rt=this._editor.getOption(16),ut=this._editor.getOption(48),{style:gt}=this._editor.getContainerDomNode();gt.setProperty("--vscode-editorCodeLens-lineHeight",`${nt}px`),gt.setProperty("--vscode-editorCodeLens-fontSize",`${ot}px`),gt.setProperty("--vscode-editorCodeLens-fontFeatureSettings",ut.fontFeatureSettings),rt&&(gt.setProperty("--vscode-editorCodeLens-fontFamily",rt),gt.setProperty("--vscode-editorCodeLens-fontFamilyDefault",EDITOR_FONT_DEFAULTS.fontFamily)),this._editor.changeViewZones(pt=>{for(const mt of this._lenses)mt.updateHeight(nt,pt)})}_localDispose(){var nt,ot,rt;(nt=this._getCodeLensModelPromise)===null||nt===void 0||nt.cancel(),this._getCodeLensModelPromise=void 0,(ot=this._resolveCodeLensesPromise)===null||ot===void 0||ot.cancel(),this._resolveCodeLensesPromise=void 0,this._localToDispose.clear(),this._oldCodeLensModels.clear(),(rt=this._currentCodeLensModel)===null||rt===void 0||rt.dispose()}_onModelChange(){this._localDispose();const nt=this._editor.getModel();if(!nt||!this._editor.getOption(15))return;const ot=this._codeLensCache.get(nt);if(ot&&this._renderCodeLensSymbols(ot),!this._languageFeaturesService.codeLensProvider.has(nt)){ot&&this._localToDispose.add(disposableTimeout(()=>{const ut=this._codeLensCache.get(nt);ot===ut&&(this._codeLensCache.delete(nt),this._onModelChange())},30*1e3));return}for(const ut of this._languageFeaturesService.codeLensProvider.all(nt))if(typeof ut.onDidChange=="function"){const gt=ut.onDidChange(()=>rt.schedule());this._localToDispose.add(gt)}const rt=new RunOnceScheduler(()=>{var ut;const gt=Date.now();(ut=this._getCodeLensModelPromise)===null||ut===void 0||ut.cancel(),this._getCodeLensModelPromise=createCancelablePromise(pt=>getCodeLensModel(this._languageFeaturesService.codeLensProvider,nt,pt)),this._getCodeLensModelPromise.then(pt=>{this._currentCodeLensModel&&this._oldCodeLensModels.add(this._currentCodeLensModel),this._currentCodeLensModel=pt,this._codeLensCache.put(nt,pt);const mt=this._provideCodeLensDebounce.update(nt,Date.now()-gt);rt.delay=mt,this._renderCodeLensSymbols(pt),this._resolveCodeLensesInViewportSoon()},onUnexpectedError)},this._provideCodeLensDebounce.get(nt));this._localToDispose.add(rt),this._localToDispose.add(toDisposable(()=>this._resolveCodeLensesScheduler.cancel())),this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{var ut;this._editor.changeDecorations(gt=>{this._editor.changeViewZones(pt=>{const mt=[];let vt=-1;this._lenses.forEach(yt=>{!yt.isValid()||vt===yt.getLineNumber()?mt.push(yt):(yt.update(pt),vt=yt.getLineNumber())});const St=new CodeLensHelper;mt.forEach(yt=>{yt.dispose(St,pt),this._lenses.splice(this._lenses.indexOf(yt),1)}),St.commit(gt)})}),rt.schedule(),this._resolveCodeLensesScheduler.cancel(),(ut=this._resolveCodeLensesPromise)===null||ut===void 0||ut.cancel(),this._resolveCodeLensesPromise=void 0})),this._localToDispose.add(this._editor.onDidFocusEditorWidget(()=>{rt.schedule()})),this._localToDispose.add(this._editor.onDidScrollChange(ut=>{ut.scrollTopChanged&&this._lenses.length>0&&this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(this._editor.onDidLayoutChange(()=>{this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(toDisposable(()=>{if(this._editor.getModel()){const ut=StableEditorScrollState.capture(this._editor);this._editor.changeDecorations(gt=>{this._editor.changeViewZones(pt=>{this._disposeAllLenses(gt,pt)})}),ut.restore(this._editor)}else this._disposeAllLenses(void 0,void 0)})),this._localToDispose.add(this._editor.onMouseDown(ut=>{if(ut.target.type!==9)return;let gt=ut.target.element;if((gt==null?void 0:gt.tagName)==="SPAN"&&(gt=gt.parentElement),(gt==null?void 0:gt.tagName)==="A")for(const pt of this._lenses){const mt=pt.getCommand(gt);if(mt){this._commandService.executeCommand(mt.id,...mt.arguments||[]).catch(vt=>this._notificationService.error(vt));break}}})),rt.schedule()}_disposeAllLenses(nt,ot){const rt=new CodeLensHelper;for(const ut of this._lenses)ut.dispose(rt,ot);nt&&rt.commit(nt),this._lenses.length=0}_renderCodeLensSymbols(nt){if(!this._editor.hasModel())return;const ot=this._editor.getModel().getLineCount(),rt=[];let ut;for(const mt of nt.lenses){const vt=mt.symbol.range.startLineNumber;vt<1||vt>ot||(ut&&ut[ut.length-1].symbol.range.startLineNumber===vt?ut.push(mt):(ut=[mt],rt.push(ut)))}if(!rt.length&&!this._lenses.length)return;const gt=StableEditorScrollState.capture(this._editor),pt=this._getLayoutInfo();this._editor.changeDecorations(mt=>{this._editor.changeViewZones(vt=>{const St=new CodeLensHelper;let yt=0,wt=0;for(;wt<rt.length&&yt<this._lenses.length;){const Lt=rt[wt][0].symbol.range.startLineNumber,xt=this._lenses[yt].getLineNumber();xt<Lt?(this._lenses[yt].dispose(St,vt),this._lenses.splice(yt,1)):xt===Lt?(this._lenses[yt].updateCodeLensSymbols(rt[wt],St),wt++,yt++):(this._lenses.splice(yt,0,new CodeLensWidget(rt[wt],this._editor,St,vt,pt.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),yt++,wt++)}for(;yt<this._lenses.length;)this._lenses[yt].dispose(St,vt),this._lenses.splice(yt,1);for(;wt<rt.length;)this._lenses.push(new CodeLensWidget(rt[wt],this._editor,St,vt,pt.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),wt++;St.commit(mt)})}),gt.restore(this._editor)}_resolveCodeLensesInViewportSoon(){this._editor.getModel()&&this._resolveCodeLensesScheduler.schedule()}_resolveCodeLensesInViewport(){var nt;(nt=this._resolveCodeLensesPromise)===null||nt===void 0||nt.cancel(),this._resolveCodeLensesPromise=void 0;const ot=this._editor.getModel();if(!ot)return;const rt=[],ut=[];if(this._lenses.forEach(mt=>{const vt=mt.computeIfNecessary(ot);vt&&(rt.push(vt),ut.push(mt))}),rt.length===0)return;const gt=Date.now(),pt=createCancelablePromise(mt=>{const vt=rt.map((St,yt)=>{const wt=new Array(St.length),Lt=St.map((xt,It)=>!xt.symbol.command&&typeof xt.provider.resolveCodeLens=="function"?Promise.resolve(xt.provider.resolveCodeLens(ot,xt.symbol,mt)).then(kt=>{wt[It]=kt},onUnexpectedExternalError):(wt[It]=xt.symbol,Promise.resolve(void 0)));return Promise.all(Lt).then(()=>{!mt.isCancellationRequested&&!ut[yt].isDisposed()&&ut[yt].updateCommands(wt)})});return Promise.all(vt)});this._resolveCodeLensesPromise=pt,this._resolveCodeLensesPromise.then(()=>{const mt=this._resolveCodeLensesDebounce.update(ot,Date.now()-gt);this._resolveCodeLensesScheduler.delay=mt,this._currentCodeLensModel&&this._codeLensCache.put(ot,this._currentCodeLensModel),this._oldCodeLensModels.clear(),pt===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)},mt=>{onUnexpectedError(mt),pt===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)})}getModel(){return this._currentCodeLensModel}};CodeLensContribution.ID="css.editor.codeLens";CodeLensContribution=__decorate$1i([__param$1i(1,ILanguageFeaturesService),__param$1i(2,ILanguageFeatureDebounceService),__param$1i(3,ICommandService),__param$1i(4,INotificationService),__param$1i(5,ICodeLensCache)],CodeLensContribution);registerEditorContribution(CodeLensContribution.ID,CodeLensContribution,1);registerEditorAction(class extends EditorAction{constructor(){super({id:"codelens.showLensesInCurrentLine",precondition:EditorContextKeys.hasCodeLensProvider,label:localize("showLensOnLine","Show CodeLens Commands For Current Line"),alias:"Show CodeLens Commands For Current Line"})}run(nt,ot){return __awaiter$X(this,void 0,void 0,function*(){if(!ot.hasModel())return;const rt=nt.get(IQuickInputService),ut=nt.get(ICommandService),gt=nt.get(INotificationService),pt=ot.getSelection().positionLineNumber,mt=ot.getContribution(CodeLensContribution.ID);if(!mt)return;const vt=mt.getModel();if(!vt)return;const St=[];for(const wt of vt.lenses)wt.symbol.command&&wt.symbol.range.startLineNumber===pt&&St.push({label:wt.symbol.command.title,command:wt.symbol.command});if(St.length===0)return;const yt=yield rt.pick(St,{canPickMany:!1});if(yt){if(vt.isDisposed)return yield ut.executeCommand(this.id);try{yield ut.executeCommand(yt.command.id,...yt.command.arguments||[])}catch(wt){gt.error(wt)}}})}});var __decorate$1h=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1h=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$W=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class DefaultDocumentColorProvider{constructor(nt,ot){this._editorWorkerClient=new EditorWorkerClient(nt,!1,"editorWorkerService",ot)}provideDocumentColors(nt,ot){return __awaiter$W(this,void 0,void 0,function*(){return this._editorWorkerClient.computeDefaultDocumentColors(nt.uri)})}provideColorPresentations(nt,ot,rt){const ut=ot.range,gt=ot.color,pt=gt.alpha,mt=new Color(new RGBA(Math.round(255*gt.red),Math.round(255*gt.green),Math.round(255*gt.blue),pt)),vt=pt?Color.Format.CSS.formatRGB(mt):Color.Format.CSS.formatRGBA(mt),St=pt?Color.Format.CSS.formatHSL(mt):Color.Format.CSS.formatHSLA(mt),yt=pt?Color.Format.CSS.formatHex(mt):Color.Format.CSS.formatHexA(mt),wt=[];return wt.push({label:vt,textEdit:{range:ut,text:vt}}),wt.push({label:St,textEdit:{range:ut,text:St}}),wt.push({label:yt,textEdit:{range:ut,text:yt}}),wt}}let DefaultDocumentColorProviderFeature=class extends Disposable{constructor(nt,ot,rt){super(),this._register(rt.colorProvider.register("*",new DefaultDocumentColorProvider(nt,ot)))}};DefaultDocumentColorProviderFeature=__decorate$1h([__param$1h(0,IModelService),__param$1h(1,ILanguageConfigurationService),__param$1h(2,ILanguageFeaturesService)],DefaultDocumentColorProviderFeature);registerEditorFeature(DefaultDocumentColorProviderFeature);var __awaiter$V=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function getColors(ct,nt,ot,rt=!0){return __awaiter$V(this,void 0,void 0,function*(){return _findColorData(new ColorDataCollector,ct,nt,ot,rt)})}function getColorPresentations(ct,nt,ot,rt){return Promise.resolve(ot.provideColorPresentations(ct,nt,rt))}class ColorDataCollector{constructor(){}compute(nt,ot,rt,ut){return __awaiter$V(this,void 0,void 0,function*(){const gt=yield nt.provideDocumentColors(ot,rt);if(Array.isArray(gt))for(const pt of gt)ut.push({colorInfo:pt,provider:nt});return Array.isArray(gt)})}}class ExtColorDataCollector{constructor(){}compute(nt,ot,rt,ut){return __awaiter$V(this,void 0,void 0,function*(){const gt=yield nt.provideDocumentColors(ot,rt);if(Array.isArray(gt))for(const pt of gt)ut.push({range:pt.range,color:[pt.color.red,pt.color.green,pt.color.blue,pt.color.alpha]});return Array.isArray(gt)})}}class ColorPresentationsCollector{constructor(nt){this.colorInfo=nt}compute(nt,ot,rt,ut){return __awaiter$V(this,void 0,void 0,function*(){const gt=yield nt.provideColorPresentations(ot,this.colorInfo,CancellationToken.None);return Array.isArray(gt)&&ut.push(...gt),Array.isArray(gt)})}}function _findColorData(ct,nt,ot,rt,ut){return __awaiter$V(this,void 0,void 0,function*(){let gt=!1,pt;const mt=[],vt=nt.ordered(ot);for(let St=vt.length-1;St>=0;St--){const yt=vt[St];if(yt instanceof DefaultDocumentColorProvider)pt=yt;else try{gt||(gt=yield ct.compute(yt,ot,rt,mt))}catch(wt){onUnexpectedExternalError(wt)}}return gt?mt:pt&&ut?(yield ct.compute(pt,ot,rt,mt),mt):[]})}function _setupColorCommand(ct,nt){const{colorProvider:ot}=ct.get(ILanguageFeaturesService),rt=ct.get(IModelService).getModel(nt);if(!rt)throw illegalArgument();const ut=ct.get(IConfigurationService).getValue("editor.defaultColorDecorators",{resource:nt});return{model:rt,colorProviderRegistry:ot,isDefaultColorDecoratorsEnabled:ut}}CommandsRegistry.registerCommand("_executeDocumentColorProvider",function(ct,...nt){const[ot]=nt;if(!(ot instanceof URI))throw illegalArgument();const{model:rt,colorProviderRegistry:ut,isDefaultColorDecoratorsEnabled:gt}=_setupColorCommand(ct,ot);return _findColorData(new ExtColorDataCollector,ut,rt,CancellationToken.None,gt)});CommandsRegistry.registerCommand("_executeColorPresentationProvider",function(ct,...nt){const[ot,rt]=nt,{uri:ut,range:gt}=rt;if(!(ut instanceof URI)||!Array.isArray(ot)||ot.length!==4||!Range$2.isIRange(gt))throw illegalArgument();const{model:pt,colorProviderRegistry:mt,isDefaultColorDecoratorsEnabled:vt}=_setupColorCommand(ct,ut),[St,yt,wt,Lt]=ot;return _findColorData(new ColorPresentationsCollector({range:gt,color:{red:St,green:yt,blue:wt,alpha:Lt}}),mt,pt,CancellationToken.None,vt)});var __decorate$1g=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1g=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$U=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const ColorDecorationInjectedTextMarker=Object.create({});let ColorDetector=class ur extends Disposable{constructor(nt,ot,rt,ut){super(),this._editor=nt,this._configurationService=ot,this._languageFeaturesService=rt,this._localToDispose=this._register(new DisposableStore),this._decorationsIds=[],this._colorDatas=new Map,this._colorDecoratorIds=this._editor.createDecorationsCollection(),this._ruleFactory=new DynamicCssRules(this._editor),this._decoratorLimitReporter=new DecoratorLimitReporter,this._colorDecorationClassRefs=this._register(new DisposableStore),this._debounceInformation=ut.for(rt.colorProvider,"Document Colors",{min:ur.RECOMPUTE_TIME}),this._register(nt.onDidChangeModel(()=>{this._isColorDecoratorsEnabled=this.isEnabled(),this.updateColors()})),this._register(nt.onDidChangeModelLanguage(()=>this.updateColors())),this._register(rt.colorProvider.onDidChange(()=>this.updateColors())),this._register(nt.onDidChangeConfiguration(gt=>{const pt=this._isColorDecoratorsEnabled;this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(141);const mt=pt!==this._isColorDecoratorsEnabled||gt.hasChanged(19),vt=gt.hasChanged(141);(mt||vt)&&(this._isColorDecoratorsEnabled?this.updateColors():this.removeAllDecorations())})),this._timeoutTimer=null,this._computePromise=null,this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(141),this.updateColors()}isEnabled(){const nt=this._editor.getModel();if(!nt)return!1;const ot=nt.getLanguageId(),rt=this._configurationService.getValue(ot);if(rt&&typeof rt=="object"){const ut=rt.colorDecorators;if(ut&&ut.enable!==void 0&&!ut.enable)return ut.enable}return this._editor.getOption(18)}static get(nt){return nt.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}updateColors(){if(this.stop(),!this._isColorDecoratorsEnabled)return;const nt=this._editor.getModel();!nt||!this._languageFeaturesService.colorProvider.has(nt)||(this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._timeoutTimer||(this._timeoutTimer=new TimeoutTimer,this._timeoutTimer.cancelAndSet(()=>{this._timeoutTimer=null,this.beginCompute()},this._debounceInformation.get(nt)))})),this.beginCompute())}beginCompute(){return __awaiter$U(this,void 0,void 0,function*(){this._computePromise=createCancelablePromise(nt=>__awaiter$U(this,void 0,void 0,function*(){const ot=this._editor.getModel();if(!ot)return[];const rt=new StopWatch(!1),ut=yield getColors(this._languageFeaturesService.colorProvider,ot,nt,this._isDefaultColorDecoratorsEnabled);return this._debounceInformation.update(ot,rt.elapsed()),ut}));try{const nt=yield this._computePromise;this.updateDecorations(nt),this.updateColorDecorators(nt),this._computePromise=null}catch(nt){onUnexpectedError(nt)}})}stop(){this._timeoutTimer&&(this._timeoutTimer.cancel(),this._timeoutTimer=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose.clear()}updateDecorations(nt){const ot=nt.map(rt=>({range:{startLineNumber:rt.colorInfo.range.startLineNumber,startColumn:rt.colorInfo.range.startColumn,endLineNumber:rt.colorInfo.range.endLineNumber,endColumn:rt.colorInfo.range.endColumn},options:ModelDecorationOptions.EMPTY}));this._editor.changeDecorations(rt=>{this._decorationsIds=rt.deltaDecorations(this._decorationsIds,ot),this._colorDatas=new Map,this._decorationsIds.forEach((ut,gt)=>this._colorDatas.set(ut,nt[gt]))})}updateColorDecorators(nt){this._colorDecorationClassRefs.clear();const ot=[],rt=this._editor.getOption(19);for(let gt=0;gt<nt.length&&ot.length<rt;gt++){const{red:pt,green:mt,blue:vt,alpha:St}=nt[gt].colorInfo.color,yt=new RGBA(Math.round(pt*255),Math.round(mt*255),Math.round(vt*255),St),wt=`rgba(${yt.r}, ${yt.g}, ${yt.b}, ${yt.a})`,Lt=this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({backgroundColor:wt}));ot.push({range:{startLineNumber:nt[gt].colorInfo.range.startLineNumber,startColumn:nt[gt].colorInfo.range.startColumn,endLineNumber:nt[gt].colorInfo.range.endLineNumber,endColumn:nt[gt].colorInfo.range.endColumn},options:{description:"colorDetector",before:{content:noBreakWhitespace,inlineClassName:`${Lt.className} colorpicker-color-decoration`,inlineClassNameAffectsLetterSpacing:!0,attachedData:ColorDecorationInjectedTextMarker}}})}const ut=rt<nt.length?rt:!1;this._decoratorLimitReporter.update(nt.length,ut),this._colorDecoratorIds.set(ot)}removeAllDecorations(){this._editor.removeDecorations(this._decorationsIds),this._decorationsIds=[],this._colorDecoratorIds.clear(),this._colorDecorationClassRefs.clear()}getColorData(nt){const ot=this._editor.getModel();if(!ot)return null;const rt=ot.getDecorationsInRange(Range$2.fromPositions(nt,nt)).filter(ut=>this._colorDatas.has(ut.id));return rt.length===0?null:this._colorDatas.get(rt[0].id)}isColorDecoration(nt){return this._colorDecoratorIds.has(nt)}};ColorDetector.ID="editor.contrib.colorDetector";ColorDetector.RECOMPUTE_TIME=1e3;ColorDetector=__decorate$1g([__param$1g(1,IConfigurationService),__param$1g(2,ILanguageFeaturesService),__param$1g(3,ILanguageFeatureDebounceService)],ColorDetector);class DecoratorLimitReporter{constructor(){this._onDidChange=new Emitter$2,this._computed=0,this._limited=!1}update(nt,ot){(nt!==this._computed||ot!==this._limited)&&(this._computed=nt,this._limited=ot,this._onDidChange.fire())}}registerEditorContribution(ColorDetector.ID,ColorDetector,1);class ColorPickerModel{get color(){return this._color}set color(nt){this._color.equals(nt)||(this._color=nt,this._onDidChangeColor.fire(nt))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(nt){this._colorPresentations=nt,this.presentationIndex>nt.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}constructor(nt,ot,rt){this.presentationIndex=rt,this._onColorFlushed=new Emitter$2,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new Emitter$2,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new Emitter$2,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=nt,this._color=nt,this._colorPresentations=ot}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(nt,ot){let rt=-1;for(let ut=0;ut<this.colorPresentations.length;ut++)if(ot.toLowerCase()===this.colorPresentations[ut].label){rt=ut;break}if(rt===-1){const ut=ot.split("(")[0].toLowerCase();for(let gt=0;gt<this.colorPresentations.length;gt++)if(this.colorPresentations[gt].label.toLowerCase().startsWith(ut)){rt=gt;break}}rt!==-1&&rt!==this.presentationIndex&&(this.presentationIndex=rt,this._onDidChangePresentation.fire(this.presentation))}flushColor(){this._onColorFlushed.fire(this._color)}}const colorPicker="",$$6=$$d;class ColorPickerHeader extends Disposable{constructor(nt,ot,rt,ut=!1){super(),this.model=ot,this.showingStandaloneColorPicker=ut,this._closeButton=null,this._domNode=$$6(".colorpicker-header"),append$1(nt,this._domNode),this._pickedColorNode=append$1(this._domNode,$$6(".picked-color"));const gt=localize("clickToToggleColorOptions","Click to toggle color options (rgb/hsl/hex)");this._pickedColorNode.setAttribute("title",gt),this._originalColorNode=append$1(this._domNode,$$6(".original-color")),this._originalColorNode.style.backgroundColor=Color.Format.CSS.format(this.model.originalColor)||"",this.backgroundColor=rt.getColorTheme().getColor(editorHoverBackground)||Color.white,this._register(rt.onDidColorThemeChange(pt=>{this.backgroundColor=pt.getColor(editorHoverBackground)||Color.white})),this._register(addDisposableListener(this._pickedColorNode,EventType$1.CLICK,()=>this.model.selectNextColorPresentation())),this._register(addDisposableListener(this._originalColorNode,EventType$1.CLICK,()=>{this.model.color=this.model.originalColor,this.model.flushColor()})),this._register(ot.onDidChangeColor(this.onDidChangeColor,this)),this._register(ot.onDidChangePresentation(this.onDidChangePresentation,this)),this._pickedColorNode.style.backgroundColor=Color.Format.CSS.format(ot.color)||"",this._pickedColorNode.classList.toggle("light",ot.color.rgba.a<.5?this.backgroundColor.isLighter():ot.color.isLighter()),this.onDidChangeColor(this.model.color),this.showingStandaloneColorPicker&&(this._domNode.classList.add("standalone-colorpicker"),this._closeButton=this._register(new CloseButton(this._domNode)))}get closeButton(){return this._closeButton}get pickedColorNode(){return this._pickedColorNode}get originalColorNode(){return this._originalColorNode}onDidChangeColor(nt){this._pickedColorNode.style.backgroundColor=Color.Format.CSS.format(nt)||"",this._pickedColorNode.classList.toggle("light",nt.rgba.a<.5?this.backgroundColor.isLighter():nt.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this._pickedColorNode.textContent=this.model.presentation?this.model.presentation.label:"",this._pickedColorNode.prepend($$6(".codicon.codicon-color-mode"))}}class CloseButton extends Disposable{constructor(nt){super(),this._onClicked=this._register(new Emitter$2),this.onClicked=this._onClicked.event,this._button=document.createElement("div"),this._button.classList.add("close-button"),append$1(nt,this._button);const ot=document.createElement("div");ot.classList.add("close-button-inner-div"),append$1(this._button,ot),append$1(ot,$$6(".button"+ThemeIcon.asCSSSelector(registerIcon("color-picker-close",Codicon.close,localize("closeIcon","Icon to close the color picker"))))).classList.add("close-icon"),this._button.onclick=()=>{this._onClicked.fire()}}}class ColorPickerBody extends Disposable{constructor(nt,ot,rt,ut=!1){super(),this.model=ot,this.pixelRatio=rt,this._insertButton=null,this._domNode=$$6(".colorpicker-body"),append$1(nt,this._domNode),this._saturationBox=new SaturationBox(this._domNode,this.model,this.pixelRatio),this._register(this._saturationBox),this._register(this._saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this._saturationBox.onColorFlushed(this.flushColor,this)),this._opacityStrip=new OpacityStrip(this._domNode,this.model,ut),this._register(this._opacityStrip),this._register(this._opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this._opacityStrip.onColorFlushed(this.flushColor,this)),this._hueStrip=new HueStrip(this._domNode,this.model,ut),this._register(this._hueStrip),this._register(this._hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this._hueStrip.onColorFlushed(this.flushColor,this)),ut&&(this._insertButton=this._register(new InsertButton(this._domNode)),this._domNode.classList.add("standalone-colorpicker"))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:nt,v:ot}){const rt=this.model.color.hsva;this.model.color=new Color(new HSVA(rt.h,nt,ot,rt.a))}onDidOpacityChange(nt){const ot=this.model.color.hsva;this.model.color=new Color(new HSVA(ot.h,ot.s,ot.v,nt))}onDidHueChange(nt){const ot=this.model.color.hsva,rt=(1-nt)*360;this.model.color=new Color(new HSVA(rt===360?0:rt,ot.s,ot.v,ot.a))}get domNode(){return this._domNode}get saturationBox(){return this._saturationBox}get enterButton(){return this._insertButton}layout(){this._saturationBox.layout(),this._opacityStrip.layout(),this._hueStrip.layout()}}class SaturationBox extends Disposable{constructor(nt,ot,rt){super(),this.model=ot,this.pixelRatio=rt,this._onDidChange=new Emitter$2,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new Emitter$2,this.onColorFlushed=this._onColorFlushed.event,this._domNode=$$6(".saturation-wrap"),append$1(nt,this._domNode),this._canvas=document.createElement("canvas"),this._canvas.className="saturation-box",append$1(this._domNode,this._canvas),this.selection=$$6(".saturation-selection"),append$1(this._domNode,this.selection),this.layout(),this._register(addDisposableListener(this._domNode,EventType$1.POINTER_DOWN,ut=>this.onPointerDown(ut))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}get domNode(){return this._domNode}onPointerDown(nt){if(!nt.target||!(nt.target instanceof Element))return;this.monitor=this._register(new GlobalPointerMoveMonitor);const ot=getDomNodePagePosition(this._domNode);nt.target!==this.selection&&this.onDidChangePosition(nt.offsetX,nt.offsetY),this.monitor.startMonitoring(nt.target,nt.pointerId,nt.buttons,ut=>this.onDidChangePosition(ut.pageX-ot.left,ut.pageY-ot.top),()=>null);const rt=addDisposableListener(document,EventType$1.POINTER_UP,()=>{this._onColorFlushed.fire(),rt.dispose(),this.monitor&&(this.monitor.stopMonitoring(!0),this.monitor=null)},!0)}onDidChangePosition(nt,ot){const rt=Math.max(0,Math.min(1,nt/this.width)),ut=Math.max(0,Math.min(1,1-ot/this.height));this.paintSelection(rt,ut),this._onDidChange.fire({s:rt,v:ut})}layout(){this.width=this._domNode.offsetWidth,this.height=this._domNode.offsetHeight,this._canvas.width=this.width*this.pixelRatio,this._canvas.height=this.height*this.pixelRatio,this.paint();const nt=this.model.color.hsva;this.paintSelection(nt.s,nt.v)}paint(){const nt=this.model.color.hsva,ot=new Color(new HSVA(nt.h,1,1,1)),rt=this._canvas.getContext("2d"),ut=rt.createLinearGradient(0,0,this._canvas.width,0);ut.addColorStop(0,"rgba(255, 255, 255, 1)"),ut.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),ut.addColorStop(1,"rgba(255, 255, 255, 0)");const gt=rt.createLinearGradient(0,0,0,this._canvas.height);gt.addColorStop(0,"rgba(0, 0, 0, 0)"),gt.addColorStop(1,"rgba(0, 0, 0, 1)"),rt.rect(0,0,this._canvas.width,this._canvas.height),rt.fillStyle=Color.Format.CSS.format(ot),rt.fill(),rt.fillStyle=ut,rt.fill(),rt.fillStyle=gt,rt.fill()}paintSelection(nt,ot){this.selection.style.left=`${nt*this.width}px`,this.selection.style.top=`${this.height-ot*this.height}px`}onDidChangeColor(){this.monitor&&this.monitor.isMonitoring()||this.paint()}}class Strip extends Disposable{constructor(nt,ot,rt=!1){super(),this.model=ot,this._onDidChange=new Emitter$2,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new Emitter$2,this.onColorFlushed=this._onColorFlushed.event,rt?(this.domNode=append$1(nt,$$6(".standalone-strip")),this.overlay=append$1(this.domNode,$$6(".standalone-overlay"))):(this.domNode=append$1(nt,$$6(".strip")),this.overlay=append$1(this.domNode,$$6(".overlay"))),this.slider=append$1(this.domNode,$$6(".slider")),this.slider.style.top="0px",this._register(addDisposableListener(this.domNode,EventType$1.POINTER_DOWN,ut=>this.onPointerDown(ut))),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;const nt=this.getValue(this.model.color);this.updateSliderPosition(nt)}onPointerDown(nt){if(!nt.target||!(nt.target instanceof Element))return;const ot=this._register(new GlobalPointerMoveMonitor),rt=getDomNodePagePosition(this.domNode);this.domNode.classList.add("grabbing"),nt.target!==this.slider&&this.onDidChangeTop(nt.offsetY),ot.startMonitoring(nt.target,nt.pointerId,nt.buttons,gt=>this.onDidChangeTop(gt.pageY-rt.top),()=>null);const ut=addDisposableListener(document,EventType$1.POINTER_UP,()=>{this._onColorFlushed.fire(),ut.dispose(),ot.stopMonitoring(!0),this.domNode.classList.remove("grabbing")},!0)}onDidChangeTop(nt){const ot=Math.max(0,Math.min(1,1-nt/this.height));this.updateSliderPosition(ot),this._onDidChange.fire(ot)}updateSliderPosition(nt){this.slider.style.top=`${(1-nt)*this.height}px`}}class OpacityStrip extends Strip{constructor(nt,ot,rt=!1){super(nt,ot,rt),this.domNode.classList.add("opacity-strip"),this._register(ot.onDidChangeColor(this.onDidChangeColor,this)),this.onDidChangeColor(this.model.color)}onDidChangeColor(nt){const{r:ot,g:rt,b:ut}=nt.rgba,gt=new Color(new RGBA(ot,rt,ut,1)),pt=new Color(new RGBA(ot,rt,ut,0));this.overlay.style.background=`linear-gradient(to bottom, ${gt} 0%, ${pt} 100%)`}getValue(nt){return nt.hsva.a}}class HueStrip extends Strip{constructor(nt,ot,rt=!1){super(nt,ot,rt),this.domNode.classList.add("hue-strip")}getValue(nt){return 1-nt.hsva.h/360}}class InsertButton extends Disposable{constructor(nt){super(),this._onClicked=this._register(new Emitter$2),this.onClicked=this._onClicked.event,this._button=append$1(nt,document.createElement("button")),this._button.classList.add("insert-button"),this._button.textContent="Insert",this._button.onclick=ot=>{this._onClicked.fire()}}get button(){return this._button}}class ColorPickerWidget extends Widget$1{constructor(nt,ot,rt,ut,gt=!1){super(),this.model=ot,this.pixelRatio=rt,this._register(PixelRatio.onDidChange(()=>this.layout()));const pt=$$6(".colorpicker-widget");nt.appendChild(pt),this.header=this._register(new ColorPickerHeader(pt,this.model,ut,gt)),this.body=this._register(new ColorPickerBody(pt,this.model,this.pixelRatio,gt))}layout(){this.body.layout()}}var __decorate$1f=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1f=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$T=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class ColorHover{constructor(nt,ot,rt,ut){this.owner=nt,this.range=ot,this.model=rt,this.provider=ut,this.forceShowAtRange=!0}isValidForHoverAnchor(nt){return nt.type===1&&this.range.startColumn<=nt.range.startColumn&&this.range.endColumn>=nt.range.endColumn}}let ColorHoverParticipant=class{constructor(nt,ot){this._editor=nt,this._themeService=ot,this.hoverOrdinal=2}computeSync(nt,ot){return[]}computeAsync(nt,ot,rt){return AsyncIterableObject.fromPromise(this._computeAsync(nt,ot,rt))}_computeAsync(nt,ot,rt){return __awaiter$T(this,void 0,void 0,function*(){if(!this._editor.hasModel())return[];const ut=ColorDetector.get(this._editor);if(!ut)return[];for(const gt of ot){if(!ut.isColorDecoration(gt))continue;const pt=ut.getColorData(gt.range.getStartPosition());if(pt)return[yield _createColorHover(this,this._editor.getModel(),pt.colorInfo,pt.provider)]}return[]})}renderHoverParts(nt,ot){return renderHoverParts(this,this._editor,this._themeService,ot,nt)}};ColorHoverParticipant=__decorate$1f([__param$1f(1,IThemeService)],ColorHoverParticipant);class StandaloneColorPickerHover{constructor(nt,ot,rt,ut){this.owner=nt,this.range=ot,this.model=rt,this.provider=ut}}let StandaloneColorPickerParticipant=class{constructor(nt,ot){this._editor=nt,this._themeService=ot,this._color=null}createColorHover(nt,ot,rt){return __awaiter$T(this,void 0,void 0,function*(){if(!this._editor.hasModel()||!ColorDetector.get(this._editor))return null;const gt=yield getColors(rt,this._editor.getModel(),CancellationToken.None);let pt=null,mt=null;for(const wt of gt){const Lt=wt.colorInfo;Range$2.containsRange(Lt.range,nt.range)&&(pt=Lt,mt=wt.provider)}const vt=pt??nt,St=mt??ot,yt=!!pt;return{colorHover:yield _createColorHover(this,this._editor.getModel(),vt,St),foundInEditor:yt}})}updateEditorModel(nt){return __awaiter$T(this,void 0,void 0,function*(){if(!this._editor.hasModel())return;const ot=nt.model;let rt=new Range$2(nt.range.startLineNumber,nt.range.startColumn,nt.range.endLineNumber,nt.range.endColumn);this._color&&(yield _updateColorPresentations(this._editor.getModel(),ot,this._color,rt,nt),rt=_updateEditorModel(this._editor,rt,ot))})}renderHoverParts(nt,ot){return renderHoverParts(this,this._editor,this._themeService,ot,nt)}set color(nt){this._color=nt}get color(){return this._color}};StandaloneColorPickerParticipant=__decorate$1f([__param$1f(1,IThemeService)],StandaloneColorPickerParticipant);function _createColorHover(ct,nt,ot,rt){return __awaiter$T(this,void 0,void 0,function*(){const ut=nt.getValueInRange(ot.range),{red:gt,green:pt,blue:mt,alpha:vt}=ot.color,St=new RGBA(Math.round(gt*255),Math.round(pt*255),Math.round(mt*255),vt),yt=new Color(St),wt=yield getColorPresentations(nt,ot,rt,CancellationToken.None),Lt=new ColorPickerModel(yt,[],0);return Lt.colorPresentations=wt||[],Lt.guessColorPresentation(yt,ut),ct instanceof ColorHoverParticipant?new ColorHover(ct,Range$2.lift(ot.range),Lt,rt):new StandaloneColorPickerHover(ct,Range$2.lift(ot.range),Lt,rt)})}function renderHoverParts(ct,nt,ot,rt,ut){if(rt.length===0||!nt.hasModel())return Disposable.None;const gt=new DisposableStore,pt=rt[0],mt=nt.getModel(),vt=pt.model,St=gt.add(new ColorPickerWidget(ut.fragment,vt,nt.getOption(137),ot,ct instanceof StandaloneColorPickerParticipant));ut.setColorPicker(St);let yt=new Range$2(pt.range.startLineNumber,pt.range.startColumn,pt.range.endLineNumber,pt.range.endColumn);if(ct instanceof StandaloneColorPickerParticipant){const wt=rt[0].model.color;ct.color=wt,_updateColorPresentations(mt,vt,wt,yt,pt),gt.add(vt.onColorFlushed(Lt=>{ct.color=Lt}))}else gt.add(vt.onColorFlushed(wt=>__awaiter$T(this,void 0,void 0,function*(){yield _updateColorPresentations(mt,vt,wt,yt,pt),yt=_updateEditorModel(nt,yt,vt,ut)})));return gt.add(vt.onDidChangeColor(wt=>{_updateColorPresentations(mt,vt,wt,yt,pt)})),gt}function _updateEditorModel(ct,nt,ot,rt){let ut,gt;if(ot.presentation.textEdit){ut=[ot.presentation.textEdit],gt=new Range$2(ot.presentation.textEdit.range.startLineNumber,ot.presentation.textEdit.range.startColumn,ot.presentation.textEdit.range.endLineNumber,ot.presentation.textEdit.range.endColumn);const pt=ct.getModel()._setTrackedRange(null,gt,3);ct.pushUndoStop(),ct.executeEdits("colorpicker",ut),gt=ct.getModel()._getTrackedRange(pt)||gt}else ut=[{range:nt,text:ot.presentation.label,forceMoveMarkers:!1}],gt=nt.setEndPosition(nt.endLineNumber,nt.startColumn+ot.presentation.label.length),ct.pushUndoStop(),ct.executeEdits("colorpicker",ut);return ot.presentation.additionalTextEdits&&(ut=[...ot.presentation.additionalTextEdits],ct.executeEdits("colorpicker",ut),rt&&rt.hide()),ct.pushUndoStop(),gt}function _updateColorPresentations(ct,nt,ot,rt,ut){return __awaiter$T(this,void 0,void 0,function*(){const gt=yield getColorPresentations(ct,{range:rt,color:{red:ot.rgba.r/255,green:ot.rgba.g/255,blue:ot.rgba.b/255,alpha:ot.rgba.a}},ut.provider,CancellationToken.None);nt.colorPresentations=gt||[]})}const goToDefinitionAtPosition="";function hasModifier(ct,nt){return!!ct[nt]}class ClickLinkMouseEvent{constructor(nt,ot){this.target=nt.target,this.isLeftClick=nt.event.leftButton,this.isMiddleClick=nt.event.middleButton,this.isRightClick=nt.event.rightButton,this.hasTriggerModifier=hasModifier(nt.event,ot.triggerModifier),this.hasSideBySideModifier=hasModifier(nt.event,ot.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=nt.event.detail<=1}}class ClickLinkKeyboardEvent{constructor(nt,ot){this.keyCodeIsTriggerKey=nt.keyCode===ot.triggerKey,this.keyCodeIsSideBySideKey=nt.keyCode===ot.triggerSideBySideKey,this.hasTriggerModifier=hasModifier(nt,ot.triggerModifier)}}class ClickLinkOptions{constructor(nt,ot,rt,ut){this.triggerKey=nt,this.triggerModifier=ot,this.triggerSideBySideKey=rt,this.triggerSideBySideModifier=ut}equals(nt){return this.triggerKey===nt.triggerKey&&this.triggerModifier===nt.triggerModifier&&this.triggerSideBySideKey===nt.triggerSideBySideKey&&this.triggerSideBySideModifier===nt.triggerSideBySideModifier}}function createOptions(ct){return ct==="altKey"?isMacintosh?new ClickLinkOptions(57,"metaKey",6,"altKey"):new ClickLinkOptions(5,"ctrlKey",6,"altKey"):isMacintosh?new ClickLinkOptions(6,"altKey",57,"metaKey"):new ClickLinkOptions(6,"altKey",5,"ctrlKey")}class ClickLinkGesture extends Disposable{constructor(nt,ot){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new Emitter$2),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new Emitter$2),this.onExecute=this._onExecute.event,this._onCancel=this._register(new Emitter$2),this.onCancel=this._onCancel.event,this._editor=nt,this._alwaysFireExecuteOnMouseUp=ot,this._opts=createOptions(this._editor.getOption(75)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration(rt=>{if(rt.hasChanged(75)){const ut=createOptions(this._editor.getOption(75));if(this._opts.equals(ut))return;this._opts=ut,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}})),this._register(this._editor.onMouseMove(rt=>this._onEditorMouseMove(new ClickLinkMouseEvent(rt,this._opts)))),this._register(this._editor.onMouseDown(rt=>this._onEditorMouseDown(new ClickLinkMouseEvent(rt,this._opts)))),this._register(this._editor.onMouseUp(rt=>this._onEditorMouseUp(new ClickLinkMouseEvent(rt,this._opts)))),this._register(this._editor.onKeyDown(rt=>this._onEditorKeyDown(new ClickLinkKeyboardEvent(rt,this._opts)))),this._register(this._editor.onKeyUp(rt=>this._onEditorKeyUp(new ClickLinkKeyboardEvent(rt,this._opts)))),this._register(this._editor.onMouseDrag(()=>this._resetHandler())),this._register(this._editor.onDidChangeCursorSelection(rt=>this._onDidChangeCursorSelection(rt))),this._register(this._editor.onDidChangeModel(rt=>this._resetHandler())),this._register(this._editor.onDidChangeModelContent(()=>this._resetHandler())),this._register(this._editor.onDidScrollChange(rt=>{(rt.scrollTopChanged||rt.scrollLeftChanged)&&this._resetHandler()}))}_onDidChangeCursorSelection(nt){nt.selection&&nt.selection.startColumn!==nt.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(nt){this._lastMouseMoveEvent=nt,this._onMouseMoveOrRelevantKeyDown.fire([nt,null])}_onEditorMouseDown(nt){this._hasTriggerKeyOnMouseDown=nt.hasTriggerModifier,this._lineNumberOnMouseDown=nt.target.position?nt.target.position.lineNumber:0}_onEditorMouseUp(nt){const ot=nt.target.position?nt.target.position.lineNumber:0;(this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===ot||this._alwaysFireExecuteOnMouseUp)&&this._onExecute.fire(nt)}_onEditorKeyDown(nt){this._lastMouseMoveEvent&&(nt.keyCodeIsTriggerKey||nt.keyCodeIsSideBySideKey&&nt.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,nt]):nt.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(nt){nt.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}const peekViewWidget="";var __decorate$1e=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1e=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let EmbeddedCodeEditorWidget=class extends CodeEditorWidget{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt,xt){super(nt,Object.assign(Object.assign({},ut.getRawOptions()),{overflowWidgetsDomNode:ut.getOverflowWidgetsDomNode()}),rt,gt,pt,mt,vt,St,yt,wt,Lt,xt),this._parentEditor=ut,this._overwriteOptions=ot,super.updateOptions(this._overwriteOptions),this._register(ut.onDidChangeConfiguration(It=>this._onParentConfigurationChanged(It)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(nt){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(nt){mixin$1(this._overwriteOptions,nt,!0),super.updateOptions(this._overwriteOptions)}};EmbeddedCodeEditorWidget=__decorate$1e([__param$1e(4,IInstantiationService),__param$1e(5,ICodeEditorService),__param$1e(6,ICommandService),__param$1e(7,IContextKeyService),__param$1e(8,IThemeService),__param$1e(9,INotificationService),__param$1e(10,IAccessibilityService),__param$1e(11,ILanguageConfigurationService),__param$1e(12,ILanguageFeaturesService)],EmbeddedCodeEditorWidget);const zoneWidget="",defaultColor=new Color(new RGBA(0,122,204)),defaultOptions$1={showArrow:!0,showFrame:!0,className:"",frameColor:defaultColor,arrowColor:defaultColor,keepEditorSelection:!1},WIDGET_ID="vs.editor.contrib.zoneWidget";class ViewZoneDelegate{constructor(nt,ot,rt,ut,gt,pt,mt,vt){this.id="",this.domNode=nt,this.afterLineNumber=ot,this.afterColumn=rt,this.heightInLines=ut,this.showInHiddenAreas=mt,this.ordinal=vt,this._onDomNodeTop=gt,this._onComputedHeight=pt}onDomNodeTop(nt){this._onDomNodeTop(nt)}onComputedHeight(nt){this._onComputedHeight(nt)}}class OverlayWidgetDelegate{constructor(nt,ot){this._id=nt,this._domNode=ot}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}class Arrow{constructor(nt){this._editor=nt,this._ruleName=Arrow._IdGenerator.nextId(),this._decorations=this._editor.createDecorationsCollection(),this._color=null,this._height=-1}dispose(){this.hide(),removeCSSRulesContainingSelector(this._ruleName)}set color(nt){this._color!==nt&&(this._color=nt,this._updateStyle())}set height(nt){this._height!==nt&&(this._height=nt,this._updateStyle())}_updateStyle(){removeCSSRulesContainingSelector(this._ruleName),createCSSRule(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `)}show(nt){nt.column===1&&(nt={lineNumber:nt.lineNumber,column:2}),this._decorations.set([{range:Range$2.fromPositions(nt),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._decorations.clear()}}Arrow._IdGenerator=new IdGenerator(".arrow-decoration-");class ZoneWidget{constructor(nt,ot={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._viewZone=null,this._disposables=new DisposableStore,this.container=null,this._isShowing=!1,this.editor=nt,this._positionMarkerId=this.editor.createDecorationsCollection(),this.options=deepClone(ot),mixin$1(this.options,defaultOptions$1,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange(rt=>{const ut=this._getWidth(rt);this.domNode.style.width=ut+"px",this.domNode.style.left=this._getLeft(rt)+"px",this._onWidth(ut)}))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones(nt=>{this._viewZone&&nt.removeZone(this._viewZone.id),this._viewZone=null}),this._positionMarkerId.clear(),this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new Arrow(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(nt){nt.frameColor&&(this.options.frameColor=nt.frameColor),nt.arrowColor&&(this.options.arrowColor=nt.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){const nt=this.options.frameColor.toString();this.container.style.borderTopColor=nt,this.container.style.borderBottomColor=nt}if(this._arrow&&this.options.arrowColor){const nt=this.options.arrowColor.toString();this._arrow.color=nt}}_getWidth(nt){return nt.width-nt.minimap.minimapWidth-nt.verticalScrollbarWidth}_getLeft(nt){return nt.minimap.minimapWidth>0&&nt.minimap.minimapLeft===0?nt.minimap.minimapWidth:0}_onViewZoneTop(nt){this.domNode.style.top=nt+"px"}_onViewZoneHeight(nt){var ot;if(this.domNode.style.height=`${nt}px`,this.container){const rt=nt-this._decoratingElementsHeight();this.container.style.height=`${rt}px`;const ut=this.editor.getLayoutInfo();this._doLayout(rt,this._getWidth(ut))}(ot=this._resizeSash)===null||ot===void 0||ot.layout()}get position(){const nt=this._positionMarkerId.getRange(0);if(nt)return nt.getStartPosition()}show(nt,ot){const rt=Range$2.isIRange(nt)?Range$2.lift(nt):Range$2.fromPositions(nt);this._isShowing=!0,this._showImpl(rt,ot),this._isShowing=!1,this._positionMarkerId.set([{range:rt,options:ModelDecorationOptions.EMPTY}])}hide(){var nt;this._viewZone&&(this.editor.changeViewZones(ot=>{this._viewZone&&ot.removeZone(this._viewZone.id)}),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),(nt=this._arrow)===null||nt===void 0||nt.hide()}_decoratingElementsHeight(){const nt=this.editor.getOption(64);let ot=0;if(this.options.showArrow){const rt=Math.round(nt/3);ot+=2*rt}if(this.options.showFrame){const rt=Math.round(nt/9);ot+=2*rt}return ot}_showImpl(nt,ot){const rt=nt.getStartPosition(),ut=this.editor.getLayoutInfo(),gt=this._getWidth(ut);this.domNode.style.width=`${gt}px`,this.domNode.style.left=this._getLeft(ut)+"px";const pt=document.createElement("div");pt.style.overflow="hidden";const mt=this.editor.getOption(64),vt=Math.max(12,this.editor.getLayoutInfo().height/mt*.8);ot=Math.min(ot,vt);let St=0,yt=0;if(this._arrow&&this.options.showArrow&&(St=Math.round(mt/3),this._arrow.height=St,this._arrow.show(rt)),this.options.showFrame&&(yt=Math.round(mt/9)),this.editor.changeViewZones(xt=>{this._viewZone&&xt.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new ViewZoneDelegate(pt,rt.lineNumber,rt.column,ot,It=>this._onViewZoneTop(It),It=>this._onViewZoneHeight(It),this.options.showInHiddenAreas,this.options.ordinal),this._viewZone.id=xt.addZone(this._viewZone),this._overlayWidget=new OverlayWidgetDelegate(WIDGET_ID+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)}),this.container&&this.options.showFrame){const xt=this.options.frameWidth?this.options.frameWidth:yt;this.container.style.borderTopWidth=xt+"px",this.container.style.borderBottomWidth=xt+"px"}const wt=ot*mt-this._decoratingElementsHeight();this.container&&(this.container.style.top=St+"px",this.container.style.height=wt+"px",this.container.style.overflow="hidden"),this._doLayout(wt,gt),this.options.keepEditorSelection||this.editor.setSelection(nt);const Lt=this.editor.getModel();if(Lt){const xt=Lt.validateRange(new Range$2(nt.startLineNumber,1,nt.endLineNumber+1,1));this.revealRange(xt,xt.endLineNumber===Lt.getLineCount())}}revealRange(nt,ot){ot?this.editor.revealLineNearTop(nt.endLineNumber,0):this.editor.revealRange(nt,0)}setCssClass(nt,ot){this.container&&(ot&&this.container.classList.remove(ot),this.container.classList.add(nt))}_onWidth(nt){}_doLayout(nt,ot){}_relayout(nt){this._viewZone&&this._viewZone.heightInLines!==nt&&this.editor.changeViewZones(ot=>{this._viewZone&&(this._viewZone.heightInLines=nt,ot.layoutZone(this._viewZone.id))})}_initSash(){if(this._resizeSash)return;this._resizeSash=this._disposables.add(new Sash(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.state=0);let nt;this._disposables.add(this._resizeSash.onDidStart(ot=>{this._viewZone&&(nt={startY:ot.startY,heightInLines:this._viewZone.heightInLines})})),this._disposables.add(this._resizeSash.onDidEnd(()=>{nt=void 0})),this._disposables.add(this._resizeSash.onDidChange(ot=>{if(nt){const rt=(ot.currentY-nt.startY)/this.editor.getOption(64),ut=rt<0?Math.ceil(rt):Math.floor(rt),gt=nt.heightInLines+ut;gt>5&&gt<35&&this._relayout(gt)}}))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(this.domNode.style.height===null?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const nt=this.editor.getLayoutInfo();return nt.width-nt.minimap.minimapWidth}}var __decorate$1d=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1d=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const IPeekViewService=createDecorator("IPeekViewService");registerSingleton(IPeekViewService,class{constructor(){this._widgets=new Map}addExclusiveWidget(ct,nt){const ot=this._widgets.get(ct);ot&&(ot.listener.dispose(),ot.widget.dispose());const rt=()=>{const ut=this._widgets.get(ct);ut&&ut.widget===nt&&(ut.listener.dispose(),this._widgets.delete(ct))};this._widgets.set(ct,{widget:nt,listener:nt.onDidClose(rt)})}},1);var PeekContext;(function(ct){ct.inPeekEditor=new RawContextKey("inReferenceSearchEditor",!0,localize("inReferenceSearchEditor","Whether the current code editor is embedded inside peek")),ct.notInPeekEditor=ct.inPeekEditor.toNegated()})(PeekContext||(PeekContext={}));let PeekContextController=class{constructor(nt,ot){nt instanceof EmbeddedCodeEditorWidget&&PeekContext.inPeekEditor.bindTo(ot)}dispose(){}};PeekContextController.ID="editor.contrib.referenceController";PeekContextController=__decorate$1d([__param$1d(1,IContextKeyService)],PeekContextController);registerEditorContribution(PeekContextController.ID,PeekContextController,0);function getOuterEditor(ct){const nt=ct.get(ICodeEditorService).getFocusedCodeEditor();return nt instanceof EmbeddedCodeEditorWidget?nt.getParentEditor():nt}const defaultOptions={headerBackgroundColor:Color.white,primaryHeadingColor:Color.fromHex("#333333"),secondaryHeadingColor:Color.fromHex("#6c6c6cb3")};let PeekViewWidget=class extends ZoneWidget{constructor(nt,ot,rt){super(nt,ot),this.instantiationService=rt,this._onDidClose=new Emitter$2,this.onDidClose=this._onDidClose.event,mixin$1(this.options,defaultOptions,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(nt){const ot=this.options;nt.headerBackgroundColor&&(ot.headerBackgroundColor=nt.headerBackgroundColor),nt.primaryHeadingColor&&(ot.primaryHeadingColor=nt.primaryHeadingColor),nt.secondaryHeadingColor&&(ot.secondaryHeadingColor=nt.secondaryHeadingColor),super.style(nt)}_applyStyles(){super._applyStyles();const nt=this.options;this._headElement&&nt.headerBackgroundColor&&(this._headElement.style.backgroundColor=nt.headerBackgroundColor.toString()),this._primaryHeading&&nt.primaryHeadingColor&&(this._primaryHeading.style.color=nt.primaryHeadingColor.toString()),this._secondaryHeading&&nt.secondaryHeadingColor&&(this._secondaryHeading.style.color=nt.secondaryHeadingColor.toString()),this._bodyElement&&nt.frameColor&&(this._bodyElement.style.borderColor=nt.frameColor.toString())}_fillContainer(nt){this.setCssClass("peekview-widget"),this._headElement=$$d(".head"),this._bodyElement=$$d(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),nt.appendChild(this._headElement),nt.appendChild(this._bodyElement)}_fillHead(nt,ot){this._titleElement=$$d(".peekview-title"),this.options.supportOnTitleClick&&(this._titleElement.classList.add("clickable"),addStandardDisposableListener(this._titleElement,"click",gt=>this._onTitleClick(gt))),append$1(this._headElement,this._titleElement),this._fillTitleIcon(this._titleElement),this._primaryHeading=$$d("span.filename"),this._secondaryHeading=$$d("span.dirname"),this._metaHeading=$$d("span.meta"),append$1(this._titleElement,this._primaryHeading,this._secondaryHeading,this._metaHeading);const rt=$$d(".peekview-actions");append$1(this._headElement,rt);const ut=this._getActionBarOptions();this._actionbarWidget=new ActionBar(rt,ut),this._disposables.add(this._actionbarWidget),ot||this._actionbarWidget.push(new Action("peekview.close",localize("label.close","Close"),ThemeIcon.asClassName(Codicon.close),!0,()=>(this.dispose(),Promise.resolve())),{label:!1,icon:!0})}_fillTitleIcon(nt){}_getActionBarOptions(){return{actionViewItemProvider:createActionViewItem.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(nt){}setTitle(nt,ot){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=nt,this._primaryHeading.setAttribute("title",nt),ot?this._secondaryHeading.innerText=ot:clearNode(this._secondaryHeading))}setMetaTitle(nt){this._metaHeading&&(nt?(this._metaHeading.innerText=nt,show(this._metaHeading)):hide(this._metaHeading))}_doLayout(nt,ot){if(!this._isShowing&&nt<0){this.dispose();return}const rt=Math.ceil(this.editor.getOption(64)*1.2),ut=Math.round(nt-(rt+2));this._doLayoutHead(rt,ot),this._doLayoutBody(ut,ot)}_doLayoutHead(nt,ot){this._headElement&&(this._headElement.style.height=`${nt}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(nt,ot){this._bodyElement&&(this._bodyElement.style.height=`${nt}px`)}};PeekViewWidget=__decorate$1d([__param$1d(2,IInstantiationService)],PeekViewWidget);const peekViewTitleBackground=registerColor("peekViewTitle.background",{dark:"#252526",light:"#F3F3F3",hcDark:Color.black,hcLight:Color.white},localize("peekViewTitleBackground","Background color of the peek view title area.")),peekViewTitleForeground=registerColor("peekViewTitleLabel.foreground",{dark:Color.white,light:Color.black,hcDark:Color.white,hcLight:editorForeground},localize("peekViewTitleForeground","Color of the peek view title.")),peekViewTitleInfoForeground=registerColor("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hcDark:"#FFFFFF99",hcLight:"#292929"},localize("peekViewTitleInfoForeground","Color of the peek view title info.")),peekViewBorder=registerColor("peekView.border",{dark:editorInfoForeground,light:editorInfoForeground,hcDark:contrastBorder,hcLight:contrastBorder},localize("peekViewBorder","Color of the peek view borders and arrow.")),peekViewResultsBackground=registerColor("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hcDark:Color.black,hcLight:Color.white},localize("peekViewResultsBackground","Background color of the peek view result list."));registerColor("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hcDark:Color.white,hcLight:editorForeground},localize("peekViewResultsMatchForeground","Foreground color for line nodes in the peek view result list."));registerColor("peekViewResult.fileForeground",{dark:Color.white,light:"#1E1E1E",hcDark:Color.white,hcLight:editorForeground},localize("peekViewResultsFileForeground","Foreground color for file nodes in the peek view result list."));registerColor("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hcDark:null,hcLight:null},localize("peekViewResultsSelectionBackground","Background color of the selected entry in the peek view result list."));registerColor("peekViewResult.selectionForeground",{dark:Color.white,light:"#6C6C6C",hcDark:Color.white,hcLight:editorForeground},localize("peekViewResultsSelectionForeground","Foreground color of the selected entry in the peek view result list."));const peekViewEditorBackground=registerColor("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hcDark:Color.black,hcLight:Color.white},localize("peekViewEditorBackground","Background color of the peek view editor."));registerColor("peekViewEditorGutter.background",{dark:peekViewEditorBackground,light:peekViewEditorBackground,hcDark:peekViewEditorBackground,hcLight:peekViewEditorBackground},localize("peekViewEditorGutterBackground","Background color of the gutter in the peek view editor."));registerColor("peekViewEditorStickyScroll.background",{dark:peekViewEditorBackground,light:peekViewEditorBackground,hcDark:peekViewEditorBackground,hcLight:peekViewEditorBackground},localize("peekViewEditorStickScrollBackground","Background color of sticky scroll in the peek view editor."));registerColor("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hcDark:null,hcLight:null},localize("peekViewResultsMatchHighlight","Match highlight color in the peek view result list."));registerColor("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hcDark:null,hcLight:null},localize("peekViewEditorMatchHighlight","Match highlight color in the peek view editor."));registerColor("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("peekViewEditorMatchHighlightBorder","Match highlight border in the peek view editor."));var __awaiter$S=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class OneReference{constructor(nt,ot,rt,ut){this.isProviderFirst=nt,this.parent=ot,this.link=rt,this._rangeCallback=ut,this.id=defaultGenerator.nextId()}get uri(){return this.link.uri}get range(){var nt,ot;return(ot=(nt=this._range)!==null&&nt!==void 0?nt:this.link.targetSelectionRange)!==null&&ot!==void 0?ot:this.link.range}set range(nt){this._range=nt,this._rangeCallback(this)}get ariaMessage(){var nt;const ot=(nt=this.parent.getPreview(this))===null||nt===void 0?void 0:nt.preview(this.range);return ot?localize({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"symbol in {0} on line {1} at column {2}, {3}",basename(this.uri),this.range.startLineNumber,this.range.startColumn,ot.value):localize("aria.oneReference","symbol in {0} on line {1} at column {2}",basename(this.uri),this.range.startLineNumber,this.range.startColumn)}}class FilePreview{constructor(nt){this._modelReference=nt}dispose(){this._modelReference.dispose()}preview(nt,ot=8){const rt=this._modelReference.object.textEditorModel;if(!rt)return;const{startLineNumber:ut,startColumn:gt,endLineNumber:pt,endColumn:mt}=nt,vt=rt.getWordUntilPosition({lineNumber:ut,column:gt-ot}),St=new Range$2(ut,vt.startColumn,ut,gt),yt=new Range$2(pt,mt,pt,1073741824),wt=rt.getValueInRange(St).replace(/^\s+/,""),Lt=rt.getValueInRange(nt),xt=rt.getValueInRange(yt).replace(/\s+$/,"");return{value:wt+Lt+xt,highlight:{start:wt.length,end:wt.length+Lt.length}}}}class FileReferences{constructor(nt,ot){this.parent=nt,this.uri=ot,this.children=[],this._previews=new ResourceMap}dispose(){dispose(this._previews.values()),this._previews.clear()}getPreview(nt){return this._previews.get(nt.uri)}get ariaMessage(){const nt=this.children.length;return nt===1?localize("aria.fileReferences.1","1 symbol in {0}, full path {1}",basename(this.uri),this.uri.fsPath):localize("aria.fileReferences.N","{0} symbols in {1}, full path {2}",nt,basename(this.uri),this.uri.fsPath)}resolve(nt){return __awaiter$S(this,void 0,void 0,function*(){if(this._previews.size!==0)return this;for(const ot of this.children)if(!this._previews.has(ot.uri))try{const rt=yield nt.createModelReference(ot.uri);this._previews.set(ot.uri,new FilePreview(rt))}catch(rt){onUnexpectedError(rt)}return this})}}class ReferencesModel{constructor(nt,ot){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new Emitter$2,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=nt,this._title=ot;const[rt]=nt;nt.sort(ReferencesModel._compareReferences);let ut;for(const gt of nt)if((!ut||!extUri.isEqual(ut.uri,gt.uri,!0))&&(ut=new FileReferences(this,gt.uri),this.groups.push(ut)),ut.children.length===0||ReferencesModel._compareReferences(gt,ut.children[ut.children.length-1])!==0){const pt=new OneReference(rt===gt,ut,gt,mt=>this._onDidChangeReferenceRange.fire(mt));this.references.push(pt),ut.children.push(pt)}}dispose(){dispose(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new ReferencesModel(this._links,this._title)}get title(){return this._title}get isEmpty(){return this.groups.length===0}get ariaMessage(){return this.isEmpty?localize("aria.result.0","No results found"):this.references.length===1?localize("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):this.groups.length===1?localize("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):localize("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(nt,ot){const{parent:rt}=nt;let ut=rt.children.indexOf(nt);const gt=rt.children.length,pt=rt.parent.groups.length;return pt===1||ot&&ut+1<gt||!ot&&ut>0?(ot?ut=(ut+1)%gt:ut=(ut+gt-1)%gt,rt.children[ut]):(ut=rt.parent.groups.indexOf(rt),ot?(ut=(ut+1)%pt,rt.parent.groups[ut].children[0]):(ut=(ut+pt-1)%pt,rt.parent.groups[ut].children[rt.parent.groups[ut].children.length-1]))}nearestReference(nt,ot){const rt=this.references.map((ut,gt)=>({idx:gt,prefixLen:commonPrefixLength(ut.uri.toString(),nt.toString()),offsetDist:Math.abs(ut.range.startLineNumber-ot.lineNumber)*100+Math.abs(ut.range.startColumn-ot.column)})).sort((ut,gt)=>ut.prefixLen>gt.prefixLen?-1:ut.prefixLen<gt.prefixLen?1:ut.offsetDist<gt.offsetDist?-1:ut.offsetDist>gt.offsetDist?1:0)[0];if(rt)return this.references[rt.idx]}referenceAt(nt,ot){for(const rt of this.references)if(rt.uri.toString()===nt.toString()&&Range$2.containsPosition(rt.range,ot))return rt}firstReference(){for(const nt of this.references)if(nt.isProviderFirst)return nt;return this.references[0]}static _compareReferences(nt,ot){return extUri.compare(nt.uri,ot.uri)||Range$2.compareRangesUsingStarts(nt.range,ot.range)}}const referencesWidget="";var __decorate$1c=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1c=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let DataSource=class{constructor(nt){this._resolverService=nt}hasChildren(nt){return nt instanceof ReferencesModel||nt instanceof FileReferences}getChildren(nt){if(nt instanceof ReferencesModel)return nt.groups;if(nt instanceof FileReferences)return nt.resolve(this._resolverService).then(ot=>ot.children);throw new Error("bad tree")}};DataSource=__decorate$1c([__param$1c(0,ITextModelService)],DataSource);class Delegate{getHeight(){return 23}getTemplateId(nt){return nt instanceof FileReferences?FileReferencesRenderer.id:OneReferenceRenderer.id}}let StringRepresentationProvider=class{constructor(nt){this._keybindingService=nt}getKeyboardNavigationLabel(nt){var ot;if(nt instanceof OneReference){const rt=(ot=nt.parent.getPreview(nt))===null||ot===void 0?void 0:ot.preview(nt.range);if(rt)return rt.value}return basename(nt.uri)}};StringRepresentationProvider=__decorate$1c([__param$1c(0,IKeybindingService)],StringRepresentationProvider);class IdentityProvider{getId(nt){return nt instanceof OneReference?nt.id:nt.uri}}let FileReferencesTemplate=class extends Disposable{constructor(nt,ot){super(),this._labelService=ot;const rt=document.createElement("div");rt.classList.add("reference-file"),this.file=this._register(new IconLabel(rt,{supportHighlights:!0})),this.badge=new CountBadge(append$1(rt,$$d(".count")),{},defaultCountBadgeStyles),nt.appendChild(rt)}set(nt,ot){const rt=dirname(nt.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(nt.uri),this._labelService.getUriLabel(rt,{relative:!0}),{title:this._labelService.getUriLabel(nt.uri),matches:ot});const ut=nt.children.length;this.badge.setCount(ut),ut>1?this.badge.setTitleFormat(localize("referencesCount","{0} references",ut)):this.badge.setTitleFormat(localize("referenceCount","{0} reference",ut))}};FileReferencesTemplate=__decorate$1c([__param$1c(1,ILabelService)],FileReferencesTemplate);let FileReferencesRenderer=class hr{constructor(nt){this._instantiationService=nt,this.templateId=hr.id}renderTemplate(nt){return this._instantiationService.createInstance(FileReferencesTemplate,nt)}renderElement(nt,ot,rt){rt.set(nt.element,createMatches(nt.filterData))}disposeTemplate(nt){nt.dispose()}};FileReferencesRenderer.id="FileReferencesRenderer";FileReferencesRenderer=__decorate$1c([__param$1c(0,IInstantiationService)],FileReferencesRenderer);class OneReferenceTemplate{constructor(nt){this.label=new HighlightedLabel(nt)}set(nt,ot){var rt;const ut=(rt=nt.parent.getPreview(nt))===null||rt===void 0?void 0:rt.preview(nt.range);if(!ut||!ut.value)this.label.set(`${basename(nt.uri)}:${nt.range.startLineNumber+1}:${nt.range.startColumn+1}`);else{const{value:gt,highlight:pt}=ut;ot&&!FuzzyScore.isDefault(ot)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(gt,createMatches(ot))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(gt,[pt]))}}}class OneReferenceRenderer{constructor(){this.templateId=OneReferenceRenderer.id}renderTemplate(nt){return new OneReferenceTemplate(nt)}renderElement(nt,ot,rt){rt.set(nt.element,nt.filterData)}disposeTemplate(){}}OneReferenceRenderer.id="OneReferenceRenderer";class AccessibilityProvider{getWidgetAriaLabel(){return localize("treeAriaLabel","References")}getAriaLabel(nt){return nt.ariaMessage}}var __decorate$1b=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1b=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$R=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class DecorationsManager{constructor(nt,ot){this._editor=nt,this._model=ot,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new DisposableStore,this._callOnModelChange=new DisposableStore,this._callOnDispose.add(this._editor.onDidChangeModel(()=>this._onModelChanged())),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const nt=this._editor.getModel();if(nt){for(const ot of this._model.references)if(ot.uri.toString()===nt.uri.toString()){this._addDecorations(ot.parent);return}}}_addDecorations(nt){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(()=>this._onDecorationChanged()));const ot=[],rt=[];for(let ut=0,gt=nt.children.length;ut<gt;ut++){const pt=nt.children[ut];this._decorationIgnoreSet.has(pt.id)||pt.uri.toString()===this._editor.getModel().uri.toString()&&(ot.push({range:pt.range,options:DecorationsManager.DecorationOptions}),rt.push(ut))}this._editor.changeDecorations(ut=>{const gt=ut.deltaDecorations([],ot);for(let pt=0;pt<gt.length;pt++)this._decorations.set(gt[pt],nt.children[rt[pt]])})}_onDecorationChanged(){const nt=[],ot=this._editor.getModel();if(ot){for(const[rt,ut]of this._decorations){const gt=ot.getDecorationRange(rt);if(!gt)continue;let pt=!1;if(!Range$2.equalsRange(gt,ut.range)){if(Range$2.spansMultipleLines(gt))pt=!0;else{const mt=ut.range.endColumn-ut.range.startColumn,vt=gt.endColumn-gt.startColumn;mt!==vt&&(pt=!0)}pt?(this._decorationIgnoreSet.add(ut.id),nt.push(rt)):ut.range=gt}}for(let rt=0,ut=nt.length;rt<ut;rt++)this._decorations.delete(nt[rt]);this._editor.removeDecorations(nt)}}removeDecorations(){this._editor.removeDecorations([...this._decorations.keys()]),this._decorations.clear()}}DecorationsManager.DecorationOptions=ModelDecorationOptions.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});class LayoutData{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(nt){let ot,rt;try{const ut=JSON.parse(nt);ot=ut.ratio,rt=ut.heightInLines}catch{}return{ratio:ot||.7,heightInLines:rt||18}}}class ReferencesTree extends WorkbenchAsyncDataTree{}let ReferenceWidget=class extends PeekViewWidget{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt){super(nt,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},pt),this._defaultTreeKeyboardSupport=ot,this.layoutData=rt,this._textModelResolverService=gt,this._instantiationService=pt,this._peekViewService=mt,this._uriLabel=vt,this._undoRedoService=St,this._keybindingService=yt,this._languageService=wt,this._languageConfigurationService=Lt,this._disposeOnNewModel=new DisposableStore,this._callOnDispose=new DisposableStore,this._onDidSelectReference=new Emitter$2,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new Dimension(0,0),this._applyTheme(ut.getColorTheme()),this._callOnDispose.add(ut.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(nt,this),this.create()}dispose(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),dispose(this._preview),dispose(this._previewNotAvailableMessage),dispose(this._tree),dispose(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(nt){const ot=nt.getColor(peekViewBorder)||Color.transparent;this.style({arrowColor:ot,frameColor:ot,headerBackgroundColor:nt.getColor(peekViewTitleBackground)||Color.transparent,primaryHeadingColor:nt.getColor(peekViewTitleForeground),secondaryHeadingColor:nt.getColor(peekViewTitleInfoForeground)})}show(nt){super.show(nt,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(nt){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:nt.ctrlKey||nt.metaKey||nt.altKey?"side":"open",source:"title"})}_fillBody(nt){this.setCssClass("reference-zone-widget"),this._messageContainer=append$1(nt,$$d("div.messages")),hide(this._messageContainer),this._splitView=new SplitView(nt,{orientation:1}),this._previewContainer=append$1(nt,$$d("div.preview.inline"));const ot={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._preview=this._instantiationService.createInstance(EmbeddedCodeEditorWidget,this._previewContainer,ot,{},this.editor),hide(this._previewContainer),this._previewNotAvailableMessage=new TextModel(localize("missingPreviewMessage","no preview available"),PLAINTEXT_LANGUAGE_ID,TextModel.DEFAULT_CREATION_OPTIONS,null,this._undoRedoService,this._languageService,this._languageConfigurationService),this._treeContainer=append$1(nt,$$d("div.ref-tree.inline"));const rt={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new AccessibilityProvider,keyboardNavigationLabelProvider:this._instantiationService.createInstance(StringRepresentationProvider),identityProvider:new IdentityProvider,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:peekViewResultsBackground}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(addStandardDisposableListener(this._treeContainer,"keydown",gt=>{gt.equals(9)&&(this._keybindingService.dispatchEvent(gt,gt.target),gt.stopPropagation())},!0)),this._tree=this._instantiationService.createInstance(ReferencesTree,"ReferencesWidget",this._treeContainer,new Delegate,[this._instantiationService.createInstance(FileReferencesRenderer),this._instantiationService.createInstance(OneReferenceRenderer)],this._instantiationService.createInstance(DataSource),rt),this._splitView.addView({onDidChange:Event.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:gt=>{this._preview.layout({height:this._dim.height,width:gt})}},Sizing.Distribute),this._splitView.addView({onDidChange:Event.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:gt=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${gt}px`,this._tree.layout(this._dim.height,gt)}},Sizing.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)},void 0));const ut=(gt,pt)=>{gt instanceof OneReference&&(pt==="show"&&this._revealReference(gt,!1),this._onDidSelectReference.fire({element:gt,kind:pt,source:"tree"}))};this._tree.onDidOpen(gt=>{gt.sideBySide?ut(gt.element,"side"):gt.editorOptions.pinned?ut(gt.element,"goto"):ut(gt.element,"show")}),hide(this._treeContainer)}_onWidth(nt){this._dim&&this._doLayoutBody(this._dim.height,nt)}_doLayoutBody(nt,ot){super._doLayoutBody(nt,ot),this._dim=new Dimension(ot,nt),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(ot),this._splitView.resizeView(0,ot*this.layoutData.ratio)}setSelection(nt){return this._revealReference(nt,!0).then(()=>{this._model&&(this._tree.setSelection([nt]),this._tree.setFocus([nt]))})}setModel(nt){return this._disposeOnNewModel.clear(),this._model=nt,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=localize("noResults","No results"),show(this._messageContainer),Promise.resolve(void 0)):(hide(this._messageContainer),this._decorationsManager=new DecorationsManager(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(nt=>this._tree.rerender(nt))),this._disposeOnNewModel.add(this._preview.onMouseDown(nt=>{const{event:ot,target:rt}=nt;if(ot.detail!==2)return;const ut=this._getFocusedReference();ut&&this._onDidSelectReference.fire({element:{uri:ut.uri,range:rt.range},kind:ot.ctrlKey||ot.metaKey||ot.altKey?"side":"open",source:"editor"})})),this.container.classList.add("results-loaded"),show(this._treeContainer),show(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(this._model.groups.length===1?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[nt]=this._tree.getFocus();if(nt instanceof OneReference)return nt;if(nt instanceof FileReferences&&nt.children.length>0)return nt.children[0]}revealReference(nt){return __awaiter$R(this,void 0,void 0,function*(){yield this._revealReference(nt,!1),this._onDidSelectReference.fire({element:nt,kind:"goto",source:"tree"})})}_revealReference(nt,ot){return __awaiter$R(this,void 0,void 0,function*(){if(this._revealedReference===nt)return;this._revealedReference=nt,nt.uri.scheme!==Schemas.inMemory?this.setTitle(basenameOrAuthority(nt.uri),this._uriLabel.getUriLabel(dirname(nt.uri))):this.setTitle(localize("peekView.alternateTitle","References"));const rt=this._textModelResolverService.createModelReference(nt.uri);this._tree.getInput()===nt.parent?this._tree.reveal(nt):(ot&&this._tree.reveal(nt.parent),yield this._tree.expand(nt.parent),this._tree.reveal(nt));const ut=yield rt;if(!this._model){ut.dispose();return}dispose(this._previewModelReference);const gt=ut.object;if(gt){const pt=this._preview.getModel()===gt.textEditorModel?0:1,mt=Range$2.lift(nt.range).collapseToStart();this._previewModelReference=ut,this._preview.setModel(gt.textEditorModel),this._preview.setSelection(mt),this._preview.revealRangeInCenter(mt,pt)}else this._preview.setModel(this._previewNotAvailableMessage),ut.dispose()})}};ReferenceWidget=__decorate$1b([__param$1b(3,IThemeService),__param$1b(4,ITextModelService),__param$1b(5,IInstantiationService),__param$1b(6,IPeekViewService),__param$1b(7,ILabelService),__param$1b(8,IUndoRedoService),__param$1b(9,IKeybindingService),__param$1b(10,ILanguageService),__param$1b(11,ILanguageConfigurationService)],ReferenceWidget);var __decorate$1a=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1a=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$Q=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const ctxReferenceSearchVisible=new RawContextKey("referenceSearchVisible",!1,localize("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));let ReferencesController=class jo{static get(nt){return nt.getContribution(jo.ID)}constructor(nt,ot,rt,ut,gt,pt,mt,vt){this._defaultTreeKeyboardSupport=nt,this._editor=ot,this._editorService=ut,this._notificationService=gt,this._instantiationService=pt,this._storageService=mt,this._configurationService=vt,this._disposables=new DisposableStore,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=ctxReferenceSearchVisible.bindTo(rt)}dispose(){var nt,ot;this._referenceSearchVisible.reset(),this._disposables.dispose(),(nt=this._widget)===null||nt===void 0||nt.dispose(),(ot=this._model)===null||ot===void 0||ot.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(nt,ot,rt){let ut;if(this._widget&&(ut=this._widget.position),this.closeWidget(),ut&&nt.containsPosition(ut))return;this._peekMode=rt,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>{this.closeWidget()})),this._disposables.add(this._editor.onDidChangeModel(()=>{this._ignoreModelChangeEvent||this.closeWidget()}));const gt="peekViewLayout",pt=LayoutData.fromJSON(this._storageService.get(gt,0,"{}"));this._widget=this._instantiationService.createInstance(ReferenceWidget,this._editor,this._defaultTreeKeyboardSupport,pt),this._widget.setTitle(localize("labelLoading","Loading...")),this._widget.show(nt),this._disposables.add(this._widget.onDidClose(()=>{ot.cancel(),this._widget&&(this._storageService.store(gt,JSON.stringify(this._widget.layoutData),0,1),this._widget=void 0),this.closeWidget()})),this._disposables.add(this._widget.onDidSelectReference(vt=>{const{element:St,kind:yt}=vt;if(St)switch(yt){case"open":(vt.source!=="editor"||!this._configurationService.getValue("editor.stablePeek"))&&this.openReference(St,!1,!1);break;case"side":this.openReference(St,!0,!1);break;case"goto":rt?this._gotoReference(St,!0):this.openReference(St,!1,!0);break}}));const mt=++this._requestIdPool;ot.then(vt=>{var St;if(mt!==this._requestIdPool||!this._widget){vt.dispose();return}return(St=this._model)===null||St===void 0||St.dispose(),this._model=vt,this._widget.setModel(this._model).then(()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(localize("metaTitle.N","{0} ({1})",this._model.title,this._model.references.length));const yt=this._editor.getModel().uri,wt=new Position$1(nt.startLineNumber,nt.startColumn),Lt=this._model.nearestReference(yt,wt);if(Lt)return this._widget.setSelection(Lt).then(()=>{this._widget&&this._editor.getOption(83)==="editor"&&this._widget.focusOnPreviewEditor()})}})},vt=>{this._notificationService.error(vt)})}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}goToNextOrPreviousReference(nt){return __awaiter$Q(this,void 0,void 0,function*(){if(!this._editor.hasModel()||!this._model||!this._widget)return;const ot=this._widget.position;if(!ot)return;const rt=this._model.nearestReference(this._editor.getModel().uri,ot);if(!rt)return;const ut=this._model.nextOrPreviousReference(rt,nt),gt=this._editor.hasTextFocus(),pt=this._widget.isPreviewEditorFocused();yield this._widget.setSelection(ut),yield this._gotoReference(ut,!1),gt?this._editor.focus():this._widget&&pt&&this._widget.focusOnPreviewEditor()})}revealReference(nt){return __awaiter$Q(this,void 0,void 0,function*(){!this._editor.hasModel()||!this._model||!this._widget||(yield this._widget.revealReference(nt))})}closeWidget(nt=!0){var ot,rt;(ot=this._widget)===null||ot===void 0||ot.dispose(),(rt=this._model)===null||rt===void 0||rt.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,nt&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(nt,ot){var rt;(rt=this._widget)===null||rt===void 0||rt.hide(),this._ignoreModelChangeEvent=!0;const ut=Range$2.lift(nt.range).collapseToStart();return this._editorService.openCodeEditor({resource:nt.uri,options:{selection:ut,selectionSource:"code.jump",pinned:ot}},this._editor).then(gt=>{var pt;if(this._ignoreModelChangeEvent=!1,!gt||!this._widget){this.closeWidget();return}if(this._editor===gt)this._widget.show(ut),this._widget.focusOnReferenceTree();else{const mt=jo.get(gt),vt=this._model.clone();this.closeWidget(),gt.focus(),mt==null||mt.toggleWidget(ut,createCancelablePromise(St=>Promise.resolve(vt)),(pt=this._peekMode)!==null&&pt!==void 0?pt:!1)}},gt=>{this._ignoreModelChangeEvent=!1,onUnexpectedError(gt)})}openReference(nt,ot,rt){ot||this.closeWidget();const{uri:ut,range:gt}=nt;this._editorService.openCodeEditor({resource:ut,options:{selection:gt,selectionSource:"code.jump",pinned:rt}},this._editor,ot)}};ReferencesController.ID="editor.contrib.referencesController";ReferencesController=__decorate$1a([__param$1a(2,IContextKeyService),__param$1a(3,ICodeEditorService),__param$1a(4,INotificationService),__param$1a(5,IInstantiationService),__param$1a(6,IStorageService),__param$1a(7,IConfigurationService)],ReferencesController);function withController(ct,nt){const ot=getOuterEditor(ct);if(!ot)return;const rt=ReferencesController.get(ot);rt&&nt(rt)}KeybindingsRegistry.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:KeyChord(2089,60),when:ContextKeyExpr.or(ctxReferenceSearchVisible,PeekContext.inPeekEditor),handler(ct){withController(ct,nt=>{nt.changeFocusBetweenPreviewAndReferences()})}});KeybindingsRegistry.registerCommandAndKeybindingRule({id:"goToNextReference",weight:100-10,primary:62,secondary:[70],when:ContextKeyExpr.or(ctxReferenceSearchVisible,PeekContext.inPeekEditor),handler(ct){withController(ct,nt=>{nt.goToNextOrPreviousReference(!0)})}});KeybindingsRegistry.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:100-10,primary:1086,secondary:[1094],when:ContextKeyExpr.or(ctxReferenceSearchVisible,PeekContext.inPeekEditor),handler(ct){withController(ct,nt=>{nt.goToNextOrPreviousReference(!1)})}});CommandsRegistry.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference");CommandsRegistry.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference");CommandsRegistry.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch");CommandsRegistry.registerCommand("closeReferenceSearch",ct=>withController(ct,nt=>nt.closeWidget()));KeybindingsRegistry.registerKeybindingRule({id:"closeReferenceSearch",weight:100-101,primary:9,secondary:[1033],when:ContextKeyExpr.and(PeekContext.inPeekEditor,ContextKeyExpr.not("config.editor.stablePeek"))});KeybindingsRegistry.registerKeybindingRule({id:"closeReferenceSearch",weight:200+50,primary:9,secondary:[1033],when:ContextKeyExpr.and(ctxReferenceSearchVisible,ContextKeyExpr.not("config.editor.stablePeek"))});KeybindingsRegistry.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:ContextKeyExpr.and(ctxReferenceSearchVisible,WorkbenchListFocusContextKey,WorkbenchTreeElementCanCollapse.negate(),WorkbenchTreeElementCanExpand.negate()),handler(ct){var nt;const rt=(nt=ct.get(IListService).lastFocusedList)===null||nt===void 0?void 0:nt.getFocus();Array.isArray(rt)&&rt[0]instanceof OneReference&&withController(ct,ut=>ut.revealReference(rt[0]))}});KeybindingsRegistry.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:ContextKeyExpr.and(ctxReferenceSearchVisible,WorkbenchListFocusContextKey,WorkbenchTreeElementCanCollapse.negate(),WorkbenchTreeElementCanExpand.negate()),handler(ct){var nt;const rt=(nt=ct.get(IListService).lastFocusedList)===null||nt===void 0?void 0:nt.getFocus();Array.isArray(rt)&&rt[0]instanceof OneReference&&withController(ct,ut=>ut.openReference(rt[0],!0,!0))}});CommandsRegistry.registerCommand("openReference",ct=>{var nt;const rt=(nt=ct.get(IListService).lastFocusedList)===null||nt===void 0?void 0:nt.getFocus();Array.isArray(rt)&&rt[0]instanceof OneReference&&withController(ct,ut=>ut.openReference(rt[0],!1,!0))});var __decorate$19=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$19=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const ctxHasSymbols=new RawContextKey("hasSymbols",!1,localize("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),ISymbolNavigationService=createDecorator("ISymbolNavigationService");let SymbolNavigationService=class{constructor(nt,ot,rt,ut){this._editorService=ot,this._notificationService=rt,this._keybindingService=ut,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=ctxHasSymbols.bindTo(nt)}reset(){var nt,ot;this._ctxHasSymbols.reset(),(nt=this._currentState)===null||nt===void 0||nt.dispose(),(ot=this._currentMessage)===null||ot===void 0||ot.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(nt){const ot=nt.parent.parent;if(ot.references.length<=1){this.reset();return}this._currentModel=ot,this._currentIdx=ot.references.indexOf(nt),this._ctxHasSymbols.set(!0),this._showMessage();const rt=new EditorState(this._editorService),ut=rt.onDidChange(gt=>{if(this._ignoreEditorChange)return;const pt=this._editorService.getActiveCodeEditor();if(!pt)return;const mt=pt.getModel(),vt=pt.getPosition();if(!mt||!vt)return;let St=!1,yt=!1;for(const wt of ot.references)if(isEqual(wt.uri,mt.uri))St=!0,yt=yt||Range$2.containsPosition(wt.range,vt);else if(St)break;(!St||!yt)&&this.reset()});this._currentState=combinedDisposable(rt,ut)}revealNext(nt){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const ot=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:ot.uri,options:{selection:Range$2.collapseToStart(ot.range),selectionRevealType:3}},nt).finally(()=>{this._ignoreEditorChange=!1})}_showMessage(){var nt;(nt=this._currentMessage)===null||nt===void 0||nt.dispose();const ot=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),rt=ot?localize("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,ot.getLabel()):localize("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(rt)}};SymbolNavigationService=__decorate$19([__param$19(0,IContextKeyService),__param$19(1,ICodeEditorService),__param$19(2,INotificationService),__param$19(3,IKeybindingService)],SymbolNavigationService);registerSingleton(ISymbolNavigationService,SymbolNavigationService,1);registerEditorCommand(new class extends EditorCommand{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:ctxHasSymbols,kbOpts:{weight:100,primary:70}})}runEditorCommand(ct,nt){return ct.get(ISymbolNavigationService).revealNext(nt)}});KeybindingsRegistry.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:ctxHasSymbols,primary:9,handler(ct){ct.get(ISymbolNavigationService).reset()}});let EditorState=class{constructor(nt){this._listener=new Map,this._disposables=new DisposableStore,this._onDidChange=new Emitter$2,this.onDidChange=this._onDidChange.event,this._disposables.add(nt.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(nt.onCodeEditorAdd(this._onDidAddEditor,this)),nt.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),dispose(this._listener.values())}_onDidAddEditor(nt){this._listener.set(nt,combinedDisposable(nt.onDidChangeCursorPosition(ot=>this._onDidChange.fire({editor:nt})),nt.onDidChangeModelContent(ot=>this._onDidChange.fire({editor:nt}))))}_onDidRemoveEditor(nt){var ot;(ot=this._listener.get(nt))===null||ot===void 0||ot.dispose(),this._listener.delete(nt)}};EditorState=__decorate$19([__param$19(0,ICodeEditorService)],EditorState);var __awaiter$P=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function getLocationLinks(ct,nt,ot,rt){return __awaiter$P(this,void 0,void 0,function*(){const gt=ot.ordered(ct).map(mt=>Promise.resolve(rt(mt,ct,nt)).then(void 0,vt=>{onUnexpectedExternalError(vt)})),pt=yield Promise.all(gt);return coalesce(pt.flat())})}function getDefinitionsAtPosition(ct,nt,ot,rt){return getLocationLinks(nt,ot,ct,(ut,gt,pt)=>ut.provideDefinition(gt,pt,rt))}function getDeclarationsAtPosition(ct,nt,ot,rt){return getLocationLinks(nt,ot,ct,(ut,gt,pt)=>ut.provideDeclaration(gt,pt,rt))}function getImplementationsAtPosition(ct,nt,ot,rt){return getLocationLinks(nt,ot,ct,(ut,gt,pt)=>ut.provideImplementation(gt,pt,rt))}function getTypeDefinitionsAtPosition(ct,nt,ot,rt){return getLocationLinks(nt,ot,ct,(ut,gt,pt)=>ut.provideTypeDefinition(gt,pt,rt))}function getReferencesAtPosition(ct,nt,ot,rt,ut){return getLocationLinks(nt,ot,ct,(gt,pt,mt)=>__awaiter$P(this,void 0,void 0,function*(){const vt=yield gt.provideReferences(pt,mt,{includeDeclaration:!0},ut);if(!rt||!vt||vt.length!==2)return vt;const St=yield gt.provideReferences(pt,mt,{includeDeclaration:!1},ut);return St&&St.length===1?St:vt}))}function _sortedAndDeduped(ct){return __awaiter$P(this,void 0,void 0,function*(){const nt=yield ct(),ot=new ReferencesModel(nt,""),rt=ot.references.map(ut=>ut.link);return ot.dispose(),rt})}registerModelAndPositionCommand("_executeDefinitionProvider",(ct,nt,ot)=>{const rt=ct.get(ILanguageFeaturesService),ut=getDefinitionsAtPosition(rt.definitionProvider,nt,ot,CancellationToken.None);return _sortedAndDeduped(()=>ut)});registerModelAndPositionCommand("_executeTypeDefinitionProvider",(ct,nt,ot)=>{const rt=ct.get(ILanguageFeaturesService),ut=getTypeDefinitionsAtPosition(rt.typeDefinitionProvider,nt,ot,CancellationToken.None);return _sortedAndDeduped(()=>ut)});registerModelAndPositionCommand("_executeDeclarationProvider",(ct,nt,ot)=>{const rt=ct.get(ILanguageFeaturesService),ut=getDeclarationsAtPosition(rt.declarationProvider,nt,ot,CancellationToken.None);return _sortedAndDeduped(()=>ut)});registerModelAndPositionCommand("_executeReferenceProvider",(ct,nt,ot)=>{const rt=ct.get(ILanguageFeaturesService),ut=getReferencesAtPosition(rt.referenceProvider,nt,ot,!1,CancellationToken.None);return _sortedAndDeduped(()=>ut)});registerModelAndPositionCommand("_executeImplementationProvider",(ct,nt,ot)=>{const rt=ct.get(ILanguageFeaturesService),ut=getImplementationsAtPosition(rt.implementationProvider,nt,ot,CancellationToken.None);return _sortedAndDeduped(()=>ut)});var __awaiter$O=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},_a$4,_b,_c,_d,_e,_f,_g,_h;MenuRegistry.appendMenuItem(MenuId.EditorContext,{submenu:MenuId.EditorContextPeek,title:localize("peek.submenu","Peek"),group:"navigation",order:100});class SymbolNavigationAnchor{static is(nt){return!nt||typeof nt!="object"?!1:!!(nt instanceof SymbolNavigationAnchor||Position$1.isIPosition(nt.position)&&nt.model)}constructor(nt,ot){this.model=nt,this.position=ot}}class SymbolNavigationAction extends EditorAction2{static all(){return SymbolNavigationAction._allSymbolNavigationCommands.values()}static _patchConfig(nt){const ot=Object.assign(Object.assign({},nt),{f1:!0});if(ot.menu)for(const rt of Iterable.wrap(ot.menu))(rt.id===MenuId.EditorContext||rt.id===MenuId.EditorContextPeek)&&(rt.when=ContextKeyExpr.and(nt.precondition,rt.when));return ot}constructor(nt,ot){super(SymbolNavigationAction._patchConfig(ot)),this.configuration=nt,SymbolNavigationAction._allSymbolNavigationCommands.set(ot.id,this)}runEditorCommand(nt,ot,rt,ut){if(!ot.hasModel())return Promise.resolve(void 0);const gt=nt.get(INotificationService),pt=nt.get(ICodeEditorService),mt=nt.get(IEditorProgressService),vt=nt.get(ISymbolNavigationService),St=nt.get(ILanguageFeaturesService),yt=nt.get(IInstantiationService),wt=ot.getModel(),Lt=ot.getPosition(),xt=SymbolNavigationAnchor.is(rt)?rt:new SymbolNavigationAnchor(wt,Lt),It=new EditorStateCancellationTokenSource(ot,5),kt=raceCancellation(this._getLocationModel(St,xt.model,xt.position,It.token),It.token).then(At=>__awaiter$O(this,void 0,void 0,function*(){var Tt;if(!At||It.token.isCancellationRequested)return;alert(At.ariaMessage);let Rt;if(At.referenceAt(wt.uri,Lt)){const Pt=this._getAlternativeCommand(ot);!SymbolNavigationAction._activeAlternativeCommands.has(Pt)&&SymbolNavigationAction._allSymbolNavigationCommands.has(Pt)&&(Rt=SymbolNavigationAction._allSymbolNavigationCommands.get(Pt))}const Nt=At.references.length;if(Nt===0){if(!this.configuration.muteMessage){const Pt=wt.getWordAtPosition(Lt);(Tt=MessageController.get(ot))===null||Tt===void 0||Tt.showMessage(this._getNoResultFoundMessage(Pt),Lt)}}else if(Nt===1&&Rt)SymbolNavigationAction._activeAlternativeCommands.add(this.desc.id),yt.invokeFunction(Pt=>Rt.runEditorCommand(Pt,ot,rt,ut).finally(()=>{SymbolNavigationAction._activeAlternativeCommands.delete(this.desc.id)}));else return this._onResult(pt,vt,ot,At,ut)}),At=>{gt.error(At)}).finally(()=>{It.dispose()});return mt.showWhile(kt,250),kt}_onResult(nt,ot,rt,ut,gt){return __awaiter$O(this,void 0,void 0,function*(){const pt=this._getGoToPreference(rt);if(!(rt instanceof EmbeddedCodeEditorWidget)&&(this.configuration.openInPeek||pt==="peek"&&ut.references.length>1))this._openInPeek(rt,ut,gt);else{const mt=ut.firstReference(),vt=ut.references.length>1&&pt==="gotoAndPeek",St=yield this._openReference(rt,nt,mt,this.configuration.openToSide,!vt);vt&&St?this._openInPeek(St,ut,gt):ut.dispose(),pt==="goto"&&ot.put(mt)}})}_openReference(nt,ot,rt,ut,gt){return __awaiter$O(this,void 0,void 0,function*(){let pt;if(isLocationLink(rt)&&(pt=rt.targetSelectionRange),pt||(pt=rt.range),!pt)return;const mt=yield ot.openCodeEditor({resource:rt.uri,options:{selection:Range$2.collapseToStart(pt),selectionRevealType:3,selectionSource:"code.jump"}},nt,ut);if(mt){if(gt){const vt=mt.getModel(),St=mt.createDecorationsCollection([{range:pt,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{mt.getModel()===vt&&St.clear()},350)}return mt}})}_openInPeek(nt,ot,rt){const ut=ReferencesController.get(nt);ut&&nt.hasModel()?ut.toggleWidget(rt??nt.getSelection(),createCancelablePromise(gt=>Promise.resolve(ot)),this.configuration.openInPeek):ot.dispose()}}SymbolNavigationAction._allSymbolNavigationCommands=new Map;SymbolNavigationAction._activeAlternativeCommands=new Set;class DefinitionAction extends SymbolNavigationAction{_getLocationModel(nt,ot,rt,ut){return __awaiter$O(this,void 0,void 0,function*(){return new ReferencesModel(yield getDefinitionsAtPosition(nt.definitionProvider,ot,rt,ut),localize("def.title","Definitions"))})}_getNoResultFoundMessage(nt){return nt&&nt.word?localize("noResultWord","No definition found for '{0}'",nt.word):localize("generic.noResults","No definition found")}_getAlternativeCommand(nt){return nt.getOption(56).alternativeDefinitionCommand}_getGoToPreference(nt){return nt.getOption(56).multipleDefinitions}}const goToDefinitionKb=isWeb&&!isStandalone()?2118:70;registerAction2((_a$4=class Go extends DefinitionAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Go.id,title:{value:localize("actions.goToDecl.label","Go to Definition"),original:"Go to Definition",mnemonicTitle:localize({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},precondition:ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider,EditorContextKeys.isInWalkThroughSnippet.toNegated()),keybinding:{when:EditorContextKeys.editorTextFocus,primary:goToDefinitionKb,weight:100},menu:[{id:MenuId.EditorContext,group:"navigation",order:1.1},{id:MenuId.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),CommandsRegistry.registerCommandAlias("editor.action.goToDeclaration",Go.id)}},_a$4.id="editor.action.revealDefinition",_a$4));registerAction2((_b=class qo extends DefinitionAction{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:qo.id,title:{value:localize("actions.goToDeclToSide.label","Open Definition to the Side"),original:"Open Definition to the Side"},precondition:ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider,EditorContextKeys.isInWalkThroughSnippet.toNegated()),keybinding:{when:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,goToDefinitionKb),weight:100}}),CommandsRegistry.registerCommandAlias("editor.action.openDeclarationToTheSide",qo.id)}},_b.id="editor.action.revealDefinitionAside",_b));registerAction2((_c=class Yo extends DefinitionAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:Yo.id,title:{value:localize("actions.previewDecl.label","Peek Definition"),original:"Peek Definition"},precondition:ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),keybinding:{when:EditorContextKeys.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:MenuId.EditorContextPeek,group:"peek",order:2}}),CommandsRegistry.registerCommandAlias("editor.action.previewDeclaration",Yo.id)}},_c.id="editor.action.peekDefinition",_c));class DeclarationAction extends SymbolNavigationAction{_getLocationModel(nt,ot,rt,ut){return __awaiter$O(this,void 0,void 0,function*(){return new ReferencesModel(yield getDeclarationsAtPosition(nt.declarationProvider,ot,rt,ut),localize("decl.title","Declarations"))})}_getNoResultFoundMessage(nt){return nt&&nt.word?localize("decl.noResultWord","No declaration found for '{0}'",nt.word):localize("decl.generic.noResults","No declaration found")}_getAlternativeCommand(nt){return nt.getOption(56).alternativeDeclarationCommand}_getGoToPreference(nt){return nt.getOption(56).multipleDeclarations}}registerAction2((_d=class gr extends DeclarationAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:gr.id,title:{value:localize("actions.goToDeclaration.label","Go to Declaration"),original:"Go to Declaration",mnemonicTitle:localize({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},precondition:ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider,EditorContextKeys.isInWalkThroughSnippet.toNegated()),menu:[{id:MenuId.EditorContext,group:"navigation",order:1.3},{id:MenuId.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}_getNoResultFoundMessage(nt){return nt&&nt.word?localize("decl.noResultWord","No declaration found for '{0}'",nt.word):localize("decl.generic.noResults","No declaration found")}},_d.id="editor.action.revealDeclaration",_d));registerAction2(class extends DeclarationAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:{value:localize("actions.peekDecl.label","Peek Declaration"),original:"Peek Declaration"},precondition:ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),menu:{id:MenuId.EditorContextPeek,group:"peek",order:3}})}});class TypeDefinitionAction extends SymbolNavigationAction{_getLocationModel(nt,ot,rt,ut){return __awaiter$O(this,void 0,void 0,function*(){return new ReferencesModel(yield getTypeDefinitionsAtPosition(nt.typeDefinitionProvider,ot,rt,ut),localize("typedef.title","Type Definitions"))})}_getNoResultFoundMessage(nt){return nt&&nt.word?localize("goToTypeDefinition.noResultWord","No type definition found for '{0}'",nt.word):localize("goToTypeDefinition.generic.noResults","No type definition found")}_getAlternativeCommand(nt){return nt.getOption(56).alternativeTypeDefinitionCommand}_getGoToPreference(nt){return nt.getOption(56).multipleTypeDefinitions}}registerAction2((_e=class fr extends TypeDefinitionAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:fr.ID,title:{value:localize("actions.goToTypeDefinition.label","Go to Type Definition"),original:"Go to Type Definition",mnemonicTitle:localize({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},precondition:ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider,EditorContextKeys.isInWalkThroughSnippet.toNegated()),keybinding:{when:EditorContextKeys.editorTextFocus,primary:0,weight:100},menu:[{id:MenuId.EditorContext,group:"navigation",order:1.4},{id:MenuId.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}},_e.ID="editor.action.goToTypeDefinition",_e));registerAction2((_f=class pr extends TypeDefinitionAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:pr.ID,title:{value:localize("actions.peekTypeDefinition.label","Peek Type Definition"),original:"Peek Type Definition"},precondition:ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),menu:{id:MenuId.EditorContextPeek,group:"peek",order:4}})}},_f.ID="editor.action.peekTypeDefinition",_f));class ImplementationAction extends SymbolNavigationAction{_getLocationModel(nt,ot,rt,ut){return __awaiter$O(this,void 0,void 0,function*(){return new ReferencesModel(yield getImplementationsAtPosition(nt.implementationProvider,ot,rt,ut),localize("impl.title","Implementations"))})}_getNoResultFoundMessage(nt){return nt&&nt.word?localize("goToImplementation.noResultWord","No implementation found for '{0}'",nt.word):localize("goToImplementation.generic.noResults","No implementation found")}_getAlternativeCommand(nt){return nt.getOption(56).alternativeImplementationCommand}_getGoToPreference(nt){return nt.getOption(56).multipleImplementations}}registerAction2((_g=class mr extends ImplementationAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:mr.ID,title:{value:localize("actions.goToImplementation.label","Go to Implementations"),original:"Go to Implementations",mnemonicTitle:localize({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},precondition:ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider,EditorContextKeys.isInWalkThroughSnippet.toNegated()),keybinding:{when:EditorContextKeys.editorTextFocus,primary:2118,weight:100},menu:[{id:MenuId.EditorContext,group:"navigation",order:1.45},{id:MenuId.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}},_g.ID="editor.action.goToImplementation",_g));registerAction2((_h=class _r extends ImplementationAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:_r.ID,title:{value:localize("actions.peekImplementation.label","Peek Implementations"),original:"Peek Implementations"},precondition:ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),keybinding:{when:EditorContextKeys.editorTextFocus,primary:3142,weight:100},menu:{id:MenuId.EditorContextPeek,group:"peek",order:5}})}},_h.ID="editor.action.peekImplementation",_h));class ReferencesAction extends SymbolNavigationAction{_getNoResultFoundMessage(nt){return nt?localize("references.no","No references found for '{0}'",nt.word):localize("references.noGeneric","No references found")}_getAlternativeCommand(nt){return nt.getOption(56).alternativeReferenceCommand}_getGoToPreference(nt){return nt.getOption(56).multipleReferences}}registerAction2(class extends ReferencesAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{value:localize("goToReferences.label","Go to References"),original:"Go to References",mnemonicTitle:localize({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},precondition:ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),keybinding:{when:EditorContextKeys.editorTextFocus,primary:1094,weight:100},menu:[{id:MenuId.EditorContext,group:"navigation",order:1.45},{id:MenuId.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}_getLocationModel(nt,ot,rt,ut){return __awaiter$O(this,void 0,void 0,function*(){return new ReferencesModel(yield getReferencesAtPosition(nt.referenceProvider,ot,rt,!0,ut),localize("ref.title","References"))})}});registerAction2(class extends ReferencesAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:{value:localize("references.action.label","Peek References"),original:"Peek References"},precondition:ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),menu:{id:MenuId.EditorContextPeek,group:"peek",order:6}})}_getLocationModel(nt,ot,rt,ut){return __awaiter$O(this,void 0,void 0,function*(){return new ReferencesModel(yield getReferencesAtPosition(nt.referenceProvider,ot,rt,!1,ut),localize("ref.title","References"))})}});class GenericGoToLocationAction extends SymbolNavigationAction{constructor(nt,ot,rt){super(nt,{id:"editor.action.goToLocation",title:{value:localize("label.generic","Go to Any Symbol"),original:"Go to Any Symbol"},precondition:ContextKeyExpr.and(PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated())}),this._references=ot,this._gotoMultipleBehaviour=rt}_getLocationModel(nt,ot,rt,ut){return __awaiter$O(this,void 0,void 0,function*(){return new ReferencesModel(this._references,localize("generic.title","Locations"))})}_getNoResultFoundMessage(nt){return nt&&localize("generic.noResult","No results for '{0}'",nt.word)||""}_getGoToPreference(nt){var ot;return(ot=this._gotoMultipleBehaviour)!==null&&ot!==void 0?ot:nt.getOption(56).multipleReferences}_getAlternativeCommand(){return""}}CommandsRegistry.registerCommand({id:"editor.action.goToLocations",description:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:URI},{name:"position",description:"The position at which to start",constraint:Position$1.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:(ct,nt,ot,rt,ut,gt,pt)=>__awaiter$O(void 0,void 0,void 0,function*(){assertType(URI.isUri(nt)),assertType(Position$1.isIPosition(ot)),assertType(Array.isArray(rt)),assertType(typeof ut>"u"||typeof ut=="string"),assertType(typeof pt>"u"||typeof pt=="boolean");const mt=ct.get(ICodeEditorService),vt=yield mt.openCodeEditor({resource:nt},mt.getFocusedCodeEditor());if(isCodeEditor(vt))return vt.setPosition(ot),vt.revealPositionInCenterIfOutsideViewport(ot,0),vt.invokeWithinContext(St=>{const yt=new class extends GenericGoToLocationAction{_getNoResultFoundMessage(wt){return gt||super._getNoResultFoundMessage(wt)}}({muteMessage:!gt,openInPeek:!!pt,openToSide:!1},rt,ut);St.get(IInstantiationService).invokeFunction(yt.run.bind(yt),vt)})})});CommandsRegistry.registerCommand({id:"editor.action.peekLocations",description:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:URI},{name:"position",description:"The position at which to start",constraint:Position$1.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"}]},handler:(ct,nt,ot,rt,ut)=>__awaiter$O(void 0,void 0,void 0,function*(){ct.get(ICommandService).executeCommand("editor.action.goToLocations",nt,ot,rt,ut,void 0,!0)})});CommandsRegistry.registerCommand({id:"editor.action.findReferences",handler:(ct,nt,ot)=>{assertType(URI.isUri(nt)),assertType(Position$1.isIPosition(ot));const rt=ct.get(ILanguageFeaturesService),ut=ct.get(ICodeEditorService);return ut.openCodeEditor({resource:nt},ut.getFocusedCodeEditor()).then(gt=>{if(!isCodeEditor(gt)||!gt.hasModel())return;const pt=ReferencesController.get(gt);if(!pt)return;const mt=createCancelablePromise(St=>getReferencesAtPosition(rt.referenceProvider,gt.getModel(),Position$1.lift(ot),!1,St).then(yt=>new ReferencesModel(yt,localize("ref.title","References")))),vt=new Range$2(ot.lineNumber,ot.column,ot.lineNumber,ot.column);return Promise.resolve(pt.toggleWidget(vt,mt,!1))})}});CommandsRegistry.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations");var __decorate$18=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$18=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$N=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let GotoDefinitionAtPositionEditorContribution=class Ao{constructor(nt,ot,rt,ut){this.textModelResolverService=ot,this.languageService=rt,this.languageFeaturesService=ut,this.toUnhook=new DisposableStore,this.toUnhookForKeyboard=new DisposableStore,this.currentWordAtPosition=null,this.previousPromise=null,this.editor=nt,this.linkDecorations=this.editor.createDecorationsCollection();const gt=new ClickLinkGesture(nt);this.toUnhook.add(gt),this.toUnhook.add(gt.onMouseMoveOrRelevantKeyDown(([pt,mt])=>{this.startFindDefinitionFromMouse(pt,withNullAsUndefined(mt))})),this.toUnhook.add(gt.onExecute(pt=>{this.isEnabled(pt)&&this.gotoDefinition(pt.target.position,pt.hasSideBySideModifier).catch(mt=>{onUnexpectedError(mt)}).finally(()=>{this.removeLinkDecorations()})})),this.toUnhook.add(gt.onCancel(()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null}))}static get(nt){return nt.getContribution(Ao.ID)}startFindDefinitionFromCursor(nt){return __awaiter$N(this,void 0,void 0,function*(){yield this.startFindDefinition(nt),this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()})),this.toUnhookForKeyboard.add(this.editor.onKeyDown(ot=>{ot&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())}))})}startFindDefinitionFromMouse(nt,ot){if(nt.target.type===9&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(nt,ot)){this.currentWordAtPosition=null,this.removeLinkDecorations();return}const rt=nt.target.position;this.startFindDefinition(rt)}startFindDefinition(nt){var ot;return __awaiter$N(this,void 0,void 0,function*(){this.toUnhookForKeyboard.clear();const rt=nt?(ot=this.editor.getModel())===null||ot===void 0?void 0:ot.getWordAtPosition(nt):null;if(!rt){this.currentWordAtPosition=null,this.removeLinkDecorations();return}if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===rt.startColumn&&this.currentWordAtPosition.endColumn===rt.endColumn&&this.currentWordAtPosition.word===rt.word)return;this.currentWordAtPosition=rt;const ut=new EditorState$1(this.editor,15);this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=createCancelablePromise(mt=>this.findDefinition(nt,mt));let gt;try{gt=yield this.previousPromise}catch(mt){onUnexpectedError(mt);return}if(!gt||!gt.length||!ut.validate(this.editor)){this.removeLinkDecorations();return}const pt=gt[0].originSelectionRange?Range$2.lift(gt[0].originSelectionRange):new Range$2(nt.lineNumber,rt.startColumn,nt.lineNumber,rt.endColumn);if(gt.length>1){let mt=pt;for(const{originSelectionRange:vt}of gt)vt&&(mt=Range$2.plusRange(mt,vt));this.addDecoration(mt,new MarkdownString().appendText(localize("multipleResults","Click to show {0} definitions.",gt.length)))}else{const mt=gt[0];if(!mt.uri)return;this.textModelResolverService.createModelReference(mt.uri).then(vt=>{if(!vt.object||!vt.object.textEditorModel){vt.dispose();return}const{object:{textEditorModel:St}}=vt,{startLineNumber:yt}=mt.range;if(yt<1||yt>St.getLineCount()){vt.dispose();return}const wt=this.getPreviewValue(St,yt,mt),Lt=this.languageService.guessLanguageIdByFilepathOrFirstLine(St.uri);this.addDecoration(pt,wt?new MarkdownString().appendCodeblock(Lt||"",wt):void 0),vt.dispose()})}})}getPreviewValue(nt,ot,rt){let ut=rt.range;return ut.endLineNumber-ut.startLineNumber>=Ao.MAX_SOURCE_PREVIEW_LINES&&(ut=this.getPreviewRangeBasedOnIndentation(nt,ot)),this.stripIndentationFromPreviewRange(nt,ot,ut)}stripIndentationFromPreviewRange(nt,ot,rt){let gt=nt.getLineFirstNonWhitespaceColumn(ot);for(let mt=ot+1;mt<rt.endLineNumber;mt++){const vt=nt.getLineFirstNonWhitespaceColumn(mt);gt=Math.min(gt,vt)}return nt.getValueInRange(rt).replace(new RegExp(`^\\s{${gt-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(nt,ot){const rt=nt.getLineFirstNonWhitespaceColumn(ot),ut=Math.min(nt.getLineCount(),ot+Ao.MAX_SOURCE_PREVIEW_LINES);let gt=ot+1;for(;gt<ut;gt++){const pt=nt.getLineFirstNonWhitespaceColumn(gt);if(rt===pt)break}return new Range$2(ot,1,gt+1,1)}addDecoration(nt,ot){const rt={range:nt,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:ot}};this.linkDecorations.set([rt])}removeLinkDecorations(){this.linkDecorations.clear()}isEnabled(nt,ot){var rt;return this.editor.hasModel()&&nt.isLeftClick&&nt.isNoneOrSingleMouseDown&&nt.target.type===6&&!(((rt=nt.target.detail.injectedText)===null||rt===void 0?void 0:rt.options)instanceof ModelDecorationInjectedTextOptions)&&(nt.hasTriggerModifier||(ot?ot.keyCodeIsTriggerKey:!1))&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(nt,ot){const rt=this.editor.getModel();return rt?getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider,rt,nt,ot):Promise.resolve(null)}gotoDefinition(nt,ot){return this.editor.setPosition(nt),this.editor.invokeWithinContext(rt=>{const ut=!ot&&this.editor.getOption(84)&&!this.isInPeekEditor(rt);return new DefinitionAction({openToSide:ot,openInPeek:ut,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(rt)})}isInPeekEditor(nt){const ot=nt.get(IContextKeyService);return PeekContext.inPeekEditor.getValue(ot)}dispose(){this.toUnhook.dispose(),this.toUnhookForKeyboard.dispose()}};GotoDefinitionAtPositionEditorContribution.ID="editor.contrib.gotodefinitionatposition";GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES=8;GotoDefinitionAtPositionEditorContribution=__decorate$18([__param$18(1,ITextModelService),__param$18(2,ILanguageService),__param$18(3,ILanguageFeaturesService)],GotoDefinitionAtPositionEditorContribution);registerEditorContribution(GotoDefinitionAtPositionEditorContribution.ID,GotoDefinitionAtPositionEditorContribution,2);const hover$1="",$$5=$$d;class HoverWidget extends Disposable{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new DomScrollableElement(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}}class HoverAction extends Disposable{static render(nt,ot,rt){return new HoverAction(nt,ot,rt)}constructor(nt,ot,rt){super(),this.actionContainer=append$1(nt,$$5("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=append$1(this.actionContainer,$$5("a.action")),this.action.setAttribute("role","button"),ot.iconClass&&append$1(this.action,$$5(`span.icon.${ot.iconClass}`));const ut=append$1(this.action,$$5("span"));ut.textContent=rt?`${ot.label} (${rt})`:ot.label,this._register(addDisposableListener(this.actionContainer,EventType$1.CLICK,gt=>{gt.stopPropagation(),gt.preventDefault(),ot.run(this.actionContainer)})),this._register(addDisposableListener(this.actionContainer,EventType$1.KEY_DOWN,gt=>{const pt=new StandardKeyboardEvent(gt);(pt.equals(3)||pt.equals(10))&&(gt.stopPropagation(),gt.preventDefault(),ot.run(this.actionContainer))})),this.setEnabled(!0)}setEnabled(nt){nt?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}var __awaiter$M=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},__asyncValues$1=globalThis&&globalThis.__asyncValues||function(ct){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var nt=ct[Symbol.asyncIterator],ot;return nt?nt.call(ct):(ct=typeof __values=="function"?__values(ct):ct[Symbol.iterator](),ot={},rt("next"),rt("throw"),rt("return"),ot[Symbol.asyncIterator]=function(){return this},ot);function rt(gt){ot[gt]=ct[gt]&&function(pt){return new Promise(function(mt,vt){pt=ct[gt](pt),ut(mt,vt,pt.done,pt.value)})}}function ut(gt,pt,mt,vt){Promise.resolve(vt).then(function(St){gt({value:St,done:mt})},pt)}};let HoverResult$1=class{constructor(nt,ot,rt){this.value=nt,this.isComplete=ot,this.hasLoadingMessage=rt}};class HoverOperation extends Disposable{constructor(nt,ot){super(),this._editor=nt,this._computer=ot,this._onResult=this._register(new Emitter$2),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new RunOnceScheduler(()=>this._triggerAsyncComputation(),0)),this._secondWaitScheduler=this._register(new RunOnceScheduler(()=>this._triggerSyncComputation(),0)),this._loadingMessageScheduler=this._register(new RunOnceScheduler(()=>this._triggerLoadingMessage(),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(58).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(nt,ot=!0){this._state=nt,ot&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=createCancelableAsyncIterable(nt=>this._computer.computeAsync(nt)),__awaiter$M(this,void 0,void 0,function*(){var nt,ot,rt,ut;try{try{for(var gt=!0,pt=__asyncValues$1(this._asyncIterable),mt;mt=yield pt.next(),nt=mt.done,!nt;){ut=mt.value,gt=!1;try{const vt=ut;vt&&(this._result.push(vt),this._fireResult())}finally{gt=!0}}}catch(vt){ot={error:vt}}finally{try{!gt&&!nt&&(rt=pt.return)&&(yield rt.call(pt))}finally{if(ot)throw ot.error}}this._asyncIterableDone=!0,(this._state===3||this._state===4)&&this._setState(0)}catch(vt){onUnexpectedError(vt)}})):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){this._state===3&&this._setState(4)}_fireResult(){if(this._state===1||this._state===2)return;const nt=this._state===0,ot=this._state===4;this._onResult.fire(new HoverResult$1(this._result.slice(0),nt,ot))}start(nt){if(nt===0)this._state===0&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}class HoverRangeAnchor{constructor(nt,ot,rt,ut){this.priority=nt,this.range=ot,this.initialMousePosX=rt,this.initialMousePosY=ut,this.type=1}equals(nt){return nt.type===1&&this.range.equalsRange(nt.range)}canAdoptVisibleHover(nt,ot){return nt.type===1&&ot.lineNumber===this.range.startLineNumber}}class HoverForeignElementAnchor{constructor(nt,ot,rt,ut,gt,pt){this.priority=nt,this.owner=ot,this.range=rt,this.initialMousePosX=ut,this.initialMousePosY=gt,this.supportsMarkerHover=pt,this.type=2}equals(nt){return nt.type===2&&this.owner===nt.owner}canAdoptVisibleHover(nt,ot){return nt.type===2&&this.owner===nt.owner}}const HoverParticipantRegistry=new class{constructor(){this._participants=[]}register(nt){this._participants.push(nt)}getAll(){return this._participants}};class Scanner{constructor(){this.value="",this.pos=0}static isDigitCharacter(nt){return nt>=48&&nt<=57}static isVariableCharacter(nt){return nt===95||nt>=97&&nt<=122||nt>=65&&nt<=90}text(nt){this.value=nt,this.pos=0}tokenText(nt){return this.value.substr(nt.pos,nt.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};const nt=this.pos;let ot=0,rt=this.value.charCodeAt(nt),ut;if(ut=Scanner._table[rt],typeof ut=="number")return this.pos+=1,{type:ut,pos:nt,len:1};if(Scanner.isDigitCharacter(rt)){ut=8;do ot+=1,rt=this.value.charCodeAt(nt+ot);while(Scanner.isDigitCharacter(rt));return this.pos+=ot,{type:ut,pos:nt,len:ot}}if(Scanner.isVariableCharacter(rt)){ut=9;do rt=this.value.charCodeAt(nt+ ++ot);while(Scanner.isVariableCharacter(rt)||Scanner.isDigitCharacter(rt));return this.pos+=ot,{type:ut,pos:nt,len:ot}}ut=10;do ot+=1,rt=this.value.charCodeAt(nt+ot);while(!isNaN(rt)&&typeof Scanner._table[rt]>"u"&&!Scanner.isDigitCharacter(rt)&&!Scanner.isVariableCharacter(rt));return this.pos+=ot,{type:ut,pos:nt,len:ot}}}Scanner._table={[36]:0,[58]:1,[44]:2,[123]:3,[125]:4,[92]:5,[47]:6,[124]:7,[43]:11,[45]:12,[63]:13};class Marker{constructor(){this._children=[]}appendChild(nt){return nt instanceof Text&&this._children[this._children.length-1]instanceof Text?this._children[this._children.length-1].value+=nt.value:(nt.parent=this,this._children.push(nt)),this}replace(nt,ot){const{parent:rt}=nt,ut=rt.children.indexOf(nt),gt=rt.children.slice(0);gt.splice(ut,1,...ot),rt._children=gt,function pt(mt,vt){for(const St of mt)St.parent=vt,pt(St.children,St)}(ot,rt)}get children(){return this._children}get rightMostDescendant(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}get snippet(){let nt=this;for(;;){if(!nt)return;if(nt instanceof TextmateSnippet)return nt;nt=nt.parent}}toString(){return this.children.reduce((nt,ot)=>nt+ot.toString(),"")}len(){return 0}}class Text extends Marker{constructor(nt){super(),this.value=nt}toString(){return this.value}len(){return this.value.length}clone(){return new Text(this.value)}}class TransformableMarker extends Marker{}class Placeholder extends TransformableMarker{static compareByIndex(nt,ot){return nt.index===ot.index?0:nt.isFinalTabstop?1:ot.isFinalTabstop||nt.index<ot.index?-1:nt.index>ot.index?1:0}constructor(nt){super(),this.index=nt}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof Choice?this._children[0]:void 0}clone(){const nt=new Placeholder(this.index);return this.transform&&(nt.transform=this.transform.clone()),nt._children=this.children.map(ot=>ot.clone()),nt}}class Choice extends Marker{constructor(){super(...arguments),this.options=[]}appendChild(nt){return nt instanceof Text&&(nt.parent=this,this.options.push(nt)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){const nt=new Choice;return this.options.forEach(nt.appendChild,nt),nt}}class Transform extends Marker{constructor(){super(...arguments),this.regexp=new RegExp("")}resolve(nt){const ot=this;let rt=!1,ut=nt.replace(this.regexp,function(){return rt=!0,ot._replace(Array.prototype.slice.call(arguments,0,-2))});return!rt&&this._children.some(gt=>gt instanceof FormatString&&!!gt.elseValue)&&(ut=this._replace([])),ut}_replace(nt){let ot="";for(const rt of this._children)if(rt instanceof FormatString){let ut=nt[rt.index]||"";ut=rt.resolve(ut),ot+=ut}else ot+=rt.toString();return ot}toString(){return""}clone(){const nt=new Transform;return nt.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),nt._children=this.children.map(ot=>ot.clone()),nt}}class FormatString extends Marker{constructor(nt,ot,rt,ut){super(),this.index=nt,this.shorthandName=ot,this.ifValue=rt,this.elseValue=ut}resolve(nt){return this.shorthandName==="upcase"?nt?nt.toLocaleUpperCase():"":this.shorthandName==="downcase"?nt?nt.toLocaleLowerCase():"":this.shorthandName==="capitalize"?nt?nt[0].toLocaleUpperCase()+nt.substr(1):"":this.shorthandName==="pascalcase"?nt?this._toPascalCase(nt):"":this.shorthandName==="camelcase"?nt?this._toCamelCase(nt):"":nt&&typeof this.ifValue=="string"?this.ifValue:!nt&&typeof this.elseValue=="string"?this.elseValue:nt||""}_toPascalCase(nt){const ot=nt.match(/[a-z0-9]+/gi);return ot?ot.map(rt=>rt.charAt(0).toUpperCase()+rt.substr(1)).join(""):nt}_toCamelCase(nt){const ot=nt.match(/[a-z0-9]+/gi);return ot?ot.map((rt,ut)=>ut===0?rt.charAt(0).toLowerCase()+rt.substr(1):rt.charAt(0).toUpperCase()+rt.substr(1)).join(""):nt}clone(){return new FormatString(this.index,this.shorthandName,this.ifValue,this.elseValue)}}class Variable extends TransformableMarker{constructor(nt){super(),this.name=nt}resolve(nt){let ot=nt.resolve(this);return this.transform&&(ot=this.transform.resolve(ot||"")),ot!==void 0?(this._children=[new Text(ot)],!0):!1}clone(){const nt=new Variable(this.name);return this.transform&&(nt.transform=this.transform.clone()),nt._children=this.children.map(ot=>ot.clone()),nt}}function walk(ct,nt){const ot=[...ct];for(;ot.length>0;){const rt=ot.shift();if(!nt(rt))break;ot.unshift(...rt.children)}}class TextmateSnippet extends Marker{get placeholderInfo(){if(!this._placeholders){const nt=[];let ot;this.walk(function(rt){return rt instanceof Placeholder&&(nt.push(rt),ot=!ot||ot.index<rt.index?rt:ot),!0}),this._placeholders={all:nt,last:ot}}return this._placeholders}get placeholders(){const{all:nt}=this.placeholderInfo;return nt}offset(nt){let ot=0,rt=!1;return this.walk(ut=>ut===nt?(rt=!0,!1):(ot+=ut.len(),!0)),rt?ot:-1}fullLen(nt){let ot=0;return walk([nt],rt=>(ot+=rt.len(),!0)),ot}enclosingPlaceholders(nt){const ot=[];let{parent:rt}=nt;for(;rt;)rt instanceof Placeholder&&ot.push(rt),rt=rt.parent;return ot}resolveVariables(nt){return this.walk(ot=>(ot instanceof Variable&&ot.resolve(nt)&&(this._placeholders=void 0),!0)),this}appendChild(nt){return this._placeholders=void 0,super.appendChild(nt)}replace(nt,ot){return this._placeholders=void 0,super.replace(nt,ot)}clone(){const nt=new TextmateSnippet;return this._children=this.children.map(ot=>ot.clone()),nt}walk(nt){walk(this.children,nt)}}class SnippetParser{constructor(){this._scanner=new Scanner,this._token={type:14,pos:0,len:0}}static escape(nt){return nt.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(nt){return/\${?CLIPBOARD/.test(nt)}parse(nt,ot,rt){const ut=new TextmateSnippet;return this.parseFragment(nt,ut),this.ensureFinalTabstop(ut,rt??!1,ot??!1),ut}parseFragment(nt,ot){const rt=ot.children.length;for(this._scanner.text(nt),this._token=this._scanner.next();this._parse(ot););const ut=new Map,gt=[];ot.walk(vt=>(vt instanceof Placeholder&&(vt.isFinalTabstop?ut.set(0,void 0):!ut.has(vt.index)&&vt.children.length>0?ut.set(vt.index,vt.children):gt.push(vt)),!0));const pt=(vt,St)=>{const yt=ut.get(vt.index);if(!yt)return;const wt=new Placeholder(vt.index);wt.transform=vt.transform;for(const Lt of yt){const xt=Lt.clone();wt.appendChild(xt),xt instanceof Placeholder&&ut.has(xt.index)&&!St.has(xt.index)&&(St.add(xt.index),pt(xt,St),St.delete(xt.index))}ot.replace(vt,[wt])},mt=new Set;for(const vt of gt)pt(vt,mt);return ot.children.slice(rt)}ensureFinalTabstop(nt,ot,rt){(ot||rt&&nt.placeholders.length>0)&&(nt.placeholders.find(gt=>gt.index===0)||nt.appendChild(new Placeholder(0)))}_accept(nt,ot){if(nt===void 0||this._token.type===nt){const rt=ot?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),rt}return!1}_backTo(nt){return this._scanner.pos=nt.pos+nt.len,this._token=nt,!1}_until(nt){const ot=this._token;for(;this._token.type!==nt;){if(this._token.type===14)return!1;if(this._token.type===5){const ut=this._scanner.next();if(ut.type!==0&&ut.type!==4&&ut.type!==5)return!1}this._token=this._scanner.next()}const rt=this._scanner.value.substring(ot.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),rt}_parse(nt){return this._parseEscaped(nt)||this._parseTabstopOrVariableName(nt)||this._parseComplexPlaceholder(nt)||this._parseComplexVariable(nt)||this._parseAnything(nt)}_parseEscaped(nt){let ot;return(ot=this._accept(5,!0))?(ot=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||ot,nt.appendChild(new Text(ot)),!0):!1}_parseTabstopOrVariableName(nt){let ot;const rt=this._token;return this._accept(0)&&(ot=this._accept(9,!0)||this._accept(8,!0))?(nt.appendChild(/^\d+$/.test(ot)?new Placeholder(Number(ot)):new Variable(ot)),!0):this._backTo(rt)}_parseComplexPlaceholder(nt){let ot;const rt=this._token;if(!(this._accept(0)&&this._accept(3)&&(ot=this._accept(8,!0))))return this._backTo(rt);const gt=new Placeholder(Number(ot));if(this._accept(1))for(;;){if(this._accept(4))return nt.appendChild(gt),!0;if(!this._parse(gt))return nt.appendChild(new Text("${"+ot+":")),gt.children.forEach(nt.appendChild,nt),!0}else if(gt.index>0&&this._accept(7)){const pt=new Choice;for(;;){if(this._parseChoiceElement(pt)){if(this._accept(2))continue;if(this._accept(7)&&(gt.appendChild(pt),this._accept(4)))return nt.appendChild(gt),!0}return this._backTo(rt),!1}}else return this._accept(6)?this._parseTransform(gt)?(nt.appendChild(gt),!0):(this._backTo(rt),!1):this._accept(4)?(nt.appendChild(gt),!0):this._backTo(rt)}_parseChoiceElement(nt){const ot=this._token,rt=[];for(;!(this._token.type===2||this._token.type===7);){let ut;if((ut=this._accept(5,!0))?ut=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||ut:ut=this._accept(void 0,!0),!ut)return this._backTo(ot),!1;rt.push(ut)}return rt.length===0?(this._backTo(ot),!1):(nt.appendChild(new Text(rt.join(""))),!0)}_parseComplexVariable(nt){let ot;const rt=this._token;if(!(this._accept(0)&&this._accept(3)&&(ot=this._accept(9,!0))))return this._backTo(rt);const gt=new Variable(ot);if(this._accept(1))for(;;){if(this._accept(4))return nt.appendChild(gt),!0;if(!this._parse(gt))return nt.appendChild(new Text("${"+ot+":")),gt.children.forEach(nt.appendChild,nt),!0}else return this._accept(6)?this._parseTransform(gt)?(nt.appendChild(gt),!0):(this._backTo(rt),!1):this._accept(4)?(nt.appendChild(gt),!0):this._backTo(rt)}_parseTransform(nt){const ot=new Transform;let rt="",ut="";for(;!this._accept(6);){let gt;if(gt=this._accept(5,!0)){gt=this._accept(6,!0)||gt,rt+=gt;continue}if(this._token.type!==14){rt+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let gt;if(gt=this._accept(5,!0)){gt=this._accept(5,!0)||this._accept(6,!0)||gt,ot.appendChild(new Text(gt));continue}if(!(this._parseFormatString(ot)||this._parseAnything(ot)))return!1}for(;!this._accept(4);){if(this._token.type!==14){ut+=this._accept(void 0,!0);continue}return!1}try{ot.regexp=new RegExp(rt,ut)}catch{return!1}return nt.transform=ot,!0}_parseFormatString(nt){const ot=this._token;if(!this._accept(0))return!1;let rt=!1;this._accept(3)&&(rt=!0);const ut=this._accept(8,!0);if(ut)if(rt){if(this._accept(4))return nt.appendChild(new FormatString(Number(ut))),!0;if(!this._accept(1))return this._backTo(ot),!1}else return nt.appendChild(new FormatString(Number(ut))),!0;else return this._backTo(ot),!1;if(this._accept(6)){const gt=this._accept(9,!0);return!gt||!this._accept(4)?(this._backTo(ot),!1):(nt.appendChild(new FormatString(Number(ut),gt)),!0)}else if(this._accept(11)){const gt=this._until(4);if(gt)return nt.appendChild(new FormatString(Number(ut),void 0,gt,void 0)),!0}else if(this._accept(12)){const gt=this._until(4);if(gt)return nt.appendChild(new FormatString(Number(ut),void 0,void 0,gt)),!0}else if(this._accept(13)){const gt=this._until(1);if(gt){const pt=this._until(4);if(pt)return nt.appendChild(new FormatString(Number(ut),void 0,gt,pt)),!0}}else{const gt=this._until(4);if(gt)return nt.appendChild(new FormatString(Number(ut),void 0,void 0,gt)),!0}return this._backTo(ot),!1}_parseAnything(nt){return this._token.type!==14?(nt.appendChild(new Text(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}}const NLS_DEFAULT_LABEL=localize("defaultLabel","input"),NLS_PRESERVE_CASE_LABEL=localize("label.preserveCaseToggle","Preserve Case");class PreserveCaseToggle extends Toggle{constructor(nt){super({icon:Codicon.preserveCase,title:NLS_PRESERVE_CASE_LABEL+nt.appendTitle,isChecked:nt.isChecked,inputActiveOptionBorder:nt.inputActiveOptionBorder,inputActiveOptionForeground:nt.inputActiveOptionForeground,inputActiveOptionBackground:nt.inputActiveOptionBackground})}}class ReplaceInput extends Widget$1{constructor(nt,ot,rt,ut){super(),this._showOptionButtons=rt,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new Emitter$2),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new Emitter$2),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new Emitter$2),this._onInput=this._register(new Emitter$2),this._onKeyUp=this._register(new Emitter$2),this._onPreserveCaseKeyDown=this._register(new Emitter$2),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=ot,this.placeholder=ut.placeholder||"",this.validation=ut.validation,this.label=ut.label||NLS_DEFAULT_LABEL;const gt=ut.appendPreserveCaseLabel||"",pt=ut.history||[],mt=!!ut.flexibleHeight,vt=!!ut.flexibleWidth,St=ut.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new HistoryInputBox(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:pt,showHistoryHint:ut.showHistoryHint,flexibleHeight:mt,flexibleWidth:vt,flexibleMaxHeight:St,inputBoxStyles:ut.inputBoxStyles})),this.preserveCase=this._register(new PreserveCaseToggle(Object.assign({appendTitle:gt,isChecked:!1},ut.toggleStyles))),this._register(this.preserveCase.onChange(Lt=>{this._onDidOptionChange.fire(Lt),!Lt&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(Lt=>{this._onPreserveCaseKeyDown.fire(Lt)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;const yt=[this.preserveCase.domNode];this.onkeydown(this.domNode,Lt=>{if(Lt.equals(15)||Lt.equals(17)||Lt.equals(9)){const xt=yt.indexOf(document.activeElement);if(xt>=0){let It=-1;Lt.equals(17)?It=(xt+1)%yt.length:Lt.equals(15)&&(xt===0?It=yt.length-1:It=xt-1),Lt.equals(9)?(yt[xt].blur(),this.inputBox.focus()):It>=0&&yt[It].focus(),EventHelper.stop(Lt,!0)}}});const wt=document.createElement("div");wt.className="controls",wt.style.display=this._showOptionButtons?"block":"none",wt.appendChild(this.preserveCase.domNode),this.domNode.appendChild(wt),nt==null||nt.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,Lt=>this._onKeyDown.fire(Lt)),this.onkeyup(this.inputBox.inputElement,Lt=>this._onKeyUp.fire(Lt)),this.oninput(this.inputBox.inputElement,Lt=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,Lt=>this._onMouseDown.fire(Lt))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(nt){nt?this.enable():this.disable()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(nt){this.preserveCase.checked=nt}focusOnPreserve(){this.preserveCase.focus()}validate(){var nt;(nt=this.inputBox)===null||nt===void 0||nt.validate()}set width(nt){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=nt+"px"}dispose(){super.dispose()}}var __decorate$17=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$17=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const historyNavigationVisible=new RawContextKey("suggestWidgetVisible",!1,localize("suggestWidgetVisible","Whether suggestion are visible")),HistoryNavigationWidgetFocusContext="historyNavigationWidgetFocus",HistoryNavigationForwardsEnablementContext="historyNavigationForwardsEnabled",HistoryNavigationBackwardsEnablementContext="historyNavigationBackwardsEnabled";let lastFocusedWidget;const widgets=[];function registerAndCreateHistoryNavigationContext(ct,nt){if(widgets.includes(nt))throw new Error("Cannot register the same widget multiple times");widgets.push(nt);const ot=new DisposableStore,rt=new RawContextKey(HistoryNavigationWidgetFocusContext,!1).bindTo(ct),ut=new RawContextKey(HistoryNavigationForwardsEnablementContext,!0).bindTo(ct),gt=new RawContextKey(HistoryNavigationBackwardsEnablementContext,!0).bindTo(ct),pt=()=>{rt.set(!0),lastFocusedWidget=nt},mt=()=>{rt.set(!1),lastFocusedWidget===nt&&(lastFocusedWidget=void 0)};return nt.element===document.activeElement&&pt(),ot.add(nt.onDidFocus(()=>pt())),ot.add(nt.onDidBlur(()=>mt())),ot.add(toDisposable(()=>{widgets.splice(widgets.indexOf(nt),1),mt()})),{historyNavigationForwardsEnablement:ut,historyNavigationBackwardsEnablement:gt,dispose(){ot.dispose()}}}let ContextScopedFindInput=class extends FindInput{constructor(nt,ot,rt,ut){super(nt,ot,rt);const gt=this._register(ut.createScoped(this.inputBox.element));this._register(registerAndCreateHistoryNavigationContext(gt,this.inputBox))}};ContextScopedFindInput=__decorate$17([__param$17(3,IContextKeyService)],ContextScopedFindInput);let ContextScopedReplaceInput=class extends ReplaceInput{constructor(nt,ot,rt,ut,gt=!1){super(nt,ot,gt,rt);const pt=this._register(ut.createScoped(this.inputBox.element));this._register(registerAndCreateHistoryNavigationContext(pt,this.inputBox))}};ContextScopedReplaceInput=__decorate$17([__param$17(3,IContextKeyService)],ContextScopedReplaceInput);KeybindingsRegistry.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetFocusContext),ContextKeyExpr.equals(HistoryNavigationBackwardsEnablementContext,!0),historyNavigationVisible.isEqualTo(!1)),primary:16,secondary:[528],handler:ct=>{lastFocusedWidget==null||lastFocusedWidget.showPreviousValue()}});KeybindingsRegistry.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetFocusContext),ContextKeyExpr.equals(HistoryNavigationForwardsEnablementContext,!0),historyNavigationVisible.isEqualTo(!1)),primary:18,secondary:[530],handler:ct=>{lastFocusedWidget==null||lastFocusedWidget.showNextValue()}});var __awaiter$L=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const Context$1={Visible:historyNavigationVisible,HasFocusedSuggestion:new RawContextKey("suggestWidgetHasFocusedSuggestion",!1,localize("suggestWidgetHasSelection","Whether any suggestion is focused")),DetailsVisible:new RawContextKey("suggestWidgetDetailsVisible",!1,localize("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new RawContextKey("suggestWidgetMultipleSuggestions",!1,localize("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new RawContextKey("suggestionMakesTextEdit",!0,localize("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new RawContextKey("acceptSuggestionOnEnter",!0,localize("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new RawContextKey("suggestionHasInsertAndReplaceRange",!1,localize("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new RawContextKey("suggestionInsertMode",void 0,{type:"string",description:localize("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new RawContextKey("suggestionCanResolve",!1,localize("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))},suggestWidgetStatusbarMenu=new MenuId("suggestWidgetStatusBar");class CompletionItem{constructor(nt,ot,rt,ut){var gt;this.position=nt,this.completion=ot,this.container=rt,this.provider=ut,this.isInvalid=!1,this.score=FuzzyScore.Default,this.distance=0,this.textLabel=typeof ot.label=="string"?ot.label:(gt=ot.label)===null||gt===void 0?void 0:gt.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=ot.sortText&&ot.sortText.toLowerCase(),this.filterTextLow=ot.filterText&&ot.filterText.toLowerCase(),this.extensionId=ot.extensionId,Range$2.isIRange(ot.range)?(this.editStart=new Position$1(ot.range.startLineNumber,ot.range.startColumn),this.editInsertEnd=new Position$1(ot.range.endLineNumber,ot.range.endColumn),this.editReplaceEnd=new Position$1(ot.range.endLineNumber,ot.range.endColumn),this.isInvalid=this.isInvalid||Range$2.spansMultipleLines(ot.range)||ot.range.startLineNumber!==nt.lineNumber):(this.editStart=new Position$1(ot.range.insert.startLineNumber,ot.range.insert.startColumn),this.editInsertEnd=new Position$1(ot.range.insert.endLineNumber,ot.range.insert.endColumn),this.editReplaceEnd=new Position$1(ot.range.replace.endLineNumber,ot.range.replace.endColumn),this.isInvalid=this.isInvalid||Range$2.spansMultipleLines(ot.range.insert)||Range$2.spansMultipleLines(ot.range.replace)||ot.range.insert.startLineNumber!==nt.lineNumber||ot.range.replace.startLineNumber!==nt.lineNumber||ot.range.insert.startColumn!==ot.range.replace.startColumn),typeof ut.resolveCompletionItem!="function"&&(this._resolveCache=Promise.resolve(),this._isResolved=!0)}get isResolved(){return!!this._isResolved}resolve(nt){return __awaiter$L(this,void 0,void 0,function*(){if(!this._resolveCache){const ot=nt.onCancellationRequested(()=>{this._resolveCache=void 0,this._isResolved=!1});this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,nt)).then(rt=>{Object.assign(this.completion,rt),this._isResolved=!0,ot.dispose()},rt=>{isCancellationError(rt)&&(this._resolveCache=void 0,this._isResolved=!1)})}return this._resolveCache})}}class CompletionOptions{constructor(nt=2,ot=new Set,rt=new Set,ut=new Map,gt=!0){this.snippetSortOrder=nt,this.kindFilter=ot,this.providerFilter=rt,this.providerItemsToReuse=ut,this.showDeprecated=gt}}CompletionOptions.default=new CompletionOptions;let _snippetSuggestSupport;function getSnippetSuggestSupport(){return _snippetSuggestSupport}class CompletionItemModel{constructor(nt,ot,rt,ut){this.items=nt,this.needsClipboard=ot,this.durations=rt,this.disposable=ut}}function provideSuggestionItems(ct,nt,ot,rt=CompletionOptions.default,ut={triggerKind:0},gt=CancellationToken.None){return __awaiter$L(this,void 0,void 0,function*(){const pt=new StopWatch(!0);ot=ot.clone();const mt=nt.getWordAtPosition(ot),vt=mt?new Range$2(ot.lineNumber,mt.startColumn,ot.lineNumber,mt.endColumn):Range$2.fromPositions(ot),St={replace:vt,insert:vt.setEndPosition(ot.lineNumber,ot.column)},yt=[],wt=new DisposableStore,Lt=[];let xt=!1;const It=(At,Tt,Rt)=>{var Nt,Pt,Ft;let Kt=!1;if(!Tt)return Kt;for(const Bt of Tt.suggestions)if(!rt.kindFilter.has(Bt.kind)){if(!rt.showDeprecated&&(!((Nt=Bt==null?void 0:Bt.tags)===null||Nt===void 0)&&Nt.includes(1)))continue;Bt.range||(Bt.range=St),Bt.sortText||(Bt.sortText=typeof Bt.label=="string"?Bt.label:Bt.label.label),!xt&&Bt.insertTextRules&&Bt.insertTextRules&4&&(xt=SnippetParser.guessNeedsClipboard(Bt.insertText)),yt.push(new CompletionItem(ot,Bt,Tt,At)),Kt=!0}return isDisposable(Tt)&&wt.add(Tt),Lt.push({providerName:(Pt=At._debugDisplayName)!==null&&Pt!==void 0?Pt:"unknown_provider",elapsedProvider:(Ft=Tt.duration)!==null&&Ft!==void 0?Ft:-1,elapsedOverall:Rt.elapsed()}),Kt},kt=(()=>__awaiter$L(this,void 0,void 0,function*(){}))();for(const At of ct.orderedGroups(nt)){let Tt=!1;if(yield Promise.all(At.map(Rt=>__awaiter$L(this,void 0,void 0,function*(){if(rt.providerItemsToReuse.has(Rt)){const Nt=rt.providerItemsToReuse.get(Rt);Nt.forEach(Pt=>yt.push(Pt)),Tt=Tt||Nt.length>0;return}if(!(rt.providerFilter.size>0&&!rt.providerFilter.has(Rt)))try{const Nt=new StopWatch(!0),Pt=yield Rt.provideCompletionItems(nt,ot,ut,gt);Tt=It(Rt,Pt,Nt)||Tt}catch(Nt){onUnexpectedExternalError(Nt)}}))),Tt||gt.isCancellationRequested)break}return yield kt,gt.isCancellationRequested?(wt.dispose(),Promise.reject(new CancellationError)):new CompletionItemModel(yt.sort(getSuggestionComparator(rt.snippetSortOrder)),xt,{entries:Lt,elapsed:pt.elapsed()},wt)})}function defaultComparator(ct,nt){if(ct.sortTextLow&&nt.sortTextLow){if(ct.sortTextLow<nt.sortTextLow)return-1;if(ct.sortTextLow>nt.sortTextLow)return 1}return ct.textLabel<nt.textLabel?-1:ct.textLabel>nt.textLabel?1:ct.completion.kind-nt.completion.kind}function snippetUpComparator(ct,nt){if(ct.completion.kind!==nt.completion.kind){if(ct.completion.kind===27)return-1;if(nt.completion.kind===27)return 1}return defaultComparator(ct,nt)}function snippetDownComparator(ct,nt){if(ct.completion.kind!==nt.completion.kind){if(ct.completion.kind===27)return 1;if(nt.completion.kind===27)return-1}return defaultComparator(ct,nt)}const _snippetComparators=new Map;_snippetComparators.set(0,snippetUpComparator);_snippetComparators.set(2,snippetDownComparator);_snippetComparators.set(1,defaultComparator);function getSuggestionComparator(ct){return _snippetComparators.get(ct)}CommandsRegistry.registerCommand("_executeCompletionItemProvider",(ct,...nt)=>__awaiter$L(void 0,void 0,void 0,function*(){const[ot,rt,ut,gt]=nt;assertType(URI.isUri(ot)),assertType(Position$1.isIPosition(rt)),assertType(typeof ut=="string"||!ut),assertType(typeof gt=="number"||!gt);const{completionProvider:pt}=ct.get(ILanguageFeaturesService),mt=yield ct.get(ITextModelService).createModelReference(ot);try{const vt={incomplete:!1,suggestions:[]},St=[],yt=mt.object.textEditorModel.validatePosition(rt),wt=yield provideSuggestionItems(pt,mt.object.textEditorModel,yt,void 0,{triggerCharacter:ut??void 0,triggerKind:ut?1:0});for(const Lt of wt.items)St.length<(gt??0)&&St.push(Lt.resolve(CancellationToken.None)),vt.incomplete=vt.incomplete||Lt.container.incomplete,vt.suggestions.push(Lt.completion);try{return yield Promise.all(St),vt}finally{setTimeout(()=>wt.disposable.dispose(),100)}}finally{mt.dispose()}}));function showSimpleSuggestions(ct,nt){var ot;(ot=ct.getContribution("editor.contrib.suggestController"))===null||ot===void 0||ot.triggerSuggest(new Set().add(nt),void 0,!0)}class QuickSuggestionsOptions{static isAllOff(nt){return nt.other==="off"&&nt.comments==="off"&&nt.strings==="off"}static isAllOn(nt){return nt.other==="on"&&nt.comments==="on"&&nt.strings==="on"}static valueFor(nt,ot){switch(ot){case 1:return nt.comments;case 2:return nt.strings;default:return nt.other}}}var __decorate$16=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$16=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const $$4=$$d;let ContentHoverController=class Qo extends Disposable{constructor(nt,ot,rt){super(),this._editor=nt,this._instantiationService=ot,this._keybindingService=rt,this._widget=this._register(this._instantiationService.createInstance(ContentHoverWidget,this._editor)),this._currentResult=null,this._participants=[];for(const ut of HoverParticipantRegistry.getAll())this._participants.push(this._instantiationService.createInstance(ut,this._editor));this._participants.sort((ut,gt)=>ut.hoverOrdinal-gt.hoverOrdinal),this._computer=new ContentHoverComputer(this._editor,this._participants),this._hoverOperation=this._register(new HoverOperation(this._editor,this._computer)),this._register(this._hoverOperation.onResult(ut=>{if(!this._computer.anchor)return;const gt=ut.hasLoadingMessage?this._addLoadingMessage(ut.value):ut.value;this._withResult(new HoverResult(this._computer.anchor,gt,ut.isComplete))})),this._register(addStandardDisposableListener(this._widget.getDomNode(),"keydown",ut=>{ut.equals(9)&&this.hide()})),this._register(TokenizationRegistry.onDidChange(()=>{this._widget.position&&this._currentResult&&(this._widget.clear(),this._setCurrentResult(this._currentResult))}))}maybeShowAt(nt){const ot=[];for(const ut of this._participants)if(ut.suggestHoverAnchor){const gt=ut.suggestHoverAnchor(nt);gt&&ot.push(gt)}const rt=nt.target;if(rt.type===6&&ot.push(new HoverRangeAnchor(0,rt.range,nt.event.posx,nt.event.posy)),rt.type===7){const ut=this._editor.getOption(48).typicalHalfwidthCharacterWidth/2;!rt.detail.isAfterLines&&typeof rt.detail.horizontalDistanceToText=="number"&&rt.detail.horizontalDistanceToText<ut&&ot.push(new HoverRangeAnchor(0,rt.range,nt.event.posx,nt.event.posy))}return ot.length===0?this._startShowingOrUpdateHover(null,0,0,!1,nt):(ot.sort((ut,gt)=>gt.priority-ut.priority),this._startShowingOrUpdateHover(ot[0],0,0,!1,nt))}startShowingAtRange(nt,ot,rt,ut){this._startShowingOrUpdateHover(new HoverRangeAnchor(0,nt,void 0,void 0),ot,rt,ut,null)}_startShowingOrUpdateHover(nt,ot,rt,ut,gt){return!this._widget.position||!this._currentResult?nt?(this._startHoverOperationIfNecessary(nt,ot,rt,ut,!1),!0):!1:this._editor.getOption(58).sticky&&gt&&this._widget.isMouseGettingCloser(gt.event.posx,gt.event.posy)?(nt&&this._startHoverOperationIfNecessary(nt,ot,rt,ut,!0),!0):nt?nt&&this._currentResult.anchor.equals(nt)?!0:nt.canAdoptVisibleHover(this._currentResult.anchor,this._widget.position)?(this._setCurrentResult(this._currentResult.filter(nt)),this._startHoverOperationIfNecessary(nt,ot,rt,ut,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(nt,ot,rt,ut,!1),!0):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(nt,ot,rt,ut,gt){this._computer.anchor&&this._computer.anchor.equals(nt)||(this._hoverOperation.cancel(),this._computer.anchor=nt,this._computer.shouldFocus=ut,this._computer.source=rt,this._computer.insistOnKeepingHoverVisible=gt,this._hoverOperation.start(ot))}_setCurrentResult(nt){this._currentResult!==nt&&(nt&&nt.messages.length===0&&(nt=null),this._currentResult=nt,this._currentResult?this._renderMessages(this._currentResult.anchor,this._currentResult.messages):this._widget.hide())}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._setCurrentResult(null)}isColorPickerVisible(){return this._widget.isColorPickerVisible}isVisibleFromKeyboard(){return this._widget.isVisibleFromKeyboard}isVisible(){return this._widget.isVisible}containsNode(nt){return nt?this._widget.getDomNode().contains(nt):!1}_addLoadingMessage(nt){if(this._computer.anchor){for(const ot of this._participants)if(ot.createLoadingMessage){const rt=ot.createLoadingMessage(this._computer.anchor);if(rt)return nt.slice(0).concat([rt])}}return nt}_withResult(nt){this._widget.position&&this._currentResult&&this._currentResult.isComplete&&(!nt.isComplete||this._computer.insistOnKeepingHoverVisible&&nt.messages.length===0)||this._setCurrentResult(nt)}_renderMessages(nt,ot){const{showAtPosition:rt,showAtSecondaryPosition:ut,highlightRange:gt}=Qo.computeHoverRanges(this._editor,nt.range,ot),pt=new DisposableStore,mt=pt.add(new EditorHoverStatusBar(this._keybindingService)),vt=document.createDocumentFragment();let St=null;const yt={fragment:vt,statusBar:mt,setColorPicker:Lt=>St=Lt,onContentsChanged:()=>this._widget.onContentsChanged(),hide:()=>this.hide()};for(const Lt of this._participants){const xt=ot.filter(It=>It.owner===Lt);xt.length>0&&pt.add(Lt.renderHoverParts(yt,xt))}const wt=ot.some(Lt=>Lt.isBeforeContent);if(mt.hasContent&&vt.appendChild(mt.hoverElement),vt.hasChildNodes()){if(gt){const Lt=this._editor.createDecorationsCollection();Lt.set([{range:gt,options:Qo._DECORATION_OPTIONS}]),pt.add(toDisposable(()=>{Lt.clear()}))}this._widget.showAt(vt,new ContentHoverVisibleData(St,rt,ut,this._editor.getOption(58).above,this._computer.shouldFocus,this._computer.source,wt,nt.initialMousePosX,nt.initialMousePosY,pt))}else pt.dispose()}static computeHoverRanges(nt,ot,rt){let ut=1;if(nt.hasModel()){const St=nt._getViewModel(),yt=St.coordinatesConverter,wt=yt.convertModelRangeToViewRange(ot),Lt=new Position$1(wt.startLineNumber,St.getLineMinColumn(wt.startLineNumber));ut=yt.convertViewPositionToModelPosition(Lt).column}const gt=ot.startLineNumber;let pt=ot.startColumn,mt=rt[0].range,vt=null;for(const St of rt)mt=Range$2.plusRange(mt,St.range),St.range.startLineNumber===gt&&St.range.endLineNumber===gt&&(pt=Math.max(Math.min(pt,St.range.startColumn),ut)),St.forceShowAtRange&&(vt=St.range);return{showAtPosition:vt?vt.getStartPosition():new Position$1(gt,ot.startColumn),showAtSecondaryPosition:vt?vt.getStartPosition():new Position$1(gt,pt),highlightRange:mt}}focus(){this._widget.focus()}scrollUp(){this._widget.scrollUp()}scrollDown(){this._widget.scrollDown()}scrollLeft(){this._widget.scrollLeft()}scrollRight(){this._widget.scrollRight()}pageUp(){this._widget.pageUp()}pageDown(){this._widget.pageDown()}goToTop(){this._widget.goToTop()}goToBottom(){this._widget.goToBottom()}escape(){this._widget.escape()}};ContentHoverController._DECORATION_OPTIONS=ModelDecorationOptions.register({description:"content-hover-highlight",className:"hoverHighlight"});ContentHoverController=__decorate$16([__param$16(1,IInstantiationService),__param$16(2,IKeybindingService)],ContentHoverController);class HoverResult{constructor(nt,ot,rt){this.anchor=nt,this.messages=ot,this.isComplete=rt}filter(nt){const ot=this.messages.filter(rt=>rt.isValidForHoverAnchor(nt));return ot.length===this.messages.length?this:new FilteredHoverResult(this,this.anchor,ot,this.isComplete)}}class FilteredHoverResult extends HoverResult{constructor(nt,ot,rt,ut){super(ot,rt,ut),this.original=nt}filter(nt){return this.original.filter(nt)}}class ContentHoverVisibleData{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt){this.colorPicker=nt,this.showAtPosition=ot,this.showAtSecondaryPosition=rt,this.preferAbove=ut,this.stoleFocus=gt,this.source=pt,this.isBeforeContent=mt,this.initialMousePosX=vt,this.initialMousePosY=St,this.disposables=yt,this.closestMouseDistance=void 0}}let ContentHoverWidget=class vr extends Disposable{get position(){var nt,ot;return(ot=(nt=this._visibleData)===null||nt===void 0?void 0:nt.showAtPosition)!==null&&ot!==void 0?ot:null}get isColorPickerVisible(){var nt;return!!(!((nt=this._visibleData)===null||nt===void 0)&&nt.colorPicker)}get isVisibleFromKeyboard(){var nt;return((nt=this._visibleData)===null||nt===void 0?void 0:nt.source)===1}get isVisible(){var nt;return(nt=this._hoverVisibleKey.get())!==null&&nt!==void 0?nt:!1}constructor(nt,ot){super(),this._editor=nt,this._contextKeyService=ot,this.allowEditorOverflow=!0,this._hoverVisibleKey=EditorContextKeys.hoverVisible.bindTo(this._contextKeyService),this._hoverFocusedKey=EditorContextKeys.hoverFocused.bindTo(this._contextKeyService),this._hover=this._register(new HoverWidget),this._focusTracker=this._register(trackFocus(this.getDomNode())),this._horizontalScrollingBy=30,this._visibleData=null,this._register(this._editor.onDidLayoutChange(()=>this._layout())),this._register(this._editor.onDidChangeConfiguration(rt=>{rt.hasChanged(48)&&this._updateFont()})),this._setVisibleData(null),this._layout(),this._editor.addContentWidget(this),this._register(this._focusTracker.onDidFocus(()=>{this._hoverFocusedKey.set(!0)})),this._register(this._focusTracker.onDidBlur(()=>{this._hoverFocusedKey.set(!1)}))}dispose(){this._editor.removeContentWidget(this),this._visibleData&&this._visibleData.disposables.dispose(),super.dispose()}getId(){return vr.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){if(!this._visibleData)return null;let nt=this._visibleData.preferAbove;!nt&&this._contextKeyService.getContextKeyValue(Context$1.Visible.key)&&(nt=!0);const ot=this._visibleData.isBeforeContent?3:void 0;return{position:this._visibleData.showAtPosition,secondaryPosition:this._visibleData.showAtSecondaryPosition,preference:nt?[1,2]:[2,1],positionAffinity:ot}}isMouseGettingCloser(nt,ot){if(!this._visibleData)return!1;if(typeof this._visibleData.initialMousePosX>"u"||typeof this._visibleData.initialMousePosY>"u")return this._visibleData.initialMousePosX=nt,this._visibleData.initialMousePosY=ot,!1;const rt=getDomNodePagePosition(this.getDomNode());typeof this._visibleData.closestMouseDistance>"u"&&(this._visibleData.closestMouseDistance=computeDistanceFromPointToRectangle(this._visibleData.initialMousePosX,this._visibleData.initialMousePosY,rt.left,rt.top,rt.width,rt.height));const ut=computeDistanceFromPointToRectangle(nt,ot,rt.left,rt.top,rt.width,rt.height);return ut>this._visibleData.closestMouseDistance+4?!1:(this._visibleData.closestMouseDistance=Math.min(this._visibleData.closestMouseDistance,ut),!0)}_setVisibleData(nt){this._visibleData&&this._visibleData.disposables.dispose(),this._visibleData=nt,this._hoverVisibleKey.set(!!this._visibleData),this._hover.containerDomNode.classList.toggle("hidden",!this._visibleData)}_layout(){const nt=Math.max(this._editor.getLayoutInfo().height/4,250),{fontSize:ot,lineHeight:rt}=this._editor.getOption(48);this._hover.contentsDomNode.style.fontSize=`${ot}px`,this._hover.contentsDomNode.style.lineHeight=`${rt/ot}`,this._hover.contentsDomNode.style.maxHeight=`${nt}px`,this._hover.contentsDomNode.style.maxWidth=`${Math.max(this._editor.getLayoutInfo().width*.66,500)}px`}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(ot=>this._editor.applyFontInfo(ot))}showAt(nt,ot){var rt;this._setVisibleData(ot),this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(nt),this._hover.contentsDomNode.style.paddingBottom="",this._updateFont(),this.onContentsChanged(),this._editor.render(),this.onContentsChanged(),ot.stoleFocus&&this._hover.containerDomNode.focus(),(rt=ot.colorPicker)===null||rt===void 0||rt.layout()}hide(){if(this._visibleData){const nt=this._visibleData.stoleFocus;this._setVisibleData(null),this._editor.layoutContentWidget(this),nt&&this._editor.focus()}}onContentsChanged(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged();const nt=this._hover.scrollbar.getScrollDimensions();if(nt.scrollWidth>nt.width){const rt=`${this._hover.scrollbar.options.horizontalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingBottom!==rt&&(this._hover.contentsDomNode.style.paddingBottom=rt,this._editor.layoutContentWidget(this),this._hover.onContentsChanged())}}clear(){this._hover.contentsDomNode.textContent=""}focus(){this._hover.containerDomNode.focus()}scrollUp(){const nt=this._hover.scrollbar.getScrollPosition().scrollTop,ot=this._editor.getOption(48);this._hover.scrollbar.setScrollPosition({scrollTop:nt-ot.lineHeight})}scrollDown(){const nt=this._hover.scrollbar.getScrollPosition().scrollTop,ot=this._editor.getOption(48);this._hover.scrollbar.setScrollPosition({scrollTop:nt+ot.lineHeight})}scrollLeft(){const nt=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:nt-this._horizontalScrollingBy})}scrollRight(){const nt=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:nt+this._horizontalScrollingBy})}pageUp(){const nt=this._hover.scrollbar.getScrollPosition().scrollTop,ot=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:nt-ot})}pageDown(){const nt=this._hover.scrollbar.getScrollPosition().scrollTop,ot=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:nt+ot})}goToTop(){this._hover.scrollbar.setScrollPosition({scrollTop:0})}goToBottom(){this._hover.scrollbar.setScrollPosition({scrollTop:this._hover.scrollbar.getScrollDimensions().scrollHeight})}escape(){this._editor.focus()}};ContentHoverWidget.ID="editor.contrib.contentHoverWidget";ContentHoverWidget=__decorate$16([__param$16(1,IContextKeyService)],ContentHoverWidget);let EditorHoverStatusBar=class extends Disposable{get hasContent(){return this._hasContent}constructor(nt){super(),this._keybindingService=nt,this._hasContent=!1,this.hoverElement=$$4("div.hover-row.status-bar"),this.actionsElement=append$1(this.hoverElement,$$4("div.actions"))}addAction(nt){const ot=this._keybindingService.lookupKeybinding(nt.commandId),rt=ot?ot.getLabel():null;return this._hasContent=!0,this._register(HoverAction.render(this.actionsElement,nt,rt))}append(nt){const ot=append$1(this.actionsElement,nt);return this._hasContent=!0,ot}};EditorHoverStatusBar=__decorate$16([__param$16(0,IKeybindingService)],EditorHoverStatusBar);class ContentHoverComputer{get anchor(){return this._anchor}set anchor(nt){this._anchor=nt}get shouldFocus(){return this._shouldFocus}set shouldFocus(nt){this._shouldFocus=nt}get source(){return this._source}set source(nt){this._source=nt}get insistOnKeepingHoverVisible(){return this._insistOnKeepingHoverVisible}set insistOnKeepingHoverVisible(nt){this._insistOnKeepingHoverVisible=nt}constructor(nt,ot){this._editor=nt,this._participants=ot,this._anchor=null,this._shouldFocus=!1,this._source=0,this._insistOnKeepingHoverVisible=!1}static _getLineDecorations(nt,ot){if(ot.type!==1&&!ot.supportsMarkerHover)return[];const rt=nt.getModel(),ut=ot.range.startLineNumber;if(ut>rt.getLineCount())return[];const gt=rt.getLineMaxColumn(ut);return nt.getLineDecorations(ut).filter(pt=>{if(pt.options.isWholeLine)return!0;const mt=pt.range.startLineNumber===ut?pt.range.startColumn:1,vt=pt.range.endLineNumber===ut?pt.range.endColumn:gt;if(pt.options.showIfCollapsed){if(mt>ot.range.startColumn+1||ot.range.endColumn-1>vt)return!1}else if(mt>ot.range.startColumn||ot.range.endColumn>vt)return!1;return!0})}computeAsync(nt){const ot=this._anchor;if(!this._editor.hasModel()||!ot)return AsyncIterableObject.EMPTY;const rt=ContentHoverComputer._getLineDecorations(this._editor,ot);return AsyncIterableObject.merge(this._participants.map(ut=>ut.computeAsync?ut.computeAsync(ot,rt,nt):AsyncIterableObject.EMPTY))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const nt=ContentHoverComputer._getLineDecorations(this._editor,this._anchor);let ot=[];for(const rt of this._participants)ot=ot.concat(rt.computeSync(this._anchor,nt));return coalesce(ot)}}function computeDistanceFromPointToRectangle(ct,nt,ot,rt,ut,gt){const pt=ot+ut/2,mt=rt+gt/2,vt=Math.max(Math.abs(ct-pt)-ut/2,0),St=Math.max(Math.abs(nt-mt)-gt/2,0);return Math.sqrt(vt*vt+St*St)}const renderedMarkdown="";var __decorate$15=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$15=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$K=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},_a$3;let MarkdownRenderer=class Cr{constructor(nt,ot,rt){this._options=nt,this._languageService=ot,this._openerService=rt,this._onDidRenderAsync=new Emitter$2,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(nt,ot,rt){if(!nt)return{element:document.createElement("span"),dispose:()=>{}};const ut=new DisposableStore,gt=ut.add(renderMarkdown(nt,Object.assign(Object.assign({},this._getRenderOptions(nt,ut)),ot),rt));return gt.element.classList.add("rendered-markdown"),{element:gt.element,dispose:()=>ut.dispose()}}_getRenderOptions(nt,ot){return{codeBlockRenderer:(rt,ut)=>__awaiter$K(this,void 0,void 0,function*(){var gt,pt,mt;let vt;rt?vt=this._languageService.getLanguageIdByLanguageName(rt):this._options.editor&&(vt=(gt=this._options.editor.getModel())===null||gt===void 0?void 0:gt.getLanguageId()),vt||(vt=PLAINTEXT_LANGUAGE_ID);const St=yield tokenizeToString(this._languageService,ut,vt),yt=document.createElement("span");if(yt.innerHTML=(mt=(pt=Cr._ttpTokenizer)===null||pt===void 0?void 0:pt.createHTML(St))!==null&&mt!==void 0?mt:St,this._options.editor){const wt=this._options.editor.getOption(48);applyFontInfo(yt,wt)}else this._options.codeBlockFontFamily&&(yt.style.fontFamily=this._options.codeBlockFontFamily);return this._options.codeBlockFontSize!==void 0&&(yt.style.fontSize=this._options.codeBlockFontSize),yt}),asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:rt=>openLinkFromMarkdown(this._openerService,rt,nt.isTrusted),disposables:ot}}}};MarkdownRenderer._ttpTokenizer=(_a$3=window.trustedTypes)===null||_a$3===void 0?void 0:_a$3.createPolicy("tokenizeToString",{createHTML(ct){return ct}});MarkdownRenderer=__decorate$15([__param$15(1,ILanguageService),__param$15(2,IOpenerService)],MarkdownRenderer);function openLinkFromMarkdown(ct,nt,ot){return __awaiter$K(this,void 0,void 0,function*(){try{return yield ct.open(nt,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:toAllowCommandsOption(ot)})}catch(rt){return onUnexpectedError(rt),!1}})}function toAllowCommandsOption(ct){return ct===!0?!0:ct&&Array.isArray(ct.enabledCommands)?ct.enabledCommands:!1}const $$3=$$d;class MarginHoverWidget extends Disposable{constructor(nt,ot,rt){super(),this._renderDisposeables=this._register(new DisposableStore),this._editor=nt,this._isVisible=!1,this._messages=[],this._hover=this._register(new HoverWidget),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new MarkdownRenderer({editor:this._editor},ot,rt)),this._computer=new MarginHoverComputer(this._editor),this._hoverOperation=this._register(new HoverOperation(this._editor,this._computer)),this._register(this._hoverOperation.onResult(ut=>{this._withResult(ut.value)})),this._register(this._editor.onDidChangeModelDecorations(()=>this._onModelDecorationsChanged())),this._register(this._editor.onDidChangeConfiguration(ut=>{ut.hasChanged(48)&&this._updateFont()})),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return MarginHoverWidget.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(ot=>this._editor.applyFontInfo(ot))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}startShowingAt(nt){this._computer.lineNumber!==nt&&(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=nt,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(nt){this._messages=nt,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(nt,ot){this._renderDisposeables.clear();const rt=document.createDocumentFragment();for(const ut of ot){const gt=$$3("div.hover-row.markdown-hover"),pt=append$1(gt,$$3("div.hover-contents")),mt=this._renderDisposeables.add(this._markdownRenderer.render(ut.value));pt.appendChild(mt.element),rt.appendChild(gt)}this._updateContents(rt),this._showAt(nt)}_updateContents(nt){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(nt),this._updateFont()}_showAt(nt){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const ot=this._editor.getLayoutInfo(),rt=this._editor.getTopForLineNumber(nt),ut=this._editor.getScrollTop(),gt=this._editor.getOption(64),pt=this._hover.containerDomNode.clientHeight,mt=rt-ut-(pt-gt)/2;this._hover.containerDomNode.style.left=`${ot.glyphMarginLeft+ot.glyphMarginWidth}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(mt),0)}px`}}MarginHoverWidget.ID="editor.contrib.modesGlyphHoverWidget";class MarginHoverComputer{get lineNumber(){return this._lineNumber}set lineNumber(nt){this._lineNumber=nt}constructor(nt){this._editor=nt,this._lineNumber=-1}computeSync(){const nt=ut=>({value:ut}),ot=this._editor.getLineDecorations(this._lineNumber),rt=[];if(!ot)return rt;for(const ut of ot){if(!ut.options.glyphMarginClassName)continue;const gt=ut.options.glyphMarginHoverMessage;!gt||isEmptyMarkdownString(gt)||rt.push(...asArray(gt).map(nt))}return rt}}var __awaiter$J=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class HoverProviderResult{constructor(nt,ot,rt){this.provider=nt,this.hover=ot,this.ordinal=rt}}function executeProvider(ct,nt,ot,rt,ut){return __awaiter$J(this,void 0,void 0,function*(){try{const gt=yield Promise.resolve(ct.provideHover(ot,rt,ut));if(gt&&isValid(gt))return new HoverProviderResult(ct,gt,nt)}catch(gt){onUnexpectedExternalError(gt)}})}function getHover(ct,nt,ot,rt){const gt=ct.ordered(nt).map((pt,mt)=>executeProvider(pt,mt,nt,ot,rt));return AsyncIterableObject.fromPromises(gt).coalesce()}function getHoverPromise(ct,nt,ot,rt){return getHover(ct,nt,ot,rt).map(ut=>ut.hover).toPromise()}registerModelAndPositionCommand("_executeHoverProvider",(ct,nt,ot)=>{const rt=ct.get(ILanguageFeaturesService);return getHoverPromise(rt.hoverProvider,nt,ot,CancellationToken.None)});function isValid(ct){const nt=typeof ct.range<"u",ot=typeof ct.contents<"u"&&ct.contents&&ct.contents.length>0;return nt&&ot}var __decorate$14=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$14=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const $$2=$$d;class MarkdownHover{constructor(nt,ot,rt,ut,gt){this.owner=nt,this.range=ot,this.contents=rt,this.isBeforeContent=ut,this.ordinal=gt}isValidForHoverAnchor(nt){return nt.type===1&&this.range.startColumn<=nt.range.startColumn&&this.range.endColumn>=nt.range.endColumn}}let MarkdownHoverParticipant=class{constructor(nt,ot,rt,ut,gt){this._editor=nt,this._languageService=ot,this._openerService=rt,this._configurationService=ut,this._languageFeaturesService=gt,this.hoverOrdinal=3}createLoadingMessage(nt){return new MarkdownHover(this,nt.range,[new MarkdownString().appendText(localize("modesContentHover.loading","Loading..."))],!1,2e3)}computeSync(nt,ot){if(!this._editor.hasModel()||nt.type!==1)return[];const rt=this._editor.getModel(),ut=nt.range.startLineNumber,gt=rt.getLineMaxColumn(ut),pt=[];let mt=1e3;const vt=rt.getLineLength(ut),St=rt.getLanguageIdAtPosition(nt.range.startLineNumber,nt.range.startColumn),yt=this._editor.getOption(112),wt=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:St});let Lt=!1;yt>=0&&vt>yt&&nt.range.startColumn>=yt&&(Lt=!0,pt.push(new MarkdownHover(this,nt.range,[{value:localize("stopped rendering","Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,mt++))),!Lt&&typeof wt=="number"&&vt>=wt&&pt.push(new MarkdownHover(this,nt.range,[{value:localize("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,mt++));let xt=!1;for(const It of ot){const kt=It.range.startLineNumber===ut?It.range.startColumn:1,At=It.range.endLineNumber===ut?It.range.endColumn:gt,Tt=It.options.hoverMessage;if(!Tt||isEmptyMarkdownString(Tt))continue;It.options.beforeContentClassName&&(xt=!0);const Rt=new Range$2(nt.range.startLineNumber,kt,nt.range.startLineNumber,At);pt.push(new MarkdownHover(this,Rt,asArray(Tt),xt,mt++))}return pt}computeAsync(nt,ot,rt){if(!this._editor.hasModel()||nt.type!==1)return AsyncIterableObject.EMPTY;const ut=this._editor.getModel();if(!this._languageFeaturesService.hoverProvider.has(ut))return AsyncIterableObject.EMPTY;const gt=new Position$1(nt.range.startLineNumber,nt.range.startColumn);return getHover(this._languageFeaturesService.hoverProvider,ut,gt,rt).filter(pt=>!isEmptyMarkdownString(pt.hover.contents)).map(pt=>{const mt=pt.hover.range?Range$2.lift(pt.hover.range):nt.range;return new MarkdownHover(this,mt,pt.hover.contents,!1,pt.ordinal)})}renderHoverParts(nt,ot){return renderMarkdownHovers(nt,ot,this._editor,this._languageService,this._openerService)}};MarkdownHoverParticipant=__decorate$14([__param$14(1,ILanguageService),__param$14(2,IOpenerService),__param$14(3,IConfigurationService),__param$14(4,ILanguageFeaturesService)],MarkdownHoverParticipant);function renderMarkdownHovers(ct,nt,ot,rt,ut){nt.sort((pt,mt)=>pt.ordinal-mt.ordinal);const gt=new DisposableStore;for(const pt of nt)for(const mt of pt.contents){if(isEmptyMarkdownString(mt))continue;const vt=$$2("div.hover-row.markdown-hover"),St=append$1(vt,$$2("div.hover-contents")),yt=gt.add(new MarkdownRenderer({editor:ot},rt,ut));gt.add(yt.onDidRenderAsync(()=>{St.className="hover-contents code-hover-contents",ct.onContentsChanged()}));const wt=gt.add(yt.render(mt));St.appendChild(wt.element),ct.fragment.appendChild(vt)}return gt}var __decorate$13=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$13=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};class MarkerCoordinate{constructor(nt,ot,rt){this.marker=nt,this.index=ot,this.total=rt}}let MarkerList=class{constructor(nt,ot,rt){this._markerService=ot,this._configService=rt,this._onDidChange=new Emitter$2,this.onDidChange=this._onDidChange.event,this._dispoables=new DisposableStore,this._markers=[],this._nextIdx=-1,URI.isUri(nt)?this._resourceFilter=mt=>mt.toString()===nt.toString():nt&&(this._resourceFilter=nt);const ut=this._configService.getValue("problems.sortOrder"),gt=(mt,vt)=>{let St=compare(mt.resource.toString(),vt.resource.toString());return St===0&&(ut==="position"?St=Range$2.compareRangesUsingStarts(mt,vt)||MarkerSeverity$1.compare(mt.severity,vt.severity):St=MarkerSeverity$1.compare(mt.severity,vt.severity)||Range$2.compareRangesUsingStarts(mt,vt)),St},pt=()=>{this._markers=this._markerService.read({resource:URI.isUri(nt)?nt:void 0,severities:MarkerSeverity$1.Error|MarkerSeverity$1.Warning|MarkerSeverity$1.Info}),typeof nt=="function"&&(this._markers=this._markers.filter(mt=>this._resourceFilter(mt.resource))),this._markers.sort(gt)};pt(),this._dispoables.add(ot.onMarkerChanged(mt=>{(!this._resourceFilter||mt.some(vt=>this._resourceFilter(vt)))&&(pt(),this._nextIdx=-1,this._onDidChange.fire())}))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(nt){return!this._resourceFilter&&!nt?!0:!this._resourceFilter||!nt?!1:this._resourceFilter(nt)}get selected(){const nt=this._markers[this._nextIdx];return nt&&new MarkerCoordinate(nt,this._nextIdx+1,this._markers.length)}_initIdx(nt,ot,rt){let ut=!1,gt=this._markers.findIndex(pt=>pt.resource.toString()===nt.uri.toString());gt<0&&(gt=binarySearch(this._markers,{resource:nt.uri},(pt,mt)=>compare(pt.resource.toString(),mt.resource.toString())),gt<0&&(gt=~gt));for(let pt=gt;pt<this._markers.length;pt++){let mt=Range$2.lift(this._markers[pt]);if(mt.isEmpty()){const vt=nt.getWordAtPosition(mt.getStartPosition());vt&&(mt=new Range$2(mt.startLineNumber,vt.startColumn,mt.startLineNumber,vt.endColumn))}if(ot&&(mt.containsPosition(ot)||ot.isBeforeOrEqual(mt.getStartPosition()))){this._nextIdx=pt,ut=!0;break}if(this._markers[pt].resource.toString()!==nt.uri.toString())break}ut||(this._nextIdx=rt?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(nt,ot,rt){if(this._markers.length===0)return!1;const ut=this._nextIdx;return this._nextIdx===-1?this._initIdx(ot,rt,nt):nt?this._nextIdx=(this._nextIdx+1)%this._markers.length:nt||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),ut!==this._nextIdx}find(nt,ot){let rt=this._markers.findIndex(ut=>ut.resource.toString()===nt.toString());if(!(rt<0)){for(;rt<this._markers.length;rt++)if(Range$2.containsPosition(this._markers[rt],ot))return new MarkerCoordinate(this._markers[rt],rt+1,this._markers.length)}}};MarkerList=__decorate$13([__param$13(1,IMarkerService),__param$13(2,IConfigurationService)],MarkerList);const IMarkerNavigationService=createDecorator("IMarkerNavigationService");let MarkerNavigationService=class{constructor(nt,ot){this._markerService=nt,this._configService=ot,this._provider=new LinkedList}getMarkerList(nt){for(const ot of this._provider){const rt=ot.getMarkerList(nt);if(rt)return rt}return new MarkerList(nt,this._markerService,this._configService)}};MarkerNavigationService=__decorate$13([__param$13(0,IMarkerService),__param$13(1,IConfigurationService)],MarkerNavigationService);registerSingleton(IMarkerNavigationService,MarkerNavigationService,1);const gotoErrorWidget="",severityIcon="";var SeverityIcon;(function(ct){function nt(ot){switch(ot){case Severity$2.Ignore:return"severity-ignore "+ThemeIcon.asClassName(Codicon.info);case Severity$2.Info:return ThemeIcon.asClassName(Codicon.info);case Severity$2.Warning:return ThemeIcon.asClassName(Codicon.warning);case Severity$2.Error:return ThemeIcon.asClassName(Codicon.error);default:return""}}ct.className=nt})(SeverityIcon||(SeverityIcon={}));var __decorate$12=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$12=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};class MessageWidget{constructor(nt,ot,rt,ut,gt){this._openerService=ut,this._labelService=gt,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new DisposableStore,this._editor=ot;const pt=document.createElement("div");pt.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),pt.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),pt.appendChild(this._relatedBlock),this._disposables.add(addStandardDisposableListener(this._relatedBlock,"click",mt=>{mt.preventDefault();const vt=this._relatedDiagnostics.get(mt.target);vt&&rt(vt)})),this._scrollable=new ScrollableElement(pt,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),nt.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll(mt=>{pt.style.left=`-${mt.scrollLeft}px`,pt.style.top=`-${mt.scrollTop}px`})),this._disposables.add(this._scrollable)}dispose(){dispose(this._disposables)}update(nt){const{source:ot,message:rt,relatedInformation:ut,code:gt}=nt;let pt=((ot==null?void 0:ot.length)||0)+2;gt&&(typeof gt=="string"?pt+=gt.length:pt+=gt.value.length);const mt=splitLines(rt);this._lines=mt.length,this._longestLineLength=0;for(const Lt of mt)this._longestLineLength=Math.max(Lt.length+pt,this._longestLineLength);clearNode(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(nt)),this._editor.applyFontInfo(this._messageBlock);let vt=this._messageBlock;for(const Lt of mt)vt=document.createElement("div"),vt.innerText=Lt,Lt===""&&(vt.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(vt);if(ot||gt){const Lt=document.createElement("span");if(Lt.classList.add("details"),vt.appendChild(Lt),ot){const xt=document.createElement("span");xt.innerText=ot,xt.classList.add("source"),Lt.appendChild(xt)}if(gt)if(typeof gt=="string"){const xt=document.createElement("span");xt.innerText=`(${gt})`,xt.classList.add("code"),Lt.appendChild(xt)}else{this._codeLink=$$d("a.code-link"),this._codeLink.setAttribute("href",`${gt.target.toString()}`),this._codeLink.onclick=It=>{this._openerService.open(gt.target,{allowCommands:!0}),It.preventDefault(),It.stopPropagation()};const xt=append$1(this._codeLink,$$d("span"));xt.innerText=gt.value,Lt.appendChild(this._codeLink)}}if(clearNode(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),isNonEmptyArray(ut)){const Lt=this._relatedBlock.appendChild(document.createElement("div"));Lt.style.paddingTop=`${Math.floor(this._editor.getOption(64)*.66)}px`,this._lines+=1;for(const xt of ut){const It=document.createElement("div"),kt=document.createElement("a");kt.classList.add("filename"),kt.innerText=`${this._labelService.getUriBasenameLabel(xt.resource)}(${xt.startLineNumber}, ${xt.startColumn}): `,kt.title=this._labelService.getUriLabel(xt.resource),this._relatedDiagnostics.set(kt,xt);const At=document.createElement("span");At.innerText=xt.message,It.appendChild(kt),It.appendChild(At),this._lines+=1,Lt.appendChild(It)}}const St=this._editor.getOption(48),yt=Math.ceil(St.typicalFullwidthCharacterWidth*this._longestLineLength*.75),wt=St.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:yt,scrollHeight:wt})}layout(nt,ot){this._scrollable.getDomNode().style.height=`${nt}px`,this._scrollable.getDomNode().style.width=`${ot}px`,this._scrollable.setScrollDimensions({width:ot,height:nt})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(nt){let ot="";switch(nt.severity){case MarkerSeverity$1.Error:ot=localize("Error","Error");break;case MarkerSeverity$1.Warning:ot=localize("Warning","Warning");break;case MarkerSeverity$1.Info:ot=localize("Info","Info");break;case MarkerSeverity$1.Hint:ot=localize("Hint","Hint");break}let rt=localize("marker aria","{0} at {1}. ",ot,nt.startLineNumber+":"+nt.startColumn);const ut=this._editor.getModel();return ut&&nt.startLineNumber<=ut.getLineCount()&&nt.startLineNumber>=1&&(rt=`${ut.getLineContent(nt.startLineNumber)}, ${rt}`),rt}}let MarkerNavigationWidget=class br extends PeekViewWidget{constructor(nt,ot,rt,ut,gt,pt,mt){super(nt,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},gt),this._themeService=ot,this._openerService=rt,this._menuService=ut,this._contextKeyService=pt,this._labelService=mt,this._callOnDispose=new DisposableStore,this._onDidSelectRelatedInformation=new Emitter$2,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=MarkerSeverity$1.Warning,this._backgroundColor=Color.white,this._applyTheme(ot.getColorTheme()),this._callOnDispose.add(ot.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(nt){this._backgroundColor=nt.getColor(editorMarkerNavigationBackground);let ot=editorMarkerNavigationError,rt=editorMarkerNavigationErrorHeader;this._severity===MarkerSeverity$1.Warning?(ot=editorMarkerNavigationWarning,rt=editorMarkerNavigationWarningHeader):this._severity===MarkerSeverity$1.Info&&(ot=editorMarkerNavigationInfo,rt=editorMarkerNavigationInfoHeader);const ut=nt.getColor(ot),gt=nt.getColor(rt);this.style({arrowColor:ut,frameColor:ut,headerBackgroundColor:gt,primaryHeadingColor:nt.getColor(peekViewTitleForeground),secondaryHeadingColor:nt.getColor(peekViewTitleInfoForeground)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(nt){super._fillHead(nt),this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(ut=>this.editor.focus()));const ot=[],rt=this._menuService.createMenu(br.TitleMenu,this._contextKeyService);createAndFillInActionBarActions(rt,void 0,ot),this._actionbarWidget.push(ot,{label:!1,icon:!0,index:0}),rt.dispose()}_fillTitleIcon(nt){this._icon=append$1(nt,$$d(""))}_fillBody(nt){this._parentContainer=nt,nt.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),nt.appendChild(this._container),this._message=new MessageWidget(this._container,this.editor,ot=>this._onDidSelectRelatedInformation.fire(ot),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(nt,ot,rt){this._container.classList.remove("stale"),this._message.update(nt),this._severity=nt.severity,this._applyTheme(this._themeService.getColorTheme());const ut=Range$2.lift(nt),gt=this.editor.getPosition(),pt=gt&&ut.containsPosition(gt)?gt:ut.getStartPosition();super.show(pt,this.computeRequiredHeight());const mt=this.editor.getModel();if(mt){const vt=rt>1?localize("problems","{0} of {1} problems",ot,rt):localize("change","{0} of {1} problem",ot,rt);this.setTitle(basename(mt.uri),vt)}this._icon.className=`codicon ${SeverityIcon.className(MarkerSeverity$1.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(pt,0),this.editor.focus()}updateMarker(nt){this._container.classList.remove("stale"),this._message.update(nt)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(nt,ot){super._doLayoutBody(nt,ot),this._heightInPixel=nt,this._message.layout(nt,ot),this._container.style.height=`${nt}px`}_onWidth(nt){this._message.layout(this._heightInPixel,nt)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};MarkerNavigationWidget.TitleMenu=new MenuId("gotoErrorTitleMenu");MarkerNavigationWidget=__decorate$12([__param$12(1,IThemeService),__param$12(2,IOpenerService),__param$12(3,IMenuService),__param$12(4,IInstantiationService),__param$12(5,IContextKeyService),__param$12(6,ILabelService)],MarkerNavigationWidget);const errorDefault=oneOf(editorErrorForeground,editorErrorBorder),warningDefault=oneOf(editorWarningForeground,editorWarningBorder),infoDefault=oneOf(editorInfoForeground,editorInfoBorder),editorMarkerNavigationError=registerColor("editorMarkerNavigationError.background",{dark:errorDefault,light:errorDefault,hcDark:contrastBorder,hcLight:contrastBorder},localize("editorMarkerNavigationError","Editor marker navigation widget error color.")),editorMarkerNavigationErrorHeader=registerColor("editorMarkerNavigationError.headerBackground",{dark:transparent(editorMarkerNavigationError,.1),light:transparent(editorMarkerNavigationError,.1),hcDark:null,hcLight:null},localize("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),editorMarkerNavigationWarning=registerColor("editorMarkerNavigationWarning.background",{dark:warningDefault,light:warningDefault,hcDark:contrastBorder,hcLight:contrastBorder},localize("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),editorMarkerNavigationWarningHeader=registerColor("editorMarkerNavigationWarning.headerBackground",{dark:transparent(editorMarkerNavigationWarning,.1),light:transparent(editorMarkerNavigationWarning,.1),hcDark:"#0C141F",hcLight:transparent(editorMarkerNavigationWarning,.2)},localize("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),editorMarkerNavigationInfo=registerColor("editorMarkerNavigationInfo.background",{dark:infoDefault,light:infoDefault,hcDark:contrastBorder,hcLight:contrastBorder},localize("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),editorMarkerNavigationInfoHeader=registerColor("editorMarkerNavigationInfo.headerBackground",{dark:transparent(editorMarkerNavigationInfo,.1),light:transparent(editorMarkerNavigationInfo,.1),hcDark:null,hcLight:null},localize("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),editorMarkerNavigationBackground=registerColor("editorMarkerNavigation.background",{dark:editorBackground,light:editorBackground,hcDark:editorBackground,hcLight:editorBackground},localize("editorMarkerNavigationBackground","Editor marker navigation widget background."));var __decorate$11=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$11=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$I=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let MarkerController=class No{static get(nt){return nt.getContribution(No.ID)}constructor(nt,ot,rt,ut,gt){this._markerNavigationService=ot,this._contextKeyService=rt,this._editorService=ut,this._instantiationService=gt,this._sessionDispoables=new DisposableStore,this._editor=nt,this._widgetVisible=CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(nt){if(this._model&&this._model.matches(nt))return this._model;let ot=!1;return this._model&&(ot=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(nt),ot&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(MarkerNavigationWidget,this._editor),this._widget.onDidClose(()=>this.close(),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(rt=>{var ut,gt,pt;(!(!((ut=this._model)===null||ut===void 0)&&ut.selected)||!Range$2.containsPosition((gt=this._model)===null||gt===void 0?void 0:gt.selected.marker,rt.position))&&((pt=this._model)===null||pt===void 0||pt.resetIndex())})),this._sessionDispoables.add(this._model.onDidChange(()=>{if(!this._widget||!this._widget.position||!this._model)return;const rt=this._model.find(this._editor.getModel().uri,this._widget.position);rt?this._widget.updateMarker(rt.marker):this._widget.showStale()})),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(rt=>{this._editorService.openCodeEditor({resource:rt.resource,options:{pinned:!0,revealIfOpened:!0,selection:Range$2.lift(rt).collapseToStart()}},this._editor),this.close(!1)})),this._sessionDispoables.add(this._editor.onDidChangeModel(()=>this._cleanUp())),this._model}close(nt=!0){this._cleanUp(),nt&&this._editor.focus()}showAtMarker(nt){if(this._editor.hasModel()){const ot=this._getOrCreateModel(this._editor.getModel().uri);ot.resetIndex(),ot.move(!0,this._editor.getModel(),new Position$1(nt.startLineNumber,nt.startColumn)),ot.selected&&this._widget.showAtMarker(ot.selected.marker,ot.selected.index,ot.selected.total)}}nagivate(nt,ot){var rt,ut;return __awaiter$I(this,void 0,void 0,function*(){if(this._editor.hasModel()){const gt=this._getOrCreateModel(ot?void 0:this._editor.getModel().uri);if(gt.move(nt,this._editor.getModel(),this._editor.getPosition()),!gt.selected)return;if(gt.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const pt=yield this._editorService.openCodeEditor({resource:gt.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:gt.selected.marker}},this._editor);pt&&((rt=No.get(pt))===null||rt===void 0||rt.close(),(ut=No.get(pt))===null||ut===void 0||ut.nagivate(nt,ot))}else this._widget.showAtMarker(gt.selected.marker,gt.selected.index,gt.selected.total)}})}};MarkerController.ID="editor.contrib.markerController";MarkerController=__decorate$11([__param$11(1,IMarkerNavigationService),__param$11(2,IContextKeyService),__param$11(3,ICodeEditorService),__param$11(4,IInstantiationService)],MarkerController);class MarkerNavigationAction extends EditorAction{constructor(nt,ot,rt){super(rt),this._next=nt,this._multiFile=ot}run(nt,ot){var rt;return __awaiter$I(this,void 0,void 0,function*(){ot.hasModel()&&((rt=MarkerController.get(ot))===null||rt===void 0||rt.nagivate(this._next,this._multiFile))})}}class NextMarkerAction extends MarkerNavigationAction{constructor(){super(!0,!1,{id:NextMarkerAction.ID,label:NextMarkerAction.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:578,weight:100},menuOpts:{menuId:MarkerNavigationWidget.TitleMenu,title:NextMarkerAction.LABEL,icon:registerIcon("marker-navigation-next",Codicon.arrowDown,localize("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}}NextMarkerAction.ID="editor.action.marker.next";NextMarkerAction.LABEL=localize("markerAction.next.label","Go to Next Problem (Error, Warning, Info)");class PrevMarkerAction extends MarkerNavigationAction{constructor(){super(!1,!1,{id:PrevMarkerAction.ID,label:PrevMarkerAction.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:1602,weight:100},menuOpts:{menuId:MarkerNavigationWidget.TitleMenu,title:PrevMarkerAction.LABEL,icon:registerIcon("marker-navigation-previous",Codicon.arrowUp,localize("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}}PrevMarkerAction.ID="editor.action.marker.prev";PrevMarkerAction.LABEL=localize("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)");class NextMarkerInFilesAction extends MarkerNavigationAction{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:localize("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:66,weight:100},menuOpts:{menuId:MenuId.MenubarGoMenu,title:localize({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}}class PrevMarkerInFilesAction extends MarkerNavigationAction{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:localize("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:1090,weight:100},menuOpts:{menuId:MenuId.MenubarGoMenu,title:localize({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}}registerEditorContribution(MarkerController.ID,MarkerController,4);registerEditorAction(NextMarkerAction);registerEditorAction(PrevMarkerAction);registerEditorAction(NextMarkerInFilesAction);registerEditorAction(PrevMarkerInFilesAction);const CONTEXT_MARKERS_NAVIGATION_VISIBLE=new RawContextKey("markersNavigationVisible",!1),MarkerCommand=EditorCommand.bindToContribution(MarkerController.get);registerEditorCommand(new MarkerCommand({id:"closeMarkersNavigation",precondition:CONTEXT_MARKERS_NAVIGATION_VISIBLE,handler:ct=>ct.close(),kbOpts:{weight:100+50,kbExpr:EditorContextKeys.focus,primary:9,secondary:[1033]}}));var __decorate$10=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$10=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const $$1=$$d;class MarkerHover{constructor(nt,ot,rt){this.owner=nt,this.range=ot,this.marker=rt}isValidForHoverAnchor(nt){return nt.type===1&&this.range.startColumn<=nt.range.startColumn&&this.range.endColumn>=nt.range.endColumn}}const markerCodeActionTrigger={type:1,filter:{include:CodeActionKind.QuickFix},triggerAction:CodeActionTriggerSource.QuickFixHover};let MarkerHoverParticipant=class{constructor(nt,ot,rt,ut){this._editor=nt,this._markerDecorationsService=ot,this._openerService=rt,this._languageFeaturesService=ut,this.hoverOrdinal=1,this.recentMarkerCodeActionsInfo=void 0}computeSync(nt,ot){if(!this._editor.hasModel()||nt.type!==1&&!nt.supportsMarkerHover)return[];const rt=this._editor.getModel(),ut=nt.range.startLineNumber,gt=rt.getLineMaxColumn(ut),pt=[];for(const mt of ot){const vt=mt.range.startLineNumber===ut?mt.range.startColumn:1,St=mt.range.endLineNumber===ut?mt.range.endColumn:gt,yt=this._markerDecorationsService.getMarker(rt.uri,mt);if(!yt)continue;const wt=new Range$2(nt.range.startLineNumber,vt,nt.range.startLineNumber,St);pt.push(new MarkerHover(this,wt,yt))}return pt}renderHoverParts(nt,ot){if(!ot.length)return Disposable.None;const rt=new DisposableStore;ot.forEach(gt=>nt.fragment.appendChild(this.renderMarkerHover(gt,rt)));const ut=ot.length===1?ot[0]:ot.sort((gt,pt)=>MarkerSeverity$1.compare(gt.marker.severity,pt.marker.severity))[0];return this.renderMarkerStatusbar(nt,ut,rt),rt}renderMarkerHover(nt,ot){const rt=$$1("div.hover-row"),ut=append$1(rt,$$1("div.marker.hover-contents")),{source:gt,message:pt,code:mt,relatedInformation:vt}=nt.marker;this._editor.applyFontInfo(ut);const St=append$1(ut,$$1("span"));if(St.style.whiteSpace="pre-wrap",St.innerText=pt,gt||mt)if(mt&&typeof mt!="string"){const yt=$$1("span");if(gt){const It=append$1(yt,$$1("span"));It.innerText=gt}const wt=append$1(yt,$$1("a.code-link"));wt.setAttribute("href",mt.target.toString()),ot.add(addDisposableListener(wt,"click",It=>{this._openerService.open(mt.target,{allowCommands:!0}),It.preventDefault(),It.stopPropagation()}));const Lt=append$1(wt,$$1("span"));Lt.innerText=mt.value;const xt=append$1(ut,yt);xt.style.opacity="0.6",xt.style.paddingLeft="6px"}else{const yt=append$1(ut,$$1("span"));yt.style.opacity="0.6",yt.style.paddingLeft="6px",yt.innerText=gt&&mt?`${gt}(${mt})`:gt||`(${mt})`}if(isNonEmptyArray(vt))for(const{message:yt,resource:wt,startLineNumber:Lt,startColumn:xt}of vt){const It=append$1(ut,$$1("div"));It.style.marginTop="8px";const kt=append$1(It,$$1("a"));kt.innerText=`${basename(wt)}(${Lt}, ${xt}): `,kt.style.cursor="pointer",ot.add(addDisposableListener(kt,"click",Tt=>{Tt.stopPropagation(),Tt.preventDefault(),this._openerService&&this._openerService.open(wt,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber:Lt,startColumn:xt}}}).catch(onUnexpectedError)}));const At=append$1(It,$$1("span"));At.innerText=yt,this._editor.applyFontInfo(At)}return rt}renderMarkerStatusbar(nt,ot,rt){if((ot.marker.severity===MarkerSeverity$1.Error||ot.marker.severity===MarkerSeverity$1.Warning||ot.marker.severity===MarkerSeverity$1.Info)&&nt.statusBar.addAction({label:localize("view problem","View Problem"),commandId:NextMarkerAction.ID,run:()=>{var ut;nt.hide(),(ut=MarkerController.get(this._editor))===null||ut===void 0||ut.showAtMarker(ot.marker),this._editor.focus()}}),!this._editor.getOption(87)){const ut=nt.statusBar.append($$1("div"));this.recentMarkerCodeActionsInfo&&(IMarkerData.makeKey(this.recentMarkerCodeActionsInfo.marker)===IMarkerData.makeKey(ot.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(ut.textContent=localize("noQuickFixes","No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const gt=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?Disposable.None:rt.add(disposableTimeout(()=>ut.textContent=localize("checkingForQuickFixes","Checking for quick fixes..."),200));ut.textContent||(ut.textContent=String.fromCharCode(160));const pt=this.getCodeActions(ot.marker);rt.add(toDisposable(()=>pt.cancel())),pt.then(mt=>{if(gt.dispose(),this.recentMarkerCodeActionsInfo={marker:ot.marker,hasCodeActions:mt.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions){mt.dispose(),ut.textContent=localize("noQuickFixes","No quick fixes available");return}ut.style.display="none";let vt=!1;rt.add(toDisposable(()=>{vt||mt.dispose()})),nt.statusBar.addAction({label:localize("quick fixes","Quick Fix..."),commandId:quickFixCommandId,run:St=>{vt=!0;const yt=CodeActionController.get(this._editor),wt=getDomNodePagePosition(St);nt.hide(),yt==null||yt.showCodeActions(markerCodeActionTrigger,mt,{x:wt.left+6,y:wt.top+wt.height+6,width:wt.width,height:wt.height})}})},onUnexpectedError)}}getCodeActions(nt){return createCancelablePromise(ot=>getCodeActions(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new Range$2(nt.startLineNumber,nt.startColumn,nt.endLineNumber,nt.endColumn),markerCodeActionTrigger,Progress.None,ot))}};MarkerHoverParticipant=__decorate$10([__param$10(1,IMarkerDecorationsService),__param$10(2,IOpenerService),__param$10(3,ILanguageFeaturesService)],MarkerHoverParticipant);const hover="";let globalObservableLogger;function getLogger(){return globalObservableLogger}let _derived;function _setDerived(ct){_derived=ct}class ConvenientObservable{get TChange(){return null}reportChanges(){this.get()}read(nt){return nt?nt.readObservable(this):this.get()}map(nt){return _derived(()=>{const ot=getFunctionName(nt);return ot!==void 0?ot:`${this.debugName} (mapped)`},ot=>nt(this.read(ot),ot))}}class BaseObservable extends ConvenientObservable{constructor(){super(...arguments),this.observers=new Set}addObserver(nt){const ot=this.observers.size;this.observers.add(nt),ot===0&&this.onFirstObserverAdded()}removeObserver(nt){this.observers.delete(nt)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}}function transaction(ct,nt){var ot,rt;const ut=new TransactionImpl(ct,nt);try{(ot=getLogger())===null||ot===void 0||ot.handleBeginTransaction(ut),ct(ut)}finally{ut.finish(),(rt=getLogger())===null||rt===void 0||rt.handleEndTransaction()}}class TransactionImpl{constructor(nt,ot){this.fn=nt,this._getDebugName=ot,this.updatingObservers=[]}getDebugName(){return this._getDebugName?this._getDebugName():getFunctionName(this.fn)}updateObserver(nt,ot){this.updatingObservers.push({observer:nt,observable:ot}),nt.beginUpdate(ot)}finish(){const nt=this.updatingObservers;this.updatingObservers=null;for(const{observer:ot,observable:rt}of nt)ot.endUpdate(rt)}}function getFunctionName(ct){const nt=ct.toString(),rt=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(nt),ut=rt?rt[1]:void 0;return ut==null?void 0:ut.trim()}function observableValue(ct,nt){return new ObservableValue(ct,nt)}class ObservableValue extends BaseObservable{constructor(nt,ot){super(),this.debugName=nt,this._value=ot}get(){return this._value}set(nt,ot,rt){var ut;if(this._value===nt)return;let gt;ot||(ot=gt=new TransactionImpl(()=>{},()=>`Setting ${this.debugName}`));try{const pt=this._value;this._setValue(nt),(ut=getLogger())===null||ut===void 0||ut.handleObservableChanged(this,{oldValue:pt,newValue:nt,change:rt,didChange:!0});for(const mt of this.observers)ot.updateObserver(mt,this),mt.handleChange(this,rt)}finally{gt&&gt.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(nt){this._value=nt}}function disposableObservableValue(ct,nt){return new DisposableObservableValue(ct,nt)}class DisposableObservableValue extends ObservableValue{_setValue(nt){this._value!==nt&&(this._value&&this._value.dispose(),this._value=nt)}dispose(){var nt;(nt=this._value)===null||nt===void 0||nt.dispose()}}function derived(ct,nt){return new Derived(ct,nt)}_setDerived(derived);class Derived extends BaseObservable{get debugName(){return typeof this._debugName=="function"?this._debugName():this._debugName}constructor(nt,ot){var rt;super(),this._debugName=nt,this.computeFn=ot,this.state=0,this.value=void 0,this.updateCount=0,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,(rt=getLogger())===null||rt===void 0||rt.handleDerivedCreated(this)}onLastObserverRemoved(){this.state=0,this.value=void 0;for(const nt of this.dependencies)nt.removeObserver(this);this.dependencies.clear()}get(){if(this.observers.size===0){const nt=this.computeFn(this);return this.onLastObserverRemoved(),nt}else{do{if(this.state===1){this.state=3;for(const nt of this.dependencies)if(nt.reportChanges(),this.state===2)break}this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){var nt;if(this.state===3)return;const ot=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=ot;const rt=this.state!==0,ut=this.value;this.state=3;try{this.value=this.computeFn(this)}finally{for(const pt of this.dependenciesToBeRemoved)pt.removeObserver(this);this.dependenciesToBeRemoved.clear()}const gt=rt&&ut!==this.value;if((nt=getLogger())===null||nt===void 0||nt.handleDerivedRecomputed(this,{oldValue:ut,newValue:this.value,change:void 0,didChange:gt}),gt)for(const pt of this.observers)pt.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(){this.updateCount++;const nt=this.updateCount===1;if(this.state===3&&(this.state=1,!nt))for(const ot of this.observers)ot.handlePossibleChange(this);if(nt)for(const ot of this.observers)ot.beginUpdate(this)}endUpdate(){if(this.updateCount--,this.updateCount===0){const nt=[...this.observers];for(const ot of nt)ot.endUpdate(this)}if(this.updateCount<0)throw new BugIndicatingError}handlePossibleChange(nt){if(this.state===3&&this.dependencies.has(nt)){this.state=1;for(const ot of this.observers)ot.handlePossibleChange(this)}}handleChange(nt,ot){const rt=this.state===3;if((this.state===1||rt)&&this.dependencies.has(nt)&&(this.state=2,rt))for(const ut of this.observers)ut.handlePossibleChange(this)}readObservable(nt){nt.addObserver(this);const ot=nt.get();return this.dependencies.add(nt),this.dependenciesToBeRemoved.delete(nt),ot}}function autorun(ct,nt){return new AutorunObserver(ct,nt,void 0)}function autorunHandleChanges(ct,nt,ot){return new AutorunObserver(ct,ot,nt.handleChange)}class AutorunObserver{constructor(nt,ot,rt){var ut;this.debugName=nt,this.runFn=ot,this._handleChange=rt,this.state=2,this.updateCount=0,this.disposed=!1,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,(ut=getLogger())===null||ut===void 0||ut.handleAutorunCreated(this),this._runIfNeeded()}dispose(){this.disposed=!0;for(const nt of this.dependencies)nt.removeObserver(this);this.dependencies.clear()}_runIfNeeded(){var nt;if(this.state===3)return;const ot=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=ot,this.state=3,(nt=getLogger())===null||nt===void 0||nt.handleAutorunTriggered(this);try{this.runFn(this)}finally{for(const rt of this.dependenciesToBeRemoved)rt.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(const nt of this.dependencies)if(nt.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--}handlePossibleChange(nt){this.state===3&&this.dependencies.has(nt)&&(this.state=1)}handleChange(nt,ot){this.dependencies.has(nt)&&(!this._handleChange||this._handleChange({changedObservable:nt,change:ot,didChange:ut=>ut===nt}))&&(this.state=2)}readObservable(nt){if(this.disposed)return nt.get();nt.addObserver(this);const ot=nt.get();return this.dependencies.add(nt),this.dependenciesToBeRemoved.delete(nt),ot}}(function(ct){ct.Observer=AutorunObserver})(autorun||(autorun={}));function constObservable(ct){return new ConstObservable(ct)}class ConstObservable extends ConvenientObservable{constructor(nt){super(),this.value=nt}get debugName(){return this.toString()}get(){return this.value}addObserver(nt){}removeObserver(nt){}toString(){return`Const: ${this.value}`}}function observableFromEvent(ct,nt){return new FromEventObservable(ct,nt)}class FromEventObservable extends BaseObservable{constructor(nt,ot){super(),this.event=nt,this.getValue=ot,this.hasValue=!1,this.handleEvent=rt=>{var ut;const gt=this.getValue(rt),pt=!this.hasValue||this.value!==gt;(ut=getLogger())===null||ut===void 0||ut.handleFromEventObservableTriggered(this,{oldValue:this.value,newValue:gt,change:void 0,didChange:pt}),pt&&(this.value=gt,this.hasValue&&transaction(mt=>{for(const vt of this.observers)mt.updateObserver(vt,this),vt.handleChange(this,void 0)},()=>{const mt=this.getDebugName();return"Event fired"+(mt?`: ${mt}`:"")}),this.hasValue=!0)}}getDebugName(){return getFunctionName(this.getValue)}get debugName(){const nt=this.getDebugName();return"From Event"+(nt?`: ${nt}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this.getValue(void 0)}}(function(ct){ct.Observer=FromEventObservable})(observableFromEvent||(observableFromEvent={}));function observableSignalFromEvent(ct,nt){return new FromEventObservableSignal(ct,nt)}class FromEventObservableSignal extends BaseObservable{constructor(nt,ot){super(),this.debugName=nt,this.event=ot,this.handleEvent=()=>{transaction(rt=>{for(const ut of this.observers)rt.updateObserver(ut,this),ut.handleChange(this,void 0)},()=>this.debugName)}}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}function observableSignal(ct){return new ObservableSignal(ct)}class ObservableSignal extends BaseObservable{constructor(nt){super(),this.debugName=nt}trigger(nt,ot){if(!nt){transaction(rt=>{this.trigger(rt,ot)},()=>`Trigger signal ${this.debugName}`);return}for(const rt of this.observers)nt.updateObserver(rt,this),rt.handleChange(this,ot)}get(){}}const inlineCompletionsHintsWidget="",inlineSuggestCommitId="editor.action.inlineSuggest.commit",showPreviousInlineSuggestionActionId="editor.action.inlineSuggest.showPrevious",showNextInlineSuggestionActionId="editor.action.inlineSuggest.showNext",toolbar="";var __awaiter$H=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class ToolBar extends Disposable{constructor(nt,ot,rt={orientation:0}){super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new EventMultiplexer),this.onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event,this.disposables=new DisposableStore,this.options=rt,this.lookupKeybindings=typeof this.options.getKeyBinding=="function",this.toggleMenuAction=this._register(new ToggleMenuAction(()=>{var ut;return(ut=this.toggleMenuActionViewItem)===null||ut===void 0?void 0:ut.show()},rt.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",nt.appendChild(this.element),this.actionBar=this._register(new ActionBar(this.element,{orientation:rt.orientation,ariaLabel:rt.ariaLabel,actionRunner:rt.actionRunner,allowContextMenu:rt.allowContextMenu,actionViewItemProvider:(ut,gt)=>{var pt;if(ut.id===ToggleMenuAction.ID)return this.toggleMenuActionViewItem=new DropdownMenuActionViewItem(ut,ut.menuActions,ot,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:ThemeIcon.asClassNameArray((pt=rt.moreIcon)!==null&&pt!==void 0?pt:Codicon.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(rt.actionViewItemProvider){const mt=rt.actionViewItemProvider(ut,gt);if(mt)return mt}if(ut instanceof SubmenuAction){const mt=new DropdownMenuActionViewItem(ut,ut.actions,ot,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:ut.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement});return mt.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(mt),this.disposables.add(this._onDidChangeDropdownVisibility.add(mt.onDidChangeVisibility)),mt}}}))}set actionRunner(nt){this.actionBar.actionRunner=nt}get actionRunner(){return this.actionBar.actionRunner}getElement(){return this.element}getItemAction(nt){return this.actionBar.getAction(nt)}setActions(nt,ot){this.clear();const rt=nt?nt.slice(0):[];this.hasSecondaryActions=!!(ot&&ot.length>0),this.hasSecondaryActions&&ot&&(this.toggleMenuAction.menuActions=ot.slice(0),rt.push(this.toggleMenuAction)),rt.forEach(ut=>{this.actionBar.push(ut,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(ut)})})}getKeybindingLabel(nt){var ot,rt;const ut=this.lookupKeybindings?(rt=(ot=this.options).getKeyBinding)===null||rt===void 0?void 0:rt.call(ot,nt):void 0;return withNullAsUndefined(ut==null?void 0:ut.getLabel())}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),super.dispose()}}class ToggleMenuAction extends Action{constructor(nt,ot){ot=ot||localize("moreActions","More Actions..."),super(ToggleMenuAction.ID,ot,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=nt}run(){return __awaiter$H(this,void 0,void 0,function*(){this.toggleDropdownMenu()})}get menuActions(){return this._menuActions}set menuActions(nt){this._menuActions=nt}}ToggleMenuAction.ID="toolbar.toggle.more";var __decorate$$=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$$=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let WorkbenchToolBar=class extends ToolBar{constructor(nt,ot,rt,ut,gt,pt,mt){super(nt,gt,Object.assign(Object.assign({getKeyBinding:vt=>{var St;return(St=pt.lookupKeybinding(vt.id))!==null&&St!==void 0?St:void 0}},ot),{allowContextMenu:!0})),this._options=ot,this._menuService=rt,this._contextKeyService=ut,this._contextMenuService=gt,this._sessionDisposables=this._store.add(new DisposableStore),ot!=null&&ot.telemetrySource&&this._store.add(this.actionBar.onDidRun(vt=>mt.publicLog2("workbenchActionExecuted",{id:vt.action.id,from:ot.telemetrySource})))}setActions(nt,ot=[],rt){var ut,gt,pt;this._sessionDisposables.clear();const mt=nt.slice(),vt=ot.slice(),St=[];let yt=0;const wt=[];let Lt=!1;if(((ut=this._options)===null||ut===void 0?void 0:ut.hiddenItemStrategy)!==-1)for(let xt=0;xt<mt.length;xt++){const It=mt[xt];!(It instanceof MenuItemAction)&&!(It instanceof SubmenuItemAction)||It.hideActions&&(St.push(It.hideActions.toggle),It.hideActions.toggle.checked&&yt++,It.hideActions.isHidden&&(Lt=!0,mt[xt]=void 0,((gt=this._options)===null||gt===void 0?void 0:gt.hiddenItemStrategy)!==0&&(wt[xt]=It)))}if(((pt=this._options)===null||pt===void 0?void 0:pt.maxNumberOfItems)!==void 0){let xt=0;for(let It=0;It<mt.length;It++){const kt=mt[It];kt&&++xt>=this._options.maxNumberOfItems&&(mt[It]=void 0,wt[It]=kt)}}coalesceInPlace(mt),coalesceInPlace(wt),super.setActions(mt,Separator.join(wt,vt)),St.length>0&&this._sessionDisposables.add(addDisposableListener(this.getElement(),"contextmenu",xt=>{var It,kt,At,Tt;const Rt=this.getItemAction(xt.target);if(!Rt)return;xt.preventDefault(),xt.stopPropagation();let Nt=!1;if(yt===1&&((It=this._options)===null||It===void 0?void 0:It.hiddenItemStrategy)===0){Nt=!0;for(let Kt=0;Kt<St.length;Kt++)if(St[Kt].checked){St[Kt]=toAction({id:Rt.id,label:Rt.label,checked:!0,enabled:!1,run(){}});break}}let Pt;if(!Nt&&(Rt instanceof MenuItemAction||Rt instanceof SubmenuItemAction)){if(!Rt.hideActions)return;Pt=Rt.hideActions.hide}else Pt=toAction({id:"label",label:localize("hide","Hide"),enabled:!1,run(){}});const Ft=Separator.join([Pt],St);!((kt=this._options)===null||kt===void 0)&&kt.resetMenu&&!rt&&(rt=[this._options.resetMenu]),Lt&&rt&&(Ft.push(new Separator),Ft.push(toAction({id:"resetThisMenu",label:localize("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(rt)}))),this._contextMenuService.showContextMenu({getAnchor:()=>xt,getActions:()=>Ft,menuId:(At=this._options)===null||At===void 0?void 0:At.contextMenu,menuActionOptions:Object.assign({renderShortTitle:!0},(Tt=this._options)===null||Tt===void 0?void 0:Tt.menuOptions),contextKeyService:this._contextKeyService})}))}};WorkbenchToolBar=__decorate$$([__param$$(2,IMenuService),__param$$(3,IContextKeyService),__param$$(4,IContextMenuService),__param$$(5,IKeybindingService),__param$$(6,ITelemetryService)],WorkbenchToolBar);var __decorate$_=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$_=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const inlineSuggestionHintsNextIcon=registerIcon("inline-suggestion-hints-next",Codicon.chevronRight,localize("parameterHintsNextIcon","Icon for show next parameter hint.")),inlineSuggestionHintsPreviousIcon=registerIcon("inline-suggestion-hints-previous",Codicon.chevronLeft,localize("parameterHintsPreviousIcon","Icon for show previous parameter hint."));let InlineSuggestionHintsContentWidget=class Zo extends Disposable{static get dropDownVisible(){return this._dropDownVisible}createCommandAction(nt,ot,rt){const ut=new Action(nt,ot,rt,!0,()=>this._commandService.executeCommand(nt)),gt=this.keybindingService.lookupKeybinding(nt,this._contextKeyService);let pt=ot;return gt&&(pt=localize({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",ot,gt.getLabel())),ut.tooltip=pt,ut}constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt){super(),this.editor=nt,this.withBorder=ot,this._position=rt,this._currentSuggestionIdx=ut,this._suggestionCount=gt,this._extraCommands=pt,this._commandService=mt,this.keybindingService=St,this._contextKeyService=yt,this._menuService=wt,this.id=`InlineSuggestionHintsContentWidget${Zo.id++}`,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=h("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[h("div",{style:{display:"flex"}},[h("div@actionBar",{className:"custom-actions"}),h("div@toolBar")])]),this.previousAction=this.createCommandAction(showPreviousInlineSuggestionActionId,localize("previous","Previous"),ThemeIcon.asClassName(inlineSuggestionHintsPreviousIcon)),this.availableSuggestionCountAction=new Action("inlineSuggestionHints.availableSuggestionCount","",void 0,!1),this.nextAction=this.createCommandAction(showNextInlineSuggestionActionId,localize("next","Next"),ThemeIcon.asClassName(inlineSuggestionHintsNextIcon)),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(MenuId.InlineCompletionsActions,this._contextKeyService)),this.clearAvailableSuggestionCountLabelDebounced=this._register(new RunOnceScheduler(()=>{this.availableSuggestionCountAction.label=""},100)),this.disableButtonsDebounced=this._register(new RunOnceScheduler(()=>{this.previousAction.enabled=this.nextAction.enabled=!1},100)),this.lastCommands=[];const Lt=this._register(new ActionBar(this.nodes.actionBar));Lt.push(this.previousAction,{icon:!0,label:!1}),Lt.push(this.availableSuggestionCountAction),Lt.push(this.nextAction,{icon:!0,label:!1}),this.toolBar=this._register(vt.createInstance(CustomizedMenuWorkbenchToolBar,this.nodes.toolBar,MenuId.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:xt=>xt.startsWith("primary")},actionViewItemProvider:(xt,It)=>xt instanceof MenuItemAction?vt.createInstance(StatusBarViewItem$1,xt,void 0):void 0,telemetrySource:"InlineSuggestionToolbar"})),this._register(this.toolBar.onDidChangeDropdownVisibility(xt=>{Zo._dropDownVisible=xt})),this._register(autorun("update position",xt=>{this._position.read(xt),this.editor.layoutContentWidget(this)})),this._register(autorun("counts",xt=>{const It=this._suggestionCount.read(xt),kt=this._currentSuggestionIdx.read(xt);It!==void 0?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label=`${kt+1}/${It}`):this.clearAvailableSuggestionCountLabelDebounced.schedule(),It!==void 0&&It>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()})),this._register(autorun("extra commands",xt=>{const It=this._extraCommands.read(xt);if(equals$2(this.lastCommands,It))return;this.lastCommands=It;const kt=It.map(At=>({class:void 0,id:At.id,enabled:!0,tooltip:At.tooltip||"",label:At.title,run:Tt=>this._commandService.executeCommand(At.id)}));for(const[At,Tt]of this.inlineCompletionsActionsMenus.getActions())for(const Rt of Tt)Rt instanceof MenuItemAction&&kt.push(Rt);kt.length>0&&kt.unshift(new Separator),this.toolBar.setAdditionalSecondaryActions(kt)}))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};InlineSuggestionHintsContentWidget._dropDownVisible=!1;InlineSuggestionHintsContentWidget.id=0;InlineSuggestionHintsContentWidget=__decorate$_([__param$_(6,ICommandService),__param$_(7,IInstantiationService),__param$_(8,IKeybindingService),__param$_(9,IContextKeyService),__param$_(10,IMenuService)],InlineSuggestionHintsContentWidget);let StatusBarViewItem$1=class extends MenuEntryActionViewItem{updateLabel(){const nt=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!nt)return super.updateLabel();if(this.label){const ot=h("div.keybinding").root;new KeybindingLabel(ot,OS,Object.assign({disableTitle:!0},unthemedKeybindingLabelOptions)).set(nt),this.label.textContent=this._action.label,this.label.appendChild(ot),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}},CustomizedMenuWorkbenchToolBar=class extends WorkbenchToolBar{constructor(nt,ot,rt,ut,gt,pt,mt,vt){super(nt,Object.assign({resetMenu:ot},rt),ut,gt,pt,mt,vt),this.menuId=ot,this.options2=rt,this.menuService=ut,this.contextKeyService=gt,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this.updateToolbar()}updateToolbar(){var nt,ot,rt,ut,gt,pt,mt;const vt=[],St=[];createAndFillInActionBarActions(this.menu,(nt=this.options2)===null||nt===void 0?void 0:nt.menuOptions,{primary:vt,secondary:St},(rt=(ot=this.options2)===null||ot===void 0?void 0:ot.toolbarOptions)===null||rt===void 0?void 0:rt.primaryGroup,(gt=(ut=this.options2)===null||ut===void 0?void 0:ut.toolbarOptions)===null||gt===void 0?void 0:gt.shouldInlineSubmenu,(mt=(pt=this.options2)===null||pt===void 0?void 0:pt.toolbarOptions)===null||mt===void 0?void 0:mt.useSeparatorsInPrimaryActions),St.push(...this.additionalActions),this.setActions(vt,St)}setAdditionalSecondaryActions(nt){equals$2(this.additionalActions,nt,(ot,rt)=>ot===rt)||(this.additionalActions=nt,this.updateToolbar())}};CustomizedMenuWorkbenchToolBar=__decorate$_([__param$_(3,IMenuService),__param$_(4,IContextKeyService),__param$_(5,IContextMenuService),__param$_(6,IKeybindingService),__param$_(7,ITelemetryService)],CustomizedMenuWorkbenchToolBar);var __decorate$Z=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$Z=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let ModesHoverController=class Sr{static get(nt){return nt.getContribution(Sr.ID)}constructor(nt,ot,rt,ut,gt){this._editor=nt,this._instantiationService=ot,this._openerService=rt,this._languageService=ut,this._keybindingService=gt,this._toUnhook=new DisposableStore,this._isMouseDown=!1,this._hoverClicked=!1,this._contentWidget=null,this._glyphWidget=null,this._hookEvents(),this._didChangeConfigurationHandler=this._editor.onDidChangeConfiguration(pt=>{pt.hasChanged(58)&&(this._unhookEvents(),this._hookEvents())})}_hookEvents(){const nt=()=>this._hideWidgets(),ot=this._editor.getOption(58);this._isHoverEnabled=ot.enabled,this._isHoverSticky=ot.sticky,this._isHoverEnabled?(this._toUnhook.add(this._editor.onMouseDown(rt=>this._onEditorMouseDown(rt))),this._toUnhook.add(this._editor.onMouseUp(rt=>this._onEditorMouseUp(rt))),this._toUnhook.add(this._editor.onMouseMove(rt=>this._onEditorMouseMove(rt))),this._toUnhook.add(this._editor.onKeyDown(rt=>this._onKeyDown(rt)))):(this._toUnhook.add(this._editor.onMouseMove(rt=>this._onEditorMouseMove(rt))),this._toUnhook.add(this._editor.onKeyDown(rt=>this._onKeyDown(rt)))),this._toUnhook.add(this._editor.onMouseLeave(rt=>this._onEditorMouseLeave(rt))),this._toUnhook.add(this._editor.onDidChangeModel(nt)),this._toUnhook.add(this._editor.onDidScrollChange(rt=>this._onEditorScrollChanged(rt)))}_unhookEvents(){this._toUnhook.clear()}_onEditorScrollChanged(nt){(nt.scrollTopChanged||nt.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(nt){this._isMouseDown=!0;const ot=nt.target;if(ot.type===9&&ot.detail===ContentHoverWidget.ID){this._hoverClicked=!0;return}ot.type===12&&ot.detail===MarginHoverWidget.ID||(ot.type!==12&&(this._hoverClicked=!1),this._hideWidgets())}_onEditorMouseUp(nt){this._isMouseDown=!1}_onEditorMouseLeave(nt){var ot;const rt=nt.event.browserEvent.relatedTarget;!((ot=this._contentWidget)===null||ot===void 0)&&ot.containsNode(rt)||this._hideWidgets()}_onEditorMouseMove(nt){var ot,rt,ut,gt,pt,mt,vt,St;const yt=nt.target;if(this._isMouseDown&&this._hoverClicked||this._isHoverSticky&&yt.type===9&&yt.detail===ContentHoverWidget.ID||this._isHoverSticky&&(!((ot=this._contentWidget)===null||ot===void 0)&&ot.containsNode((rt=nt.event.browserEvent.view)===null||rt===void 0?void 0:rt.document.activeElement))&&!(!((gt=(ut=nt.event.browserEvent.view)===null||ut===void 0?void 0:ut.getSelection())===null||gt===void 0)&&gt.isCollapsed)||!this._isHoverSticky&&yt.type===9&&yt.detail===ContentHoverWidget.ID&&(!((pt=this._contentWidget)===null||pt===void 0)&&pt.isColorPickerVisible())||this._isHoverSticky&&yt.type===12&&yt.detail===MarginHoverWidget.ID||this._isHoverSticky&&(!((mt=this._contentWidget)===null||mt===void 0)&&mt.isVisibleFromKeyboard()))return;if(!this._isHoverEnabled){this._hideWidgets();return}if(this._getOrCreateContentWidget().maybeShowAt(nt)){(vt=this._glyphWidget)===null||vt===void 0||vt.hide();return}if(yt.type===2&&yt.position){(St=this._contentWidget)===null||St===void 0||St.hide(),this._glyphWidget||(this._glyphWidget=new MarginHoverWidget(this._editor,this._languageService,this._openerService)),this._glyphWidget.startShowingAt(yt.position.lineNumber);return}this._hideWidgets()}_onKeyDown(nt){var ot;if(!this._editor.hasModel())return;const rt=this._keybindingService.softDispatch(nt,this._editor.getDomNode()),ut=(rt==null?void 0:rt.kind)===1||rt&&rt.kind===2&&rt.commandId==="editor.action.showHover"&&((ot=this._contentWidget)===null||ot===void 0?void 0:ot.isVisible());nt.keyCode!==5&&nt.keyCode!==6&&nt.keyCode!==57&&nt.keyCode!==4&&!ut&&this._hideWidgets()}_hideWidgets(){var nt,ot,rt;this._isMouseDown&&this._hoverClicked&&(!((nt=this._contentWidget)===null||nt===void 0)&&nt.isColorPickerVisible())||InlineSuggestionHintsContentWidget.dropDownVisible||(this._hoverClicked=!1,(ot=this._glyphWidget)===null||ot===void 0||ot.hide(),(rt=this._contentWidget)===null||rt===void 0||rt.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(ContentHoverController,this._editor)),this._contentWidget}isColorPickerVisible(){var nt;return((nt=this._contentWidget)===null||nt===void 0?void 0:nt.isColorPickerVisible())||!1}showContentHover(nt,ot,rt,ut){this._getOrCreateContentWidget().startShowingAtRange(nt,ot,rt,ut)}focus(){var nt;(nt=this._contentWidget)===null||nt===void 0||nt.focus()}scrollUp(){var nt;(nt=this._contentWidget)===null||nt===void 0||nt.scrollUp()}scrollDown(){var nt;(nt=this._contentWidget)===null||nt===void 0||nt.scrollDown()}scrollLeft(){var nt;(nt=this._contentWidget)===null||nt===void 0||nt.scrollLeft()}scrollRight(){var nt;(nt=this._contentWidget)===null||nt===void 0||nt.scrollRight()}pageUp(){var nt;(nt=this._contentWidget)===null||nt===void 0||nt.pageUp()}pageDown(){var nt;(nt=this._contentWidget)===null||nt===void 0||nt.pageDown()}goToTop(){var nt;(nt=this._contentWidget)===null||nt===void 0||nt.goToTop()}goToBottom(){var nt;(nt=this._contentWidget)===null||nt===void 0||nt.goToBottom()}escape(){var nt;(nt=this._contentWidget)===null||nt===void 0||nt.escape()}isHoverVisible(){var nt;return(nt=this._contentWidget)===null||nt===void 0?void 0:nt.isVisible()}dispose(){var nt,ot;this._unhookEvents(),this._toUnhook.dispose(),this._didChangeConfigurationHandler.dispose(),(nt=this._glyphWidget)===null||nt===void 0||nt.dispose(),(ot=this._contentWidget)===null||ot===void 0||ot.dispose()}};ModesHoverController.ID="editor.contrib.hover";ModesHoverController=__decorate$Z([__param$Z(1,IInstantiationService),__param$Z(2,IOpenerService),__param$Z(3,ILanguageService),__param$Z(4,IKeybindingService)],ModesHoverController);class ShowOrFocusHoverAction extends EditorAction{constructor(){super({id:"editor.action.showHover",label:localize({key:"showOrFocusHover",comment:["Label for action that will trigger the showing/focusing of a hover in the editor.","If the hover is not visible, it will show the hover.","This allows for users to show the hover without using the mouse.","If the hover is already visible, it will take focus."]},"Show or Focus Hover"),description:{description:"Show or Focus Hover",args:[{name:"args",schema:{type:"object",properties:{focus:{description:"Controls if when triggered with the keyboard, the hover should take focus immediately.",type:"boolean",default:!1}}}}]},alias:"Show or Focus Hover",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2087),weight:100}})}run(nt,ot,rt){if(!ot.hasModel())return;const ut=ModesHoverController.get(ot);if(!ut)return;const gt=ot.getPosition(),pt=new Range$2(gt.lineNumber,gt.column,gt.lineNumber,gt.column),mt=ot.getOption(2)===2||!!(rt!=null&&rt.focus);ut.isHoverVisible()?ut.focus():ut.showContentHover(pt,1,1,mt)}}class ShowDefinitionPreviewHoverAction extends EditorAction{constructor(){super({id:"editor.action.showDefinitionPreviewHover",label:localize({key:"showDefinitionPreviewHover",comment:["Label for action that will trigger the showing of definition preview hover in the editor.","This allows for users to show the definition preview hover without using the mouse."]},"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0})}run(nt,ot){const rt=ModesHoverController.get(ot);if(!rt)return;const ut=ot.getPosition();if(!ut)return;const gt=new Range$2(ut.lineNumber,ut.column,ut.lineNumber,ut.column),pt=GotoDefinitionAtPositionEditorContribution.get(ot);if(!pt)return;pt.startFindDefinitionFromCursor(ut).then(()=>{rt.showContentHover(gt,1,1,!0)})}}class ScrollUpHoverAction extends EditorAction{constructor(){super({id:"editor.action.scrollUpHover",label:localize({key:"scrollUpHover",comment:["Action that allows to scroll up in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Up Hover"),alias:"Scroll Up Hover",precondition:EditorContextKeys.hoverFocused,kbOpts:{kbExpr:EditorContextKeys.hoverFocused,primary:16,weight:100}})}run(nt,ot){const rt=ModesHoverController.get(ot);rt&&rt.scrollUp()}}class ScrollDownHoverAction extends EditorAction{constructor(){super({id:"editor.action.scrollDownHover",label:localize({key:"scrollDownHover",comment:["Action that allows to scroll down in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Down Hover"),alias:"Scroll Down Hover",precondition:EditorContextKeys.hoverFocused,kbOpts:{kbExpr:EditorContextKeys.hoverFocused,primary:18,weight:100}})}run(nt,ot){const rt=ModesHoverController.get(ot);rt&&rt.scrollDown()}}class ScrollLeftHoverAction extends EditorAction{constructor(){super({id:"editor.action.scrollLeftHover",label:localize({key:"scrollLeftHover",comment:["Action that allows to scroll left in the hover widget with the left arrow when the hover widget is focused."]},"Scroll Left Hover"),alias:"Scroll Left Hover",precondition:EditorContextKeys.hoverFocused,kbOpts:{kbExpr:EditorContextKeys.hoverFocused,primary:15,weight:100}})}run(nt,ot){const rt=ModesHoverController.get(ot);rt&&rt.scrollLeft()}}class ScrollRightHoverAction extends EditorAction{constructor(){super({id:"editor.action.scrollRightHover",label:localize({key:"scrollRightHover",comment:["Action that allows to scroll right in the hover widget with the right arrow when the hover widget is focused."]},"Scroll Right Hover"),alias:"Scroll Right Hover",precondition:EditorContextKeys.hoverFocused,kbOpts:{kbExpr:EditorContextKeys.hoverFocused,primary:17,weight:100}})}run(nt,ot){const rt=ModesHoverController.get(ot);rt&&rt.scrollRight()}}class PageUpHoverAction extends EditorAction{constructor(){super({id:"editor.action.pageUpHover",label:localize({key:"pageUpHover",comment:["Action that allows to page up in the hover widget with the page up command when the hover widget is focused."]},"Page Up Hover"),alias:"Page Up Hover",precondition:EditorContextKeys.hoverFocused,kbOpts:{kbExpr:EditorContextKeys.hoverFocused,primary:11,secondary:[528],weight:100}})}run(nt,ot){const rt=ModesHoverController.get(ot);rt&&rt.pageUp()}}class PageDownHoverAction extends EditorAction{constructor(){super({id:"editor.action.pageDownHover",label:localize({key:"pageDownHover",comment:["Action that allows to page down in the hover widget with the page down command when the hover widget is focused."]},"Page Down Hover"),alias:"Page Down Hover",precondition:EditorContextKeys.hoverFocused,kbOpts:{kbExpr:EditorContextKeys.hoverFocused,primary:12,secondary:[530],weight:100}})}run(nt,ot){const rt=ModesHoverController.get(ot);rt&&rt.pageDown()}}class GoToTopHoverAction extends EditorAction{constructor(){super({id:"editor.action.goToTopHover",label:localize({key:"goToTopHover",comment:["Action that allows to go to the top of the hover widget with the home command when the hover widget is focused."]},"Go To Top Hover"),alias:"Go To Bottom Hover",precondition:EditorContextKeys.hoverFocused,kbOpts:{kbExpr:EditorContextKeys.hoverFocused,primary:14,secondary:[2064],weight:100}})}run(nt,ot){const rt=ModesHoverController.get(ot);rt&&rt.goToTop()}}class GoToBottomHoverAction extends EditorAction{constructor(){super({id:"editor.action.goToBottomHover",label:localize({key:"goToBottomHover",comment:["Action that allows to go to the bottom in the hover widget with the end command when the hover widget is focused."]},"Go To Bottom Hover"),alias:"Go To Bottom Hover",precondition:EditorContextKeys.hoverFocused,kbOpts:{kbExpr:EditorContextKeys.hoverFocused,primary:13,secondary:[2066],weight:100}})}run(nt,ot){const rt=ModesHoverController.get(ot);rt&&rt.goToBottom()}}class EscapeFocusHoverAction extends EditorAction{constructor(){super({id:"editor.action.escapeFocusHover",label:localize({key:"escapeFocusHover",comment:["Action that allows to escape from the hover widget with the escape command when the hover widget is focused."]},"Escape Focus Hover"),alias:"Escape Focus Hover",precondition:EditorContextKeys.hoverFocused,kbOpts:{kbExpr:EditorContextKeys.hoverFocused,primary:9,weight:100}})}run(nt,ot){const rt=ModesHoverController.get(ot);rt&&rt.escape()}}registerEditorContribution(ModesHoverController.ID,ModesHoverController,2);registerEditorAction(ShowOrFocusHoverAction);registerEditorAction(ShowDefinitionPreviewHoverAction);registerEditorAction(ScrollUpHoverAction);registerEditorAction(ScrollDownHoverAction);registerEditorAction(ScrollLeftHoverAction);registerEditorAction(ScrollRightHoverAction);registerEditorAction(PageUpHoverAction);registerEditorAction(PageDownHoverAction);registerEditorAction(GoToTopHoverAction);registerEditorAction(GoToBottomHoverAction);registerEditorAction(EscapeFocusHoverAction);HoverParticipantRegistry.register(MarkdownHoverParticipant);HoverParticipantRegistry.register(MarkerHoverParticipant);registerThemingParticipant((ct,nt)=>{const ot=ct.getColor(editorHoverBorder);ot&&(nt.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${ot.transparent(.5)}; }`),nt.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${ot.transparent(.5)}; }`),nt.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${ot.transparent(.5)}; }`))});class ColorContribution extends Disposable{constructor(nt){super(),this._editor=nt,this._register(nt.onMouseDown(ot=>this.onMouseDown(ot)))}dispose(){super.dispose()}onMouseDown(nt){const ot=nt.target;if(ot.type!==6||!ot.detail.injectedText||ot.detail.injectedText.options.attachedData!==ColorDecorationInjectedTextMarker||!ot.range)return;const rt=this._editor.getContribution(ModesHoverController.ID);if(rt&&!rt.isColorPickerVisible()){const ut=new Range$2(ot.range.startLineNumber,ot.range.startColumn+1,ot.range.endLineNumber,ot.range.endColumn+1);rt.showContentHover(ut,1,0,!1)}}}ColorContribution.ID="editor.contrib.colorContribution";registerEditorContribution(ColorContribution.ID,ColorContribution,2);HoverParticipantRegistry.register(ColorHoverParticipant);var __decorate$Y=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$Y=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$G=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let StandaloneColorPickerController=class yr extends Disposable{constructor(nt,ot,rt,ut,gt,pt,mt){super(),this._editor=nt,this._modelService=rt,this._keybindingService=ut,this._instantiationService=gt,this._languageFeatureService=pt,this._languageConfigurationService=mt,this._standaloneColorPickerWidget=null,this._standaloneColorPickerVisible=EditorContextKeys.standaloneColorPickerVisible.bindTo(ot),this._standaloneColorPickerFocused=EditorContextKeys.standaloneColorPickerFocused.bindTo(ot)}showOrFocus(){var nt;this._editor.hasModel()&&(this._standaloneColorPickerVisible.get()?this._standaloneColorPickerFocused.get()||(nt=this._standaloneColorPickerWidget)===null||nt===void 0||nt.focus():this._standaloneColorPickerWidget=new StandaloneColorPickerWidget(this._editor,this._standaloneColorPickerVisible,this._standaloneColorPickerFocused,this._instantiationService,this._modelService,this._keybindingService,this._languageFeatureService,this._languageConfigurationService))}hide(){var nt;this._standaloneColorPickerFocused.set(!1),this._standaloneColorPickerVisible.set(!1),(nt=this._standaloneColorPickerWidget)===null||nt===void 0||nt.hide(),this._editor.focus()}insertColor(){var nt;(nt=this._standaloneColorPickerWidget)===null||nt===void 0||nt.updateEditor(),this.hide()}static get(nt){return nt.getContribution(yr.ID)}};StandaloneColorPickerController.ID="editor.contrib.standaloneColorPickerController";StandaloneColorPickerController=__decorate$Y([__param$Y(1,IContextKeyService),__param$Y(2,IModelService),__param$Y(3,IKeybindingService),__param$Y(4,IInstantiationService),__param$Y(5,ILanguageFeaturesService),__param$Y(6,ILanguageConfigurationService)],StandaloneColorPickerController);registerEditorContribution(StandaloneColorPickerController.ID,StandaloneColorPickerController,1);const PADDING=8,CLOSE_BUTTON_WIDTH=22;let StandaloneColorPickerWidget=class wr extends Disposable{constructor(nt,ot,rt,ut,gt,pt,mt,vt){var St;super(),this._editor=nt,this._standaloneColorPickerVisible=ot,this._standaloneColorPickerFocused=rt,this._modelService=gt,this._keybindingService=pt,this._languageFeaturesService=mt,this._languageConfigurationService=vt,this.body=document.createElement("div"),this._position=void 0,this._colorHover=null,this._selectionSetInEditor=!1,this._onResult=this._register(new Emitter$2),this.onResult=this._onResult.event,this._standaloneColorPickerVisible.set(!0),this._standaloneColorPickerParticipant=ut.createInstance(StandaloneColorPickerParticipant,this._editor),this._position=(St=this._editor._getViewModel())===null||St===void 0?void 0:St.getPrimaryCursorState().viewState.position;const yt=this._editor.getSelection(),wt=yt?{startLineNumber:yt.startLineNumber,startColumn:yt.startColumn,endLineNumber:yt.endLineNumber,endColumn:yt.endColumn}:{startLineNumber:0,endLineNumber:0,endColumn:0,startColumn:0},Lt=this._register(trackFocus(this.body));this._register(Lt.onDidBlur(xt=>{this.hide()})),this._register(Lt.onDidFocus(xt=>{this.focus()})),this._register(this._editor.onDidChangeCursorPosition(()=>{this._selectionSetInEditor?this._selectionSetInEditor=!1:this.hide()})),this._register(this._editor.onMouseMove(xt=>{var It;const kt=(It=xt.target.element)===null||It===void 0?void 0:It.classList;kt&&kt.contains("colorpicker-color-decoration")&&this.hide()})),this._register(this.onResult(xt=>{this._render(xt.value,xt.foundInEditor)})),this._start(wt),this._editor.addContentWidget(this)}updateEditor(){this._colorHover&&this._standaloneColorPickerParticipant.updateEditorModel(this._colorHover)}getId(){return wr.ID}getDomNode(){return this.body}getPosition(){if(!this._position)return null;const nt=this._editor.getOption(58).above;return{position:this._position,secondaryPosition:this._position,preference:nt?[1,2]:[2,1],positionAffinity:2}}hide(){this.dispose(),this._standaloneColorPickerVisible.set(!1),this._standaloneColorPickerFocused.set(!1),this._editor.removeContentWidget(this),this._editor.focus()}focus(){this._standaloneColorPickerFocused.set(!0),this.body.focus()}_start(nt){return __awaiter$G(this,void 0,void 0,function*(){const ot=yield this._computeAsync(nt);ot&&this._onResult.fire(new StandaloneColorPickerResult(ot.result,ot.foundInEditor))})}_computeAsync(nt){return __awaiter$G(this,void 0,void 0,function*(){if(!this._editor.hasModel())return null;const ot={range:nt,color:{red:0,green:0,blue:0,alpha:1}},rt=yield this._standaloneColorPickerParticipant.createColorHover(ot,new DefaultDocumentColorProvider(this._modelService,this._languageConfigurationService),this._languageFeaturesService.colorProvider);return rt?{result:rt.colorHover,foundInEditor:rt.foundInEditor}:null})}_render(nt,ot){const rt=document.createDocumentFragment(),ut=this._register(new EditorHoverStatusBar(this._keybindingService));let gt;const pt={fragment:rt,statusBar:ut,setColorPicker:kt=>gt=kt,onContentsChanged:()=>{},hide:()=>this.hide()};if(this._colorHover=nt,this._register(this._standaloneColorPickerParticipant.renderHoverParts(pt,[nt])),gt===void 0)return;this.body.classList.add("standalone-colorpicker-body"),this.body.style.maxHeight=Math.max(this._editor.getLayoutInfo().height/4,250)+"px",this.body.style.maxWidth=Math.max(this._editor.getLayoutInfo().width*.66,500)+"px",this.body.tabIndex=0,this.body.appendChild(rt),gt.layout();const mt=gt.body,vt=mt.saturationBox.domNode.clientWidth,St=mt.domNode.clientWidth-vt-CLOSE_BUTTON_WIDTH-PADDING,yt=gt.body.enterButton;yt==null||yt.onClicked(()=>{this.updateEditor(),this.hide()});const wt=gt.header,Lt=wt.pickedColorNode;Lt.style.width=vt+PADDING+"px";const xt=wt.originalColorNode;xt.style.width=St+"px";const It=gt.header.closeButton;It==null||It.onClicked(()=>{this.hide()}),ot&&(yt&&(yt.button.textContent="Replace"),this._selectionSetInEditor=!0,this._editor.setSelection(nt.range)),this._editor.layoutContentWidget(this)}};StandaloneColorPickerWidget.ID="editor.contrib.standaloneColorPickerWidget";StandaloneColorPickerWidget=__decorate$Y([__param$Y(3,IInstantiationService),__param$Y(4,IModelService),__param$Y(5,IKeybindingService),__param$Y(6,ILanguageFeaturesService),__param$Y(7,ILanguageConfigurationService)],StandaloneColorPickerWidget);class StandaloneColorPickerResult{constructor(nt,ot){this.value=nt,this.foundInEditor=ot}}class ShowOrFocusStandaloneColorPicker extends EditorAction2{constructor(){super({id:"editor.action.showOrFocusStandaloneColorPicker",title:{value:localize("showOrFocusStandaloneColorPicker","Show or Focus Standalone Color Picker"),mnemonicTitle:localize({key:"mishowOrFocusStandaloneColorPicker",comment:["&& denotes a mnemonic"]},"&&Show or Focus Standalone Color Picker"),original:"Show or Focus Standalone Color Picker"},precondition:void 0,menu:[{id:MenuId.CommandPalette}]})}runEditorCommand(nt,ot){var rt;(rt=StandaloneColorPickerController.get(ot))===null||rt===void 0||rt.showOrFocus()}}class HideStandaloneColorPicker extends EditorAction{constructor(){super({id:"editor.action.hideColorPicker",label:localize({key:"hideColorPicker",comment:["Action that hides the color picker"]},"Hide the Color Picker"),alias:"Hide the Color Picker",precondition:EditorContextKeys.standaloneColorPickerVisible.isEqualTo(!0),kbOpts:{primary:9,weight:100}})}run(nt,ot){var rt;(rt=StandaloneColorPickerController.get(ot))===null||rt===void 0||rt.hide()}}class InsertColorWithStandaloneColorPicker extends EditorAction{constructor(){super({id:"editor.action.insertColorWithStandaloneColorPicker",label:localize({key:"insertColorWithStandaloneColorPicker",comment:["Action that inserts color with standalone color picker"]},"Insert Color with Standalone Color Picker"),alias:"Insert Color with Standalone Color Picker",precondition:EditorContextKeys.standaloneColorPickerFocused.isEqualTo(!0),kbOpts:{primary:3,weight:100}})}run(nt,ot){var rt;(rt=StandaloneColorPickerController.get(ot))===null||rt===void 0||rt.insertColor()}}registerEditorAction(HideStandaloneColorPicker);registerEditorAction(InsertColorWithStandaloneColorPicker);registerAction2(ShowOrFocusStandaloneColorPicker);const generateUuid=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let ct;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?ct=crypto.getRandomValues.bind(crypto):ct=function(rt){for(let ut=0;ut<rt.length;ut++)rt[ut]=Math.floor(Math.random()*256);return rt};const nt=new Uint8Array(16),ot=[];for(let rt=0;rt<256;rt++)ot.push(rt.toString(16).padStart(2,"0"));return function(){ct(nt),nt[6]=nt[6]&15|64,nt[8]=nt[8]&63|128;let ut=0,gt="";return gt+=ot[nt[ut++]],gt+=ot[nt[ut++]],gt+=ot[nt[ut++]],gt+=ot[nt[ut++]],gt+="-",gt+=ot[nt[ut++]],gt+=ot[nt[ut++]],gt+="-",gt+=ot[nt[ut++]],gt+=ot[nt[ut++]],gt+="-",gt+=ot[nt[ut++]],gt+=ot[nt[ut++]],gt+="-",gt+=ot[nt[ut++]],gt+=ot[nt[ut++]],gt+=ot[nt[ut++]],gt+=ot[nt[ut++]],gt+=ot[nt[ut++]],gt+=ot[nt[ut++]],gt}}();var __awaiter$F=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function createStringDataTransferItem(ct){return{id:generateUuid(),asString:()=>__awaiter$F(this,void 0,void 0,function*(){return ct}),asFile:()=>{},value:typeof ct=="string"?ct:void 0}}function createFileDataTransferItem(ct,nt,ot){return{id:generateUuid(),asString:()=>__awaiter$F(this,void 0,void 0,function*(){return""}),asFile:()=>({name:ct,uri:nt,data:ot}),value:void 0}}class VSDataTransfer{constructor(){this._entries=new Map}get size(){let nt=0;return this.forEach(()=>nt++),nt}has(nt){return this._entries.has(this.toKey(nt))}matches(nt){if(this.has(nt))return!0;if(nt.toLowerCase()==="files")return Iterable.some(this.values(),pt=>pt.asFile());if(nt==="*/*")return this._entries.size>0;const ot=this.toKey(nt).match(/^([a-z]+)\/([a-z]+|\*)$/i);if(!ot)return!1;const[rt,ut,gt]=ot;return gt==="*"?Iterable.some(this._entries.keys(),pt=>pt.startsWith(ut+"/")):!1}get(nt){var ot;return(ot=this._entries.get(this.toKey(nt)))===null||ot===void 0?void 0:ot[0]}append(nt,ot){const rt=this._entries.get(nt);rt?rt.push(ot):this._entries.set(this.toKey(nt),[ot])}replace(nt,ot){this._entries.set(this.toKey(nt),[ot])}delete(nt){this._entries.delete(this.toKey(nt))}*entries(){for(const[nt,ot]of this._entries.entries())for(const rt of ot)yield[nt,rt]}values(){return Array.from(this._entries.values()).flat()}forEach(nt){for(const[ot,rt]of this.entries())nt(rt,ot)}toKey(nt){return nt.toLowerCase()}}const UriList=Object.freeze({create:ct=>distinct(ct.map(nt=>nt.toString())).join(`\r
`),split:ct=>ct.split(`\r
`),parse:ct=>UriList.split(ct).filter(nt=>!nt.startsWith("#"))}),CodeDataTransfers={EDITORS:"CodeEditors",FILES:"CodeFiles"};function extractEditorsDropData(ct){var nt;const ot=[];if(ct.dataTransfer&&ct.dataTransfer.types.length>0){const gt=ct.dataTransfer.getData(CodeDataTransfers.EDITORS);if(gt)try{ot.push(...parse$2(gt))}catch{}else try{const vt=ct.dataTransfer.getData(DataTransfers.RESOURCES);ot.push(...createDraggedEditorInputFromRawResourcesData(vt))}catch{}if(!((nt=ct.dataTransfer)===null||nt===void 0)&&nt.files)for(let vt=0;vt<ct.dataTransfer.files.length;vt++){const St=ct.dataTransfer.files[vt];if(St&&St.path)try{ot.push({resource:URI.file(St.path),isExternal:!0,allowWorkspaceOpen:!0})}catch{}}const pt=ct.dataTransfer.getData(CodeDataTransfers.FILES);if(pt)try{const vt=JSON.parse(pt);for(const St of vt)ot.push({resource:URI.file(St),isExternal:!0,allowWorkspaceOpen:!0})}catch{}const mt=Registry.as(Extensions.DragAndDropContribution).getAll();for(const vt of mt){const St=ct.dataTransfer.getData(vt.dataFormatKey);if(St)try{ot.push(...vt.getEditorInputs(St))}catch{}}}const rt=[],ut=new ResourceMap;for(const gt of ot)gt.resource?ut.has(gt.resource)||(rt.push(gt),ut.set(gt.resource,!0)):rt.push(gt);return rt}function createDraggedEditorInputFromRawResourcesData(ct){const nt=[];if(ct){const ot=JSON.parse(ct);for(const rt of ot)if(rt.indexOf(":")>0){const{selection:ut,uri:gt}=extractSelection(URI.parse(rt));nt.push({resource:gt,options:{selection:ut}})}}return nt}class DragAndDropContributionRegistry{constructor(){this._contributions=new Map}getAll(){return this._contributions.values()}}const Extensions={DragAndDropContribution:"workbench.contributions.dragAndDrop"};Registry.add(Extensions.DragAndDropContribution,new DragAndDropContributionRegistry);class LocalSelectionTransfer{constructor(){}static getInstance(){return LocalSelectionTransfer.INSTANCE}hasData(nt){return nt&&nt===this.proto}getData(nt){if(this.hasData(nt))return this.data}}LocalSelectionTransfer.INSTANCE=new LocalSelectionTransfer;var __awaiter$E=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function toVSDataTransfer(ct){const nt=new VSDataTransfer;for(const ot of ct.items){const rt=ot.type;if(ot.kind==="string"){const ut=new Promise(gt=>ot.getAsString(gt));nt.append(rt,createStringDataTransferItem(ut))}else if(ot.kind==="file"){const ut=ot.getAsFile();ut&&nt.append(rt,createFileDataTransferItemFromFile(ut))}}return nt}function createFileDataTransferItemFromFile(ct){const nt=ct.path?URI.parse(ct.path):void 0;return createFileDataTransferItem(ct.name,nt,()=>__awaiter$E(this,void 0,void 0,function*(){return new Uint8Array(yield ct.arrayBuffer())}))}const INTERNAL_DND_MIME_TYPES=Object.freeze([CodeDataTransfers.EDITORS,CodeDataTransfers.FILES,DataTransfers.RESOURCES]);function addExternalEditorsDropData(ct,nt,ot=!1){var rt;if(nt.dataTransfer&&(ot||!ct.has(Mimes.uriList))){const ut=extractEditorsDropData(nt).filter(gt=>gt.resource).map(gt=>gt.resource.toString());for(const gt of(rt=nt.dataTransfer)===null||rt===void 0?void 0:rt.items){const pt=gt.getAsFile();pt&&ut.push(pt.path?URI.file(pt.path).toString():pt.name)}ut.length&&ct.replace(Mimes.uriList,createStringDataTransferItem(UriList.create(ut)))}for(const ut of INTERNAL_DND_MIME_TYPES)ct.delete(ut)}const inlineProgressWidget="";var __decorate$X=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$X=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const inlineProgressDecoration=ModelDecorationOptions.register({description:"inline-progress-widget",stickiness:1,showIfCollapsed:!0,after:{content:noBreakWhitespace,inlineClassName:"inline-editor-progress-decoration",inlineClassNameAffectsLetterSpacing:!0}});class InlineProgressWidget extends Disposable{constructor(nt,ot,rt,ut,gt){super(),this.typeId=nt,this.editor=ot,this.range=rt,this.delegate=gt,this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this.create(ut),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}create(nt){this.domNode=$$d(".inline-progress-widget"),this.domNode.role="button",this.domNode.title=nt;const ot=$$d("span.icon");this.domNode.append(ot),ot.classList.add(...ThemeIcon.asClassNameArray(Codicon.loading),"codicon-modifier-spin");const rt=()=>{const ut=this.editor.getOption(64);this.domNode.style.height=`${ut}px`,this.domNode.style.width=`${Math.ceil(.8*ut)}px`};rt(),this._register(this.editor.onDidChangeConfiguration(ut=>{(ut.hasChanged(50)||ut.hasChanged(64))&&rt()})),this._register(addDisposableListener(this.domNode,EventType$1.CLICK,ut=>{this.delegate.cancel()}))}getId(){return InlineProgressWidget.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn},preference:[0]}}dispose(){super.dispose(),this.editor.removeContentWidget(this)}}InlineProgressWidget.baseId="editor.widget.inlineProgressWidget";let InlineProgressManager=class extends Disposable{constructor(nt,ot,rt){super(),this.id=nt,this._editor=ot,this._instantiationService=rt,this._showDelay=500,this._showPromise=this._register(new MutableDisposable),this._currentWidget=new MutableDisposable,this._currentDecorations=ot.createDecorationsCollection()}setAtPosition(nt,ot,rt){this.clear(),this._showPromise.value=disposableTimeout(()=>{const ut=Range$2.fromPositions(nt);this._currentDecorations.set([{range:ut,options:inlineProgressDecoration}]).length>0&&(this._currentWidget.value=this._instantiationService.createInstance(InlineProgressWidget,this.id,this._editor,ut,ot,rt))},this._showDelay)}clear(){this._showPromise.clear(),this._currentDecorations.clear(),this._currentWidget.clear()}};InlineProgressManager=__decorate$X([__param$X(2,IInstantiationService)],InlineProgressManager);var __decorate$W=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$W=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$D=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const vscodeClipboardMime="application/vnd.code.copyMetadata";let CopyPasteController=class extends Disposable{constructor(nt,ot,rt,ut,gt,pt){super(),this._bulkEditService=rt,this._clipboardService=ut,this._configurationService=gt,this._languageFeaturesService=pt,this.operationIdPool=0,this._editor=nt;const mt=nt.getContainerDomNode();this._register(addDisposableListener(mt,"copy",vt=>this.handleCopy(vt))),this._register(addDisposableListener(mt,"cut",vt=>this.handleCopy(vt))),this._register(addDisposableListener(mt,"paste",vt=>this.handlePaste(vt),!0)),this._pasteProgressManager=this._register(new InlineProgressManager("pasteIntoEditor",nt,ot))}arePasteActionsEnabled(nt){return this._configurationService.getValue("editor.experimental.pasteActions.enabled",{resource:nt.uri})?!0:nt.uri.scheme===Schemas.vscodeNotebookCell}handleCopy(nt){var ot;if(!nt.clipboardData||!this._editor.hasTextFocus())return;const rt=this._editor.getModel(),ut=this._editor.getSelections();if(!rt||!(ut!=null&&ut.length)||!this.arePasteActionsEnabled(rt))return;const gt=[...ut],pt=ut[0],mt=pt.isEmpty();if(mt){if(!this._editor.getOption(35))return;gt[0]=new Range$2(pt.startLineNumber,0,pt.startLineNumber,rt.getLineLength(pt.startLineNumber))}const vt=this._languageFeaturesService.documentPasteEditProvider.ordered(rt).filter(Lt=>!!Lt.prepareDocumentPaste);if(!vt.length){this.setCopyMetadata(nt.clipboardData,{wasFromEmptySelection:mt});return}const St=toVSDataTransfer(nt.clipboardData),yt=generateUuid();this.setCopyMetadata(nt.clipboardData,{id:yt,wasFromEmptySelection:mt});const wt=createCancelablePromise(Lt=>__awaiter$D(this,void 0,void 0,function*(){const xt=yield Promise.all(vt.map(It=>It.prepareDocumentPaste(rt,gt,St,Lt)));for(const It of xt)It==null||It.forEach((kt,At)=>{St.replace(At,kt)});return St}));(ot=this._currentClipboardItem)===null||ot===void 0||ot.dataTransferPromise.cancel(),this._currentClipboardItem={handle:yt,dataTransferPromise:wt}}setCopyMetadata(nt,ot){nt.setData(vscodeClipboardMime,JSON.stringify(ot))}handlePaste(nt){var ot,rt;return __awaiter$D(this,void 0,void 0,function*(){if(!nt.clipboardData||!this._editor.hasTextFocus())return;const ut=this.operationIdPool++;(ot=this._currentOperation)===null||ot===void 0||ot.promise.cancel(),this._pasteProgressManager.clear();const gt=this._editor.getSelections();if(!(gt!=null&&gt.length)||!this._editor.hasModel())return;const pt=this._editor.getModel();if(!this.arePasteActionsEnabled(pt))return;let mt;const vt=(rt=nt.clipboardData)===null||rt===void 0?void 0:rt.getData(vscodeClipboardMime);vt&&typeof vt=="string"&&(mt=JSON.parse(vt));const St=this._languageFeaturesService.documentPasteEditProvider.ordered(pt);if(!St.length)return;nt.preventDefault(),nt.stopImmediatePropagation();const yt=createCancelablePromise(wt=>__awaiter$D(this,void 0,void 0,function*(){var Lt,xt,It,kt;const At=this._editor;if(!At.hasModel())return;const Tt=new EditorStateCancellationTokenSource(At,3,void 0,wt);try{this._pasteProgressManager.setAtPosition(gt[0].getEndPosition(),localize("pasteIntoEditorProgress","Running paste handlers. Click to cancel"),{cancel:()=>Tt.cancel()});const Rt=toVSDataTransfer(nt.clipboardData);if(mt!=null&&mt.id&&((Lt=this._currentClipboardItem)===null||Lt===void 0?void 0:Lt.handle)===mt.id){const Pt=yield this._currentClipboardItem.dataTransferPromise;if(Tt.token.isCancellationRequested)return;Pt.forEach((Ft,Kt)=>{Rt.replace(Kt,Ft)})}if(!Rt.has(Mimes.uriList)){const Pt=yield this._clipboardService.readResources();if(Tt.token.isCancellationRequested)return;Pt.length&&Rt.append(Mimes.uriList,createStringDataTransferItem(UriList.create(Pt)))}Rt.delete(vscodeClipboardMime);const Nt=yield this.getProviderPasteEdit(St,Rt,pt,gt,Tt.token);if(Tt.token.isCancellationRequested)return;if(Nt){const Pt=typeof Nt.insertText=="string"?SnippetParser.escape(Nt.insertText):Nt.insertText.snippet,Ft={edits:[new ResourceTextEdit(pt.uri,{range:Selection$1.liftSelection(At.getSelection()),text:Pt,insertAsSnippet:!0}),...(It=(xt=Nt.additionalEdit)===null||xt===void 0?void 0:xt.edits)!==null&&It!==void 0?It:[]]};yield this._bulkEditService.apply(Ft,{editor:At});return}yield this.applyDefaultPasteHandler(Rt,mt,Tt.token)}finally{Tt.dispose(),((kt=this._currentOperation)===null||kt===void 0?void 0:kt.id)===ut&&(this._pasteProgressManager.clear(),this._currentOperation=void 0)}}));this._currentOperation={id:ut,promise:yt}})}getProviderPasteEdit(nt,ot,rt,ut,gt){return raceCancellation((()=>__awaiter$D(this,void 0,void 0,function*(){for(const pt of nt){if(gt.isCancellationRequested)return;if(!isSupportedProvider(pt,ot))continue;const mt=yield pt.provideDocumentPasteEdits(rt,ut,ot,gt);if(mt)return mt}}))(),gt)}applyDefaultPasteHandler(nt,ot,rt){var ut;return __awaiter$D(this,void 0,void 0,function*(){const gt=(ut=nt.get(Mimes.text))!==null&&ut!==void 0?ut:nt.get("text");if(!gt)return;const pt=yield gt.asString();rt.isCancellationRequested||this._editor.trigger("keyboard","paste",{text:pt,pasteOnNewLine:ot==null?void 0:ot.wasFromEmptySelection,multicursorText:null})})}};CopyPasteController.ID="editor.contrib.copyPasteActionController";CopyPasteController=__decorate$W([__param$W(1,IInstantiationService),__param$W(2,IBulkEditService),__param$W(3,IClipboardService),__param$W(4,IConfigurationService),__param$W(5,ILanguageFeaturesService)],CopyPasteController);function isSupportedProvider(ct,nt){return ct.pasteMimeTypes.some(ot=>nt.matches(ot))}registerEditorContribution(CopyPasteController.ID,CopyPasteController,0);Registry.as(Extensions$8.Configuration).registerConfiguration(Object.assign(Object.assign({},editorConfigurationBaseNode),{properties:{"editor.experimental.pasteActions.enabled":{type:"boolean",scope:5,description:localize("pasteActions","Enable/disable running edits from extensions on paste."),default:!1}}}));class BlockCommentCommand{constructor(nt,ot,rt){this.languageConfigurationService=rt,this._selection=nt,this._insertSpace=ot,this._usedEndToken=null}static _haystackHasNeedleAtOffset(nt,ot,rt){if(rt<0)return!1;const ut=ot.length,gt=nt.length;if(rt+ut>gt)return!1;for(let pt=0;pt<ut;pt++){const mt=nt.charCodeAt(rt+pt),vt=ot.charCodeAt(pt);if(mt!==vt&&!(mt>=65&&mt<=90&&mt+32===vt)&&!(vt>=65&&vt<=90&&vt+32===mt))return!1}return!0}_createOperationsForBlockComment(nt,ot,rt,ut,gt,pt){const mt=nt.startLineNumber,vt=nt.startColumn,St=nt.endLineNumber,yt=nt.endColumn,wt=gt.getLineContent(mt),Lt=gt.getLineContent(St);let xt=wt.lastIndexOf(ot,vt-1+ot.length),It=Lt.indexOf(rt,yt-1-rt.length);if(xt!==-1&&It!==-1)if(mt===St)wt.substring(xt+ot.length,It).indexOf(rt)>=0&&(xt=-1,It=-1);else{const At=wt.substring(xt+ot.length),Tt=Lt.substring(0,It);(At.indexOf(rt)>=0||Tt.indexOf(rt)>=0)&&(xt=-1,It=-1)}let kt;xt!==-1&&It!==-1?(ut&&xt+ot.length<wt.length&&wt.charCodeAt(xt+ot.length)===32&&(ot=ot+" "),ut&&It>0&&Lt.charCodeAt(It-1)===32&&(rt=" "+rt,It-=1),kt=BlockCommentCommand._createRemoveBlockCommentOperations(new Range$2(mt,xt+ot.length+1,St,It+1),ot,rt)):(kt=BlockCommentCommand._createAddBlockCommentOperations(nt,ot,rt,this._insertSpace),this._usedEndToken=kt.length===1?rt:null);for(const At of kt)pt.addTrackedEditOperation(At.range,At.text)}static _createRemoveBlockCommentOperations(nt,ot,rt){const ut=[];return Range$2.isEmpty(nt)?ut.push(EditOperation.delete(new Range$2(nt.startLineNumber,nt.startColumn-ot.length,nt.endLineNumber,nt.endColumn+rt.length))):(ut.push(EditOperation.delete(new Range$2(nt.startLineNumber,nt.startColumn-ot.length,nt.startLineNumber,nt.startColumn))),ut.push(EditOperation.delete(new Range$2(nt.endLineNumber,nt.endColumn,nt.endLineNumber,nt.endColumn+rt.length)))),ut}static _createAddBlockCommentOperations(nt,ot,rt,ut){const gt=[];return Range$2.isEmpty(nt)?gt.push(EditOperation.replace(new Range$2(nt.startLineNumber,nt.startColumn,nt.endLineNumber,nt.endColumn),ot+"  "+rt)):(gt.push(EditOperation.insert(new Position$1(nt.startLineNumber,nt.startColumn),ot+(ut?" ":""))),gt.push(EditOperation.insert(new Position$1(nt.endLineNumber,nt.endColumn),(ut?" ":"")+rt))),gt}getEditOperations(nt,ot){const rt=this._selection.startLineNumber,ut=this._selection.startColumn;nt.tokenization.tokenizeIfCheap(rt);const gt=nt.getLanguageIdAtPosition(rt,ut),pt=this.languageConfigurationService.getLanguageConfiguration(gt).comments;!pt||!pt.blockCommentStartToken||!pt.blockCommentEndToken||this._createOperationsForBlockComment(this._selection,pt.blockCommentStartToken,pt.blockCommentEndToken,this._insertSpace,nt,ot)}computeCursorState(nt,ot){const rt=ot.getInverseEditOperations();if(rt.length===2){const ut=rt[0],gt=rt[1];return new Selection$1(ut.range.endLineNumber,ut.range.endColumn,gt.range.startLineNumber,gt.range.startColumn)}else{const ut=rt[0].range,gt=this._usedEndToken?-this._usedEndToken.length-1:0;return new Selection$1(ut.endLineNumber,ut.endColumn+gt,ut.endLineNumber,ut.endColumn+gt)}}}class LineCommentCommand{constructor(nt,ot,rt,ut,gt,pt,mt){this.languageConfigurationService=nt,this._selection=ot,this._tabSize=rt,this._type=ut,this._insertSpace=gt,this._selectionId=null,this._deltaColumn=0,this._moveEndPositionDown=!1,this._ignoreEmptyLines=pt,this._ignoreFirstLine=mt||!1}static _gatherPreflightCommentStrings(nt,ot,rt,ut){nt.tokenization.tokenizeIfCheap(ot);const gt=nt.getLanguageIdAtPosition(ot,1),pt=ut.getLanguageConfiguration(gt).comments,mt=pt?pt.lineCommentToken:null;if(!mt)return null;const vt=[];for(let St=0,yt=rt-ot+1;St<yt;St++)vt[St]={ignore:!1,commentStr:mt,commentStrOffset:0,commentStrLength:mt.length};return vt}static _analyzeLines(nt,ot,rt,ut,gt,pt,mt,vt){let St=!0,yt;nt===0?yt=!0:nt===1?yt=!1:yt=!0;for(let wt=0,Lt=ut.length;wt<Lt;wt++){const xt=ut[wt],It=gt+wt;if(It===gt&&mt){xt.ignore=!0;continue}const kt=rt.getLineContent(It),At=firstNonWhitespaceIndex(kt);if(At===-1){xt.ignore=pt,xt.commentStrOffset=kt.length;continue}if(St=!1,xt.ignore=!1,xt.commentStrOffset=At,yt&&!BlockCommentCommand._haystackHasNeedleAtOffset(kt,xt.commentStr,At)&&(nt===0?yt=!1:nt===1||(xt.ignore=!0)),yt&&ot){const Tt=At+xt.commentStrLength;Tt<kt.length&&kt.charCodeAt(Tt)===32&&(xt.commentStrLength+=1)}}if(nt===0&&St){yt=!1;for(let wt=0,Lt=ut.length;wt<Lt;wt++)ut[wt].ignore=!1}return{supported:!0,shouldRemoveComments:yt,lines:ut}}static _gatherPreflightData(nt,ot,rt,ut,gt,pt,mt,vt){const St=LineCommentCommand._gatherPreflightCommentStrings(rt,ut,gt,vt);return St===null?{supported:!1}:LineCommentCommand._analyzeLines(nt,ot,rt,St,ut,pt,mt,vt)}_executeLineComments(nt,ot,rt,ut){let gt;rt.shouldRemoveComments?gt=LineCommentCommand._createRemoveLineCommentsOperations(rt.lines,ut.startLineNumber):(LineCommentCommand._normalizeInsertionPoint(nt,rt.lines,ut.startLineNumber,this._tabSize),gt=this._createAddLineCommentsOperations(rt.lines,ut.startLineNumber));const pt=new Position$1(ut.positionLineNumber,ut.positionColumn);for(let mt=0,vt=gt.length;mt<vt;mt++)ot.addEditOperation(gt[mt].range,gt[mt].text),Range$2.isEmpty(gt[mt].range)&&Range$2.getStartPosition(gt[mt].range).equals(pt)&&nt.getLineContent(pt.lineNumber).length+1===pt.column&&(this._deltaColumn=(gt[mt].text||"").length);this._selectionId=ot.trackSelection(ut)}_attemptRemoveBlockComment(nt,ot,rt,ut){let gt=ot.startLineNumber,pt=ot.endLineNumber;const mt=ut.length+Math.max(nt.getLineFirstNonWhitespaceColumn(ot.startLineNumber),ot.startColumn);let vt=nt.getLineContent(gt).lastIndexOf(rt,mt-1),St=nt.getLineContent(pt).indexOf(ut,ot.endColumn-1-rt.length);return vt!==-1&&St===-1&&(St=nt.getLineContent(gt).indexOf(ut,vt+rt.length),pt=gt),vt===-1&&St!==-1&&(vt=nt.getLineContent(pt).lastIndexOf(rt,St),gt=pt),ot.isEmpty()&&(vt===-1||St===-1)&&(vt=nt.getLineContent(gt).indexOf(rt),vt!==-1&&(St=nt.getLineContent(gt).indexOf(ut,vt+rt.length))),vt!==-1&&nt.getLineContent(gt).charCodeAt(vt+rt.length)===32&&(rt+=" "),St!==-1&&nt.getLineContent(pt).charCodeAt(St-1)===32&&(ut=" "+ut,St-=1),vt!==-1&&St!==-1?BlockCommentCommand._createRemoveBlockCommentOperations(new Range$2(gt,vt+rt.length+1,pt,St+1),rt,ut):null}_executeBlockComment(nt,ot,rt){nt.tokenization.tokenizeIfCheap(rt.startLineNumber);const ut=nt.getLanguageIdAtPosition(rt.startLineNumber,1),gt=this.languageConfigurationService.getLanguageConfiguration(ut).comments;if(!gt||!gt.blockCommentStartToken||!gt.blockCommentEndToken)return;const pt=gt.blockCommentStartToken,mt=gt.blockCommentEndToken;let vt=this._attemptRemoveBlockComment(nt,rt,pt,mt);if(!vt){if(rt.isEmpty()){const St=nt.getLineContent(rt.startLineNumber);let yt=firstNonWhitespaceIndex(St);yt===-1&&(yt=St.length),vt=BlockCommentCommand._createAddBlockCommentOperations(new Range$2(rt.startLineNumber,yt+1,rt.startLineNumber,St.length+1),pt,mt,this._insertSpace)}else vt=BlockCommentCommand._createAddBlockCommentOperations(new Range$2(rt.startLineNumber,nt.getLineFirstNonWhitespaceColumn(rt.startLineNumber),rt.endLineNumber,nt.getLineMaxColumn(rt.endLineNumber)),pt,mt,this._insertSpace);vt.length===1&&(this._deltaColumn=pt.length+1)}this._selectionId=ot.trackSelection(rt);for(const St of vt)ot.addEditOperation(St.range,St.text)}getEditOperations(nt,ot){let rt=this._selection;if(this._moveEndPositionDown=!1,rt.startLineNumber===rt.endLineNumber&&this._ignoreFirstLine){ot.addEditOperation(new Range$2(rt.startLineNumber,nt.getLineMaxColumn(rt.startLineNumber),rt.startLineNumber+1,1),rt.startLineNumber===nt.getLineCount()?"":`
`),this._selectionId=ot.trackSelection(rt);return}rt.startLineNumber<rt.endLineNumber&&rt.endColumn===1&&(this._moveEndPositionDown=!0,rt=rt.setEndPosition(rt.endLineNumber-1,nt.getLineMaxColumn(rt.endLineNumber-1)));const ut=LineCommentCommand._gatherPreflightData(this._type,this._insertSpace,nt,rt.startLineNumber,rt.endLineNumber,this._ignoreEmptyLines,this._ignoreFirstLine,this.languageConfigurationService);return ut.supported?this._executeLineComments(nt,ot,ut,rt):this._executeBlockComment(nt,ot,rt)}computeCursorState(nt,ot){let rt=ot.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(rt=rt.setEndPosition(rt.endLineNumber+1,1)),new Selection$1(rt.selectionStartLineNumber,rt.selectionStartColumn+this._deltaColumn,rt.positionLineNumber,rt.positionColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(nt,ot){const rt=[];for(let ut=0,gt=nt.length;ut<gt;ut++){const pt=nt[ut];pt.ignore||rt.push(EditOperation.delete(new Range$2(ot+ut,pt.commentStrOffset+1,ot+ut,pt.commentStrOffset+pt.commentStrLength+1)))}return rt}_createAddLineCommentsOperations(nt,ot){const rt=[],ut=this._insertSpace?" ":"";for(let gt=0,pt=nt.length;gt<pt;gt++){const mt=nt[gt];mt.ignore||rt.push(EditOperation.insert(new Position$1(ot+gt,mt.commentStrOffset+1),mt.commentStr+ut))}return rt}static nextVisibleColumn(nt,ot,rt,ut){return rt?nt+(ot-nt%ot):nt+ut}static _normalizeInsertionPoint(nt,ot,rt,ut){let gt=1073741824,pt,mt;for(let vt=0,St=ot.length;vt<St;vt++){if(ot[vt].ignore)continue;const yt=nt.getLineContent(rt+vt);let wt=0;for(let Lt=0,xt=ot[vt].commentStrOffset;wt<gt&&Lt<xt;Lt++)wt=LineCommentCommand.nextVisibleColumn(wt,ut,yt.charCodeAt(Lt)===9,1);wt<gt&&(gt=wt)}gt=Math.floor(gt/ut)*ut;for(let vt=0,St=ot.length;vt<St;vt++){if(ot[vt].ignore)continue;const yt=nt.getLineContent(rt+vt);let wt=0;for(pt=0,mt=ot[vt].commentStrOffset;wt<gt&&pt<mt;pt++)wt=LineCommentCommand.nextVisibleColumn(wt,ut,yt.charCodeAt(pt)===9,1);wt>gt?ot[vt].commentStrOffset=pt-1:ot[vt].commentStrOffset=pt}}}class CommentLineAction extends EditorAction{constructor(nt,ot){super(ot),this._type=nt}run(nt,ot){const rt=nt.get(ILanguageConfigurationService);if(!ot.hasModel())return;const ut=ot.getModel(),gt=[],pt=ut.getOptions(),mt=ot.getOption(21),vt=ot.getSelections().map((yt,wt)=>({selection:yt,index:wt,ignoreFirstLine:!1}));vt.sort((yt,wt)=>Range$2.compareRangesUsingStarts(yt.selection,wt.selection));let St=vt[0];for(let yt=1;yt<vt.length;yt++){const wt=vt[yt];St.selection.endLineNumber===wt.selection.startLineNumber&&(St.index<wt.index?wt.ignoreFirstLine=!0:(St.ignoreFirstLine=!0,St=wt))}for(const yt of vt)gt.push(new LineCommentCommand(rt,yt.selection,pt.tabSize,this._type,mt.insertSpace,mt.ignoreEmptyLines,yt.ignoreFirstLine));ot.pushUndoStop(),ot.executeCommands(this.id,gt),ot.pushUndoStop()}}class ToggleCommentLineAction extends CommentLineAction{constructor(){super(0,{id:"editor.action.commentLine",label:localize("comment.line","Toggle Line Comment"),alias:"Toggle Line Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2138,weight:100},menuOpts:{menuId:MenuId.MenubarEditMenu,group:"5_insert",title:localize({key:"miToggleLineComment",comment:["&& denotes a mnemonic"]},"&&Toggle Line Comment"),order:1}})}}class AddLineCommentAction extends CommentLineAction{constructor(){super(1,{id:"editor.action.addCommentLine",label:localize("comment.line.add","Add Line Comment"),alias:"Add Line Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2081),weight:100}})}}class RemoveLineCommentAction extends CommentLineAction{constructor(){super(2,{id:"editor.action.removeCommentLine",label:localize("comment.line.remove","Remove Line Comment"),alias:"Remove Line Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2099),weight:100}})}}class BlockCommentAction extends EditorAction{constructor(){super({id:"editor.action.blockComment",label:localize("comment.block","Toggle Block Comment"),alias:"Toggle Block Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:MenuId.MenubarEditMenu,group:"5_insert",title:localize({key:"miToggleBlockComment",comment:["&& denotes a mnemonic"]},"Toggle &&Block Comment"),order:2}})}run(nt,ot){const rt=nt.get(ILanguageConfigurationService);if(!ot.hasModel())return;const ut=ot.getOption(21),gt=[],pt=ot.getSelections();for(const mt of pt)gt.push(new BlockCommentCommand(mt,ut.insertSpace,rt));ot.pushUndoStop(),ot.executeCommands(this.id,gt),ot.pushUndoStop()}}registerEditorAction(ToggleCommentLineAction);registerEditorAction(AddLineCommentAction);registerEditorAction(RemoveLineCommentAction);registerEditorAction(BlockCommentAction);var __decorate$V=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$V=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let ContextMenuController=class Er{static get(nt){return nt.getContribution(Er.ID)}constructor(nt,ot,rt,ut,gt,pt,mt,vt){this._contextMenuService=ot,this._contextViewService=rt,this._contextKeyService=ut,this._keybindingService=gt,this._menuService=pt,this._configurationService=mt,this._workspaceContextService=vt,this._toDispose=new DisposableStore,this._contextMenuIsBeingShownCount=0,this._editor=nt,this._toDispose.add(this._editor.onContextMenu(St=>this._onContextMenu(St))),this._toDispose.add(this._editor.onMouseWheel(St=>{if(this._contextMenuIsBeingShownCount>0){const yt=this._contextViewService.getContextViewElement(),wt=St.srcElement;wt.shadowRoot&&getShadowRoot(yt)===wt.shadowRoot||this._contextViewService.hideContextView()}})),this._toDispose.add(this._editor.onKeyDown(St=>{this._editor.getOption(22)&&St.keyCode===58&&(St.preventDefault(),St.stopPropagation(),this.showContextMenu())}))}_onContextMenu(nt){if(!this._editor.hasModel())return;if(!this._editor.getOption(22)){this._editor.focus(),nt.target.position&&!this._editor.getSelection().containsPosition(nt.target.position)&&this._editor.setPosition(nt.target.position);return}if(nt.target.type===12||nt.target.type===6&&nt.target.detail.injectedText)return;if(nt.event.preventDefault(),nt.event.stopPropagation(),nt.target.type===11)return this._showScrollbarContextMenu({x:nt.event.posx-1,width:2,y:nt.event.posy-1,height:2});if(nt.target.type!==6&&nt.target.type!==7&&nt.target.type!==1)return;if(this._editor.focus(),nt.target.position){let rt=!1;for(const ut of this._editor.getSelections())if(ut.containsPosition(nt.target.position)){rt=!0;break}rt||this._editor.setPosition(nt.target.position)}let ot=null;nt.target.type!==1&&(ot={x:nt.event.posx-1,width:2,y:nt.event.posy-1,height:2}),this.showContextMenu(ot)}showContextMenu(nt){if(!this._editor.getOption(22)||!this._editor.hasModel())return;const ot=this._getMenuActions(this._editor.getModel(),this._editor.isSimpleWidget?MenuId.SimpleEditorContext:MenuId.EditorContext);ot.length>0&&this._doShowContextMenu(ot,nt)}_getMenuActions(nt,ot){const rt=[],ut=this._menuService.createMenu(ot,this._contextKeyService),gt=ut.getActions({arg:nt.uri});ut.dispose();for(const pt of gt){const[,mt]=pt;let vt=0;for(const St of mt)if(St instanceof SubmenuItemAction){const yt=this._getMenuActions(nt,St.item.submenu);yt.length>0&&(rt.push(new SubmenuAction(St.id,St.label,yt)),vt++)}else rt.push(St),vt++;vt&&rt.push(new Separator)}return rt.length&&rt.pop(),rt}_doShowContextMenu(nt,ot=null){if(!this._editor.hasModel())return;const rt=this._editor.getOption(58);if(this._editor.updateOptions({hover:{enabled:!1}}),!ot){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();const gt=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),pt=getDomNodePagePosition(this._editor.getDomNode()),mt=pt.left+gt.left,vt=pt.top+gt.top+gt.height;ot={x:mt,y:vt}}const ut=this._editor.getOption(122)&&!isIOS;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:ut?this._editor.getDomNode():void 0,getAnchor:()=>ot,getActions:()=>nt,getActionViewItem:gt=>{const pt=this._keybindingFor(gt);if(pt)return new ActionViewItem(gt,gt,{label:!0,keybinding:pt.getLabel(),isMenu:!0});const mt=gt;return typeof mt.getActionViewItem=="function"?mt.getActionViewItem():new ActionViewItem(gt,gt,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:gt=>this._keybindingFor(gt),onHide:gt=>{this._contextMenuIsBeingShownCount--,this._editor.updateOptions({hover:rt})}})}_showScrollbarContextMenu(nt){if(!this._editor.hasModel()||isStandaloneEditorWorkspace(this._workspaceContextService.getWorkspace()))return;const ot=this._editor.getOption(70);let rt=0;const ut=St=>({id:`menu-action-${++rt}`,label:St.label,tooltip:"",class:void 0,enabled:typeof St.enabled>"u"?!0:St.enabled,checked:St.checked,run:St.run}),gt=(St,yt)=>new SubmenuAction(`menu-action-${++rt}`,St,yt,void 0),pt=(St,yt,wt,Lt,xt)=>{if(!yt)return ut({label:St,enabled:yt,run:()=>{}});const It=At=>()=>{this._configurationService.updateValue(wt,At)},kt=[];for(const At of xt)kt.push(ut({label:At.label,checked:Lt===At.value,run:It(At.value)}));return gt(St,kt)},mt=[];mt.push(ut({label:localize("context.minimap.minimap","Minimap"),checked:ot.enabled,run:()=>{this._configurationService.updateValue("editor.minimap.enabled",!ot.enabled)}})),mt.push(new Separator),mt.push(ut({label:localize("context.minimap.renderCharacters","Render Characters"),enabled:ot.enabled,checked:ot.renderCharacters,run:()=>{this._configurationService.updateValue("editor.minimap.renderCharacters",!ot.renderCharacters)}})),mt.push(pt(localize("context.minimap.size","Vertical size"),ot.enabled,"editor.minimap.size",ot.size,[{label:localize("context.minimap.size.proportional","Proportional"),value:"proportional"},{label:localize("context.minimap.size.fill","Fill"),value:"fill"},{label:localize("context.minimap.size.fit","Fit"),value:"fit"}])),mt.push(pt(localize("context.minimap.slider","Slider"),ot.enabled,"editor.minimap.showSlider",ot.showSlider,[{label:localize("context.minimap.slider.mouseover","Mouse Over"),value:"mouseover"},{label:localize("context.minimap.slider.always","Always"),value:"always"}]));const vt=this._editor.getOption(122)&&!isIOS;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:vt?this._editor.getDomNode():void 0,getAnchor:()=>nt,getActions:()=>mt,onHide:St=>{this._contextMenuIsBeingShownCount--,this._editor.focus()}})}_keybindingFor(nt){return this._keybindingService.lookupKeybinding(nt.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}};ContextMenuController.ID="editor.contrib.contextmenu";ContextMenuController=__decorate$V([__param$V(1,IContextMenuService),__param$V(2,IContextViewService),__param$V(3,IContextKeyService),__param$V(4,IKeybindingService),__param$V(5,IMenuService),__param$V(6,IConfigurationService),__param$V(7,IWorkspaceContextService)],ContextMenuController);class ShowContextMenu extends EditorAction{constructor(){super({id:"editor.action.showContextMenu",label:localize("action.showContextMenu.label","Show Editor Context Menu"),alias:"Show Editor Context Menu",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:1092,weight:100}})}run(nt,ot){var rt;(rt=ContextMenuController.get(ot))===null||rt===void 0||rt.showContextMenu()}}registerEditorContribution(ContextMenuController.ID,ContextMenuController,2);registerEditorAction(ShowContextMenu);class CursorState{constructor(nt){this.selections=nt}equals(nt){const ot=this.selections.length,rt=nt.selections.length;if(ot!==rt)return!1;for(let ut=0;ut<ot;ut++)if(!this.selections[ut].equalsSelection(nt.selections[ut]))return!1;return!0}}class StackElement{constructor(nt,ot,rt){this.cursorState=nt,this.scrollTop=ot,this.scrollLeft=rt}}class CursorUndoRedoController extends Disposable{static get(nt){return nt.getContribution(CursorUndoRedoController.ID)}constructor(nt){super(),this._editor=nt,this._isCursorUndoRedo=!1,this._undoStack=[],this._redoStack=[],this._register(nt.onDidChangeModel(ot=>{this._undoStack=[],this._redoStack=[]})),this._register(nt.onDidChangeModelContent(ot=>{this._undoStack=[],this._redoStack=[]})),this._register(nt.onDidChangeCursorSelection(ot=>{if(this._isCursorUndoRedo||!ot.oldSelections||ot.oldModelVersionId!==ot.modelVersionId)return;const rt=new CursorState(ot.oldSelections);this._undoStack.length>0&&this._undoStack[this._undoStack.length-1].cursorState.equals(rt)||(this._undoStack.push(new StackElement(rt,nt.getScrollTop(),nt.getScrollLeft())),this._redoStack=[],this._undoStack.length>50&&this._undoStack.shift())}))}cursorUndo(){!this._editor.hasModel()||this._undoStack.length===0||(this._redoStack.push(new StackElement(new CursorState(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._undoStack.pop()))}cursorRedo(){!this._editor.hasModel()||this._redoStack.length===0||(this._undoStack.push(new StackElement(new CursorState(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._redoStack.pop()))}_applyState(nt){this._isCursorUndoRedo=!0,this._editor.setSelections(nt.cursorState.selections),this._editor.setScrollPosition({scrollTop:nt.scrollTop,scrollLeft:nt.scrollLeft}),this._isCursorUndoRedo=!1}}CursorUndoRedoController.ID="editor.contrib.cursorUndoRedoController";class CursorUndo extends EditorAction{constructor(){super({id:"cursorUndo",label:localize("cursor.undo","Cursor Undo"),alias:"Cursor Undo",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2099,weight:100}})}run(nt,ot,rt){var ut;(ut=CursorUndoRedoController.get(ot))===null||ut===void 0||ut.cursorUndo()}}class CursorRedo extends EditorAction{constructor(){super({id:"cursorRedo",label:localize("cursor.redo","Cursor Redo"),alias:"Cursor Redo",precondition:void 0})}run(nt,ot,rt){var ut;(ut=CursorUndoRedoController.get(ot))===null||ut===void 0||ut.cursorRedo()}}registerEditorContribution(CursorUndoRedoController.ID,CursorUndoRedoController,0);registerEditorAction(CursorUndo);registerEditorAction(CursorRedo);const dnd="";class DragAndDropCommand{constructor(nt,ot,rt){this.selection=nt,this.targetPosition=ot,this.copy=rt,this.targetSelection=null}getEditOperations(nt,ot){const rt=nt.getValueInRange(this.selection);if(this.copy||ot.addEditOperation(this.selection,null),ot.addEditOperation(new Range$2(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),rt),this.selection.containsPosition(this.targetPosition)&&!(this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition)))){this.targetSelection=this.selection;return}if(this.copy){this.targetSelection=new Selection$1(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber>this.selection.endLineNumber){this.targetSelection=new Selection$1(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber<this.selection.endLineNumber){this.targetSelection=new Selection$1(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new Selection$1(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column-this.selection.endColumn+this.selection.startColumn:this.targetPosition.column-this.selection.endColumn+this.selection.startColumn,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new Selection$1(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn)}computeCursorState(nt,ot){return this.targetSelection}}function hasTriggerModifier(ct){return isMacintosh?ct.altKey:ct.ctrlKey}class DragAndDropController extends Disposable{constructor(nt){super(),this._editor=nt,this._dndDecorationIds=this._editor.createDecorationsCollection(),this._register(this._editor.onMouseDown(ot=>this._onEditorMouseDown(ot))),this._register(this._editor.onMouseUp(ot=>this._onEditorMouseUp(ot))),this._register(this._editor.onMouseDrag(ot=>this._onEditorMouseDrag(ot))),this._register(this._editor.onMouseDrop(ot=>this._onEditorMouseDrop(ot))),this._register(this._editor.onMouseDropCanceled(()=>this._onEditorMouseDropCanceled())),this._register(this._editor.onKeyDown(ot=>this.onEditorKeyDown(ot))),this._register(this._editor.onKeyUp(ot=>this.onEditorKeyUp(ot))),this._register(this._editor.onDidBlurEditorWidget(()=>this.onEditorBlur())),this._register(this._editor.onDidBlurEditorText(()=>this.onEditorBlur())),this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(nt){!this._editor.getOption(33)||this._editor.getOption(20)||(hasTriggerModifier(nt)&&(this._modifierPressed=!0),this._mouseDown&&hasTriggerModifier(nt)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(nt){!this._editor.getOption(33)||this._editor.getOption(20)||(hasTriggerModifier(nt)&&(this._modifierPressed=!1),this._mouseDown&&nt.keyCode===DragAndDropController.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(nt){this._mouseDown=!0}_onEditorMouseUp(nt){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(nt){const ot=nt.target;if(this._dragSelection===null){const ut=(this._editor.getSelections()||[]).filter(gt=>ot.position&&gt.containsPosition(ot.position));if(ut.length===1)this._dragSelection=ut[0];else return}hasTriggerModifier(nt.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),ot.position&&(this._dragSelection.containsPosition(ot.position)?this._removeDecoration():this.showAt(ot.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(nt){if(nt.target&&(this._hitContent(nt.target)||this._hitMargin(nt.target))&&nt.target.position){const ot=new Position$1(nt.target.position.lineNumber,nt.target.position.column);if(this._dragSelection===null){let rt=null;if(nt.event.shiftKey){const ut=this._editor.getSelection();if(ut){const{selectionStartLineNumber:gt,selectionStartColumn:pt}=ut;rt=[new Selection$1(gt,pt,ot.lineNumber,ot.column)]}}else rt=(this._editor.getSelections()||[]).map(ut=>ut.containsPosition(ot)?new Selection$1(ot.lineNumber,ot.column,ot.lineNumber,ot.column):ut);this._editor.setSelections(rt||[],"mouse",3)}else(!this._dragSelection.containsPosition(ot)||(hasTriggerModifier(nt.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(ot)||this._dragSelection.getStartPosition().equals(ot)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(DragAndDropController.ID,new DragAndDropCommand(this._dragSelection,ot,hasTriggerModifier(nt.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(nt){this._dndDecorationIds.set([{range:new Range$2(nt.lineNumber,nt.column,nt.lineNumber,nt.column),options:DragAndDropController._DECORATION_OPTIONS}]),this._editor.revealPosition(nt,1)}_removeDecoration(){this._dndDecorationIds.clear()}_hitContent(nt){return nt.type===6||nt.type===7}_hitMargin(nt){return nt.type===2||nt.type===3||nt.type===4}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}}DragAndDropController.ID="editor.contrib.dragAndDrop";DragAndDropController.TRIGGER_KEY_VALUE=isMacintosh?6:5;DragAndDropController._DECORATION_OPTIONS=ModelDecorationOptions.register({description:"dnd-target",className:"dnd-target"});registerEditorContribution(DragAndDropController.ID,DragAndDropController,2);class TreeViewsDnDService{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(nt){if(nt&&this._dragOperations.has(nt)){const ot=this._dragOperations.get(nt);return this._dragOperations.delete(nt),ot}}}class DraggedTreeItemsIdentifier{constructor(nt){this.identifier=nt}}const ITreeViewsDnDService=createDecorator("treeViewsDndService");registerSingleton(ITreeViewsDnDService,TreeViewsDnDService,1);const postDropWidget="";var __decorate$U=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$U=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const changeDropTypeCommandId="editor.changeDropType",dropWidgetVisibleCtx=new RawContextKey("dropWidgetVisible",!1,localize("dropWidgetVisible","Whether the drop widget is showing"));let PostDropWidget=class Lr extends Disposable{constructor(nt,ot,rt,ut,gt,pt,mt){super(),this.editor=nt,this.range=ot,this.edits=rt,this.onSelectNewEdit=ut,this._contextMenuService=gt,this._keybindingService=mt,this.allowEditorOverflow=!0,this.suppressMouseDown=!0,this.create(),this.dropWidgetVisible=dropWidgetVisibleCtx.bindTo(pt),this.dropWidgetVisible.set(!0),this._register(toDisposable(()=>this.dropWidgetVisible.reset())),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this),this._register(toDisposable(()=>this.editor.removeContentWidget(this))),this._register(this.editor.onDidChangeCursorPosition(vt=>{ot.containsPosition(vt.position)||this.dispose()})),this._register(Event.runAndSubscribe(mt.onDidUpdateKeybindings,()=>{this._updateButtonTitle()}))}_updateButtonTitle(){var nt;const ot=(nt=this._keybindingService.lookupKeybinding(changeDropTypeCommandId))===null||nt===void 0?void 0:nt.getLabel();this.button.element.title=ot?localize("postDropWidgetTitleWithBinding","Show drop options... ({0})",ot):localize("postDropWidgetTitle","Show drop options...")}create(){this.domNode=$$d(".post-drop-widget"),this.button=this._register(new Button(this.domNode,{supportIcons:!0})),this.button.label="$(insert)",this._register(addDisposableListener(this.domNode,EventType$1.CLICK,()=>this.showDropSelector()))}getId(){return Lr.ID}getDomNode(){return this.domNode}getPosition(){return{position:this.range.getEndPosition(),preference:[2]}}showDropSelector(){this._contextMenuService.showContextMenu({getAnchor:()=>{const nt=getDomNodePagePosition(this.button.element);return{x:nt.left+nt.width,y:nt.top+nt.height}},getActions:()=>this.edits.allEdits.map((nt,ot)=>toAction({id:"",label:nt.label,checked:ot===this.edits.activeEditIndex,run:()=>{if(ot!==this.edits.activeEditIndex)return this.onSelectNewEdit(ot)}}))})}};PostDropWidget.ID="editor.widget.postDropWidget";PostDropWidget=__decorate$U([__param$U(4,IContextMenuService),__param$U(5,IContextKeyService),__param$U(6,IKeybindingService)],PostDropWidget);let PostDropWidgetManager=class extends Disposable{constructor(nt,ot){super(),this._editor=nt,this._instantiationService=ot,this._currentWidget=this._register(new MutableDisposable),this._register(Event.any(nt.onDidChangeModel,nt.onDidChangeModelContent)(()=>this.clear()))}show(nt,ot,rt){this.clear(),this._editor.hasModel()&&(this._currentWidget.value=this._instantiationService.createInstance(PostDropWidget,this._editor,nt,ot,rt))}clear(){this._currentWidget.clear()}changeExistingDropType(){var nt;(nt=this._currentWidget.value)===null||nt===void 0||nt.showDropSelector()}};PostDropWidgetManager=__decorate$U([__param$U(1,IInstantiationService)],PostDropWidgetManager);var __decorate$T=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$T=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$C=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class DefaultTextDropProvider{constructor(){this.dropMimeTypes=[Mimes.text,"text"]}provideDocumentOnDropEdits(nt,ot,rt,ut){var gt;return __awaiter$C(this,void 0,void 0,function*(){const pt=(gt=rt.get("text"))!==null&&gt!==void 0?gt:rt.get(Mimes.text);if(!pt||rt.has(Mimes.uriList))return;const mt=yield pt.asString();return{label:localize("defaultDropProvider.text.label","Insert Plain Text"),insertText:mt}})}}class UriListDropProvider{constructor(){this.dropMimeTypes=[Mimes.uriList]}provideDocumentOnDropEdits(nt,ot,rt,ut){return __awaiter$C(this,void 0,void 0,function*(){const gt=yield extractUriList(rt);if(!gt.length||ut.isCancellationRequested)return;let pt=0;const mt=gt.map(({uri:St,originalText:yt})=>St.scheme===Schemas.file?St.fsPath:(pt++,yt)).join(" ");let vt;return pt>0?vt=gt.length>1?localize("defaultDropProvider.uriList.uris","Insert Uris"):localize("defaultDropProvider.uriList.uri","Insert Uri"):vt=gt.length>1?localize("defaultDropProvider.uriList.paths","Insert Paths"):localize("defaultDropProvider.uriList.path","Insert Path"),{insertText:mt,label:vt}})}}let RelativePathDropProvider=class{constructor(nt){this._workspaceContextService=nt,this.dropMimeTypes=[Mimes.uriList]}provideDocumentOnDropEdits(nt,ot,rt,ut){return __awaiter$C(this,void 0,void 0,function*(){const gt=yield extractUriList(rt);if(!gt.length||ut.isCancellationRequested)return;const pt=coalesce(gt.map(({uri:mt})=>{const vt=this._workspaceContextService.getWorkspaceFolder(mt);return vt?relativePath(vt.uri,mt):void 0}));if(pt.length)return{insertText:pt.join(" "),label:gt.length>1?localize("defaultDropProvider.uriList.relativePaths","Insert Relative Paths"):localize("defaultDropProvider.uriList.relativePath","Insert Relative Path")}})}};RelativePathDropProvider=__decorate$T([__param$T(0,IWorkspaceContextService)],RelativePathDropProvider);function extractUriList(ct){return __awaiter$C(this,void 0,void 0,function*(){const nt=ct.get(Mimes.uriList);if(!nt)return[];const ot=yield nt.asString(),rt=[];for(const ut of UriList.parse(ot))try{rt.push({uri:URI.parse(ut),originalText:ut})}catch{}return rt})}let registeredDefaultProviders=!1;function registerDefaultDropProviders(ct,nt){registeredDefaultProviders||(registeredDefaultProviders=!0,ct.documentOnDropEditProvider.register("*",new DefaultTextDropProvider),ct.documentOnDropEditProvider.register("*",new UriListDropProvider),ct.documentOnDropEditProvider.register("*",new RelativePathDropProvider(nt)))}var __decorate$S=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$S=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$B=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let DropIntoEditorController=class Dr extends Disposable{static get(nt){return nt.getContribution(Dr.ID)}constructor(nt,ot,rt,ut,gt,pt){super(),this._bulkEditService=ut,this._languageFeaturesService=gt,this._treeViewsDragAndDropService=pt,this.operationIdPool=0,this.treeItemsTransfer=LocalSelectionTransfer.getInstance(),this._dropProgressManager=this._register(ot.createInstance(InlineProgressManager,"dropIntoEditor",nt)),this._postDropWidgetManager=this._register(ot.createInstance(PostDropWidgetManager,nt)),this._register(nt.onDropIntoEditor(mt=>this.onDropIntoEditor(nt,mt.position,mt.event))),registerDefaultDropProviders(this._languageFeaturesService,rt)}changeDropType(){this._postDropWidgetManager.changeExistingDropType()}onDropIntoEditor(nt,ot,rt){var ut;return __awaiter$B(this,void 0,void 0,function*(){if(!rt.dataTransfer||!nt.hasModel())return;(ut=this._currentOperation)===null||ut===void 0||ut.promise.cancel(),this._dropProgressManager.clear(),nt.focus(),nt.setPosition(ot);const gt=this.operationIdPool++,pt=createCancelablePromise(mt=>__awaiter$B(this,void 0,void 0,function*(){var vt;const St=new EditorStateCancellationTokenSource(nt,1,void 0,mt);this._dropProgressManager.setAtPosition(ot,localize("dropIntoEditorProgress","Running drop handlers. Click to cancel"),{cancel:()=>St.cancel()});try{const yt=yield this.extractDataTransferData(rt);if(yt.size===0||St.token.isCancellationRequested)return;const wt=nt.getModel();if(!wt)return;const Lt=this._languageFeaturesService.documentOnDropEditProvider.ordered(wt).filter(It=>It.dropMimeTypes?It.dropMimeTypes.some(kt=>yt.matches(kt)):!0),xt=yield raceCancellation(Promise.all(Lt.map(It=>It.provideDocumentOnDropEdits(wt,ot,yt,St.token))),St.token);if(St.token.isCancellationRequested)return;xt&&(yield this.applyDropResult(nt,ot,0,coalesce(xt),mt))}finally{St.dispose(),((vt=this._currentOperation)===null||vt===void 0?void 0:vt.id)===gt&&(this._dropProgressManager.clear(),this._currentOperation=void 0)}}));this._currentOperation={id:gt,promise:pt}})}extractDataTransferData(nt){return __awaiter$B(this,void 0,void 0,function*(){if(!nt.dataTransfer)return new VSDataTransfer;const ot=toVSDataTransfer(nt.dataTransfer);if(addExternalEditorsDropData(ot,nt),this.treeItemsTransfer.hasData(DraggedTreeItemsIdentifier.prototype)){const rt=this.treeItemsTransfer.getData(DraggedTreeItemsIdentifier.prototype);if(Array.isArray(rt))for(const ut of rt){const gt=yield this._treeViewsDragAndDropService.removeDragOperationTransfer(ut.identifier);if(gt)for(const[pt,mt]of gt.entries())ot.replace(pt,mt)}}return ot})}applyDropResult(nt,ot,rt,ut,gt){var pt,mt;return __awaiter$B(this,void 0,void 0,function*(){const vt=nt.getModel();if(!vt)return;const St=ut[rt];if(!St)return;const yt=typeof St.insertText=="string"?SnippetParser.escape(St.insertText):St.insertText.snippet,wt={edits:[new ResourceTextEdit(vt.uri,{range:Range$2.fromPositions(ot),text:yt,insertAsSnippet:!0}),...(mt=(pt=St.additionalEdit)===null||pt===void 0?void 0:pt.edits)!==null&&mt!==void 0?mt:[]]},Lt=vt.deltaDecorations([],[{range:Range$2.fromPositions(ot),options:{description:"drop-line-suffix",stickiness:0}}]),xt=yield this._bulkEditService.apply(wt,{editor:nt,token:gt}),It=vt.getDecorationRange(Lt[0]);vt.deltaDecorations(Lt,[]),xt.isApplied&&ut.length>1&&nt.getOptions().get(34).showDropSelector==="afterDrop"&&this._postDropWidgetManager.show(It??Range$2.fromPositions(ot),{activeEditIndex:rt,allEdits:ut},At=>__awaiter$B(this,void 0,void 0,function*(){yield vt.undo(),this.applyDropResult(nt,ot,At,ut,gt)}))})}};DropIntoEditorController.ID="editor.contrib.dropIntoEditorController";DropIntoEditorController=__decorate$S([__param$S(1,IInstantiationService),__param$S(2,IWorkspaceContextService),__param$S(3,IBulkEditService),__param$S(4,ILanguageFeaturesService),__param$S(5,ITreeViewsDnDService)],DropIntoEditorController);registerEditorContribution(DropIntoEditorController.ID,DropIntoEditorController,2);registerEditorCommand(new class extends EditorCommand{constructor(){super({id:changeDropTypeCommandId,precondition:dropWidgetVisibleCtx,kbOpts:{weight:100,primary:2137}})}runEditorCommand(ct,nt,ot){var rt;(rt=DropIntoEditorController.get(nt))===null||rt===void 0||rt.changeDropType()}});class FindDecorations{constructor(nt){this._editor=nt,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.removeDecorations(this._allDecorations()),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const nt=this._findScopeDecorationIds.map(ot=>this._editor.getModel().getDecorationRange(ot)).filter(ot=>!!ot);if(nt.length)return nt}return null}getStartPosition(){return this._startPosition}setStartPosition(nt){this._startPosition=nt,this.setCurrentFindMatch(null)}_getDecorationIndex(nt){const ot=this._decorations.indexOf(nt);return ot>=0?ot+1:1}getDecorationRangeAt(nt){const ot=nt<this._decorations.length?this._decorations[nt]:null;return ot?this._editor.getModel().getDecorationRange(ot):null}getCurrentMatchesPosition(nt){const ot=this._editor.getModel().getDecorationsInRange(nt);for(const rt of ot){const ut=rt.options;if(ut===FindDecorations._FIND_MATCH_DECORATION||ut===FindDecorations._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(rt.id)}return 0}setCurrentFindMatch(nt){let ot=null,rt=0;if(nt)for(let ut=0,gt=this._decorations.length;ut<gt;ut++){const pt=this._editor.getModel().getDecorationRange(this._decorations[ut]);if(nt.equalsRange(pt)){ot=this._decorations[ut],rt=ut+1;break}}return(this._highlightedDecorationId!==null||ot!==null)&&this._editor.changeDecorations(ut=>{if(this._highlightedDecorationId!==null&&(ut.changeDecorationOptions(this._highlightedDecorationId,FindDecorations._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),ot!==null&&(this._highlightedDecorationId=ot,ut.changeDecorationOptions(this._highlightedDecorationId,FindDecorations._CURRENT_FIND_MATCH_DECORATION)),this._rangeHighlightDecorationId!==null&&(ut.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),ot!==null){let gt=this._editor.getModel().getDecorationRange(ot);if(gt.startLineNumber!==gt.endLineNumber&&gt.endColumn===1){const pt=gt.endLineNumber-1,mt=this._editor.getModel().getLineMaxColumn(pt);gt=new Range$2(gt.startLineNumber,gt.startColumn,pt,mt)}this._rangeHighlightDecorationId=ut.addDecoration(gt,FindDecorations._RANGE_HIGHLIGHT_DECORATION)}}),rt}set(nt,ot){this._editor.changeDecorations(rt=>{let ut=FindDecorations._FIND_MATCH_DECORATION;const gt=[];if(nt.length>1e3){ut=FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION;const mt=this._editor.getModel().getLineCount(),St=this._editor.getLayoutInfo().height/mt,yt=Math.max(2,Math.ceil(3/St));let wt=nt[0].range.startLineNumber,Lt=nt[0].range.endLineNumber;for(let xt=1,It=nt.length;xt<It;xt++){const kt=nt[xt].range;Lt+yt>=kt.startLineNumber?kt.endLineNumber>Lt&&(Lt=kt.endLineNumber):(gt.push({range:new Range$2(wt,1,Lt,1),options:FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),wt=kt.startLineNumber,Lt=kt.endLineNumber)}gt.push({range:new Range$2(wt,1,Lt,1),options:FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}const pt=new Array(nt.length);for(let mt=0,vt=nt.length;mt<vt;mt++)pt[mt]={range:nt[mt].range,options:ut};this._decorations=rt.deltaDecorations(this._decorations,pt),this._overviewRulerApproximateDecorations=rt.deltaDecorations(this._overviewRulerApproximateDecorations,gt),this._rangeHighlightDecorationId&&(rt.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach(mt=>rt.removeDecoration(mt)),this._findScopeDecorationIds=[]),ot!=null&&ot.length&&(this._findScopeDecorationIds=ot.map(mt=>rt.addDecoration(mt,FindDecorations._FIND_SCOPE_DECORATION)))})}matchBeforePosition(nt){if(this._decorations.length===0)return null;for(let ot=this._decorations.length-1;ot>=0;ot--){const rt=this._decorations[ot],ut=this._editor.getModel().getDecorationRange(rt);if(!(!ut||ut.endLineNumber>nt.lineNumber)){if(ut.endLineNumber<nt.lineNumber)return ut;if(!(ut.endColumn>nt.column))return ut}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(nt){if(this._decorations.length===0)return null;for(let ot=0,rt=this._decorations.length;ot<rt;ot++){const ut=this._decorations[ot],gt=this._editor.getModel().getDecorationRange(ut);if(!(!gt||gt.startLineNumber<nt.lineNumber)){if(gt.startLineNumber>nt.lineNumber)return gt;if(!(gt.startColumn<nt.column))return gt}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let nt=[];return nt=nt.concat(this._decorations),nt=nt.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&nt.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&nt.push(this._rangeHighlightDecorationId),nt}}FindDecorations._CURRENT_FIND_MATCH_DECORATION=ModelDecorationOptions.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:themeColorFromId(overviewRulerFindMatchForeground),position:OverviewRulerLane.Center},minimap:{color:themeColorFromId(minimapFindMatch),position:MinimapPosition.Inline}});FindDecorations._FIND_MATCH_DECORATION=ModelDecorationOptions.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:themeColorFromId(overviewRulerFindMatchForeground),position:OverviewRulerLane.Center},minimap:{color:themeColorFromId(minimapFindMatch),position:MinimapPosition.Inline}});FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION=ModelDecorationOptions.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0});FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION=ModelDecorationOptions.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:themeColorFromId(overviewRulerFindMatchForeground),position:OverviewRulerLane.Center}});FindDecorations._RANGE_HIGHLIGHT_DECORATION=ModelDecorationOptions.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0});FindDecorations._FIND_SCOPE_DECORATION=ModelDecorationOptions.register({description:"find-scope",className:"findScope",isWholeLine:!0});class ReplaceAllCommand{constructor(nt,ot,rt){this._editorSelection=nt,this._ranges=ot,this._replaceStrings=rt,this._trackedEditorSelectionId=null}getEditOperations(nt,ot){if(this._ranges.length>0){const rt=[];for(let pt=0;pt<this._ranges.length;pt++)rt.push({range:this._ranges[pt],text:this._replaceStrings[pt]});rt.sort((pt,mt)=>Range$2.compareRangesUsingStarts(pt.range,mt.range));const ut=[];let gt=rt[0];for(let pt=1;pt<rt.length;pt++)gt.range.endLineNumber===rt[pt].range.startLineNumber&&gt.range.endColumn===rt[pt].range.startColumn?(gt.range=gt.range.plusRange(rt[pt].range),gt.text=gt.text+rt[pt].text):(ut.push(gt),gt=rt[pt]);ut.push(gt);for(const pt of ut)ot.addEditOperation(pt.range,pt.text)}this._trackedEditorSelectionId=ot.trackSelection(this._editorSelection)}computeCursorState(nt,ot){return ot.getTrackedSelection(this._trackedEditorSelectionId)}}function buildReplaceStringWithCasePreserved(ct,nt){if(ct&&ct[0]!==""){const ot=validateSpecificSpecialCharacter(ct,nt,"-"),rt=validateSpecificSpecialCharacter(ct,nt,"_");return ot&&!rt?buildReplaceStringForSpecificSpecialCharacter(ct,nt,"-"):!ot&&rt?buildReplaceStringForSpecificSpecialCharacter(ct,nt,"_"):ct[0].toUpperCase()===ct[0]?nt.toUpperCase():ct[0].toLowerCase()===ct[0]?nt.toLowerCase():containsUppercaseCharacter(ct[0][0])&&nt.length>0?nt[0].toUpperCase()+nt.substr(1):ct[0][0].toUpperCase()!==ct[0][0]&&nt.length>0?nt[0].toLowerCase()+nt.substr(1):nt}else return nt}function validateSpecificSpecialCharacter(ct,nt,ot){return ct[0].indexOf(ot)!==-1&&nt.indexOf(ot)!==-1&&ct[0].split(ot).length===nt.split(ot).length}function buildReplaceStringForSpecificSpecialCharacter(ct,nt,ot){const rt=nt.split(ot),ut=ct[0].split(ot);let gt="";return rt.forEach((pt,mt)=>{gt+=buildReplaceStringWithCasePreserved([ut[mt]],pt)+ot}),gt.slice(0,-1)}class StaticValueReplacePattern{constructor(nt){this.staticValue=nt,this.kind=0}}class DynamicPiecesReplacePattern{constructor(nt){this.pieces=nt,this.kind=1}}class ReplacePattern{static fromStaticValue(nt){return new ReplacePattern([ReplacePiece.staticValue(nt)])}get hasReplacementPatterns(){return this._state.kind===1}constructor(nt){!nt||nt.length===0?this._state=new StaticValueReplacePattern(""):nt.length===1&&nt[0].staticValue!==null?this._state=new StaticValueReplacePattern(nt[0].staticValue):this._state=new DynamicPiecesReplacePattern(nt)}buildReplaceString(nt,ot){if(this._state.kind===0)return ot?buildReplaceStringWithCasePreserved(nt,this._state.staticValue):this._state.staticValue;let rt="";for(let ut=0,gt=this._state.pieces.length;ut<gt;ut++){const pt=this._state.pieces[ut];if(pt.staticValue!==null){rt+=pt.staticValue;continue}let mt=ReplacePattern._substitute(pt.matchIndex,nt);if(pt.caseOps!==null&&pt.caseOps.length>0){const vt=[],St=pt.caseOps.length;let yt=0;for(let wt=0,Lt=mt.length;wt<Lt;wt++){if(yt>=St){vt.push(mt.slice(wt));break}switch(pt.caseOps[yt]){case"U":vt.push(mt[wt].toUpperCase());break;case"u":vt.push(mt[wt].toUpperCase()),yt++;break;case"L":vt.push(mt[wt].toLowerCase());break;case"l":vt.push(mt[wt].toLowerCase()),yt++;break;default:vt.push(mt[wt])}}mt=vt.join("")}rt+=mt}return rt}static _substitute(nt,ot){if(ot===null)return"";if(nt===0)return ot[0];let rt="";for(;nt>0;){if(nt<ot.length)return(ot[nt]||"")+rt;rt=String(nt%10)+rt,nt=Math.floor(nt/10)}return"$"+rt}}class ReplacePiece{static staticValue(nt){return new ReplacePiece(nt,-1,null)}static caseOps(nt,ot){return new ReplacePiece(null,nt,ot)}constructor(nt,ot,rt){this.staticValue=nt,this.matchIndex=ot,!rt||rt.length===0?this.caseOps=null:this.caseOps=rt.slice(0)}}class ReplacePieceBuilder{constructor(nt){this._source=nt,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(nt){this._emitStatic(this._source.substring(this._lastCharIndex,nt)),this._lastCharIndex=nt}emitStatic(nt,ot){this._emitStatic(nt),this._lastCharIndex=ot}_emitStatic(nt){nt.length!==0&&(this._currentStaticPiece+=nt)}emitMatchIndex(nt,ot,rt){this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=ReplacePiece.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=ReplacePiece.caseOps(nt,rt),this._lastCharIndex=ot}finalize(){return this.emitUnchanged(this._source.length),this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=ReplacePiece.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new ReplacePattern(this._result)}}function parseReplaceString(ct){if(!ct||ct.length===0)return new ReplacePattern(null);const nt=[],ot=new ReplacePieceBuilder(ct);for(let rt=0,ut=ct.length;rt<ut;rt++){const gt=ct.charCodeAt(rt);if(gt===92){if(rt++,rt>=ut)break;const pt=ct.charCodeAt(rt);switch(pt){case 92:ot.emitUnchanged(rt-1),ot.emitStatic("\\",rt+1);break;case 110:ot.emitUnchanged(rt-1),ot.emitStatic(`
`,rt+1);break;case 116:ot.emitUnchanged(rt-1),ot.emitStatic("	",rt+1);break;case 117:case 85:case 108:case 76:ot.emitUnchanged(rt-1),ot.emitStatic("",rt+1),nt.push(String.fromCharCode(pt));break}continue}if(gt===36){if(rt++,rt>=ut)break;const pt=ct.charCodeAt(rt);if(pt===36){ot.emitUnchanged(rt-1),ot.emitStatic("$",rt+1);continue}if(pt===48||pt===38){ot.emitUnchanged(rt-1),ot.emitMatchIndex(0,rt+1,nt),nt.length=0;continue}if(49<=pt&&pt<=57){let mt=pt-48;if(rt+1<ut){const vt=ct.charCodeAt(rt+1);if(48<=vt&&vt<=57){rt++,mt=mt*10+(vt-48),ot.emitUnchanged(rt-2),ot.emitMatchIndex(mt,rt+1,nt),nt.length=0;continue}}ot.emitUnchanged(rt-1),ot.emitMatchIndex(mt,rt+1,nt),nt.length=0;continue}}}return ot.finalize()}const CONTEXT_FIND_WIDGET_VISIBLE=new RawContextKey("findWidgetVisible",!1);CONTEXT_FIND_WIDGET_VISIBLE.toNegated();const CONTEXT_FIND_INPUT_FOCUSED=new RawContextKey("findInputFocussed",!1),CONTEXT_REPLACE_INPUT_FOCUSED=new RawContextKey("replaceInputFocussed",!1),ToggleCaseSensitiveKeybinding={primary:545,mac:{primary:2593}},ToggleWholeWordKeybinding={primary:565,mac:{primary:2613}},ToggleRegexKeybinding={primary:560,mac:{primary:2608}},ToggleSearchScopeKeybinding={primary:554,mac:{primary:2602}},TogglePreserveCaseKeybinding={primary:558,mac:{primary:2606}},FIND_IDS={StartFindAction:"actions.find",StartFindWithSelection:"actions.findWithSelection",StartFindWithArgs:"editor.actions.findWithArgs",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",GoToMatchFindAction:"editor.action.goToMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",TogglePreserveCaseCommand:"togglePreserveCase",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches"},MATCHES_LIMIT=19999,RESEARCH_DELAY=240;class FindModelBoundToEditorModel{constructor(nt,ot){this._toDispose=new DisposableStore,this._editor=nt,this._state=ot,this._isDisposed=!1,this._startSearchingTimer=new TimeoutTimer,this._decorations=new FindDecorations(nt),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new RunOnceScheduler(()=>this.research(!1),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition(rt=>{(rt.reason===3||rt.reason===5||rt.reason===6)&&this._decorations.setStartPosition(this._editor.getPosition())})),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent(rt=>{this._ignoreModelContentChanged||(rt.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())})),this._toDispose.add(this._state.onFindReplaceStateChange(rt=>this._onStateChanged(rt))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,dispose(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(nt){this._isDisposed||this._editor.hasModel()&&(nt.searchString||nt.isReplaceRevealed||nt.isRegex||nt.wholeWord||nt.matchCase||nt.searchScope)&&(this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet(()=>{nt.searchScope?this.research(nt.moveCursor,this._state.searchScope):this.research(nt.moveCursor)},RESEARCH_DELAY)):nt.searchScope?this.research(nt.moveCursor,this._state.searchScope):this.research(nt.moveCursor))}static _getSearchRange(nt,ot){return ot||nt.getFullModelRange()}research(nt,ot){let rt=null;typeof ot<"u"?ot!==null&&(Array.isArray(ot)?rt=ot:rt=[ot]):rt=this._decorations.getFindScopes(),rt!==null&&(rt=rt.map(mt=>{if(mt.startLineNumber!==mt.endLineNumber){let vt=mt.endLineNumber;return mt.endColumn===1&&(vt=vt-1),new Range$2(mt.startLineNumber,1,vt,this._editor.getModel().getLineMaxColumn(vt))}return mt}));const ut=this._findMatches(rt,!1,MATCHES_LIMIT);this._decorations.set(ut,rt);const gt=this._editor.getSelection();let pt=this._decorations.getCurrentMatchesPosition(gt);if(pt===0&&ut.length>0){const mt=findFirstInSorted(ut.map(vt=>vt.range),vt=>Range$2.compareRangesUsingStarts(vt,gt)>=0);pt=mt>0?mt-1+1:pt}this._state.changeMatchInfo(pt,this._decorations.getCount(),void 0),nt&&this._editor.getOption(39).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){const nt=this._decorations.getFindScope();return nt&&this._editor.revealRangeInCenterIfOutsideViewport(nt,0),!0}return!1}_setCurrentFindMatch(nt){const ot=this._decorations.setCurrentFindMatch(nt);this._state.changeMatchInfo(ot,this._decorations.getCount(),nt),this._editor.setSelection(nt),this._editor.revealRangeInCenterIfOutsideViewport(nt,0)}_prevSearchPosition(nt){const ot=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:rt,column:ut}=nt;const gt=this._editor.getModel();return ot||ut===1?(rt===1?rt=gt.getLineCount():rt--,ut=gt.getLineMaxColumn(rt)):ut--,new Position$1(rt,ut)}_moveToPrevMatch(nt,ot=!1){if(!this._state.canNavigateBack()){const yt=this._decorations.matchAfterPosition(nt);yt&&this._setCurrentFindMatch(yt);return}if(this._decorations.getCount()<MATCHES_LIMIT){let yt=this._decorations.matchBeforePosition(nt);yt&&yt.isEmpty()&&yt.getStartPosition().equals(nt)&&(nt=this._prevSearchPosition(nt),yt=this._decorations.matchBeforePosition(nt)),yt&&this._setCurrentFindMatch(yt);return}if(this._cannotFind())return;const rt=this._decorations.getFindScope(),ut=FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(),rt);ut.getEndPosition().isBefore(nt)&&(nt=ut.getEndPosition()),nt.isBefore(ut.getStartPosition())&&(nt=ut.getEndPosition());const{lineNumber:gt,column:pt}=nt,mt=this._editor.getModel();let vt=new Position$1(gt,pt),St=mt.findPreviousMatch(this._state.searchString,vt,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(125):null,!1);if(St&&St.range.isEmpty()&&St.range.getStartPosition().equals(vt)&&(vt=this._prevSearchPosition(vt),St=mt.findPreviousMatch(this._state.searchString,vt,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(125):null,!1)),!!St){if(!ot&&!ut.containsRange(St.range))return this._moveToPrevMatch(St.range.getStartPosition(),!0);this._setCurrentFindMatch(St.range)}}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(nt){const ot=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:rt,column:ut}=nt;const gt=this._editor.getModel();return ot||ut===gt.getLineMaxColumn(rt)?(rt===gt.getLineCount()?rt=1:rt++,ut=1):ut++,new Position$1(rt,ut)}_moveToNextMatch(nt){if(!this._state.canNavigateForward()){const rt=this._decorations.matchBeforePosition(nt);rt&&this._setCurrentFindMatch(rt);return}if(this._decorations.getCount()<MATCHES_LIMIT){let rt=this._decorations.matchAfterPosition(nt);rt&&rt.isEmpty()&&rt.getStartPosition().equals(nt)&&(nt=this._nextSearchPosition(nt),rt=this._decorations.matchAfterPosition(nt)),rt&&this._setCurrentFindMatch(rt);return}const ot=this._getNextMatch(nt,!1,!0);ot&&this._setCurrentFindMatch(ot.range)}_getNextMatch(nt,ot,rt,ut=!1){if(this._cannotFind())return null;const gt=this._decorations.getFindScope(),pt=FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(),gt);pt.getEndPosition().isBefore(nt)&&(nt=pt.getStartPosition()),nt.isBefore(pt.getStartPosition())&&(nt=pt.getStartPosition());const{lineNumber:mt,column:vt}=nt,St=this._editor.getModel();let yt=new Position$1(mt,vt),wt=St.findNextMatch(this._state.searchString,yt,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(125):null,ot);return rt&&wt&&wt.range.isEmpty()&&wt.range.getStartPosition().equals(yt)&&(yt=this._nextSearchPosition(yt),wt=St.findNextMatch(this._state.searchString,yt,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(125):null,ot)),wt?!ut&&!pt.containsRange(wt.range)?this._getNextMatch(wt.range.getEndPosition(),ot,rt,!0):wt:null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_moveToMatch(nt){const ot=this._decorations.getDecorationRangeAt(nt);ot&&this._setCurrentFindMatch(ot)}moveToMatch(nt){this._moveToMatch(nt)}_getReplacePattern(){return this._state.isRegex?parseReplaceString(this._state.replaceString):ReplacePattern.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;const nt=this._getReplacePattern(),ot=this._editor.getSelection(),rt=this._getNextMatch(ot.getStartPosition(),!0,!1);if(rt)if(ot.equalsRange(rt.range)){const ut=nt.buildReplaceString(rt.matches,this._state.preserveCase),gt=new ReplaceCommand(ot,ut);this._executeEditorCommand("replace",gt),this._decorations.setStartPosition(new Position$1(ot.startLineNumber,ot.startColumn+ut.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(rt.range)}_findMatches(nt,ot,rt){const ut=(nt||[null]).map(gt=>FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(),gt));return this._editor.getModel().findMatches(this._state.searchString,ut,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(125):null,ot,rt)}replaceAll(){if(!this._hasMatches())return;const nt=this._decorations.getFindScopes();nt===null&&this._state.matchesCount>=MATCHES_LIMIT?this._largeReplaceAll():this._regularReplaceAll(nt),this.research(!1)}_largeReplaceAll(){const ot=new SearchParams(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(125):null).parseSearchRequest();if(!ot)return;let rt=ot.regex;if(!rt.multiline){let wt="mu";rt.ignoreCase&&(wt+="i"),rt.global&&(wt+="g"),rt=new RegExp(rt.source,wt)}const ut=this._editor.getModel(),gt=ut.getValue(1),pt=ut.getFullModelRange(),mt=this._getReplacePattern();let vt;const St=this._state.preserveCase;mt.hasReplacementPatterns||St?vt=gt.replace(rt,function(){return mt.buildReplaceString(arguments,St)}):vt=gt.replace(rt,mt.buildReplaceString(null,St));const yt=new ReplaceCommandThatPreservesSelection(pt,vt,this._editor.getSelection());this._executeEditorCommand("replaceAll",yt)}_regularReplaceAll(nt){const ot=this._getReplacePattern(),rt=this._findMatches(nt,ot.hasReplacementPatterns||this._state.preserveCase,1073741824),ut=[];for(let pt=0,mt=rt.length;pt<mt;pt++)ut[pt]=ot.buildReplaceString(rt[pt].matches,this._state.preserveCase);const gt=new ReplaceAllCommand(this._editor.getSelection(),rt.map(pt=>pt.range),ut);this._executeEditorCommand("replaceAll",gt)}selectAllMatches(){if(!this._hasMatches())return;const nt=this._decorations.getFindScopes();let rt=this._findMatches(nt,!1,1073741824).map(gt=>new Selection$1(gt.range.startLineNumber,gt.range.startColumn,gt.range.endLineNumber,gt.range.endColumn));const ut=this._editor.getSelection();for(let gt=0,pt=rt.length;gt<pt;gt++)if(rt[gt].equalsRange(ut)){rt=[ut].concat(rt.slice(0,gt)).concat(rt.slice(gt+1));break}this._editor.setSelections(rt)}_executeEditorCommand(nt,ot){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(nt,ot),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}const findOptionsWidget="";class FindOptionsWidget extends Widget$1{constructor(nt,ot,rt){super(),this._hideSoon=this._register(new RunOnceScheduler(()=>this._hide(),2e3)),this._isVisible=!1,this._editor=nt,this._state=ot,this._keybindingService=rt,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.style.zIndex="12",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const ut={inputActiveOptionBorder:asCssVariable(inputActiveOptionBorder),inputActiveOptionForeground:asCssVariable(inputActiveOptionForeground),inputActiveOptionBackground:asCssVariable(inputActiveOptionBackground)};this.caseSensitive=this._register(new CaseSensitiveToggle(Object.assign({appendTitle:this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase},ut))),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange(()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)})),this.wholeWords=this._register(new WholeWordsToggle(Object.assign({appendTitle:this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),isChecked:this._state.wholeWord},ut))),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange(()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)})),this.regex=this._register(new RegexToggle(Object.assign({appendTitle:this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),isChecked:this._state.isRegex},ut))),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange(()=>{this._state.change({isRegex:this.regex.checked},!1)})),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange(gt=>{let pt=!1;gt.isRegex&&(this.regex.checked=this._state.isRegex,pt=!0),gt.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,pt=!0),gt.matchCase&&(this.caseSensitive.checked=this._state.matchCase,pt=!0),!this._state.isRevealed&&pt&&this._revealTemporarily()})),this._register(addDisposableListener(this._domNode,EventType$1.MOUSE_LEAVE,gt=>this._onMouseLeave())),this._register(addDisposableListener(this._domNode,"mouseover",gt=>this._onMouseOver()))}_keybindingLabelFor(nt){const ot=this._keybindingService.lookupKeybinding(nt);return ot?` (${ot.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return FindOptionsWidget.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseLeave(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}}FindOptionsWidget.ID="editor.contrib.findOptionsWidget";function effectiveOptionValue(ct,nt){return ct===1?!0:ct===2?!1:nt}class FindReplaceState extends Disposable{get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return effectiveOptionValue(this._isRegexOverride,this._isRegex)}get wholeWord(){return effectiveOptionValue(this._wholeWordOverride,this._wholeWord)}get matchCase(){return effectiveOptionValue(this._matchCaseOverride,this._matchCase)}get preserveCase(){return effectiveOptionValue(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}constructor(){super(),this._onFindReplaceStateChange=this._register(new Emitter$2),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}changeMatchInfo(nt,ot,rt){const ut={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let gt=!1;ot===0&&(nt=0),nt>ot&&(nt=ot),this._matchesPosition!==nt&&(this._matchesPosition=nt,ut.matchesPosition=!0,gt=!0),this._matchesCount!==ot&&(this._matchesCount=ot,ut.matchesCount=!0,gt=!0),typeof rt<"u"&&(Range$2.equalsRange(this._currentMatch,rt)||(this._currentMatch=rt,ut.currentMatch=!0,gt=!0)),gt&&this._onFindReplaceStateChange.fire(ut)}change(nt,ot,rt=!0){var ut;const gt={moveCursor:ot,updateHistory:rt,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let pt=!1;const mt=this.isRegex,vt=this.wholeWord,St=this.matchCase,yt=this.preserveCase;typeof nt.searchString<"u"&&this._searchString!==nt.searchString&&(this._searchString=nt.searchString,gt.searchString=!0,pt=!0),typeof nt.replaceString<"u"&&this._replaceString!==nt.replaceString&&(this._replaceString=nt.replaceString,gt.replaceString=!0,pt=!0),typeof nt.isRevealed<"u"&&this._isRevealed!==nt.isRevealed&&(this._isRevealed=nt.isRevealed,gt.isRevealed=!0,pt=!0),typeof nt.isReplaceRevealed<"u"&&this._isReplaceRevealed!==nt.isReplaceRevealed&&(this._isReplaceRevealed=nt.isReplaceRevealed,gt.isReplaceRevealed=!0,pt=!0),typeof nt.isRegex<"u"&&(this._isRegex=nt.isRegex),typeof nt.wholeWord<"u"&&(this._wholeWord=nt.wholeWord),typeof nt.matchCase<"u"&&(this._matchCase=nt.matchCase),typeof nt.preserveCase<"u"&&(this._preserveCase=nt.preserveCase),typeof nt.searchScope<"u"&&(!((ut=nt.searchScope)===null||ut===void 0)&&ut.every(wt=>{var Lt;return(Lt=this._searchScope)===null||Lt===void 0?void 0:Lt.some(xt=>!Range$2.equalsRange(xt,wt))})||(this._searchScope=nt.searchScope,gt.searchScope=!0,pt=!0)),typeof nt.loop<"u"&&this._loop!==nt.loop&&(this._loop=nt.loop,gt.loop=!0,pt=!0),typeof nt.isSearching<"u"&&this._isSearching!==nt.isSearching&&(this._isSearching=nt.isSearching,gt.isSearching=!0,pt=!0),typeof nt.filters<"u"&&(this._filters?this._filters.update(nt.filters):this._filters=nt.filters,gt.filters=!0,pt=!0),this._isRegexOverride=typeof nt.isRegexOverride<"u"?nt.isRegexOverride:0,this._wholeWordOverride=typeof nt.wholeWordOverride<"u"?nt.wholeWordOverride:0,this._matchCaseOverride=typeof nt.matchCaseOverride<"u"?nt.matchCaseOverride:0,this._preserveCaseOverride=typeof nt.preserveCaseOverride<"u"?nt.preserveCaseOverride:0,mt!==this.isRegex&&(pt=!0,gt.isRegex=!0),vt!==this.wholeWord&&(pt=!0,gt.wholeWord=!0),St!==this.matchCase&&(pt=!0,gt.matchCase=!0),yt!==this.preserveCase&&(pt=!0,gt.preserveCase=!0),pt&&this._onFindReplaceStateChange.fire(gt)}canNavigateBack(){return this.canNavigateInLoop()||this.matchesPosition!==1}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=MATCHES_LIMIT}}const findWidget="";function showHistoryKeybindingHint(ct){var nt,ot;return((nt=ct.lookupKeybinding("history.showPrevious"))===null||nt===void 0?void 0:nt.getElectronAccelerator())==="Up"&&((ot=ct.lookupKeybinding("history.showNext"))===null||ot===void 0?void 0:ot.getElectronAccelerator())==="Down"}var __awaiter$A=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const findSelectionIcon=registerIcon("find-selection",Codicon.selection,localize("findSelectionIcon","Icon for 'Find in Selection' in the editor find widget.")),findCollapsedIcon=registerIcon("find-collapsed",Codicon.chevronRight,localize("findCollapsedIcon","Icon to indicate that the editor find widget is collapsed.")),findExpandedIcon=registerIcon("find-expanded",Codicon.chevronDown,localize("findExpandedIcon","Icon to indicate that the editor find widget is expanded.")),findReplaceIcon=registerIcon("find-replace",Codicon.replace,localize("findReplaceIcon","Icon for 'Replace' in the editor find widget.")),findReplaceAllIcon=registerIcon("find-replace-all",Codicon.replaceAll,localize("findReplaceAllIcon","Icon for 'Replace All' in the editor find widget.")),findPreviousMatchIcon=registerIcon("find-previous-match",Codicon.arrowUp,localize("findPreviousMatchIcon","Icon for 'Find Previous' in the editor find widget.")),findNextMatchIcon=registerIcon("find-next-match",Codicon.arrowDown,localize("findNextMatchIcon","Icon for 'Find Next' in the editor find widget.")),NLS_FIND_INPUT_LABEL=localize("label.find","Find"),NLS_FIND_INPUT_PLACEHOLDER=localize("placeholder.find","Find"),NLS_PREVIOUS_MATCH_BTN_LABEL=localize("label.previousMatchButton","Previous Match"),NLS_NEXT_MATCH_BTN_LABEL=localize("label.nextMatchButton","Next Match"),NLS_TOGGLE_SELECTION_FIND_TITLE=localize("label.toggleSelectionFind","Find in Selection"),NLS_CLOSE_BTN_LABEL=localize("label.closeButton","Close"),NLS_REPLACE_INPUT_LABEL=localize("label.replace","Replace"),NLS_REPLACE_INPUT_PLACEHOLDER=localize("placeholder.replace","Replace"),NLS_REPLACE_BTN_LABEL=localize("label.replaceButton","Replace"),NLS_REPLACE_ALL_BTN_LABEL=localize("label.replaceAllButton","Replace All"),NLS_TOGGLE_REPLACE_MODE_BTN_LABEL=localize("label.toggleReplaceButton","Toggle Replace"),NLS_MATCHES_COUNT_LIMIT_TITLE=localize("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",MATCHES_LIMIT),NLS_MATCHES_LOCATION=localize("label.matchesLocation","{0} of {1}"),NLS_NO_RESULTS=localize("label.noResults","No results"),FIND_WIDGET_INITIAL_WIDTH=419,PART_WIDTH=275,FIND_INPUT_AREA_WIDTH=PART_WIDTH-54;let MAX_MATCHES_COUNT_WIDTH=69;const FIND_INPUT_AREA_HEIGHT=33,ctrlEnterReplaceAllWarningPromptedKey="ctrlEnterReplaceAll.windows.donotask",ctrlKeyMod=isMacintosh?256:2048;class FindWidgetViewZone{constructor(nt){this.afterLineNumber=nt,this.heightInPx=FIND_INPUT_AREA_HEIGHT,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function stopPropagationForMultiLineUpwards(ct,nt,ot){const rt=!!nt.match(/\n/);if(ot&&rt&&ot.selectionStart>0){ct.stopPropagation();return}}function stopPropagationForMultiLineDownwards(ct,nt,ot){const rt=!!nt.match(/\n/);if(ot&&rt&&ot.selectionEnd<ot.value.length){ct.stopPropagation();return}}class FindWidget extends Widget$1{constructor(nt,ot,rt,ut,gt,pt,mt,vt,St){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=nt,this._controller=ot,this._state=rt,this._contextViewProvider=ut,this._keybindingService=gt,this._contextKeyService=pt,this._storageService=vt,this._notificationService=St,this._ctrlEnterReplaceAllWarningPrompted=!!vt.getBoolean(ctrlEnterReplaceAllWarningPromptedKey,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new Delayer(500),this._register(toDisposable(()=>this._updateHistoryDelayer.cancel())),this._register(this._state.onFindReplaceStateChange(yt=>this._onStateChanged(yt))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration(yt=>{if(yt.hasChanged(87)&&(this._codeEditor.getOption(87)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),yt.hasChanged(139)&&this._tryUpdateWidgetWidth(),yt.hasChanged(2)&&this.updateAccessibilitySupport(),yt.hasChanged(39)){const wt=this._codeEditor.getOption(39).loop;this._state.change({loop:wt},!1);const Lt=this._codeEditor.getOption(39).addExtraSpaceOnTop;Lt&&!this._viewZone&&(this._viewZone=new FindWidgetViewZone(0),this._showViewZone()),!Lt&&this._viewZone&&this._removeViewZone()}})),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection(()=>{this._isVisible&&this._updateToggleSelectionFindButton()})),this._register(this._codeEditor.onDidFocusEditorWidget(()=>__awaiter$A(this,void 0,void 0,function*(){if(this._isVisible){const yt=yield this._controller.getGlobalBufferTerm();yt&&yt!==this._state.searchString&&(this._state.change({searchString:yt},!1),this._findInput.select())}}))),this._findInputFocused=CONTEXT_FIND_INPUT_FOCUSED.bindTo(pt),this._findFocusTracker=this._register(trackFocus(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus(()=>{this._findInputFocused.set(!0),this._updateSearchScope()})),this._register(this._findFocusTracker.onDidBlur(()=>{this._findInputFocused.set(!1)})),this._replaceInputFocused=CONTEXT_REPLACE_INPUT_FOCUSED.bindTo(pt),this._replaceFocusTracker=this._register(trackFocus(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus(()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()})),this._register(this._replaceFocusTracker.onDidBlur(()=>{this._replaceInputFocused.set(!1)})),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(39).addExtraSpaceOnTop&&(this._viewZone=new FindWidgetViewZone(0)),this._register(this._codeEditor.onDidChangeModel(()=>{this._isVisible&&(this._viewZoneId=void 0)})),this._register(this._codeEditor.onDidScrollChange(yt=>{if(yt.scrollTopChanged){this._layoutViewZone();return}setTimeout(()=>{this._layoutViewZone()},0)}))}getId(){return FindWidget.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(nt){if(nt.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(nt.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),nt.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),nt.isReplaceRevealed&&(this._state.isReplaceRevealed?!this._codeEditor.getOption(87)&&!this._isReplaceVisible&&(this._isReplaceVisible=!0,this._replaceInput.width=getTotalWidth(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(nt.isRevealed||nt.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),nt.isRegex&&this._findInput.setRegex(this._state.isRegex),nt.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),nt.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),nt.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),nt.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),nt.searchString||nt.matchesCount||nt.matchesPosition){const ot=this._state.searchString.length>0&&this._state.matchesCount===0;this._domNode.classList.toggle("no-results",ot),this._updateMatchesCount(),this._updateButtons()}(nt.searchString||nt.currentMatch)&&this._layoutViewZone(),nt.updateHistory&&this._delayedUpdateHistory(),nt.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,onUnexpectedError)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){this._matchesCount.style.minWidth=MAX_MATCHES_COUNT_WIDTH+"px",this._state.matchesCount>=MATCHES_LIMIT?this._matchesCount.title=NLS_MATCHES_COUNT_LIMIT_TITLE:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild);let nt;if(this._state.matchesCount>0){let ot=String(this._state.matchesCount);this._state.matchesCount>=MATCHES_LIMIT&&(ot+="+");let rt=String(this._state.matchesPosition);rt==="0"&&(rt="?"),nt=format(NLS_MATCHES_LOCATION,rt,ot)}else nt=NLS_NO_RESULTS;this._matchesCount.appendChild(document.createTextNode(nt)),alert(this._getAriaLabel(nt,this._state.currentMatch,this._state.searchString)),MAX_MATCHES_COUNT_WIDTH=Math.max(MAX_MATCHES_COUNT_WIDTH,this._matchesCount.clientWidth)}_getAriaLabel(nt,ot,rt){if(nt===NLS_NO_RESULTS)return rt===""?localize("ariaSearchNoResultEmpty","{0} found",nt):localize("ariaSearchNoResult","{0} found for '{1}'",nt,rt);if(ot){const ut=localize("ariaSearchNoResultWithLineNum","{0} found for '{1}', at {2}",nt,rt,ot.startLineNumber+":"+ot.startColumn),gt=this._codeEditor.getModel();return gt&&ot.startLineNumber<=gt.getLineCount()&&ot.startLineNumber>=1?`${gt.getLineContent(ot.startLineNumber)}, ${ut}`:ut}return localize("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",nt,rt)}_updateToggleSelectionFindButton(){const nt=this._codeEditor.getSelection(),ot=nt?nt.startLineNumber!==nt.endLineNumber||nt.startColumn!==nt.endColumn:!1,rt=this._toggleSelectionFind.checked;this._isVisible&&(rt||ot)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);const nt=this._state.searchString.length>0,ot=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&nt&&ot&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&nt&&ot&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&nt),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&nt),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);const rt=!this._codeEditor.getOption(87);this._toggleReplaceBtn.setEnabled(this._isVisible&&rt)}_reveal(){if(this._revealTimeouts.forEach(nt=>{clearTimeout(nt)}),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const nt=this._codeEditor.getSelection();switch(this._codeEditor.getOption(39).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const rt=!!nt&&nt.startLineNumber!==nt.endLineNumber;this._toggleSelectionFind.checked=rt;break}}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout(()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")},0)),this._revealTimeouts.push(setTimeout(()=>{this._findInput.validate()},200)),this._codeEditor.layoutOverlayWidget(this);let ot=!0;if(this._codeEditor.getOption(39).seedSearchStringFromSelection&&nt){const rt=this._codeEditor.getDomNode();if(rt){const ut=getDomNodePagePosition(rt),gt=this._codeEditor.getScrolledVisiblePosition(nt.getStartPosition()),pt=ut.left+(gt?gt.left:0),mt=gt?gt.top:0;if(this._viewZone&&mt<this._viewZone.heightInPx){nt.endLineNumber>nt.startLineNumber&&(ot=!1);const vt=getTopLeftOffset(this._domNode).left;pt>vt&&(ot=!1);const St=this._codeEditor.getScrolledVisiblePosition(nt.getEndPosition());ut.left+(St?St.left:0)>vt&&(ot=!1)}}}this._showViewZone(ot)}}_hide(nt){this._revealTimeouts.forEach(ot=>{clearTimeout(ot)}),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),nt&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(nt){if(!this._codeEditor.getOption(39).addExtraSpaceOnTop){this._removeViewZone();return}if(!this._isVisible)return;const rt=this._viewZone;this._viewZoneId!==void 0||!rt||this._codeEditor.changeViewZones(ut=>{rt.heightInPx=this._getHeight(),this._viewZoneId=ut.addZone(rt),this._codeEditor.setScrollTop(nt||this._codeEditor.getScrollTop()+rt.heightInPx)})}_showViewZone(nt=!0){if(!this._isVisible||!this._codeEditor.getOption(39).addExtraSpaceOnTop)return;this._viewZone===void 0&&(this._viewZone=new FindWidgetViewZone(0));const rt=this._viewZone;this._codeEditor.changeViewZones(ut=>{if(this._viewZoneId!==void 0){const gt=this._getHeight();if(gt===rt.heightInPx)return;const pt=gt-rt.heightInPx;rt.heightInPx=gt,ut.layoutZone(this._viewZoneId),nt&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+pt);return}else{let gt=this._getHeight();if(gt-=this._codeEditor.getOption(81).top,gt<=0)return;rt.heightInPx=gt,this._viewZoneId=ut.addZone(rt),nt&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+gt)}})}_removeViewZone(){this._codeEditor.changeViewZones(nt=>{this._viewZoneId!==void 0&&(nt.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))})}_tryUpdateWidgetWidth(){if(!this._isVisible||!isInDOM(this._domNode))return;const nt=this._codeEditor.getLayoutInfo();if(nt.contentWidth<=0){this._domNode.classList.add("hiddenEditor");return}else this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const rt=nt.width,ut=nt.minimap.minimapWidth;let gt=!1,pt=!1,mt=!1;if(this._resized&&getTotalWidth(this._domNode)>FIND_WIDGET_INITIAL_WIDTH){this._domNode.style.maxWidth=`${rt-28-ut-15}px`,this._replaceInput.width=getTotalWidth(this._findInput.domNode);return}if(FIND_WIDGET_INITIAL_WIDTH+28+ut>=rt&&(pt=!0),FIND_WIDGET_INITIAL_WIDTH+28+ut-MAX_MATCHES_COUNT_WIDTH>=rt&&(mt=!0),FIND_WIDGET_INITIAL_WIDTH+28+ut-MAX_MATCHES_COUNT_WIDTH>=rt+50&&(gt=!0),this._domNode.classList.toggle("collapsed-find-widget",gt),this._domNode.classList.toggle("narrow-find-widget",mt),this._domNode.classList.toggle("reduced-find-widget",pt),!mt&&!gt&&(this._domNode.style.maxWidth=`${rt-28-ut-15}px`),this._findInput.layout({collapsedFindWidget:gt,narrowFindWidget:mt,reducedFindWidget:pt}),this._resized){const vt=this._findInput.inputBox.element.clientWidth;vt>0&&(this._replaceInput.width=vt)}else this._isReplaceVisible&&(this._replaceInput.width=getTotalWidth(this._findInput.domNode))}_getHeight(){let nt=0;return nt+=4,nt+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(nt+=4,nt+=this._replaceInput.inputBox.height+2),nt+=4,nt}_tryUpdateHeight(){const nt=this._getHeight();return this._cachedHeight!==null&&this._cachedHeight===nt?!1:(this._cachedHeight=nt,this._domNode.style.height=`${nt}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){const nt=this._codeEditor.getSelections();nt.map(ot=>{ot.endColumn===1&&ot.endLineNumber>ot.startLineNumber&&(ot=ot.setEndPosition(ot.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(ot.endLineNumber-1)));const rt=this._state.currentMatch;return ot.startLineNumber!==ot.endLineNumber&&!Range$2.equalsRange(ot,rt)?ot:null}).filter(ot=>!!ot),nt.length&&this._state.change({searchScope:nt},!0)}}_onFindInputMouseDown(nt){nt.middleButton&&nt.stopPropagation()}_onFindInputKeyDown(nt){if(nt.equals(ctrlKeyMod|3))if(this._keybindingService.dispatchEvent(nt,nt.target)){nt.preventDefault();return}else{this._findInput.inputBox.insertAtCursor(`
`),nt.preventDefault();return}if(nt.equals(2)){this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),nt.preventDefault();return}if(nt.equals(2066)){this._codeEditor.focus(),nt.preventDefault();return}if(nt.equals(16))return stopPropagationForMultiLineUpwards(nt,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"));if(nt.equals(18))return stopPropagationForMultiLineDownwards(nt,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"))}_onReplaceInputKeyDown(nt){if(nt.equals(ctrlKeyMod|3))if(this._keybindingService.dispatchEvent(nt,nt.target)){nt.preventDefault();return}else{isWindows&&isNative&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(localize("ctrlEnter.keybindingChanged","Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(ctrlEnterReplaceAllWarningPromptedKey,!0,0,0)),this._replaceInput.inputBox.insertAtCursor(`
`),nt.preventDefault();return}if(nt.equals(2)){this._findInput.focusOnCaseSensitive(),nt.preventDefault();return}if(nt.equals(1026)){this._findInput.focus(),nt.preventDefault();return}if(nt.equals(2066)){this._codeEditor.focus(),nt.preventDefault();return}if(nt.equals(16))return stopPropagationForMultiLineUpwards(nt,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"));if(nt.equals(18))return stopPropagationForMultiLineDownwards(nt,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"))}getVerticalSashLeft(nt){return 0}_keybindingLabelFor(nt){const ot=this._keybindingService.lookupKeybinding(nt);return ot?` (${ot.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new ContextScopedFindInput(null,this._contextViewProvider,{width:FIND_INPUT_AREA_WIDTH,label:NLS_FIND_INPUT_LABEL,placeholder:NLS_FIND_INPUT_PLACEHOLDER,appendCaseSensitiveLabel:this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),validation:vt=>{if(vt.length===0||!this._findInput.getRegex())return null;try{return new RegExp(vt,"gu"),null}catch(St){return{content:St.message}}},flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showCommonFindToggles:!0,showHistoryHint:()=>showHistoryKeybindingHint(this._keybindingService),inputBoxStyles:defaultInputBoxStyles,toggleStyles:defaultToggleStyles},this._contextKeyService)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown(vt=>this._onFindInputKeyDown(vt))),this._register(this._findInput.inputBox.onDidChange(()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)})),this._register(this._findInput.onDidOptionChange(()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this._findInput.onCaseSensitiveKeyDown(vt=>{vt.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),vt.preventDefault())})),this._register(this._findInput.onRegexKeyDown(vt=>{vt.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),vt.preventDefault())})),this._register(this._findInput.inputBox.onDidHeightChange(vt=>{this._tryUpdateHeight()&&this._showViewZone()})),isLinux&&this._register(this._findInput.onMouseDown(vt=>this._onFindInputMouseDown(vt))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount(),this._prevBtn=this._register(new SimpleButton({label:NLS_PREVIOUS_MATCH_BTN_LABEL+this._keybindingLabelFor(FIND_IDS.PreviousMatchFindAction),icon:findPreviousMatchIcon,onTrigger:()=>{assertIsDefined(this._codeEditor.getAction(FIND_IDS.PreviousMatchFindAction)).run().then(void 0,onUnexpectedError)}})),this._nextBtn=this._register(new SimpleButton({label:NLS_NEXT_MATCH_BTN_LABEL+this._keybindingLabelFor(FIND_IDS.NextMatchFindAction),icon:findNextMatchIcon,onTrigger:()=>{assertIsDefined(this._codeEditor.getAction(FIND_IDS.NextMatchFindAction)).run().then(void 0,onUnexpectedError)}}));const rt=document.createElement("div");rt.className="find-part",rt.appendChild(this._findInput.domNode);const ut=document.createElement("div");ut.className="find-actions",rt.appendChild(ut),ut.appendChild(this._matchesCount),ut.appendChild(this._prevBtn.domNode),ut.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new Toggle({icon:findSelectionIcon,title:NLS_TOGGLE_SELECTION_FIND_TITLE+this._keybindingLabelFor(FIND_IDS.ToggleSearchScopeCommand),isChecked:!1,inputActiveOptionBackground:asCssVariable(inputActiveOptionBackground),inputActiveOptionBorder:asCssVariable(inputActiveOptionBorder),inputActiveOptionForeground:asCssVariable(inputActiveOptionForeground)})),this._register(this._toggleSelectionFind.onChange(()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){const vt=this._codeEditor.getSelections();vt.map(St=>(St.endColumn===1&&St.endLineNumber>St.startLineNumber&&(St=St.setEndPosition(St.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(St.endLineNumber-1))),St.isEmpty()?null:St)).filter(St=>!!St),vt.length&&this._state.change({searchScope:vt},!0)}}else this._state.change({searchScope:null},!0)})),ut.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new SimpleButton({label:NLS_CLOSE_BTN_LABEL+this._keybindingLabelFor(FIND_IDS.CloseFindWidgetCommand),icon:widgetClose,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:vt=>{vt.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),vt.preventDefault())}})),ut.appendChild(this._closeBtn.domNode),this._replaceInput=this._register(new ContextScopedReplaceInput(null,void 0,{label:NLS_REPLACE_INPUT_LABEL,placeholder:NLS_REPLACE_INPUT_PLACEHOLDER,appendPreserveCaseLabel:this._keybindingLabelFor(FIND_IDS.TogglePreserveCaseCommand),history:[],flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>showHistoryKeybindingHint(this._keybindingService),inputBoxStyles:defaultInputBoxStyles,toggleStyles:defaultToggleStyles},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown(vt=>this._onReplaceInputKeyDown(vt))),this._register(this._replaceInput.inputBox.onDidChange(()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)})),this._register(this._replaceInput.inputBox.onDidHeightChange(vt=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()})),this._register(this._replaceInput.onDidOptionChange(()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)})),this._register(this._replaceInput.onPreserveCaseKeyDown(vt=>{vt.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),vt.preventDefault())})),this._replaceBtn=this._register(new SimpleButton({label:NLS_REPLACE_BTN_LABEL+this._keybindingLabelFor(FIND_IDS.ReplaceOneAction),icon:findReplaceIcon,onTrigger:()=>{this._controller.replace()},onKeyDown:vt=>{vt.equals(1026)&&(this._closeBtn.focus(),vt.preventDefault())}})),this._replaceAllBtn=this._register(new SimpleButton({label:NLS_REPLACE_ALL_BTN_LABEL+this._keybindingLabelFor(FIND_IDS.ReplaceAllAction),icon:findReplaceAllIcon,onTrigger:()=>{this._controller.replaceAll()}}));const gt=document.createElement("div");gt.className="replace-part",gt.appendChild(this._replaceInput.domNode);const pt=document.createElement("div");pt.className="replace-actions",gt.appendChild(pt),pt.appendChild(this._replaceBtn.domNode),pt.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new SimpleButton({label:NLS_TOGGLE_REPLACE_MODE_BTN_LABEL,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=getTotalWidth(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.style.width=`${FIND_WIDGET_INITIAL_WIDTH}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(rt),this._domNode.appendChild(gt),this._resizeSash=new Sash(this._domNode,this,{orientation:0,size:2}),this._resized=!1;let mt=FIND_WIDGET_INITIAL_WIDTH;this._register(this._resizeSash.onDidStart(()=>{mt=getTotalWidth(this._domNode)})),this._register(this._resizeSash.onDidChange(vt=>{this._resized=!0;const St=mt+vt.startX-vt.currentX;if(St<FIND_WIDGET_INITIAL_WIDTH)return;const yt=parseFloat(getComputedStyle$1(this._domNode).maxWidth)||0;St>yt||(this._domNode.style.width=`${St}px`,this._isReplaceVisible&&(this._replaceInput.width=getTotalWidth(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())})),this._register(this._resizeSash.onDidReset(()=>{const vt=getTotalWidth(this._domNode);if(vt<FIND_WIDGET_INITIAL_WIDTH)return;let St=FIND_WIDGET_INITIAL_WIDTH;if(!this._resized||vt===FIND_WIDGET_INITIAL_WIDTH){const yt=this._codeEditor.getLayoutInfo();St=yt.width-28-yt.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${St}px`,this._isReplaceVisible&&(this._replaceInput.width=getTotalWidth(this._findInput.domNode)),this._findInput.inputBox.layout()}))}updateAccessibilitySupport(){const nt=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(nt!==2)}}FindWidget.ID="editor.contrib.findWidget";class SimpleButton extends Widget$1{constructor(nt){super(),this._opts=nt;let ot="button";this._opts.className&&(ot=ot+" "+this._opts.className),this._opts.icon&&(ot=ot+" "+ThemeIcon.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className=ot,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this.onclick(this._domNode,rt=>{this._opts.onTrigger(),rt.preventDefault()}),this.onkeydown(this._domNode,rt=>{var ut,gt;if(rt.equals(10)||rt.equals(3)){this._opts.onTrigger(),rt.preventDefault();return}(gt=(ut=this._opts).onKeyDown)===null||gt===void 0||gt.call(ut,rt)})}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(nt){this._domNode.classList.toggle("disabled",!nt),this._domNode.setAttribute("aria-disabled",String(!nt)),this._domNode.tabIndex=nt?0:-1}setExpanded(nt){this._domNode.setAttribute("aria-expanded",String(!!nt)),nt?(this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findCollapsedIcon)),this._domNode.classList.add(...ThemeIcon.asClassNameArray(findExpandedIcon))):(this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findExpandedIcon)),this._domNode.classList.add(...ThemeIcon.asClassNameArray(findCollapsedIcon)))}}registerThemingParticipant((ct,nt)=>{const ot=(kt,At)=>{At&&nt.addRule(`.monaco-editor ${kt} { background-color: ${At}; }`)};ot(".findMatch",ct.getColor(editorFindMatchHighlight)),ot(".currentFindMatch",ct.getColor(editorFindMatch)),ot(".findScope",ct.getColor(editorFindRangeHighlight));const rt=ct.getColor(editorWidgetBackground);ot(".find-widget",rt);const ut=ct.getColor(widgetShadow);ut&&nt.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${ut}; }`);const gt=ct.getColor(widgetBorder);gt&&nt.addRule(`.monaco-editor .find-widget { border-left: 1px solid ${gt}; border-right: 1px solid ${gt}; border-bottom: 1px solid ${gt}; }`);const pt=ct.getColor(editorFindMatchHighlightBorder);pt&&nt.addRule(`.monaco-editor .findMatch { border: 1px ${isHighContrast(ct.type)?"dotted":"solid"} ${pt}; box-sizing: border-box; }`);const mt=ct.getColor(editorFindMatchBorder);mt&&nt.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${mt}; padding: 1px; box-sizing: border-box; }`);const vt=ct.getColor(editorFindRangeHighlightBorder);vt&&nt.addRule(`.monaco-editor .findScope { border: 1px ${isHighContrast(ct.type)?"dashed":"solid"} ${vt}; }`);const St=ct.getColor(contrastBorder);St&&nt.addRule(`.monaco-editor .find-widget { border: 1px solid ${St}; }`);const yt=ct.getColor(editorWidgetForeground);yt&&nt.addRule(`.monaco-editor .find-widget { color: ${yt}; }`);const wt=ct.getColor(errorForeground);wt&&nt.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${wt}; }`);const Lt=ct.getColor(editorWidgetResizeBorder);if(Lt)nt.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${Lt}; }`);else{const kt=ct.getColor(editorWidgetBorder);kt&&nt.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${kt}; }`)}const xt=ct.getColor(toolbarHoverBackground);xt&&nt.addRule(`
		.monaco-editor .find-widget .button:not(.disabled):hover,
		.monaco-editor .find-widget .codicon-find-selection:hover {
			background-color: ${xt} !important;
		}
	`);const It=ct.getColor(focusBorder);It&&nt.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${It}; }`)});var __decorate$R=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$R=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$z=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const SEARCH_STRING_MAX_LENGTH=524288;function getSelectionSearchString(ct,nt="single",ot=!1){if(!ct.hasModel())return null;const rt=ct.getSelection();if(nt==="single"&&rt.startLineNumber===rt.endLineNumber||nt==="multiple"){if(rt.isEmpty()){const ut=ct.getConfiguredWordAtPosition(rt.getStartPosition());if(ut&&ot===!1)return ut.word}else if(ct.getModel().getValueLengthInRange(rt)<SEARCH_STRING_MAX_LENGTH)return ct.getModel().getValueInRange(rt)}return null}let CommonFindController=class xr extends Disposable{get editor(){return this._editor}static get(nt){return nt.getContribution(xr.ID)}constructor(nt,ot,rt,ut){super(),this._editor=nt,this._findWidgetVisible=CONTEXT_FIND_WIDGET_VISIBLE.bindTo(ot),this._contextKeyService=ot,this._storageService=rt,this._clipboardService=ut,this._updateHistoryDelayer=new Delayer(500),this._state=this._register(new FindReplaceState),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange(gt=>this._onStateChanged(gt))),this._model=null,this._register(this._editor.onDidChangeModel(()=>{const gt=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),gt&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(39).loop})}))}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(nt){this.saveQueryState(nt),nt.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),nt.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(nt){nt.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,0),nt.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,0),nt.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,0),nt.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,0)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){const nt=this._editor.getSelections();nt.map(ot=>(ot.endColumn===1&&ot.endLineNumber>ot.startLineNumber&&(ot=ot.setEndPosition(ot.endLineNumber-1,this._editor.getModel().getLineMaxColumn(ot.endLineNumber-1))),ot.isEmpty()?null:ot)).filter(ot=>!!ot),nt.length&&this._state.change({searchScope:nt},!0)}}setSearchString(nt){this._state.isRegex&&(nt=escapeRegExpCharacters(nt)),this._state.change({searchString:nt},!1)}highlightFindOptions(nt=!1){}_start(nt,ot){return __awaiter$z(this,void 0,void 0,function*(){if(this.disposeModel(),!this._editor.hasModel())return;const rt=Object.assign(Object.assign({},ot),{isRevealed:!0});if(nt.seedSearchStringFromSelection==="single"){const ut=getSelectionSearchString(this._editor,nt.seedSearchStringFromSelection,nt.seedSearchStringFromNonEmptySelection);ut&&(this._state.isRegex?rt.searchString=escapeRegExpCharacters(ut):rt.searchString=ut)}else if(nt.seedSearchStringFromSelection==="multiple"&&!nt.updateSearchScope){const ut=getSelectionSearchString(this._editor,nt.seedSearchStringFromSelection);ut&&(rt.searchString=ut)}if(!rt.searchString&&nt.seedSearchStringFromGlobalClipboard){const ut=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;ut&&(rt.searchString=ut)}if(nt.forceRevealReplace||rt.isReplaceRevealed?rt.isReplaceRevealed=!0:this._findWidgetVisible.get()||(rt.isReplaceRevealed=!1),nt.updateSearchScope){const ut=this._editor.getSelections();ut.some(gt=>!gt.isEmpty())&&(rt.searchScope=ut)}rt.loop=nt.loop,this._state.change(rt,!1),this._model||(this._model=new FindModelBoundToEditorModel(this._editor,this._state))})}start(nt,ot){return this._start(nt,ot)}moveToNextMatch(){return this._model?(this._model.moveToNextMatch(),!0):!1}moveToPrevMatch(){return this._model?(this._model.moveToPrevMatch(),!0):!1}goToMatch(nt){return this._model?(this._model.moveToMatch(nt),!0):!1}replace(){return this._model?(this._model.replace(),!0):!1}replaceAll(){return this._model?(this._model.replaceAll(),!0):!1}selectAllMatches(){return this._model?(this._model.selectAllMatches(),this._editor.focus(),!0):!1}getGlobalBufferTerm(){return __awaiter$z(this,void 0,void 0,function*(){return this._editor.getOption(39).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""})}setGlobalBufferTerm(nt){this._editor.getOption(39).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(nt)}};CommonFindController.ID="editor.contrib.findController";CommonFindController=__decorate$R([__param$R(1,IContextKeyService),__param$R(2,IStorageService),__param$R(3,IClipboardService)],CommonFindController);let FindController=class extends CommonFindController{constructor(nt,ot,rt,ut,gt,pt,mt,vt){super(nt,rt,mt,vt),this._contextViewService=ot,this._keybindingService=ut,this._themeService=gt,this._notificationService=pt,this._widget=null,this._findOptionsWidget=null}_start(nt,ot){const rt=Object.create(null,{_start:{get:()=>super._start}});return __awaiter$z(this,void 0,void 0,function*(){this._widget||this._createFindWidget();const ut=this._editor.getSelection();let gt=!1;switch(this._editor.getOption(39).autoFindInSelection){case"always":gt=!0;break;case"never":gt=!1;break;case"multiline":{gt=!!ut&&ut.startLineNumber!==ut.endLineNumber;break}}nt.updateSearchScope=nt.updateSearchScope||gt,yield rt._start.call(this,nt,ot),this._widget&&(nt.shouldFocus===2?this._widget.focusReplaceInput():nt.shouldFocus===1&&this._widget.focusFindInput())})}highlightFindOptions(nt=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!nt?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new FindWidget(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new FindOptionsWidget(this._editor,this._state,this._keybindingService))}};FindController=__decorate$R([__param$R(1,IContextViewService),__param$R(2,IContextKeyService),__param$R(3,IKeybindingService),__param$R(4,IThemeService),__param$R(5,INotificationService),__param$R(6,IStorageService),__param$R(7,IClipboardService)],FindController);const StartFindAction=registerMultiEditorAction(new MultiEditorAction({id:FIND_IDS.StartFindAction,label:localize("startFindAction","Find"),alias:"Find",precondition:ContextKeyExpr.or(EditorContextKeys.focus,ContextKeyExpr.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:MenuId.MenubarEditMenu,group:"3_find",title:localize({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}}));StartFindAction.addImplementation(0,(ct,nt,ot)=>{const rt=CommonFindController.get(nt);return rt?rt.start({forceRevealReplace:!1,seedSearchStringFromSelection:nt.getOption(39).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:nt.getOption(39).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:nt.getOption(39).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:nt.getOption(39).loop}):!1});const findArgDescription={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},regex:{type:"boolean"},regexOverride:{type:"number",description:localize("actions.find.isRegexOverride",`Overrides "Use Regular Expression" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},wholeWord:{type:"boolean"},wholeWordOverride:{type:"number",description:localize("actions.find.wholeWordOverride",`Overrides "Match Whole Word" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},matchCase:{type:"boolean"},matchCaseOverride:{type:"number",description:localize("actions.find.matchCaseOverride",`Overrides "Math Case" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},preserveCase:{type:"boolean"},preserveCaseOverride:{type:"number",description:localize("actions.find.preserveCaseOverride",`Overrides "Preserve Case" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},findInSelection:{type:"boolean"}}}}]};class StartFindWithArgsAction extends EditorAction{constructor(){super({id:FIND_IDS.StartFindWithArgs,label:localize("startFindWithArgsAction","Find With Arguments"),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},description:findArgDescription})}run(nt,ot,rt){return __awaiter$z(this,void 0,void 0,function*(){const ut=CommonFindController.get(ot);if(ut){const gt=rt?{searchString:rt.searchString,replaceString:rt.replaceString,isReplaceRevealed:rt.replaceString!==void 0,isRegex:rt.isRegex,wholeWord:rt.matchWholeWord,matchCase:rt.isCaseSensitive,preserveCase:rt.preserveCase}:{};yield ut.start({forceRevealReplace:!1,seedSearchStringFromSelection:ut.getState().searchString.length===0&&ot.getOption(39).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:ot.getOption(39).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:(rt==null?void 0:rt.findInSelection)||!1,loop:ot.getOption(39).loop},gt),ut.setGlobalBufferTerm(ut.getState().searchString)}})}}class StartFindWithSelectionAction extends EditorAction{constructor(){super({id:FIND_IDS.StartFindWithSelection,label:localize("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(nt,ot){return __awaiter$z(this,void 0,void 0,function*(){const rt=CommonFindController.get(ot);rt&&(yield rt.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:ot.getOption(39).loop}),rt.setGlobalBufferTerm(rt.getState().searchString))})}}class MatchFindAction extends EditorAction{run(nt,ot){return __awaiter$z(this,void 0,void 0,function*(){const rt=CommonFindController.get(ot);rt&&!this._run(rt)&&(yield rt.start({forceRevealReplace:!1,seedSearchStringFromSelection:rt.getState().searchString.length===0&&ot.getOption(39).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:ot.getOption(39).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:ot.getOption(39).loop}),this._run(rt))})}}class NextMatchFindAction extends MatchFindAction{constructor(){super({id:FIND_IDS.NextMatchFindAction,label:localize("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:EditorContextKeys.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,CONTEXT_FIND_INPUT_FOCUSED),primary:3,weight:100}]})}_run(nt){return nt.moveToNextMatch()?(nt.editor.pushUndoStop(),!0):!1}}class PreviousMatchFindAction extends MatchFindAction{constructor(){super({id:FIND_IDS.PreviousMatchFindAction,label:localize("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:EditorContextKeys.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,CONTEXT_FIND_INPUT_FOCUSED),primary:1027,weight:100}]})}_run(nt){return nt.moveToPrevMatch()}}class MoveToMatchFindAction extends EditorAction{constructor(){super({id:FIND_IDS.GoToMatchFindAction,label:localize("findMatchAction.goToMatch","Go to Match..."),alias:"Go to Match...",precondition:CONTEXT_FIND_WIDGET_VISIBLE}),this._highlightDecorations=[]}run(nt,ot,rt){const ut=CommonFindController.get(ot);if(!ut)return;const gt=ut.getState().matchesCount;if(gt<1){nt.get(INotificationService).notify({severity:Severity.Warning,message:localize("findMatchAction.noResults","No matches. Try searching for something else.")});return}const mt=nt.get(IQuickInputService).createInputBox();mt.placeholder=localize("findMatchAction.inputPlaceHolder","Type a number to go to a specific match (between 1 and {0})",gt);const vt=yt=>{const wt=parseInt(yt);if(isNaN(wt))return;const Lt=ut.getState().matchesCount;if(wt>0&&wt<=Lt)return wt-1;if(wt<0&&wt>=-Lt)return Lt+wt},St=yt=>{const wt=vt(yt);if(typeof wt=="number"){mt.validationMessage=void 0,ut.goToMatch(wt);const Lt=ut.getState().currentMatch;Lt&&this.addDecorations(ot,Lt)}else mt.validationMessage=localize("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",ut.getState().matchesCount),this.clearDecorations(ot)};mt.onDidChangeValue(yt=>{St(yt)}),mt.onDidAccept(()=>{const yt=vt(mt.value);typeof yt=="number"?(ut.goToMatch(yt),mt.hide()):mt.validationMessage=localize("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",ut.getState().matchesCount)}),mt.onDidHide(()=>{this.clearDecorations(ot),mt.dispose()}),mt.show()}clearDecorations(nt){nt.changeDecorations(ot=>{this._highlightDecorations=ot.deltaDecorations(this._highlightDecorations,[])})}addDecorations(nt,ot){nt.changeDecorations(rt=>{this._highlightDecorations=rt.deltaDecorations(this._highlightDecorations,[{range:ot,options:{description:"find-match-quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:ot,options:{description:"find-match-quick-access-range-highlight-overview",overviewRuler:{color:themeColorFromId(overviewRulerRangeHighlight),position:OverviewRulerLane.Full}}}])})}}class SelectionMatchFindAction extends EditorAction{run(nt,ot){return __awaiter$z(this,void 0,void 0,function*(){const rt=CommonFindController.get(ot);if(!rt)return;const ut=getSelectionSearchString(ot,"single",!1);ut&&rt.setSearchString(ut),this._run(rt)||(yield rt.start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:ot.getOption(39).loop}),this._run(rt))})}}class NextSelectionMatchFindAction extends SelectionMatchFindAction{constructor(){super({id:FIND_IDS.NextSelectionMatchFindAction,label:localize("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:2109,weight:100}})}_run(nt){return nt.moveToNextMatch()}}class PreviousSelectionMatchFindAction extends SelectionMatchFindAction{constructor(){super({id:FIND_IDS.PreviousSelectionMatchFindAction,label:localize("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:3133,weight:100}})}_run(nt){return nt.moveToPrevMatch()}}const StartFindReplaceAction=registerMultiEditorAction(new MultiEditorAction({id:FIND_IDS.StartFindReplaceAction,label:localize("startReplace","Replace"),alias:"Replace",precondition:ContextKeyExpr.or(EditorContextKeys.focus,ContextKeyExpr.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:MenuId.MenubarEditMenu,group:"3_find",title:localize({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}}));StartFindReplaceAction.addImplementation(0,(ct,nt,ot)=>{if(!nt.hasModel()||nt.getOption(87))return!1;const rt=CommonFindController.get(nt);if(!rt)return!1;const ut=nt.getSelection(),gt=rt.isFindInputFocused(),pt=!ut.isEmpty()&&ut.startLineNumber===ut.endLineNumber&&nt.getOption(39).seedSearchStringFromSelection!=="never"&&!gt,mt=gt||pt?2:1;return rt.start({forceRevealReplace:!0,seedSearchStringFromSelection:pt?"single":"none",seedSearchStringFromNonEmptySelection:nt.getOption(39).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:nt.getOption(39).seedSearchStringFromSelection!=="never",shouldFocus:mt,shouldAnimate:!0,updateSearchScope:!1,loop:nt.getOption(39).loop})});registerEditorContribution(CommonFindController.ID,FindController,0);registerEditorAction(StartFindWithArgsAction);registerEditorAction(StartFindWithSelectionAction);registerEditorAction(NextMatchFindAction);registerEditorAction(PreviousMatchFindAction);registerEditorAction(MoveToMatchFindAction);registerEditorAction(NextSelectionMatchFindAction);registerEditorAction(PreviousSelectionMatchFindAction);const FindCommand=EditorCommand.bindToContribution(CommonFindController.get);registerEditorCommand(new FindCommand({id:FIND_IDS.CloseFindWidgetCommand,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:ct=>ct.closeFindWidget(),kbOpts:{weight:100+5,kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,ContextKeyExpr.not("isComposing")),primary:9,secondary:[1033]}}));registerEditorCommand(new FindCommand({id:FIND_IDS.ToggleCaseSensitiveCommand,precondition:void 0,handler:ct=>ct.toggleCaseSensitive(),kbOpts:{weight:100+5,kbExpr:EditorContextKeys.focus,primary:ToggleCaseSensitiveKeybinding.primary,mac:ToggleCaseSensitiveKeybinding.mac,win:ToggleCaseSensitiveKeybinding.win,linux:ToggleCaseSensitiveKeybinding.linux}}));registerEditorCommand(new FindCommand({id:FIND_IDS.ToggleWholeWordCommand,precondition:void 0,handler:ct=>ct.toggleWholeWords(),kbOpts:{weight:100+5,kbExpr:EditorContextKeys.focus,primary:ToggleWholeWordKeybinding.primary,mac:ToggleWholeWordKeybinding.mac,win:ToggleWholeWordKeybinding.win,linux:ToggleWholeWordKeybinding.linux}}));registerEditorCommand(new FindCommand({id:FIND_IDS.ToggleRegexCommand,precondition:void 0,handler:ct=>ct.toggleRegex(),kbOpts:{weight:100+5,kbExpr:EditorContextKeys.focus,primary:ToggleRegexKeybinding.primary,mac:ToggleRegexKeybinding.mac,win:ToggleRegexKeybinding.win,linux:ToggleRegexKeybinding.linux}}));registerEditorCommand(new FindCommand({id:FIND_IDS.ToggleSearchScopeCommand,precondition:void 0,handler:ct=>ct.toggleSearchScope(),kbOpts:{weight:100+5,kbExpr:EditorContextKeys.focus,primary:ToggleSearchScopeKeybinding.primary,mac:ToggleSearchScopeKeybinding.mac,win:ToggleSearchScopeKeybinding.win,linux:ToggleSearchScopeKeybinding.linux}}));registerEditorCommand(new FindCommand({id:FIND_IDS.TogglePreserveCaseCommand,precondition:void 0,handler:ct=>ct.togglePreserveCase(),kbOpts:{weight:100+5,kbExpr:EditorContextKeys.focus,primary:TogglePreserveCaseKeybinding.primary,mac:TogglePreserveCaseKeybinding.mac,win:TogglePreserveCaseKeybinding.win,linux:TogglePreserveCaseKeybinding.linux}}));registerEditorCommand(new FindCommand({id:FIND_IDS.ReplaceOneAction,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:ct=>ct.replace(),kbOpts:{weight:100+5,kbExpr:EditorContextKeys.focus,primary:3094}}));registerEditorCommand(new FindCommand({id:FIND_IDS.ReplaceOneAction,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:ct=>ct.replace(),kbOpts:{weight:100+5,kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,CONTEXT_REPLACE_INPUT_FOCUSED),primary:3}}));registerEditorCommand(new FindCommand({id:FIND_IDS.ReplaceAllAction,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:ct=>ct.replaceAll(),kbOpts:{weight:100+5,kbExpr:EditorContextKeys.focus,primary:2563}}));registerEditorCommand(new FindCommand({id:FIND_IDS.ReplaceAllAction,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:ct=>ct.replaceAll(),kbOpts:{weight:100+5,kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,CONTEXT_REPLACE_INPUT_FOCUSED),primary:void 0,mac:{primary:2051}}}));registerEditorCommand(new FindCommand({id:FIND_IDS.SelectAllMatchesAction,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:ct=>ct.selectAllMatches(),kbOpts:{weight:100+5,kbExpr:EditorContextKeys.focus,primary:515}}));const folding="",foldSourceAbbr={[0]:" ",[1]:"u",[2]:"r"},MAX_FOLDING_REGIONS=65535,MAX_LINE_NUMBER=16777215,MASK_INDENT=4278190080;class BitField{constructor(nt){const ot=Math.ceil(nt/32);this._states=new Uint32Array(ot)}get(nt){const ot=nt/32|0,rt=nt%32;return(this._states[ot]&1<<rt)!==0}set(nt,ot){const rt=nt/32|0,ut=nt%32,gt=this._states[rt];ot?this._states[rt]=gt|1<<ut:this._states[rt]=gt&~(1<<ut)}}class FoldingRegions{constructor(nt,ot,rt){if(nt.length!==ot.length||nt.length>MAX_FOLDING_REGIONS)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=nt,this._endIndexes=ot,this._collapseStates=new BitField(nt.length),this._userDefinedStates=new BitField(nt.length),this._recoveredStates=new BitField(nt.length),this._types=rt,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;const nt=[],ot=(rt,ut)=>{const gt=nt[nt.length-1];return this.getStartLineNumber(gt)<=rt&&this.getEndLineNumber(gt)>=ut};for(let rt=0,ut=this._startIndexes.length;rt<ut;rt++){const gt=this._startIndexes[rt],pt=this._endIndexes[rt];if(gt>MAX_LINE_NUMBER||pt>MAX_LINE_NUMBER)throw new Error("startLineNumber or endLineNumber must not exceed "+MAX_LINE_NUMBER);for(;nt.length>0&&!ot(gt,pt);)nt.pop();const mt=nt.length>0?nt[nt.length-1]:-1;nt.push(rt),this._startIndexes[rt]=gt+((mt&255)<<24),this._endIndexes[rt]=pt+((mt&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(nt){return this._startIndexes[nt]&MAX_LINE_NUMBER}getEndLineNumber(nt){return this._endIndexes[nt]&MAX_LINE_NUMBER}getType(nt){return this._types?this._types[nt]:void 0}hasTypes(){return!!this._types}isCollapsed(nt){return this._collapseStates.get(nt)}setCollapsed(nt,ot){this._collapseStates.set(nt,ot)}isUserDefined(nt){return this._userDefinedStates.get(nt)}setUserDefined(nt,ot){return this._userDefinedStates.set(nt,ot)}isRecovered(nt){return this._recoveredStates.get(nt)}setRecovered(nt,ot){return this._recoveredStates.set(nt,ot)}getSource(nt){return this.isUserDefined(nt)?1:this.isRecovered(nt)?2:0}setSource(nt,ot){ot===1?(this.setUserDefined(nt,!0),this.setRecovered(nt,!1)):ot===2?(this.setUserDefined(nt,!1),this.setRecovered(nt,!0)):(this.setUserDefined(nt,!1),this.setRecovered(nt,!1))}setCollapsedAllOfType(nt,ot){let rt=!1;if(this._types)for(let ut=0;ut<this._types.length;ut++)this._types[ut]===nt&&(this.setCollapsed(ut,ot),rt=!0);return rt}toRegion(nt){return new FoldingRegion(this,nt)}getParentIndex(nt){this.ensureParentIndices();const ot=((this._startIndexes[nt]&MASK_INDENT)>>>24)+((this._endIndexes[nt]&MASK_INDENT)>>>16);return ot===MAX_FOLDING_REGIONS?-1:ot}contains(nt,ot){return this.getStartLineNumber(nt)<=ot&&this.getEndLineNumber(nt)>=ot}findIndex(nt){let ot=0,rt=this._startIndexes.length;if(rt===0)return-1;for(;ot<rt;){const ut=Math.floor((ot+rt)/2);nt<this.getStartLineNumber(ut)?rt=ut:ot=ut+1}return ot-1}findRange(nt){let ot=this.findIndex(nt);if(ot>=0){if(this.getEndLineNumber(ot)>=nt)return ot;for(ot=this.getParentIndex(ot);ot!==-1;){if(this.contains(ot,nt))return ot;ot=this.getParentIndex(ot)}}return-1}toString(){const nt=[];for(let ot=0;ot<this.length;ot++)nt[ot]=`[${foldSourceAbbr[this.getSource(ot)]}${this.isCollapsed(ot)?"+":"-"}] ${this.getStartLineNumber(ot)}/${this.getEndLineNumber(ot)}`;return nt.join(", ")}toFoldRange(nt){return{startLineNumber:this._startIndexes[nt]&MAX_LINE_NUMBER,endLineNumber:this._endIndexes[nt]&MAX_LINE_NUMBER,type:this._types?this._types[nt]:void 0,isCollapsed:this.isCollapsed(nt),source:this.getSource(nt)}}static fromFoldRanges(nt){const ot=nt.length,rt=new Uint32Array(ot),ut=new Uint32Array(ot);let gt=[],pt=!1;for(let vt=0;vt<ot;vt++){const St=nt[vt];rt[vt]=St.startLineNumber,ut[vt]=St.endLineNumber,gt.push(St.type),St.type&&(pt=!0)}pt||(gt=void 0);const mt=new FoldingRegions(rt,ut,gt);for(let vt=0;vt<ot;vt++)nt[vt].isCollapsed&&mt.setCollapsed(vt,!0),mt.setSource(vt,nt[vt].source);return mt}static sanitizeAndMerge(nt,ot,rt){rt=rt??Number.MAX_VALUE;const ut=(kt,At)=>Array.isArray(kt)?Tt=>Tt<At?kt[Tt]:void 0:Tt=>Tt<At?kt.toFoldRange(Tt):void 0,gt=ut(nt,nt.length),pt=ut(ot,ot.length);let mt=0,vt=0,St=gt(0),yt=pt(0);const wt=[];let Lt,xt=0;const It=[];for(;St||yt;){let kt;if(yt&&(!St||St.startLineNumber>=yt.startLineNumber))St&&St.startLineNumber===yt.startLineNumber?(yt.source===1?kt=yt:(kt=St,kt.isCollapsed=yt.isCollapsed&&St.endLineNumber===yt.endLineNumber,kt.source=0),St=gt(++mt)):(kt=yt,yt.isCollapsed&&yt.source===0&&(kt.source=2)),yt=pt(++vt);else{let At=vt,Tt=yt;for(;;){if(!Tt||Tt.startLineNumber>St.endLineNumber){kt=St;break}if(Tt.source===1&&Tt.endLineNumber>St.endLineNumber)break;Tt=pt(++At)}St=gt(++mt)}if(kt){for(;Lt&&Lt.endLineNumber<kt.startLineNumber;)Lt=wt.pop();kt.endLineNumber>kt.startLineNumber&&kt.startLineNumber>xt&&kt.endLineNumber<=rt&&(!Lt||Lt.endLineNumber>=kt.endLineNumber)&&(It.push(kt),xt=kt.startLineNumber,Lt&&wt.push(Lt),Lt=kt)}}return It}}class FoldingRegion{constructor(nt,ot){this.ranges=nt,this.index=ot}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(nt){return nt.startLineNumber<=this.startLineNumber&&nt.endLineNumber>=this.endLineNumber}containsLine(nt){return this.startLineNumber<=nt&&nt<=this.endLineNumber}}class FoldingModel{get regions(){return this._regions}get textModel(){return this._textModel}constructor(nt,ot){this._updateEventEmitter=new Emitter$2,this.onDidChange=this._updateEventEmitter.event,this._textModel=nt,this._decorationProvider=ot,this._regions=new FoldingRegions(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[]}toggleCollapseState(nt){if(!nt.length)return;nt=nt.sort((rt,ut)=>rt.regionIndex-ut.regionIndex);const ot={};this._decorationProvider.changeDecorations(rt=>{let ut=0,gt=-1,pt=-1;const mt=vt=>{for(;ut<vt;){const St=this._regions.getEndLineNumber(ut),yt=this._regions.isCollapsed(ut);if(St<=gt){const wt=this.regions.getSource(ut)!==0;rt.changeDecorationOptions(this._editorDecorationIds[ut],this._decorationProvider.getDecorationOption(yt,St<=pt,wt))}yt&&St>pt&&(pt=St),ut++}};for(const vt of nt){const St=vt.regionIndex,yt=this._editorDecorationIds[St];if(yt&&!ot[yt]){ot[yt]=!0,mt(St);const wt=!this._regions.isCollapsed(St);this._regions.setCollapsed(St,wt),gt=Math.max(gt,this._regions.getEndLineNumber(St))}}mt(this._regions.length)}),this._updateEventEmitter.fire({model:this,collapseStateChanged:nt})}removeManualRanges(nt){const ot=new Array,rt=ut=>{for(const gt of nt)if(!(gt.startLineNumber>ut.endLineNumber||ut.startLineNumber>gt.endLineNumber))return!0;return!1};for(let ut=0;ut<this._regions.length;ut++){const gt=this._regions.toFoldRange(ut);(gt.source===0||!rt(gt))&&ot.push(gt)}this.updatePost(FoldingRegions.fromFoldRanges(ot))}update(nt,ot=[]){const rt=this._currentFoldedOrManualRanges(ot),ut=FoldingRegions.sanitizeAndMerge(nt,rt,this._textModel.getLineCount());this.updatePost(FoldingRegions.fromFoldRanges(ut))}updatePost(nt){const ot=[];let rt=-1;for(let ut=0,gt=nt.length;ut<gt;ut++){const pt=nt.getStartLineNumber(ut),mt=nt.getEndLineNumber(ut),vt=nt.isCollapsed(ut),St=nt.getSource(ut)!==0,yt={startLineNumber:pt,startColumn:this._textModel.getLineMaxColumn(pt),endLineNumber:mt,endColumn:this._textModel.getLineMaxColumn(mt)+1};ot.push({range:yt,options:this._decorationProvider.getDecorationOption(vt,mt<=rt,St)}),vt&&mt>rt&&(rt=mt)}this._decorationProvider.changeDecorations(ut=>this._editorDecorationIds=ut.deltaDecorations(this._editorDecorationIds,ot)),this._regions=nt,this._updateEventEmitter.fire({model:this})}_currentFoldedOrManualRanges(nt=[]){const ot=(ut,gt)=>{for(const pt of nt)if(ut<pt&&pt<=gt)return!0;return!1},rt=[];for(let ut=0,gt=this._regions.length;ut<gt;ut++){let pt=this.regions.isCollapsed(ut);const mt=this.regions.getSource(ut);if(pt||mt!==0){const vt=this._regions.toFoldRange(ut),St=this._textModel.getDecorationRange(this._editorDecorationIds[ut]);St&&(pt&&ot(St.startLineNumber,St.endLineNumber)&&(pt=!1),rt.push({startLineNumber:St.startLineNumber,endLineNumber:St.endLineNumber,type:vt.type,isCollapsed:pt,source:mt}))}}return rt}getMemento(){const nt=this._currentFoldedOrManualRanges(),ot=[],rt=this._textModel.getLineCount();for(let ut=0,gt=nt.length;ut<gt;ut++){const pt=nt[ut];if(pt.startLineNumber>=pt.endLineNumber||pt.startLineNumber<1||pt.endLineNumber>rt)continue;const mt=this._getLinesChecksum(pt.startLineNumber+1,pt.endLineNumber);ot.push({startLineNumber:pt.startLineNumber,endLineNumber:pt.endLineNumber,isCollapsed:pt.isCollapsed,source:pt.source,checksum:mt})}return ot.length>0?ot:void 0}applyMemento(nt){var ot,rt;if(!Array.isArray(nt))return;const ut=[],gt=this._textModel.getLineCount();for(const mt of nt){if(mt.startLineNumber>=mt.endLineNumber||mt.startLineNumber<1||mt.endLineNumber>gt)continue;const vt=this._getLinesChecksum(mt.startLineNumber+1,mt.endLineNumber);(!mt.checksum||vt===mt.checksum)&&ut.push({startLineNumber:mt.startLineNumber,endLineNumber:mt.endLineNumber,type:void 0,isCollapsed:(ot=mt.isCollapsed)!==null&&ot!==void 0?ot:!0,source:(rt=mt.source)!==null&&rt!==void 0?rt:0})}const pt=FoldingRegions.sanitizeAndMerge(this._regions,ut,gt);this.updatePost(FoldingRegions.fromFoldRanges(pt))}_getLinesChecksum(nt,ot){return hash(this._textModel.getLineContent(nt)+this._textModel.getLineContent(ot))%1e6}dispose(){this._decorationProvider.removeDecorations(this._editorDecorationIds)}getAllRegionsAtLine(nt,ot){const rt=[];if(this._regions){let ut=this._regions.findRange(nt),gt=1;for(;ut>=0;){const pt=this._regions.toRegion(ut);(!ot||ot(pt,gt))&&rt.push(pt),gt++,ut=pt.parentIndex}}return rt}getRegionAtLine(nt){if(this._regions){const ot=this._regions.findRange(nt);if(ot>=0)return this._regions.toRegion(ot)}return null}getRegionsInside(nt,ot){const rt=[],ut=nt?nt.regionIndex+1:0,gt=nt?nt.endLineNumber:Number.MAX_VALUE;if(ot&&ot.length===2){const pt=[];for(let mt=ut,vt=this._regions.length;mt<vt;mt++){const St=this._regions.toRegion(mt);if(this._regions.getStartLineNumber(mt)<gt){for(;pt.length>0&&!St.containedBy(pt[pt.length-1]);)pt.pop();pt.push(St),ot(St,pt.length)&&rt.push(St)}else break}}else for(let pt=ut,mt=this._regions.length;pt<mt;pt++){const vt=this._regions.toRegion(pt);if(this._regions.getStartLineNumber(pt)<gt)(!ot||ot(vt))&&rt.push(vt);else break}return rt}}function toggleCollapseState(ct,nt,ot){const rt=[];for(const ut of ot){const gt=ct.getRegionAtLine(ut);if(gt){const pt=!gt.isCollapsed;if(rt.push(gt),nt>1){const mt=ct.getRegionsInside(gt,(vt,St)=>vt.isCollapsed!==pt&&St<nt);rt.push(...mt)}}}ct.toggleCollapseState(rt)}function setCollapseStateLevelsDown(ct,nt,ot=Number.MAX_VALUE,rt){const ut=[];if(rt&&rt.length>0)for(const gt of rt){const pt=ct.getRegionAtLine(gt);if(pt&&(pt.isCollapsed!==nt&&ut.push(pt),ot>1)){const mt=ct.getRegionsInside(pt,(vt,St)=>vt.isCollapsed!==nt&&St<ot);ut.push(...mt)}}else{const gt=ct.getRegionsInside(null,(pt,mt)=>pt.isCollapsed!==nt&&mt<ot);ut.push(...gt)}ct.toggleCollapseState(ut)}function setCollapseStateLevelsUp(ct,nt,ot,rt){const ut=[];for(const gt of rt){const pt=ct.getAllRegionsAtLine(gt,(mt,vt)=>mt.isCollapsed!==nt&&vt<=ot);ut.push(...pt)}ct.toggleCollapseState(ut)}function setCollapseStateUp(ct,nt,ot){const rt=[];for(const ut of ot){const gt=ct.getAllRegionsAtLine(ut,pt=>pt.isCollapsed!==nt);gt.length>0&&rt.push(gt[0])}ct.toggleCollapseState(rt)}function setCollapseStateAtLevel(ct,nt,ot,rt){const ut=(pt,mt)=>mt===nt&&pt.isCollapsed!==ot&&!rt.some(vt=>pt.containsLine(vt)),gt=ct.getRegionsInside(null,ut);ct.toggleCollapseState(gt)}function setCollapseStateForRest(ct,nt,ot){const rt=[];for(const pt of ot){const mt=ct.getAllRegionsAtLine(pt,void 0);mt.length>0&&rt.push(mt[0])}const ut=pt=>rt.every(mt=>!mt.containedBy(pt)&&!pt.containedBy(mt))&&pt.isCollapsed!==nt,gt=ct.getRegionsInside(null,ut);ct.toggleCollapseState(gt)}function setCollapseStateForMatchingLines(ct,nt,ot){const rt=ct.textModel,ut=ct.regions,gt=[];for(let pt=ut.length-1;pt>=0;pt--)if(ot!==ut.isCollapsed(pt)){const mt=ut.getStartLineNumber(pt);nt.test(rt.getLineContent(mt))&&gt.push(ut.toRegion(pt))}ct.toggleCollapseState(gt)}function setCollapseStateForType(ct,nt,ot){const rt=ct.regions,ut=[];for(let gt=rt.length-1;gt>=0;gt--)ot!==rt.isCollapsed(gt)&&nt===rt.getType(gt)&&ut.push(rt.toRegion(gt));ct.toggleCollapseState(ut)}function getParentFoldLine(ct,nt){let ot=null;const rt=nt.getRegionAtLine(ct);if(rt!==null&&(ot=rt.startLineNumber,ct===ot)){const ut=rt.parentIndex;ut!==-1?ot=nt.regions.getStartLineNumber(ut):ot=null}return ot}function getPreviousFoldLine(ct,nt){let ot=nt.getRegionAtLine(ct);if(ot!==null&&ot.startLineNumber===ct){if(ct!==ot.startLineNumber)return ot.startLineNumber;{const rt=ot.parentIndex;let ut=0;for(rt!==-1&&(ut=nt.regions.getStartLineNumber(ot.parentIndex));ot!==null;)if(ot.regionIndex>0){if(ot=nt.regions.toRegion(ot.regionIndex-1),ot.startLineNumber<=ut)return null;if(ot.parentIndex===rt)return ot.startLineNumber}else return null}}else if(nt.regions.length>0)for(ot=nt.regions.toRegion(nt.regions.length-1);ot!==null;){if(ot.startLineNumber<ct)return ot.startLineNumber;ot.regionIndex>0?ot=nt.regions.toRegion(ot.regionIndex-1):ot=null}return null}function getNextFoldLine(ct,nt){let ot=nt.getRegionAtLine(ct);if(ot!==null&&ot.startLineNumber===ct){const rt=ot.parentIndex;let ut=0;if(rt!==-1)ut=nt.regions.getEndLineNumber(ot.parentIndex);else{if(nt.regions.length===0)return null;ut=nt.regions.getEndLineNumber(nt.regions.length-1)}for(;ot!==null;)if(ot.regionIndex<nt.regions.length){if(ot=nt.regions.toRegion(ot.regionIndex+1),ot.startLineNumber>=ut)return null;if(ot.parentIndex===rt)return ot.startLineNumber}else return null}else if(nt.regions.length>0)for(ot=nt.regions.toRegion(0);ot!==null;){if(ot.startLineNumber>ct)return ot.startLineNumber;ot.regionIndex<nt.regions.length?ot=nt.regions.toRegion(ot.regionIndex+1):ot=null}return null}class HiddenRangeModel{get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}constructor(nt){this._updateEventEmitter=new Emitter$2,this._hasLineChanges=!1,this._foldingModel=nt,this._foldingModelListener=nt.onDidChange(ot=>this.updateHiddenRanges()),this._hiddenRanges=[],nt.regions.length&&this.updateHiddenRanges()}notifyChangeModelContent(nt){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=nt.changes.some(ot=>ot.range.endLineNumber!==ot.range.startLineNumber||countEOL(ot.text)[0]!==0))}updateHiddenRanges(){let nt=!1;const ot=[];let rt=0,ut=0,gt=Number.MAX_VALUE,pt=-1;const mt=this._foldingModel.regions;for(;rt<mt.length;rt++){if(!mt.isCollapsed(rt))continue;const vt=mt.getStartLineNumber(rt)+1,St=mt.getEndLineNumber(rt);gt<=vt&&St<=pt||(!nt&&ut<this._hiddenRanges.length&&this._hiddenRanges[ut].startLineNumber===vt&&this._hiddenRanges[ut].endLineNumber===St?(ot.push(this._hiddenRanges[ut]),ut++):(nt=!0,ot.push(new Range$2(vt,1,St,1))),gt=vt,pt=St)}(this._hasLineChanges||nt||ut<this._hiddenRanges.length)&&this.applyHiddenRanges(ot)}applyHiddenRanges(nt){this._hiddenRanges=nt,this._hasLineChanges=!1,this._updateEventEmitter.fire(nt)}hasRanges(){return this._hiddenRanges.length>0}isHidden(nt){return findRange(this._hiddenRanges,nt)!==null}adjustSelections(nt){let ot=!1;const rt=this._foldingModel.textModel;let ut=null;const gt=pt=>((!ut||!isInside(pt,ut))&&(ut=findRange(this._hiddenRanges,pt)),ut?ut.startLineNumber-1:null);for(let pt=0,mt=nt.length;pt<mt;pt++){let vt=nt[pt];const St=gt(vt.startLineNumber);St&&(vt=vt.setStartPosition(St,rt.getLineMaxColumn(St)),ot=!0);const yt=gt(vt.endLineNumber);yt&&(vt=vt.setEndPosition(yt,rt.getLineMaxColumn(yt)),ot=!0),nt[pt]=vt}return ot}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function isInside(ct,nt){return ct>=nt.startLineNumber&&ct<=nt.endLineNumber}function findRange(ct,nt){const ot=findFirstInSorted(ct,rt=>nt<rt.startLineNumber)-1;return ot>=0&&ct[ot].endLineNumber>=nt?ct[ot]:null}const MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT=5e3,ID_INDENT_PROVIDER="indent";class IndentRangeProvider{constructor(nt,ot,rt){this.editorModel=nt,this.languageConfigurationService=ot,this.foldingRangesLimit=rt,this.id=ID_INDENT_PROVIDER}dispose(){}compute(nt){const ot=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,rt=ot&&!!ot.offSide,ut=ot&&ot.markers;return Promise.resolve(computeRanges(this.editorModel,rt,ut,this.foldingRangesLimit))}}let RangesCollector$1=class{constructor(nt){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=nt}insertFirst(nt,ot,rt){if(nt>MAX_LINE_NUMBER||ot>MAX_LINE_NUMBER)return;const ut=this._length;this._startIndexes[ut]=nt,this._endIndexes[ut]=ot,this._length++,rt<1e3&&(this._indentOccurrences[rt]=(this._indentOccurrences[rt]||0)+1)}toIndentRanges(nt){const ot=this._foldingRangesLimit.limit;if(this._length<=ot){this._foldingRangesLimit.update(this._length,!1);const rt=new Uint32Array(this._length),ut=new Uint32Array(this._length);for(let gt=this._length-1,pt=0;gt>=0;gt--,pt++)rt[pt]=this._startIndexes[gt],ut[pt]=this._endIndexes[gt];return new FoldingRegions(rt,ut)}else{this._foldingRangesLimit.update(this._length,ot);let rt=0,ut=this._indentOccurrences.length;for(let vt=0;vt<this._indentOccurrences.length;vt++){const St=this._indentOccurrences[vt];if(St){if(St+rt>ot){ut=vt;break}rt+=St}}const gt=nt.getOptions().tabSize,pt=new Uint32Array(ot),mt=new Uint32Array(ot);for(let vt=this._length-1,St=0;vt>=0;vt--){const yt=this._startIndexes[vt],wt=nt.getLineContent(yt),Lt=computeIndentLevel(wt,gt);(Lt<ut||Lt===ut&&rt++<ot)&&(pt[St]=yt,mt[St]=this._endIndexes[vt],St++)}return new FoldingRegions(pt,mt)}}};const foldingRangesLimitDefault={limit:MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT,update:()=>{}};function computeRanges(ct,nt,ot,rt=foldingRangesLimitDefault){const ut=ct.getOptions().tabSize,gt=new RangesCollector$1(rt);let pt;ot&&(pt=new RegExp(`(${ot.start.source})|(?:${ot.end.source})`));const mt=[],vt=ct.getLineCount()+1;mt.push({indent:-1,endAbove:vt,line:vt});for(let St=ct.getLineCount();St>0;St--){const yt=ct.getLineContent(St),wt=computeIndentLevel(yt,ut);let Lt=mt[mt.length-1];if(wt===-1){nt&&(Lt.endAbove=St);continue}let xt;if(pt&&(xt=yt.match(pt)))if(xt[1]){let It=mt.length-1;for(;It>0&&mt[It].indent!==-2;)It--;if(It>0){mt.length=It+1,Lt=mt[It],gt.insertFirst(St,Lt.line,wt),Lt.line=St,Lt.indent=wt,Lt.endAbove=St;continue}}else{mt.push({indent:-2,endAbove:St,line:St});continue}if(Lt.indent>wt){do mt.pop(),Lt=mt[mt.length-1];while(Lt.indent>wt);const It=Lt.endAbove-1;It-St>=1&&gt.insertFirst(St,It,wt)}Lt.indent===wt?Lt.endAbove=St:mt.push({indent:wt,endAbove:St,line:St})}return gt.toIndentRanges(ct)}const foldBackground=registerColor("editor.foldBackground",{light:transparent(editorSelectionBackground,.3),dark:transparent(editorSelectionBackground,.3),hcDark:null,hcLight:null},localize("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editorGutter.foldingControlForeground",{dark:iconForeground,light:iconForeground,hcDark:iconForeground,hcLight:iconForeground},localize("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));const foldingExpandedIcon=registerIcon("folding-expanded",Codicon.chevronDown,localize("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),foldingCollapsedIcon=registerIcon("folding-collapsed",Codicon.chevronRight,localize("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin.")),foldingManualCollapsedIcon=registerIcon("folding-manual-collapsed",foldingCollapsedIcon,localize("foldingManualCollapedIcon","Icon for manually collapsed ranges in the editor glyph margin.")),foldingManualExpandedIcon=registerIcon("folding-manual-expanded",foldingExpandedIcon,localize("foldingManualExpandedIcon","Icon for manually expanded ranges in the editor glyph margin.")),foldedBackgroundMinimap={color:themeColorFromId(foldBackground),position:MinimapPosition.Inline};class FoldingDecorationProvider{constructor(nt){this.editor=nt,this.showFoldingControls="mouseover",this.showFoldingHighlights=!0}getDecorationOption(nt,ot,rt){return ot?FoldingDecorationProvider.HIDDEN_RANGE_DECORATION:this.showFoldingControls==="never"?nt?this.showFoldingHighlights?FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION:FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_RANGE_DECORATION:FoldingDecorationProvider.NO_CONTROLS_EXPANDED_RANGE_DECORATION:nt?rt?this.showFoldingHighlights?FoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:FoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION:this.showFoldingHighlights?FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION:this.showFoldingControls==="mouseover"?rt?FoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION:FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:rt?FoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION:FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION}changeDecorations(nt){return this.editor.changeDecorations(nt)}removeDecorations(nt){this.editor.removeDecorations(nt)}}FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:ThemeIcon.asClassName(foldingCollapsedIcon)});FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:foldedBackgroundMinimap,isWholeLine:!0,firstLineDecorationClassName:ThemeIcon.asClassName(foldingCollapsedIcon)});FoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-manually-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:ThemeIcon.asClassName(foldingManualCollapsedIcon)});FoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-manually-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:foldedBackgroundMinimap,isWholeLine:!0,firstLineDecorationClassName:ThemeIcon.asClassName(foldingManualCollapsedIcon)});FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_RANGE_DECORATION=ModelDecorationOptions.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0});FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION=ModelDecorationOptions.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:foldedBackgroundMinimap,isWholeLine:!0});FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+ThemeIcon.asClassName(foldingExpandedIcon)});FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:ThemeIcon.asClassName(foldingExpandedIcon)});FoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-manually-expanded-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+ThemeIcon.asClassName(foldingManualExpandedIcon)});FoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-manually-expanded-auto-hide-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:ThemeIcon.asClassName(foldingManualExpandedIcon)});FoldingDecorationProvider.NO_CONTROLS_EXPANDED_RANGE_DECORATION=ModelDecorationOptions.register({description:"folding-no-controls-range-decoration",stickiness:0,isWholeLine:!0});FoldingDecorationProvider.HIDDEN_RANGE_DECORATION=ModelDecorationOptions.register({description:"folding-hidden-range-decoration",stickiness:1});const foldingContext={},ID_SYNTAX_PROVIDER="syntax";class SyntaxRangeProvider{constructor(nt,ot,rt,ut,gt){this.editorModel=nt,this.providers=ot,this.handleFoldingRangesChange=rt,this.foldingRangesLimit=ut,this.fallbackRangeProvider=gt,this.id=ID_SYNTAX_PROVIDER,this.disposables=new DisposableStore,gt&&this.disposables.add(gt);for(const pt of ot)typeof pt.onDidChange=="function"&&this.disposables.add(pt.onDidChange(rt))}compute(nt){return collectSyntaxRanges(this.providers,this.editorModel,nt).then(ot=>{var rt,ut;return ot?sanitizeRanges(ot,this.foldingRangesLimit):(ut=(rt=this.fallbackRangeProvider)===null||rt===void 0?void 0:rt.compute(nt))!==null&&ut!==void 0?ut:null})}dispose(){this.disposables.dispose()}}function collectSyntaxRanges(ct,nt,ot){let rt=null;const ut=ct.map((gt,pt)=>Promise.resolve(gt.provideFoldingRanges(nt,foldingContext,ot)).then(mt=>{if(!ot.isCancellationRequested&&Array.isArray(mt)){Array.isArray(rt)||(rt=[]);const vt=nt.getLineCount();for(const St of mt)St.start>0&&St.end>St.start&&St.end<=vt&&rt.push({start:St.start,end:St.end,rank:pt,kind:St.kind})}},onUnexpectedExternalError));return Promise.all(ut).then(gt=>rt)}class RangesCollector{constructor(nt){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=nt}add(nt,ot,rt,ut){if(nt>MAX_LINE_NUMBER||ot>MAX_LINE_NUMBER)return;const gt=this._length;this._startIndexes[gt]=nt,this._endIndexes[gt]=ot,this._nestingLevels[gt]=ut,this._types[gt]=rt,this._length++,ut<30&&(this._nestingLevelCounts[ut]=(this._nestingLevelCounts[ut]||0)+1)}toIndentRanges(){const nt=this._foldingRangesLimit.limit;if(this._length<=nt){this._foldingRangesLimit.update(this._length,!1);const ot=new Uint32Array(this._length),rt=new Uint32Array(this._length);for(let ut=0;ut<this._length;ut++)ot[ut]=this._startIndexes[ut],rt[ut]=this._endIndexes[ut];return new FoldingRegions(ot,rt,this._types)}else{this._foldingRangesLimit.update(this._length,nt);let ot=0,rt=this._nestingLevelCounts.length;for(let mt=0;mt<this._nestingLevelCounts.length;mt++){const vt=this._nestingLevelCounts[mt];if(vt){if(vt+ot>nt){rt=mt;break}ot+=vt}}const ut=new Uint32Array(nt),gt=new Uint32Array(nt),pt=[];for(let mt=0,vt=0;mt<this._length;mt++){const St=this._nestingLevels[mt];(St<rt||St===rt&&ot++<nt)&&(ut[vt]=this._startIndexes[mt],gt[vt]=this._endIndexes[mt],pt[vt]=this._types[mt],vt++)}return new FoldingRegions(ut,gt,pt)}}}function sanitizeRanges(ct,nt){const ot=ct.sort((pt,mt)=>{let vt=pt.start-mt.start;return vt===0&&(vt=pt.rank-mt.rank),vt}),rt=new RangesCollector(nt);let ut;const gt=[];for(const pt of ot)if(!ut)ut=pt,rt.add(pt.start,pt.end,pt.kind&&pt.kind.value,gt.length);else if(pt.start>ut.start)if(pt.end<=ut.end)gt.push(ut),ut=pt,rt.add(pt.start,pt.end,pt.kind&&pt.kind.value,gt.length);else{if(pt.start>ut.end){do ut=gt.pop();while(ut&&pt.start>ut.end);ut&&gt.push(ut),ut=pt}rt.add(pt.start,pt.end,pt.kind&&pt.kind.value,gt.length)}return rt.toIndentRanges()}var __decorate$Q=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$Q=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$y=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const CONTEXT_FOLDING_ENABLED=new RawContextKey("foldingEnabled",!1);let FoldingController=class xo extends Disposable{static get(nt){return nt.getContribution(xo.ID)}static getFoldingRangeProviders(nt,ot){var rt,ut;const gt=nt.foldingRangeProvider.ordered(ot);return(ut=(rt=xo._foldingRangeSelector)===null||rt===void 0?void 0:rt.call(xo,gt,ot))!==null&&ut!==void 0?ut:gt}constructor(nt,ot,rt,ut,gt,pt){super(),this.contextKeyService=ot,this.languageConfigurationService=rt,this.languageFeaturesService=pt,this.localToDispose=this._register(new DisposableStore),this.editor=nt,this._foldingLimitReporter=new RangesLimitReporter(nt);const mt=this.editor.getOptions();this._isEnabled=mt.get(41),this._useFoldingProviders=mt.get(42)!=="indentation",this._unfoldOnClickAfterEndOfLine=mt.get(46),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=mt.get(44),this.updateDebounceInfo=gt.for(pt.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new FoldingDecorationProvider(nt),this.foldingDecorationProvider.showFoldingControls=mt.get(105),this.foldingDecorationProvider.showFoldingHighlights=mt.get(43),this.foldingEnabled=CONTEXT_FOLDING_ENABLED.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel(()=>this.onModelChanged())),this._register(this.editor.onDidChangeConfiguration(vt=>{if(vt.hasChanged(41)&&(this._isEnabled=this.editor.getOptions().get(41),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),vt.hasChanged(45)&&this.onModelChanged(),vt.hasChanged(105)||vt.hasChanged(43)){const St=this.editor.getOptions();this.foldingDecorationProvider.showFoldingControls=St.get(105),this.foldingDecorationProvider.showFoldingHighlights=St.get(43),this.triggerFoldingModelChanged()}vt.hasChanged(42)&&(this._useFoldingProviders=this.editor.getOptions().get(42)!=="indentation",this.onFoldingStrategyChanged()),vt.hasChanged(46)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(46)),vt.hasChanged(44)&&(this._foldingImportsByDefault=this.editor.getOptions().get(44))})),this.onModelChanged()}saveViewState(){const nt=this.editor.getModel();if(!nt||!this._isEnabled||nt.isTooLargeForTokenization())return{};if(this.foldingModel){const ot=this.foldingModel.getMemento(),rt=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:ot,lineCount:nt.getLineCount(),provider:rt,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(nt){const ot=this.editor.getModel();if(!(!ot||!this._isEnabled||ot.isTooLargeForTokenization()||!this.hiddenRangeModel)&&nt&&(this._currentModelHasFoldedImports=!!nt.foldedImports,nt.collapsedRegions&&nt.collapsedRegions.length>0&&this.foldingModel)){this._restoringViewState=!0;try{this.foldingModel.applyMemento(nt.collapsedRegions)}finally{this._restoringViewState=!1}}}onModelChanged(){this.localToDispose.clear();const nt=this.editor.getModel();!this._isEnabled||!nt||nt.isTooLargeForTokenization()||(this._currentModelHasFoldedImports=!1,this.foldingModel=new FoldingModel(nt,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new HiddenRangeModel(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange(ot=>this.onHiddenRangesChanges(ot))),this.updateScheduler=new Delayer(this.updateDebounceInfo.get(nt)),this.cursorChangedScheduler=new RunOnceScheduler(()=>this.revealCursor(),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelContent(ot=>this.onDidChangeModelContent(ot))),this.localToDispose.add(this.editor.onDidChangeCursorPosition(()=>this.onCursorPositionChanged())),this.localToDispose.add(this.editor.onMouseDown(ot=>this.onEditorMouseDown(ot))),this.localToDispose.add(this.editor.onMouseUp(ot=>this.onEditorMouseUp(ot))),this.localToDispose.add({dispose:()=>{var ot,rt;this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),(ot=this.updateScheduler)===null||ot===void 0||ot.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,(rt=this.rangeProvider)===null||rt===void 0||rt.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){var nt;(nt=this.rangeProvider)===null||nt===void 0||nt.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(nt){if(this.rangeProvider)return this.rangeProvider;const ot=new IndentRangeProvider(nt,this.languageConfigurationService,this._foldingLimitReporter);if(this.rangeProvider=ot,this._useFoldingProviders&&this.foldingModel){const rt=xo.getFoldingRangeProviders(this.languageFeaturesService,nt);rt.length>0&&(this.rangeProvider=new SyntaxRangeProvider(nt,rt,()=>this.triggerFoldingModelChanged(),this._foldingLimitReporter,ot))}return this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(nt){var ot;(ot=this.hiddenRangeModel)===null||ot===void 0||ot.notifyChangeModelContent(nt),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger(()=>{const nt=this.foldingModel;if(!nt)return null;const ot=new StopWatch(!0),rt=this.getRangeProvider(nt.textModel),ut=this.foldingRegionPromise=createCancelablePromise(gt=>rt.compute(gt));return ut.then(gt=>{if(gt&&ut===this.foldingRegionPromise){let pt;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const yt=gt.setCollapsedAllOfType(FoldingRangeKind.Imports.value,!0);yt&&(pt=StableEditorScrollState.capture(this.editor),this._currentModelHasFoldedImports=yt)}const mt=this.editor.getSelections(),vt=mt?mt.map(yt=>yt.startLineNumber):[];nt.update(gt,vt),pt==null||pt.restore(this.editor);const St=this.updateDebounceInfo.update(nt.textModel,ot.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=St)}return nt})}).then(void 0,nt=>(onUnexpectedError(nt),null)))}onHiddenRangesChanges(nt){if(this.hiddenRangeModel&&nt.length&&!this._restoringViewState){const ot=this.editor.getSelections();ot&&this.hiddenRangeModel.adjustSelections(ot)&&this.editor.setSelections(ot)}this.editor.setHiddenAreas(nt,this)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const nt=this.getFoldingModel();nt&&nt.then(ot=>{if(ot){const rt=this.editor.getSelections();if(rt&&rt.length>0){const ut=[];for(const gt of rt){const pt=gt.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(pt)&&ut.push(...ot.getAllRegionsAtLine(pt,mt=>mt.isCollapsed&&pt>mt.startLineNumber))}ut.length&&(ot.toggleCollapseState(ut),this.reveal(rt[0].getPosition()))}}}).then(void 0,onUnexpectedError)}onEditorMouseDown(nt){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!nt.target||!nt.target.range||!nt.event.leftButton&&!nt.event.middleButton)return;const ot=nt.target.range;let rt=!1;switch(nt.target.type){case 4:{const ut=nt.target.detail,gt=nt.target.element.offsetLeft;if(ut.offsetX-gt<5)return;rt=!0;break}case 7:{if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()&&!nt.target.detail.isAfterLines)break;return}case 6:{if(this.hiddenRangeModel.hasRanges()){const ut=this.editor.getModel();if(ut&&ot.startColumn===ut.getLineMaxColumn(ot.startLineNumber))break}return}default:return}this.mouseDownInfo={lineNumber:ot.startLineNumber,iconClicked:rt}}onEditorMouseUp(nt){const ot=this.foldingModel;if(!ot||!this.mouseDownInfo||!nt.target)return;const rt=this.mouseDownInfo.lineNumber,ut=this.mouseDownInfo.iconClicked,gt=nt.target.range;if(!gt||gt.startLineNumber!==rt)return;if(ut){if(nt.target.type!==4)return}else{const mt=this.editor.getModel();if(!mt||gt.startColumn!==mt.getLineMaxColumn(rt))return}const pt=ot.getRegionAtLine(rt);if(pt&&pt.startLineNumber===rt){const mt=pt.isCollapsed;if(ut||mt){const vt=nt.event.altKey;let St=[];if(vt){const yt=Lt=>!Lt.containedBy(pt)&&!pt.containedBy(Lt),wt=ot.getRegionsInside(null,yt);for(const Lt of wt)Lt.isCollapsed&&St.push(Lt);St.length===0&&(St=wt)}else{const yt=nt.event.middleButton||nt.event.shiftKey;if(yt)for(const wt of ot.getRegionsInside(pt))wt.isCollapsed===mt&&St.push(wt);(mt||!yt||St.length===0)&&St.push(pt)}ot.toggleCollapseState(St),this.reveal({lineNumber:rt,column:1})}}}reveal(nt){this.editor.revealPositionInCenterIfOutsideViewport(nt,0)}};FoldingController.ID="editor.contrib.folding";FoldingController=__decorate$Q([__param$Q(1,IContextKeyService),__param$Q(2,ILanguageConfigurationService),__param$Q(3,INotificationService),__param$Q(4,ILanguageFeatureDebounceService),__param$Q(5,ILanguageFeaturesService)],FoldingController);class RangesLimitReporter{constructor(nt){this.editor=nt,this._onDidChange=new Emitter$2,this._computed=0,this._limited=!1}get limit(){return this.editor.getOptions().get(45)}update(nt,ot){(nt!==this._computed||ot!==this._limited)&&(this._computed=nt,this._limited=ot,this._onDidChange.fire())}}class FoldingAction extends EditorAction{runEditorCommand(nt,ot,rt){const ut=nt.get(ILanguageConfigurationService),gt=FoldingController.get(ot);if(!gt)return;const pt=gt.getFoldingModel();if(pt)return this.reportTelemetry(nt,ot),pt.then(mt=>{if(mt){this.invoke(gt,mt,ot,rt,ut);const vt=ot.getSelection();vt&&gt.reveal(vt.getStartPosition())}})}getSelectedLines(nt){const ot=nt.getSelections();return ot?ot.map(rt=>rt.startLineNumber):[]}getLineNumbers(nt,ot){return nt&&nt.selectionLines?nt.selectionLines.map(rt=>rt+1):this.getSelectedLines(ot)}run(nt,ot){}}function foldingArgumentsConstraint(ct){if(!isUndefined(ct)){if(!isObject$1(ct))return!1;const nt=ct;if(!isUndefined(nt.levels)&&!isNumber$1(nt.levels)||!isUndefined(nt.direction)&&!isString$1(nt.direction)||!isUndefined(nt.selectionLines)&&(!Array.isArray(nt.selectionLines)||!nt.selectionLines.every(isNumber$1)))return!1}return!0}class UnfoldAction extends FoldingAction{constructor(){super({id:"editor.unfold",label:localize("unfoldAction.label","Unfold"),alias:"Unfold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3166,mac:{primary:2654},weight:100},description:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:`Property-value pairs that can be passed through this argument:
						* 'levels': Number of levels to unfold. If not set, defaults to 1.
						* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.
						* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.
						`,constraint:foldingArgumentsConstraint,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(nt,ot,rt,ut){const gt=ut&&ut.levels||1,pt=this.getLineNumbers(ut,rt);ut&&ut.direction==="up"?setCollapseStateLevelsUp(ot,!1,gt,pt):setCollapseStateLevelsDown(ot,!1,gt,pt)}}class UnFoldRecursivelyAction extends FoldingAction{constructor(){super({id:"editor.unfoldRecursively",label:localize("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2142),weight:100}})}invoke(nt,ot,rt,ut){setCollapseStateLevelsDown(ot,!1,Number.MAX_VALUE,this.getSelectedLines(rt))}}class FoldAction extends FoldingAction{constructor(){super({id:"editor.fold",label:localize("foldAction.label","Fold"),alias:"Fold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3164,mac:{primary:2652},weight:100},description:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:`Property-value pairs that can be passed through this argument:
							* 'levels': Number of levels to fold.
							* 'direction': If 'up', folds given number of levels up otherwise folds down.
							* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.
							If no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.
						`,constraint:foldingArgumentsConstraint,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(nt,ot,rt,ut){const gt=this.getLineNumbers(ut,rt),pt=ut&&ut.levels,mt=ut&&ut.direction;typeof pt!="number"&&typeof mt!="string"?setCollapseStateUp(ot,!0,gt):mt==="up"?setCollapseStateLevelsUp(ot,!0,pt||1,gt):setCollapseStateLevelsDown(ot,!0,pt||1,gt)}}class ToggleFoldAction extends FoldingAction{constructor(){super({id:"editor.toggleFold",label:localize("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2090),weight:100}})}invoke(nt,ot,rt){const ut=this.getSelectedLines(rt);toggleCollapseState(ot,1,ut)}}class FoldRecursivelyAction extends FoldingAction{constructor(){super({id:"editor.foldRecursively",label:localize("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2140),weight:100}})}invoke(nt,ot,rt){const ut=this.getSelectedLines(rt);setCollapseStateLevelsDown(ot,!0,Number.MAX_VALUE,ut)}}class FoldAllBlockCommentsAction extends FoldingAction{constructor(){super({id:"editor.foldAllBlockComments",label:localize("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2138),weight:100}})}invoke(nt,ot,rt,ut,gt){if(ot.regions.hasTypes())setCollapseStateForType(ot,FoldingRangeKind.Comment.value,!0);else{const pt=rt.getModel();if(!pt)return;const mt=gt.getLanguageConfiguration(pt.getLanguageId()).comments;if(mt&&mt.blockCommentStartToken){const vt=new RegExp("^\\s*"+escapeRegExpCharacters(mt.blockCommentStartToken));setCollapseStateForMatchingLines(ot,vt,!0)}}}}class FoldAllRegionsAction extends FoldingAction{constructor(){super({id:"editor.foldAllMarkerRegions",label:localize("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2077),weight:100}})}invoke(nt,ot,rt,ut,gt){if(ot.regions.hasTypes())setCollapseStateForType(ot,FoldingRangeKind.Region.value,!0);else{const pt=rt.getModel();if(!pt)return;const mt=gt.getLanguageConfiguration(pt.getLanguageId()).foldingRules;if(mt&&mt.markers&&mt.markers.start){const vt=new RegExp(mt.markers.start);setCollapseStateForMatchingLines(ot,vt,!0)}}}}class UnfoldAllRegionsAction extends FoldingAction{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:localize("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2078),weight:100}})}invoke(nt,ot,rt,ut,gt){if(ot.regions.hasTypes())setCollapseStateForType(ot,FoldingRangeKind.Region.value,!1);else{const pt=rt.getModel();if(!pt)return;const mt=gt.getLanguageConfiguration(pt.getLanguageId()).foldingRules;if(mt&&mt.markers&&mt.markers.start){const vt=new RegExp(mt.markers.start);setCollapseStateForMatchingLines(ot,vt,!1)}}}}class FoldAllRegionsExceptAction extends FoldingAction{constructor(){super({id:"editor.foldAllExcept",label:localize("foldAllExcept.label","Fold All Regions Except Selected"),alias:"Fold All Regions Except Selected",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2136),weight:100}})}invoke(nt,ot,rt){const ut=this.getSelectedLines(rt);setCollapseStateForRest(ot,!0,ut)}}class UnfoldAllRegionsExceptAction extends FoldingAction{constructor(){super({id:"editor.unfoldAllExcept",label:localize("unfoldAllExcept.label","Unfold All Regions Except Selected"),alias:"Unfold All Regions Except Selected",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2134),weight:100}})}invoke(nt,ot,rt){const ut=this.getSelectedLines(rt);setCollapseStateForRest(ot,!1,ut)}}class FoldAllAction extends FoldingAction{constructor(){super({id:"editor.foldAll",label:localize("foldAllAction.label","Fold All"),alias:"Fold All",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2069),weight:100}})}invoke(nt,ot,rt){setCollapseStateLevelsDown(ot,!0)}}class UnfoldAllAction extends FoldingAction{constructor(){super({id:"editor.unfoldAll",label:localize("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2088),weight:100}})}invoke(nt,ot,rt){setCollapseStateLevelsDown(ot,!1)}}class FoldLevelAction extends FoldingAction{getFoldingLevel(){return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length))}invoke(nt,ot,rt){setCollapseStateAtLevel(ot,this.getFoldingLevel(),!0,this.getSelectedLines(rt))}}FoldLevelAction.ID_PREFIX="editor.foldLevel";FoldLevelAction.ID=ct=>FoldLevelAction.ID_PREFIX+ct;class GotoParentFoldAction extends FoldingAction{constructor(){super({id:"editor.gotoParentFold",label:localize("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,weight:100}})}invoke(nt,ot,rt){const ut=this.getSelectedLines(rt);if(ut.length>0){const gt=getParentFoldLine(ut[0],ot);gt!==null&&rt.setSelection({startLineNumber:gt,startColumn:1,endLineNumber:gt,endColumn:1})}}}class GotoPreviousFoldAction extends FoldingAction{constructor(){super({id:"editor.gotoPreviousFold",label:localize("gotoPreviousFold.label","Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,weight:100}})}invoke(nt,ot,rt){const ut=this.getSelectedLines(rt);if(ut.length>0){const gt=getPreviousFoldLine(ut[0],ot);gt!==null&&rt.setSelection({startLineNumber:gt,startColumn:1,endLineNumber:gt,endColumn:1})}}}class GotoNextFoldAction extends FoldingAction{constructor(){super({id:"editor.gotoNextFold",label:localize("gotoNextFold.label","Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,weight:100}})}invoke(nt,ot,rt){const ut=this.getSelectedLines(rt);if(ut.length>0){const gt=getNextFoldLine(ut[0],ot);gt!==null&&rt.setSelection({startLineNumber:gt,startColumn:1,endLineNumber:gt,endColumn:1})}}}class FoldRangeFromSelectionAction extends FoldingAction{constructor(){super({id:"editor.createFoldingRangeFromSelection",label:localize("createManualFoldRange.label","Create Folding Range from Selection"),alias:"Create Folding Range from Selection",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2135),weight:100}})}invoke(nt,ot,rt){var ut;const gt=[],pt=rt.getSelections();if(pt){for(const mt of pt){let vt=mt.endLineNumber;mt.endColumn===1&&--vt,vt>mt.startLineNumber&&(gt.push({startLineNumber:mt.startLineNumber,endLineNumber:vt,type:void 0,isCollapsed:!0,source:1}),rt.setSelection({startLineNumber:mt.startLineNumber,startColumn:1,endLineNumber:mt.startLineNumber,endColumn:1}))}if(gt.length>0){gt.sort((vt,St)=>vt.startLineNumber-St.startLineNumber);const mt=FoldingRegions.sanitizeAndMerge(ot.regions,gt,(ut=rt.getModel())===null||ut===void 0?void 0:ut.getLineCount());ot.updatePost(FoldingRegions.fromFoldRanges(mt))}}}}class RemoveFoldRangeFromSelectionAction extends FoldingAction{constructor(){super({id:"editor.removeManualFoldingRanges",label:localize("removeManualFoldingRanges.label","Remove Manual Folding Ranges"),alias:"Remove Manual Folding Ranges",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2137),weight:100}})}invoke(nt,ot,rt){const ut=rt.getSelections();if(ut){const gt=[];for(const pt of ut){const{startLineNumber:mt,endLineNumber:vt}=pt;gt.push(vt>=mt?{startLineNumber:mt,endLineNumber:vt}:{endLineNumber:vt,startLineNumber:mt})}ot.removeManualRanges(gt),nt.triggerFoldingModelChanged()}}}registerEditorContribution(FoldingController.ID,FoldingController,0);registerEditorAction(UnfoldAction);registerEditorAction(UnFoldRecursivelyAction);registerEditorAction(FoldAction);registerEditorAction(FoldRecursivelyAction);registerEditorAction(FoldAllAction);registerEditorAction(UnfoldAllAction);registerEditorAction(FoldAllBlockCommentsAction);registerEditorAction(FoldAllRegionsAction);registerEditorAction(UnfoldAllRegionsAction);registerEditorAction(FoldAllRegionsExceptAction);registerEditorAction(UnfoldAllRegionsExceptAction);registerEditorAction(ToggleFoldAction);registerEditorAction(GotoParentFoldAction);registerEditorAction(GotoPreviousFoldAction);registerEditorAction(GotoNextFoldAction);registerEditorAction(FoldRangeFromSelectionAction);registerEditorAction(RemoveFoldRangeFromSelectionAction);for(let ct=1;ct<=7;ct++)registerInstantiatedEditorAction(new FoldLevelAction({id:FoldLevelAction.ID(ct),label:localize("foldLevelAction.label","Fold Level {0}",ct),alias:`Fold Level ${ct}`,precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2048|21+ct),weight:100}}));CommandsRegistry.registerCommand("_executeFoldingRangeProvider",function(ct,...nt){return __awaiter$y(this,void 0,void 0,function*(){const[ot]=nt;if(!(ot instanceof URI))throw illegalArgument();const rt=ct.get(ILanguageFeaturesService),ut=ct.get(IModelService).getModel(ot);if(!ut)throw illegalArgument();const gt=ct.get(IConfigurationService);if(!gt.getValue("editor.folding",{resource:ot}))return[];const pt=ct.get(ILanguageConfigurationService),mt=gt.getValue("editor.foldingStrategy",{resource:ot}),vt={get limit(){return gt.getValue("editor.foldingMaximumRegions",{resource:ot})},update:(xt,It)=>{}},St=new IndentRangeProvider(ut,pt,vt);let yt=St;if(mt!=="indentation"){const xt=FoldingController.getFoldingRangeProviders(rt,ut);xt.length&&(yt=new SyntaxRangeProvider(ut,xt,()=>{},vt,St))}const wt=yield yt.compute(CancellationToken.None),Lt=[];try{if(wt)for(let xt=0;xt<wt.length;xt++){const It=wt.getType(xt);Lt.push({start:wt.getStartLineNumber(xt),end:wt.getEndLineNumber(xt),kind:It?FoldingRangeKind.fromValue(It):void 0})}return Lt}finally{yt.dispose()}})});class EditorFontZoomIn extends EditorAction{constructor(){super({id:"editor.action.fontZoomIn",label:localize("EditorFontZoomIn.label","Editor Font Zoom In"),alias:"Editor Font Zoom In",precondition:void 0})}run(nt,ot){EditorZoom.setZoomLevel(EditorZoom.getZoomLevel()+1)}}class EditorFontZoomOut extends EditorAction{constructor(){super({id:"editor.action.fontZoomOut",label:localize("EditorFontZoomOut.label","Editor Font Zoom Out"),alias:"Editor Font Zoom Out",precondition:void 0})}run(nt,ot){EditorZoom.setZoomLevel(EditorZoom.getZoomLevel()-1)}}class EditorFontZoomReset extends EditorAction{constructor(){super({id:"editor.action.fontZoomReset",label:localize("EditorFontZoomReset.label","Editor Font Zoom Reset"),alias:"Editor Font Zoom Reset",precondition:void 0})}run(nt,ot){EditorZoom.setZoomLevel(0)}}registerEditorAction(EditorFontZoomIn);registerEditorAction(EditorFontZoomOut);registerEditorAction(EditorFontZoomReset);var __decorate$P=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$P=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$x=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let FormatOnType=class{constructor(nt,ot,rt){this._editor=nt,this._languageFeaturesService=ot,this._workerService=rt,this._disposables=new DisposableStore,this._sessionDisposables=new DisposableStore,this._disposables.add(ot.onTypeFormattingEditProvider.onDidChange(this._update,this)),this._disposables.add(nt.onDidChangeModel(()=>this._update())),this._disposables.add(nt.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(nt.onDidChangeConfiguration(ut=>{ut.hasChanged(54)&&this._update()})),this._update()}dispose(){this._disposables.dispose(),this._sessionDisposables.dispose()}_update(){if(this._sessionDisposables.clear(),!this._editor.getOption(54)||!this._editor.hasModel())return;const nt=this._editor.getModel(),[ot]=this._languageFeaturesService.onTypeFormattingEditProvider.ordered(nt);if(!ot||!ot.autoFormatTriggerCharacters)return;const rt=new CharacterSet;for(const ut of ot.autoFormatTriggerCharacters)rt.add(ut.charCodeAt(0));this._sessionDisposables.add(this._editor.onDidType(ut=>{const gt=ut.charCodeAt(ut.length-1);rt.has(gt)&&this._trigger(String.fromCharCode(gt))}))}_trigger(nt){if(!this._editor.hasModel()||this._editor.getSelections().length>1||!this._editor.getSelection().isEmpty())return;const ot=this._editor.getModel(),rt=this._editor.getPosition(),ut=new CancellationTokenSource$1,gt=this._editor.onDidChangeModelContent(pt=>{if(pt.isFlush){ut.cancel(),gt.dispose();return}for(let mt=0,vt=pt.changes.length;mt<vt;mt++)if(pt.changes[mt].range.endLineNumber<=rt.lineNumber){ut.cancel(),gt.dispose();return}});getOnTypeFormattingEdits(this._workerService,this._languageFeaturesService,ot,rt,nt,ot.getFormattingOptions(),ut.token).then(pt=>{ut.token.isCancellationRequested||isNonEmptyArray(pt)&&(FormattingEdit.execute(this._editor,pt,!0),alertFormattingEdits(pt))}).finally(()=>{gt.dispose()})}};FormatOnType.ID="editor.contrib.autoFormat";FormatOnType=__decorate$P([__param$P(1,ILanguageFeaturesService),__param$P(2,IEditorWorkerService)],FormatOnType);let FormatOnPaste=class{constructor(nt,ot,rt){this.editor=nt,this._languageFeaturesService=ot,this._instantiationService=rt,this._callOnDispose=new DisposableStore,this._callOnModel=new DisposableStore,this._callOnDispose.add(nt.onDidChangeConfiguration(()=>this._update())),this._callOnDispose.add(nt.onDidChangeModel(()=>this._update())),this._callOnDispose.add(nt.onDidChangeModelLanguage(()=>this._update())),this._callOnDispose.add(ot.documentRangeFormattingEditProvider.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(53)&&this.editor.hasModel()&&this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste(({range:nt})=>this._trigger(nt)))}_trigger(nt){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider,this.editor,nt,2,Progress.None,CancellationToken.None).catch(onUnexpectedError))}};FormatOnPaste.ID="editor.contrib.formatOnPaste";FormatOnPaste=__decorate$P([__param$P(1,ILanguageFeaturesService),__param$P(2,IInstantiationService)],FormatOnPaste);class FormatDocumentAction extends EditorAction{constructor(){super({id:"editor.action.formatDocument",label:localize("formatDocument.label","Format Document"),alias:"Format Document",precondition:ContextKeyExpr.and(EditorContextKeys.notInCompositeEditor,EditorContextKeys.writable,EditorContextKeys.hasDocumentFormattingProvider),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}run(nt,ot){return __awaiter$x(this,void 0,void 0,function*(){if(ot.hasModel()){const rt=nt.get(IInstantiationService);yield nt.get(IEditorProgressService).showWhile(rt.invokeFunction(formatDocumentWithSelectedProvider,ot,1,Progress.None,CancellationToken.None),250)}})}}class FormatSelectionAction extends EditorAction{constructor(){super({id:"editor.action.formatSelection",label:localize("formatSelection.label","Format Selection"),alias:"Format Selection",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2084),weight:100},contextMenuOpts:{when:EditorContextKeys.hasNonEmptySelection,group:"1_modification",order:1.31}})}run(nt,ot){return __awaiter$x(this,void 0,void 0,function*(){if(!ot.hasModel())return;const rt=nt.get(IInstantiationService),ut=ot.getModel(),gt=ot.getSelections().map(mt=>mt.isEmpty()?new Range$2(mt.startLineNumber,1,mt.startLineNumber,ut.getLineMaxColumn(mt.startLineNumber)):mt);yield nt.get(IEditorProgressService).showWhile(rt.invokeFunction(formatDocumentRangesWithSelectedProvider,ot,gt,1,Progress.None,CancellationToken.None),250)})}}registerEditorContribution(FormatOnType.ID,FormatOnType,2);registerEditorContribution(FormatOnPaste.ID,FormatOnPaste,2);registerEditorAction(FormatDocumentAction);registerEditorAction(FormatSelectionAction);CommandsRegistry.registerCommand("editor.action.format",ct=>__awaiter$x(void 0,void 0,void 0,function*(){const nt=ct.get(ICodeEditorService).getFocusedCodeEditor();if(!nt||!nt.hasModel())return;const ot=ct.get(ICommandService);nt.getSelection().isEmpty()?yield ot.executeCommand("editor.action.formatDocument"):yield ot.executeCommand("editor.action.formatSelection")}));var __decorate$O=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$O=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$w=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class TreeElement{remove(){var nt;(nt=this.parent)===null||nt===void 0||nt.children.delete(this.id)}static findId(nt,ot){let rt;typeof nt=="string"?rt=`${ot.id}/${nt}`:(rt=`${ot.id}/${nt.name}`,ot.children.get(rt)!==void 0&&(rt=`${ot.id}/${nt.name}_${nt.range.startLineNumber}_${nt.range.startColumn}`));let ut=rt;for(let gt=0;ot.children.get(ut)!==void 0;gt++)ut=`${rt}_${gt}`;return ut}static empty(nt){return nt.children.size===0}}class OutlineElement extends TreeElement{constructor(nt,ot,rt){super(),this.id=nt,this.parent=ot,this.symbol=rt,this.children=new Map}}class OutlineGroup extends TreeElement{constructor(nt,ot,rt,ut){super(),this.id=nt,this.parent=ot,this.label=rt,this.order=ut,this.children=new Map}}class OutlineModel extends TreeElement{static create(nt,ot,rt){const ut=new CancellationTokenSource$1(rt),gt=new OutlineModel(ot.uri),pt=nt.ordered(ot),mt=pt.map((St,yt)=>{var wt;const Lt=TreeElement.findId(`provider_${yt}`,gt),xt=new OutlineGroup(Lt,gt,(wt=St.displayName)!==null&&wt!==void 0?wt:"Unknown Outline Provider",yt);return Promise.resolve(St.provideDocumentSymbols(ot,ut.token)).then(It=>{for(const kt of It||[])OutlineModel._makeOutlineElement(kt,xt);return xt},It=>(onUnexpectedExternalError(It),xt)).then(It=>{TreeElement.empty(It)?It.remove():gt._groups.set(Lt,It)})}),vt=nt.onDidChange(()=>{const St=nt.ordered(ot);equals$2(St,pt)||ut.cancel()});return Promise.all(mt).then(()=>ut.token.isCancellationRequested&&!rt.isCancellationRequested?OutlineModel.create(nt,ot,rt):gt._compact()).finally(()=>{vt.dispose()})}static _makeOutlineElement(nt,ot){const rt=TreeElement.findId(nt,ot),ut=new OutlineElement(rt,ot,nt);if(nt.children)for(const gt of nt.children)OutlineModel._makeOutlineElement(gt,ut);ot.children.set(ut.id,ut)}constructor(nt){super(),this.uri=nt,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}_compact(){let nt=0;for(const[ot,rt]of this._groups)rt.children.size===0?this._groups.delete(ot):nt+=1;if(nt!==1)this.children=this._groups;else{const ot=Iterable.first(this._groups.values());for(const[,rt]of ot.children)rt.parent=this,this.children.set(rt.id,rt)}return this}getTopLevelSymbols(){const nt=[];for(const ot of this.children.values())ot instanceof OutlineElement?nt.push(ot.symbol):nt.push(...Iterable.map(ot.children.values(),rt=>rt.symbol));return nt.sort((ot,rt)=>Range$2.compareRangesUsingStarts(ot.range,rt.range))}asListOfDocumentSymbols(){const nt=this.getTopLevelSymbols(),ot=[];return OutlineModel._flattenDocumentSymbols(ot,nt,""),ot.sort((rt,ut)=>Position$1.compare(Range$2.getStartPosition(rt.range),Range$2.getStartPosition(ut.range))||Position$1.compare(Range$2.getEndPosition(ut.range),Range$2.getEndPosition(rt.range)))}static _flattenDocumentSymbols(nt,ot,rt){for(const ut of ot)nt.push({kind:ut.kind,tags:ut.tags,name:ut.name,detail:ut.detail,containerName:ut.containerName||rt,range:ut.range,selectionRange:ut.selectionRange,children:void 0}),ut.children&&OutlineModel._flattenDocumentSymbols(nt,ut.children,ut.name)}}const IOutlineModelService=createDecorator("IOutlineModelService");let OutlineModelService=class{constructor(nt,ot,rt){this._languageFeaturesService=nt,this._disposables=new DisposableStore,this._cache=new LRUCache(10,.7),this._debounceInformation=ot.for(nt.documentSymbolProvider,"DocumentSymbols",{min:350}),this._disposables.add(rt.onModelRemoved(ut=>{this._cache.delete(ut.id)}))}dispose(){this._disposables.dispose()}getOrCreate(nt,ot){return __awaiter$w(this,void 0,void 0,function*(){const rt=this._languageFeaturesService.documentSymbolProvider,ut=rt.ordered(nt);let gt=this._cache.get(nt.id);if(!gt||gt.versionId!==nt.getVersionId()||!equals$2(gt.provider,ut)){const mt=new CancellationTokenSource$1;gt={versionId:nt.getVersionId(),provider:ut,promiseCnt:0,source:mt,promise:OutlineModel.create(rt,nt,mt.token),model:void 0},this._cache.set(nt.id,gt);const vt=Date.now();gt.promise.then(St=>{gt.model=St,this._debounceInformation.update(nt,Date.now()-vt)}).catch(St=>{this._cache.delete(nt.id)})}if(gt.model)return gt.model;gt.promiseCnt+=1;const pt=ot.onCancellationRequested(()=>{--gt.promiseCnt===0&&(gt.source.cancel(),this._cache.delete(nt.id))});try{return yield gt.promise}finally{pt.dispose()}})}};OutlineModelService=__decorate$O([__param$O(0,ILanguageFeaturesService),__param$O(1,ILanguageFeatureDebounceService),__param$O(2,IModelService)],OutlineModelService);registerSingleton(IOutlineModelService,OutlineModelService,1);var __awaiter$v=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};CommandsRegistry.registerCommand("_executeDocumentSymbolProvider",function(ct,...nt){return __awaiter$v(this,void 0,void 0,function*(){const[ot]=nt;assertType(URI.isUri(ot));const rt=ct.get(IOutlineModelService),gt=yield ct.get(ITextModelService).createModelReference(ot);try{return(yield rt.getOrCreate(gt.object.textEditorModel,CancellationToken.None)).getTopLevelSymbols()}finally{gt.dispose()}})});class InlineCompletionContextKeys extends Disposable{constructor(nt,ot){super(),this.contextKeyService=nt,this.model=ot,this.inlineCompletionVisible=InlineCompletionContextKeys.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=InlineCompletionContextKeys.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=InlineCompletionContextKeys.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService),this.suppressSuggestions=InlineCompletionContextKeys.suppressSuggestions.bindTo(this.contextKeyService),this._register(autorun("update context key: inlineCompletionVisible, suppressSuggestions",rt=>{const ut=this.model.read(rt),gt=ut==null?void 0:ut.selectedInlineCompletion.read(rt),pt=ut==null?void 0:ut.ghostText.read(rt),mt=ut==null?void 0:ut.selectedSuggestItem.read(rt);this.inlineCompletionVisible.set(mt===void 0&&pt!==void 0),pt&&gt&&this.suppressSuggestions.set(gt.inlineCompletion.source.inlineCompletions.suppressSuggestions)})),this._register(autorun("update context key: inlineCompletionSuggestsIndentation, inlineCompletionSuggestsIndentationLessThanTabSize",rt=>{const ut=this.model.read(rt);let gt=!1,pt=!0;const mt=ut==null?void 0:ut.ghostText.read(rt);if(ut!=null&&ut.selectedSuggestItem&&mt&&mt.parts.length>0){const{column:vt,lines:St}=mt.parts[0],yt=St[0],wt=ut.textModel.getLineIndentColumn(mt.lineNumber);if(vt<=wt){let xt=firstNonWhitespaceIndex(yt);xt===-1&&(xt=yt.length-1),gt=xt>0;const It=ut.textModel.getOptions().tabSize;pt=CursorColumns.visibleColumnFromColumn(yt,xt+1,It)<It}}this.inlineCompletionSuggestsIndentation.set(gt),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(pt)}))}}InlineCompletionContextKeys.inlineSuggestionVisible=new RawContextKey("inlineSuggestionVisible",!1,localize("inlineSuggestionVisible","Whether an inline suggestion is visible"));InlineCompletionContextKeys.inlineSuggestionHasIndentation=new RawContextKey("inlineSuggestionHasIndentation",!1,localize("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace"));InlineCompletionContextKeys.inlineSuggestionHasIndentationLessThanTabSize=new RawContextKey("inlineSuggestionHasIndentationLessThanTabSize",!0,localize("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab"));InlineCompletionContextKeys.alwaysShowInlineSuggestionToolbar=new RawContextKey("alwaysShowInlineSuggestionToolbar",!1,localize("alwaysShowInlineSuggestionToolbar","Whether the inline suggestion toolbar should always be visible"));InlineCompletionContextKeys.suppressSuggestions=new RawContextKey("inlineSuggestionSuppressSuggestions",void 0,localize("suppressSuggestions","Whether suggestions should be suppressed for the current suggestion"));const ghostText="";function applyEdits(ct,nt){const ot=new PositionOffsetTransformer(ct),rt=nt.map(ut=>{const gt=Range$2.lift(ut.range);return{startOffset:ot.getOffset(gt.getStartPosition()),endOffset:ot.getOffset(gt.getEndPosition()),text:ut.text}});rt.sort((ut,gt)=>gt.startOffset-ut.startOffset);for(const ut of rt)ct=ct.substring(0,ut.startOffset)+ut.text+ct.substring(ut.endOffset);return ct}class PositionOffsetTransformer{constructor(nt){this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let ot=0;ot<nt.length;ot++)nt.charAt(ot)===`
`&&this.lineStartOffsetByLineIdx.push(ot+1)}getOffset(nt){return this.lineStartOffsetByLineIdx[nt.lineNumber-1]+nt.column-1}}const array=[];function getReadonlyEmptyArray(){return array}class ColumnRange{constructor(nt,ot){if(this.startColumn=nt,this.endColumnExclusive=ot,nt>ot)throw new BugIndicatingError(`startColumn ${nt} cannot be after endColumnExclusive ${ot}`)}toRange(nt){return new Range$2(nt,this.startColumn,nt,this.endColumnExclusive)}}function applyObservableDecorations(ct,nt){const ot=new DisposableStore,rt=ct.createDecorationsCollection();return ot.add(autorun(`Apply decorations from ${nt.debugName}`,ut=>{const gt=nt.read(ut);rt.set(gt)})),ot.add({dispose:()=>{rt.clear()}}),ot}function addPositions(ct,nt){return new Position$1(ct.lineNumber+nt.lineNumber-1,nt.lineNumber===1?ct.column+nt.column-1:nt.column)}function lengthOfText(ct){let nt=1,ot=1;for(const rt of ct)rt===`
`?(nt++,ot=1):ot++;return new Position$1(nt,ot)}class GhostText{constructor(nt,ot){this.lineNumber=nt,this.parts=ot}renderForScreenReader(nt){if(this.parts.length===0)return"";const ot=this.parts[this.parts.length-1],rt=nt.substr(0,ot.column-1);return applyEdits(rt,this.parts.map(gt=>({range:{startLineNumber:1,endLineNumber:1,startColumn:gt.column,endColumn:gt.column},text:gt.lines.join(`
`)}))).substring(this.parts[0].column-1)}get lineCount(){return 1+this.parts.reduce((nt,ot)=>nt+ot.lines.length-1,0)}}class GhostTextPart{constructor(nt,ot,rt){this.column=nt,this.lines=ot,this.preview=rt}}class GhostTextReplacement{constructor(nt,ot,rt,ut=0){this.lineNumber=nt,this.columnRange=ot,this.newLines=rt,this.additionalReservedLineCount=ut,this.parts=[new GhostTextPart(this.columnRange.endColumnExclusive,this.newLines,!1)]}}var __decorate$N=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$N=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},_a$2;let GhostTextWidget=class extends Disposable{constructor(nt,ot,rt){super(),this.editor=nt,this.model=ot,this.languageService=rt,this.isDisposed=observableValue("isDisposed",!1),this.currentTextModel=observableFromEvent(this.editor.onDidChangeModel,()=>this.editor.getModel()),this.uiState=derived("uiState",ut=>{if(this.isDisposed.read(ut))return;const gt=this.currentTextModel.read(ut);if(gt!==this.model.targetTextModel.read(ut))return;const pt=this.model.ghostText.read(ut);if(!pt)return;const mt=pt instanceof GhostTextReplacement?pt.columnRange:void 0,vt=[],St=[];function yt(kt,At){if(St.length>0){const Tt=St[St.length-1];At&&Tt.decorations.push(new LineDecoration(Tt.content.length+1,Tt.content.length+1+kt[0].length,At,0)),Tt.content+=kt[0],kt=kt.slice(1)}for(const Tt of kt)St.push({content:Tt,decorations:At?[new LineDecoration(1,Tt.length+1,At,0)]:[]})}const wt=gt.getLineContent(pt.lineNumber);let Lt,xt=0;for(const kt of pt.parts){let At=kt.lines;Lt===void 0?(vt.push({column:kt.column,text:At[0],preview:kt.preview}),At=At.slice(1)):yt([wt.substring(xt,kt.column-1)],void 0),At.length>0&&(yt(At,"ghost-text"),Lt===void 0&&kt.column<=wt.length&&(Lt=kt.column)),xt=kt.column-1}Lt!==void 0&&yt([wt.substring(xt)],void 0);const It=Lt!==void 0?new ColumnRange(Lt,wt.length+1):void 0;return{replacedRange:mt,inlineTexts:vt,additionalLines:St,hiddenRange:It,lineNumber:pt.lineNumber,additionalReservedLineCount:this.model.minReservedLineCount.read(ut),targetTextModel:gt}}),this.decorations=derived("decorations",ut=>{const gt=this.uiState.read(ut);if(!gt)return[];const pt=[];gt.replacedRange&&pt.push({range:gt.replacedRange.toRange(gt.lineNumber),options:{inlineClassName:"inline-completion-text-to-replace",description:"GhostTextReplacement"}}),gt.hiddenRange&&pt.push({range:gt.hiddenRange.toRange(gt.lineNumber),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}});for(const mt of gt.inlineTexts)pt.push({range:Range$2.fromPositions(new Position$1(gt.lineNumber,mt.column)),options:{description:"ghost-text",after:{content:mt.text,inlineClassName:mt.preview?"ghost-text-decoration-preview":"ghost-text-decoration",cursorStops:InjectedTextCursorStops.Left},showIfCollapsed:!0}});return pt}),this.additionalLinesWidget=this._register(new AdditionalLinesWidget(this.editor,this.languageService.languageIdCodec,derived("lines",ut=>{const gt=this.uiState.read(ut);return gt?{lineNumber:gt.lineNumber,additionalLines:gt.additionalLines,minReservedLineCount:gt.additionalReservedLineCount,targetTextModel:gt.targetTextModel}:void 0}))),this._register(toDisposable(()=>{this.isDisposed.set(!0,void 0)})),this._register(applyObservableDecorations(this.editor,this.decorations))}ownsViewZone(nt){return this.additionalLinesWidget.viewZoneId===nt}};GhostTextWidget=__decorate$N([__param$N(2,ILanguageService)],GhostTextWidget);class AdditionalLinesWidget extends Disposable{get viewZoneId(){return this._viewZoneId}constructor(nt,ot,rt){super(),this.editor=nt,this.languageIdCodec=ot,this.lines=rt,this._viewZoneId=void 0,this.editorOptionsChanged=observableSignalFromEvent("editorOptionChanged",Event.filter(this.editor.onDidChangeConfiguration,ut=>ut.hasChanged(31)||ut.hasChanged(112)||ut.hasChanged(94)||ut.hasChanged(89)||ut.hasChanged(49)||ut.hasChanged(48)||ut.hasChanged(64))),this._register(autorun("update view zone",ut=>{const gt=this.lines.read(ut);this.editorOptionsChanged.read(ut),gt?this.updateLines(gt.lineNumber,gt.additionalLines,gt.minReservedLineCount):this.clear()}))}dispose(){super.dispose(),this.clear()}clear(){this.editor.changeViewZones(nt=>{this._viewZoneId&&(nt.removeZone(this._viewZoneId),this._viewZoneId=void 0)})}updateLines(nt,ot,rt){const ut=this.editor.getModel();if(!ut)return;const{tabSize:gt}=ut.getOptions();this.editor.changeViewZones(pt=>{this._viewZoneId&&(pt.removeZone(this._viewZoneId),this._viewZoneId=void 0);const mt=Math.max(ot.length,rt);if(mt>0){const vt=document.createElement("div");renderLines(vt,gt,ot,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=pt.addZone({afterLineNumber:nt,heightInLines:mt,domNode:vt,afterColumnAffinity:1})}})}}function renderLines(ct,nt,ot,rt,ut){const gt=rt.get(31),pt=rt.get(112),mt="none",vt=rt.get(89),St=rt.get(49),yt=rt.get(48),wt=rt.get(64),Lt=new StringBuilder(1e4);Lt.appendString('<div class="suggest-preview-text">');for(let kt=0,At=ot.length;kt<At;kt++){const Tt=ot[kt],Rt=Tt.content;Lt.appendString('<div class="view-line'),Lt.appendString('" style="top:'),Lt.appendString(String(kt*wt)),Lt.appendString('px;width:1000000px;">');const Nt=isBasicASCII(Rt),Pt=containsRTL(Rt),Ft=LineTokens.createEmpty(Rt,ut);renderViewLine(new RenderLineInput(yt.isMonospace&&!gt,yt.canUseHalfwidthRightwardsArrow,Rt,!1,Nt,Pt,0,Ft,Tt.decorations,nt,0,yt.spaceWidth,yt.middotWidth,yt.wsmiddotWidth,pt,mt,vt,St!==EditorFontLigatures.OFF,null),Lt),Lt.appendString("</div>")}Lt.appendString("</div>"),applyFontInfo(ct,yt);const xt=Lt.build(),It=ttPolicy?ttPolicy.createHTML(xt):xt;ct.innerHTML=It}const ttPolicy=(_a$2=window.trustedTypes)===null||_a$2===void 0?void 0:_a$2.createPolicy("editorGhostText",{createHTML:ct=>ct});class SingleTextEdit{constructor(nt,ot){this.range=nt,this.text=ot}removeCommonPrefix(nt,ot){const rt=ot?this.range.intersectRanges(ot):this.range;if(!rt)return this;const ut=nt.getValueInRange(rt,1),gt=commonPrefixLength(ut,this.text),pt=addPositions(this.range.getStartPosition(),lengthOfText(ut.substring(0,gt))),mt=this.text.substring(gt),vt=Range$2.fromPositions(pt,this.range.getEndPosition());return new SingleTextEdit(vt,mt)}augments(nt){return this.text.startsWith(nt.text)&&rangeExtends(this.range,nt.range)}computeGhostText(nt,ot,rt,ut=0){let gt=this.removeCommonPrefix(nt);if(gt.range.endLineNumber!==gt.range.startLineNumber)return;const pt=nt.getLineContent(gt.range.startLineNumber),mt=getLeadingWhitespace(pt).length;if(gt.range.startColumn-1<=mt){const It=getLeadingWhitespace(gt.text).length,kt=pt.substring(gt.range.startColumn-1,mt),At=Range$2.fromPositions(gt.range.getStartPosition().delta(0,kt.length),gt.range.getEndPosition()),Tt=gt.text.startsWith(kt)?gt.text.substring(kt.length):gt.text.substring(It);gt=new SingleTextEdit(At,Tt)}const St=nt.getValueInRange(gt.range),yt=cachingDiff(St,gt.text);if(!yt)return;const wt=gt.range.startLineNumber,Lt=new Array;if(ot==="prefix"){const It=yt.filter(kt=>kt.originalLength===0);if(It.length>1||It.length===1&&It[0].originalStart!==St.length)return}const xt=gt.text.length-ut;for(const It of yt){const kt=gt.range.startColumn+It.originalStart+It.originalLength;if(ot==="subwordSmart"&&rt&&rt.lineNumber===gt.range.startLineNumber&&kt<rt.column||It.originalLength>0)return;if(It.modifiedLength===0)continue;const At=It.modifiedStart+It.modifiedLength,Tt=Math.max(It.modifiedStart,Math.min(At,xt)),Rt=gt.text.substring(It.modifiedStart,Tt),Nt=gt.text.substring(Tt,Math.max(It.modifiedStart,At));if(Rt.length>0){const Pt=splitLines(Rt);Lt.push(new GhostTextPart(kt,Pt,!1))}if(Nt.length>0){const Pt=splitLines(Nt);Lt.push(new GhostTextPart(kt,Pt,!0))}}return new GhostText(wt,Lt)}}function rangeExtends(ct,nt){return nt.getStartPosition().equals(ct.getStartPosition())&&nt.getEndPosition().isBeforeOrEqual(ct.getEndPosition())}let lastRequest;function cachingDiff(ct,nt){if((lastRequest==null?void 0:lastRequest.originalValue)===ct&&(lastRequest==null?void 0:lastRequest.newValue)===nt)return lastRequest==null?void 0:lastRequest.changes;{let ot=smartDiff(ct,nt,!0);if(ot){const rt=deletedCharacters(ot);if(rt>0){const ut=smartDiff(ct,nt,!1);ut&&deletedCharacters(ut)<rt&&(ot=ut)}}return lastRequest={originalValue:ct,newValue:nt,changes:ot},ot}}function deletedCharacters(ct){let nt=0;for(const ot of ct)nt+=ot.originalLength;return nt}function smartDiff(ct,nt,ot){if(ct.length>5e3||nt.length>5e3)return;function rt(St){let yt=0;for(let wt=0,Lt=St.length;wt<Lt;wt++){const xt=St.charCodeAt(wt);xt>yt&&(yt=xt)}return yt}const ut=Math.max(rt(ct),rt(nt));function gt(St){if(St<0)throw new Error("unexpected");return ut+St+1}function pt(St){let yt=0,wt=0;const Lt=new Int32Array(St.length);for(let xt=0,It=St.length;xt<It;xt++)if(ot&&St[xt]==="("){const kt=wt*100+yt;Lt[xt]=gt(2*kt),yt++}else if(ot&&St[xt]===")"){yt=Math.max(yt-1,0);const kt=wt*100+yt;Lt[xt]=gt(2*kt+1),yt===0&&wt++}else Lt[xt]=St.charCodeAt(xt);return Lt}const mt=pt(ct),vt=pt(nt);return new LcsDiff({getElements:()=>mt},{getElements:()=>vt}).ComputeDiff(!1).changes}function fixBracketsInLine(ct,nt){const ot=new DenseKeyProvider,rt=new LanguageAgnosticBracketTokens(ot,St=>nt.getLanguageConfiguration(St)),ut=new TextBufferTokenizer(new StaticTokenizerSource([ct]),rt),gt=parseDocument(ut,[],void 0,!0);let pt="";const mt=ct.getLineContent();function vt(St,yt){if(St.kind===2)if(vt(St.openingBracket,yt),yt=lengthAdd(yt,St.openingBracket.length),St.child&&(vt(St.child,yt),yt=lengthAdd(yt,St.child.length)),St.closingBracket)vt(St.closingBracket,yt),yt=lengthAdd(yt,St.closingBracket.length);else{const Lt=rt.getSingleLanguageBracketTokens(St.openingBracket.languageId).findClosingTokenText(St.openingBracket.bracketIds);pt+=Lt}else if(St.kind!==3){if(St.kind===0||St.kind===1)pt+=mt.substring(yt,lengthAdd(yt,St.length));else if(St.kind===4)for(const wt of St.children)vt(wt,yt),yt=lengthAdd(yt,wt.length)}}return vt(gt,lengthZero),pt}class StaticTokenizerSource{constructor(nt){this.lines=nt,this.tokenization={getLineTokens:ot=>this.lines[ot-1]}}getLineCount(){return this.lines.length}getLineLength(nt){return this.lines[nt-1].getLineContent().length}}var __awaiter$u=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function provideInlineCompletions(ct,nt,ot,rt,ut=CancellationToken.None,gt){return __awaiter$u(this,void 0,void 0,function*(){const pt=getDefaultRange(nt,ot),mt=ct.all(ot),vt=yield Promise.all(mt.map(wt=>__awaiter$u(this,void 0,void 0,function*(){try{const Lt=yield wt.provideInlineCompletions(ot,nt,rt,ut);return{provider:wt,completions:Lt}}catch(Lt){onUnexpectedExternalError(Lt)}return{provider:wt,completions:void 0}}))),St=new Map,yt=[];for(const wt of vt){const Lt=wt.completions;if(!Lt)continue;const xt=new InlineCompletionList(Lt,wt.provider);yt.push(xt);for(const It of Lt.items){const kt=InlineCompletionItem.from(It,xt,pt,ot,gt);St.set(kt.hash(),kt)}}return new InlineCompletionProviderResult(Array.from(St.values()),new Set(St.keys()),yt)})}class InlineCompletionProviderResult{constructor(nt,ot,rt){this.completions=nt,this.hashs=ot,this.providerResults=rt}has(nt){return this.hashs.has(nt.hash())}dispose(){for(const nt of this.providerResults)nt.removeRef()}}class InlineCompletionList{constructor(nt,ot){this.inlineCompletions=nt,this.provider=ot,this.refCount=1}addRef(){this.refCount++}removeRef(){this.refCount--,this.refCount===0&&this.provider.freeInlineCompletions(this.inlineCompletions)}}class InlineCompletionItem{static from(nt,ot,rt,ut,gt){let pt,mt,vt=nt.range?Range$2.lift(nt.range):rt;if(typeof nt.insertText=="string"){if(pt=nt.insertText,gt&&nt.completeBracketPairs){pt=closeBrackets(pt,vt.getStartPosition(),ut,gt);const St=pt.length-nt.insertText.length;St!==0&&(vt=new Range$2(vt.startLineNumber,vt.startColumn,vt.endLineNumber,vt.endColumn+St))}mt=void 0}else if("snippet"in nt.insertText){const St=nt.insertText.snippet.length;if(gt&&nt.completeBracketPairs){nt.insertText.snippet=closeBrackets(nt.insertText.snippet,vt.getStartPosition(),ut,gt);const wt=nt.insertText.snippet.length-St;wt!==0&&(vt=new Range$2(vt.startLineNumber,vt.startColumn,vt.endLineNumber,vt.endColumn+wt))}const yt=new SnippetParser().parse(nt.insertText.snippet);yt.children.length===1&&yt.children[0]instanceof Text?(pt=yt.children[0].value,mt=void 0):(pt=yt.toString(),mt={snippet:nt.insertText.snippet,range:vt})}else assertNever(nt.insertText);return new InlineCompletionItem(pt,nt.command,vt,pt,mt,nt.additionalTextEdits||getReadonlyEmptyArray(),nt,ot)}constructor(nt,ot,rt,ut,gt,pt,mt,vt){this.filterText=nt,this.command=ot,this.range=rt,this.insertText=ut,this.snippetInfo=gt,this.additionalTextEdits=pt,this.sourceInlineCompletion=mt,this.source=vt,nt=nt.replace(/\r\n|\r/g,`
`),ut=nt.replace(/\r\n|\r/g,`
`)}withRange(nt){return new InlineCompletionItem(this.filterText,this.command,nt,this.insertText,this.snippetInfo,this.additionalTextEdits,this.sourceInlineCompletion,this.source)}hash(){return JSON.stringify({insertText:this.insertText,range:this.range.toString()})}}function getDefaultRange(ct,nt){const ot=nt.getWordAtPosition(ct),rt=nt.getLineMaxColumn(ct.lineNumber);return ot?new Range$2(ct.lineNumber,ot.startColumn,ct.lineNumber,rt):Range$2.fromPositions(ct,ct.with(void 0,rt))}function closeBrackets(ct,nt,ot,rt){const gt=ot.getLineContent(nt.lineNumber).substring(0,nt.column-1)+ct,pt=ot.tokenization.tokenizeLineWithEdit(nt,gt.length-(nt.column-1),ct),mt=pt==null?void 0:pt.sliceAndInflate(nt.column-1,gt.length,0);return mt?fixBracketsInLine(mt,rt):ct}var __decorate$M=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$M=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$t=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let InlineCompletionsSource=class extends Disposable{constructor(nt,ot,rt,ut,gt){super(),this.textModel=nt,this.versionId=ot,this._debounceValue=rt,this.languageFeaturesService=ut,this.languageConfigurationService=gt,this.updateOperation=this._register(new MutableDisposable),this.inlineCompletions=disposableObservableValue("inlineCompletions",void 0),this.suggestWidgetInlineCompletions=disposableObservableValue("suggestWidgetInlineCompletions",void 0),this._register(this.textModel.onDidChangeContent(()=>{this.updateOperation.clear()}))}clear(nt){this.updateOperation.clear(),this.inlineCompletions.set(void 0,nt),this.suggestWidgetInlineCompletions.set(void 0,nt)}clearSuggestWidgetInlineCompletions(){var nt;!((nt=this.updateOperation.value)===null||nt===void 0)&&nt.request.context.selectedSuggestionInfo&&this.updateOperation.clear(),this.suggestWidgetInlineCompletions.set(void 0,void 0)}update(nt,ot,rt){var ut,gt;const pt=new UpdateRequest(nt,ot,this.textModel.getVersionId()),mt=ot.selectedSuggestionInfo?this.suggestWidgetInlineCompletions:this.inlineCompletions;if(!((ut=this.updateOperation.value)===null||ut===void 0)&&ut.request.satisfies(pt))return this.updateOperation.value.promise;if(!((gt=mt.get())===null||gt===void 0)&&gt.request.satisfies(pt))return Promise.resolve(!0);const vt=!!this.updateOperation.value;this.updateOperation.clear();const St=new CancellationTokenSource$1,yt=(()=>__awaiter$t(this,void 0,void 0,function*(){if((vt||ot.triggerKind===InlineCompletionTriggerKind$1.Automatic)&&(yield wait(this._debounceValue.get(this.textModel))),St.token.isCancellationRequested||this.textModel.getVersionId()!==pt.versionId)return!1;const xt=new Date,It=yield provideInlineCompletions(this.languageFeaturesService.inlineCompletionsProvider,nt,this.textModel,ot,St.token,this.languageConfigurationService);if(St.token.isCancellationRequested||this.textModel.getVersionId()!==pt.versionId)return!1;const kt=new Date;this._debounceValue.update(this.textModel,kt.getTime()-xt.getTime());const At=new UpToDateInlineCompletions(It,pt,this.textModel,this.versionId);if(rt){const Tt=rt.toInlineCompletion(void 0);rt.canBeReused(this.textModel,nt)&&!It.has(Tt)&&At.prepend(rt.inlineCompletion,Tt.range,!0)}return transaction(Tt=>{mt.set(At,Tt)}),this.updateOperation.clear(),!0}))(),wt=new UpdateOperation(pt,St,yt);return this.updateOperation.value=wt,yt}};InlineCompletionsSource=__decorate$M([__param$M(3,ILanguageFeaturesService),__param$M(4,ILanguageConfigurationService)],InlineCompletionsSource);function wait(ct,nt){return new Promise(ot=>{let rt;const ut=setTimeout(()=>{rt&&rt.dispose(),ot()},ct);nt&&(rt=nt.onCancellationRequested(()=>{clearTimeout(ut),rt&&rt.dispose(),ot()}))})}class UpdateRequest{constructor(nt,ot,rt){this.position=nt,this.context=ot,this.versionId=rt}satisfies(nt){return this.position.equals(nt.position)&&equals(this.context.selectedSuggestionInfo,nt.context.selectedSuggestionInfo,(ot,rt)=>ot.equals(rt))&&(nt.context.triggerKind===InlineCompletionTriggerKind$1.Automatic||this.context.triggerKind===InlineCompletionTriggerKind$1.Explicit)&&this.versionId===nt.versionId}}function equals(ct,nt,ot){return!ct||!nt?ct===nt:ot(ct,nt)}class UpdateOperation{constructor(nt,ot,rt){this.request=nt,this.cancellationTokenSource=ot,this.promise=rt}dispose(){this.cancellationTokenSource.cancel()}}class UpToDateInlineCompletions{get inlineCompletions(){return this._inlineCompletions}constructor(nt,ot,rt,ut){this.inlineCompletionProviderResult=nt,this.request=ot,this.textModel=rt,this.versionId=ut,this.refCount=1,this.prependedInlineCompletionItems=[],this.counter=0,this.rangeVersion=derived("ranges",pt=>{this.versionId.read(pt);let mt=!1;for(const vt of this._inlineCompletions)mt=mt||vt._updateRange(this.textModel);return mt&&this.counter++,this.counter});const gt=rt.deltaDecorations([],nt.completions.map(pt=>({range:pt.range,options:{description:"inline-completion-tracking-range"}})));this._inlineCompletions=nt.completions.map((pt,mt)=>new InlineCompletionWithUpdatedRange(pt,gt[mt],this.rangeVersion))}prepend(nt,ot,rt){rt&&nt.source.addRef();const ut=this.textModel.deltaDecorations([],[{range:ot,options:{description:"inline-completion-tracking-range"}}])[0];this._inlineCompletions.unshift(new InlineCompletionWithUpdatedRange(nt,ut,this.rangeVersion,ot)),this.prependedInlineCompletionItems.push(nt)}clone(){return this.refCount++,this}dispose(){if(this.refCount--,this.refCount===0){this.textModel.deltaDecorations(this._inlineCompletions.map(nt=>nt.decorationId),[]),this.inlineCompletionProviderResult.dispose();for(const nt of this.prependedInlineCompletionItems)nt.source.removeRef()}}}class InlineCompletionWithUpdatedRange{constructor(nt,ot,rt,ut){this.inlineCompletion=nt,this.decorationId=ot,this.rangeVersion=rt,this.semanticId=JSON.stringify([this.inlineCompletion.filterText,this.inlineCompletion.insertText,this.inlineCompletion.range.getStartPosition().toString()]),this._isValid=!0,this._updatedRange=ut??nt.range}getUpdatedRange(nt){return this.rangeVersion.read(nt),this._updatedRange}_updateRange(nt){const ot=nt.getDecorationRange(this.decorationId);return ot?this._updatedRange.equalsRange(ot)?!1:(this._updatedRange=ot,!0):(this._isValid=!1,!0)}toInlineCompletion(nt){return this.inlineCompletion.withRange(this.getUpdatedRange(nt))}toSingleTextEdit(nt){return new SingleTextEdit(this.getUpdatedRange(nt),this.inlineCompletion.insertText)}isVisible(nt,ot,rt){const ut=this.toFilterTextReplacement(rt).removeCommonPrefix(nt);if(!this._isValid||!this.inlineCompletion.range.getStartPosition().equals(this.getUpdatedRange(rt).getStartPosition())||ot.lineNumber!==ut.range.startLineNumber)return!1;const gt=nt.getValueInRange(ut.range,1).toLowerCase(),pt=ut.text.toLowerCase(),mt=Math.max(0,ot.column-ut.range.startColumn);let vt=pt.substring(0,mt),St=pt.substring(mt),yt=gt.substring(0,mt),wt=gt.substring(mt);const Lt=nt.getLineIndentColumn(ut.range.startLineNumber);return ut.range.startColumn<=Lt&&(yt=yt.trimStart(),yt.length===0&&(wt=wt.trimStart()),vt=vt.trimStart(),vt.length===0&&(St=St.trimStart())),vt.startsWith(yt)&&!!matchesSubString(wt,St)}toFilterTextReplacement(nt){return new SingleTextEdit(this.getUpdatedRange(nt),this.inlineCompletion.filterText)}canBeReused(nt,ot){return this._isValid&&this.getUpdatedRange(void 0).containsPosition(ot)&&this.isVisible(nt,ot,void 0)&&!this.isSmallerThanOriginal(void 0)}isSmallerThanOriginal(nt){return length$1(this.getUpdatedRange(nt)).isBefore(length$1(this.inlineCompletion.range))}}function length$1(ct){return ct.startLineNumber===ct.endLineNumber?new Position$1(1,1+ct.endColumn-ct.startColumn):new Position$1(1+ct.endLineNumber-ct.startLineNumber,ct.endColumn)}const snippetSession="";function normalizeDriveLetter(ct,nt=isWindows){return hasDriveLetter(ct,nt)?ct.charAt(0).toUpperCase()+ct.slice(1):ct}var __decorate$L=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$L=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};class CompositeSnippetVariableResolver{constructor(nt){this._delegates=nt}resolve(nt){for(const ot of this._delegates){const rt=ot.resolve(nt);if(rt!==void 0)return rt}}}class SelectionBasedVariableResolver{constructor(nt,ot,rt,ut){this._model=nt,this._selection=ot,this._selectionIdx=rt,this._overtypingCapturer=ut}resolve(nt){const{name:ot}=nt;if(ot==="SELECTION"||ot==="TM_SELECTED_TEXT"){let rt=this._model.getValueInRange(this._selection)||void 0,ut=this._selection.startLineNumber!==this._selection.endLineNumber;if(!rt&&this._overtypingCapturer){const gt=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);gt&&(rt=gt.value,ut=gt.multiline)}if(rt&&ut&&nt.snippet){const gt=this._model.getLineContent(this._selection.startLineNumber),pt=getLeadingWhitespace(gt,0,this._selection.startColumn-1);let mt=pt;nt.snippet.walk(St=>St===nt?!1:(St instanceof Text&&(mt=getLeadingWhitespace(splitLines(St.value).pop())),!0));const vt=commonPrefixLength(mt,pt);rt=rt.replace(/(\r\n|\r|\n)(.*)/g,(St,yt,wt)=>`${yt}${mt.substr(vt)}${wt}`)}return rt}else{if(ot==="TM_CURRENT_LINE")return this._model.getLineContent(this._selection.positionLineNumber);if(ot==="TM_CURRENT_WORD"){const rt=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return rt&&rt.word||void 0}else{if(ot==="TM_LINE_INDEX")return String(this._selection.positionLineNumber-1);if(ot==="TM_LINE_NUMBER")return String(this._selection.positionLineNumber);if(ot==="CURSOR_INDEX")return String(this._selectionIdx);if(ot==="CURSOR_NUMBER")return String(this._selectionIdx+1)}}}}class ModelBasedVariableResolver{constructor(nt,ot){this._labelService=nt,this._model=ot}resolve(nt){const{name:ot}=nt;if(ot==="TM_FILENAME")return basename$1(this._model.uri.fsPath);if(ot==="TM_FILENAME_BASE"){const rt=basename$1(this._model.uri.fsPath),ut=rt.lastIndexOf(".");return ut<=0?rt:rt.slice(0,ut)}else{if(ot==="TM_DIRECTORY")return dirname$1(this._model.uri.fsPath)==="."?"":this._labelService.getUriLabel(dirname(this._model.uri));if(ot==="TM_FILEPATH")return this._labelService.getUriLabel(this._model.uri);if(ot==="RELATIVE_FILEPATH")return this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0})}}}class ClipboardBasedVariableResolver{constructor(nt,ot,rt,ut){this._readClipboardText=nt,this._selectionIdx=ot,this._selectionCount=rt,this._spread=ut}resolve(nt){if(nt.name!=="CLIPBOARD")return;const ot=this._readClipboardText();if(ot){if(this._spread){const rt=ot.split(/\r\n|\n|\r/).filter(ut=>!isFalsyOrWhitespace(ut));if(rt.length===this._selectionCount)return rt[this._selectionIdx]}return ot}}}let CommentBasedVariableResolver=class{constructor(nt,ot,rt){this._model=nt,this._selection=ot,this._languageConfigurationService=rt}resolve(nt){const{name:ot}=nt,rt=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),ut=this._languageConfigurationService.getLanguageConfiguration(rt).comments;if(ut){if(ot==="LINE_COMMENT")return ut.lineCommentToken||void 0;if(ot==="BLOCK_COMMENT_START")return ut.blockCommentStartToken||void 0;if(ot==="BLOCK_COMMENT_END")return ut.blockCommentEndToken||void 0}}};CommentBasedVariableResolver=__decorate$L([__param$L(2,ILanguageConfigurationService)],CommentBasedVariableResolver);class TimeBasedVariableResolver{constructor(){this._date=new Date}resolve(nt){const{name:ot}=nt;if(ot==="CURRENT_YEAR")return String(this._date.getFullYear());if(ot==="CURRENT_YEAR_SHORT")return String(this._date.getFullYear()).slice(-2);if(ot==="CURRENT_MONTH")return String(this._date.getMonth().valueOf()+1).padStart(2,"0");if(ot==="CURRENT_DATE")return String(this._date.getDate().valueOf()).padStart(2,"0");if(ot==="CURRENT_HOUR")return String(this._date.getHours().valueOf()).padStart(2,"0");if(ot==="CURRENT_MINUTE")return String(this._date.getMinutes().valueOf()).padStart(2,"0");if(ot==="CURRENT_SECOND")return String(this._date.getSeconds().valueOf()).padStart(2,"0");if(ot==="CURRENT_DAY_NAME")return TimeBasedVariableResolver.dayNames[this._date.getDay()];if(ot==="CURRENT_DAY_NAME_SHORT")return TimeBasedVariableResolver.dayNamesShort[this._date.getDay()];if(ot==="CURRENT_MONTH_NAME")return TimeBasedVariableResolver.monthNames[this._date.getMonth()];if(ot==="CURRENT_MONTH_NAME_SHORT")return TimeBasedVariableResolver.monthNamesShort[this._date.getMonth()];if(ot==="CURRENT_SECONDS_UNIX")return String(Math.floor(this._date.getTime()/1e3));if(ot==="CURRENT_TIMEZONE_OFFSET"){const rt=this._date.getTimezoneOffset(),ut=rt>0?"-":"+",gt=Math.trunc(Math.abs(rt/60)),pt=gt<10?"0"+gt:gt,mt=Math.abs(rt)-gt*60,vt=mt<10?"0"+mt:mt;return ut+pt+":"+vt}}}TimeBasedVariableResolver.dayNames=[localize("Sunday","Sunday"),localize("Monday","Monday"),localize("Tuesday","Tuesday"),localize("Wednesday","Wednesday"),localize("Thursday","Thursday"),localize("Friday","Friday"),localize("Saturday","Saturday")];TimeBasedVariableResolver.dayNamesShort=[localize("SundayShort","Sun"),localize("MondayShort","Mon"),localize("TuesdayShort","Tue"),localize("WednesdayShort","Wed"),localize("ThursdayShort","Thu"),localize("FridayShort","Fri"),localize("SaturdayShort","Sat")];TimeBasedVariableResolver.monthNames=[localize("January","January"),localize("February","February"),localize("March","March"),localize("April","April"),localize("May","May"),localize("June","June"),localize("July","July"),localize("August","August"),localize("September","September"),localize("October","October"),localize("November","November"),localize("December","December")];TimeBasedVariableResolver.monthNamesShort=[localize("JanuaryShort","Jan"),localize("FebruaryShort","Feb"),localize("MarchShort","Mar"),localize("AprilShort","Apr"),localize("MayShort","May"),localize("JuneShort","Jun"),localize("JulyShort","Jul"),localize("AugustShort","Aug"),localize("SeptemberShort","Sep"),localize("OctoberShort","Oct"),localize("NovemberShort","Nov"),localize("DecemberShort","Dec")];class WorkspaceBasedVariableResolver{constructor(nt){this._workspaceService=nt}resolve(nt){if(!this._workspaceService)return;const ot=toWorkspaceIdentifier(this._workspaceService.getWorkspace());if(!isEmptyWorkspaceIdentifier(ot)){if(nt.name==="WORKSPACE_NAME")return this._resolveWorkspaceName(ot);if(nt.name==="WORKSPACE_FOLDER")return this._resoveWorkspacePath(ot)}}_resolveWorkspaceName(nt){if(isSingleFolderWorkspaceIdentifier(nt))return basename$1(nt.uri.path);let ot=basename$1(nt.configPath.path);return ot.endsWith(WORKSPACE_EXTENSION)&&(ot=ot.substr(0,ot.length-WORKSPACE_EXTENSION.length-1)),ot}_resoveWorkspacePath(nt){if(isSingleFolderWorkspaceIdentifier(nt))return normalizeDriveLetter(nt.uri.fsPath);const ot=basename$1(nt.configPath.path);let rt=nt.configPath.fsPath;return rt.endsWith(ot)&&(rt=rt.substr(0,rt.length-ot.length-1)),rt?normalizeDriveLetter(rt):"/"}}class RandomBasedVariableResolver{resolve(nt){const{name:ot}=nt;if(ot==="RANDOM")return Math.random().toString().slice(-6);if(ot==="RANDOM_HEX")return Math.random().toString(16).slice(-6);if(ot==="UUID")return generateUuid()}}var __decorate$K=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$K=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};class OneSnippet{constructor(nt,ot,rt){this._editor=nt,this._snippet=ot,this._snippetLineLeadingWhitespace=rt,this._offset=-1,this._nestingLevel=1,this._placeholderGroups=groupBy(ot.placeholders,Placeholder.compareByIndex),this._placeholderGroupsIdx=-1}initialize(nt){this._offset=nt.newPosition}dispose(){this._placeholderDecorations&&this._editor.removeDecorations([...this._placeholderDecorations.values()]),this._placeholderGroups.length=0}_initDecorations(){if(this._offset===-1)throw new Error("Snippet not initialized!");if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const nt=this._editor.getModel();this._editor.changeDecorations(ot=>{for(const rt of this._snippet.placeholders){const ut=this._snippet.offset(rt),gt=this._snippet.fullLen(rt),pt=Range$2.fromPositions(nt.getPositionAt(this._offset+ut),nt.getPositionAt(this._offset+ut+gt)),mt=rt.isFinalTabstop?OneSnippet._decor.inactiveFinal:OneSnippet._decor.inactive,vt=ot.addDecoration(pt,mt);this._placeholderDecorations.set(rt,vt)}})}move(nt){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){const ut=[];for(const gt of this._placeholderGroups[this._placeholderGroupsIdx])if(gt.transform){const pt=this._placeholderDecorations.get(gt),mt=this._editor.getModel().getDecorationRange(pt),vt=this._editor.getModel().getValueInRange(mt),St=gt.transform.resolve(vt).split(/\r\n|\r|\n/);for(let yt=1;yt<St.length;yt++)St[yt]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+St[yt]);ut.push(EditOperation.replace(mt,St.join(this._editor.getModel().getEOL())))}ut.length>0&&this._editor.executeEdits("snippet.placeholderTransform",ut)}let ot=!1;nt===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,ot=!0):nt===!1&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,ot=!0);const rt=this._editor.getModel().changeDecorations(ut=>{const gt=new Set,pt=[];for(const mt of this._placeholderGroups[this._placeholderGroupsIdx]){const vt=this._placeholderDecorations.get(mt),St=this._editor.getModel().getDecorationRange(vt);pt.push(new Selection$1(St.startLineNumber,St.startColumn,St.endLineNumber,St.endColumn)),ot=ot&&this._hasPlaceholderBeenCollapsed(mt),ut.changeDecorationOptions(vt,mt.isFinalTabstop?OneSnippet._decor.activeFinal:OneSnippet._decor.active),gt.add(mt);for(const yt of this._snippet.enclosingPlaceholders(mt)){const wt=this._placeholderDecorations.get(yt);ut.changeDecorationOptions(wt,yt.isFinalTabstop?OneSnippet._decor.activeFinal:OneSnippet._decor.active),gt.add(yt)}}for(const[mt,vt]of this._placeholderDecorations)gt.has(mt)||ut.changeDecorationOptions(vt,mt.isFinalTabstop?OneSnippet._decor.inactiveFinal:OneSnippet._decor.inactive);return pt});return ot?this.move(nt):rt??[]}_hasPlaceholderBeenCollapsed(nt){let ot=nt;for(;ot;){if(ot instanceof Placeholder){const rt=this._placeholderDecorations.get(ot);if(this._editor.getModel().getDecorationRange(rt).isEmpty()&&ot.toString().length>0)return!0}ot=ot.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get isTrivialSnippet(){if(this._snippet.placeholders.length===0)return!0;if(this._snippet.placeholders.length===1){const[nt]=this._snippet.placeholders;if(nt.isFinalTabstop&&this._snippet.rightMostDescendant===nt)return!0}return!1}computePossibleSelections(){const nt=new Map;for(const ot of this._placeholderGroups){let rt;for(const ut of ot){if(ut.isFinalTabstop)break;rt||(rt=[],nt.set(ut.index,rt));const gt=this._placeholderDecorations.get(ut),pt=this._editor.getModel().getDecorationRange(gt);if(!pt){nt.delete(ut.index);break}rt.push(pt)}}return nt}get activeChoice(){if(!this._placeholderDecorations)return;const nt=this._placeholderGroups[this._placeholderGroupsIdx][0];if(!(nt!=null&&nt.choice))return;const ot=this._placeholderDecorations.get(nt);if(!ot)return;const rt=this._editor.getModel().getDecorationRange(ot);if(rt)return{range:rt,choice:nt.choice}}get hasChoice(){let nt=!1;return this._snippet.walk(ot=>(nt=ot instanceof Choice,!nt)),nt}merge(nt){const ot=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations(rt=>{for(const ut of this._placeholderGroups[this._placeholderGroupsIdx]){const gt=nt.shift();console.assert(gt._offset!==-1),console.assert(!gt._placeholderDecorations);const pt=gt._snippet.placeholderInfo.last.index;for(const vt of gt._snippet.placeholderInfo.all)vt.isFinalTabstop?vt.index=ut.index+(pt+1)/this._nestingLevel:vt.index=ut.index+vt.index/this._nestingLevel;this._snippet.replace(ut,gt._snippet.children);const mt=this._placeholderDecorations.get(ut);rt.removeDecoration(mt),this._placeholderDecorations.delete(ut);for(const vt of gt._snippet.placeholders){const St=gt._snippet.offset(vt),yt=gt._snippet.fullLen(vt),wt=Range$2.fromPositions(ot.getPositionAt(gt._offset+St),ot.getPositionAt(gt._offset+St+yt)),Lt=rt.addDecoration(wt,OneSnippet._decor.inactive);this._placeholderDecorations.set(vt,Lt)}}this._placeholderGroups=groupBy(this._snippet.placeholders,Placeholder.compareByIndex)})}}OneSnippet._decor={active:ModelDecorationOptions.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:ModelDecorationOptions.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:ModelDecorationOptions.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:ModelDecorationOptions.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};const _defaultOptions$1={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let SnippetSession=class ro{static adjustWhitespace(nt,ot,rt,ut,gt){const pt=nt.getLineContent(ot.lineNumber),mt=getLeadingWhitespace(pt,0,ot.column-1);let vt;return ut.walk(St=>{if(!(St instanceof Text)||St.parent instanceof Choice||gt&&!gt.has(St))return!0;const yt=St.value.split(/\r\n|\r|\n/);if(rt){const Lt=ut.offset(St);if(Lt===0)yt[0]=nt.normalizeIndentation(yt[0]);else{vt=vt??ut.toString();const xt=vt.charCodeAt(Lt-1);(xt===10||xt===13)&&(yt[0]=nt.normalizeIndentation(mt+yt[0]))}for(let xt=1;xt<yt.length;xt++)yt[xt]=nt.normalizeIndentation(mt+yt[xt])}const wt=yt.join(nt.getEOL());return wt!==St.value&&(St.parent.replace(St,[new Text(wt)]),vt=void 0),!0}),mt}static adjustSelection(nt,ot,rt,ut){if(rt!==0||ut!==0){const{positionLineNumber:gt,positionColumn:pt}=ot,mt=pt-rt,vt=pt+ut,St=nt.validateRange({startLineNumber:gt,startColumn:mt,endLineNumber:gt,endColumn:vt});ot=Selection$1.createWithDirection(St.startLineNumber,St.startColumn,St.endLineNumber,St.endColumn,ot.getDirection())}return ot}static createEditsAndSnippetsFromSelections(nt,ot,rt,ut,gt,pt,mt,vt,St){const yt=[],wt=[];if(!nt.hasModel())return{edits:yt,snippets:wt};const Lt=nt.getModel(),xt=nt.invokeWithinContext(Pt=>Pt.get(IWorkspaceContextService)),It=nt.invokeWithinContext(Pt=>new ModelBasedVariableResolver(Pt.get(ILabelService),Lt)),kt=()=>mt,At=Lt.getValueInRange(ro.adjustSelection(Lt,nt.getSelection(),rt,0)),Tt=Lt.getValueInRange(ro.adjustSelection(Lt,nt.getSelection(),0,ut)),Rt=Lt.getLineFirstNonWhitespaceColumn(nt.getSelection().positionLineNumber),Nt=nt.getSelections().map((Pt,Ft)=>({selection:Pt,idx:Ft})).sort((Pt,Ft)=>Range$2.compareRangesUsingStarts(Pt.selection,Ft.selection));for(const{selection:Pt,idx:Ft}of Nt){let Kt=ro.adjustSelection(Lt,Pt,rt,0),Bt=ro.adjustSelection(Lt,Pt,0,ut);At!==Lt.getValueInRange(Kt)&&(Kt=Pt),Tt!==Lt.getValueInRange(Bt)&&(Bt=Pt);const Ut=Pt.setStartPosition(Kt.startLineNumber,Kt.startColumn).setEndPosition(Bt.endLineNumber,Bt.endColumn),qt=new SnippetParser().parse(ot,!0,gt),Yt=Ut.getStartPosition(),Zt=ro.adjustWhitespace(Lt,Yt,pt||Ft>0&&Rt!==Lt.getLineFirstNonWhitespaceColumn(Pt.positionLineNumber),qt);qt.resolveVariables(new CompositeSnippetVariableResolver([It,new ClipboardBasedVariableResolver(kt,Ft,Nt.length,nt.getOption(76)==="spread"),new SelectionBasedVariableResolver(Lt,Pt,Ft,vt),new CommentBasedVariableResolver(Lt,Pt,St),new TimeBasedVariableResolver,new WorkspaceBasedVariableResolver(xt),new RandomBasedVariableResolver])),yt[Ft]=EditOperation.replace(Ut,qt.toString()),yt[Ft].identifier={major:Ft,minor:0},yt[Ft]._isTracked=!0,wt[Ft]=new OneSnippet(nt,qt,Zt)}return{edits:yt,snippets:wt}}static createEditsAndSnippetsFromEdits(nt,ot,rt,ut,gt,pt,mt){if(!nt.hasModel()||ot.length===0)return{edits:[],snippets:[]};const vt=[],St=nt.getModel(),yt=new SnippetParser,wt=new TextmateSnippet,Lt=new CompositeSnippetVariableResolver([nt.invokeWithinContext(It=>new ModelBasedVariableResolver(It.get(ILabelService),St)),new ClipboardBasedVariableResolver(()=>gt,0,nt.getSelections().length,nt.getOption(76)==="spread"),new SelectionBasedVariableResolver(St,nt.getSelection(),0,pt),new CommentBasedVariableResolver(St,nt.getSelection(),mt),new TimeBasedVariableResolver,new WorkspaceBasedVariableResolver(nt.invokeWithinContext(It=>It.get(IWorkspaceContextService))),new RandomBasedVariableResolver]);ot=ot.sort((It,kt)=>Range$2.compareRangesUsingStarts(It.range,kt.range));let xt=0;for(let It=0;It<ot.length;It++){const{range:kt,template:At}=ot[It];if(It>0){const Ft=ot[It-1].range,Kt=Range$2.fromPositions(Ft.getEndPosition(),kt.getStartPosition()),Bt=new Text(St.getValueInRange(Kt));wt.appendChild(Bt),xt+=Bt.value.length}const Tt=yt.parseFragment(At,wt);ro.adjustWhitespace(St,kt.getStartPosition(),!0,wt,new Set(Tt)),wt.resolveVariables(Lt);const Rt=wt.toString(),Nt=Rt.slice(xt);xt=Rt.length;const Pt=EditOperation.replace(kt,Nt);Pt.identifier={major:It,minor:0},Pt._isTracked=!0,vt.push(Pt)}return yt.ensureFinalTabstop(wt,rt,!0),{edits:vt,snippets:[new OneSnippet(nt,wt,"")]}}constructor(nt,ot,rt=_defaultOptions$1,ut){this._editor=nt,this._template=ot,this._options=rt,this._languageConfigurationService=ut,this._templateMerges=[],this._snippets=[]}dispose(){dispose(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;const{edits:nt,snippets:ot}=typeof this._template=="string"?ro.createEditsAndSnippetsFromSelections(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService):ro.createEditsAndSnippetsFromEdits(this._editor,this._template,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService);this._snippets=ot,this._editor.executeEdits("snippet",nt,rt=>{const ut=rt.filter(gt=>!!gt.identifier);for(let gt=0;gt<ot.length;gt++)ot[gt].initialize(ut[gt].textChange);return this._snippets[0].hasPlaceholder?this._move(!0):ut.map(gt=>Selection$1.fromPositions(gt.range.getEndPosition()))}),this._editor.revealRange(this._editor.getSelections()[0])}merge(nt,ot=_defaultOptions$1){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,nt]);const{edits:rt,snippets:ut}=ro.createEditsAndSnippetsFromSelections(this._editor,nt,ot.overwriteBefore,ot.overwriteAfter,!0,ot.adjustWhitespace,ot.clipboardText,ot.overtypingCapturer,this._languageConfigurationService);this._editor.executeEdits("snippet",rt,gt=>{const pt=gt.filter(vt=>!!vt.identifier);for(let vt=0;vt<ut.length;vt++)ut[vt].initialize(pt[vt].textChange);const mt=ut[0].isTrivialSnippet;if(!mt){for(const vt of this._snippets)vt.merge(ut);console.assert(ut.length===0)}return this._snippets[0].hasPlaceholder&&!mt?this._move(void 0):pt.map(vt=>Selection$1.fromPositions(vt.range.getEndPosition()))})}next(){const nt=this._move(!0);this._editor.setSelections(nt),this._editor.revealPositionInCenterIfOutsideViewport(nt[0].getPosition())}prev(){const nt=this._move(!1);this._editor.setSelections(nt),this._editor.revealPositionInCenterIfOutsideViewport(nt[0].getPosition())}_move(nt){const ot=[];for(const rt of this._snippets){const ut=rt.move(nt);ot.push(...ut)}return ot}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get hasChoice(){return this._snippets[0].hasChoice}get activeChoice(){return this._snippets[0].activeChoice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const nt=this._editor.getSelections();if(nt.length<this._snippets.length)return!1;const ot=new Map;for(const rt of this._snippets){const ut=rt.computePossibleSelections();if(ot.size===0)for(const[gt,pt]of ut){pt.sort(Range$2.compareRangesUsingStarts);for(const mt of nt)if(pt[0].containsRange(mt)){ot.set(gt,[]);break}}if(ot.size===0)return!1;ot.forEach((gt,pt)=>{gt.push(...ut.get(pt))})}nt.sort(Range$2.compareRangesUsingStarts);for(const[rt,ut]of ot){if(ut.length!==nt.length){ot.delete(rt);continue}ut.sort(Range$2.compareRangesUsingStarts);for(let gt=0;gt<ut.length;gt++)if(!ut[gt].containsRange(nt[gt])){ot.delete(rt);continue}}return ot.size>0}};SnippetSession=__decorate$K([__param$K(3,ILanguageConfigurationService)],SnippetSession);var __decorate$J=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$J=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const _defaultOptions={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let SnippetController2=class Io{static get(nt){return nt.getContribution(Io.ID)}constructor(nt,ot,rt,ut,gt){this._editor=nt,this._logService=ot,this._languageFeaturesService=rt,this._languageConfigurationService=gt,this._snippetListener=new DisposableStore,this._modelVersionId=-1,this._inSnippet=Io.InSnippetMode.bindTo(ut),this._hasNextTabstop=Io.HasNextTabstop.bindTo(ut),this._hasPrevTabstop=Io.HasPrevTabstop.bindTo(ut)}dispose(){var nt;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),(nt=this._session)===null||nt===void 0||nt.dispose(),this._snippetListener.dispose()}insert(nt,ot){try{this._doInsert(nt,typeof ot>"u"?_defaultOptions:Object.assign(Object.assign({},_defaultOptions),ot))}catch(rt){this.cancel(),this._logService.error(rt),this._logService.error("snippet_error"),this._logService.error("insert_template=",nt),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(nt,ot){var rt;if(this._editor.hasModel()){if(this._snippetListener.clear(),ot.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session&&typeof nt!="string"&&this.cancel(),this._session?(assertType(typeof nt=="string"),this._session.merge(nt,ot)):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new SnippetSession(this._editor,nt,ot,this._languageConfigurationService),this._session.insert()),ot.undoStopAfter&&this._editor.getModel().pushStackElement(),!((rt=this._session)===null||rt===void 0)&&rt.hasChoice){this._choiceCompletionItemProvider={provideCompletionItems:(gt,pt)=>{if(!this._session||gt!==this._editor.getModel()||!Position$1.equals(this._editor.getPosition(),pt))return;const{activeChoice:mt}=this._session;if(!mt||mt.choice.options.length===0)return;const vt=gt.getValueInRange(mt.range),St=!!mt.choice.options.find(wt=>wt.value===vt),yt=[];for(let wt=0;wt<mt.choice.options.length;wt++){const Lt=mt.choice.options[wt];yt.push({kind:13,label:Lt.value,insertText:Lt.value,sortText:"a".repeat(wt+1),range:mt.range,filterText:St?`${vt}_${Lt.value}`:void 0,command:{id:"jumpToNextSnippetPlaceholder",title:localize("next","Go to next placeholder...")}})}return{suggestions:yt}}};const ut=this._languageFeaturesService.completionProvider.register({language:this._editor.getModel().getLanguageId(),pattern:this._editor.getModel().uri.fsPath,scheme:this._editor.getModel().uri.scheme,exclusive:!0},this._choiceCompletionItemProvider);this._snippetListener.add(ut)}this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent(ut=>ut.isFlush&&this.cancel())),this._snippetListener.add(this._editor.onDidChangeModel(()=>this.cancel())),this._snippetListener.add(this._editor.onDidChangeCursorSelection(()=>this._updateState()))}}_updateState(){if(!(!this._session||!this._editor.hasModel())){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel()){this._currentChoice=void 0;return}const{activeChoice:nt}=this._session;if(!nt||!this._choiceCompletionItemProvider){this._currentChoice=void 0;return}this._currentChoice!==nt.choice&&(this._currentChoice=nt.choice,queueMicrotask(()=>{showSimpleSuggestions(this._editor,this._choiceCompletionItemProvider)}))}finish(){for(;this._inSnippet.get();)this.next()}cancel(nt=!1){var ot;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),this._currentChoice=void 0,(ot=this._session)===null||ot===void 0||ot.dispose(),this._session=void 0,this._modelVersionId=-1,nt&&this._editor.setSelections([this._editor.getSelection()])}prev(){var nt;(nt=this._session)===null||nt===void 0||nt.prev(),this._updateState()}next(){var nt;(nt=this._session)===null||nt===void 0||nt.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}};SnippetController2.ID="snippetController2";SnippetController2.InSnippetMode=new RawContextKey("inSnippetMode",!1,localize("inSnippetMode","Whether the editor in current in snippet mode"));SnippetController2.HasNextTabstop=new RawContextKey("hasNextTabstop",!1,localize("hasNextTabstop","Whether there is a next tab stop when in snippet mode"));SnippetController2.HasPrevTabstop=new RawContextKey("hasPrevTabstop",!1,localize("hasPrevTabstop","Whether there is a previous tab stop when in snippet mode"));SnippetController2=__decorate$J([__param$J(1,ILogService),__param$J(2,ILanguageFeaturesService),__param$J(3,IContextKeyService),__param$J(4,ILanguageConfigurationService)],SnippetController2);registerEditorContribution(SnippetController2.ID,SnippetController2,4);const CommandCtor=EditorCommand.bindToContribution(SnippetController2.get);registerEditorCommand(new CommandCtor({id:"jumpToNextSnippetPlaceholder",precondition:ContextKeyExpr.and(SnippetController2.InSnippetMode,SnippetController2.HasNextTabstop),handler:ct=>ct.next(),kbOpts:{weight:100+30,kbExpr:EditorContextKeys.editorTextFocus,primary:2}}));registerEditorCommand(new CommandCtor({id:"jumpToPrevSnippetPlaceholder",precondition:ContextKeyExpr.and(SnippetController2.InSnippetMode,SnippetController2.HasPrevTabstop),handler:ct=>ct.prev(),kbOpts:{weight:100+30,kbExpr:EditorContextKeys.editorTextFocus,primary:1026}}));registerEditorCommand(new CommandCtor({id:"leaveSnippet",precondition:SnippetController2.InSnippetMode,handler:ct=>ct.cancel(!0),kbOpts:{weight:100+30,kbExpr:EditorContextKeys.editorTextFocus,primary:9,secondary:[1033]}}));registerEditorCommand(new CommandCtor({id:"acceptSnippet",precondition:SnippetController2.InSnippetMode,handler:ct=>ct.finish()}));var __decorate$I=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$I=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$s=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},VersionIdChangeReason;(function(ct){ct[ct.Undo=0]="Undo",ct[ct.Redo=1]="Redo",ct[ct.AcceptWord=2]="AcceptWord",ct[ct.Other=3]="Other"})(VersionIdChangeReason||(VersionIdChangeReason={}));let InlineCompletionsModel=class extends Disposable{get isAcceptingPartially(){return this._isAcceptingPartially}get isNavigatingCurrentInlineCompletion(){return this._isNavigatingCurrentInlineCompletion}constructor(nt,ot,rt,ut,gt,pt,mt,vt,St,yt,wt,Lt){super(),this.textModel=nt,this.selectedSuggestItem=ot,this.cursorPosition=rt,this.textModelVersionId=ut,this._debounceValue=gt,this._suggestPreviewEnabled=pt,this._suggestPreviewMode=mt,this._inlineSuggestMode=vt,this._enabled=St,this._instantiationService=yt,this._commandService=wt,this._languageConfigurationService=Lt,this._source=this._register(this._instantiationService.createInstance(InlineCompletionsSource,this.textModel,this.textModelVersionId,this._debounceValue)),this._isActive=observableValue("isActive",!1),this._forceUpdate=observableSignal("forceUpdate"),this._isAcceptingPartially=!1,this._isNavigatingCurrentInlineCompletion=!1,this._filteredInlineCompletionItems=derived("filteredInlineCompletionItems",Tt=>{const Rt=this._source.inlineCompletions.read(Tt);if(!Rt)return[];const Nt=this.cursorPosition.read(Tt);return Rt.inlineCompletions.filter(Ft=>Ft.isVisible(this.textModel,Nt,Tt))}),this._selectedInlineCompletionId=void 0,this._selectedInlineCompletionIdChangeSignal=observableSignal("selectedCompletionIdChanged"),this.selectedInlineCompletionIndex=derived("selectedCachedCompletionIndex",Tt=>{this._selectedInlineCompletionIdChangeSignal.read(Tt);const Rt=this._filteredInlineCompletionItems.read(Tt),Nt=this._selectedInlineCompletionId===void 0?-1:Rt.findIndex(Pt=>Pt.semanticId===this._selectedInlineCompletionId);return Nt===-1?(this._selectedInlineCompletionId=void 0,0):Nt}),this.selectedInlineCompletion=derived("selectedCachedCompletion",Tt=>{const Rt=this._filteredInlineCompletionItems.read(Tt),Nt=this.selectedInlineCompletionIndex.read(Tt);return Rt[Nt]}),this.lastTriggerKind=this._source.inlineCompletions.map(Tt=>Tt==null?void 0:Tt.request.context.triggerKind),this.inlineCompletionsCount=derived("selectedInlineCompletionsCount",Tt=>{if(this.lastTriggerKind.read(Tt)===InlineCompletionTriggerKind$1.Explicit)return this._filteredInlineCompletionItems.read(Tt).length}),this.ghostTextAndCompletion=derived("ghostTextAndCompletion",Tt=>{var Rt;const Nt=this.textModel,Pt=this.selectedSuggestItem.read(Tt);if(Pt){const Ft=this._source.suggestWidgetInlineCompletions.read(Tt),Kt=Ft?Ft.inlineCompletions:[this.selectedInlineCompletion.read(Tt)].filter(isDefined),Bt=Pt.toSingleTextEdit().removeCommonPrefix(Nt),Ut=mapFind(Kt,dn=>{let bn=dn.toSingleTextEdit(Tt);return bn=bn.removeCommonPrefix(Nt,Range$2.fromPositions(bn.range.getStartPosition(),Pt.range.getEndPosition())),bn.augments(Bt)?{edit:bn,completion:dn}:void 0});if(!this._suggestPreviewEnabled.read(Tt)&&!Ut)return;const Yt=(Rt=Ut==null?void 0:Ut.edit)!==null&&Rt!==void 0?Rt:Bt,Zt=Ut?Ut.edit.text.length-Bt.text.length:0,Xt=this._suggestPreviewMode.read(Tt),_i=this.cursorPosition.read(Tt),nn=Yt.computeGhostText(Nt,Xt,_i,Zt);return{ghostText:nn??new GhostText(Yt.range.endLineNumber,[]),completion:Ut==null?void 0:Ut.completion}}else{if(!this._isActive.read(Tt))return;const Ft=this.selectedInlineCompletion.read(Tt);if(!Ft)return;const Kt=Ft.toSingleTextEdit(Tt),Bt=this._inlineSuggestMode.read(Tt),Ut=this.cursorPosition.read(Tt),qt=Kt.computeGhostText(Nt,Bt,Ut);return qt?{ghostText:qt,completion:Ft}:void 0}}),this.ghostText=derived("ghostText",Tt=>{const Rt=this.ghostTextAndCompletion.read(Tt);if(Rt)return Rt.ghostText});const xt=new Set([VersionIdChangeReason.Redo,VersionIdChangeReason.Undo,VersionIdChangeReason.AcceptWord]);let It=!1,kt=InlineCompletionTriggerKind$1.Automatic;this._register(autorunHandleChanges("update",{handleChange:Tt=>(Tt.didChange(this.textModelVersionId)&&xt.has(Tt.change)?It=!0:Tt.didChange(this._forceUpdate)&&(kt=Tt.change),!0)},Tt=>{var Rt,Nt;if(this._forceUpdate.read(Tt),this._enabled.read(Tt)&&this.selectedSuggestItem.read(Tt)||this._isActive.read(Tt)){const Pt=It||((Nt=(Rt=this.selectedInlineCompletion.get())===null||Rt===void 0?void 0:Rt.inlineCompletion.source.inlineCompletions.enableForwardStability)!==null&&Nt!==void 0?Nt:!1),Ft=this.selectedSuggestItem.read(Tt),Kt=this.cursorPosition.read(Tt);this.textModelVersionId.read(Tt);const Bt=this._source.suggestWidgetInlineCompletions.get();if(Bt&&!Ft){const Ut=this._source.inlineCompletions.get();Ut&&Bt.request.versionId>Ut.request.versionId&&this._source.inlineCompletions.set(Bt.clone(),void 0),this._source.clearSuggestWidgetInlineCompletions()}this._updatePromise=this._source.update(Kt,{triggerKind:kt,selectedSuggestionInfo:Ft==null?void 0:Ft.toSelectedSuggestionInfo()},Pt?this.selectedInlineCompletion.get():void 0)}else this._updatePromise=void 0;It=!1,kt=InlineCompletionTriggerKind$1.Automatic}));let At;this._register(autorun("call handleItemDidShow",Tt=>{var Rt,Nt;const Pt=this.ghostTextAndCompletion.read(Tt),Ft=Pt==null?void 0:Pt.completion;if((Ft==null?void 0:Ft.semanticId)!==(At==null?void 0:At.semanticId)&&(At=Ft,Ft)){const Kt=Ft.inlineCompletion,Bt=Kt.source;(Nt=(Rt=Bt.provider).handleItemDidShow)===null||Nt===void 0||Nt.call(Rt,Bt.inlineCompletions,Kt.sourceInlineCompletion,Kt.insertText)}}))}trigger(nt){return __awaiter$s(this,void 0,void 0,function*(){this._isActive.set(!0,nt),yield this._updatePromise})}triggerExplicitly(){return __awaiter$s(this,void 0,void 0,function*(){transaction(nt=>{this._isActive.set(!0,nt),this._forceUpdate.trigger(nt,InlineCompletionTriggerKind$1.Explicit)}),yield this._updatePromise})}stop(nt){if(!nt){transaction(ot=>this.stop(ot));return}this._isActive.set(!1,nt),this._source.clear(nt)}deltaIndex(nt){return __awaiter$s(this,void 0,void 0,function*(){yield this.triggerExplicitly(),this._isNavigatingCurrentInlineCompletion=!0;try{const ot=this._filteredInlineCompletionItems.get()||[];if(ot.length>0){const rt=(this.selectedInlineCompletionIndex.get()+nt+ot.length)%ot.length;this._selectedInlineCompletionId=ot[rt].semanticId}else this._selectedInlineCompletionId=void 0;this._selectedInlineCompletionIdChangeSignal.trigger(void 0)}finally{this._isNavigatingCurrentInlineCompletion=!1}})}next(){return __awaiter$s(this,void 0,void 0,function*(){yield this.deltaIndex(1)})}previous(){return __awaiter$s(this,void 0,void 0,function*(){yield this.deltaIndex(-1)})}accept(nt){var ot,rt;if(nt.getModel()!==this.textModel)throw new BugIndicatingError;const ut=this.ghostText.get(),gt=(ot=this.selectedInlineCompletion.get())===null||ot===void 0?void 0:ot.toInlineCompletion(void 0);!ut||!gt||(nt.pushUndoStop(),gt.snippetInfo?(nt.executeEdits("inlineSuggestion.accept",[EditOperation.replaceMove(gt.range,""),...gt.additionalTextEdits]),nt.setPosition(gt.snippetInfo.range.getStartPosition()),(rt=SnippetController2.get(nt))===null||rt===void 0||rt.insert(gt.snippetInfo.snippet,{undoStopBefore:!1})):nt.executeEdits("inlineSuggestion.accept",[EditOperation.replaceMove(gt.range,gt.insertText),...gt.additionalTextEdits]),gt.command?this._commandService.executeCommand(gt.command.id,...gt.command.arguments||[]).finally(()=>{transaction(pt=>{this._source.clear(pt)})}).then(void 0,onUnexpectedExternalError):transaction(pt=>{this._source.clear(pt)}))}acceptNextWord(nt){this.acceptNext(nt,(ot,rt)=>{const ut=this.textModel.getLanguageIdAtPosition(ot.lineNumber,ot.column),gt=this._languageConfigurationService.getLanguageConfiguration(ut),pt=new RegExp(gt.wordDefinition.source,gt.wordDefinition.flags.replace("g","")),mt=rt.match(pt);let vt=0;mt&&mt.index!==void 0?mt.index===0?vt=mt[0].length:vt=mt.index:vt=rt.length;const yt=/\s+/g.exec(rt);return yt&&yt.index!==void 0&&yt.index+yt[0].length<vt&&(vt=yt.index+yt[0].length),vt})}acceptNextLine(nt){this.acceptNext(nt,(ot,rt)=>{const ut=rt.match(/\n/);return ut&&ut.index!==void 0?ut.index+1:rt.length})}acceptNext(nt,ot){var rt;if(nt.getModel()!==this.textModel)throw new BugIndicatingError;const ut=this.ghostText.get(),gt=(rt=this.selectedInlineCompletion.get())===null||rt===void 0?void 0:rt.toInlineCompletion(void 0);if(!ut||!gt)return;if(gt.snippetInfo||gt.filterText!==gt.insertText){this.accept(nt);return}if(ut.parts.length===0)return;const pt=ut.parts[0],mt=new Position$1(ut.lineNumber,pt.column),vt=pt.lines.join(`
`),St=ot(mt,vt);if(St===vt.length&&ut.parts.length===1){this.accept(nt);return}const yt=vt.substring(0,St);this._isAcceptingPartially=!0;try{nt.pushUndoStop(),nt.executeEdits("inlineSuggestion.accept",[EditOperation.replace(Range$2.fromPositions(mt),yt)]);const wt=lengthOfText(yt);nt.setPosition(addPositions(mt,wt))}finally{this._isAcceptingPartially=!1}if(gt.source.provider.handlePartialAccept){const wt=Range$2.fromPositions(gt.range.getStartPosition(),addPositions(mt,lengthOfText(yt))),Lt=nt.getModel().getValueInRange(wt,1);gt.source.provider.handlePartialAccept(gt.source.inlineCompletions,gt.sourceInlineCompletion,Lt.length)}}};InlineCompletionsModel=__decorate$I([__param$I(9,IInstantiationService),__param$I(10,ICommandService),__param$I(11,ILanguageConfigurationService)],InlineCompletionsModel);var __decorate$H=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$H=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};class Memory{constructor(nt){this.name=nt}select(nt,ot,rt){if(rt.length===0)return 0;const ut=rt[0].score[0];for(let gt=0;gt<rt.length;gt++){const{score:pt,completion:mt}=rt[gt];if(pt[0]!==ut)break;if(mt.preselect)return gt}return 0}}class NoMemory extends Memory{constructor(){super("first")}memorize(nt,ot,rt){}toJSON(){}fromJSON(){}}class LRUMemory extends Memory{constructor(){super("recentlyUsed"),this._cache=new LRUCache(300,.66),this._seq=0}memorize(nt,ot,rt){const ut=`${nt.getLanguageId()}/${rt.textLabel}`;this._cache.set(ut,{touch:this._seq++,type:rt.completion.kind,insertText:rt.completion.insertText})}select(nt,ot,rt){if(rt.length===0)return 0;const ut=nt.getLineContent(ot.lineNumber).substr(ot.column-10,ot.column-1);if(/\s$/.test(ut))return super.select(nt,ot,rt);const gt=rt[0].score[0];let pt=-1,mt=-1,vt=-1;for(let St=0;St<rt.length&&rt[St].score[0]===gt;St++){const yt=`${nt.getLanguageId()}/${rt[St].textLabel}`,wt=this._cache.peek(yt);if(wt&&wt.touch>vt&&wt.type===rt[St].completion.kind&&wt.insertText===rt[St].completion.insertText&&(vt=wt.touch,mt=St),rt[St].completion.preselect&&pt===-1)return pt=St}return mt!==-1?mt:pt!==-1?pt:0}toJSON(){return this._cache.toJSON()}fromJSON(nt){this._cache.clear();const ot=0;for(const[rt,ut]of nt)ut.touch=ot,ut.type=typeof ut.type=="number"?ut.type:CompletionItemKinds.fromString(ut.type),this._cache.set(rt,ut);this._seq=this._cache.size}}class PrefixMemory extends Memory{constructor(){super("recentlyUsedByPrefix"),this._trie=TernarySearchTree.forStrings(),this._seq=0}memorize(nt,ot,rt){const{word:ut}=nt.getWordUntilPosition(ot),gt=`${nt.getLanguageId()}/${ut}`;this._trie.set(gt,{type:rt.completion.kind,insertText:rt.completion.insertText,touch:this._seq++})}select(nt,ot,rt){const{word:ut}=nt.getWordUntilPosition(ot);if(!ut)return super.select(nt,ot,rt);const gt=`${nt.getLanguageId()}/${ut}`;let pt=this._trie.get(gt);if(pt||(pt=this._trie.findSubstr(gt)),pt)for(let mt=0;mt<rt.length;mt++){const{kind:vt,insertText:St}=rt[mt].completion;if(vt===pt.type&&St===pt.insertText)return mt}return super.select(nt,ot,rt)}toJSON(){const nt=[];return this._trie.forEach((ot,rt)=>nt.push([rt,ot])),nt.sort((ot,rt)=>-(ot[1].touch-rt[1].touch)).forEach((ot,rt)=>ot[1].touch=rt),nt.slice(0,200)}fromJSON(nt){if(this._trie.clear(),nt.length>0){this._seq=nt[0][1].touch+1;for(const[ot,rt]of nt)rt.type=typeof rt.type=="number"?rt.type:CompletionItemKinds.fromString(rt.type),this._trie.set(ot,rt)}}}let SuggestMemoryService=class Mo{constructor(nt,ot){this._storageService=nt,this._configService=ot,this._disposables=new DisposableStore,this._persistSoon=new RunOnceScheduler(()=>this._saveState(),500),this._disposables.add(nt.onWillSaveState(rt=>{rt.reason===WillSaveStateReason.SHUTDOWN&&this._saveState()}))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(nt,ot,rt){this._withStrategy(nt,ot).memorize(nt,ot,rt),this._persistSoon.schedule()}select(nt,ot,rt){return this._withStrategy(nt,ot).select(nt,ot,rt)}_withStrategy(nt,ot){var rt;const ut=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:nt.getLanguageIdAtPosition(ot.lineNumber,ot.column),resource:nt.uri});if(((rt=this._strategy)===null||rt===void 0?void 0:rt.name)!==ut){this._saveState();const gt=Mo._strategyCtors.get(ut)||NoMemory;this._strategy=new gt;try{const mt=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,vt=this._storageService.get(`${Mo._storagePrefix}/${ut}`,mt);vt&&this._strategy.fromJSON(JSON.parse(vt))}catch{}}return this._strategy}_saveState(){if(this._strategy){const ot=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,rt=JSON.stringify(this._strategy);this._storageService.store(`${Mo._storagePrefix}/${this._strategy.name}`,rt,ot,1)}}};SuggestMemoryService._strategyCtors=new Map([["recentlyUsedByPrefix",PrefixMemory],["recentlyUsed",LRUMemory],["first",NoMemory]]);SuggestMemoryService._storagePrefix="suggest/memories";SuggestMemoryService=__decorate$H([__param$H(0,IStorageService),__param$H(1,IConfigurationService)],SuggestMemoryService);const ISuggestMemoryService=createDecorator("ISuggestMemories");registerSingleton(ISuggestMemoryService,SuggestMemoryService,1);var __decorate$G=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$G=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let WordContextKey=class Ir{constructor(nt,ot){this._editor=nt,this._enabled=!1,this._ckAtEnd=Ir.AtEnd.bindTo(ot),this._configListener=this._editor.onDidChangeConfiguration(rt=>rt.hasChanged(118)&&this._update()),this._update()}dispose(){var nt;this._configListener.dispose(),(nt=this._selectionListener)===null||nt===void 0||nt.dispose(),this._ckAtEnd.reset()}_update(){const nt=this._editor.getOption(118)==="on";if(this._enabled!==nt)if(this._enabled=nt,this._enabled){const ot=()=>{if(!this._editor.hasModel()){this._ckAtEnd.set(!1);return}const rt=this._editor.getModel(),ut=this._editor.getSelection(),gt=rt.getWordAtPosition(ut.getStartPosition());if(!gt){this._ckAtEnd.set(!1);return}this._ckAtEnd.set(gt.endColumn===ut.getStartPosition().column)};this._selectionListener=this._editor.onDidChangeCursorSelection(ot),ot()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}};WordContextKey.AtEnd=new RawContextKey("atEndOfWord",!1);WordContextKey=__decorate$G([__param$G(1,IContextKeyService)],WordContextKey);var __decorate$F=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$F=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let SuggestAlternatives=class Po{constructor(nt,ot){this._editor=nt,this._index=0,this._ckOtherSuggestions=Po.OtherSuggestions.bindTo(ot)}dispose(){this.reset()}reset(){var nt;this._ckOtherSuggestions.reset(),(nt=this._listener)===null||nt===void 0||nt.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:nt,index:ot},rt){if(nt.items.length===0){this.reset();return}if(Po._moveIndex(!0,nt,ot)===ot){this.reset();return}this._acceptNext=rt,this._model=nt,this._index=ot,this._listener=this._editor.onDidChangeCursorPosition(()=>{this._ignore||this.reset()}),this._ckOtherSuggestions.set(!0)}static _moveIndex(nt,ot,rt){let ut=rt;for(let gt=ot.items.length;gt>0&&(ut=(ut+ot.items.length+(nt?1:-1))%ot.items.length,!(ut===rt||!ot.items[ut].completion.additionalTextEdits));gt--);return ut}next(){this._move(!0)}prev(){this._move(!1)}_move(nt){if(this._model)try{this._ignore=!0,this._index=Po._moveIndex(nt,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};SuggestAlternatives.OtherSuggestions=new RawContextKey("hasOtherSuggestions",!1);SuggestAlternatives=__decorate$F([__param$F(1,IContextKeyService)],SuggestAlternatives);class CommitCharacterController{constructor(nt,ot,rt,ut){this._disposables=new DisposableStore,this._disposables.add(rt.onDidSuggest(gt=>{gt.completionModel.items.length===0&&this.reset()})),this._disposables.add(rt.onDidCancel(gt=>{this.reset()})),this._disposables.add(ot.onDidShow(()=>this._onItem(ot.getFocusedItem()))),this._disposables.add(ot.onDidFocus(this._onItem,this)),this._disposables.add(ot.onDidHide(this.reset,this)),this._disposables.add(nt.onWillType(gt=>{if(this._active&&!ot.isFrozen()&&rt.state!==0){const pt=gt.charCodeAt(gt.length-1);this._active.acceptCharacters.has(pt)&&nt.getOption(0)&&ut(this._active.item)}}))}_onItem(nt){if(!nt||!isNonEmptyArray(nt.item.completion.commitCharacters)){this.reset();return}if(this._active&&this._active.item.item===nt.item)return;const ot=new CharacterSet;for(const rt of nt.item.completion.commitCharacters)rt.length>0&&ot.add(rt.charCodeAt(0));this._active={acceptCharacters:ot,item:nt}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}}var __awaiter$r=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class BracketSelectionRangeProvider{provideSelectionRanges(nt,ot){return __awaiter$r(this,void 0,void 0,function*(){const rt=[];for(const ut of ot){const gt=[];rt.push(gt);const pt=new Map;yield new Promise(mt=>BracketSelectionRangeProvider._bracketsRightYield(mt,0,nt,ut,pt)),yield new Promise(mt=>BracketSelectionRangeProvider._bracketsLeftYield(mt,0,nt,ut,pt,gt))}return rt})}static _bracketsRightYield(nt,ot,rt,ut,gt){const pt=new Map,mt=Date.now();for(;;){if(ot>=BracketSelectionRangeProvider._maxRounds){nt();break}if(!ut){nt();break}const vt=rt.bracketPairs.findNextBracket(ut);if(!vt){nt();break}if(Date.now()-mt>BracketSelectionRangeProvider._maxDuration){setTimeout(()=>BracketSelectionRangeProvider._bracketsRightYield(nt,ot+1,rt,ut,gt));break}if(vt.bracketInfo.isOpeningBracket){const yt=vt.bracketInfo.bracketText,wt=pt.has(yt)?pt.get(yt):0;pt.set(yt,wt+1)}else{const yt=vt.bracketInfo.getOpeningBrackets()[0].bracketText;let wt=pt.has(yt)?pt.get(yt):0;if(wt-=1,pt.set(yt,Math.max(0,wt)),wt<0){let Lt=gt.get(yt);Lt||(Lt=new LinkedList,gt.set(yt,Lt)),Lt.push(vt.range)}}ut=vt.range.getEndPosition()}}static _bracketsLeftYield(nt,ot,rt,ut,gt,pt){const mt=new Map,vt=Date.now();for(;;){if(ot>=BracketSelectionRangeProvider._maxRounds&&gt.size===0){nt();break}if(!ut){nt();break}const St=rt.bracketPairs.findPrevBracket(ut);if(!St){nt();break}if(Date.now()-vt>BracketSelectionRangeProvider._maxDuration){setTimeout(()=>BracketSelectionRangeProvider._bracketsLeftYield(nt,ot+1,rt,ut,gt,pt));break}if(St.bracketInfo.isOpeningBracket){const wt=St.bracketInfo.bracketText;let Lt=mt.has(wt)?mt.get(wt):0;if(Lt-=1,mt.set(wt,Math.max(0,Lt)),Lt<0){const xt=gt.get(wt);if(xt){const It=xt.shift();xt.size===0&&gt.delete(wt);const kt=Range$2.fromPositions(St.range.getEndPosition(),It.getStartPosition()),At=Range$2.fromPositions(St.range.getStartPosition(),It.getEndPosition());pt.push({range:kt}),pt.push({range:At}),BracketSelectionRangeProvider._addBracketLeading(rt,At,pt)}}}else{const wt=St.bracketInfo.getOpeningBrackets()[0].bracketText,Lt=mt.has(wt)?mt.get(wt):0;mt.set(wt,Lt+1)}ut=St.range.getStartPosition()}}static _addBracketLeading(nt,ot,rt){if(ot.startLineNumber===ot.endLineNumber)return;const ut=ot.startLineNumber,gt=nt.getLineFirstNonWhitespaceColumn(ut);gt!==0&&gt!==ot.startColumn&&(rt.push({range:Range$2.fromPositions(new Position$1(ut,gt),ot.getEndPosition())}),rt.push({range:Range$2.fromPositions(new Position$1(ut,1),ot.getEndPosition())}));const pt=ut-1;if(pt>0){const mt=nt.getLineFirstNonWhitespaceColumn(pt);mt===ot.startColumn&&mt!==nt.getLineLastNonWhitespaceColumn(pt)&&(rt.push({range:Range$2.fromPositions(new Position$1(pt,mt),ot.getEndPosition())}),rt.push({range:Range$2.fromPositions(new Position$1(pt,1),ot.getEndPosition())}))}}}BracketSelectionRangeProvider._maxDuration=30;BracketSelectionRangeProvider._maxRounds=2;var __awaiter$q=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class WordDistance{static create(nt,ot){return __awaiter$q(this,void 0,void 0,function*(){if(!ot.getOption(113).localityBonus||!ot.hasModel())return WordDistance.None;const rt=ot.getModel(),ut=ot.getPosition();if(!nt.canComputeWordRanges(rt.uri))return WordDistance.None;const[gt]=yield new BracketSelectionRangeProvider().provideSelectionRanges(rt,[ut]);if(gt.length===0)return WordDistance.None;const pt=yield nt.computeWordRanges(rt.uri,gt[0].range);if(!pt)return WordDistance.None;const mt=rt.getWordUntilPosition(ut);return delete pt[mt.word],new class extends WordDistance{distance(vt,St){if(!ut.equals(ot.getPosition()))return 0;if(St.kind===17)return 2<<20;const yt=typeof St.label=="string"?St.label:St.label.label,wt=pt[yt];if(isFalsyOrEmpty(wt))return 2<<20;const Lt=binarySearch(wt,Range$2.fromPositions(vt),Range$2.compareRangesUsingStarts),xt=Lt>=0?wt[Lt]:wt[Math.max(0,~Lt-1)];let It=gt.length;for(const kt of gt){if(!Range$2.containsRange(kt.range,xt))break;It-=1}return It}}})}}WordDistance.None=new class extends WordDistance{distance(){return 0}};let LineContext$1=class{constructor(nt,ot){this.leadingLineContent=nt,this.characterCountDelta=ot}};class CompletionModel{constructor(nt,ot,rt,ut,gt,pt,mt=FuzzyScoreOptions.default,vt=void 0){this.clipboardText=vt,this._snippetCompareFn=CompletionModel._compareCompletionItems,this._items=nt,this._column=ot,this._wordDistance=ut,this._options=gt,this._refilterKind=1,this._lineContext=rt,this._fuzzyScoreOptions=mt,pt==="top"?this._snippetCompareFn=CompletionModel._compareCompletionItemsSnippetsUp:pt==="bottom"&&(this._snippetCompareFn=CompletionModel._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(nt){(this._lineContext.leadingLineContent!==nt.leadingLineContent||this._lineContext.characterCountDelta!==nt.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<nt.characterCountDelta&&this._filteredItems?2:1,this._lineContext=nt)}get items(){return this._ensureCachedState(),this._filteredItems}getItemsByProvider(){return this._ensureCachedState(),this._itemsByProvider}getIncompleteProvider(){this._ensureCachedState();const nt=new Set;for(const[ot,rt]of this.getItemsByProvider())rt.length>0&&rt[0].container.incomplete&&nt.add(ot);return nt}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._itemsByProvider=new Map;const nt=[],{leadingLineContent:ot,characterCountDelta:rt}=this._lineContext;let ut="",gt="";const pt=this._refilterKind===1?this._items:this._filteredItems,mt=[],vt=!this._options.filterGraceful||pt.length>2e3?fuzzyScore:fuzzyScoreGracefulAggressive;for(let St=0;St<pt.length;St++){const yt=pt[St];if(yt.isInvalid)continue;const wt=this._itemsByProvider.get(yt.provider);wt?wt.push(yt):this._itemsByProvider.set(yt.provider,[yt]);const Lt=yt.position.column-yt.editStart.column,xt=Lt+rt-(yt.position.column-this._column);if(ut.length!==xt&&(ut=xt===0?"":ot.slice(-xt),gt=ut.toLowerCase()),yt.word=ut,xt===0)yt.score=FuzzyScore.Default;else{let It=0;for(;It<Lt;){const kt=ut.charCodeAt(It);if(kt===32||kt===9)It+=1;else break}if(It>=xt)yt.score=FuzzyScore.Default;else if(typeof yt.completion.filterText=="string"){const kt=vt(ut,gt,It,yt.completion.filterText,yt.filterTextLow,0,this._fuzzyScoreOptions);if(!kt)continue;compareIgnoreCase(yt.completion.filterText,yt.textLabel)===0?yt.score=kt:(yt.score=anyScore(ut,gt,It,yt.textLabel,yt.labelLow,0),yt.score[0]=kt[0])}else{const kt=vt(ut,gt,It,yt.textLabel,yt.labelLow,0,this._fuzzyScoreOptions);if(!kt)continue;yt.score=kt}}yt.idx=St,yt.distance=this._wordDistance.distance(yt.position,yt.completion),mt.push(yt),nt.push(yt.textLabel.length)}this._filteredItems=mt.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:nt.length?quickSelect(nt.length-.85,nt,(St,yt)=>St-yt):0}}static _compareCompletionItems(nt,ot){return nt.score[0]>ot.score[0]?-1:nt.score[0]<ot.score[0]?1:nt.distance<ot.distance?-1:nt.distance>ot.distance?1:nt.idx<ot.idx?-1:nt.idx>ot.idx?1:0}static _compareCompletionItemsSnippetsDown(nt,ot){if(nt.completion.kind!==ot.completion.kind){if(nt.completion.kind===27)return 1;if(ot.completion.kind===27)return-1}return CompletionModel._compareCompletionItems(nt,ot)}static _compareCompletionItemsSnippetsUp(nt,ot){if(nt.completion.kind!==ot.completion.kind){if(nt.completion.kind===27)return-1;if(ot.completion.kind===27)return 1}return CompletionModel._compareCompletionItems(nt,ot)}}var __decorate$E=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$E=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$p=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class LineContext{static shouldAutoTrigger(nt){if(!nt.hasModel())return!1;const ot=nt.getModel(),rt=nt.getPosition();ot.tokenization.tokenizeIfCheap(rt.lineNumber);const ut=ot.getWordAtPosition(rt);return!(!ut||ut.endColumn!==rt.column||!isNaN(Number(ut.word)))}constructor(nt,ot,rt){this.leadingLineContent=nt.getLineContent(ot.lineNumber).substr(0,ot.column-1),this.leadingWord=nt.getWordUntilPosition(ot),this.lineNumber=ot.lineNumber,this.column=ot.column,this.triggerOptions=rt}}function canShowQuickSuggest(ct,nt,ot){if(!nt.getContextKeyValue(InlineCompletionContextKeys.inlineSuggestionVisible.key))return!0;const rt=nt.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);return rt!==void 0?!rt:!ct.getOption(60).suppressSuggestions}function canShowSuggestOnTriggerCharacters(ct,nt,ot){if(!nt.getContextKeyValue("inlineSuggestionVisible"))return!0;const rt=nt.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);return rt!==void 0?!rt:!ct.getOption(60).suppressSuggestions}let SuggestModel=class kr{constructor(nt,ot,rt,ut,gt,pt,mt,vt){this._editor=nt,this._editorWorkerService=ot,this._clipboardService=rt,this._telemetryService=ut,this._logService=gt,this._contextKeyService=pt,this._configurationService=mt,this._languageFeaturesService=vt,this._toDispose=new DisposableStore,this._triggerCharacterListener=new DisposableStore,this._triggerQuickSuggest=new TimeoutTimer,this._triggerState=void 0,this._completionDisposables=new DisposableStore,this._onDidCancel=new Emitter$2,this._onDidTrigger=new Emitter$2,this._onDidSuggest=new Emitter$2,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new Selection$1(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters()})),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()}));let St=!1;this._toDispose.add(this._editor.onDidCompositionStart(()=>{St=!0})),this._toDispose.add(this._editor.onDidCompositionEnd(()=>{St=!1,this._onCompositionEnd()})),this._toDispose.add(this._editor.onDidChangeCursorSelection(yt=>{St||this._onCursorChange(yt)})),this._toDispose.add(this._editor.onDidChangeModelContent(()=>{!St&&this._triggerState!==void 0&&this._refilterCompletionItems()})),this._updateTriggerCharacters()}dispose(){dispose(this._triggerCharacterListener),dispose([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(87)||!this._editor.hasModel()||!this._editor.getOption(116))return;const nt=new Map;for(const rt of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(const ut of rt.triggerCharacters||[]){let gt=nt.get(ut);gt||(gt=new Set,gt.add(getSnippetSuggestSupport()),nt.set(ut,gt)),gt.add(rt)}const ot=rt=>{var ut;if(!canShowSuggestOnTriggerCharacters(this._editor,this._contextKeyService,this._configurationService)||LineContext.shouldAutoTrigger(this._editor))return;if(!rt){const mt=this._editor.getPosition();rt=this._editor.getModel().getLineContent(mt.lineNumber).substr(0,mt.column-1)}let gt="";isLowSurrogate(rt.charCodeAt(rt.length-1))?isHighSurrogate(rt.charCodeAt(rt.length-2))&&(gt=rt.substr(rt.length-2)):gt=rt.charAt(rt.length-1);const pt=nt.get(gt);if(pt){const mt=new Map;if(this._completionModel)for(const[vt,St]of this._completionModel.getItemsByProvider())pt.has(vt)||mt.set(vt,St);this.trigger({auto:!0,triggerKind:1,triggerCharacter:gt,retrigger:!!this._completionModel,clipboardText:(ut=this._completionModel)===null||ut===void 0?void 0:ut.clipboardText,completionOptions:{providerFilter:pt,providerItemsToReuse:mt}})}};this._triggerCharacterListener.add(this._editor.onDidType(ot)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(()=>ot()))}get state(){return this._triggerState?this._triggerState.auto?2:1:0}cancel(nt=!1){var ot;this._triggerState!==void 0&&(this._triggerQuickSuggest.cancel(),(ot=this._requestToken)===null||ot===void 0||ot.cancel(),this._requestToken=void 0,this._triggerState=void 0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:nt}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._triggerState!==void 0&&(!this._editor.hasModel()||!this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.cancel():this.trigger({auto:this._triggerState.auto,retrigger:!0}))}_onCursorChange(nt){if(!this._editor.hasModel())return;const ot=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!nt.selection.isEmpty()||nt.reason!==0&&nt.reason!==3||nt.source!=="keyboard"&&nt.source!=="deleteLeft"){this.cancel();return}this._triggerState===void 0&&nt.reason===0?(ot.containsRange(this._currentSelection)||ot.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._triggerState!==void 0&&nt.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._triggerState===void 0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){QuickSuggestionsOptions.isAllOff(this._editor.getOption(85))||(this.cancel(),this._triggerQuickSuggest.cancelAndSet(()=>{if(this._triggerState!==void 0||!LineContext.shouldAutoTrigger(this._editor)||!this._editor.hasModel()||!this._editor.hasWidgetFocus())return;const nt=this._editor.getModel(),ot=this._editor.getPosition(),rt=this._editor.getOption(85);if(!QuickSuggestionsOptions.isAllOff(rt)){if(!QuickSuggestionsOptions.isAllOn(rt)){nt.tokenization.tokenizeIfCheap(ot.lineNumber);const ut=nt.tokenization.getLineTokens(ot.lineNumber),gt=ut.getStandardTokenType(ut.findTokenIndexAtOffset(Math.max(ot.column-1-1,0)));if(QuickSuggestionsOptions.valueFor(rt,gt)!=="on")return}canShowQuickSuggest(this._editor,this._contextKeyService,this._configurationService)&&this._languageFeaturesService.completionProvider.has(nt)&&this.trigger({auto:!0})}},this._editor.getOption(86)))}_refilterCompletionItems(){assertType(this._editor.hasModel()),assertType(this._triggerState!==void 0);const nt=this._editor.getModel(),ot=this._editor.getPosition(),rt=new LineContext(nt,ot,Object.assign(Object.assign({},this._triggerState),{refilter:!0}));this._onNewContext(rt)}trigger(nt){var ot,rt,ut,gt,pt,mt;if(!this._editor.hasModel())return;const vt=this._editor.getModel(),St=new LineContext(vt,this._editor.getPosition(),nt);this.cancel(nt.retrigger),this._triggerState=nt,this._onDidTrigger.fire({auto:nt.auto,shy:(ot=nt.shy)!==null&&ot!==void 0?ot:!1,position:this._editor.getPosition()}),this._context=St;let yt={triggerKind:(rt=nt.triggerKind)!==null&&rt!==void 0?rt:0};nt.triggerCharacter&&(yt={triggerKind:1,triggerCharacter:nt.triggerCharacter}),this._requestToken=new CancellationTokenSource$1;const wt=this._editor.getOption(107);let Lt=1;switch(wt){case"top":Lt=0;break;case"bottom":Lt=2;break}const{itemKind:xt,showDeprecated:It}=kr._createSuggestFilter(this._editor),kt=new CompletionOptions(Lt,(gt=(ut=nt.completionOptions)===null||ut===void 0?void 0:ut.kindFilter)!==null&&gt!==void 0?gt:xt,(pt=nt.completionOptions)===null||pt===void 0?void 0:pt.providerFilter,(mt=nt.completionOptions)===null||mt===void 0?void 0:mt.providerItemsToReuse,It),At=WordDistance.create(this._editorWorkerService,this._editor),Tt=provideSuggestionItems(this._languageFeaturesService.completionProvider,vt,this._editor.getPosition(),kt,yt,this._requestToken.token);Promise.all([Tt,At]).then(([Rt,Nt])=>__awaiter$p(this,void 0,void 0,function*(){var Pt;if((Pt=this._requestToken)===null||Pt===void 0||Pt.dispose(),!this._editor.hasModel())return;let Ft=nt==null?void 0:nt.clipboardText;if(!Ft&&Rt.needsClipboard&&(Ft=yield this._clipboardService.readText()),this._triggerState===void 0)return;const Kt=this._editor.getModel(),Bt=new LineContext(Kt,this._editor.getPosition(),nt),Ut=Object.assign(Object.assign({},FuzzyScoreOptions.default),{firstMatchCanBeWeak:!this._editor.getOption(113).matchOnWordStartOnly});this._completionModel=new CompletionModel(Rt.items,this._context.column,{leadingLineContent:Bt.leadingLineContent,characterCountDelta:Bt.column-this._context.column},Nt,this._editor.getOption(113),this._editor.getOption(107),Ut,Ft),this._completionDisposables.add(Rt.disposable),this._onNewContext(Bt),this._reportDurationsTelemetry(Rt.durations)})).catch(onUnexpectedError)}_reportDurationsTelemetry(nt){this._telemetryGate++%230===0&&setTimeout(()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(nt)}),this._logService.debug("suggest.durations.json",nt)})}static _createSuggestFilter(nt){const ot=new Set;nt.getOption(107)==="none"&&ot.add(27);const ut=nt.getOption(113);return ut.showMethods||ot.add(0),ut.showFunctions||ot.add(1),ut.showConstructors||ot.add(2),ut.showFields||ot.add(3),ut.showVariables||ot.add(4),ut.showClasses||ot.add(5),ut.showStructs||ot.add(6),ut.showInterfaces||ot.add(7),ut.showModules||ot.add(8),ut.showProperties||ot.add(9),ut.showEvents||ot.add(10),ut.showOperators||ot.add(11),ut.showUnits||ot.add(12),ut.showValues||ot.add(13),ut.showConstants||ot.add(14),ut.showEnums||ot.add(15),ut.showEnumMembers||ot.add(16),ut.showKeywords||ot.add(17),ut.showWords||ot.add(18),ut.showColors||ot.add(19),ut.showFiles||ot.add(20),ut.showReferences||ot.add(21),ut.showColors||ot.add(22),ut.showFolders||ot.add(23),ut.showTypeParameters||ot.add(24),ut.showSnippets||ot.add(27),ut.showUsers||ot.add(25),ut.showIssues||ot.add(26),{itemKind:ot,showDeprecated:ut.showDeprecated}}_onNewContext(nt){if(this._context){if(nt.lineNumber!==this._context.lineNumber){this.cancel();return}if(getLeadingWhitespace(nt.leadingLineContent)!==getLeadingWhitespace(this._context.leadingLineContent)){this.cancel();return}if(nt.column<this._context.column){nt.leadingWord.word?this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0}):this.cancel();return}if(this._completionModel){if(nt.leadingWord.word.length!==0&&nt.leadingWord.startColumn>this._context.leadingWord.startColumn){if(LineContext.shouldAutoTrigger(this._editor)&&this._context){const rt=this._completionModel.getItemsByProvider();this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerItemsToReuse:rt}})}return}if(nt.column>this._context.column&&this._completionModel.getIncompleteProvider().size>0&&nt.leadingWord.word.length!==0){const ot=new Map,rt=new Set;for(const[ut,gt]of this._completionModel.getItemsByProvider())gt.length>0&&gt[0].container.incomplete?rt.add(ut):ot.set(ut,gt);this.trigger({auto:this._context.triggerOptions.auto,triggerKind:2,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerFilter:rt,providerItemsToReuse:ot}})}else{const ot=this._completionModel.lineContext;let rt=!1;if(this._completionModel.lineContext={leadingLineContent:nt.leadingLineContent,characterCountDelta:nt.column-this._context.column},this._completionModel.items.length===0){const ut=LineContext.shouldAutoTrigger(this._editor);if(!this._context){this.cancel();return}if(ut&&this._context.leadingWord.endColumn<nt.leadingWord.startColumn){this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0});return}if(this._context.triggerOptions.auto){this.cancel();return}else if(this._completionModel.lineContext=ot,rt=this._completionModel.items.length>0,rt&&nt.leadingWord.word.length===0){this.cancel();return}}this._onDidSuggest.fire({completionModel:this._completionModel,triggerOptions:nt.triggerOptions,isFrozen:rt})}}}}};SuggestModel=__decorate$E([__param$E(1,IEditorWorkerService),__param$E(2,IClipboardService),__param$E(3,ITelemetryService),__param$E(4,ILogService),__param$E(5,IContextKeyService),__param$E(6,IConfigurationService),__param$E(7,ILanguageFeaturesService)],SuggestModel);class OvertypingCapturer{constructor(nt,ot){this._disposables=new DisposableStore,this._lastOvertyped=[],this._locked=!1,this._disposables.add(nt.onWillType(()=>{if(this._locked||!nt.hasModel())return;const rt=nt.getSelections(),ut=rt.length;let gt=!1;for(let mt=0;mt<ut;mt++)if(!rt[mt].isEmpty()){gt=!0;break}if(!gt){this._lastOvertyped.length!==0&&(this._lastOvertyped.length=0);return}this._lastOvertyped=[];const pt=nt.getModel();for(let mt=0;mt<ut;mt++){const vt=rt[mt];if(pt.getValueLengthInRange(vt)>OvertypingCapturer._maxSelectionLength)return;this._lastOvertyped[mt]={value:pt.getValueInRange(vt),multiline:vt.startLineNumber!==vt.endLineNumber}}})),this._disposables.add(ot.onDidTrigger(rt=>{this._locked=!0})),this._disposables.add(ot.onDidCancel(rt=>{this._locked=!1}))}getLastOvertypedInfo(nt){if(nt>=0&&nt<this._lastOvertyped.length)return this._lastOvertyped[nt]}dispose(){this._disposables.dispose()}}OvertypingCapturer._maxSelectionLength=51200;const suggest="";var __decorate$D=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$D=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};class StatusBarViewItem extends MenuEntryActionViewItem{updateLabel(){const nt=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!nt)return super.updateLabel();this.label&&(this.label.textContent=localize({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",this._action.label,StatusBarViewItem.symbolPrintEnter(nt)))}static symbolPrintEnter(nt){var ot;return(ot=nt.getLabel())===null||ot===void 0?void 0:ot.replace(/\benter\b/gi,"")}}let SuggestWidgetStatus=class{constructor(nt,ot,rt,ut,gt){this._menuId=ot,this._menuService=ut,this._contextKeyService=gt,this._menuDisposables=new DisposableStore,this.element=append$1(nt,$$d(".suggest-status-bar"));const pt=mt=>mt instanceof MenuItemAction?rt.createInstance(StatusBarViewItem,mt,void 0):void 0;this._leftActions=new ActionBar(this.element,{actionViewItemProvider:pt}),this._rightActions=new ActionBar(this.element,{actionViewItemProvider:pt}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}dispose(){this._menuDisposables.dispose(),this.element.remove()}show(){const nt=this._menuService.createMenu(this._menuId,this._contextKeyService),ot=()=>{const rt=[],ut=[];for(const[gt,pt]of nt.getActions())gt==="left"?rt.push(...pt):ut.push(...pt);this._leftActions.clear(),this._leftActions.push(rt),this._rightActions.clear(),this._rightActions.push(ut)};this._menuDisposables.add(nt.onDidChange(()=>ot())),this._menuDisposables.add(nt)}hide(){this._menuDisposables.clear()}};SuggestWidgetStatus=__decorate$D([__param$D(2,IInstantiationService),__param$D(3,IMenuService),__param$D(4,IContextKeyService)],SuggestWidgetStatus);class ResizableHTMLElement{constructor(){this._onDidWillResize=new Emitter$2,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new Emitter$2,this.onDidResize=this._onDidResize.event,this._sashListener=new DisposableStore,this._size=new Dimension(0,0),this._minSize=new Dimension(0,0),this._maxSize=new Dimension(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new Sash(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new Sash(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new Sash(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:OrthogonalEdge.North}),this._southSash=new Sash(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:OrthogonalEdge.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let nt,ot=0,rt=0;this._sashListener.add(Event.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{nt===void 0&&(this._onDidWillResize.fire(),nt=this._size,ot=0,rt=0)})),this._sashListener.add(Event.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{nt!==void 0&&(nt=void 0,ot=0,rt=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(ut=>{nt&&(rt=ut.currentX-ut.startX,this.layout(nt.height+ot,nt.width+rt),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(ut=>{nt&&(rt=-(ut.currentX-ut.startX),this.layout(nt.height+ot,nt.width+rt),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(ut=>{nt&&(ot=-(ut.currentY-ut.startY),this.layout(nt.height+ot,nt.width+rt),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(ut=>{nt&&(ot=ut.currentY-ut.startY,this.layout(nt.height+ot,nt.width+rt),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(Event.any(this._eastSash.onDidReset,this._westSash.onDidReset)(ut=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(Event.any(this._northSash.onDidReset,this._southSash.onDidReset)(ut=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(nt,ot,rt,ut){this._northSash.state=nt?3:0,this._eastSash.state=ot?3:0,this._southSash.state=rt?3:0,this._westSash.state=ut?3:0}layout(nt=this.size.height,ot=this.size.width){const{height:rt,width:ut}=this._minSize,{height:gt,width:pt}=this._maxSize;nt=Math.max(rt,Math.min(gt,nt)),ot=Math.max(ut,Math.min(pt,ot));const mt=new Dimension(ot,nt);Dimension.equals(mt,this._size)||(this.domNode.style.height=nt+"px",this.domNode.style.width=ot+"px",this._size=mt,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(nt){this._maxSize=nt}get maxSize(){return this._maxSize}set minSize(nt){this._minSize=nt}get minSize(){return this._minSize}set preferredSize(nt){this._preferredSize=nt}get preferredSize(){return this._preferredSize}}var __decorate$C=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$C=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};function canExpandCompletionItem(ct){return!!ct&&!!(ct.completion.documentation||ct.completion.detail&&ct.completion.detail!==ct.completion.label)}let SuggestDetailsWidget=class{constructor(nt,ot){this._editor=nt,this._onDidClose=new Emitter$2,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new Emitter$2,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new DisposableStore,this._renderDisposeable=new DisposableStore,this._borderWidth=1,this._size=new Dimension(330,0),this.domNode=$$d(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=ot.createInstance(MarkdownRenderer,{editor:nt}),this._body=$$d(".body"),this._scrollbar=new DomScrollableElement(this._body,{alwaysConsumeMouseWheel:!0}),append$1(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=append$1(this._body,$$d(".header")),this._close=append$1(this._header,$$d("span"+ThemeIcon.asCSSSelector(Codicon.close))),this._close.title=localize("details.close","Close"),this._type=append$1(this._header,$$d("p.type")),this._docs=append$1(this._body,$$d("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration(rt=>{rt.hasChanged(48)&&this._configureFont()}))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){const nt=this._editor.getOptions(),ot=nt.get(48),rt=ot.getMassagedFontFamily(),ut=nt.get(114)||ot.fontSize,gt=nt.get(115)||ot.lineHeight,pt=ot.fontWeight,mt=`${ut}px`,vt=`${gt}px`;this.domNode.style.fontSize=mt,this.domNode.style.lineHeight=`${gt/ut}`,this.domNode.style.fontWeight=pt,this.domNode.style.fontFeatureSettings=ot.fontFeatureSettings,this._type.style.fontFamily=rt,this._close.style.height=vt,this._close.style.width=vt}getLayoutInfo(){const nt=this._editor.getOption(115)||this._editor.getOption(48).lineHeight,ot=this._borderWidth,rt=ot*2;return{lineHeight:nt,borderWidth:ot,borderHeight:rt,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=localize("loading","Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,this.getLayoutInfo().lineHeight*2),this._onDidChangeContents.fire(this)}renderItem(nt,ot){var rt,ut;this._renderDisposeable.clear();let{detail:gt,documentation:pt}=nt.completion;if(ot){let mt="";mt+=`score: ${nt.score[0]}
`,mt+=`prefix: ${(rt=nt.word)!==null&&rt!==void 0?rt:"(no prefix)"}
`,mt+=`word: ${nt.completion.filterText?nt.completion.filterText+" (filterText)":nt.textLabel}
`,mt+=`distance: ${nt.distance} (localityBonus-setting)
`,mt+=`index: ${nt.idx}, based on ${nt.completion.sortText&&`sortText: "${nt.completion.sortText}"`||"label"}
`,mt+=`commit_chars: ${(ut=nt.completion.commitCharacters)===null||ut===void 0?void 0:ut.join("")}
`,pt=new MarkdownString().appendCodeblock("empty",mt),gt=`Provider: ${nt.provider._debugDisplayName}`}if(!ot&&!canExpandCompletionItem(nt)){this.clearContents();return}if(this.domNode.classList.remove("no-docs","no-type"),gt){const mt=gt.length>1e5?`${gt.substr(0,1e5)}`:gt;this._type.textContent=mt,this._type.title=mt,show(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gmi.test(mt))}else clearNode(this._type),this._type.title="",hide(this._type),this.domNode.classList.add("no-type");if(clearNode(this._docs),typeof pt=="string")this._docs.classList.remove("markdown-docs"),this._docs.textContent=pt;else if(pt){this._docs.classList.add("markdown-docs"),clearNode(this._docs);const mt=this._markdownRenderer.render(pt);this._docs.appendChild(mt.element),this._renderDisposeable.add(mt),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=mt=>{mt.preventDefault(),mt.stopPropagation()},this._close.onclick=mt=>{mt.preventDefault(),mt.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get size(){return this._size}layout(nt,ot){const rt=new Dimension(nt,ot);Dimension.equals(rt,this._size)||(this._size=rt,size(this.domNode,nt,ot)),this._scrollbar.scanDomNode()}scrollDown(nt=8){this._body.scrollTop+=nt}scrollUp(nt=8){this._body.scrollTop-=nt}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(nt){this._borderWidth=nt}get borderWidth(){return this._borderWidth}};SuggestDetailsWidget=__decorate$C([__param$C(1,IInstantiationService)],SuggestDetailsWidget);class SuggestDetailsOverlay{constructor(nt,ot){this.widget=nt,this._editor=ot,this._disposables=new DisposableStore,this._added=!1,this._preferAlignAtTop=!0,this._resizable=new ResizableHTMLElement,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(nt.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let rt,ut,gt=0,pt=0;this._disposables.add(this._resizable.onDidWillResize(()=>{rt=this._topLeft,ut=this._resizable.size})),this._disposables.add(this._resizable.onDidResize(mt=>{if(rt&&ut){this.widget.layout(mt.dimension.width,mt.dimension.height);let vt=!1;mt.west&&(pt=ut.width-mt.dimension.width,vt=!0),mt.north&&(gt=ut.height-mt.dimension.height,vt=!0),vt&&this._applyTopLeft({top:rt.top+gt,left:rt.left+pt})}mt.done&&(rt=void 0,ut=void 0,gt=0,pt=0,this._userSize=mt.dimension)})),this._disposables.add(this.widget.onDidChangeContents(()=>{var mt;this._anchorBox&&this._placeAtAnchor(this._anchorBox,(mt=this._userSize)!==null&&mt!==void 0?mt:this.widget.size,this._preferAlignAtTop)}))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return null}show(){this._added||(this._editor.addOverlayWidget(this),this.getDomNode().style.position="fixed",this._added=!0)}hide(nt=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),nt&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(nt,ot){var rt;const ut=nt.getBoundingClientRect();this._anchorBox=ut,this._preferAlignAtTop=ot,this._placeAtAnchor(this._anchorBox,(rt=this._userSize)!==null&&rt!==void 0?rt:this.widget.size,ot)}_placeAtAnchor(nt,ot,rt){var ut;const gt=getClientArea(document.body),pt=this.widget.getLayoutInfo(),mt=new Dimension(220,2*pt.lineHeight),vt=nt.top,St=function(){const Nt=gt.width-(nt.left+nt.width+pt.borderWidth+pt.horizontalPadding),Pt=-pt.borderWidth+nt.left+nt.width,Ft=new Dimension(Nt,gt.height-nt.top-pt.borderHeight-pt.verticalPadding),Kt=Ft.with(void 0,nt.top+nt.height-pt.borderHeight-pt.verticalPadding);return{top:vt,left:Pt,fit:Nt-ot.width,maxSizeTop:Ft,maxSizeBottom:Kt,minSize:mt.with(Math.min(Nt,mt.width))}}(),yt=function(){const Nt=nt.left-pt.borderWidth-pt.horizontalPadding,Pt=Math.max(pt.horizontalPadding,nt.left-ot.width-pt.borderWidth),Ft=new Dimension(Nt,gt.height-nt.top-pt.borderHeight-pt.verticalPadding),Kt=Ft.with(void 0,nt.top+nt.height-pt.borderHeight-pt.verticalPadding);return{top:vt,left:Pt,fit:Nt-ot.width,maxSizeTop:Ft,maxSizeBottom:Kt,minSize:mt.with(Math.min(Nt,mt.width))}}(),wt=function(){const Nt=nt.left,Pt=-pt.borderWidth+nt.top+nt.height,Ft=new Dimension(nt.width-pt.borderHeight,gt.height-nt.top-nt.height-pt.verticalPadding);return{top:Pt,left:Nt,fit:Ft.height-ot.height,maxSizeBottom:Ft,maxSizeTop:Ft,minSize:mt.with(Ft.width)}}(),Lt=[St,yt,wt],xt=(ut=Lt.find(Nt=>Nt.fit>=0))!==null&&ut!==void 0?ut:Lt.sort((Nt,Pt)=>Pt.fit-Nt.fit)[0],It=nt.top+nt.height-pt.borderHeight;let kt,At=ot.height;const Tt=Math.max(xt.maxSizeTop.height,xt.maxSizeBottom.height);At>Tt&&(At=Tt);let Rt;rt?At<=xt.maxSizeTop.height?(kt=!0,Rt=xt.maxSizeTop):(kt=!1,Rt=xt.maxSizeBottom):At<=xt.maxSizeBottom.height?(kt=!1,Rt=xt.maxSizeBottom):(kt=!0,Rt=xt.maxSizeTop),this._applyTopLeft({left:xt.left,top:kt?xt.top:It-At}),this.getDomNode().style.position="fixed",this._resizable.enableSashes(!kt,xt===St,kt,xt!==St),this._resizable.minSize=xt.minSize,this._resizable.maxSize=Rt,this._resizable.layout(At,Math.min(Rt.width,ot.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(nt){this._topLeft=nt,this.getDomNode().style.left=`${this._topLeft.left}px`,this.getDomNode().style.top=`${this._topLeft.top}px`}}var FileKind;(function(ct){ct[ct.FILE=0]="FILE",ct[ct.FOLDER=1]="FOLDER",ct[ct.ROOT_FOLDER=2]="ROOT_FOLDER"})(FileKind||(FileKind={}));const fileIconDirectoryRegex=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function getIconClasses(ct,nt,ot,rt){const ut=rt===FileKind.ROOT_FOLDER?["rootfolder-icon"]:rt===FileKind.FOLDER?["folder-icon"]:["file-icon"];if(ot){let gt;if(ot.scheme===Schemas.data)gt=DataUri.parseMetaData(ot).get(DataUri.META_DATA_LABEL);else{const pt=ot.path.match(fileIconDirectoryRegex);pt?(gt=cssEscape(pt[2].toLowerCase()),pt[1]&&ut.push(`${cssEscape(pt[1].toLowerCase())}-name-dir-icon`)):gt=cssEscape(ot.authority.toLowerCase())}if(rt===FileKind.FOLDER)ut.push(`${gt}-name-folder-icon`);else{if(gt){if(ut.push(`${gt}-name-file-icon`),ut.push("name-file-icon"),gt.length<=255){const mt=gt.split(".");for(let vt=1;vt<mt.length;vt++)ut.push(`${mt.slice(vt).join(".")}-ext-file-icon`)}ut.push("ext-file-icon")}const pt=detectLanguageId(ct,nt,ot);pt&&ut.push(`${cssEscape(pt)}-lang-file-icon`)}}return ut}function detectLanguageId(ct,nt,ot){if(!ot)return null;let rt=null;if(ot.scheme===Schemas.data){const gt=DataUri.parseMetaData(ot).get(DataUri.META_DATA_MIME);gt&&(rt=nt.getLanguageIdByMimeType(gt))}else{const ut=ct.getModel(ot);ut&&(rt=ut.getLanguageId())}return rt&&rt!==PLAINTEXT_LANGUAGE_ID?rt:nt.guessLanguageIdByFilepathOrFirstLine(ot)}function cssEscape(ct){return ct.replace(/[\11\12\14\15\40]/g,"/")}var __decorate$B=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$B=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},_a$1;function getAriaId(ct){return`suggest-aria-id:${ct}`}const suggestMoreInfoIcon=registerIcon("suggest-more-info",Codicon.chevronRight,localize("suggestMoreInfoIcon","Icon for more information in the suggest widget.")),_completionItemColor=new(_a$1=class Oo{extract(nt,ot){if(nt.textLabel.match(Oo._regexStrict))return ot[0]=nt.textLabel,!0;if(nt.completion.detail&&nt.completion.detail.match(Oo._regexStrict))return ot[0]=nt.completion.detail,!0;if(typeof nt.completion.documentation=="string"){const rt=Oo._regexRelaxed.exec(nt.completion.documentation);if(rt&&(rt.index===0||rt.index+rt[0].length===nt.completion.documentation.length))return ot[0]=rt[0],!0}return!1}},_a$1._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/,_a$1._regexStrict=new RegExp(`^${_a$1._regexRelaxed.source}$`,"i"),_a$1);let ItemRenderer=class{constructor(nt,ot,rt,ut){this._editor=nt,this._modelService=ot,this._languageService=rt,this._themeService=ut,this._onDidToggleDetails=new Emitter$2,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(nt){const ot=new DisposableStore,rt=nt;rt.classList.add("show-file-icons");const ut=append$1(nt,$$d(".icon")),gt=append$1(ut,$$d("span.colorspan")),pt=append$1(nt,$$d(".contents")),mt=append$1(pt,$$d(".main")),vt=append$1(mt,$$d(".icon-label.codicon")),St=append$1(mt,$$d("span.left")),yt=append$1(mt,$$d("span.right")),wt=new IconLabel(St,{supportHighlights:!0,supportIcons:!0});ot.add(wt);const Lt=append$1(St,$$d("span.signature-label")),xt=append$1(St,$$d("span.qualifier-label")),It=append$1(yt,$$d("span.details-label")),kt=append$1(yt,$$d("span.readMore"+ThemeIcon.asCSSSelector(suggestMoreInfoIcon)));kt.title=localize("readMore","Read More");const At=()=>{const Tt=this._editor.getOptions(),Rt=Tt.get(48),Nt=Rt.getMassagedFontFamily(),Pt=Rt.fontFeatureSettings,Ft=Tt.get(114)||Rt.fontSize,Kt=Tt.get(115)||Rt.lineHeight,Bt=Rt.fontWeight,Ut=Rt.letterSpacing,qt=`${Ft}px`,Yt=`${Kt}px`,Zt=`${Ut}px`;rt.style.fontSize=qt,rt.style.fontWeight=Bt,rt.style.letterSpacing=Zt,mt.style.fontFamily=Nt,mt.style.fontFeatureSettings=Pt,mt.style.lineHeight=Yt,ut.style.height=Yt,ut.style.width=Yt,kt.style.height=Yt,kt.style.width=Yt};return At(),ot.add(this._editor.onDidChangeConfiguration(Tt=>{(Tt.hasChanged(48)||Tt.hasChanged(114)||Tt.hasChanged(115))&&At()})),{root:rt,left:St,right:yt,icon:ut,colorspan:gt,iconLabel:wt,iconContainer:vt,parametersLabel:Lt,qualifierLabel:xt,detailsLabel:It,readMore:kt,disposables:ot}}renderElement(nt,ot,rt){const{completion:ut}=nt;rt.root.id=getAriaId(ot),rt.colorspan.style.backgroundColor="";const gt={labelEscapeNewLines:!0,matches:createMatches(nt.score)},pt=[];if(ut.kind===19&&_completionItemColor.extract(nt,pt))rt.icon.className="icon customcolor",rt.iconContainer.className="icon hide",rt.colorspan.style.backgroundColor=pt[0];else if(ut.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){rt.icon.className="icon hide",rt.iconContainer.className="icon hide";const mt=getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:nt.textLabel}),FileKind.FILE),vt=getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:ut.detail}),FileKind.FILE);gt.extraClasses=mt.length>vt.length?mt:vt}else ut.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(rt.icon.className="icon hide",rt.iconContainer.className="icon hide",gt.extraClasses=[getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:nt.textLabel}),FileKind.FOLDER),getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:ut.detail}),FileKind.FOLDER)].flat()):(rt.icon.className="icon hide",rt.iconContainer.className="",rt.iconContainer.classList.add("suggest-icon",...ThemeIcon.asClassNameArray(CompletionItemKinds.toIcon(ut.kind))));ut.tags&&ut.tags.indexOf(1)>=0&&(gt.extraClasses=(gt.extraClasses||[]).concat(["deprecated"]),gt.matches=[]),rt.iconLabel.setLabel(nt.textLabel,void 0,gt),typeof ut.label=="string"?(rt.parametersLabel.textContent="",rt.detailsLabel.textContent=stripNewLines(ut.detail||""),rt.root.classList.add("string-label")):(rt.parametersLabel.textContent=stripNewLines(ut.label.detail||""),rt.detailsLabel.textContent=stripNewLines(ut.label.description||""),rt.root.classList.remove("string-label")),this._editor.getOption(113).showInlineDetails?show(rt.detailsLabel):hide(rt.detailsLabel),canExpandCompletionItem(nt)?(rt.right.classList.add("can-expand-details"),show(rt.readMore),rt.readMore.onmousedown=mt=>{mt.stopPropagation(),mt.preventDefault()},rt.readMore.onclick=mt=>{mt.stopPropagation(),mt.preventDefault(),this._onDidToggleDetails.fire()}):(rt.right.classList.remove("can-expand-details"),hide(rt.readMore),rt.readMore.onmousedown=null,rt.readMore.onclick=null)}disposeTemplate(nt){nt.disposables.dispose()}};ItemRenderer=__decorate$B([__param$B(1,IModelService),__param$B(2,ILanguageService),__param$B(3,IThemeService)],ItemRenderer);function stripNewLines(ct){return ct.replace(/\r\n|\r|\n/g,"")}var __decorate$A=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$A=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$o=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};registerColor("editorSuggestWidget.background",{dark:editorWidgetBackground,light:editorWidgetBackground,hcDark:editorWidgetBackground,hcLight:editorWidgetBackground},localize("editorSuggestWidgetBackground","Background color of the suggest widget."));registerColor("editorSuggestWidget.border",{dark:editorWidgetBorder,light:editorWidgetBorder,hcDark:editorWidgetBorder,hcLight:editorWidgetBorder},localize("editorSuggestWidgetBorder","Border color of the suggest widget."));const editorSuggestWidgetForeground=registerColor("editorSuggestWidget.foreground",{dark:editorForeground,light:editorForeground,hcDark:editorForeground,hcLight:editorForeground},localize("editorSuggestWidgetForeground","Foreground color of the suggest widget."));registerColor("editorSuggestWidget.selectedForeground",{dark:quickInputListFocusForeground,light:quickInputListFocusForeground,hcDark:quickInputListFocusForeground,hcLight:quickInputListFocusForeground},localize("editorSuggestWidgetSelectedForeground","Foreground color of the selected entry in the suggest widget."));registerColor("editorSuggestWidget.selectedIconForeground",{dark:quickInputListFocusIconForeground,light:quickInputListFocusIconForeground,hcDark:quickInputListFocusIconForeground,hcLight:quickInputListFocusIconForeground},localize("editorSuggestWidgetSelectedIconForeground","Icon foreground color of the selected entry in the suggest widget."));const editorSuggestWidgetSelectedBackground=registerColor("editorSuggestWidget.selectedBackground",{dark:quickInputListFocusBackground,light:quickInputListFocusBackground,hcDark:quickInputListFocusBackground,hcLight:quickInputListFocusBackground},localize("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget."));registerColor("editorSuggestWidget.highlightForeground",{dark:listHighlightForeground,light:listHighlightForeground,hcDark:listHighlightForeground,hcLight:listHighlightForeground},localize("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget."));registerColor("editorSuggestWidget.focusHighlightForeground",{dark:listFocusHighlightForeground,light:listFocusHighlightForeground,hcDark:listFocusHighlightForeground,hcLight:listFocusHighlightForeground},localize("editorSuggestWidgetFocusHighlightForeground","Color of the match highlights in the suggest widget when an item is focused."));registerColor("editorSuggestWidgetStatus.foreground",{dark:transparent(editorSuggestWidgetForeground,.5),light:transparent(editorSuggestWidgetForeground,.5),hcDark:transparent(editorSuggestWidgetForeground,.5),hcLight:transparent(editorSuggestWidgetForeground,.5)},localize("editorSuggestWidgetStatusForeground","Foreground color of the suggest widget status."));class PersistedWidgetSize{constructor(nt,ot){this._service=nt,this._key=`suggestWidget.size/${ot.getEditorType()}/${ot instanceof EmbeddedCodeEditorWidget}`}restore(){var nt;const ot=(nt=this._service.get(this._key,0))!==null&&nt!==void 0?nt:"";try{const rt=JSON.parse(ot);if(Dimension.is(rt))return Dimension.lift(rt)}catch{}}store(nt){this._service.store(this._key,JSON.stringify(nt),0,1)}reset(){this._service.remove(this._key,0)}}let SuggestWidget=class Xo{constructor(nt,ot,rt,ut,gt){this.editor=nt,this._storageService=ot,this._state=0,this._isAuto=!1,this._pendingLayout=new MutableDisposable,this._pendingShowDetails=new MutableDisposable,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new TimeoutTimer,this._disposables=new DisposableStore,this._onDidSelect=new PauseableEmitter,this._onDidFocus=new PauseableEmitter,this._onDidHide=new Emitter$2,this._onDidShow=new Emitter$2,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new Emitter$2,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new ResizableHTMLElement,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new SuggestContentWidget(this,nt),this._persistedSize=new PersistedWidgetSize(ot,nt);class pt{constructor(xt,It,kt=!1,At=!1){this.persistedSize=xt,this.currentSize=It,this.persistHeight=kt,this.persistWidth=At}}let mt;this._disposables.add(this.element.onDidWillResize(()=>{this._contentWidget.lockPreference(),mt=new pt(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(Lt=>{var xt,It,kt,At;if(this._resize(Lt.dimension.width,Lt.dimension.height),mt&&(mt.persistHeight=mt.persistHeight||!!Lt.north||!!Lt.south,mt.persistWidth=mt.persistWidth||!!Lt.east||!!Lt.west),!!Lt.done){if(mt){const{itemHeight:Tt,defaultSize:Rt}=this.getLayoutInfo(),Nt=Math.round(Tt/2);let{width:Pt,height:Ft}=this.element.size;(!mt.persistHeight||Math.abs(mt.currentSize.height-Ft)<=Nt)&&(Ft=(It=(xt=mt.persistedSize)===null||xt===void 0?void 0:xt.height)!==null&&It!==void 0?It:Rt.height),(!mt.persistWidth||Math.abs(mt.currentSize.width-Pt)<=Nt)&&(Pt=(At=(kt=mt.persistedSize)===null||kt===void 0?void 0:kt.width)!==null&&At!==void 0?At:Rt.width),this._persistedSize.store(new Dimension(Pt,Ft))}this._contentWidget.unlockPreference(),mt=void 0}})),this._messageElement=append$1(this.element.domNode,$$d(".message")),this._listElement=append$1(this.element.domNode,$$d(".tree"));const vt=gt.createInstance(SuggestDetailsWidget,this.editor);vt.onDidClose(this.toggleDetails,this,this._disposables),this._details=new SuggestDetailsOverlay(vt,this.editor);const St=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(113).showIcons);St();const yt=gt.createInstance(ItemRenderer,this.editor);this._disposables.add(yt),this._disposables.add(yt.onDidToggleDetails(()=>this.toggleDetails())),this._list=new List("SuggestWidget",this._listElement,{getHeight:Lt=>this.getLayoutInfo().itemHeight,getTemplateId:Lt=>"suggestion"},[yt],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>localize("suggest","Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:Lt=>{let xt=Lt.textLabel;if(typeof Lt.completion.label!="string"){const{detail:Tt,description:Rt}=Lt.completion.label;Tt&&Rt?xt=localize("label.full","{0}{1}, {2}",xt,Tt,Rt):Tt?xt=localize("label.detail","{0}{1}",xt,Tt):Rt&&(xt=localize("label.desc","{0}, {1}",xt,Rt))}if(!Lt.isResolved||!this._isDetailsVisible())return xt;const{documentation:It,detail:kt}=Lt.completion,At=format("{0}{1}",kt||"",It?typeof It=="string"?It:It.value:"");return localize("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",xt,At)}}}),this._list.style(getListStyles({listInactiveFocusBackground:editorSuggestWidgetSelectedBackground,listInactiveFocusOutline:activeContrastBorder})),this._status=gt.createInstance(SuggestWidgetStatus,this.element.domNode,suggestWidgetStatusbarMenu);const wt=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(113).showStatusBar);wt(),this._disposables.add(ut.onDidColorThemeChange(Lt=>this._onThemeChange(Lt))),this._onThemeChange(ut.getColorTheme()),this._disposables.add(this._list.onMouseDown(Lt=>this._onListMouseDownOrTap(Lt))),this._disposables.add(this._list.onTap(Lt=>this._onListMouseDownOrTap(Lt))),this._disposables.add(this._list.onDidChangeSelection(Lt=>this._onListSelection(Lt))),this._disposables.add(this._list.onDidChangeFocus(Lt=>this._onListFocus(Lt))),this._disposables.add(this.editor.onDidChangeCursorSelection(()=>this._onCursorSelectionChanged())),this._disposables.add(this.editor.onDidChangeConfiguration(Lt=>{Lt.hasChanged(113)&&(wt(),St())})),this._ctxSuggestWidgetVisible=Context$1.Visible.bindTo(rt),this._ctxSuggestWidgetDetailsVisible=Context$1.DetailsVisible.bindTo(rt),this._ctxSuggestWidgetMultipleSuggestions=Context$1.MultipleSuggestions.bindTo(rt),this._ctxSuggestWidgetHasFocusedSuggestion=Context$1.HasFocusedSuggestion.bindTo(rt),this._disposables.add(addStandardDisposableListener(this._details.widget.domNode,"keydown",Lt=>{this._onDetailsKeydown.fire(Lt)})),this._disposables.add(this.editor.onMouseDown(Lt=>this._onEditorMouseDown(Lt)))}dispose(){var nt;this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),(nt=this._loadingTimeout)===null||nt===void 0||nt.dispose(),this._pendingLayout.dispose(),this._pendingShowDetails.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(nt){this._details.widget.domNode.contains(nt.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(nt.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(nt){typeof nt.element>"u"||typeof nt.index>"u"||(nt.browserEvent.preventDefault(),nt.browserEvent.stopPropagation(),this._select(nt.element,nt.index))}_onListSelection(nt){nt.elements.length&&this._select(nt.elements[0],nt.indexes[0])}_select(nt,ot){const rt=this._completionModel;rt&&(this._onDidSelect.fire({item:nt,index:ot,model:rt}),this.editor.focus())}_onThemeChange(nt){this._details.widget.borderWidth=isHighContrast(nt.type)?2:1}_onListFocus(nt){var ot;if(this._ignoreFocusEvents)return;if(!nt.elements.length){this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0}),this._ctxSuggestWidgetHasFocusedSuggestion.set(!1);return}if(!this._completionModel)return;this._ctxSuggestWidgetHasFocusedSuggestion.set(!0);const rt=nt.elements[0],ut=nt.indexes[0];rt!==this._focusedItem&&((ot=this._currentSuggestionDetails)===null||ot===void 0||ot.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=rt,this._list.reveal(ut),this._currentSuggestionDetails=createCancelablePromise(gt=>__awaiter$o(this,void 0,void 0,function*(){const pt=disposableTimeout(()=>{this._isDetailsVisible()&&this.showDetails(!0)},250),mt=gt.onCancellationRequested(()=>pt.dispose()),vt=yield rt.resolve(gt);return pt.dispose(),mt.dispose(),vt})),this._currentSuggestionDetails.then(()=>{ut>=this._list.length||rt!==this._list.element(ut)||(this._ignoreFocusEvents=!0,this._list.splice(ut,1,[rt]),this._list.setFocus([ut]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this.showDetails(!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:getAriaId(ut)}))}).catch(onUnexpectedError)),this._onDidFocus.fire({item:rt,index:ut,model:this._completionModel})}_setState(nt){if(this._state!==nt)switch(this._state=nt,this.element.domNode.classList.toggle("frozen",nt===4),this.element.domNode.classList.remove("message"),nt){case 0:hide(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._ctxSuggestWidgetHasFocusedSuggestion.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=Xo.LOADING_MESSAGE,hide(this._listElement,this._status.element),show(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=Xo.NO_SUGGESTIONS_MESSAGE,hide(this._listElement,this._status.element),show(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 3:hide(this._messageElement),show(this._listElement,this._status.element),this._show();break;case 4:hide(this._messageElement),show(this._listElement,this._status.element),this._show();break;case 5:hide(this._messageElement),show(this._listElement,this._status.element),this._details.show(),this._show();break}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)},100)}showTriggered(nt,ot){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!nt,this._isAuto||(this._loadingTimeout=disposableTimeout(()=>this._setState(1),ot)))}showSuggestions(nt,ot,rt,ut,gt){var pt,mt;if(this._contentWidget.setPosition(this.editor.getPosition()),(pt=this._loadingTimeout)===null||pt===void 0||pt.dispose(),(mt=this._currentSuggestionDetails)===null||mt===void 0||mt.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==nt&&(this._completionModel=nt),rt&&this._state!==2&&this._state!==0){this._setState(4);return}const vt=this._completionModel.items.length,St=vt===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(vt>1),St){this._setState(ut?0:2),this._completionModel=void 0;return}this._focusedItem=void 0,this._onDidFocus.pause(),this._onDidSelect.pause();try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(rt?4:3),this._list.reveal(ot,0),this._list.setFocus(gt?[]:[ot])}finally{this._onDidFocus.resume(),this._onDidSelect.resume()}this._pendingLayout.value=runAtThisOrScheduleAtNextAnimationFrame(()=>{this._pendingLayout.clear(),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")})}focusSelected(){this._list.length>0&&this._list.setFocus([0])}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel&&this._list.getFocus().length>0)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._setState(3),this._details.widget.domNode.classList.remove("focused")):this._state===3&&this._isDetailsVisible()&&(this._setState(5),this._details.widget.domNode.classList.add("focused"))}toggleDetails(){this._isDetailsVisible()?(this._pendingShowDetails.clear(),this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):(canExpandCompletionItem(this._list.getFocusedElements()[0])||this._explainMode)&&(this._state===3||this._state===5||this._state===4)&&(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}showDetails(nt){this._pendingShowDetails.value=runAtThisOrScheduleAtNextAnimationFrame(()=>{this._pendingShowDetails.clear(),this._details.show(),nt?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._positionDetails(),this.editor.focus(),this.element.domNode.classList.add("shows-details")})}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){var nt;this._pendingLayout.clear(),this._pendingShowDetails.clear(),(nt=this._loadingTimeout)===null||nt===void 0||nt.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();const ot=this._persistedSize.restore(),rt=Math.ceil(this.getLayoutInfo().itemHeight*4.3);ot&&ot.height<rt&&this._persistedSize.store(ot.with(void 0,rt))}isFrozen(){return this._state===4}_afterRender(nt){if(nt===null){this._isDetailsVisible()&&this._details.hide();return}this._state===2||this._state===1||(this._isDetailsVisible()&&this._details.show(),this._positionDetails())}_layout(nt){var ot,rt,ut;if(!this.editor.hasModel()||!this.editor.getDomNode())return;const gt=getClientArea(document.body),pt=this.getLayoutInfo();nt||(nt=pt.defaultSize);let mt=nt.height,vt=nt.width;if(this._status.element.style.height=`${pt.itemHeight}px`,this._state===2||this._state===1)mt=pt.itemHeight+pt.borderHeight,vt=pt.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new Dimension(vt,mt),this._contentWidget.setPreference(2);else{const St=gt.width-pt.borderHeight-2*pt.horizontalPadding;vt>St&&(vt=St);const yt=this._completionModel?this._completionModel.stats.pLabelLen*pt.typicalHalfwidthCharacterWidth:vt,wt=pt.statusBarHeight+this._list.contentHeight+pt.borderHeight,Lt=pt.itemHeight+pt.statusBarHeight,xt=getDomNodePagePosition(this.editor.getDomNode()),It=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),kt=xt.top+It.top+It.height,At=Math.min(gt.height-kt-pt.verticalPadding,wt),Tt=xt.top+It.top-pt.verticalPadding,Rt=Math.min(Tt,wt);let Nt=Math.min(Math.max(Rt,At)+pt.borderHeight,wt);mt===((ot=this._cappedHeight)===null||ot===void 0?void 0:ot.capped)&&(mt=this._cappedHeight.wanted),mt<Lt&&(mt=Lt),mt>Nt&&(mt=Nt);const Pt=150;mt>At||this._forceRenderingAbove&&Tt>Pt?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),Nt=Rt):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),Nt=At),this.element.preferredSize=new Dimension(yt,pt.defaultSize.height),this.element.maxSize=new Dimension(St,Nt),this.element.minSize=new Dimension(220,Lt),this._cappedHeight=mt===wt?{wanted:(ut=(rt=this._cappedHeight)===null||rt===void 0?void 0:rt.wanted)!==null&&ut!==void 0?ut:nt.height,capped:mt}:void 0}this._resize(vt,mt)}_resize(nt,ot){const{width:rt,height:ut}=this.element.maxSize;nt=Math.min(rt,nt),ot=Math.min(ut,ot);const{statusBarHeight:gt}=this.getLayoutInfo();this._list.layout(ot-gt,nt),this._listElement.style.height=`${ot-gt}px`,this.element.layout(ot,nt),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){var nt;this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,((nt=this._contentWidget.getPosition())===null||nt===void 0?void 0:nt.preference[0])===2)}getLayoutInfo(){const nt=this.editor.getOption(48),ot=clamp(this.editor.getOption(115)||nt.lineHeight,8,1e3),rt=!this.editor.getOption(113).showStatusBar||this._state===2||this._state===1?0:ot,ut=this._details.widget.borderWidth,gt=2*ut;return{itemHeight:ot,statusBarHeight:rt,borderWidth:ut,borderHeight:gt,typicalHalfwidthCharacterWidth:nt.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new Dimension(430,rt+12*ot+gt)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(nt){this._storageService.store("expandSuggestionDocs",nt,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};SuggestWidget.LOADING_MESSAGE=localize("suggestWidget.loading","Loading...");SuggestWidget.NO_SUGGESTIONS_MESSAGE=localize("suggestWidget.noSuggestions","No suggestions.");SuggestWidget=__decorate$A([__param$A(1,IStorageService),__param$A(2,IContextKeyService),__param$A(3,IThemeService),__param$A(4,IInstantiationService)],SuggestWidget);class SuggestContentWidget{constructor(nt,ot){this._widget=nt,this._editor=ot,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return this._hidden||!this._position||!this._preference?null:{position:this._position,preference:[this._preference]}}beforeRender(){const{height:nt,width:ot}=this._widget.element.size,{borderWidth:rt,horizontalPadding:ut}=this._widget.getLayoutInfo();return new Dimension(ot+2*rt+ut,nt+2*rt)}afterRender(nt){this._widget._afterRender(nt)}setPreference(nt){this._preferenceLocked||(this._preference=nt)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(nt){this._position=nt}}var __decorate$z=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$z=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};class LineSuffix{constructor(nt,ot){if(this._model=nt,this._position=ot,nt.getLineMaxColumn(ot.lineNumber)!==ot.column){const ut=nt.getOffsetAt(ot),gt=nt.getPositionAt(ut+1);this._marker=nt.deltaDecorations([],[{range:Range$2.fromPositions(ot,gt),options:{description:"suggest-line-suffix",stickiness:1}}])}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.deltaDecorations(this._marker,[])}delta(nt){if(this._model.isDisposed()||this._position.lineNumber!==nt.lineNumber)return 0;if(this._marker){const ot=this._model.getDecorationRange(this._marker[0]);return this._model.getOffsetAt(ot.getStartPosition())-this._model.getOffsetAt(nt)}else return this._model.getLineMaxColumn(nt.lineNumber)-nt.column}}let SuggestController=class Tr{static get(nt){return nt.getContribution(Tr.ID)}constructor(nt,ot,rt,ut,gt,pt,mt){this._memoryService=ot,this._commandService=rt,this._contextKeyService=ut,this._instantiationService=gt,this._logService=pt,this._telemetryService=mt,this._lineSuffix=new MutableDisposable,this._toDispose=new DisposableStore,this._selectors=new PriorityRegistry(wt=>wt.priority),this._telemetryGate=0,this.editor=nt,this.model=gt.createInstance(SuggestModel,this.editor),this._selectors.register({priority:0,select:(wt,Lt,xt)=>this._memoryService.select(wt,Lt,xt)});const vt=Context$1.InsertMode.bindTo(ut);vt.set(nt.getOption(113).insertMode),this.model.onDidTrigger(()=>vt.set(nt.getOption(113).insertMode)),this.widget=this._toDispose.add(new IdleValue(()=>{const wt=this._instantiationService.createInstance(SuggestWidget,this.editor);this._toDispose.add(wt),this._toDispose.add(wt.onDidSelect(At=>this._insertSuggestion(At,0),this));const Lt=new CommitCharacterController(this.editor,wt,this.model,At=>this._insertSuggestion(At,2));this._toDispose.add(Lt);const xt=Context$1.MakesTextEdit.bindTo(this._contextKeyService),It=Context$1.HasInsertAndReplaceRange.bindTo(this._contextKeyService),kt=Context$1.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(toDisposable(()=>{xt.reset(),It.reset(),kt.reset()})),this._toDispose.add(wt.onDidFocus(({item:At})=>{const Tt=this.editor.getPosition(),Rt=At.editStart.column,Nt=Tt.column;let Pt=!0;this.editor.getOption(1)==="smart"&&this.model.state===2&&!At.completion.additionalTextEdits&&!(At.completion.insertTextRules&4)&&Nt-Rt===At.completion.insertText.length&&(Pt=this.editor.getModel().getValueInRange({startLineNumber:Tt.lineNumber,startColumn:Rt,endLineNumber:Tt.lineNumber,endColumn:Nt})!==At.completion.insertText),xt.set(Pt),It.set(!Position$1.equals(At.editInsertEnd,At.editReplaceEnd)),kt.set(!!At.provider.resolveCompletionItem||!!At.completion.documentation||At.completion.detail!==At.completion.label)})),this._toDispose.add(wt.onDetailsKeyDown(At=>{if(At.toKeyCodeChord().equals(new KeyCodeChord(!0,!1,!1,!1,33))||isMacintosh&&At.toKeyCodeChord().equals(new KeyCodeChord(!1,!1,!1,!0,33))){At.stopPropagation();return}At.toKeyCodeChord().isModifierKey()||this.editor.focus()})),wt})),this._overtypingCapturer=this._toDispose.add(new IdleValue(()=>this._toDispose.add(new OvertypingCapturer(this.editor,this.model)))),this._alternatives=this._toDispose.add(new IdleValue(()=>this._toDispose.add(new SuggestAlternatives(this.editor,this._contextKeyService)))),this._toDispose.add(gt.createInstance(WordContextKey,nt)),this._toDispose.add(this.model.onDidTrigger(wt=>{this.widget.value.showTriggered(wt.auto,wt.shy?250:50),this._lineSuffix.value=new LineSuffix(this.editor.getModel(),wt.position)})),this._toDispose.add(this.model.onDidSuggest(wt=>{var Lt;if(wt.triggerOptions.shy)return;let xt=-1;for(const kt of this._selectors.itemsOrderedByPriorityDesc)if(xt=kt.select(this.editor.getModel(),this.editor.getPosition(),wt.completionModel.items),xt!==-1)break;xt===-1&&(xt=0);let It=!1;if(wt.triggerOptions.auto){const kt=this.editor.getOption(113);kt.snippetsPreventQuickSuggestions&&(!((Lt=SnippetController2.get(this.editor))===null||Lt===void 0)&&Lt.isInSnippet())?It=!0:kt.selectionMode==="never"||kt.selectionMode==="always"?It=kt.selectionMode==="never":kt.selectionMode==="whenTriggerCharacter"?It=wt.triggerOptions.triggerKind!==1:kt.selectionMode==="whenQuickSuggestion"&&(It=wt.triggerOptions.triggerKind===1&&!wt.triggerOptions.refilter)}this.widget.value.showSuggestions(wt.completionModel,xt,wt.isFrozen,wt.triggerOptions.auto,It)})),this._toDispose.add(this.model.onDidCancel(wt=>{wt.retrigger||this.widget.value.hideWidget()})),this._toDispose.add(this.editor.onDidBlurEditorWidget(()=>{this.model.cancel(),this.model.clear()}));const St=Context$1.AcceptSuggestionsOnEnter.bindTo(ut),yt=()=>{const wt=this.editor.getOption(1);St.set(wt==="on"||wt==="smart")};this._toDispose.add(this.editor.onDidChangeConfiguration(()=>yt())),yt()}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose()}_insertSuggestion(nt,ot){if(!nt||!nt.item){this._alternatives.value.reset(),this.model.cancel(),this.model.clear();return}if(!this.editor.hasModel())return;const rt=SnippetController2.get(this.editor);if(!rt)return;const ut=this.editor.getModel(),gt=ut.getAlternativeVersionId(),{item:pt}=nt,mt=[],vt=new CancellationTokenSource$1;ot&1||this.editor.pushUndoStop();const St=this.getOverwriteInfo(pt,!!(ot&8));if(this._memoryService.memorize(ut,this.editor.getPosition(),pt),Array.isArray(pt.completion.additionalTextEdits)){this.model.cancel();const wt=StableEditorScrollState.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",pt.completion.additionalTextEdits.map(Lt=>EditOperation.replaceMove(Range$2.lift(Lt.range),Lt.text))),wt.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!pt.isResolved){const wt=new StopWatch(!0);let Lt;const xt=ut.onDidChangeContent(Tt=>{if(Tt.isFlush){vt.cancel(),xt.dispose();return}for(const Rt of Tt.changes){const Nt=Range$2.getEndPosition(Rt.range);(!Lt||Position$1.isBefore(Nt,Lt))&&(Lt=Nt)}}),It=ot;ot|=2;let kt=!1;const At=this.editor.onWillType(()=>{At.dispose(),kt=!0,It&2||this.editor.pushUndoStop()});mt.push(pt.resolve(vt.token).then(()=>{if(!pt.completion.additionalTextEdits||vt.token.isCancellationRequested||Lt&&pt.completion.additionalTextEdits.some(Rt=>Position$1.isBefore(Lt,Range$2.getStartPosition(Rt.range))))return!1;kt&&this.editor.pushUndoStop();const Tt=StableEditorScrollState.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",pt.completion.additionalTextEdits.map(Rt=>EditOperation.replaceMove(Range$2.lift(Rt.range),Rt.text))),Tt.restoreRelativeVerticalPositionOfCursor(this.editor),(kt||!(It&2))&&this.editor.pushUndoStop(),!0}).then(Tt=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",wt.elapsed(),Tt),xt.dispose(),At.dispose()}))}let{insertText:yt}=pt.completion;pt.completion.insertTextRules&4||(yt=SnippetParser.escape(yt)),this.model.cancel(),rt.insert(yt,{overwriteBefore:St.overwriteBefore,overwriteAfter:St.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(pt.completion.insertTextRules&1),clipboardText:nt.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),ot&2||this.editor.pushUndoStop(),pt.completion.command&&(pt.completion.command.id===TriggerSuggestAction.id?this.model.trigger({auto:!0,retrigger:!0}):mt.push(this._commandService.executeCommand(pt.completion.command.id,...pt.completion.command.arguments?[...pt.completion.command.arguments]:[]).catch(onUnexpectedError))),ot&4&&this._alternatives.value.set(nt,wt=>{for(vt.cancel();ut.canUndo();){gt!==ut.getAlternativeVersionId()&&ut.undo(),this._insertSuggestion(wt,3|(ot&8?8:0));break}}),this._alertCompletionItem(pt),Promise.all(mt).finally(()=>{this._reportSuggestionAcceptedTelemetry(pt,ut,nt),this.model.clear(),vt.dispose()})}_reportSuggestionAcceptedTelemetry(nt,ot,rt){var ut;if(this._telemetryGate++%100!==0)return;const gt=nt.extensionId?nt.extensionId.value:((ut=rt.item.provider._debugDisplayName)!==null&&ut!==void 0?ut:"unknown").split("(",1)[0].toLowerCase();this._telemetryService.publicLog2("suggest.acceptedSuggestion",{providerId:gt,kind:nt.completion.kind,basenameHash:hash(basename(ot.uri)).toString(16),languageId:ot.getLanguageId(),fileExtension:extname(ot.uri)})}getOverwriteInfo(nt,ot){assertType(this.editor.hasModel());let rt=this.editor.getOption(113).insertMode==="replace";ot&&(rt=!rt);const ut=nt.position.column-nt.editStart.column,gt=(rt?nt.editReplaceEnd.column:nt.editInsertEnd.column)-nt.position.column,pt=this.editor.getPosition().column-nt.position.column,mt=this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0;return{overwriteBefore:ut+pt,overwriteAfter:gt+mt}}_alertCompletionItem(nt){if(isNonEmptyArray(nt.completion.additionalTextEdits)){const ot=localize("aria.alert.snippet","Accepting '{0}' made {1} additional edits",nt.textLabel,nt.completion.additionalTextEdits.length);alert(ot)}}triggerSuggest(nt,ot,rt){this.editor.hasModel()&&(this.model.trigger({auto:ot??!1,completionOptions:{providerFilter:nt,kindFilter:rt?new Set:void 0}}),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(nt){if(!this.editor.hasModel())return;const ot=this.editor.getPosition(),rt=()=>{ot.equals(this.editor.getPosition())&&this._commandService.executeCommand(nt.fallback)},ut=gt=>{if(gt.completion.insertTextRules&4||gt.completion.additionalTextEdits)return!0;const pt=this.editor.getPosition(),mt=gt.editStart.column,vt=pt.column;return vt-mt!==gt.completion.insertText.length?!0:this.editor.getModel().getValueInRange({startLineNumber:pt.lineNumber,startColumn:mt,endLineNumber:pt.lineNumber,endColumn:vt})!==gt.completion.insertText};Event.once(this.model.onDidTrigger)(gt=>{const pt=[];Event.any(this.model.onDidTrigger,this.model.onDidCancel)(()=>{dispose(pt),rt()},void 0,pt),this.model.onDidSuggest(({completionModel:mt})=>{if(dispose(pt),mt.items.length===0){rt();return}const vt=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),mt.items),St=mt.items[vt];if(!ut(St)){rt();return}this.editor.pushUndoStop(),this._insertSuggestion({index:vt,item:St,model:mt},7)},void 0,pt)}),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(ot,0),this.editor.focus()}acceptSelectedSuggestion(nt,ot){const rt=this.widget.value.getFocusedItem();let ut=0;nt&&(ut|=4),ot&&(ut|=8),this._insertSuggestion(rt,ut)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}focusSuggestion(){this.widget.value.focusSelected()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(nt){return this._selectors.register(nt)}};SuggestController.ID="editor.contrib.suggestController";SuggestController=__decorate$z([__param$z(1,ISuggestMemoryService),__param$z(2,ICommandService),__param$z(3,IContextKeyService),__param$z(4,IInstantiationService),__param$z(5,ILogService),__param$z(6,ITelemetryService)],SuggestController);class PriorityRegistry{constructor(nt){this.prioritySelector=nt,this._items=new Array}register(nt){if(this._items.indexOf(nt)!==-1)throw new Error("Value is already registered");return this._items.push(nt),this._items.sort((ot,rt)=>this.prioritySelector(rt)-this.prioritySelector(ot)),{dispose:()=>{const ot=this._items.indexOf(nt);ot>=0&&this._items.splice(ot,1)}}}get itemsOrderedByPriorityDesc(){return this._items}}class TriggerSuggestAction extends EditorAction{constructor(){super({id:TriggerSuggestAction.id,label:localize("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasCompletionItemProvider,Context$1.Visible.toNegated()),kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(nt,ot,rt){const ut=SuggestController.get(ot);if(!ut)return;let gt;rt&&typeof rt=="object"&&rt.auto===!0&&(gt=!0),ut.triggerSuggest(void 0,gt,void 0)}}TriggerSuggestAction.id="editor.action.triggerSuggest";registerEditorContribution(SuggestController.ID,SuggestController,2);registerEditorAction(TriggerSuggestAction);const weight$2=100+90,SuggestCommand=EditorCommand.bindToContribution(SuggestController.get);registerEditorCommand(new SuggestCommand({id:"acceptSelectedSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,Context$1.HasFocusedSuggestion),handler(ct){ct.acceptSelectedSuggestion(!0,!1)},kbOpts:[{primary:2,kbExpr:ContextKeyExpr.and(Context$1.Visible,EditorContextKeys.textInputFocus),weight:weight$2},{primary:3,kbExpr:ContextKeyExpr.and(Context$1.Visible,EditorContextKeys.textInputFocus,Context$1.AcceptSuggestionsOnEnter,Context$1.MakesTextEdit),weight:weight$2}],menuOpts:[{menuId:suggestWidgetStatusbarMenu,title:localize("accept.insert","Insert"),group:"left",order:1,when:Context$1.HasInsertAndReplaceRange.toNegated()},{menuId:suggestWidgetStatusbarMenu,title:localize("accept.insert","Insert"),group:"left",order:1,when:ContextKeyExpr.and(Context$1.HasInsertAndReplaceRange,Context$1.InsertMode.isEqualTo("insert"))},{menuId:suggestWidgetStatusbarMenu,title:localize("accept.replace","Replace"),group:"left",order:1,when:ContextKeyExpr.and(Context$1.HasInsertAndReplaceRange,Context$1.InsertMode.isEqualTo("replace"))}]}));registerEditorCommand(new SuggestCommand({id:"acceptAlternativeSelectedSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,EditorContextKeys.textInputFocus,Context$1.HasFocusedSuggestion),kbOpts:{weight:weight$2,kbExpr:EditorContextKeys.textInputFocus,primary:1027,secondary:[1026]},handler(ct){ct.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:suggestWidgetStatusbarMenu,group:"left",order:2,when:ContextKeyExpr.and(Context$1.HasInsertAndReplaceRange,Context$1.InsertMode.isEqualTo("insert")),title:localize("accept.replace","Replace")},{menuId:suggestWidgetStatusbarMenu,group:"left",order:2,when:ContextKeyExpr.and(Context$1.HasInsertAndReplaceRange,Context$1.InsertMode.isEqualTo("replace")),title:localize("accept.insert","Insert")}]}));CommandsRegistry.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion");registerEditorCommand(new SuggestCommand({id:"hideSuggestWidget",precondition:Context$1.Visible,handler:ct=>ct.cancelSuggestWidget(),kbOpts:{weight:weight$2,kbExpr:EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}}));registerEditorCommand(new SuggestCommand({id:"selectNextSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:ct=>ct.selectNextSuggestion(),kbOpts:{weight:weight$2,kbExpr:EditorContextKeys.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}}));registerEditorCommand(new SuggestCommand({id:"selectNextPageSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:ct=>ct.selectNextPageSuggestion(),kbOpts:{weight:weight$2,kbExpr:EditorContextKeys.textInputFocus,primary:12,secondary:[2060]}}));registerEditorCommand(new SuggestCommand({id:"selectLastSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:ct=>ct.selectLastSuggestion()}));registerEditorCommand(new SuggestCommand({id:"selectPrevSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:ct=>ct.selectPrevSuggestion(),kbOpts:{weight:weight$2,kbExpr:EditorContextKeys.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}}));registerEditorCommand(new SuggestCommand({id:"selectPrevPageSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:ct=>ct.selectPrevPageSuggestion(),kbOpts:{weight:weight$2,kbExpr:EditorContextKeys.textInputFocus,primary:11,secondary:[2059]}}));registerEditorCommand(new SuggestCommand({id:"selectFirstSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:ct=>ct.selectFirstSuggestion()}));registerEditorCommand(new SuggestCommand({id:"focusSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,Context$1.HasFocusedSuggestion.negate()),handler:ct=>ct.focusSuggestion(),kbOpts:{weight:weight$2,kbExpr:EditorContextKeys.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}}}));registerEditorCommand(new SuggestCommand({id:"focusAndAcceptSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,Context$1.HasFocusedSuggestion.negate()),handler:ct=>{ct.focusSuggestion(),ct.acceptSelectedSuggestion(!0,!1)}}));registerEditorCommand(new SuggestCommand({id:"toggleSuggestionDetails",precondition:ContextKeyExpr.and(Context$1.Visible,Context$1.HasFocusedSuggestion),handler:ct=>ct.toggleSuggestionDetails(),kbOpts:{weight:weight$2,kbExpr:EditorContextKeys.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:suggestWidgetStatusbarMenu,group:"right",order:1,when:ContextKeyExpr.and(Context$1.DetailsVisible,Context$1.CanResolve),title:localize("detail.more","show less")},{menuId:suggestWidgetStatusbarMenu,group:"right",order:1,when:ContextKeyExpr.and(Context$1.DetailsVisible.toNegated(),Context$1.CanResolve),title:localize("detail.less","show more")}]}));registerEditorCommand(new SuggestCommand({id:"toggleExplainMode",precondition:Context$1.Visible,handler:ct=>ct.toggleExplainMode(),kbOpts:{weight:100,primary:2138}}));registerEditorCommand(new SuggestCommand({id:"toggleSuggestionFocus",precondition:Context$1.Visible,handler:ct=>ct.toggleSuggestionFocus(),kbOpts:{weight:weight$2,kbExpr:EditorContextKeys.textInputFocus,primary:2570,mac:{primary:778}}}));registerEditorCommand(new SuggestCommand({id:"insertBestCompletion",precondition:ContextKeyExpr.and(EditorContextKeys.textInputFocus,ContextKeyExpr.equals("config.editor.tabCompletion","on"),WordContextKey.AtEnd,Context$1.Visible.toNegated(),SuggestAlternatives.OtherSuggestions.toNegated(),SnippetController2.InSnippetMode.toNegated()),handler:(ct,nt)=>{ct.triggerSuggestAndAcceptBest(isObject$1(nt)?Object.assign({fallback:"tab"},nt):{fallback:"tab"})},kbOpts:{weight:weight$2,primary:2}}));registerEditorCommand(new SuggestCommand({id:"insertNextSuggestion",precondition:ContextKeyExpr.and(EditorContextKeys.textInputFocus,ContextKeyExpr.equals("config.editor.tabCompletion","on"),SuggestAlternatives.OtherSuggestions,Context$1.Visible.toNegated(),SnippetController2.InSnippetMode.toNegated()),handler:ct=>ct.acceptNextSuggestion(),kbOpts:{weight:weight$2,kbExpr:EditorContextKeys.textInputFocus,primary:2}}));registerEditorCommand(new SuggestCommand({id:"insertPrevSuggestion",precondition:ContextKeyExpr.and(EditorContextKeys.textInputFocus,ContextKeyExpr.equals("config.editor.tabCompletion","on"),SuggestAlternatives.OtherSuggestions,Context$1.Visible.toNegated(),SnippetController2.InSnippetMode.toNegated()),handler:ct=>ct.acceptPrevSuggestion(),kbOpts:{weight:weight$2,kbExpr:EditorContextKeys.textInputFocus,primary:1026}}));registerEditorAction(class extends EditorAction{constructor(){super({id:"editor.action.resetSuggestSize",label:localize("suggest.reset.label","Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(ct,nt){var ot;(ot=SuggestController.get(nt))===null||ot===void 0||ot.resetWidgetSize()}});class SuggestWidgetAdaptor extends Disposable{get selectedItem(){return this._selectedItem}constructor(nt,ot,rt){super(),this.editor=nt,this.suggestControllerPreselector=ot,this.checkModelVersion=rt,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this._selectedItem=observableValue("suggestWidgetInlineCompletionProvider.selectedItem",void 0),this._register(nt.onKeyDown(gt=>{gt.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))})),this._register(nt.onKeyUp(gt=>{gt.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))}));const ut=SuggestController.get(this.editor);if(ut){this._register(ut.registerSelector({priority:100,select:(mt,vt,St)=>{var yt;transaction(At=>this.checkModelVersion(At));const wt=this.editor.getModel();if(!wt)return-1;const Lt=(yt=this.suggestControllerPreselector())===null||yt===void 0?void 0:yt.removeCommonPrefix(wt);if(!Lt)return-1;const xt=Position$1.lift(vt),It=St.map((At,Tt)=>{const Nt=SuggestItemInfo.fromSuggestion(ut,wt,xt,At,this.isShiftKeyPressed).toSingleTextEdit().removeCommonPrefix(wt),Pt=Lt.augments(Nt);return{index:Tt,valid:Pt,prefixLength:Nt.text.length,suggestItem:At}}).filter(At=>At&&At.valid&&At.prefixLength>0),kt=findMaxBy(It,compareBy(At=>At.prefixLength,numberComparator));return kt?kt.index:-1}}));let gt=!1;const pt=()=>{gt||(gt=!0,this._register(ut.widget.value.onDidShow(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})),this._register(ut.widget.value.onDidHide(()=>{this.isSuggestWidgetVisible=!1,this.update(!1)})),this._register(ut.widget.value.onDidFocus(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})))};this._register(Event.once(ut.model.onDidTrigger)(mt=>{pt()}))}this.update(this._isActive)}update(nt){const ot=this.getSuggestItemInfo();(this._isActive!==nt||!suggestItemInfoEquals(this._currentSuggestItemInfo,ot))&&(this._isActive=nt,this._currentSuggestItemInfo=ot,transaction(rt=>{this.checkModelVersion(rt),this._selectedItem.set(this._isActive?this._currentSuggestItemInfo:void 0,rt)}))}getSuggestItemInfo(){const nt=SuggestController.get(this.editor);if(!nt||!this.isSuggestWidgetVisible)return;const ot=nt.widget.value.getFocusedItem(),rt=this.editor.getPosition(),ut=this.editor.getModel();if(!(!ot||!rt||!ut))return SuggestItemInfo.fromSuggestion(nt,ut,rt,ot.item,this.isShiftKeyPressed)}stopForceRenderingAbove(){const nt=SuggestController.get(this.editor);nt==null||nt.stopForceRenderingAbove()}forceRenderingAbove(){const nt=SuggestController.get(this.editor);nt==null||nt.forceRenderingAbove()}}class SuggestItemInfo{static fromSuggestion(nt,ot,rt,ut,gt){let{insertText:pt}=ut.completion,mt=!1;if(ut.completion.insertTextRules&4){const St=new SnippetParser().parse(pt);St.children.length<100&&SnippetSession.adjustWhitespace(ot,rt,!0,St),pt=St.toString(),mt=!0}const vt=nt.getOverwriteInfo(ut,gt);return new SuggestItemInfo(Range$2.fromPositions(rt.delta(0,-vt.overwriteBefore),rt.delta(0,Math.max(vt.overwriteAfter,0))),pt,ut.completion.kind,mt)}constructor(nt,ot,rt,ut){this.range=nt,this.insertText=ot,this.completionItemKind=rt,this.isSnippetText=ut}equals(nt){return this.range.equalsRange(nt.range)&&this.insertText===nt.insertText&&this.completionItemKind===nt.completionItemKind&&this.isSnippetText===nt.isSnippetText}toSelectedSuggestionInfo(){return new SelectedSuggestionInfo(this.range,this.insertText,this.completionItemKind,this.isSnippetText)}toSingleTextEdit(){return new SingleTextEdit(this.range,this.insertText)}}function suggestItemInfoEquals(ct,nt){return ct===nt?!0:!ct||!nt?!1:ct.equals(nt)}var __decorate$y=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$y=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let InlineCompletionsController=class Rr extends Disposable{static get(nt){return nt.getContribution(Rr.ID)}constructor(nt,ot,rt,ut,gt,pt,mt,vt){super(),this.editor=nt,this.instantiationService=ot,this.contextKeyService=rt,this.configurationService=ut,this.commandService=gt,this.debounceService=pt,this.languageFeaturesService=mt,this.audioCueService=vt,this.suggestWidgetAdaptor=this._register(new SuggestWidgetAdaptor(this.editor,()=>{var wt,Lt;return(Lt=(wt=this.model.get())===null||wt===void 0?void 0:wt.selectedInlineCompletion.get())===null||Lt===void 0?void 0:Lt.toSingleTextEdit(void 0)},wt=>this.updateObservables(wt,VersionIdChangeReason.Other))),this.textModelVersionId=observableValue("textModelVersionId",-1),this.cursorPosition=observableValue("cursorPosition",new Position$1(1,1)),this.model=disposableObservableValue("inlineCompletionModel",void 0),this.ghostTextWidget=this._register(this.instantiationService.createInstance(GhostTextWidget,this.editor,{ghostText:this.model.map((wt,Lt)=>wt==null?void 0:wt.ghostText.read(Lt)),minReservedLineCount:constObservable(0),targetTextModel:this.model.map(wt=>wt==null?void 0:wt.textModel)})),this._debounceValue=this.debounceService.for(this.languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50}),this._register(new InlineCompletionContextKeys(this.contextKeyService,this.model));const St=observableFromEvent(nt.onDidChangeConfiguration,()=>nt.getOption(60).enabled);this._register(Event.runAndSubscribe(nt.onDidChangeModel,()=>{transaction(wt=>{this.model.set(void 0,wt),this.updateObservables(wt,VersionIdChangeReason.Other);const Lt=nt.getModel();if(Lt){const xt=ot.createInstance(InlineCompletionsModel,Lt,this.suggestWidgetAdaptor.selectedItem,this.cursorPosition,this.textModelVersionId,this._debounceValue,observableFromEvent(nt.onDidChangeConfiguration,()=>nt.getOption(113).preview),observableFromEvent(nt.onDidChangeConfiguration,()=>nt.getOption(113).previewMode),observableFromEvent(nt.onDidChangeConfiguration,()=>nt.getOption(60).mode),St);this.model.set(xt,wt)}})})),this._register(nt.onDidChangeModelContent(wt=>transaction(Lt=>{var xt;return this.updateObservables(Lt,wt.isUndoing?VersionIdChangeReason.Undo:wt.isRedoing?VersionIdChangeReason.Redo:!((xt=this.model.get())===null||xt===void 0)&&xt.isAcceptingPartially?VersionIdChangeReason.AcceptWord:VersionIdChangeReason.Other)}))),this._register(nt.onDidChangeCursorPosition(wt=>transaction(Lt=>{var xt;this.updateObservables(Lt,VersionIdChangeReason.Other),wt.reason===3&&((xt=this.model.get())===null||xt===void 0||xt.stop(Lt))}))),this._register(nt.onDidType(()=>transaction(wt=>{var Lt;this.updateObservables(wt,VersionIdChangeReason.Other),St.get()&&((Lt=this.model.get())===null||Lt===void 0||Lt.trigger(wt))}))),this._register(this.commandService.onDidExecuteCommand(wt=>{new Set([CoreEditingCommands.Tab.id,CoreEditingCommands.DeleteLeft.id,CoreEditingCommands.DeleteRight.id,inlineSuggestCommitId,"acceptSelectedSuggestion"]).has(wt.commandId)&&nt.hasTextFocus()&&St.get()&&transaction(xt=>{var It;(It=this.model.get())===null||It===void 0||It.trigger(xt)})})),this._register(this.editor.onDidBlurEditorWidget(()=>{this.configurationService.getValue("editor.inlineSuggest.keepOnBlur")||nt.getOption(60).keepOnBlur||InlineSuggestionHintsContentWidget.dropDownVisible||transaction(wt=>{var Lt;(Lt=this.model.get())===null||Lt===void 0||Lt.stop(wt)})})),this._register(autorun("forceRenderingAbove",wt=>{const Lt=this.model.read(wt),xt=Lt==null?void 0:Lt.ghostText.read(wt);this.suggestWidgetAdaptor.selectedItem.read(wt)?xt&&xt.lineCount>=2&&this.suggestWidgetAdaptor.forceRenderingAbove():this.suggestWidgetAdaptor.stopForceRenderingAbove()})),this._register(toDisposable(()=>{this.suggestWidgetAdaptor.stopForceRenderingAbove()}));let yt;this._register(autorun("play audio cue & read suggestion",wt=>{const Lt=this.model.read(wt),xt=Lt==null?void 0:Lt.selectedInlineCompletion.read(wt);if(!Lt||!xt){yt=void 0;return}const It=Lt==null?void 0:Lt.ghostText.get();if(!It){yt=void 0;return}const kt=Lt.textModel.getLineContent(It.lineNumber);if(xt.semanticId!==yt){if(yt=xt.semanticId,Lt.isNavigatingCurrentInlineCompletion)return;this.audioCueService.playAudioCue(AudioCue.inlineSuggestion).then(()=>{this.editor.getOption(6)&&alert(It.renderForScreenReader(kt))})}}))}updateObservables(nt,ot){var rt,ut;const gt=this.editor.getModel();this.textModelVersionId.set((rt=gt==null?void 0:gt.getVersionId())!==null&&rt!==void 0?rt:-1,nt,ot),this.cursorPosition.set((ut=this.editor.getPosition())!==null&&ut!==void 0?ut:new Position$1(1,1),nt)}shouldShowHoverAt(nt){var ot;const rt=(ot=this.model.get())===null||ot===void 0?void 0:ot.ghostText.get();return rt?rt.parts.some(ut=>nt.containsPosition(new Position$1(rt.lineNumber,ut.column))):!1}shouldShowHoverAtViewZone(nt){return this.ghostTextWidget.ownsViewZone(nt)}};InlineCompletionsController.ID="editor.contrib.inlineCompletionsController";InlineCompletionsController=__decorate$y([__param$y(1,IInstantiationService),__param$y(2,IContextKeyService),__param$y(3,IConfigurationService),__param$y(4,ICommandService),__param$y(5,ILanguageFeatureDebounceService),__param$y(6,ILanguageFeaturesService),__param$y(7,IAudioCueService)],InlineCompletionsController);var __awaiter$n=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class ShowNextInlineSuggestionAction extends EditorAction{constructor(){super({id:ShowNextInlineSuggestionAction.ID,label:localize("action.inlineSuggest.showNext","Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:ContextKeyExpr.and(EditorContextKeys.writable,InlineCompletionContextKeys.inlineSuggestionVisible),kbOpts:{weight:100,primary:606}})}run(nt,ot){var rt;return __awaiter$n(this,void 0,void 0,function*(){const ut=InlineCompletionsController.get(ot);(rt=ut==null?void 0:ut.model.get())===null||rt===void 0||rt.next()})}}ShowNextInlineSuggestionAction.ID=showNextInlineSuggestionActionId;class ShowPreviousInlineSuggestionAction extends EditorAction{constructor(){super({id:ShowPreviousInlineSuggestionAction.ID,label:localize("action.inlineSuggest.showPrevious","Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:ContextKeyExpr.and(EditorContextKeys.writable,InlineCompletionContextKeys.inlineSuggestionVisible),kbOpts:{weight:100,primary:604}})}run(nt,ot){var rt;return __awaiter$n(this,void 0,void 0,function*(){const ut=InlineCompletionsController.get(ot);(rt=ut==null?void 0:ut.model.get())===null||rt===void 0||rt.previous()})}}ShowPreviousInlineSuggestionAction.ID=showPreviousInlineSuggestionActionId;class TriggerInlineSuggestionAction extends EditorAction{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:localize("action.inlineSuggest.trigger","Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:EditorContextKeys.writable})}run(nt,ot){var rt;return __awaiter$n(this,void 0,void 0,function*(){const ut=InlineCompletionsController.get(ot);(rt=ut==null?void 0:ut.model.get())===null||rt===void 0||rt.triggerExplicitly()})}}class AcceptNextWordOfInlineCompletion extends EditorAction{constructor(){super({id:"editor.action.inlineSuggest.acceptNextWord",label:localize("action.inlineSuggest.acceptNextWord","Accept Next Word Of Inline Suggestion"),alias:"Accept Next Word Of Inline Suggestion",precondition:ContextKeyExpr.and(EditorContextKeys.writable,InlineCompletionContextKeys.inlineSuggestionVisible),kbOpts:{weight:100+1,primary:2065},menuOpts:[{menuId:MenuId.InlineSuggestionToolbar,title:localize("acceptWord","Accept Word"),group:"primary",order:2}]})}run(nt,ot){var rt;return __awaiter$n(this,void 0,void 0,function*(){const ut=InlineCompletionsController.get(ot);(rt=ut==null?void 0:ut.model.get())===null||rt===void 0||rt.acceptNextWord(ut.editor)})}}class AcceptNextLineOfInlineCompletion extends EditorAction{constructor(){super({id:"editor.action.inlineSuggest.acceptNextLine",label:localize("action.inlineSuggest.acceptNextLine","Accept Next Line Of Inline Suggestion"),alias:"Accept Next Line Of Inline Suggestion",precondition:ContextKeyExpr.and(EditorContextKeys.writable,InlineCompletionContextKeys.inlineSuggestionVisible),kbOpts:{weight:100+1},menuOpts:[{menuId:MenuId.InlineSuggestionToolbar,title:localize("acceptLine","Accept Line"),group:"secondary",order:2}]})}run(nt,ot){var rt;return __awaiter$n(this,void 0,void 0,function*(){const ut=InlineCompletionsController.get(ot);(rt=ut==null?void 0:ut.model.get())===null||rt===void 0||rt.acceptNextLine(ut.editor)})}}class AcceptInlineCompletion extends EditorAction{constructor(){super({id:inlineSuggestCommitId,label:localize("action.inlineSuggest.accept","Accept Inline Suggestion"),alias:"Accept Inline Suggestion",precondition:InlineCompletionContextKeys.inlineSuggestionVisible,menuOpts:[{menuId:MenuId.InlineSuggestionToolbar,title:localize("accept","Accept"),group:"primary",order:1}],kbOpts:{primary:2,weight:200,kbExpr:ContextKeyExpr.and(InlineCompletionContextKeys.inlineSuggestionVisible,EditorContextKeys.tabMovesFocus.toNegated(),InlineCompletionContextKeys.inlineSuggestionHasIndentationLessThanTabSize)}})}run(nt,ot){var rt;return __awaiter$n(this,void 0,void 0,function*(){const ut=InlineCompletionsController.get(ot);ut&&((rt=ut.model.get())===null||rt===void 0||rt.accept(ut.editor),ut.editor.focus())})}}class HideInlineCompletion extends EditorAction{constructor(){super({id:HideInlineCompletion.ID,label:localize("action.inlineSuggest.hide","Hide Inline Suggestion"),alias:"Hide Inline Suggestion",precondition:InlineCompletionContextKeys.inlineSuggestionVisible,kbOpts:{weight:100,primary:9}})}run(nt,ot){return __awaiter$n(this,void 0,void 0,function*(){const rt=InlineCompletionsController.get(ot);transaction(ut=>{var gt;(gt=rt==null?void 0:rt.model.get())===null||gt===void 0||gt.stop(ut)})})}}HideInlineCompletion.ID="editor.action.inlineSuggest.hide";class ToggleAlwaysShowInlineSuggestionToolbar extends Action2{constructor(){super({id:ToggleAlwaysShowInlineSuggestionToolbar.ID,title:localize("action.inlineSuggest.alwaysShowToolbar","Always Show Toolbar"),f1:!1,precondition:void 0,menu:[{id:MenuId.InlineSuggestionToolbar,group:"secondary",order:10}],toggled:InlineCompletionContextKeys.alwaysShowInlineSuggestionToolbar})}run(nt,ot){return __awaiter$n(this,void 0,void 0,function*(){const rt=nt.get(IConfigurationService),gt=rt.getValue("editor.inlineSuggest.showToolbar")==="always"?"onHover":"always";rt.updateValue("editor.inlineSuggest.showToolbar",gt)})}}ToggleAlwaysShowInlineSuggestionToolbar.ID="editor.action.inlineSuggest.toggleAlwaysShowToolbar";var __decorate$x=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$x=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};class InlineCompletionsHover{constructor(nt,ot,rt){this.owner=nt,this.range=ot,this.controller=rt}isValidForHoverAnchor(nt){return nt.type===1&&this.range.startColumn<=nt.range.startColumn&&this.range.endColumn>=nt.range.endColumn}}let InlineCompletionsHoverParticipant=class{constructor(nt,ot,rt,ut,gt,pt){this._editor=nt,this._languageService=ot,this._openerService=rt,this.accessibilityService=ut,this._instantiationService=gt,this._telemetryService=pt,this.hoverOrdinal=4}suggestHoverAnchor(nt){const ot=InlineCompletionsController.get(this._editor);if(!ot)return null;const rt=nt.target;if(rt.type===8){const ut=rt.detail;if(ot.shouldShowHoverAtViewZone(ut.viewZoneId))return new HoverForeignElementAnchor(1e3,this,Range$2.fromPositions(this._editor.getModel().validatePosition(ut.positionBefore||ut.position)),nt.event.posx,nt.event.posy,!1)}return rt.type===7&&ot.shouldShowHoverAt(rt.range)?new HoverForeignElementAnchor(1e3,this,rt.range,nt.event.posx,nt.event.posy,!1):rt.type===6&&rt.detail.mightBeForeignElement&&ot.shouldShowHoverAt(rt.range)?new HoverForeignElementAnchor(1e3,this,rt.range,nt.event.posx,nt.event.posy,!1):null}computeSync(nt,ot){if(this._editor.getOption(60).showToolbar==="always")return[];const rt=InlineCompletionsController.get(this._editor);return rt&&rt.shouldShowHoverAt(nt.range)?[new InlineCompletionsHover(this,nt.range,rt)]:[]}renderHoverParts(nt,ot){const rt=new DisposableStore,ut=ot[0];this._telemetryService.publicLog2("inlineCompletionHover.shown"),this.accessibilityService.isScreenReaderOptimized()&&this.renderScreenReaderText(nt,ut,rt);const gt=ut.controller.model.get(),pt=this._instantiationService.createInstance(InlineSuggestionHintsContentWidget,this._editor,!1,constObservable(null),gt.selectedInlineCompletionIndex,gt.inlineCompletionsCount,gt.selectedInlineCompletion.map(mt=>{var vt;return(vt=mt==null?void 0:mt.inlineCompletion.source.inlineCompletions.commands)!==null&&vt!==void 0?vt:[]}));return nt.fragment.appendChild(pt.getDomNode()),gt.triggerExplicitly(),rt.add(pt),rt}renderScreenReaderText(nt,ot,rt){const ut=$$d,gt=ut("div.hover-row.markdown-hover"),pt=append$1(gt,ut("div.hover-contents",{["aria-live"]:"assertive"})),mt=rt.add(new MarkdownRenderer({editor:this._editor},this._languageService,this._openerService)),vt=St=>{rt.add(mt.onDidRenderAsync(()=>{pt.className="hover-contents code-hover-contents",nt.onContentsChanged()}));const yt=localize("inlineSuggestionFollows","Suggestion:"),wt=rt.add(mt.render(new MarkdownString().appendText(yt).appendCodeblock("text",St)));pt.replaceChildren(wt.element)};rt.add(autorun("update hover",St=>{var yt;const wt=(yt=ot.controller.model.read(St))===null||yt===void 0?void 0:yt.ghostText.read(St);if(wt){const Lt=this._editor.getModel().getLineContent(wt.lineNumber);vt(wt.renderForScreenReader(Lt))}else reset(pt)})),nt.fragment.appendChild(gt)}};InlineCompletionsHoverParticipant=__decorate$x([__param$x(1,ILanguageService),__param$x(2,IOpenerService),__param$x(3,IAccessibilityService),__param$x(4,IInstantiationService),__param$x(5,ITelemetryService)],InlineCompletionsHoverParticipant);registerEditorContribution(InlineCompletionsController.ID,InlineCompletionsController,3);registerEditorAction(TriggerInlineSuggestionAction);registerEditorAction(ShowNextInlineSuggestionAction);registerEditorAction(ShowPreviousInlineSuggestionAction);registerEditorAction(AcceptNextWordOfInlineCompletion);registerEditorAction(AcceptNextLineOfInlineCompletion);registerEditorAction(AcceptInlineCompletion);registerEditorAction(HideInlineCompletion);registerAction2(ToggleAlwaysShowInlineSuggestionToolbar);HoverParticipantRegistry.register(InlineCompletionsHoverParticipant);function getSpaceCnt(ct,nt){let ot=0;for(let rt=0;rt<ct.length;rt++)ct.charAt(rt)==="	"?ot+=nt:ot++;return ot}function generateIndent(ct,nt,ot){ct=ct<0?0:ct;let rt="";if(!ot){const ut=Math.floor(ct/nt);ct=ct%nt;for(let gt=0;gt<ut;gt++)rt+="	"}for(let ut=0;ut<ct;ut++)rt+=" ";return rt}var __decorate$w=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$w=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};function getReindentEditOperations(ct,nt,ot,rt,ut){if(ct.getLineCount()===1&&ct.getLineMaxColumn(1)===1)return[];const gt=nt.getLanguageConfiguration(ct.getLanguageId()).indentationRules;if(!gt)return[];for(rt=Math.min(rt,ct.getLineCount());ot<=rt&&gt.unIndentedLinePattern;){const At=ct.getLineContent(ot);if(!gt.unIndentedLinePattern.test(At))break;ot++}if(ot>rt-1)return[];const{tabSize:pt,indentSize:mt,insertSpaces:vt}=ct.getOptions(),St=(At,Tt)=>(Tt=Tt||1,ShiftCommand.shiftIndent(At,At.length+Tt,pt,mt,vt)),yt=(At,Tt)=>(Tt=Tt||1,ShiftCommand.unshiftIndent(At,At.length+Tt,pt,mt,vt)),wt=[];let Lt;const xt=ct.getLineContent(ot);let It=xt;if(ut!=null){Lt=ut;const At=getLeadingWhitespace(xt);It=Lt+xt.substring(At.length),gt.decreaseIndentPattern&&gt.decreaseIndentPattern.test(It)&&(Lt=yt(Lt),It=Lt+xt.substring(At.length)),xt!==It&&wt.push(EditOperation.replaceMove(new Selection$1(ot,1,ot,At.length+1),normalizeIndentation(Lt,mt,vt)))}else Lt=getLeadingWhitespace(xt);let kt=Lt;gt.increaseIndentPattern&&gt.increaseIndentPattern.test(It)?(kt=St(kt),Lt=St(Lt)):gt.indentNextLinePattern&&gt.indentNextLinePattern.test(It)&&(kt=St(kt)),ot++;for(let At=ot;At<=rt;At++){const Tt=ct.getLineContent(At),Rt=getLeadingWhitespace(Tt),Nt=kt+Tt.substring(Rt.length);gt.decreaseIndentPattern&&gt.decreaseIndentPattern.test(Nt)&&(kt=yt(kt),Lt=yt(Lt)),Rt!==kt&&wt.push(EditOperation.replaceMove(new Selection$1(At,1,At,Rt.length+1),normalizeIndentation(kt,mt,vt))),!(gt.unIndentedLinePattern&&gt.unIndentedLinePattern.test(Tt))&&(gt.increaseIndentPattern&&gt.increaseIndentPattern.test(Nt)?(Lt=St(Lt),kt=Lt):gt.indentNextLinePattern&&gt.indentNextLinePattern.test(Nt)?kt=St(kt):kt=Lt)}return wt}class IndentationToSpacesAction extends EditorAction{constructor(){super({id:IndentationToSpacesAction.ID,label:localize("indentationToSpaces","Convert Indentation to Spaces"),alias:"Convert Indentation to Spaces",precondition:EditorContextKeys.writable})}run(nt,ot){const rt=ot.getModel();if(!rt)return;const ut=rt.getOptions(),gt=ot.getSelection();if(!gt)return;const pt=new IndentationToSpacesCommand(gt,ut.tabSize);ot.pushUndoStop(),ot.executeCommands(this.id,[pt]),ot.pushUndoStop(),rt.updateOptions({insertSpaces:!0})}}IndentationToSpacesAction.ID="editor.action.indentationToSpaces";class IndentationToTabsAction extends EditorAction{constructor(){super({id:IndentationToTabsAction.ID,label:localize("indentationToTabs","Convert Indentation to Tabs"),alias:"Convert Indentation to Tabs",precondition:EditorContextKeys.writable})}run(nt,ot){const rt=ot.getModel();if(!rt)return;const ut=rt.getOptions(),gt=ot.getSelection();if(!gt)return;const pt=new IndentationToTabsCommand(gt,ut.tabSize);ot.pushUndoStop(),ot.executeCommands(this.id,[pt]),ot.pushUndoStop(),rt.updateOptions({insertSpaces:!1})}}IndentationToTabsAction.ID="editor.action.indentationToTabs";class ChangeIndentationSizeAction extends EditorAction{constructor(nt,ot,rt){super(rt),this.insertSpaces=nt,this.displaySizeOnly=ot}run(nt,ot){const rt=nt.get(IQuickInputService),ut=nt.get(IModelService),gt=ot.getModel();if(!gt)return;const pt=ut.getCreationOptions(gt.getLanguageId(),gt.uri,gt.isForSimpleWidget),mt=gt.getOptions(),vt=[1,2,3,4,5,6,7,8].map(yt=>({id:yt.toString(),label:yt.toString(),description:yt===pt.tabSize&&yt===mt.tabSize?localize("configuredTabSize","Configured Tab Size"):yt===pt.tabSize?localize("defaultTabSize","Default Tab Size"):yt===mt.tabSize?localize("currentTabSize","Current Tab Size"):void 0})),St=Math.min(gt.getOptions().tabSize-1,7);setTimeout(()=>{rt.pick(vt,{placeHolder:localize({key:"selectTabWidth",comment:["Tab corresponds to the tab key"]},"Select Tab Size for Current File"),activeItem:vt[St]}).then(yt=>{if(yt&&gt&&!gt.isDisposed()){const wt=parseInt(yt.label,10);this.displaySizeOnly?gt.updateOptions({tabSize:wt}):gt.updateOptions({tabSize:wt,indentSize:wt,insertSpaces:this.insertSpaces})}})},50)}}class IndentUsingTabs extends ChangeIndentationSizeAction{constructor(){super(!1,!1,{id:IndentUsingTabs.ID,label:localize("indentUsingTabs","Indent Using Tabs"),alias:"Indent Using Tabs",precondition:void 0})}}IndentUsingTabs.ID="editor.action.indentUsingTabs";class IndentUsingSpaces extends ChangeIndentationSizeAction{constructor(){super(!0,!1,{id:IndentUsingSpaces.ID,label:localize("indentUsingSpaces","Indent Using Spaces"),alias:"Indent Using Spaces",precondition:void 0})}}IndentUsingSpaces.ID="editor.action.indentUsingSpaces";class ChangeTabDisplaySize extends ChangeIndentationSizeAction{constructor(){super(!0,!0,{id:ChangeTabDisplaySize.ID,label:localize("changeTabDisplaySize","Change Tab Display Size"),alias:"Change Tab Display Size",precondition:void 0})}}ChangeTabDisplaySize.ID="editor.action.changeTabDisplaySize";class DetectIndentation extends EditorAction{constructor(){super({id:DetectIndentation.ID,label:localize("detectIndentation","Detect Indentation from Content"),alias:"Detect Indentation from Content",precondition:void 0})}run(nt,ot){const rt=nt.get(IModelService),ut=ot.getModel();if(!ut)return;const gt=rt.getCreationOptions(ut.getLanguageId(),ut.uri,ut.isForSimpleWidget);ut.detectIndentation(gt.insertSpaces,gt.tabSize)}}DetectIndentation.ID="editor.action.detectIndentation";class ReindentLinesAction extends EditorAction{constructor(){super({id:"editor.action.reindentlines",label:localize("editor.reindentlines","Reindent Lines"),alias:"Reindent Lines",precondition:EditorContextKeys.writable})}run(nt,ot){const rt=nt.get(ILanguageConfigurationService),ut=ot.getModel();if(!ut)return;const gt=getReindentEditOperations(ut,rt,1,ut.getLineCount());gt.length>0&&(ot.pushUndoStop(),ot.executeEdits(this.id,gt),ot.pushUndoStop())}}class ReindentSelectedLinesAction extends EditorAction{constructor(){super({id:"editor.action.reindentselectedlines",label:localize("editor.reindentselectedlines","Reindent Selected Lines"),alias:"Reindent Selected Lines",precondition:EditorContextKeys.writable})}run(nt,ot){const rt=nt.get(ILanguageConfigurationService),ut=ot.getModel();if(!ut)return;const gt=ot.getSelections();if(gt===null)return;const pt=[];for(const mt of gt){let vt=mt.startLineNumber,St=mt.endLineNumber;if(vt!==St&&mt.endColumn===1&&St--,vt===1){if(vt===St)continue}else vt--;const yt=getReindentEditOperations(ut,rt,vt,St);pt.push(...yt)}pt.length>0&&(ot.pushUndoStop(),ot.executeEdits(this.id,pt),ot.pushUndoStop())}}class AutoIndentOnPasteCommand{constructor(nt,ot){this._initialSelection=ot,this._edits=[],this._selectionId=null;for(const rt of nt)rt.range&&typeof rt.text=="string"&&this._edits.push(rt)}getEditOperations(nt,ot){for(const ut of this._edits)ot.addEditOperation(Range$2.lift(ut.range),ut.text);let rt=!1;Array.isArray(this._edits)&&this._edits.length===1&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(rt=!0,this._selectionId=ot.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(rt=!0,this._selectionId=ot.trackSelection(this._initialSelection,!1))),rt||(this._selectionId=ot.trackSelection(this._initialSelection))}computeCursorState(nt,ot){return ot.getTrackedSelection(this._selectionId)}}let AutoIndentOnPaste=class{constructor(nt,ot){this.editor=nt,this._languageConfigurationService=ot,this.callOnDispose=new DisposableStore,this.callOnModel=new DisposableStore,this.callOnDispose.add(nt.onDidChangeConfiguration(()=>this.update())),this.callOnDispose.add(nt.onDidChangeModel(()=>this.update())),this.callOnDispose.add(nt.onDidChangeModelLanguage(()=>this.update()))}update(){this.callOnModel.clear(),!(this.editor.getOption(10)<4||this.editor.getOption(53))&&this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste(({range:nt})=>{this.trigger(nt)}))}trigger(nt){const ot=this.editor.getSelections();if(ot===null||ot.length>1)return;const rt=this.editor.getModel();if(!rt||!rt.tokenization.isCheapToTokenize(nt.getStartPosition().lineNumber))return;const ut=this.editor.getOption(10),{tabSize:gt,indentSize:pt,insertSpaces:mt}=rt.getOptions(),vt=[],St={shiftIndent:xt=>ShiftCommand.shiftIndent(xt,xt.length+1,gt,pt,mt),unshiftIndent:xt=>ShiftCommand.unshiftIndent(xt,xt.length+1,gt,pt,mt)};let yt=nt.startLineNumber;for(;yt<=nt.endLineNumber;){if(this.shouldIgnoreLine(rt,yt)){yt++;continue}break}if(yt>nt.endLineNumber)return;let wt=rt.getLineContent(yt);if(!/\S/.test(wt.substring(0,nt.startColumn-1))){const xt=getGoodIndentForLine(ut,rt,rt.getLanguageId(),yt,St,this._languageConfigurationService);if(xt!==null){const It=getLeadingWhitespace(wt),kt=getSpaceCnt(xt,gt),At=getSpaceCnt(It,gt);if(kt!==At){const Tt=generateIndent(kt,gt,mt);vt.push({range:new Range$2(yt,1,yt,It.length+1),text:Tt}),wt=Tt+wt.substr(It.length)}else{const Tt=getIndentMetadata(rt,yt,this._languageConfigurationService);if(Tt===0||Tt===8)return}}}const Lt=yt;for(;yt<nt.endLineNumber;){if(!/\S/.test(rt.getLineContent(yt+1))){yt++;continue}break}if(yt!==nt.endLineNumber){const It=getGoodIndentForLine(ut,{tokenization:{getLineTokens:kt=>rt.tokenization.getLineTokens(kt),getLanguageId:()=>rt.getLanguageId(),getLanguageIdAtPosition:(kt,At)=>rt.getLanguageIdAtPosition(kt,At)},getLineContent:kt=>kt===Lt?wt:rt.getLineContent(kt)},rt.getLanguageId(),yt+1,St,this._languageConfigurationService);if(It!==null){const kt=getSpaceCnt(It,gt),At=getSpaceCnt(getLeadingWhitespace(rt.getLineContent(yt+1)),gt);if(kt!==At){const Tt=kt-At;for(let Rt=yt+1;Rt<=nt.endLineNumber;Rt++){const Nt=rt.getLineContent(Rt),Pt=getLeadingWhitespace(Nt),Kt=getSpaceCnt(Pt,gt)+Tt,Bt=generateIndent(Kt,gt,mt);Bt!==Pt&&vt.push({range:new Range$2(Rt,1,Rt,Pt.length+1),text:Bt})}}}}if(vt.length>0){this.editor.pushUndoStop();const xt=new AutoIndentOnPasteCommand(vt,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",xt),this.editor.pushUndoStop()}}shouldIgnoreLine(nt,ot){nt.tokenization.forceTokenization(ot);const rt=nt.getLineFirstNonWhitespaceColumn(ot);if(rt===0)return!0;const ut=nt.tokenization.getLineTokens(ot);if(ut.getCount()>0){const gt=ut.findTokenIndexAtOffset(rt);if(gt>=0&&ut.getStandardTokenType(gt)===1)return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}};AutoIndentOnPaste.ID="editor.contrib.autoIndentOnPaste";AutoIndentOnPaste=__decorate$w([__param$w(1,ILanguageConfigurationService)],AutoIndentOnPaste);function getIndentationEditOperations(ct,nt,ot,rt){if(ct.getLineCount()===1&&ct.getLineMaxColumn(1)===1)return;let ut="";for(let pt=0;pt<ot;pt++)ut+=" ";const gt=new RegExp(ut,"gi");for(let pt=1,mt=ct.getLineCount();pt<=mt;pt++){let vt=ct.getLineFirstNonWhitespaceColumn(pt);if(vt===0&&(vt=ct.getLineMaxColumn(pt)),vt===1)continue;const St=new Range$2(pt,1,pt,vt),yt=ct.getValueInRange(St),wt=rt?yt.replace(/\t/ig,ut):yt.replace(gt,"	");nt.addEditOperation(St,wt)}}class IndentationToSpacesCommand{constructor(nt,ot){this.selection=nt,this.tabSize=ot,this.selectionId=null}getEditOperations(nt,ot){this.selectionId=ot.trackSelection(this.selection),getIndentationEditOperations(nt,ot,this.tabSize,!0)}computeCursorState(nt,ot){return ot.getTrackedSelection(this.selectionId)}}class IndentationToTabsCommand{constructor(nt,ot){this.selection=nt,this.tabSize=ot,this.selectionId=null}getEditOperations(nt,ot){this.selectionId=ot.trackSelection(this.selection),getIndentationEditOperations(nt,ot,this.tabSize,!1)}computeCursorState(nt,ot){return ot.getTrackedSelection(this.selectionId)}}registerEditorContribution(AutoIndentOnPaste.ID,AutoIndentOnPaste,2);registerEditorAction(IndentationToSpacesAction);registerEditorAction(IndentationToTabsAction);registerEditorAction(IndentUsingTabs);registerEditorAction(IndentUsingSpaces);registerEditorAction(ChangeTabDisplaySize);registerEditorAction(DetectIndentation);registerEditorAction(ReindentLinesAction);registerEditorAction(ReindentSelectedLinesAction);var __awaiter$m=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class InlayHintAnchor{constructor(nt,ot){this.range=nt,this.direction=ot}}class InlayHintItem{constructor(nt,ot,rt){this.hint=nt,this.anchor=ot,this.provider=rt,this._isResolved=!1}with(nt){const ot=new InlayHintItem(this.hint,nt.anchor,this.provider);return ot._isResolved=this._isResolved,ot._currentResolve=this._currentResolve,ot}resolve(nt){return __awaiter$m(this,void 0,void 0,function*(){if(typeof this.provider.resolveInlayHint=="function"){if(this._currentResolve)return yield this._currentResolve,nt.isCancellationRequested?void 0:this.resolve(nt);this._isResolved||(this._currentResolve=this._doResolve(nt).finally(()=>this._currentResolve=void 0)),yield this._currentResolve}})}_doResolve(nt){var ot,rt;return __awaiter$m(this,void 0,void 0,function*(){try{const ut=yield Promise.resolve(this.provider.resolveInlayHint(this.hint,nt));this.hint.tooltip=(ot=ut==null?void 0:ut.tooltip)!==null&&ot!==void 0?ot:this.hint.tooltip,this.hint.label=(rt=ut==null?void 0:ut.label)!==null&&rt!==void 0?rt:this.hint.label,this._isResolved=!0}catch(ut){onUnexpectedExternalError(ut),this._isResolved=!1}})}}class InlayHintsFragments{static create(nt,ot,rt,ut){return __awaiter$m(this,void 0,void 0,function*(){const gt=[],pt=nt.ordered(ot).reverse().map(mt=>rt.map(vt=>__awaiter$m(this,void 0,void 0,function*(){try{const St=yield mt.provideInlayHints(ot,vt,ut);St!=null&&St.hints.length&&gt.push([St,mt])}catch(St){onUnexpectedExternalError(St)}})));if(yield Promise.all(pt.flat()),ut.isCancellationRequested||ot.isDisposed())throw new CancellationError;return new InlayHintsFragments(rt,gt,ot)})}constructor(nt,ot,rt){this._disposables=new DisposableStore,this.ranges=nt,this.provider=new Set;const ut=[];for(const[gt,pt]of ot){this._disposables.add(gt),this.provider.add(pt);for(const mt of gt.hints){const vt=rt.validatePosition(mt.position);let St="before";const yt=InlayHintsFragments._getRangeAtPosition(rt,vt);let wt;yt.getStartPosition().isBefore(vt)?(wt=Range$2.fromPositions(yt.getStartPosition(),vt),St="after"):(wt=Range$2.fromPositions(vt,yt.getEndPosition()),St="before"),ut.push(new InlayHintItem(mt,new InlayHintAnchor(wt,St),pt))}}this.items=ut.sort((gt,pt)=>Position$1.compare(gt.hint.position,pt.hint.position))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(nt,ot){const rt=ot.lineNumber,ut=nt.getWordAtPosition(ot);if(ut)return new Range$2(rt,ut.startColumn,rt,ut.endColumn);nt.tokenization.tokenizeIfCheap(rt);const gt=nt.tokenization.getLineTokens(rt),pt=ot.column-1,mt=gt.findTokenIndexAtOffset(pt);let vt=gt.getStartOffset(mt),St=gt.getEndOffset(mt);return St-vt===1&&(vt===pt&&mt>1?(vt=gt.getStartOffset(mt-1),St=gt.getEndOffset(mt-1)):St===pt&&mt<gt.getCount()-1&&(vt=gt.getStartOffset(mt+1),St=gt.getEndOffset(mt+1))),new Range$2(rt,vt+1,rt,St+1)}}function asCommandLink(ct){return URI.from({scheme:Schemas.command,path:ct.id,query:ct.arguments&&encodeURIComponent(JSON.stringify(ct.arguments))}).toString()}var __awaiter$l=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function showGoToContextMenu(ct,nt,ot,rt){var ut;return __awaiter$l(this,void 0,void 0,function*(){const gt=ct.get(ITextModelService),pt=ct.get(IContextMenuService),mt=ct.get(ICommandService),vt=ct.get(IInstantiationService),St=ct.get(INotificationService);if(yield rt.item.resolve(CancellationToken.None),!rt.part.location)return;const yt=rt.part.location,wt=[],Lt=new Set(MenuRegistry.getMenuItems(MenuId.EditorContext).map(It=>isIMenuItem(It)?It.command.id:generateUuid()));for(const It of SymbolNavigationAction.all())Lt.has(It.desc.id)&&wt.push(new Action(It.desc.id,MenuItemAction.label(It.desc,{renderShortTitle:!0}),void 0,!0,()=>__awaiter$l(this,void 0,void 0,function*(){const kt=yield gt.createModelReference(yt.uri);try{const At=new SymbolNavigationAnchor(kt.object.textEditorModel,Range$2.getStartPosition(yt.range)),Tt=rt.item.anchor.range;yield vt.invokeFunction(It.runEditorCommand.bind(It),nt,At,Tt)}finally{kt.dispose()}})));if(rt.part.command){const{command:It}=rt.part;wt.push(new Separator),wt.push(new Action(It.id,It.title,void 0,!0,()=>__awaiter$l(this,void 0,void 0,function*(){var kt;try{yield mt.executeCommand(It.id,...(kt=It.arguments)!==null&&kt!==void 0?kt:[])}catch(At){St.notify({severity:Severity.Error,source:rt.item.provider.displayName,message:At})}})))}const xt=nt.getOption(122);pt.showContextMenu({domForShadowRoot:xt&&(ut=nt.getDomNode())!==null&&ut!==void 0?ut:void 0,getAnchor:()=>{const It=getDomNodePagePosition(ot);return{x:It.left,y:It.top+It.height+8}},getActions:()=>wt,onHide:()=>{nt.focus()},autoSelectFirstItem:!0})})}function goToDefinitionWithLocation(ct,nt,ot,rt){return __awaiter$l(this,void 0,void 0,function*(){const gt=yield ct.get(ITextModelService).createModelReference(rt.uri);yield ot.invokeWithinContext(pt=>__awaiter$l(this,void 0,void 0,function*(){const mt=nt.hasSideBySideModifier,vt=pt.get(IContextKeyService),St=PeekContext.inPeekEditor.getValue(vt),yt=!mt&&ot.getOption(84)&&!St;return new DefinitionAction({openToSide:mt,openInPeek:yt,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(pt,new SymbolNavigationAnchor(gt.object.textEditorModel,Range$2.getStartPosition(rt.range)),Range$2.lift(rt.range))})),gt.dispose()})}var __decorate$v=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$v=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$k=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class InlayHintsCache{constructor(){this._entries=new LRUCache(50)}get(nt){const ot=InlayHintsCache._key(nt);return this._entries.get(ot)}set(nt,ot){const rt=InlayHintsCache._key(nt);this._entries.set(rt,ot)}static _key(nt){return`${nt.uri.toString()}/${nt.getVersionId()}`}}const IInlayHintsCache=createDecorator("IInlayHintsCache");registerSingleton(IInlayHintsCache,InlayHintsCache,1);class RenderedInlayHintLabelPart{constructor(nt,ot){this.item=nt,this.index=ot}get part(){const nt=this.item.hint.label;return typeof nt=="string"?{label:nt}:nt[this.index]}}class ActiveInlayHintInfo{constructor(nt,ot){this.part=nt,this.hasTriggerModifier=ot}}let InlayHintsController=class Jo{static get(nt){var ot;return(ot=nt.getContribution(Jo.ID))!==null&&ot!==void 0?ot:void 0}constructor(nt,ot,rt,ut,gt,pt,mt){this._editor=nt,this._languageFeaturesService=ot,this._inlayHintsCache=ut,this._commandService=gt,this._notificationService=pt,this._instaService=mt,this._disposables=new DisposableStore,this._sessionDisposables=new DisposableStore,this._decorationsMetadata=new Map,this._ruleFactory=new DynamicCssRules(this._editor),this._activeRenderMode=0,this._debounceInfo=rt.for(ot.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(ot.inlayHintsProvider.onDidChange(()=>this._update())),this._disposables.add(nt.onDidChangeModel(()=>this._update())),this._disposables.add(nt.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(nt.onDidChangeConfiguration(vt=>{vt.hasChanged(135)&&this._update()})),this._update()}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){this._sessionDisposables.clear(),this._removeAllDecorations();const nt=this._editor.getOption(135);if(nt.enabled==="off")return;const ot=this._editor.getModel();if(!ot||!this._languageFeaturesService.inlayHintsProvider.has(ot))return;const rt=this._inlayHintsCache.get(ot);rt&&this._updateHintsDecorators([ot.getFullModelRange()],rt),this._sessionDisposables.add(toDisposable(()=>{ot.isDisposed()||this._cacheHintsForFastRestore(ot)}));let ut;const gt=new Set,pt=new RunOnceScheduler(()=>__awaiter$k(this,void 0,void 0,function*(){const mt=Date.now();ut==null||ut.dispose(!0),ut=new CancellationTokenSource$1;const vt=ot.onWillDispose(()=>ut==null?void 0:ut.cancel());try{const St=ut.token,yt=yield InlayHintsFragments.create(this._languageFeaturesService.inlayHintsProvider,ot,this._getHintsRanges(),St);if(pt.delay=this._debounceInfo.update(ot,Date.now()-mt),St.isCancellationRequested){yt.dispose();return}for(const wt of yt.provider)typeof wt.onDidChangeInlayHints=="function"&&!gt.has(wt)&&(gt.add(wt),this._sessionDisposables.add(wt.onDidChangeInlayHints(()=>{pt.isScheduled()||pt.schedule()})));this._sessionDisposables.add(yt),this._updateHintsDecorators(yt.ranges,yt.items),this._cacheHintsForFastRestore(ot)}catch(St){onUnexpectedError(St)}finally{ut.dispose(),vt.dispose()}}),this._debounceInfo.get(ot));if(this._sessionDisposables.add(pt),this._sessionDisposables.add(toDisposable(()=>ut==null?void 0:ut.dispose(!0))),pt.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange(mt=>{(mt.scrollTopChanged||!pt.isScheduled())&&pt.schedule()})),this._sessionDisposables.add(this._editor.onDidChangeModelContent(mt=>{const vt=Math.max(pt.delay,1250);pt.schedule(vt)})),nt.enabled==="on")this._activeRenderMode=0;else{let mt,vt;nt.enabled==="onUnlessPressed"?(mt=0,vt=1):(mt=1,vt=0),this._activeRenderMode=mt,this._sessionDisposables.add(ModifierKeyEmitter.getInstance().event(St=>{if(!this._editor.hasModel())return;const yt=St.altKey&&St.ctrlKey&&!(St.shiftKey||St.metaKey)?vt:mt;if(yt!==this._activeRenderMode){this._activeRenderMode=yt;const wt=this._editor.getModel(),Lt=this._copyInlayHintsWithCurrentAnchor(wt);this._updateHintsDecorators([wt.getFullModelRange()],Lt),pt.schedule(0)}}))}this._sessionDisposables.add(this._installDblClickGesture(()=>pt.schedule(0))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const nt=new DisposableStore,ot=nt.add(new ClickLinkGesture(this._editor)),rt=new DisposableStore;return nt.add(rt),nt.add(ot.onMouseMoveOrRelevantKeyDown(ut=>{const[gt]=ut,pt=this._getInlayHintLabelPart(gt),mt=this._editor.getModel();if(!pt||!mt){rt.clear();return}const vt=new CancellationTokenSource$1;rt.add(toDisposable(()=>vt.dispose(!0))),pt.item.resolve(vt.token),this._activeInlayHintPart=pt.part.command||pt.part.location?new ActiveInlayHintInfo(pt,gt.hasTriggerModifier):void 0;const St=mt.validatePosition(pt.item.hint.position).lineNumber,yt=new Range$2(St,1,St,mt.getLineMaxColumn(St)),wt=this._getInlineHintsForRange(yt);this._updateHintsDecorators([yt],wt),rt.add(toDisposable(()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([yt],wt)}))})),nt.add(ot.onCancel(()=>rt.clear())),nt.add(ot.onExecute(ut=>__awaiter$k(this,void 0,void 0,function*(){const gt=this._getInlayHintLabelPart(ut);if(gt){const pt=gt.part;pt.location?this._instaService.invokeFunction(goToDefinitionWithLocation,ut,this._editor,pt.location):Command$1.is(pt.command)&&(yield this._invokeCommand(pt.command,gt.item))}}))),nt}_getInlineHintsForRange(nt){const ot=new Set;for(const rt of this._decorationsMetadata.values())nt.containsRange(rt.item.anchor.range)&&ot.add(rt.item);return Array.from(ot)}_installDblClickGesture(nt){return this._editor.onMouseUp(ot=>__awaiter$k(this,void 0,void 0,function*(){if(ot.event.detail!==2)return;const rt=this._getInlayHintLabelPart(ot);if(rt&&(ot.event.preventDefault(),yield rt.item.resolve(CancellationToken.None),isNonEmptyArray(rt.item.hint.textEdits))){const ut=rt.item.hint.textEdits.map(gt=>EditOperation.replace(Range$2.lift(gt.range),gt.text));this._editor.executeEdits("inlayHint.default",ut),nt()}}))}_installContextMenu(){return this._editor.onContextMenu(nt=>__awaiter$k(this,void 0,void 0,function*(){if(!(nt.event.target instanceof HTMLElement))return;const ot=this._getInlayHintLabelPart(nt);ot&&(yield this._instaService.invokeFunction(showGoToContextMenu,this._editor,nt.event.target,ot))}))}_getInlayHintLabelPart(nt){var ot;if(nt.target.type!==6)return;const rt=(ot=nt.target.detail.injectedText)===null||ot===void 0?void 0:ot.options;if(rt instanceof ModelDecorationInjectedTextOptions&&(rt==null?void 0:rt.attachedData)instanceof RenderedInlayHintLabelPart)return rt.attachedData}_invokeCommand(nt,ot){var rt;return __awaiter$k(this,void 0,void 0,function*(){try{yield this._commandService.executeCommand(nt.id,...(rt=nt.arguments)!==null&&rt!==void 0?rt:[])}catch(ut){this._notificationService.notify({severity:Severity.Error,source:ot.provider.displayName,message:ut})}})}_cacheHintsForFastRestore(nt){const ot=this._copyInlayHintsWithCurrentAnchor(nt);this._inlayHintsCache.set(nt,ot)}_copyInlayHintsWithCurrentAnchor(nt){const ot=new Map;for(const[rt,ut]of this._decorationsMetadata){if(ot.has(ut.item))continue;const gt=nt.getDecorationRange(rt);if(gt){const pt=new InlayHintAnchor(gt,ut.item.anchor.direction),mt=ut.item.with({anchor:pt});ot.set(ut.item,mt)}}return Array.from(ot.values())}_getHintsRanges(){const ot=this._editor.getModel(),rt=this._editor.getVisibleRangesPlusViewportAboveBelow(),ut=[];for(const gt of rt.sort(Range$2.compareRangesUsingStarts)){const pt=ot.validateRange(new Range$2(gt.startLineNumber-30,gt.startColumn,gt.endLineNumber+30,gt.endColumn));ut.length===0||!Range$2.areIntersectingOrTouching(ut[ut.length-1],pt)?ut.push(pt):ut[ut.length-1]=Range$2.plusRange(ut[ut.length-1],pt)}return ut}_updateHintsDecorators(nt,ot){var rt,ut;const gt=[],pt=(kt,At,Tt,Rt,Nt)=>{const Pt={content:Tt,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:At.className,cursorStops:Rt,attachedData:Nt};gt.push({item:kt,classNameRef:At,decoration:{range:kt.anchor.range,options:{description:"InlayHint",showIfCollapsed:kt.anchor.range.isEmpty(),collapseOnReplaceEdit:!kt.anchor.range.isEmpty(),stickiness:0,[kt.anchor.direction]:this._activeRenderMode===0?Pt:void 0}}})},mt=(kt,At)=>{const Tt=this._ruleFactory.createClassNameRef({width:`${vt/3|0}px`,display:"inline-block"});pt(kt,Tt,"",At?InjectedTextCursorStops.Right:InjectedTextCursorStops.None)},{fontSize:vt,fontFamily:St,padding:yt,isUniform:wt}=this._getLayoutInfo(),Lt="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(Lt,St);for(const kt of ot){kt.hint.paddingLeft&&mt(kt,!1);const At=typeof kt.hint.label=="string"?[{label:kt.hint.label}]:kt.hint.label;for(let Tt=0;Tt<At.length;Tt++){const Rt=At[Tt],Nt=Tt===0,Pt=Tt===At.length-1,Ft={fontSize:`${vt}px`,fontFamily:`var(${Lt}), ${EDITOR_FONT_DEFAULTS.fontFamily}`,verticalAlign:wt?"baseline":"middle"};isNonEmptyArray(kt.hint.textEdits)&&(Ft.cursor="default"),this._fillInColors(Ft,kt.hint),(Rt.command||Rt.location)&&((rt=this._activeInlayHintPart)===null||rt===void 0?void 0:rt.part.item)===kt&&this._activeInlayHintPart.part.index===Tt&&(Ft.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(Ft.color=themeColorFromId(editorActiveLinkForeground),Ft.cursor="pointer")),yt&&(Nt&&Pt?(Ft.padding=`1px ${Math.max(1,vt/4)|0}px`,Ft.borderRadius=`${vt/4|0}px`):Nt?(Ft.padding=`1px 0 1px ${Math.max(1,vt/4)|0}px`,Ft.borderRadius=`${vt/4|0}px 0 0 ${vt/4|0}px`):Pt?(Ft.padding=`1px ${Math.max(1,vt/4)|0}px 1px 0`,Ft.borderRadius=`0 ${vt/4|0}px ${vt/4|0}px 0`):Ft.padding="1px 0 1px 0"),pt(kt,this._ruleFactory.createClassNameRef(Ft),fixSpace(Rt.label),Pt&&!kt.hint.paddingRight?InjectedTextCursorStops.Right:InjectedTextCursorStops.None,new RenderedInlayHintLabelPart(kt,Tt))}if(kt.hint.paddingRight&&mt(kt,!0),gt.length>Jo._MAX_DECORATORS)break}const xt=[];for(const kt of nt)for(const{id:At}of(ut=this._editor.getDecorationsInRange(kt))!==null&&ut!==void 0?ut:[]){const Tt=this._decorationsMetadata.get(At);Tt&&(xt.push(At),Tt.classNameRef.dispose(),this._decorationsMetadata.delete(At))}const It=StableEditorScrollState.capture(this._editor);this._editor.changeDecorations(kt=>{const At=kt.deltaDecorations(xt,gt.map(Tt=>Tt.decoration));for(let Tt=0;Tt<At.length;Tt++){const Rt=gt[Tt];this._decorationsMetadata.set(At[Tt],Rt)}}),It.restore(this._editor)}_fillInColors(nt,ot){ot.kind===InlayHintKind$1.Parameter?(nt.backgroundColor=themeColorFromId(editorInlayHintParameterBackground),nt.color=themeColorFromId(editorInlayHintParameterForeground)):ot.kind===InlayHintKind$1.Type?(nt.backgroundColor=themeColorFromId(editorInlayHintTypeBackground),nt.color=themeColorFromId(editorInlayHintTypeForeground)):(nt.backgroundColor=themeColorFromId(editorInlayHintBackground),nt.color=themeColorFromId(editorInlayHintForeground))}_getLayoutInfo(){const nt=this._editor.getOption(135),ot=nt.padding,rt=this._editor.getOption(50),ut=this._editor.getOption(47);let gt=nt.fontSize;(!gt||gt<5||gt>rt)&&(gt=rt);const pt=nt.fontFamily||ut;return{fontSize:gt,fontFamily:pt,padding:ot,isUniform:!ot&&pt===ut&&gt===rt}}_removeAllDecorations(){this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));for(const nt of this._decorationsMetadata.values())nt.classNameRef.dispose();this._decorationsMetadata.clear()}};InlayHintsController.ID="editor.contrib.InlayHints";InlayHintsController._MAX_DECORATORS=1500;InlayHintsController=__decorate$v([__param$v(1,ILanguageFeaturesService),__param$v(2,ILanguageFeatureDebounceService),__param$v(3,IInlayHintsCache),__param$v(4,ICommandService),__param$v(5,INotificationService),__param$v(6,IInstantiationService)],InlayHintsController);function fixSpace(ct){const nt="";return ct.replace(/[ \t]/g,nt)}CommandsRegistry.registerCommand("_executeInlayHintProvider",(ct,...nt)=>__awaiter$k(void 0,void 0,void 0,function*(){const[ot,rt]=nt;assertType(URI.isUri(ot)),assertType(Range$2.isIRange(rt));const{inlayHintsProvider:ut}=ct.get(ILanguageFeaturesService),gt=yield ct.get(ITextModelService).createModelReference(ot);try{const pt=yield InlayHintsFragments.create(ut,gt.object.textEditorModel,[Range$2.lift(rt)],CancellationToken.None),mt=pt.items.map(vt=>vt.hint);return setTimeout(()=>pt.dispose(),0),mt}finally{gt.dispose()}}));var __decorate$u=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$u=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$j=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},__asyncValues=globalThis&&globalThis.__asyncValues||function(ct){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var nt=ct[Symbol.asyncIterator],ot;return nt?nt.call(ct):(ct=typeof __values=="function"?__values(ct):ct[Symbol.iterator](),ot={},rt("next"),rt("throw"),rt("return"),ot[Symbol.asyncIterator]=function(){return this},ot);function rt(gt){ot[gt]=ct[gt]&&function(pt){return new Promise(function(mt,vt){pt=ct[gt](pt),ut(mt,vt,pt.done,pt.value)})}}function ut(gt,pt,mt,vt){Promise.resolve(vt).then(function(St){gt({value:St,done:mt})},pt)}};class InlayHintsHoverAnchor extends HoverForeignElementAnchor{constructor(nt,ot,rt,ut){super(10,ot,nt.item.anchor.range,rt,ut,!0),this.part=nt}}let InlayHintsHover=class extends MarkdownHoverParticipant{constructor(nt,ot,rt,ut,gt,pt){super(nt,ot,rt,ut,pt),this._resolverService=gt,this.hoverOrdinal=6}suggestHoverAnchor(nt){var ot;if(!InlayHintsController.get(this._editor)||nt.target.type!==6)return null;const ut=(ot=nt.target.detail.injectedText)===null||ot===void 0?void 0:ot.options;return ut instanceof ModelDecorationInjectedTextOptions&&ut.attachedData instanceof RenderedInlayHintLabelPart?new InlayHintsHoverAnchor(ut.attachedData,this,nt.event.posx,nt.event.posy):null}computeSync(){return[]}computeAsync(nt,ot,rt){return nt instanceof InlayHintsHoverAnchor?new AsyncIterableObject(ut=>__awaiter$j(this,void 0,void 0,function*(){var gt,pt,mt,vt;const{part:St}=nt;if(yield St.item.resolve(rt),rt.isCancellationRequested)return;let yt;typeof St.item.hint.tooltip=="string"?yt=new MarkdownString().appendText(St.item.hint.tooltip):St.item.hint.tooltip&&(yt=St.item.hint.tooltip),yt&&ut.emitOne(new MarkdownHover(this,nt.range,[yt],!1,0)),isNonEmptyArray(St.item.hint.textEdits)&&ut.emitOne(new MarkdownHover(this,nt.range,[new MarkdownString().appendText(localize("hint.dbl","Double-click to insert"))],!1,10001));let wt;if(typeof St.part.tooltip=="string"?wt=new MarkdownString().appendText(St.part.tooltip):St.part.tooltip&&(wt=St.part.tooltip),wt&&ut.emitOne(new MarkdownHover(this,nt.range,[wt],!1,1)),St.part.location||St.part.command){let At;const Rt=this._editor.getOption(75)==="altKey"?isMacintosh?localize("links.navigate.kb.meta.mac","cmd + click"):localize("links.navigate.kb.meta","ctrl + click"):isMacintosh?localize("links.navigate.kb.alt.mac","option + click"):localize("links.navigate.kb.alt","alt + click");St.part.location&&St.part.command?At=new MarkdownString().appendText(localize("hint.defAndCommand","Go to Definition ({0}), right click for more",Rt)):St.part.location?At=new MarkdownString().appendText(localize("hint.def","Go to Definition ({0})",Rt)):St.part.command&&(At=new MarkdownString(`[${localize("hint.cmd","Execute Command")}](${asCommandLink(St.part.command)} "${St.part.command.title}") (${Rt})`,{isTrusted:!0})),At&&ut.emitOne(new MarkdownHover(this,nt.range,[At],!1,1e4))}const Lt=yield this._resolveInlayHintLabelPartHover(St,rt);try{for(var xt=!0,It=__asyncValues(Lt),kt;kt=yield It.next(),gt=kt.done,!gt;){vt=kt.value,xt=!1;try{const At=vt;ut.emitOne(At)}finally{xt=!0}}}catch(At){pt={error:At}}finally{try{!xt&&!gt&&(mt=It.return)&&(yield mt.call(It))}finally{if(pt)throw pt.error}}})):AsyncIterableObject.EMPTY}_resolveInlayHintLabelPartHover(nt,ot){return __awaiter$j(this,void 0,void 0,function*(){if(!nt.part.location)return AsyncIterableObject.EMPTY;const{uri:rt,range:ut}=nt.part.location,gt=yield this._resolverService.createModelReference(rt);try{const pt=gt.object.textEditorModel;return this._languageFeaturesService.hoverProvider.has(pt)?getHover(this._languageFeaturesService.hoverProvider,pt,new Position$1(ut.startLineNumber,ut.startColumn),ot).filter(mt=>!isEmptyMarkdownString(mt.hover.contents)).map(mt=>new MarkdownHover(this,nt.item.anchor.range,mt.hover.contents,!1,2+mt.ordinal)):AsyncIterableObject.EMPTY}finally{gt.dispose()}})}};InlayHintsHover=__decorate$u([__param$u(1,ILanguageService),__param$u(2,IOpenerService),__param$u(3,IConfigurationService),__param$u(4,ITextModelService),__param$u(5,ILanguageFeaturesService)],InlayHintsHover);registerEditorContribution(InlayHintsController.ID,InlayHintsController,1);HoverParticipantRegistry.register(InlayHintsHover);class InPlaceReplaceCommand{constructor(nt,ot,rt){this._editRange=nt,this._originalSelection=ot,this._text=rt}getEditOperations(nt,ot){ot.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(nt,ot){const ut=ot.getInverseEditOperations()[0].range;return this._originalSelection.isEmpty()?new Selection$1(ut.endLineNumber,Math.min(this._originalSelection.positionColumn,ut.endColumn),ut.endLineNumber,Math.min(this._originalSelection.positionColumn,ut.endColumn)):new Selection$1(ut.endLineNumber,ut.endColumn-this._text.length,ut.endLineNumber,ut.endColumn)}}const inPlaceReplace="";var __decorate$t=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$t=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let InPlaceReplaceController=class er{static get(nt){return nt.getContribution(er.ID)}constructor(nt,ot){this.editor=nt,this.editorWorkerService=ot,this.decorations=this.editor.createDecorationsCollection()}dispose(){}run(nt,ot){var rt;(rt=this.currentRequest)===null||rt===void 0||rt.cancel();const ut=this.editor.getSelection(),gt=this.editor.getModel();if(!gt||!ut)return;let pt=ut;if(pt.startLineNumber!==pt.endLineNumber)return;const mt=new EditorState$1(this.editor,5),vt=gt.uri;return this.editorWorkerService.canNavigateValueSet(vt)?(this.currentRequest=createCancelablePromise(St=>this.editorWorkerService.navigateValueSet(vt,pt,ot)),this.currentRequest.then(St=>{var yt;if(!St||!St.range||!St.value||!mt.validate(this.editor))return;const wt=Range$2.lift(St.range);let Lt=St.range;const xt=St.value.length-(pt.endColumn-pt.startColumn);Lt={startLineNumber:Lt.startLineNumber,startColumn:Lt.startColumn,endLineNumber:Lt.endLineNumber,endColumn:Lt.startColumn+St.value.length},xt>1&&(pt=new Selection$1(pt.startLineNumber,pt.startColumn,pt.endLineNumber,pt.endColumn+xt-1));const It=new InPlaceReplaceCommand(wt,pt,St.value);this.editor.pushUndoStop(),this.editor.executeCommand(nt,It),this.editor.pushUndoStop(),this.decorations.set([{range:Lt,options:er.DECORATION}]),(yt=this.decorationRemover)===null||yt===void 0||yt.cancel(),this.decorationRemover=timeout(350),this.decorationRemover.then(()=>this.decorations.clear()).catch(onUnexpectedError)}).catch(onUnexpectedError)):Promise.resolve(void 0)}};InPlaceReplaceController.ID="editor.contrib.inPlaceReplaceController";InPlaceReplaceController.DECORATION=ModelDecorationOptions.register({description:"in-place-replace",className:"valueSetReplacement"});InPlaceReplaceController=__decorate$t([__param$t(1,IEditorWorkerService)],InPlaceReplaceController);class InPlaceReplaceUp extends EditorAction{constructor(){super({id:"editor.action.inPlaceReplace.up",label:localize("InPlaceReplaceAction.previous.label","Replace with Previous Value"),alias:"Replace with Previous Value",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3159,weight:100}})}run(nt,ot){const rt=InPlaceReplaceController.get(ot);return rt?rt.run(this.id,!1):Promise.resolve(void 0)}}class InPlaceReplaceDown extends EditorAction{constructor(){super({id:"editor.action.inPlaceReplace.down",label:localize("InPlaceReplaceAction.next.label","Replace with Next Value"),alias:"Replace with Next Value",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3161,weight:100}})}run(nt,ot){const rt=InPlaceReplaceController.get(ot);return rt?rt.run(this.id,!0):Promise.resolve(void 0)}}registerEditorContribution(InPlaceReplaceController.ID,InPlaceReplaceController,4);registerEditorAction(InPlaceReplaceUp);registerEditorAction(InPlaceReplaceDown);class ExpandLineSelectionAction extends EditorAction{constructor(){super({id:"expandLineSelection",label:localize("expandLineSelection","Expand Line Selection"),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:EditorContextKeys.textInputFocus,primary:2090}})}run(nt,ot,rt){if(rt=rt||{},!ot.hasModel())return;const ut=ot._getViewModel();ut.model.pushStackElement(),ut.setCursorStates(rt.source,3,CursorMoveCommands.expandLineSelection(ut,ut.getCursorStates())),ut.revealPrimaryCursor(rt.source,!0)}}registerEditorAction(ExpandLineSelectionAction);class TrimTrailingWhitespaceCommand{constructor(nt,ot){this._selection=nt,this._cursors=ot,this._selectionId=null}getEditOperations(nt,ot){const rt=trimTrailingWhitespace(nt,this._cursors);for(let ut=0,gt=rt.length;ut<gt;ut++){const pt=rt[ut];ot.addEditOperation(pt.range,pt.text)}this._selectionId=ot.trackSelection(this._selection)}computeCursorState(nt,ot){return ot.getTrackedSelection(this._selectionId)}}function trimTrailingWhitespace(ct,nt){nt.sort((pt,mt)=>pt.lineNumber===mt.lineNumber?pt.column-mt.column:pt.lineNumber-mt.lineNumber);for(let pt=nt.length-2;pt>=0;pt--)nt[pt].lineNumber===nt[pt+1].lineNumber&&nt.splice(pt,1);const ot=[];let rt=0,ut=0;const gt=nt.length;for(let pt=1,mt=ct.getLineCount();pt<=mt;pt++){const vt=ct.getLineContent(pt),St=vt.length+1;let yt=0;if(ut<gt&&nt[ut].lineNumber===pt&&(yt=nt[ut].column,ut++,yt===St)||vt.length===0)continue;const wt=lastNonWhitespaceIndex(vt);let Lt=0;if(wt===-1)Lt=1;else if(wt!==vt.length-1)Lt=wt+2;else continue;Lt=Math.max(yt,Lt),ot[rt++]=EditOperation.delete(new Range$2(pt,Lt,pt,St))}return ot}class CopyLinesCommand{constructor(nt,ot,rt){this._selection=nt,this._isCopyingDown=ot,this._noop=rt||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(nt,ot){let rt=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,rt.startLineNumber<rt.endLineNumber&&rt.endColumn===1&&(this._endLineNumberDelta=1,rt=rt.setEndPosition(rt.endLineNumber-1,nt.getLineMaxColumn(rt.endLineNumber-1)));const ut=[];for(let pt=rt.startLineNumber;pt<=rt.endLineNumber;pt++)ut.push(nt.getLineContent(pt));const gt=ut.join(`
`);gt===""&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?ot.addEditOperation(new Range$2(rt.endLineNumber,nt.getLineMaxColumn(rt.endLineNumber),rt.endLineNumber+1,1),rt.endLineNumber===nt.getLineCount()?"":`
`):this._isCopyingDown?ot.addEditOperation(new Range$2(rt.startLineNumber,1,rt.startLineNumber,1),gt+`
`):ot.addEditOperation(new Range$2(rt.endLineNumber,nt.getLineMaxColumn(rt.endLineNumber),rt.endLineNumber,nt.getLineMaxColumn(rt.endLineNumber)),`
`+gt),this._selectionId=ot.trackSelection(rt),this._selectionDirection=this._selection.getDirection()}computeCursorState(nt,ot){let rt=ot.getTrackedSelection(this._selectionId);if(this._startLineNumberDelta!==0||this._endLineNumberDelta!==0){let ut=rt.startLineNumber,gt=rt.startColumn,pt=rt.endLineNumber,mt=rt.endColumn;this._startLineNumberDelta!==0&&(ut=ut+this._startLineNumberDelta,gt=1),this._endLineNumberDelta!==0&&(pt=pt+this._endLineNumberDelta,mt=1),rt=Selection$1.createWithDirection(ut,gt,pt,mt,this._selectionDirection)}return rt}}var __decorate$s=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$s=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let MoveLinesCommand=class{constructor(nt,ot,rt,ut){this._languageConfigurationService=ut,this._selection=nt,this._isMovingDown=ot,this._autoIndent=rt,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(nt,ot){const rt=nt.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===rt){this._selectionId=ot.trackSelection(this._selection);return}if(!this._isMovingDown&&this._selection.startLineNumber===1){this._selectionId=ot.trackSelection(this._selection);return}this._moveEndPositionDown=!1;let ut=this._selection;ut.startLineNumber<ut.endLineNumber&&ut.endColumn===1&&(this._moveEndPositionDown=!0,ut=ut.setEndPosition(ut.endLineNumber-1,nt.getLineMaxColumn(ut.endLineNumber-1)));const{tabSize:gt,indentSize:pt,insertSpaces:mt}=nt.getOptions(),vt=this.buildIndentConverter(gt,pt,mt),St={tokenization:{getLineTokens:yt=>nt.tokenization.getLineTokens(yt),getLanguageId:()=>nt.getLanguageId(),getLanguageIdAtPosition:(yt,wt)=>nt.getLanguageIdAtPosition(yt,wt)},getLineContent:null};if(ut.startLineNumber===ut.endLineNumber&&nt.getLineMaxColumn(ut.startLineNumber)===1){const yt=ut.startLineNumber,wt=this._isMovingDown?yt+1:yt-1;nt.getLineMaxColumn(wt)===1?ot.addEditOperation(new Range$2(1,1,1,1),null):(ot.addEditOperation(new Range$2(yt,1,yt,1),nt.getLineContent(wt)),ot.addEditOperation(new Range$2(wt,1,wt,nt.getLineMaxColumn(wt)),null)),ut=new Selection$1(wt,1,wt,1)}else{let yt,wt;if(this._isMovingDown){yt=ut.endLineNumber+1,wt=nt.getLineContent(yt),ot.addEditOperation(new Range$2(yt-1,nt.getLineMaxColumn(yt-1),yt,nt.getLineMaxColumn(yt)),null);let Lt=wt;if(this.shouldAutoIndent(nt,ut)){const xt=this.matchEnterRule(nt,vt,gt,yt,ut.startLineNumber-1);if(xt!==null){const kt=getLeadingWhitespace(nt.getLineContent(yt)),At=xt+getSpaceCnt(kt,gt);Lt=generateIndent(At,gt,mt)+this.trimLeft(wt)}else{St.getLineContent=At=>At===ut.startLineNumber?nt.getLineContent(yt):nt.getLineContent(At);const kt=getGoodIndentForLine(this._autoIndent,St,nt.getLanguageIdAtPosition(yt,1),ut.startLineNumber,vt,this._languageConfigurationService);if(kt!==null){const At=getLeadingWhitespace(nt.getLineContent(yt)),Tt=getSpaceCnt(kt,gt),Rt=getSpaceCnt(At,gt);Tt!==Rt&&(Lt=generateIndent(Tt,gt,mt)+this.trimLeft(wt))}}ot.addEditOperation(new Range$2(ut.startLineNumber,1,ut.startLineNumber,1),Lt+`
`);const It=this.matchEnterRuleMovingDown(nt,vt,gt,ut.startLineNumber,yt,Lt);if(It!==null)It!==0&&this.getIndentEditsOfMovingBlock(nt,ot,ut,gt,mt,It);else{St.getLineContent=At=>At===ut.startLineNumber?Lt:At>=ut.startLineNumber+1&&At<=ut.endLineNumber+1?nt.getLineContent(At-1):nt.getLineContent(At);const kt=getGoodIndentForLine(this._autoIndent,St,nt.getLanguageIdAtPosition(yt,1),ut.startLineNumber+1,vt,this._languageConfigurationService);if(kt!==null){const At=getLeadingWhitespace(nt.getLineContent(ut.startLineNumber)),Tt=getSpaceCnt(kt,gt),Rt=getSpaceCnt(At,gt);if(Tt!==Rt){const Nt=Tt-Rt;this.getIndentEditsOfMovingBlock(nt,ot,ut,gt,mt,Nt)}}}}else ot.addEditOperation(new Range$2(ut.startLineNumber,1,ut.startLineNumber,1),Lt+`
`)}else if(yt=ut.startLineNumber-1,wt=nt.getLineContent(yt),ot.addEditOperation(new Range$2(yt,1,yt+1,1),null),ot.addEditOperation(new Range$2(ut.endLineNumber,nt.getLineMaxColumn(ut.endLineNumber),ut.endLineNumber,nt.getLineMaxColumn(ut.endLineNumber)),`
`+wt),this.shouldAutoIndent(nt,ut)){St.getLineContent=xt=>xt===yt?nt.getLineContent(ut.startLineNumber):nt.getLineContent(xt);const Lt=this.matchEnterRule(nt,vt,gt,ut.startLineNumber,ut.startLineNumber-2);if(Lt!==null)Lt!==0&&this.getIndentEditsOfMovingBlock(nt,ot,ut,gt,mt,Lt);else{const xt=getGoodIndentForLine(this._autoIndent,St,nt.getLanguageIdAtPosition(ut.startLineNumber,1),yt,vt,this._languageConfigurationService);if(xt!==null){const It=getLeadingWhitespace(nt.getLineContent(ut.startLineNumber)),kt=getSpaceCnt(xt,gt),At=getSpaceCnt(It,gt);if(kt!==At){const Tt=kt-At;this.getIndentEditsOfMovingBlock(nt,ot,ut,gt,mt,Tt)}}}}}this._selectionId=ot.trackSelection(ut)}buildIndentConverter(nt,ot,rt){return{shiftIndent:ut=>ShiftCommand.shiftIndent(ut,ut.length+1,nt,ot,rt),unshiftIndent:ut=>ShiftCommand.unshiftIndent(ut,ut.length+1,nt,ot,rt)}}parseEnterResult(nt,ot,rt,ut,gt){if(gt){let pt=gt.indentation;gt.indentAction===IndentAction.None||gt.indentAction===IndentAction.Indent?pt=gt.indentation+gt.appendText:gt.indentAction===IndentAction.IndentOutdent?pt=gt.indentation:gt.indentAction===IndentAction.Outdent&&(pt=ot.unshiftIndent(gt.indentation)+gt.appendText);const mt=nt.getLineContent(ut);if(this.trimLeft(mt).indexOf(this.trimLeft(pt))>=0){const vt=getLeadingWhitespace(nt.getLineContent(ut));let St=getLeadingWhitespace(pt);const yt=getIndentMetadata(nt,ut,this._languageConfigurationService);yt!==null&&yt&2&&(St=ot.unshiftIndent(St));const wt=getSpaceCnt(St,rt),Lt=getSpaceCnt(vt,rt);return wt-Lt}}return null}matchEnterRuleMovingDown(nt,ot,rt,ut,gt,pt){if(lastNonWhitespaceIndex(pt)>=0){const mt=nt.getLineMaxColumn(gt),vt=getEnterAction(this._autoIndent,nt,new Range$2(gt,mt,gt,mt),this._languageConfigurationService);return this.parseEnterResult(nt,ot,rt,ut,vt)}else{let mt=ut-1;for(;mt>=1;){const yt=nt.getLineContent(mt);if(lastNonWhitespaceIndex(yt)>=0)break;mt--}if(mt<1||ut>nt.getLineCount())return null;const vt=nt.getLineMaxColumn(mt),St=getEnterAction(this._autoIndent,nt,new Range$2(mt,vt,mt,vt),this._languageConfigurationService);return this.parseEnterResult(nt,ot,rt,ut,St)}}matchEnterRule(nt,ot,rt,ut,gt,pt){let mt=gt;for(;mt>=1;){let yt;if(mt===gt&&pt!==void 0?yt=pt:yt=nt.getLineContent(mt),lastNonWhitespaceIndex(yt)>=0)break;mt--}if(mt<1||ut>nt.getLineCount())return null;const vt=nt.getLineMaxColumn(mt),St=getEnterAction(this._autoIndent,nt,new Range$2(mt,vt,mt,vt),this._languageConfigurationService);return this.parseEnterResult(nt,ot,rt,ut,St)}trimLeft(nt){return nt.replace(/^\s+/,"")}shouldAutoIndent(nt,ot){if(this._autoIndent<4||!nt.tokenization.isCheapToTokenize(ot.startLineNumber))return!1;const rt=nt.getLanguageIdAtPosition(ot.startLineNumber,1),ut=nt.getLanguageIdAtPosition(ot.endLineNumber,1);return!(rt!==ut||this._languageConfigurationService.getLanguageConfiguration(rt).indentRulesSupport===null)}getIndentEditsOfMovingBlock(nt,ot,rt,ut,gt,pt){for(let mt=rt.startLineNumber;mt<=rt.endLineNumber;mt++){const vt=nt.getLineContent(mt),St=getLeadingWhitespace(vt),wt=getSpaceCnt(St,ut)+pt,Lt=generateIndent(wt,ut,gt);Lt!==St&&(ot.addEditOperation(new Range$2(mt,1,mt,St.length+1),Lt),mt===rt.endLineNumber&&rt.endColumn<=St.length+1&&Lt===""&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(nt,ot){let rt=ot.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(rt=rt.setEndPosition(rt.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&rt.startLineNumber<rt.endLineNumber&&(rt=rt.setEndPosition(rt.endLineNumber,2)),rt}};MoveLinesCommand=__decorate$s([__param$s(3,ILanguageConfigurationService)],MoveLinesCommand);class SortLinesCommand{static getCollator(){return SortLinesCommand._COLLATOR||(SortLinesCommand._COLLATOR=new Intl.Collator),SortLinesCommand._COLLATOR}constructor(nt,ot){this.selection=nt,this.descending=ot,this.selectionId=null}getEditOperations(nt,ot){const rt=sortLines(nt,this.selection,this.descending);rt&&ot.addEditOperation(rt.range,rt.text),this.selectionId=ot.trackSelection(this.selection)}computeCursorState(nt,ot){return ot.getTrackedSelection(this.selectionId)}static canRun(nt,ot,rt){if(nt===null)return!1;const ut=getSortData(nt,ot,rt);if(!ut)return!1;for(let gt=0,pt=ut.before.length;gt<pt;gt++)if(ut.before[gt]!==ut.after[gt])return!0;return!1}}SortLinesCommand._COLLATOR=null;function getSortData(ct,nt,ot){const rt=nt.startLineNumber;let ut=nt.endLineNumber;if(nt.endColumn===1&&ut--,rt>=ut)return null;const gt=[];for(let mt=rt;mt<=ut;mt++)gt.push(ct.getLineContent(mt));let pt=gt.slice(0);return pt.sort(SortLinesCommand.getCollator().compare),ot===!0&&(pt=pt.reverse()),{startLineNumber:rt,endLineNumber:ut,before:gt,after:pt}}function sortLines(ct,nt,ot){const rt=getSortData(ct,nt,ot);return rt?EditOperation.replace(new Range$2(rt.startLineNumber,1,rt.endLineNumber,ct.getLineMaxColumn(rt.endLineNumber)),rt.after.join(`
`)):null}class AbstractCopyLinesAction extends EditorAction{constructor(nt,ot){super(ot),this.down=nt}run(nt,ot){if(!ot.hasModel())return;const rt=ot.getSelections().map((pt,mt)=>({selection:pt,index:mt,ignore:!1}));rt.sort((pt,mt)=>Range$2.compareRangesUsingStarts(pt.selection,mt.selection));let ut=rt[0];for(let pt=1;pt<rt.length;pt++){const mt=rt[pt];ut.selection.endLineNumber===mt.selection.startLineNumber&&(ut.index<mt.index?mt.ignore=!0:(ut.ignore=!0,ut=mt))}const gt=[];for(const pt of rt)gt.push(new CopyLinesCommand(pt.selection,this.down,pt.ignore));ot.pushUndoStop(),ot.executeCommands(this.id,gt),ot.pushUndoStop()}}class CopyLinesUpAction extends AbstractCopyLinesAction{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:localize("lines.copyUp","Copy Line Up"),alias:"Copy Line Up",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"2_line",title:localize({key:"miCopyLinesUp",comment:["&& denotes a mnemonic"]},"&&Copy Line Up"),order:1}})}}class CopyLinesDownAction extends AbstractCopyLinesAction{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:localize("lines.copyDown","Copy Line Down"),alias:"Copy Line Down",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"2_line",title:localize({key:"miCopyLinesDown",comment:["&& denotes a mnemonic"]},"Co&&py Line Down"),order:2}})}}class DuplicateSelectionAction extends EditorAction{constructor(){super({id:"editor.action.duplicateSelection",label:localize("duplicateSelection","Duplicate Selection"),alias:"Duplicate Selection",precondition:EditorContextKeys.writable,menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"2_line",title:localize({key:"miDuplicateSelection",comment:["&& denotes a mnemonic"]},"&&Duplicate Selection"),order:5}})}run(nt,ot,rt){if(!ot.hasModel())return;const ut=[],gt=ot.getSelections(),pt=ot.getModel();for(const mt of gt)if(mt.isEmpty())ut.push(new CopyLinesCommand(mt,!0));else{const vt=new Selection$1(mt.endLineNumber,mt.endColumn,mt.endLineNumber,mt.endColumn);ut.push(new ReplaceCommandThatSelectsText(vt,pt.getValueInRange(mt)))}ot.pushUndoStop(),ot.executeCommands(this.id,ut),ot.pushUndoStop()}}class AbstractMoveLinesAction extends EditorAction{constructor(nt,ot){super(ot),this.down=nt}run(nt,ot){const rt=nt.get(ILanguageConfigurationService),ut=[],gt=ot.getSelections()||[],pt=ot.getOption(10);for(const mt of gt)ut.push(new MoveLinesCommand(mt,this.down,pt,rt));ot.pushUndoStop(),ot.executeCommands(this.id,ut),ot.pushUndoStop()}}class MoveLinesUpAction extends AbstractMoveLinesAction{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:localize("lines.moveUp","Move Line Up"),alias:"Move Line Up",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"2_line",title:localize({key:"miMoveLinesUp",comment:["&& denotes a mnemonic"]},"Mo&&ve Line Up"),order:3}})}}class MoveLinesDownAction extends AbstractMoveLinesAction{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:localize("lines.moveDown","Move Line Down"),alias:"Move Line Down",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"2_line",title:localize({key:"miMoveLinesDown",comment:["&& denotes a mnemonic"]},"Move &&Line Down"),order:4}})}}class AbstractSortLinesAction extends EditorAction{constructor(nt,ot){super(ot),this.descending=nt}run(nt,ot){const rt=ot.getSelections()||[];for(const gt of rt)if(!SortLinesCommand.canRun(ot.getModel(),gt,this.descending))return;const ut=[];for(let gt=0,pt=rt.length;gt<pt;gt++)ut[gt]=new SortLinesCommand(rt[gt],this.descending);ot.pushUndoStop(),ot.executeCommands(this.id,ut),ot.pushUndoStop()}}class SortLinesAscendingAction extends AbstractSortLinesAction{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:localize("lines.sortAscending","Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:EditorContextKeys.writable})}}class SortLinesDescendingAction extends AbstractSortLinesAction{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:localize("lines.sortDescending","Sort Lines Descending"),alias:"Sort Lines Descending",precondition:EditorContextKeys.writable})}}class DeleteDuplicateLinesAction extends EditorAction{constructor(){super({id:"editor.action.removeDuplicateLines",label:localize("lines.deleteDuplicates","Delete Duplicate Lines"),alias:"Delete Duplicate Lines",precondition:EditorContextKeys.writable})}run(nt,ot){if(!ot.hasModel())return;const rt=ot.getModel();if(rt.getLineCount()===1&&rt.getLineMaxColumn(1)===1)return;const ut=[],gt=[];let pt=0;for(const mt of ot.getSelections()){const vt=new Set,St=[];for(let xt=mt.startLineNumber;xt<=mt.endLineNumber;xt++){const It=rt.getLineContent(xt);vt.has(It)||(St.push(It),vt.add(It))}const yt=new Selection$1(mt.startLineNumber,1,mt.endLineNumber,rt.getLineMaxColumn(mt.endLineNumber)),wt=mt.startLineNumber-pt,Lt=new Selection$1(wt,1,wt+St.length-1,St[St.length-1].length);ut.push(EditOperation.replace(yt,St.join(`
`))),gt.push(Lt),pt+=mt.endLineNumber-mt.startLineNumber+1-St.length}ot.pushUndoStop(),ot.executeEdits(this.id,ut,gt),ot.pushUndoStop()}}class TrimTrailingWhitespaceAction extends EditorAction{constructor(){super({id:TrimTrailingWhitespaceAction.ID,label:localize("lines.trimTrailingWhitespace","Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2102),weight:100}})}run(nt,ot,rt){let ut=[];rt.reason==="auto-save"&&(ut=(ot.getSelections()||[]).map(mt=>new Position$1(mt.positionLineNumber,mt.positionColumn)));const gt=ot.getSelection();if(gt===null)return;const pt=new TrimTrailingWhitespaceCommand(gt,ut);ot.pushUndoStop(),ot.executeCommands(this.id,[pt]),ot.pushUndoStop()}}TrimTrailingWhitespaceAction.ID="editor.action.trimTrailingWhitespace";class DeleteLinesAction extends EditorAction{constructor(){super({id:"editor.action.deleteLines",label:localize("lines.delete","Delete Line"),alias:"Delete Line",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:3113,weight:100}})}run(nt,ot){if(!ot.hasModel())return;const rt=this._getLinesToRemove(ot),ut=ot.getModel();if(ut.getLineCount()===1&&ut.getLineMaxColumn(1)===1)return;let gt=0;const pt=[],mt=[];for(let vt=0,St=rt.length;vt<St;vt++){const yt=rt[vt];let wt=yt.startLineNumber,Lt=yt.endLineNumber,xt=1,It=ut.getLineMaxColumn(Lt);Lt<ut.getLineCount()?(Lt+=1,It=1):wt>1&&(wt-=1,xt=ut.getLineMaxColumn(wt)),pt.push(EditOperation.replace(new Selection$1(wt,xt,Lt,It),"")),mt.push(new Selection$1(wt-gt,yt.positionColumn,wt-gt,yt.positionColumn)),gt+=yt.endLineNumber-yt.startLineNumber+1}ot.pushUndoStop(),ot.executeEdits(this.id,pt,mt),ot.pushUndoStop()}_getLinesToRemove(nt){const ot=nt.getSelections().map(gt=>{let pt=gt.endLineNumber;return gt.startLineNumber<gt.endLineNumber&&gt.endColumn===1&&(pt-=1),{startLineNumber:gt.startLineNumber,selectionStartColumn:gt.selectionStartColumn,endLineNumber:pt,positionColumn:gt.positionColumn}});ot.sort((gt,pt)=>gt.startLineNumber===pt.startLineNumber?gt.endLineNumber-pt.endLineNumber:gt.startLineNumber-pt.startLineNumber);const rt=[];let ut=ot[0];for(let gt=1;gt<ot.length;gt++)ut.endLineNumber+1>=ot[gt].startLineNumber?ut.endLineNumber=ot[gt].endLineNumber:(rt.push(ut),ut=ot[gt]);return rt.push(ut),rt}}class IndentLinesAction extends EditorAction{constructor(){super({id:"editor.action.indentLines",label:localize("lines.indent","Indent Line"),alias:"Indent Line",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2142,weight:100}})}run(nt,ot){const rt=ot._getViewModel();rt&&(ot.pushUndoStop(),ot.executeCommands(this.id,TypeOperations.indent(rt.cursorConfig,ot.getModel(),ot.getSelections())),ot.pushUndoStop())}}class OutdentLinesAction extends EditorAction{constructor(){super({id:"editor.action.outdentLines",label:localize("lines.outdent","Outdent Line"),alias:"Outdent Line",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2140,weight:100}})}run(nt,ot){CoreEditingCommands.Outdent.runEditorCommand(nt,ot,null)}}class InsertLineBeforeAction extends EditorAction{constructor(){super({id:"editor.action.insertLineBefore",label:localize("lines.insertBefore","Insert Line Above"),alias:"Insert Line Above",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3075,weight:100}})}run(nt,ot){const rt=ot._getViewModel();rt&&(ot.pushUndoStop(),ot.executeCommands(this.id,TypeOperations.lineInsertBefore(rt.cursorConfig,ot.getModel(),ot.getSelections())))}}class InsertLineAfterAction extends EditorAction{constructor(){super({id:"editor.action.insertLineAfter",label:localize("lines.insertAfter","Insert Line Below"),alias:"Insert Line Below",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2051,weight:100}})}run(nt,ot){const rt=ot._getViewModel();rt&&(ot.pushUndoStop(),ot.executeCommands(this.id,TypeOperations.lineInsertAfter(rt.cursorConfig,ot.getModel(),ot.getSelections())))}}class AbstractDeleteAllToBoundaryAction extends EditorAction{run(nt,ot){if(!ot.hasModel())return;const rt=ot.getSelection(),ut=this._getRangesToDelete(ot),gt=[];for(let vt=0,St=ut.length-1;vt<St;vt++){const yt=ut[vt],wt=ut[vt+1];Range$2.intersectRanges(yt,wt)===null?gt.push(yt):ut[vt+1]=Range$2.plusRange(yt,wt)}gt.push(ut[ut.length-1]);const pt=this._getEndCursorState(rt,gt),mt=gt.map(vt=>EditOperation.replace(vt,""));ot.pushUndoStop(),ot.executeEdits(this.id,mt,pt),ot.pushUndoStop()}}class DeleteAllLeftAction extends AbstractDeleteAllToBoundaryAction{constructor(){super({id:"deleteAllLeft",label:localize("lines.deleteAllLeft","Delete All Left"),alias:"Delete All Left",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(nt,ot){let rt=null;const ut=[];let gt=0;return ot.forEach(pt=>{let mt;if(pt.endColumn===1&&gt>0){const vt=pt.startLineNumber-gt;mt=new Selection$1(vt,pt.startColumn,vt,pt.startColumn)}else mt=new Selection$1(pt.startLineNumber,pt.startColumn,pt.startLineNumber,pt.startColumn);gt+=pt.endLineNumber-pt.startLineNumber,pt.intersectRanges(nt)?rt=mt:ut.push(mt)}),rt&&ut.unshift(rt),ut}_getRangesToDelete(nt){const ot=nt.getSelections();if(ot===null)return[];let rt=ot;const ut=nt.getModel();return ut===null?[]:(rt.sort(Range$2.compareRangesUsingStarts),rt=rt.map(gt=>{if(gt.isEmpty())if(gt.startColumn===1){const pt=Math.max(1,gt.startLineNumber-1),mt=gt.startLineNumber===1?1:ut.getLineContent(pt).length+1;return new Range$2(pt,mt,gt.startLineNumber,1)}else return new Range$2(gt.startLineNumber,1,gt.startLineNumber,gt.startColumn);else return new Range$2(gt.startLineNumber,1,gt.endLineNumber,gt.endColumn)}),rt)}}class DeleteAllRightAction extends AbstractDeleteAllToBoundaryAction{constructor(){super({id:"deleteAllRight",label:localize("lines.deleteAllRight","Delete All Right"),alias:"Delete All Right",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(nt,ot){let rt=null;const ut=[];for(let gt=0,pt=ot.length,mt=0;gt<pt;gt++){const vt=ot[gt],St=new Selection$1(vt.startLineNumber-mt,vt.startColumn,vt.startLineNumber-mt,vt.startColumn);vt.intersectRanges(nt)?rt=St:ut.push(St)}return rt&&ut.unshift(rt),ut}_getRangesToDelete(nt){const ot=nt.getModel();if(ot===null)return[];const rt=nt.getSelections();if(rt===null)return[];const ut=rt.map(gt=>{if(gt.isEmpty()){const pt=ot.getLineMaxColumn(gt.startLineNumber);return gt.startColumn===pt?new Range$2(gt.startLineNumber,gt.startColumn,gt.startLineNumber+1,1):new Range$2(gt.startLineNumber,gt.startColumn,gt.startLineNumber,pt)}return gt});return ut.sort(Range$2.compareRangesUsingStarts),ut}}class JoinLinesAction extends EditorAction{constructor(){super({id:"editor.action.joinLines",label:localize("lines.joinLines","Join Lines"),alias:"Join Lines",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(nt,ot){const rt=ot.getSelections();if(rt===null)return;let ut=ot.getSelection();if(ut===null)return;rt.sort(Range$2.compareRangesUsingStarts);const gt=[],pt=rt.reduce((Lt,xt)=>Lt.isEmpty()?Lt.endLineNumber===xt.startLineNumber?(ut.equalsSelection(Lt)&&(ut=xt),xt):xt.startLineNumber>Lt.endLineNumber+1?(gt.push(Lt),xt):new Selection$1(Lt.startLineNumber,Lt.startColumn,xt.endLineNumber,xt.endColumn):xt.startLineNumber>Lt.endLineNumber?(gt.push(Lt),xt):new Selection$1(Lt.startLineNumber,Lt.startColumn,xt.endLineNumber,xt.endColumn));gt.push(pt);const mt=ot.getModel();if(mt===null)return;const vt=[],St=[];let yt=ut,wt=0;for(let Lt=0,xt=gt.length;Lt<xt;Lt++){const It=gt[Lt],kt=It.startLineNumber,At=1;let Tt=0,Rt,Nt;const Pt=mt.getLineContent(It.endLineNumber).length-It.endColumn;if(It.isEmpty()||It.startLineNumber===It.endLineNumber){const Bt=It.getStartPosition();Bt.lineNumber<mt.getLineCount()?(Rt=kt+1,Nt=mt.getLineMaxColumn(Rt)):(Rt=Bt.lineNumber,Nt=mt.getLineMaxColumn(Bt.lineNumber))}else Rt=It.endLineNumber,Nt=mt.getLineMaxColumn(Rt);let Ft=mt.getLineContent(kt);for(let Bt=kt+1;Bt<=Rt;Bt++){const Ut=mt.getLineContent(Bt),qt=mt.getLineFirstNonWhitespaceColumn(Bt);if(qt>=1){let Yt=!0;Ft===""&&(Yt=!1),Yt&&(Ft.charAt(Ft.length-1)===" "||Ft.charAt(Ft.length-1)==="	")&&(Yt=!1,Ft=Ft.replace(/[\s\uFEFF\xA0]+$/g," "));const Zt=Ut.substr(qt-1);Ft+=(Yt?" ":"")+Zt,Yt?Tt=Zt.length+1:Tt=Zt.length}else Tt=0}const Kt=new Range$2(kt,At,Rt,Nt);if(!Kt.isEmpty()){let Bt;It.isEmpty()?(vt.push(EditOperation.replace(Kt,Ft)),Bt=new Selection$1(Kt.startLineNumber-wt,Ft.length-Tt+1,kt-wt,Ft.length-Tt+1)):It.startLineNumber===It.endLineNumber?(vt.push(EditOperation.replace(Kt,Ft)),Bt=new Selection$1(It.startLineNumber-wt,It.startColumn,It.endLineNumber-wt,It.endColumn)):(vt.push(EditOperation.replace(Kt,Ft)),Bt=new Selection$1(It.startLineNumber-wt,It.startColumn,It.startLineNumber-wt,Ft.length-Pt)),Range$2.intersectRanges(Kt,ut)!==null?yt=Bt:St.push(Bt)}wt+=Kt.endLineNumber-Kt.startLineNumber}St.unshift(yt),ot.pushUndoStop(),ot.executeEdits(this.id,vt,St),ot.pushUndoStop()}}class TransposeAction extends EditorAction{constructor(){super({id:"editor.action.transpose",label:localize("editor.transpose","Transpose characters around the cursor"),alias:"Transpose characters around the cursor",precondition:EditorContextKeys.writable})}run(nt,ot){const rt=ot.getSelections();if(rt===null)return;const ut=ot.getModel();if(ut===null)return;const gt=[];for(let pt=0,mt=rt.length;pt<mt;pt++){const vt=rt[pt];if(!vt.isEmpty())continue;const St=vt.getStartPosition(),yt=ut.getLineMaxColumn(St.lineNumber);if(St.column>=yt){if(St.lineNumber===ut.getLineCount())continue;const wt=new Range$2(St.lineNumber,Math.max(1,St.column-1),St.lineNumber+1,1),Lt=ut.getValueInRange(wt).split("").reverse().join("");gt.push(new ReplaceCommand(new Selection$1(St.lineNumber,Math.max(1,St.column-1),St.lineNumber+1,1),Lt))}else{const wt=new Range$2(St.lineNumber,Math.max(1,St.column-1),St.lineNumber,St.column+1),Lt=ut.getValueInRange(wt).split("").reverse().join("");gt.push(new ReplaceCommandThatPreservesSelection(wt,Lt,new Selection$1(St.lineNumber,St.column+1,St.lineNumber,St.column+1)))}}ot.pushUndoStop(),ot.executeCommands(this.id,gt),ot.pushUndoStop()}}class AbstractCaseAction extends EditorAction{run(nt,ot){const rt=ot.getSelections();if(rt===null)return;const ut=ot.getModel();if(ut===null)return;const gt=ot.getOption(125),pt=[];for(const mt of rt)if(mt.isEmpty()){const vt=mt.getStartPosition(),St=ot.getConfiguredWordAtPosition(vt);if(!St)continue;const yt=new Range$2(vt.lineNumber,St.startColumn,vt.lineNumber,St.endColumn),wt=ut.getValueInRange(yt);pt.push(EditOperation.replace(yt,this._modifyText(wt,gt)))}else{const vt=ut.getValueInRange(mt);pt.push(EditOperation.replace(mt,this._modifyText(vt,gt)))}ot.pushUndoStop(),ot.executeEdits(this.id,pt),ot.pushUndoStop()}}class UpperCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToUppercase",label:localize("editor.transformToUppercase","Transform to Uppercase"),alias:"Transform to Uppercase",precondition:EditorContextKeys.writable})}_modifyText(nt,ot){return nt.toLocaleUpperCase()}}class LowerCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToLowercase",label:localize("editor.transformToLowercase","Transform to Lowercase"),alias:"Transform to Lowercase",precondition:EditorContextKeys.writable})}_modifyText(nt,ot){return nt.toLocaleLowerCase()}}class BackwardsCompatibleRegExp{constructor(nt,ot){this._pattern=nt,this._flags=ot,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch{}}return this._actual}isSupported(){return this.get()!==null}}class TitleCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToTitlecase",label:localize("editor.transformToTitlecase","Transform to Title Case"),alias:"Transform to Title Case",precondition:EditorContextKeys.writable})}_modifyText(nt,ot){const rt=TitleCaseAction.titleBoundary.get();return rt?nt.toLocaleLowerCase().replace(rt,ut=>ut.toLocaleUpperCase()):nt}}TitleCaseAction.titleBoundary=new BackwardsCompatibleRegExp("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu");class SnakeCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToSnakecase",label:localize("editor.transformToSnakecase","Transform to Snake Case"),alias:"Transform to Snake Case",precondition:EditorContextKeys.writable})}_modifyText(nt,ot){const rt=SnakeCaseAction.caseBoundary.get(),ut=SnakeCaseAction.singleLetters.get();return!rt||!ut?nt:nt.replace(rt,"$1_$2").replace(ut,"$1_$2$3").toLocaleLowerCase()}}SnakeCaseAction.caseBoundary=new BackwardsCompatibleRegExp("(\\p{Ll})(\\p{Lu})","gmu");SnakeCaseAction.singleLetters=new BackwardsCompatibleRegExp("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu");class CamelCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToCamelcase",label:localize("editor.transformToCamelcase","Transform to Camel Case"),alias:"Transform to Camel Case",precondition:EditorContextKeys.writable})}_modifyText(nt,ot){const rt=CamelCaseAction.wordBoundary.get();if(!rt)return nt;const ut=nt.split(rt);return ut.shift()+ut.map(pt=>pt.substring(0,1).toLocaleUpperCase()+pt.substring(1)).join("")}}CamelCaseAction.wordBoundary=new BackwardsCompatibleRegExp("[_\\s-]","gm");class KebabCaseAction extends AbstractCaseAction{static isSupported(){return[this.caseBoundary,this.singleLetters,this.underscoreBoundary].every(ot=>ot.isSupported())}constructor(){super({id:"editor.action.transformToKebabcase",label:localize("editor.transformToKebabcase","Transform to Kebab Case"),alias:"Transform to Kebab Case",precondition:EditorContextKeys.writable})}_modifyText(nt,ot){const rt=KebabCaseAction.caseBoundary.get(),ut=KebabCaseAction.singleLetters.get(),gt=KebabCaseAction.underscoreBoundary.get();return!rt||!ut||!gt?nt:nt.replace(gt,"$1-$3").replace(rt,"$1-$2").replace(ut,"$1-$2").toLocaleLowerCase()}}KebabCaseAction.caseBoundary=new BackwardsCompatibleRegExp("(\\p{Ll})(\\p{Lu})","gmu");KebabCaseAction.singleLetters=new BackwardsCompatibleRegExp("(\\p{Lu}|\\p{N})(\\p{Lu}\\p{Ll})","gmu");KebabCaseAction.underscoreBoundary=new BackwardsCompatibleRegExp("(\\S)(_)(\\S)","gm");registerEditorAction(CopyLinesUpAction);registerEditorAction(CopyLinesDownAction);registerEditorAction(DuplicateSelectionAction);registerEditorAction(MoveLinesUpAction);registerEditorAction(MoveLinesDownAction);registerEditorAction(SortLinesAscendingAction);registerEditorAction(SortLinesDescendingAction);registerEditorAction(DeleteDuplicateLinesAction);registerEditorAction(TrimTrailingWhitespaceAction);registerEditorAction(DeleteLinesAction);registerEditorAction(IndentLinesAction);registerEditorAction(OutdentLinesAction);registerEditorAction(InsertLineBeforeAction);registerEditorAction(InsertLineAfterAction);registerEditorAction(DeleteAllLeftAction);registerEditorAction(DeleteAllRightAction);registerEditorAction(JoinLinesAction);registerEditorAction(TransposeAction);registerEditorAction(UpperCaseAction);registerEditorAction(LowerCaseAction);SnakeCaseAction.caseBoundary.isSupported()&&SnakeCaseAction.singleLetters.isSupported()&&registerEditorAction(SnakeCaseAction);CamelCaseAction.wordBoundary.isSupported()&&registerEditorAction(CamelCaseAction);TitleCaseAction.titleBoundary.isSupported()&&registerEditorAction(TitleCaseAction);KebabCaseAction.isSupported()&&registerEditorAction(KebabCaseAction);const linkedEditing="";var __decorate$r=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$r=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$i=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE=new RawContextKey("LinkedEditingInputVisible",!1),DECORATION_CLASS_NAME="linked-editing-decoration";let LinkedEditingContribution=class tr extends Disposable{static get(nt){return nt.getContribution(tr.ID)}constructor(nt,ot,rt,ut,gt){super(),this.languageConfigurationService=ut,this._syncRangesToken=0,this._localToDispose=this._register(new DisposableStore),this._editor=nt,this._providers=rt.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE.bindTo(ot),this._debounceInformation=gt.for(this._providers,"Linked Editing",{max:200}),this._currentDecorations=this._editor.createDecorationsCollection(),this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new DisposableStore),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequest=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel(()=>this.reinitialize(!0))),this._register(this._editor.onDidChangeConfiguration(pt=>{(pt.hasChanged(67)||pt.hasChanged(88))&&this.reinitialize(!1)})),this._register(this._providers.onDidChange(()=>this.reinitialize(!1))),this._register(this._editor.onDidChangeModelLanguage(()=>this.reinitialize(!0))),this.reinitialize(!0)}reinitialize(nt){const ot=this._editor.getModel(),rt=ot!==null&&(this._editor.getOption(67)||this._editor.getOption(88))&&this._providers.has(ot);if(rt===this._enabled&&!nt||(this._enabled=rt,this.clearRanges(),this._localToDispose.clear(),!rt||ot===null))return;this._localToDispose.add(Event.runAndSubscribe(ot.onDidChangeLanguageConfiguration,()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(ot.getLanguageId()).getWordDefinition()}));const ut=new Delayer(this._debounceInformation.get(ot)),gt=()=>{var vt;this._rangeUpdateTriggerPromise=ut.trigger(()=>this.updateRanges(),(vt=this._debounceDuration)!==null&&vt!==void 0?vt:this._debounceInformation.get(ot))},pt=new Delayer(0),mt=vt=>{this._rangeSyncTriggerPromise=pt.trigger(()=>this._syncRanges(vt))};this._localToDispose.add(this._editor.onDidChangeCursorPosition(()=>{gt()})),this._localToDispose.add(this._editor.onDidChangeModelContent(vt=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const St=this._currentDecorations.getRange(0);if(St&&vt.changes.every(yt=>St.intersectRanges(yt.range))){mt(this._syncRangesToken);return}}gt()})),this._localToDispose.add({dispose:()=>{ut.dispose(),pt.dispose()}}),this.updateRanges()}_syncRanges(nt){if(!this._editor.hasModel()||nt!==this._syncRangesToken||this._currentDecorations.length===0)return;const ot=this._editor.getModel(),rt=this._currentDecorations.getRange(0);if(!rt||rt.startLineNumber!==rt.endLineNumber)return this.clearRanges();const ut=ot.getValueInRange(rt);if(this._currentWordPattern){const pt=ut.match(this._currentWordPattern);if((pt?pt[0].length:0)!==ut.length)return this.clearRanges()}const gt=[];for(let pt=1,mt=this._currentDecorations.length;pt<mt;pt++){const vt=this._currentDecorations.getRange(pt);if(vt)if(vt.startLineNumber!==vt.endLineNumber)gt.push({range:vt,text:ut});else{let St=ot.getValueInRange(vt),yt=ut,wt=vt.startColumn,Lt=vt.endColumn;const xt=commonPrefixLength(St,yt);wt+=xt,St=St.substr(xt),yt=yt.substr(xt);const It=commonSuffixLength(St,yt);Lt-=It,St=St.substr(0,St.length-It),yt=yt.substr(0,yt.length-It),(wt!==Lt||yt.length!==0)&&gt.push({range:new Range$2(vt.startLineNumber,wt,vt.endLineNumber,Lt),text:yt})}}if(gt.length!==0)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const pt=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",gt),this._editor._getViewModel().setPrevEditOperationType(pt)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations.clear(),this._currentRequest&&(this._currentRequest.cancel(),this._currentRequest=null,this._currentRequestPosition=null)}updateRanges(nt=!1){return __awaiter$i(this,void 0,void 0,function*(){if(!this._editor.hasModel()){this.clearRanges();return}const ot=this._editor.getPosition();if(!this._enabled&&!nt||this._editor.getSelections().length>1){this.clearRanges();return}const rt=this._editor.getModel(),ut=rt.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===ut){if(ot.equals(this._currentRequestPosition))return;if(this._currentDecorations.length>0){const pt=this._currentDecorations.getRange(0);if(pt&&pt.containsPosition(ot))return}}this.clearRanges(),this._currentRequestPosition=ot,this._currentRequestModelVersion=ut;const gt=createCancelablePromise(pt=>__awaiter$i(this,void 0,void 0,function*(){try{const mt=new StopWatch(!1),vt=yield getLinkedEditingRanges(this._providers,rt,ot,pt);if(this._debounceInformation.update(rt,mt.elapsed()),gt!==this._currentRequest||(this._currentRequest=null,ut!==rt.getVersionId()))return;let St=[];vt!=null&&vt.ranges&&(St=vt.ranges),this._currentWordPattern=(vt==null?void 0:vt.wordPattern)||this._languageWordPattern;let yt=!1;for(let Lt=0,xt=St.length;Lt<xt;Lt++)if(Range$2.containsPosition(St[Lt],ot)){if(yt=!0,Lt!==0){const It=St[Lt];St.splice(Lt,1),St.unshift(It)}break}if(!yt){this.clearRanges();return}const wt=St.map(Lt=>({range:Lt,options:tr.DECORATION}));this._visibleContextKey.set(!0),this._currentDecorations.set(wt),this._syncRangesToken++}catch(mt){isCancellationError(mt)||onUnexpectedError(mt),(this._currentRequest===gt||!this._currentRequest)&&this.clearRanges()}}));return this._currentRequest=gt,gt})}};LinkedEditingContribution.ID="editor.contrib.linkedEditing";LinkedEditingContribution.DECORATION=ModelDecorationOptions.register({description:"linked-editing",stickiness:0,className:DECORATION_CLASS_NAME});LinkedEditingContribution=__decorate$r([__param$r(1,IContextKeyService),__param$r(2,ILanguageFeaturesService),__param$r(3,ILanguageConfigurationService),__param$r(4,ILanguageFeatureDebounceService)],LinkedEditingContribution);class LinkedEditingAction extends EditorAction{constructor(){super({id:"editor.action.linkedEditing",label:localize("linkedEditing.label","Start Linked Editing"),alias:"Start Linked Editing",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasRenameProvider),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3132,weight:100}})}runCommand(nt,ot){const rt=nt.get(ICodeEditorService),[ut,gt]=Array.isArray(ot)&&ot||[void 0,void 0];return URI.isUri(ut)&&Position$1.isIPosition(gt)?rt.openCodeEditor({resource:ut},rt.getActiveCodeEditor()).then(pt=>{pt&&(pt.setPosition(gt),pt.invokeWithinContext(mt=>(this.reportTelemetry(mt,pt),this.run(mt,pt))))},onUnexpectedError):super.runCommand(nt,ot)}run(nt,ot){const rt=LinkedEditingContribution.get(ot);return rt?Promise.resolve(rt.updateRanges(!0)):Promise.resolve()}}const LinkedEditingCommand=EditorCommand.bindToContribution(LinkedEditingContribution.get);registerEditorCommand(new LinkedEditingCommand({id:"cancelLinkedEditingInput",precondition:CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE,handler:ct=>ct.clearRanges(),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,weight:100+99,primary:9,secondary:[1033]}}));function getLinkedEditingRanges(ct,nt,ot,rt){const ut=ct.ordered(nt);return first(ut.map(gt=>()=>__awaiter$i(this,void 0,void 0,function*(){try{return yield gt.provideLinkedEditingRanges(nt,ot,rt)}catch(pt){onUnexpectedExternalError(pt);return}})),gt=>!!gt&&isNonEmptyArray(gt==null?void 0:gt.ranges))}registerColor("editor.linkedEditingBackground",{dark:Color.fromHex("#f00").transparent(.3),light:Color.fromHex("#f00").transparent(.3),hcDark:Color.fromHex("#f00").transparent(.3),hcLight:Color.white},localize("editorLinkedEditingBackground","Background color when the editor auto renames on type."));registerModelAndPositionCommand("_executeLinkedEditingProvider",(ct,nt,ot)=>{const{linkedEditingRangeProvider:rt}=ct.get(ILanguageFeaturesService);return getLinkedEditingRanges(rt,nt,ot,CancellationToken.None)});registerEditorContribution(LinkedEditingContribution.ID,LinkedEditingContribution,1);registerEditorAction(LinkedEditingAction);const links="";var __awaiter$h=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let Link$1=class{constructor(nt,ot){this._link=nt,this._provider=ot}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}resolve(nt){return __awaiter$h(this,void 0,void 0,function*(){return this._link.url?this._link.url:typeof this._provider.resolveLink=="function"?Promise.resolve(this._provider.resolveLink(this._link,nt)).then(ot=>(this._link=ot||this._link,this._link.url?this.resolve(nt):Promise.reject(new Error("missing")))):Promise.reject(new Error("missing"))})}};class LinksList{constructor(nt){this._disposables=new DisposableStore;let ot=[];for(const[rt,ut]of nt){const gt=rt.links.map(pt=>new Link$1(pt,ut));ot=LinksList._union(ot,gt),isDisposable(rt)&&this._disposables.add(rt)}this.links=ot}dispose(){this._disposables.dispose(),this.links.length=0}static _union(nt,ot){const rt=[];let ut,gt,pt,mt;for(ut=0,pt=0,gt=nt.length,mt=ot.length;ut<gt&&pt<mt;){const vt=nt[ut],St=ot[pt];if(Range$2.areIntersectingOrTouching(vt.range,St.range)){ut++;continue}Range$2.compareRangesUsingStarts(vt.range,St.range)<0?(rt.push(vt),ut++):(rt.push(St),pt++)}for(;ut<gt;ut++)rt.push(nt[ut]);for(;pt<mt;pt++)rt.push(ot[pt]);return rt}}function getLinks(ct,nt,ot){const rt=[],ut=ct.ordered(nt).reverse().map((gt,pt)=>Promise.resolve(gt.provideLinks(nt,ot)).then(mt=>{mt&&(rt[pt]=[mt,gt])},onUnexpectedExternalError));return Promise.all(ut).then(()=>{const gt=new LinksList(coalesce(rt));return ot.isCancellationRequested?(gt.dispose(),new LinksList([])):gt})}CommandsRegistry.registerCommand("_executeLinkProvider",(ct,...nt)=>__awaiter$h(void 0,void 0,void 0,function*(){let[ot,rt]=nt;assertType(ot instanceof URI),typeof rt!="number"&&(rt=0);const{linkProvider:ut}=ct.get(ILanguageFeaturesService),gt=ct.get(IModelService).getModel(ot);if(!gt)return[];const pt=yield getLinks(ut,gt,CancellationToken.None);if(!pt)return[];for(let vt=0;vt<Math.min(rt,pt.links.length);vt++)yield pt.links[vt].resolve(CancellationToken.None);const mt=pt.links.slice(0);return pt.dispose(),mt}));var __decorate$q=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$q=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$g=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let LinkDetector=class Ar extends Disposable{static get(nt){return nt.getContribution(Ar.ID)}constructor(nt,ot,rt,ut,gt){super(),this.editor=nt,this.openerService=ot,this.notificationService=rt,this.languageFeaturesService=ut,this.providers=this.languageFeaturesService.linkProvider,this.debounceInformation=gt.for(this.providers,"Links",{min:1e3,max:4e3}),this.computeLinks=this._register(new RunOnceScheduler(()=>this.computeLinksNow(),1e3)),this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null;const pt=this._register(new ClickLinkGesture(nt));this._register(pt.onMouseMoveOrRelevantKeyDown(([mt,vt])=>{this._onEditorMouseMove(mt,vt)})),this._register(pt.onExecute(mt=>{this.onEditorMouseUp(mt)})),this._register(pt.onCancel(mt=>{this.cleanUpActiveLinkDecoration()})),this._register(nt.onDidChangeConfiguration(mt=>{mt.hasChanged(68)&&(this.updateDecorations([]),this.stop(),this.computeLinks.schedule(0))})),this._register(nt.onDidChangeModelContent(mt=>{this.editor.hasModel()&&this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()))})),this._register(nt.onDidChangeModel(mt=>{this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.computeLinks.schedule(0)})),this._register(nt.onDidChangeModelLanguage(mt=>{this.stop(),this.computeLinks.schedule(0)})),this._register(this.providers.onDidChange(mt=>{this.stop(),this.computeLinks.schedule(0)})),this.computeLinks.schedule(0)}computeLinksNow(){return __awaiter$g(this,void 0,void 0,function*(){if(!this.editor.hasModel()||!this.editor.getOption(68))return;const nt=this.editor.getModel();if(this.providers.has(nt)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=createCancelablePromise(ot=>getLinks(this.providers,nt,ot));try{const ot=new StopWatch(!1);if(this.activeLinksList=yield this.computePromise,this.debounceInformation.update(nt,ot.elapsed()),nt.isDisposed())return;this.updateDecorations(this.activeLinksList.links)}catch(ot){onUnexpectedError(ot)}finally{this.computePromise=null}}})}updateDecorations(nt){const ot=this.editor.getOption(75)==="altKey",rt=[],ut=Object.keys(this.currentOccurrences);for(const pt of ut){const mt=this.currentOccurrences[pt];rt.push(mt.decorationId)}const gt=[];if(nt)for(const pt of nt)gt.push(LinkOccurrence.decoration(pt,ot));this.editor.changeDecorations(pt=>{const mt=pt.deltaDecorations(rt,gt);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let vt=0,St=mt.length;vt<St;vt++){const yt=new LinkOccurrence(nt[vt],mt[vt]);this.currentOccurrences[yt.decorationId]=yt}})}_onEditorMouseMove(nt,ot){const rt=this.editor.getOption(75)==="altKey";if(this.isEnabled(nt,ot)){this.cleanUpActiveLinkDecoration();const ut=this.getLinkOccurrence(nt.target.position);ut&&this.editor.changeDecorations(gt=>{ut.activate(gt,rt),this.activeLinkDecorationId=ut.decorationId})}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const nt=this.editor.getOption(75)==="altKey";if(this.activeLinkDecorationId){const ot=this.currentOccurrences[this.activeLinkDecorationId];ot&&this.editor.changeDecorations(rt=>{ot.deactivate(rt,nt)}),this.activeLinkDecorationId=null}}onEditorMouseUp(nt){if(!this.isEnabled(nt))return;const ot=this.getLinkOccurrence(nt.target.position);ot&&this.openLinkOccurrence(ot,nt.hasSideBySideModifier,!0)}openLinkOccurrence(nt,ot,rt=!1){if(!this.openerService)return;const{link:ut}=nt;ut.resolve(CancellationToken.None).then(gt=>{if(typeof gt=="string"&&this.editor.hasModel()){const pt=this.editor.getModel().uri;if(pt.scheme===Schemas.file&&gt.startsWith(`${Schemas.file}:`)){const mt=URI.parse(gt);if(mt.scheme===Schemas.file){const vt=originalFSPath(mt);let St=null;vt.startsWith("/./")?St=`.${vt.substr(1)}`:vt.startsWith("//./")&&(St=`.${vt.substr(2)}`),St&&(gt=joinPath(pt,St))}}}return this.openerService.open(gt,{openToSide:ot,fromUserGesture:rt,allowContributedOpeners:!0,allowCommands:!0,fromWorkspace:!0})},gt=>{const pt=gt instanceof Error?gt.message:gt;pt==="invalid"?this.notificationService.warn(localize("invalid.url","Failed to open this link because it is not well-formed: {0}",ut.url.toString())):pt==="missing"?this.notificationService.warn(localize("missing.url","Failed to open this link because its target is missing.")):onUnexpectedError(gt)})}getLinkOccurrence(nt){if(!this.editor.hasModel()||!nt)return null;const ot=this.editor.getModel().getDecorationsInRange({startLineNumber:nt.lineNumber,startColumn:nt.column,endLineNumber:nt.lineNumber,endColumn:nt.column},0,!0);for(const rt of ot){const ut=this.currentOccurrences[rt.id];if(ut)return ut}return null}isEnabled(nt,ot){return!!(nt.target.type===6&&(nt.hasTriggerModifier||ot&&ot.keyCodeIsTriggerKey))}stop(){var nt;this.computeLinks.cancel(),this.activeLinksList&&((nt=this.activeLinksList)===null||nt===void 0||nt.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop()}};LinkDetector.ID="editor.linkDetector";LinkDetector=__decorate$q([__param$q(1,IOpenerService),__param$q(2,INotificationService),__param$q(3,ILanguageFeaturesService),__param$q(4,ILanguageFeatureDebounceService)],LinkDetector);const decoration={general:ModelDecorationOptions.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),active:ModelDecorationOptions.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"})};class LinkOccurrence{static decoration(nt,ot){return{range:nt.range,options:LinkOccurrence._getOptions(nt,ot,!1)}}static _getOptions(nt,ot,rt){const ut=Object.assign({},rt?decoration.active:decoration.general);return ut.hoverMessage=getHoverMessage(nt,ot),ut}constructor(nt,ot){this.link=nt,this.decorationId=ot}activate(nt,ot){nt.changeDecorationOptions(this.decorationId,LinkOccurrence._getOptions(this.link,ot,!0))}deactivate(nt,ot){nt.changeDecorationOptions(this.decorationId,LinkOccurrence._getOptions(this.link,ot,!1))}}function getHoverMessage(ct,nt){const ot=ct.url&&/^command:/i.test(ct.url.toString()),rt=ct.tooltip?ct.tooltip:ot?localize("links.navigate.executeCmd","Execute command"):localize("links.navigate.follow","Follow link"),ut=nt?isMacintosh?localize("links.navigate.kb.meta.mac","cmd + click"):localize("links.navigate.kb.meta","ctrl + click"):isMacintosh?localize("links.navigate.kb.alt.mac","option + click"):localize("links.navigate.kb.alt","alt + click");if(ct.url){let gt="";if(/^command:/i.test(ct.url.toString())){const mt=ct.url.toString().match(/^command:([^?#]+)/);if(mt){const vt=mt[1];gt=localize("tooltip.explanation","Execute command {0}",vt)}}return new MarkdownString("",!0).appendLink(ct.url.toString(!0).replace(/ /g,"%20"),rt,gt).appendMarkdown(` (${ut})`)}else return new MarkdownString().appendText(`${rt} (${ut})`)}class OpenLinkAction extends EditorAction{constructor(){super({id:"editor.action.openLink",label:localize("label","Open Link"),alias:"Open Link",precondition:void 0})}run(nt,ot){const rt=LinkDetector.get(ot);if(!rt||!ot.hasModel())return;const ut=ot.getSelections();for(const gt of ut){const pt=rt.getLinkOccurrence(gt.getEndPosition());pt&&rt.openLinkOccurrence(pt,!1)}}}registerEditorContribution(LinkDetector.ID,LinkDetector,1);registerEditorAction(OpenLinkAction);class LongLinesHelper extends Disposable{constructor(nt){super(),this._editor=nt,this._register(this._editor.onMouseDown(ot=>{const rt=this._editor.getOption(112);rt>=0&&ot.target.type===6&&ot.target.position.column>=rt&&this._editor.updateOptions({stopRenderingLineAfter:-1})}))}}LongLinesHelper.ID="editor.contrib.longLinesHelper";registerEditorContribution(LongLinesHelper.ID,LongLinesHelper,2);const highlightDecorations="",wordHighlightBackground=registerColor("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hcDark:null,hcLight:null},localize("wordHighlight","Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hcDark:null,hcLight:null},localize("wordHighlightStrong","Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editor.wordHighlightTextBackground",{light:wordHighlightBackground,dark:wordHighlightBackground,hcDark:wordHighlightBackground,hcLight:wordHighlightBackground},localize("wordHighlightText","Background color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0);const wordHighlightBorder=registerColor("editor.wordHighlightBorder",{light:null,dark:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("wordHighlightBorder","Border color of a symbol during read-access, like reading a variable."));registerColor("editor.wordHighlightStrongBorder",{light:null,dark:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("wordHighlightStrongBorder","Border color of a symbol during write-access, like writing to a variable."));registerColor("editor.wordHighlightTextBorder",{light:wordHighlightBorder,dark:wordHighlightBorder,hcDark:wordHighlightBorder,hcLight:wordHighlightBorder},localize("wordHighlightTextBorder","Border color of a textual occurrence for a symbol."));const overviewRulerWordHighlightForeground=registerColor("editorOverviewRuler.wordHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hcDark:"#A0A0A0CC",hcLight:"#A0A0A0CC"},localize("overviewRulerWordHighlightForeground","Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),overviewRulerWordHighlightStrongForeground=registerColor("editorOverviewRuler.wordHighlightStrongForeground",{dark:"#C0A0C0CC",light:"#C0A0C0CC",hcDark:"#C0A0C0CC",hcLight:"#C0A0C0CC"},localize("overviewRulerWordHighlightStrongForeground","Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),overviewRulerWordHighlightTextForeground=registerColor("editorOverviewRuler.wordHighlightTextForeground",{dark:overviewRulerSelectionHighlightForeground,light:overviewRulerSelectionHighlightForeground,hcDark:overviewRulerSelectionHighlightForeground,hcLight:overviewRulerSelectionHighlightForeground},localize("overviewRulerWordHighlightTextForeground","Overview ruler marker color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0),_WRITE_OPTIONS=ModelDecorationOptions.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:themeColorFromId(overviewRulerWordHighlightStrongForeground),position:OverviewRulerLane.Center},minimap:{color:themeColorFromId(minimapSelectionOccurrenceHighlight),position:MinimapPosition.Inline}}),_TEXT_OPTIONS=ModelDecorationOptions.register({description:"word-highlight-text",stickiness:1,className:"wordHighlightText",overviewRuler:{color:themeColorFromId(overviewRulerWordHighlightTextForeground),position:OverviewRulerLane.Center},minimap:{color:themeColorFromId(minimapSelectionOccurrenceHighlight),position:MinimapPosition.Inline}}),_SELECTION_HIGHLIGHT_OPTIONS=ModelDecorationOptions.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",overviewRuler:{color:themeColorFromId(overviewRulerSelectionHighlightForeground),position:OverviewRulerLane.Center},minimap:{color:themeColorFromId(minimapSelectionOccurrenceHighlight),position:MinimapPosition.Inline}}),_SELECTION_HIGHLIGHT_OPTIONS_NO_OVERVIEW=ModelDecorationOptions.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"}),_REGULAR_OPTIONS=ModelDecorationOptions.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:themeColorFromId(overviewRulerWordHighlightForeground),position:OverviewRulerLane.Center},minimap:{color:themeColorFromId(minimapSelectionOccurrenceHighlight),position:MinimapPosition.Inline}});function getHighlightDecorationOptions(ct){return ct===DocumentHighlightKind$1.Write?_WRITE_OPTIONS:ct===DocumentHighlightKind$1.Text?_TEXT_OPTIONS:_REGULAR_OPTIONS}function getSelectionHighlightDecorationOptions(ct){return ct?_SELECTION_HIGHLIGHT_OPTIONS_NO_OVERVIEW:_SELECTION_HIGHLIGHT_OPTIONS}registerThemingParticipant((ct,nt)=>{const ot=ct.getColor(editorSelectionHighlight);ot&&nt.addRule(`.monaco-editor .selectionHighlight { background-color: ${ot.transparent(.5)}; }`)});var __decorate$p=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$p=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};function announceCursorChange(ct,nt){const ot=nt.filter(rt=>!ct.find(ut=>ut.equals(rt)));if(ot.length>=1){const rt=ot.map(gt=>`line ${gt.viewState.position.lineNumber} column ${gt.viewState.position.column}`).join(", "),ut=ot.length===1?localize("cursorAdded","Cursor added: {0}",rt):localize("cursorsAdded","Cursors added: {0}",rt);status(ut)}}class InsertCursorAbove extends EditorAction{constructor(){super({id:"editor.action.insertCursorAbove",label:localize("mutlicursor.insertAbove","Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miInsertCursorAbove",comment:["&& denotes a mnemonic"]},"&&Add Cursor Above"),order:2}})}run(nt,ot,rt){if(!ot.hasModel())return;let ut=!0;rt&&rt.logicalLine===!1&&(ut=!1);const gt=ot._getViewModel();if(gt.cursorConfig.readOnly)return;gt.model.pushStackElement();const pt=gt.getCursorStates();gt.setCursorStates(rt.source,3,CursorMoveCommands.addCursorUp(gt,pt,ut)),gt.revealTopMostCursor(rt.source),announceCursorChange(pt,gt.getCursorStates())}}class InsertCursorBelow extends EditorAction{constructor(){super({id:"editor.action.insertCursorBelow",label:localize("mutlicursor.insertBelow","Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miInsertCursorBelow",comment:["&& denotes a mnemonic"]},"A&&dd Cursor Below"),order:3}})}run(nt,ot,rt){if(!ot.hasModel())return;let ut=!0;rt&&rt.logicalLine===!1&&(ut=!1);const gt=ot._getViewModel();if(gt.cursorConfig.readOnly)return;gt.model.pushStackElement();const pt=gt.getCursorStates();gt.setCursorStates(rt.source,3,CursorMoveCommands.addCursorDown(gt,pt,ut)),gt.revealBottomMostCursor(rt.source),announceCursorChange(pt,gt.getCursorStates())}}class InsertCursorAtEndOfEachLineSelected extends EditorAction{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:localize("mutlicursor.insertAtEndOfEachLineSelected","Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miInsertCursorAtEndOfEachLineSelected",comment:["&& denotes a mnemonic"]},"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(nt,ot,rt){if(!nt.isEmpty()){for(let ut=nt.startLineNumber;ut<nt.endLineNumber;ut++){const gt=ot.getLineMaxColumn(ut);rt.push(new Selection$1(ut,gt,ut,gt))}nt.endColumn>1&&rt.push(new Selection$1(nt.endLineNumber,nt.endColumn,nt.endLineNumber,nt.endColumn))}}run(nt,ot){if(!ot.hasModel())return;const rt=ot.getModel(),ut=ot.getSelections(),gt=ot._getViewModel(),pt=gt.getCursorStates(),mt=[];ut.forEach(vt=>this.getCursorsForSelection(vt,rt,mt)),mt.length>0&&ot.setSelections(mt),announceCursorChange(pt,gt.getCursorStates())}}class InsertCursorAtEndOfLineSelected extends EditorAction{constructor(){super({id:"editor.action.addCursorsToBottom",label:localize("mutlicursor.addCursorsToBottom","Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(nt,ot){if(!ot.hasModel())return;const rt=ot.getSelections(),ut=ot.getModel().getLineCount(),gt=[];for(let vt=rt[0].startLineNumber;vt<=ut;vt++)gt.push(new Selection$1(vt,rt[0].startColumn,vt,rt[0].endColumn));const pt=ot._getViewModel(),mt=pt.getCursorStates();gt.length>0&&ot.setSelections(gt),announceCursorChange(mt,pt.getCursorStates())}}class InsertCursorAtTopOfLineSelected extends EditorAction{constructor(){super({id:"editor.action.addCursorsToTop",label:localize("mutlicursor.addCursorsToTop","Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(nt,ot){if(!ot.hasModel())return;const rt=ot.getSelections(),ut=[];for(let mt=rt[0].startLineNumber;mt>=1;mt--)ut.push(new Selection$1(mt,rt[0].startColumn,mt,rt[0].endColumn));const gt=ot._getViewModel(),pt=gt.getCursorStates();ut.length>0&&ot.setSelections(ut),announceCursorChange(pt,gt.getCursorStates())}}class MultiCursorSessionResult{constructor(nt,ot,rt){this.selections=nt,this.revealRange=ot,this.revealScrollType=rt}}class MultiCursorSession{static create(nt,ot){if(!nt.hasModel())return null;const rt=ot.getState();if(!nt.hasTextFocus()&&rt.isRevealed&&rt.searchString.length>0)return new MultiCursorSession(nt,ot,!1,rt.searchString,rt.wholeWord,rt.matchCase,null);let ut=!1,gt,pt;const mt=nt.getSelections();mt.length===1&&mt[0].isEmpty()?(ut=!0,gt=!0,pt=!0):(gt=rt.wholeWord,pt=rt.matchCase);const vt=nt.getSelection();let St,yt=null;if(vt.isEmpty()){const wt=nt.getConfiguredWordAtPosition(vt.getStartPosition());if(!wt)return null;St=wt.word,yt=new Selection$1(vt.startLineNumber,wt.startColumn,vt.startLineNumber,wt.endColumn)}else St=nt.getModel().getValueInRange(vt).replace(/\r\n/g,`
`);return new MultiCursorSession(nt,ot,ut,St,gt,pt,yt)}constructor(nt,ot,rt,ut,gt,pt,mt){this._editor=nt,this.findController=ot,this.isDisconnectedFromFindController=rt,this.searchText=ut,this.wholeWord=gt,this.matchCase=pt,this.currentMatch=mt}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const nt=this._getNextMatch();if(!nt)return null;const ot=this._editor.getSelections();return new MultiCursorSessionResult(ot.concat(nt),nt,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const nt=this._getNextMatch();if(!nt)return null;const ot=this._editor.getSelections();return new MultiCursorSessionResult(ot.slice(0,ot.length-1).concat(nt),nt,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const ut=this.currentMatch;return this.currentMatch=null,ut}this.findController.highlightFindOptions();const nt=this._editor.getSelections(),ot=nt[nt.length-1],rt=this._editor.getModel().findNextMatch(this.searchText,ot.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(125):null,!1);return rt?new Selection$1(rt.range.startLineNumber,rt.range.startColumn,rt.range.endLineNumber,rt.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const nt=this._getPreviousMatch();if(!nt)return null;const ot=this._editor.getSelections();return new MultiCursorSessionResult(ot.concat(nt),nt,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const nt=this._getPreviousMatch();if(!nt)return null;const ot=this._editor.getSelections();return new MultiCursorSessionResult(ot.slice(0,ot.length-1).concat(nt),nt,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const ut=this.currentMatch;return this.currentMatch=null,ut}this.findController.highlightFindOptions();const nt=this._editor.getSelections(),ot=nt[nt.length-1],rt=this._editor.getModel().findPreviousMatch(this.searchText,ot.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(125):null,!1);return rt?new Selection$1(rt.range.startLineNumber,rt.range.startColumn,rt.range.endLineNumber,rt.range.endColumn):null}selectAll(nt){if(!this._editor.hasModel())return[];this.findController.highlightFindOptions();const ot=this._editor.getModel();return nt?ot.findMatches(this.searchText,nt,!1,this.matchCase,this.wholeWord?this._editor.getOption(125):null,!1,1073741824):ot.findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(125):null,!1,1073741824)}}class MultiCursorSelectionController extends Disposable{static get(nt){return nt.getContribution(MultiCursorSelectionController.ID)}constructor(nt){super(),this._sessionDispose=this._register(new DisposableStore),this._editor=nt,this._ignoreSelectionChange=!1,this._session=null}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(nt){if(!this._session){const ot=MultiCursorSession.create(this._editor,nt);if(!ot)return;this._session=ot;const rt={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(rt.wholeWordOverride=1,rt.matchCaseOverride=1,rt.isRegexOverride=2),nt.getState().change(rt,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection(ut=>{this._ignoreSelectionChange||this._endSession()})),this._sessionDispose.add(this._editor.onDidBlurEditorText(()=>{this._endSession()})),this._sessionDispose.add(nt.getState().onFindReplaceStateChange(ut=>{(ut.matchCase||ut.wholeWord)&&this._endSession()}))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const nt={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(nt,!1)}this._session=null}_setSelections(nt){this._ignoreSelectionChange=!0,this._editor.setSelections(nt),this._ignoreSelectionChange=!1}_expandEmptyToWord(nt,ot){if(!ot.isEmpty())return ot;const rt=this._editor.getConfiguredWordAtPosition(ot.getStartPosition());return rt?new Selection$1(ot.startLineNumber,rt.startColumn,ot.startLineNumber,rt.endColumn):ot}_applySessionResult(nt){nt&&(this._setSelections(nt.selections),nt.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(nt.revealRange,nt.revealScrollType))}getSession(nt){return this._session}addSelectionToNextFindMatch(nt){if(this._editor.hasModel()){if(!this._session){const ot=this._editor.getSelections();if(ot.length>1){const ut=nt.getState().matchCase;if(!modelRangesContainSameText(this._editor.getModel(),ot,ut)){const pt=this._editor.getModel(),mt=[];for(let vt=0,St=ot.length;vt<St;vt++)mt[vt]=this._expandEmptyToWord(pt,ot[vt]);this._editor.setSelections(mt);return}}}this._beginSessionIfNeeded(nt),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(nt){this._beginSessionIfNeeded(nt),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(nt){this._beginSessionIfNeeded(nt),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(nt){this._beginSessionIfNeeded(nt),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(nt){if(!this._editor.hasModel())return;let ot=null;const rt=nt.getState();if(rt.isRevealed&&rt.searchString.length>0&&rt.isRegex){const ut=this._editor.getModel();rt.searchScope?ot=ut.findMatches(rt.searchString,rt.searchScope,rt.isRegex,rt.matchCase,rt.wholeWord?this._editor.getOption(125):null,!1,1073741824):ot=ut.findMatches(rt.searchString,!0,rt.isRegex,rt.matchCase,rt.wholeWord?this._editor.getOption(125):null,!1,1073741824)}else{if(this._beginSessionIfNeeded(nt),!this._session)return;ot=this._session.selectAll(rt.searchScope)}if(ot.length>0){const ut=this._editor.getSelection();for(let gt=0,pt=ot.length;gt<pt;gt++){const mt=ot[gt];if(mt.range.intersectRanges(ut)){ot[gt]=ot[0],ot[0]=mt;break}}this._setSelections(ot.map(gt=>new Selection$1(gt.range.startLineNumber,gt.range.startColumn,gt.range.endLineNumber,gt.range.endColumn)))}}}MultiCursorSelectionController.ID="editor.contrib.multiCursorController";class MultiCursorSelectionControllerAction extends EditorAction{run(nt,ot){const rt=MultiCursorSelectionController.get(ot);if(!rt)return;const ut=ot._getViewModel();if(ut){const gt=ut.getCursorStates(),pt=CommonFindController.get(ot);if(pt)this._run(rt,pt);else{const mt=nt.get(IInstantiationService).createInstance(CommonFindController,ot);this._run(rt,mt),mt.dispose()}announceCursorChange(gt,ut.getCursorStates())}}}class AddSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:localize("addSelectionToNextFindMatch","Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:2082,weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miAddSelectionToNextFindMatch",comment:["&& denotes a mnemonic"]},"Add &&Next Occurrence"),order:5}})}_run(nt,ot){nt.addSelectionToNextFindMatch(ot)}}class AddSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:localize("addSelectionToPreviousFindMatch","Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miAddSelectionToPreviousFindMatch",comment:["&& denotes a mnemonic"]},"Add P&&revious Occurrence"),order:6}})}_run(nt,ot){nt.addSelectionToPreviousFindMatch(ot)}}class MoveSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:localize("moveSelectionToNextFindMatch","Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:KeyChord(2089,2082),weight:100}})}_run(nt,ot){nt.moveSelectionToNextFindMatch(ot)}}class MoveSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:localize("moveSelectionToPreviousFindMatch","Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(nt,ot){nt.moveSelectionToPreviousFindMatch(ot)}}class SelectHighlightsAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.selectHighlights",label:localize("selectAllOccurrencesOfFindMatch","Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:3114,weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miSelectHighlights",comment:["&& denotes a mnemonic"]},"Select All &&Occurrences"),order:7}})}_run(nt,ot){nt.selectAll(ot)}}class CompatChangeAll extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.changeAll",label:localize("changeAll.label","Change All Occurrences"),alias:"Change All Occurrences",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.editorTextFocus),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(nt,ot){nt.selectAll(ot)}}class SelectionHighlighterState{constructor(nt,ot,rt,ut,gt){this._model=nt,this._searchText=ot,this._matchCase=rt,this._wordSeparators=ut,this._modelVersionId=this._model.getVersionId(),this._cachedFindMatches=null,gt&&this._model===gt._model&&this._searchText===gt._searchText&&this._matchCase===gt._matchCase&&this._wordSeparators===gt._wordSeparators&&this._modelVersionId===gt._modelVersionId&&(this._cachedFindMatches=gt._cachedFindMatches)}findMatches(){return this._cachedFindMatches===null&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map(nt=>nt.range),this._cachedFindMatches.sort(Range$2.compareRangesUsingStarts)),this._cachedFindMatches}}let SelectionHighlighter=class Nr extends Disposable{constructor(nt,ot){super(),this._languageFeaturesService=ot,this.editor=nt,this._isEnabled=nt.getOption(103),this._decorations=nt.createDecorationsCollection(),this.updateSoon=this._register(new RunOnceScheduler(()=>this._update(),300)),this.state=null,this._register(nt.onDidChangeConfiguration(ut=>{this._isEnabled=nt.getOption(103)})),this._register(nt.onDidChangeCursorSelection(ut=>{this._isEnabled&&(ut.selection.isEmpty()?ut.reason===3?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())})),this._register(nt.onDidChangeModel(ut=>{this._setState(null)})),this._register(nt.onDidChangeModelContent(ut=>{this._isEnabled&&this.updateSoon.schedule()}));const rt=CommonFindController.get(nt);rt&&this._register(rt.getState().onFindReplaceStateChange(ut=>{this._update()})),this.updateSoon.schedule()}_update(){this._setState(Nr._createState(this.state,this._isEnabled,this.editor))}static _createState(nt,ot,rt){if(!ot||!rt.hasModel())return null;const ut=rt.getSelection();if(ut.startLineNumber!==ut.endLineNumber)return null;const gt=MultiCursorSelectionController.get(rt);if(!gt)return null;const pt=CommonFindController.get(rt);if(!pt)return null;let mt=gt.getSession(pt);if(!mt){const yt=rt.getSelections();if(yt.length>1){const Lt=pt.getState().matchCase;if(!modelRangesContainSameText(rt.getModel(),yt,Lt))return null}mt=MultiCursorSession.create(rt,pt)}if(!mt||mt.currentMatch||/^[ \t]+$/.test(mt.searchText)||mt.searchText.length>200)return null;const vt=pt.getState(),St=vt.matchCase;if(vt.isRevealed){let yt=vt.searchString;St||(yt=yt.toLowerCase());let wt=mt.searchText;if(St||(wt=wt.toLowerCase()),yt===wt&&mt.matchCase===vt.matchCase&&mt.wholeWord===vt.wholeWord&&!vt.isRegex)return null}return new SelectionHighlighterState(rt.getModel(),mt.searchText,mt.matchCase,mt.wholeWord?rt.getOption(125):null,nt)}_setState(nt){if(this.state=nt,!this.state){this._decorations.clear();return}if(!this.editor.hasModel())return;const ot=this.editor.getModel();if(ot.isTooLargeForTokenization())return;const rt=this.state.findMatches(),ut=this.editor.getSelections();ut.sort(Range$2.compareRangesUsingStarts);const gt=[];for(let vt=0,St=0,yt=rt.length,wt=ut.length;vt<yt;){const Lt=rt[vt];if(St>=wt)gt.push(Lt),vt++;else{const xt=Range$2.compareRangesUsingStarts(Lt,ut[St]);xt<0?((ut[St].isEmpty()||!Range$2.areIntersecting(Lt,ut[St]))&&gt.push(Lt),vt++):(xt>0||vt++,St++)}}const pt=this._languageFeaturesService.documentHighlightProvider.has(ot)&&this.editor.getOption(78),mt=gt.map(vt=>({range:vt,options:getSelectionHighlightDecorationOptions(pt)}));this._decorations.set(mt)}dispose(){this._setState(null),super.dispose()}};SelectionHighlighter.ID="editor.contrib.selectionHighlighter";SelectionHighlighter=__decorate$p([__param$p(1,ILanguageFeaturesService)],SelectionHighlighter);function modelRangesContainSameText(ct,nt,ot){const rt=getValueInRange(ct,nt[0],!ot);for(let ut=1,gt=nt.length;ut<gt;ut++){const pt=nt[ut];if(pt.isEmpty())return!1;const mt=getValueInRange(ct,pt,!ot);if(rt!==mt)return!1}return!0}function getValueInRange(ct,nt,ot){const rt=ct.getValueInRange(nt);return ot?rt.toLowerCase():rt}class FocusNextCursor extends EditorAction{constructor(){super({id:"editor.action.focusNextCursor",label:localize("mutlicursor.focusNextCursor","Focus Next Cursor"),description:{description:localize("mutlicursor.focusNextCursor.description","Focuses the next cursor"),args:[]},alias:"Focus Next Cursor",precondition:void 0})}run(nt,ot,rt){if(!ot.hasModel())return;const ut=ot._getViewModel();if(ut.cursorConfig.readOnly)return;ut.model.pushStackElement();const gt=Array.from(ut.getCursorStates()),pt=gt.shift();pt&&(gt.push(pt),ut.setCursorStates(rt.source,3,gt),ut.revealPrimaryCursor(rt.source,!0),announceCursorChange(gt,ut.getCursorStates()))}}class FocusPreviousCursor extends EditorAction{constructor(){super({id:"editor.action.focusPreviousCursor",label:localize("mutlicursor.focusPreviousCursor","Focus Previous Cursor"),description:{description:localize("mutlicursor.focusPreviousCursor.description","Focuses the previous cursor"),args:[]},alias:"Focus Previous Cursor",precondition:void 0})}run(nt,ot,rt){if(!ot.hasModel())return;const ut=ot._getViewModel();if(ut.cursorConfig.readOnly)return;ut.model.pushStackElement();const gt=Array.from(ut.getCursorStates()),pt=gt.pop();pt&&(gt.unshift(pt),ut.setCursorStates(rt.source,3,gt),ut.revealPrimaryCursor(rt.source,!0),announceCursorChange(gt,ut.getCursorStates()))}}registerEditorContribution(MultiCursorSelectionController.ID,MultiCursorSelectionController,4);registerEditorContribution(SelectionHighlighter.ID,SelectionHighlighter,1);registerEditorAction(InsertCursorAbove);registerEditorAction(InsertCursorBelow);registerEditorAction(InsertCursorAtEndOfEachLineSelected);registerEditorAction(AddSelectionToNextFindMatchAction);registerEditorAction(AddSelectionToPreviousFindMatchAction);registerEditorAction(MoveSelectionToNextFindMatchAction);registerEditorAction(MoveSelectionToPreviousFindMatchAction);registerEditorAction(SelectHighlightsAction);registerEditorAction(CompatChangeAll);registerEditorAction(InsertCursorAtEndOfLineSelected);registerEditorAction(InsertCursorAtTopOfLineSelected);registerEditorAction(FocusNextCursor);registerEditorAction(FocusPreviousCursor);var __awaiter$f=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const Context={Visible:new RawContextKey("parameterHintsVisible",!1),MultipleSignatures:new RawContextKey("parameterHintsMultipleSignatures",!1)};function provideSignatureHelp(ct,nt,ot,rt,ut){return __awaiter$f(this,void 0,void 0,function*(){const gt=ct.ordered(nt);for(const pt of gt)try{const mt=yield pt.provideSignatureHelp(nt,ot,ut,rt);if(mt)return mt}catch(mt){onUnexpectedExternalError(mt)}})}CommandsRegistry.registerCommand("_executeSignatureHelpProvider",(ct,...nt)=>__awaiter$f(void 0,void 0,void 0,function*(){const[ot,rt,ut]=nt;assertType(URI.isUri(ot)),assertType(Position$1.isIPosition(rt)),assertType(typeof ut=="string"||!ut);const gt=ct.get(ILanguageFeaturesService),pt=yield ct.get(ITextModelService).createModelReference(ot);try{const mt=yield provideSignatureHelp(gt.signatureHelpProvider,pt.object.textEditorModel,Position$1.lift(rt),{triggerKind:SignatureHelpTriggerKind$1.Invoke,isRetrigger:!1,triggerCharacter:ut},CancellationToken.None);return mt?(setTimeout(()=>mt.dispose(),0),mt.value):void 0}finally{pt.dispose()}}));var __awaiter$e=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},ParameterHintState;(function(ct){ct.Default={type:0};class nt{constructor(ut,gt){this.request=ut,this.previouslyActiveHints=gt,this.type=2}}ct.Pending=nt;class ot{constructor(ut){this.hints=ut,this.type=1}}ct.Active=ot})(ParameterHintState||(ParameterHintState={}));class ParameterHintsModel extends Disposable{constructor(nt,ot,rt=ParameterHintsModel.DEFAULT_DELAY){super(),this._onChangedHints=this._register(new Emitter$2),this.onChangedHints=this._onChangedHints.event,this.triggerOnType=!1,this._state=ParameterHintState.Default,this._pendingTriggers=[],this._lastSignatureHelpResult=this._register(new MutableDisposable),this.triggerChars=new CharacterSet,this.retriggerChars=new CharacterSet,this.triggerId=0,this.editor=nt,this.providers=ot,this.throttledDelayer=new Delayer(rt),this._register(this.editor.onDidBlurEditorWidget(()=>this.cancel())),this._register(this.editor.onDidChangeConfiguration(()=>this.onEditorConfigurationChange())),this._register(this.editor.onDidChangeModel(ut=>this.onModelChanged())),this._register(this.editor.onDidChangeModelLanguage(ut=>this.onModelChanged())),this._register(this.editor.onDidChangeCursorSelection(ut=>this.onCursorChange(ut))),this._register(this.editor.onDidChangeModelContent(ut=>this.onModelContentChange())),this._register(this.providers.onDidChange(this.onModelChanged,this)),this._register(this.editor.onDidType(ut=>this.onDidType(ut))),this.onEditorConfigurationChange(),this.onModelChanged()}get state(){return this._state}set state(nt){this._state.type===2&&this._state.request.cancel(),this._state=nt}cancel(nt=!1){this.state=ParameterHintState.Default,this.throttledDelayer.cancel(),nt||this._onChangedHints.fire(void 0)}trigger(nt,ot){const rt=this.editor.getModel();if(!rt||!this.providers.has(rt))return;const ut=++this.triggerId;this._pendingTriggers.push(nt),this.throttledDelayer.trigger(()=>this.doTrigger(ut),ot).catch(onUnexpectedError)}next(){if(this.state.type!==1)return;const nt=this.state.hints.signatures.length,ot=this.state.hints.activeSignature,rt=ot%nt===nt-1,ut=this.editor.getOption(82).cycle;if((nt<2||rt)&&!ut){this.cancel();return}this.updateActiveSignature(rt&&ut?0:ot+1)}previous(){if(this.state.type!==1)return;const nt=this.state.hints.signatures.length,ot=this.state.hints.activeSignature,rt=ot===0,ut=this.editor.getOption(82).cycle;if((nt<2||rt)&&!ut){this.cancel();return}this.updateActiveSignature(rt&&ut?nt-1:ot-1)}updateActiveSignature(nt){this.state.type===1&&(this.state=new ParameterHintState.Active(Object.assign(Object.assign({},this.state.hints),{activeSignature:nt})),this._onChangedHints.fire(this.state.hints))}doTrigger(nt){return __awaiter$e(this,void 0,void 0,function*(){const ot=this.state.type===1||this.state.type===2,rt=this.getLastActiveHints();if(this.cancel(!0),this._pendingTriggers.length===0)return!1;const ut=this._pendingTriggers.reduce(mergeTriggerContexts);this._pendingTriggers=[];const gt={triggerKind:ut.triggerKind,triggerCharacter:ut.triggerCharacter,isRetrigger:ot,activeSignatureHelp:rt};if(!this.editor.hasModel())return!1;const pt=this.editor.getModel(),mt=this.editor.getPosition();this.state=new ParameterHintState.Pending(createCancelablePromise(vt=>provideSignatureHelp(this.providers,pt,mt,gt,vt)),rt);try{const vt=yield this.state.request;return nt!==this.triggerId?(vt==null||vt.dispose(),!1):!vt||!vt.value.signatures||vt.value.signatures.length===0?(vt==null||vt.dispose(),this._lastSignatureHelpResult.clear(),this.cancel(),!1):(this.state=new ParameterHintState.Active(vt.value),this._lastSignatureHelpResult.value=vt,this._onChangedHints.fire(this.state.hints),!0)}catch(vt){return nt===this.triggerId&&(this.state=ParameterHintState.Default),onUnexpectedError(vt),!1}})}getLastActiveHints(){switch(this.state.type){case 1:return this.state.hints;case 2:return this.state.previouslyActiveHints;default:return}}get isTriggered(){return this.state.type===1||this.state.type===2||this.throttledDelayer.isTriggered()}onModelChanged(){this.cancel(),this.triggerChars.clear(),this.retriggerChars.clear();const nt=this.editor.getModel();if(nt)for(const ot of this.providers.ordered(nt)){for(const rt of ot.signatureHelpTriggerCharacters||[])if(rt.length){const ut=rt.charCodeAt(0);this.triggerChars.add(ut),this.retriggerChars.add(ut)}for(const rt of ot.signatureHelpRetriggerCharacters||[])rt.length&&this.retriggerChars.add(rt.charCodeAt(0))}}onDidType(nt){if(!this.triggerOnType)return;const ot=nt.length-1,rt=nt.charCodeAt(ot);(this.triggerChars.has(rt)||this.isTriggered&&this.retriggerChars.has(rt))&&this.trigger({triggerKind:SignatureHelpTriggerKind$1.TriggerCharacter,triggerCharacter:nt.charAt(ot)})}onCursorChange(nt){nt.source==="mouse"?this.cancel():this.isTriggered&&this.trigger({triggerKind:SignatureHelpTriggerKind$1.ContentChange})}onModelContentChange(){this.isTriggered&&this.trigger({triggerKind:SignatureHelpTriggerKind$1.ContentChange})}onEditorConfigurationChange(){this.triggerOnType=this.editor.getOption(82).enabled,this.triggerOnType||this.cancel()}dispose(){this.cancel(!0),super.dispose()}}ParameterHintsModel.DEFAULT_DELAY=120;function mergeTriggerContexts(ct,nt){switch(nt.triggerKind){case SignatureHelpTriggerKind$1.Invoke:return nt;case SignatureHelpTriggerKind$1.ContentChange:return ct;case SignatureHelpTriggerKind$1.TriggerCharacter:default:return nt}}const parameterHints="";var __decorate$o=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$o=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const $=$$d,parameterHintsNextIcon=registerIcon("parameter-hints-next",Codicon.chevronDown,localize("parameterHintsNextIcon","Icon for show next parameter hint.")),parameterHintsPreviousIcon=registerIcon("parameter-hints-previous",Codicon.chevronUp,localize("parameterHintsPreviousIcon","Icon for show previous parameter hint."));let ParameterHintsWidget=class Mr extends Disposable{constructor(nt,ot,rt,ut,gt){super(),this.editor=nt,this.model=ot,this.renderDisposeables=this._register(new DisposableStore),this.visible=!1,this.announcedLabel=null,this.allowEditorOverflow=!0,this.markdownRenderer=this._register(new MarkdownRenderer({editor:nt},gt,ut)),this.keyVisible=Context.Visible.bindTo(rt),this.keyMultipleSignatures=Context.MultipleSignatures.bindTo(rt)}createParameterHintDOMNodes(){const nt=$(".editor-widget.parameter-hints-widget"),ot=append$1(nt,$(".phwrapper"));ot.tabIndex=-1;const rt=append$1(ot,$(".controls")),ut=append$1(rt,$(".button"+ThemeIcon.asCSSSelector(parameterHintsPreviousIcon))),gt=append$1(rt,$(".overloads")),pt=append$1(rt,$(".button"+ThemeIcon.asCSSSelector(parameterHintsNextIcon)));this._register(addDisposableListener(ut,"click",Lt=>{EventHelper.stop(Lt),this.previous()})),this._register(addDisposableListener(pt,"click",Lt=>{EventHelper.stop(Lt),this.next()}));const mt=$(".body"),vt=new DomScrollableElement(mt,{alwaysConsumeMouseWheel:!0});this._register(vt),ot.appendChild(vt.getDomNode());const St=append$1(mt,$(".signature")),yt=append$1(mt,$(".docs"));nt.style.userSelect="text",this.domNodes={element:nt,signature:St,overloads:gt,docs:yt,scrollbar:vt},this.editor.addContentWidget(this),this.hide(),this._register(this.editor.onDidChangeCursorSelection(Lt=>{this.visible&&this.editor.layoutContentWidget(this)}));const wt=()=>{if(!this.domNodes)return;const Lt=this.editor.getOption(48);this.domNodes.element.style.fontSize=`${Lt.fontSize}px`,this.domNodes.element.style.lineHeight=`${Lt.lineHeight/Lt.fontSize}`};wt(),this._register(Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor)).filter(Lt=>Lt.hasChanged(48)).on(wt,null)),this._register(this.editor.onDidLayoutChange(Lt=>this.updateMaxHeight())),this.updateMaxHeight()}show(){this.visible||(this.domNodes||this.createParameterHintDOMNodes(),this.keyVisible.set(!0),this.visible=!0,setTimeout(()=>{var nt;(nt=this.domNodes)===null||nt===void 0||nt.element.classList.add("visible")},100),this.editor.layoutContentWidget(this))}hide(){var nt;this.renderDisposeables.clear(),this.visible&&(this.keyVisible.reset(),this.visible=!1,this.announcedLabel=null,(nt=this.domNodes)===null||nt===void 0||nt.element.classList.remove("visible"),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[1,2]}:null}render(nt){var ot;if(this.renderDisposeables.clear(),!this.domNodes)return;const rt=nt.signatures.length>1;this.domNodes.element.classList.toggle("multiple",rt),this.keyMultipleSignatures.set(rt),this.domNodes.signature.innerText="",this.domNodes.docs.innerText="";const ut=nt.signatures[nt.activeSignature];if(!ut)return;const gt=append$1(this.domNodes.signature,$(".code")),pt=this.editor.getOption(48);gt.style.fontSize=`${pt.fontSize}px`,gt.style.fontFamily=pt.fontFamily;const mt=ut.parameters.length>0,vt=(ot=ut.activeParameter)!==null&&ot!==void 0?ot:nt.activeParameter;if(mt)this.renderParameters(gt,ut,vt);else{const wt=append$1(gt,$("span"));wt.textContent=ut.label}const St=ut.parameters[vt];if(St!=null&&St.documentation){const wt=$("span.documentation");if(typeof St.documentation=="string")wt.textContent=St.documentation;else{const Lt=this.renderMarkdownDocs(St.documentation);wt.appendChild(Lt.element)}append$1(this.domNodes.docs,$("p",{},wt))}if(ut.documentation!==void 0)if(typeof ut.documentation=="string")append$1(this.domNodes.docs,$("p",{},ut.documentation));else{const wt=this.renderMarkdownDocs(ut.documentation);append$1(this.domNodes.docs,wt.element)}const yt=this.hasDocs(ut,St);if(this.domNodes.signature.classList.toggle("has-docs",yt),this.domNodes.docs.classList.toggle("empty",!yt),this.domNodes.overloads.textContent=String(nt.activeSignature+1).padStart(nt.signatures.length.toString().length,"0")+"/"+nt.signatures.length,St){let wt="";const Lt=ut.parameters[vt];Array.isArray(Lt.label)?wt=ut.label.substring(Lt.label[0],Lt.label[1]):wt=Lt.label,Lt.documentation&&(wt+=typeof Lt.documentation=="string"?`, ${Lt.documentation}`:`, ${Lt.documentation.value}`),ut.documentation&&(wt+=typeof ut.documentation=="string"?`, ${ut.documentation}`:`, ${ut.documentation.value}`),this.announcedLabel!==wt&&(alert(localize("hint","{0}, hint",wt)),this.announcedLabel=wt)}this.editor.layoutContentWidget(this),this.domNodes.scrollbar.scanDomNode()}renderMarkdownDocs(nt){const ot=this.renderDisposeables.add(this.markdownRenderer.render(nt,{asyncRenderCallback:()=>{var rt;(rt=this.domNodes)===null||rt===void 0||rt.scrollbar.scanDomNode()}}));return ot.element.classList.add("markdown-docs"),ot}hasDocs(nt,ot){return!!(ot&&typeof ot.documentation=="string"&&assertIsDefined(ot.documentation).length>0||ot&&typeof ot.documentation=="object"&&assertIsDefined(ot.documentation).value.length>0||nt.documentation&&typeof nt.documentation=="string"&&assertIsDefined(nt.documentation).length>0||nt.documentation&&typeof nt.documentation=="object"&&assertIsDefined(nt.documentation.value).length>0)}renderParameters(nt,ot,rt){const[ut,gt]=this.getParameterLabelOffsets(ot,rt),pt=document.createElement("span");pt.textContent=ot.label.substring(0,ut);const mt=document.createElement("span");mt.textContent=ot.label.substring(ut,gt),mt.className="parameter active";const vt=document.createElement("span");vt.textContent=ot.label.substring(gt),append$1(nt,pt,mt,vt)}getParameterLabelOffsets(nt,ot){const rt=nt.parameters[ot];if(rt){if(Array.isArray(rt.label))return rt.label;if(rt.label.length){const ut=new RegExp(`(\\W|^)${escapeRegExpCharacters(rt.label)}(?=\\W|$)`,"g");ut.test(nt.label);const gt=ut.lastIndex-rt.label.length;return gt>=0?[gt,ut.lastIndex]:[0,0]}else return[0,0]}else return[0,0]}next(){this.editor.focus(),this.model.next()}previous(){this.editor.focus(),this.model.previous()}getDomNode(){return this.domNodes||this.createParameterHintDOMNodes(),this.domNodes.element}getId(){return Mr.ID}updateMaxHeight(){if(!this.domNodes)return;const ot=`${Math.max(this.editor.getLayoutInfo().height/4,250)}px`;this.domNodes.element.style.maxHeight=ot;const rt=this.domNodes.element.getElementsByClassName("phwrapper");rt.length&&(rt[0].style.maxHeight=ot)}};ParameterHintsWidget.ID="editor.widget.parameterHintsWidget";ParameterHintsWidget=__decorate$o([__param$o(2,IContextKeyService),__param$o(3,IOpenerService),__param$o(4,ILanguageService)],ParameterHintsWidget);registerColor("editorHoverWidget.highlightForeground",{dark:listHighlightForeground,light:listHighlightForeground,hcDark:listHighlightForeground,hcLight:listHighlightForeground},localize("editorHoverWidgetHighlightForeground","Foreground color of the active item in the parameter hint."));var __decorate$n=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$n=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let ParameterHintsController=class Pr extends Disposable{static get(nt){return nt.getContribution(Pr.ID)}constructor(nt,ot,rt){super(),this.editor=nt,this.model=this._register(new ParameterHintsModel(nt,rt.signatureHelpProvider)),this._register(this.model.onChangedHints(ut=>{var gt;ut?(this.widget.value.show(),this.widget.value.render(ut)):(gt=this.widget.rawValue)===null||gt===void 0||gt.hide()})),this.widget=new Lazy(()=>this._register(ot.createInstance(ParameterHintsWidget,this.editor,this.model)))}cancel(){this.model.cancel()}previous(){var nt;(nt=this.widget.rawValue)===null||nt===void 0||nt.previous()}next(){var nt;(nt=this.widget.rawValue)===null||nt===void 0||nt.next()}trigger(nt){this.model.trigger(nt,0)}};ParameterHintsController.ID="editor.controller.parameterHints";ParameterHintsController=__decorate$n([__param$n(1,IInstantiationService),__param$n(2,ILanguageFeaturesService)],ParameterHintsController);class TriggerParameterHintsAction extends EditorAction{constructor(){super({id:"editor.action.triggerParameterHints",label:localize("parameterHints.trigger.label","Trigger Parameter Hints"),alias:"Trigger Parameter Hints",precondition:EditorContextKeys.hasSignatureHelpProvider,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3082,weight:100}})}run(nt,ot){const rt=ParameterHintsController.get(ot);rt==null||rt.trigger({triggerKind:SignatureHelpTriggerKind$1.Invoke})}}registerEditorContribution(ParameterHintsController.ID,ParameterHintsController,2);registerEditorAction(TriggerParameterHintsAction);const weight$1=100+75,ParameterHintsCommand=EditorCommand.bindToContribution(ParameterHintsController.get);registerEditorCommand(new ParameterHintsCommand({id:"closeParameterHints",precondition:Context.Visible,handler:ct=>ct.cancel(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.focus,primary:9,secondary:[1033]}}));registerEditorCommand(new ParameterHintsCommand({id:"showPrevParameterHint",precondition:ContextKeyExpr.and(Context.Visible,Context.MultipleSignatures),handler:ct=>ct.previous(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.focus,primary:16,secondary:[528],mac:{primary:16,secondary:[528,302]}}}));registerEditorCommand(new ParameterHintsCommand({id:"showNextParameterHint",precondition:ContextKeyExpr.and(Context.Visible,Context.MultipleSignatures),handler:ct=>ct.next(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.focus,primary:18,secondary:[530],mac:{primary:18,secondary:[530,300]}}}));const renameInputField="";var __decorate$m=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$m=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const CONTEXT_RENAME_INPUT_VISIBLE=new RawContextKey("renameInputVisible",!1,localize("renameInputVisible","Whether the rename input widget is visible"));let RenameInputField=class{constructor(nt,ot,rt,ut,gt){this._editor=nt,this._acceptKeybindings=ot,this._themeService=rt,this._keybindingService=ut,this._disposables=new DisposableStore,this.allowEditorOverflow=!0,this._visibleContextKey=CONTEXT_RENAME_INPUT_VISIBLE.bindTo(gt),this._editor.addContentWidget(this),this._disposables.add(this._editor.onDidChangeConfiguration(pt=>{pt.hasChanged(48)&&this._updateFont()})),this._disposables.add(rt.onDidColorThemeChange(this._updateStyles,this))}dispose(){this._disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return"__renameInputWidget"}getDomNode(){return this._domNode||(this._domNode=document.createElement("div"),this._domNode.className="monaco-editor rename-box",this._input=document.createElement("input"),this._input.className="rename-input",this._input.type="text",this._input.setAttribute("aria-label",localize("renameAriaLabel","Rename input. Type new name and press Enter to commit.")),this._domNode.appendChild(this._input),this._label=document.createElement("div"),this._label.className="rename-label",this._domNode.appendChild(this._label),this._updateFont(),this._updateStyles(this._themeService.getColorTheme())),this._domNode}_updateStyles(nt){var ot,rt,ut,gt;if(!this._input||!this._domNode)return;const pt=nt.getColor(widgetShadow),mt=nt.getColor(widgetBorder);this._domNode.style.backgroundColor=String((ot=nt.getColor(editorWidgetBackground))!==null&&ot!==void 0?ot:""),this._domNode.style.boxShadow=pt?` 0 0 8px 2px ${pt}`:"",this._domNode.style.border=mt?`1px solid ${mt}`:"",this._domNode.style.color=String((rt=nt.getColor(inputForeground))!==null&&rt!==void 0?rt:""),this._input.style.backgroundColor=String((ut=nt.getColor(inputBackground))!==null&&ut!==void 0?ut:"");const vt=nt.getColor(inputBorder);this._input.style.borderWidth=vt?"1px":"0px",this._input.style.borderStyle=vt?"solid":"none",this._input.style.borderColor=(gt=vt==null?void 0:vt.toString())!==null&&gt!==void 0?gt:"none"}_updateFont(){if(!this._input||!this._label)return;const nt=this._editor.getOption(48);this._input.style.fontFamily=nt.fontFamily,this._input.style.fontWeight=nt.fontWeight,this._input.style.fontSize=`${nt.fontSize}px`,this._label.style.fontSize=`${nt.fontSize*.8}px`}getPosition(){return this._visible?{position:this._position,preference:[2,1]}:null}beforeRender(){var nt,ot;const[rt,ut]=this._acceptKeybindings;return this._label.innerText=localize({key:"label",comment:['placeholders are keybindings, e.g "F2 to Rename, Shift+F2 to Preview"']},"{0} to Rename, {1} to Preview",(nt=this._keybindingService.lookupKeybinding(rt))===null||nt===void 0?void 0:nt.getLabel(),(ot=this._keybindingService.lookupKeybinding(ut))===null||ot===void 0?void 0:ot.getLabel()),null}afterRender(nt){nt||this.cancelInput(!0)}acceptInput(nt){var ot;(ot=this._currentAcceptInput)===null||ot===void 0||ot.call(this,nt)}cancelInput(nt){var ot;(ot=this._currentCancelInput)===null||ot===void 0||ot.call(this,nt)}getInput(nt,ot,rt,ut,gt,pt){this._domNode.classList.toggle("preview",gt),this._position=new Position$1(nt.startLineNumber,nt.startColumn),this._input.value=ot,this._input.setAttribute("selectionStart",rt.toString()),this._input.setAttribute("selectionEnd",ut.toString()),this._input.size=Math.max((nt.endColumn-nt.startColumn)*1.1,20);const mt=new DisposableStore;return new Promise(vt=>{this._currentCancelInput=St=>(this._currentAcceptInput=void 0,this._currentCancelInput=void 0,vt(St),!0),this._currentAcceptInput=St=>{if(this._input.value.trim().length===0||this._input.value===ot){this.cancelInput(!0);return}this._currentAcceptInput=void 0,this._currentCancelInput=void 0,vt({newName:this._input.value,wantsPreview:gt&&St})},mt.add(pt.onCancellationRequested(()=>this.cancelInput(!0))),mt.add(this._editor.onDidBlurEditorWidget(()=>this.cancelInput(!document.hasFocus()))),this._show()}).finally(()=>{mt.dispose(),this._hide()})}_show(){this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber,0),this._visible=!0,this._visibleContextKey.set(!0),this._editor.layoutContentWidget(this),setTimeout(()=>{this._input.focus(),this._input.setSelectionRange(parseInt(this._input.getAttribute("selectionStart")),parseInt(this._input.getAttribute("selectionEnd")))},100)}_hide(){this._visible=!1,this._visibleContextKey.reset(),this._editor.layoutContentWidget(this)}};RenameInputField=__decorate$m([__param$m(2,IThemeService),__param$m(3,IKeybindingService),__param$m(4,IContextKeyService)],RenameInputField);var __decorate$l=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$l=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$d=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class RenameSkeleton{constructor(nt,ot,rt){this.model=nt,this.position=ot,this._providerRenameIdx=0,this._providers=rt.ordered(nt)}hasProvider(){return this._providers.length>0}resolveRenameLocation(nt){return __awaiter$d(this,void 0,void 0,function*(){const ot=[];for(this._providerRenameIdx=0;this._providerRenameIdx<this._providers.length;this._providerRenameIdx++){const ut=this._providers[this._providerRenameIdx];if(!ut.resolveRenameLocation)break;const gt=yield ut.resolveRenameLocation(this.model,this.position,nt);if(gt){if(gt.rejectReason){ot.push(gt.rejectReason);continue}return gt}}const rt=this.model.getWordAtPosition(this.position);return rt?{range:new Range$2(this.position.lineNumber,rt.startColumn,this.position.lineNumber,rt.endColumn),text:rt.word,rejectReason:ot.length>0?ot.join(`
`):void 0}:{range:Range$2.fromPositions(this.position),text:"",rejectReason:ot.length>0?ot.join(`
`):void 0}})}provideRenameEdits(nt,ot){return __awaiter$d(this,void 0,void 0,function*(){return this._provideRenameEdits(nt,this._providerRenameIdx,[],ot)})}_provideRenameEdits(nt,ot,rt,ut){return __awaiter$d(this,void 0,void 0,function*(){const gt=this._providers[ot];if(!gt)return{edits:[],rejectReason:rt.join(`
`)};const pt=yield gt.provideRenameEdits(this.model,this.position,nt,ut);if(pt){if(pt.rejectReason)return this._provideRenameEdits(nt,ot+1,rt.concat(pt.rejectReason),ut)}else return this._provideRenameEdits(nt,ot+1,rt.concat(localize("no result","No result.")),ut);return pt})}}function rename(ct,nt,ot,rt){return __awaiter$d(this,void 0,void 0,function*(){const ut=new RenameSkeleton(nt,ot,ct),gt=yield ut.resolveRenameLocation(CancellationToken.None);return gt!=null&&gt.rejectReason?{edits:[],rejectReason:gt.rejectReason}:ut.provideRenameEdits(rt,CancellationToken.None)})}let RenameController=class Or{static get(nt){return nt.getContribution(Or.ID)}constructor(nt,ot,rt,ut,gt,pt,mt,vt){this.editor=nt,this._instaService=ot,this._notificationService=rt,this._bulkEditService=ut,this._progressService=gt,this._logService=pt,this._configService=mt,this._languageFeaturesService=vt,this._disposableStore=new DisposableStore,this._cts=new CancellationTokenSource$1,this._renameInputField=this._disposableStore.add(this._instaService.createInstance(RenameInputField,this.editor,["acceptRenameInput","acceptRenameInputWithPreview"]))}dispose(){this._disposableStore.dispose(),this._cts.dispose(!0)}run(){var nt,ot;return __awaiter$d(this,void 0,void 0,function*(){if(this._cts.dispose(!0),this._cts=new CancellationTokenSource$1,!this.editor.hasModel())return;const rt=this.editor.getPosition(),ut=new RenameSkeleton(this.editor.getModel(),rt,this._languageFeaturesService.renameProvider);if(!ut.hasProvider())return;const gt=new EditorStateCancellationTokenSource(this.editor,5,void 0,this._cts.token);let pt;try{const It=ut.resolveRenameLocation(gt.token);this._progressService.showWhile(It,250),pt=yield It}catch(It){(nt=MessageController.get(this.editor))===null||nt===void 0||nt.showMessage(It||localize("resolveRenameLocationFailed","An unknown error occurred while resolving rename location"),rt);return}finally{gt.dispose()}if(!pt)return;if(pt.rejectReason){(ot=MessageController.get(this.editor))===null||ot===void 0||ot.showMessage(pt.rejectReason,rt);return}if(gt.token.isCancellationRequested)return;const mt=new EditorStateCancellationTokenSource(this.editor,5,pt.range,this._cts.token),vt=this.editor.getSelection();let St=0,yt=pt.text.length;!Range$2.isEmpty(vt)&&!Range$2.spansMultipleLines(vt)&&Range$2.containsRange(pt.range,vt)&&(St=Math.max(0,vt.startColumn-pt.range.startColumn),yt=Math.min(pt.range.endColumn,vt.endColumn)-pt.range.startColumn);const wt=this._bulkEditService.hasPreviewHandler()&&this._configService.getValue(this.editor.getModel().uri,"editor.rename.enablePreview"),Lt=yield this._renameInputField.getInput(pt.range,pt.text,St,yt,wt,mt.token);if(typeof Lt=="boolean"){Lt&&this.editor.focus(),mt.dispose();return}this.editor.focus();const xt=raceCancellation(ut.provideRenameEdits(Lt.newName,mt.token),mt.token).then(It=>__awaiter$d(this,void 0,void 0,function*(){if(!(!It||!this.editor.hasModel())){if(It.rejectReason){this._notificationService.info(It.rejectReason);return}this.editor.setSelection(Range$2.fromPositions(this.editor.getSelection().getPosition())),this._bulkEditService.apply(It,{editor:this.editor,showPreview:Lt.wantsPreview,label:localize("label","Renaming '{0}' to '{1}'",pt==null?void 0:pt.text,Lt.newName),code:"undoredo.rename",quotableLabel:localize("quotableLabel","Renaming {0} to {1}",pt==null?void 0:pt.text,Lt.newName),respectAutoSaveConfig:!0}).then(kt=>{kt.ariaSummary&&alert(localize("aria","Successfully renamed '{0}' to '{1}'. Summary: {2}",pt.text,Lt.newName,kt.ariaSummary))}).catch(kt=>{this._notificationService.error(localize("rename.failedApply","Rename failed to apply edits")),this._logService.error(kt)})}}),It=>{this._notificationService.error(localize("rename.failed","Rename failed to compute edits")),this._logService.error(It)}).finally(()=>{mt.dispose()});return this._progressService.showWhile(xt,250),xt})}acceptRenameInput(nt){this._renameInputField.acceptInput(nt)}cancelRenameInput(){this._renameInputField.cancelInput(!0)}};RenameController.ID="editor.contrib.renameController";RenameController=__decorate$l([__param$l(1,IInstantiationService),__param$l(2,INotificationService),__param$l(3,IBulkEditService),__param$l(4,IEditorProgressService),__param$l(5,ILogService),__param$l(6,ITextResourceConfigurationService),__param$l(7,ILanguageFeaturesService)],RenameController);class RenameAction extends EditorAction{constructor(){super({id:"editor.action.rename",label:localize("rename.label","Rename Symbol"),alias:"Rename Symbol",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasRenameProvider),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:60,weight:100},contextMenuOpts:{group:"1_modification",order:1.1}})}runCommand(nt,ot){const rt=nt.get(ICodeEditorService),[ut,gt]=Array.isArray(ot)&&ot||[void 0,void 0];return URI.isUri(ut)&&Position$1.isIPosition(gt)?rt.openCodeEditor({resource:ut},rt.getActiveCodeEditor()).then(pt=>{pt&&(pt.setPosition(gt),pt.invokeWithinContext(mt=>(this.reportTelemetry(mt,pt),this.run(mt,pt))))},onUnexpectedError):super.runCommand(nt,ot)}run(nt,ot){const rt=RenameController.get(ot);return rt?rt.run():Promise.resolve()}}registerEditorContribution(RenameController.ID,RenameController,4);registerEditorAction(RenameAction);const RenameCommand=EditorCommand.bindToContribution(RenameController.get);registerEditorCommand(new RenameCommand({id:"acceptRenameInput",precondition:CONTEXT_RENAME_INPUT_VISIBLE,handler:ct=>ct.acceptRenameInput(!1),kbOpts:{weight:100+99,kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,ContextKeyExpr.not("isComposing")),primary:3}}));registerEditorCommand(new RenameCommand({id:"acceptRenameInputWithPreview",precondition:ContextKeyExpr.and(CONTEXT_RENAME_INPUT_VISIBLE,ContextKeyExpr.has("config.editor.rename.enablePreview")),handler:ct=>ct.acceptRenameInput(!0),kbOpts:{weight:100+99,kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,ContextKeyExpr.not("isComposing")),primary:1024+3}}));registerEditorCommand(new RenameCommand({id:"cancelRenameInput",precondition:CONTEXT_RENAME_INPUT_VISIBLE,handler:ct=>ct.cancelRenameInput(),kbOpts:{weight:100+99,kbExpr:EditorContextKeys.focus,primary:9,secondary:[1033]}}));registerModelAndPositionCommand("_executeDocumentRenameProvider",function(ct,nt,ot,...rt){const[ut]=rt;assertType(typeof ut=="string");const{renameProvider:gt}=ct.get(ILanguageFeaturesService);return rename(gt,nt,ot,ut)});registerModelAndPositionCommand("_executePrepareRename",function(ct,nt,ot){return __awaiter$d(this,void 0,void 0,function*(){const{renameProvider:rt}=ct.get(ILanguageFeaturesService),gt=yield new RenameSkeleton(nt,ot,rt).resolveRenameLocation(CancellationToken.None);if(gt!=null&&gt.rejectReason)throw new Error(gt.rejectReason);return gt})});Registry.as(Extensions$8.Configuration).registerConfiguration({id:"editor",properties:{"editor.rename.enablePreview":{scope:5,description:localize("enablePreview","Enable/disable the ability to preview changes before renaming"),default:!0,type:"boolean"}}});function reverseEndianness(ct){for(let nt=0,ot=ct.length;nt<ot;nt+=4){const rt=ct[nt+0],ut=ct[nt+1],gt=ct[nt+2],pt=ct[nt+3];ct[nt+0]=pt,ct[nt+1]=gt,ct[nt+2]=ut,ct[nt+3]=rt}}function toLittleEndianBuffer(ct){const nt=new Uint8Array(ct.buffer,ct.byteOffset,ct.length*4);return isLittleEndian()||reverseEndianness(nt),VSBuffer.wrap(nt)}function encodeSemanticTokensDto(ct){const nt=new Uint32Array(encodeSemanticTokensDtoSize(ct));let ot=0;if(nt[ot++]=ct.id,ct.type==="full")nt[ot++]=1,nt[ot++]=ct.data.length,nt.set(ct.data,ot),ot+=ct.data.length;else{nt[ot++]=2,nt[ot++]=ct.deltas.length;for(const rt of ct.deltas)nt[ot++]=rt.start,nt[ot++]=rt.deleteCount,rt.data?(nt[ot++]=rt.data.length,nt.set(rt.data,ot),ot+=rt.data.length):nt[ot++]=0}return toLittleEndianBuffer(nt)}function encodeSemanticTokensDtoSize(ct){let nt=0;if(nt+=1+1,ct.type==="full")nt+=1+ct.data.length;else{nt+=1,nt+=(1+1+1)*ct.deltas.length;for(const ot of ct.deltas)ot.data&&(nt+=ot.data.length)}return nt}var __awaiter$c=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};function isSemanticTokens(ct){return ct&&!!ct.data}function isSemanticTokensEdits(ct){return ct&&Array.isArray(ct.edits)}class DocumentSemanticTokensResult{constructor(nt,ot,rt){this.provider=nt,this.tokens=ot,this.error=rt}}function hasDocumentSemanticTokensProvider(ct,nt){return ct.has(nt)}function getDocumentSemanticTokensProviders(ct,nt){const ot=ct.orderedGroups(nt);return ot.length>0?ot[0]:[]}function getDocumentSemanticTokens(ct,nt,ot,rt,ut){return __awaiter$c(this,void 0,void 0,function*(){const gt=getDocumentSemanticTokensProviders(ct,nt),pt=yield Promise.all(gt.map(mt=>__awaiter$c(this,void 0,void 0,function*(){let vt,St=null;try{vt=yield mt.provideDocumentSemanticTokens(nt,mt===ot?rt:null,ut)}catch(yt){St=yt,vt=null}return(!vt||!isSemanticTokens(vt)&&!isSemanticTokensEdits(vt))&&(vt=null),new DocumentSemanticTokensResult(mt,vt,St)})));for(const mt of pt){if(mt.error)throw mt.error;if(mt.tokens)return mt}return pt.length>0?pt[0]:null})}function _getDocumentSemanticTokensProviderHighestGroup(ct,nt){const ot=ct.orderedGroups(nt);return ot.length>0?ot[0]:null}class DocumentRangeSemanticTokensResult{constructor(nt,ot){this.provider=nt,this.tokens=ot}}function hasDocumentRangeSemanticTokensProvider(ct,nt){return ct.has(nt)}function getDocumentRangeSemanticTokensProviders(ct,nt){const ot=ct.orderedGroups(nt);return ot.length>0?ot[0]:[]}function getDocumentRangeSemanticTokens(ct,nt,ot,rt){return __awaiter$c(this,void 0,void 0,function*(){const ut=getDocumentRangeSemanticTokensProviders(ct,nt),gt=yield Promise.all(ut.map(pt=>__awaiter$c(this,void 0,void 0,function*(){let mt;try{mt=yield pt.provideDocumentRangeSemanticTokens(nt,ot,rt)}catch(vt){onUnexpectedExternalError(vt),mt=null}return(!mt||!isSemanticTokens(mt))&&(mt=null),new DocumentRangeSemanticTokensResult(pt,mt)})));for(const pt of gt)if(pt.tokens)return pt;return gt.length>0?gt[0]:null})}CommandsRegistry.registerCommand("_provideDocumentSemanticTokensLegend",(ct,...nt)=>__awaiter$c(void 0,void 0,void 0,function*(){const[ot]=nt;assertType(ot instanceof URI);const rt=ct.get(IModelService).getModel(ot);if(!rt)return;const{documentSemanticTokensProvider:ut}=ct.get(ILanguageFeaturesService),gt=_getDocumentSemanticTokensProviderHighestGroup(ut,rt);return gt?gt[0].getLegend():ct.get(ICommandService).executeCommand("_provideDocumentRangeSemanticTokensLegend",ot)}));CommandsRegistry.registerCommand("_provideDocumentSemanticTokens",(ct,...nt)=>__awaiter$c(void 0,void 0,void 0,function*(){const[ot]=nt;assertType(ot instanceof URI);const rt=ct.get(IModelService).getModel(ot);if(!rt)return;const{documentSemanticTokensProvider:ut}=ct.get(ILanguageFeaturesService);if(!hasDocumentSemanticTokensProvider(ut,rt))return ct.get(ICommandService).executeCommand("_provideDocumentRangeSemanticTokens",ot,rt.getFullModelRange());const gt=yield getDocumentSemanticTokens(ut,rt,null,null,CancellationToken.None);if(!gt)return;const{provider:pt,tokens:mt}=gt;if(!mt||!isSemanticTokens(mt))return;const vt=encodeSemanticTokensDto({id:0,type:"full",data:mt.data});return mt.resultId&&pt.releaseDocumentSemanticTokens(mt.resultId),vt}));CommandsRegistry.registerCommand("_provideDocumentRangeSemanticTokensLegend",(ct,...nt)=>__awaiter$c(void 0,void 0,void 0,function*(){const[ot,rt]=nt;assertType(ot instanceof URI);const ut=ct.get(IModelService).getModel(ot);if(!ut)return;const{documentRangeSemanticTokensProvider:gt}=ct.get(ILanguageFeaturesService),pt=getDocumentRangeSemanticTokensProviders(gt,ut);if(pt.length===0)return;if(pt.length===1)return pt[0].getLegend();if(!rt||!Range$2.isIRange(rt))return console.warn("provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in"),pt[0].getLegend();const mt=yield getDocumentRangeSemanticTokens(gt,ut,Range$2.lift(rt),CancellationToken.None);if(mt)return mt.provider.getLegend()}));CommandsRegistry.registerCommand("_provideDocumentRangeSemanticTokens",(ct,...nt)=>__awaiter$c(void 0,void 0,void 0,function*(){const[ot,rt]=nt;assertType(ot instanceof URI),assertType(Range$2.isIRange(rt));const ut=ct.get(IModelService).getModel(ot);if(!ut)return;const{documentRangeSemanticTokensProvider:gt}=ct.get(ILanguageFeaturesService),pt=yield getDocumentRangeSemanticTokens(gt,ut,Range$2.lift(rt),CancellationToken.None);if(!(!pt||!pt.tokens))return encodeSemanticTokensDto({id:0,type:"full",data:pt.tokens.data})}));const SEMANTIC_HIGHLIGHTING_SETTING_ID="editor.semanticHighlighting";function isSemanticColoringEnabled(ct,nt,ot){var rt;const ut=(rt=ot.getValue(SEMANTIC_HIGHLIGHTING_SETTING_ID,{overrideIdentifier:ct.getLanguageId(),resource:ct.uri}))===null||rt===void 0?void 0:rt.enabled;return typeof ut=="boolean"?ut:nt.getColorTheme().semanticHighlighting}var __decorate$k=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$k=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let DocumentSemanticTokensFeature=class extends Disposable{constructor(nt,ot,rt,ut,gt,pt){super(),this._watchers=Object.create(null);const mt=yt=>{this._watchers[yt.uri.toString()]=new ModelSemanticColoring(yt,nt,rt,gt,pt)},vt=(yt,wt)=>{wt.dispose(),delete this._watchers[yt.uri.toString()]},St=()=>{for(const yt of ot.getModels()){const wt=this._watchers[yt.uri.toString()];isSemanticColoringEnabled(yt,rt,ut)?wt||mt(yt):wt&&vt(yt,wt)}};this._register(ot.onModelAdded(yt=>{isSemanticColoringEnabled(yt,rt,ut)&&mt(yt)})),this._register(ot.onModelRemoved(yt=>{const wt=this._watchers[yt.uri.toString()];wt&&vt(yt,wt)})),this._register(ut.onDidChangeConfiguration(yt=>{yt.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)&&St()})),this._register(rt.onDidColorThemeChange(St))}dispose(){for(const nt of Object.values(this._watchers))nt.dispose();super.dispose()}};DocumentSemanticTokensFeature=__decorate$k([__param$k(0,ISemanticTokensStylingService),__param$k(1,IModelService),__param$k(2,IThemeService),__param$k(3,IConfigurationService),__param$k(4,ILanguageFeatureDebounceService),__param$k(5,ILanguageFeaturesService)],DocumentSemanticTokensFeature);let ModelSemanticColoring=class mo extends Disposable{constructor(nt,ot,rt,ut,gt){super(),this._semanticTokensStylingService=ot,this._isDisposed=!1,this._model=nt,this._provider=gt.documentSemanticTokensProvider,this._debounceInformation=ut.for(this._provider,"DocumentSemanticTokens",{min:mo.REQUEST_MIN_DELAY,max:mo.REQUEST_MAX_DELAY}),this._fetchDocumentSemanticTokens=this._register(new RunOnceScheduler(()=>this._fetchDocumentSemanticTokensNow(),mo.REQUEST_MIN_DELAY)),this._currentDocumentResponse=null,this._currentDocumentRequestCancellationTokenSource=null,this._documentProvidersChangeListeners=[],this._providersChangedDuringRequest=!1,this._register(this._model.onDidChangeContent(()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(this._model.onDidChangeAttached(()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(this._model.onDidChangeLanguage(()=>{this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(0)}));const pt=()=>{dispose(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[];for(const mt of this._provider.all(nt))typeof mt.onDidChange=="function"&&this._documentProvidersChangeListeners.push(mt.onDidChange(()=>{if(this._currentDocumentRequestCancellationTokenSource){this._providersChangedDuringRequest=!0;return}this._fetchDocumentSemanticTokens.schedule(0)}))};pt(),this._register(this._provider.onDidChange(()=>{pt(),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(rt.onDidColorThemeChange(mt=>{this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._fetchDocumentSemanticTokens.schedule(0)}dispose(){this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._isDisposed=!0,super.dispose()}_fetchDocumentSemanticTokensNow(){if(this._currentDocumentRequestCancellationTokenSource)return;if(!hasDocumentSemanticTokensProvider(this._provider,this._model)){this._currentDocumentResponse&&this._model.tokenization.setSemanticTokens(null,!1);return}if(!this._model.isAttachedToEditor())return;const nt=new CancellationTokenSource$1,ot=this._currentDocumentResponse?this._currentDocumentResponse.provider:null,rt=this._currentDocumentResponse&&this._currentDocumentResponse.resultId||null,ut=getDocumentSemanticTokens(this._provider,this._model,ot,rt,nt.token);this._currentDocumentRequestCancellationTokenSource=nt,this._providersChangedDuringRequest=!1;const gt=[],pt=this._model.onDidChangeContent(vt=>{gt.push(vt)}),mt=new StopWatch(!1);ut.then(vt=>{if(this._debounceInformation.update(this._model,mt.elapsed()),this._currentDocumentRequestCancellationTokenSource=null,pt.dispose(),!vt)this._setDocumentSemanticTokens(null,null,null,gt);else{const{provider:St,tokens:yt}=vt,wt=this._semanticTokensStylingService.getStyling(St);this._setDocumentSemanticTokens(St,yt||null,wt,gt)}},vt=>{vt&&(isCancellationError(vt)||typeof vt.message=="string"&&vt.message.indexOf("busy")!==-1)||onUnexpectedError(vt),this._currentDocumentRequestCancellationTokenSource=null,pt.dispose(),(gt.length>0||this._providersChangedDuringRequest)&&(this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model)))})}static _copy(nt,ot,rt,ut,gt){gt=Math.min(gt,rt.length-ut,nt.length-ot);for(let pt=0;pt<gt;pt++)rt[ut+pt]=nt[ot+pt]}_setDocumentSemanticTokens(nt,ot,rt,ut){const gt=this._currentDocumentResponse,pt=()=>{(ut.length>0||this._providersChangedDuringRequest)&&!this._fetchDocumentSemanticTokens.isScheduled()&&this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))};if(this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._isDisposed){nt&&ot&&nt.releaseDocumentSemanticTokens(ot.resultId);return}if(!nt||!rt){this._model.tokenization.setSemanticTokens(null,!1);return}if(!ot){this._model.tokenization.setSemanticTokens(null,!0),pt();return}if(isSemanticTokensEdits(ot)){if(!gt){this._model.tokenization.setSemanticTokens(null,!0);return}if(ot.edits.length===0)ot={resultId:ot.resultId,data:gt.data};else{let mt=0;for(const Lt of ot.edits)mt+=(Lt.data?Lt.data.length:0)-Lt.deleteCount;const vt=gt.data,St=new Uint32Array(vt.length+mt);let yt=vt.length,wt=St.length;for(let Lt=ot.edits.length-1;Lt>=0;Lt--){const xt=ot.edits[Lt];if(xt.start>vt.length){rt.warnInvalidEditStart(gt.resultId,ot.resultId,Lt,xt.start,vt.length),this._model.tokenization.setSemanticTokens(null,!0);return}const It=yt-(xt.start+xt.deleteCount);It>0&&(mo._copy(vt,yt-It,St,wt-It,It),wt-=It),xt.data&&(mo._copy(xt.data,0,St,wt-xt.data.length,xt.data.length),wt-=xt.data.length),yt=xt.start}yt>0&&mo._copy(vt,0,St,0,yt),ot={resultId:ot.resultId,data:St}}}if(isSemanticTokens(ot)){this._currentDocumentResponse=new SemanticTokensResponse(nt,ot.resultId,ot.data);const mt=toMultilineTokens2(ot,rt,this._model.getLanguageId());if(ut.length>0)for(const vt of ut)for(const St of mt)for(const yt of vt.changes)St.applyEdit(yt.range,yt.text);this._model.tokenization.setSemanticTokens(mt,!0)}else this._model.tokenization.setSemanticTokens(null,!0);pt()}};ModelSemanticColoring.REQUEST_MIN_DELAY=300;ModelSemanticColoring.REQUEST_MAX_DELAY=2e3;ModelSemanticColoring=__decorate$k([__param$k(1,ISemanticTokensStylingService),__param$k(2,IThemeService),__param$k(3,ILanguageFeatureDebounceService),__param$k(4,ILanguageFeaturesService)],ModelSemanticColoring);class SemanticTokensResponse{constructor(nt,ot,rt){this.provider=nt,this.resultId=ot,this.data=rt}dispose(){this.provider.releaseDocumentSemanticTokens(this.resultId)}}registerEditorFeature(DocumentSemanticTokensFeature);var __decorate$j=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$j=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let ViewportSemanticTokensContribution=class extends Disposable{constructor(nt,ot,rt,ut,gt,pt){super(),this._semanticTokensStylingService=ot,this._themeService=rt,this._configurationService=ut,this._editor=nt,this._provider=pt.documentRangeSemanticTokensProvider,this._debounceInformation=gt.for(this._provider,"DocumentRangeSemanticTokens",{min:100,max:500}),this._tokenizeViewport=this._register(new RunOnceScheduler(()=>this._tokenizeViewportNow(),100)),this._outstandingRequests=[];const mt=()=>{this._editor.hasModel()&&this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()))};this._register(this._editor.onDidScrollChange(()=>{mt()})),this._register(this._editor.onDidChangeModel(()=>{this._cancelAll(),mt()})),this._register(this._editor.onDidChangeModelContent(vt=>{this._cancelAll(),mt()})),this._register(this._provider.onDidChange(()=>{this._cancelAll(),mt()})),this._register(this._configurationService.onDidChangeConfiguration(vt=>{vt.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)&&(this._cancelAll(),mt())})),this._register(this._themeService.onDidColorThemeChange(()=>{this._cancelAll(),mt()})),mt()}_cancelAll(){for(const nt of this._outstandingRequests)nt.cancel();this._outstandingRequests=[]}_removeOutstandingRequest(nt){for(let ot=0,rt=this._outstandingRequests.length;ot<rt;ot++)if(this._outstandingRequests[ot]===nt){this._outstandingRequests.splice(ot,1);return}}_tokenizeViewportNow(){if(!this._editor.hasModel())return;const nt=this._editor.getModel();if(nt.tokenization.hasCompleteSemanticTokens())return;if(!isSemanticColoringEnabled(nt,this._themeService,this._configurationService)){nt.tokenization.hasSomeSemanticTokens()&&nt.tokenization.setSemanticTokens(null,!1);return}if(!hasDocumentRangeSemanticTokensProvider(this._provider,nt)){nt.tokenization.hasSomeSemanticTokens()&&nt.tokenization.setSemanticTokens(null,!1);return}const ot=this._editor.getVisibleRangesPlusViewportAboveBelow();this._outstandingRequests=this._outstandingRequests.concat(ot.map(rt=>this._requestRange(nt,rt)))}_requestRange(nt,ot){const rt=nt.getVersionId(),ut=createCancelablePromise(pt=>Promise.resolve(getDocumentRangeSemanticTokens(this._provider,nt,ot,pt))),gt=new StopWatch(!1);return ut.then(pt=>{if(this._debounceInformation.update(nt,gt.elapsed()),!pt||!pt.tokens||nt.isDisposed()||nt.getVersionId()!==rt)return;const{provider:mt,tokens:vt}=pt,St=this._semanticTokensStylingService.getStyling(mt);nt.tokenization.setPartialSemanticTokens(ot,toMultilineTokens2(vt,St,nt.getLanguageId()))}).then(()=>this._removeOutstandingRequest(ut),()=>this._removeOutstandingRequest(ut)),ut}};ViewportSemanticTokensContribution.ID="editor.contrib.viewportSemanticTokens";ViewportSemanticTokensContribution=__decorate$j([__param$j(1,ISemanticTokensStylingService),__param$j(2,IThemeService),__param$j(3,IConfigurationService),__param$j(4,ILanguageFeatureDebounceService),__param$j(5,ILanguageFeaturesService)],ViewportSemanticTokensContribution);registerEditorContribution(ViewportSemanticTokensContribution.ID,ViewportSemanticTokensContribution,1);class WordSelectionRangeProvider{provideSelectionRanges(nt,ot){const rt=[];for(const ut of ot){const gt=[];rt.push(gt),this._addInWordRanges(gt,nt,ut),this._addWordRanges(gt,nt,ut),this._addWhitespaceLine(gt,nt,ut),gt.push({range:nt.getFullModelRange()})}return rt}_addInWordRanges(nt,ot,rt){const ut=ot.getWordAtPosition(rt);if(!ut)return;const{word:gt,startColumn:pt}=ut,mt=rt.column-pt;let vt=mt,St=mt,yt=0;for(;vt>=0;vt--){const wt=gt.charCodeAt(vt);if(vt!==mt&&(wt===95||wt===45))break;if(isLowerAsciiLetter(wt)&&isUpperAsciiLetter(yt))break;yt=wt}for(vt+=1;St<gt.length;St++){const wt=gt.charCodeAt(St);if(isUpperAsciiLetter(wt)&&isLowerAsciiLetter(yt))break;if(wt===95||wt===45)break;yt=wt}vt<St&&nt.push({range:new Range$2(rt.lineNumber,pt+vt,rt.lineNumber,pt+St)})}_addWordRanges(nt,ot,rt){const ut=ot.getWordAtPosition(rt);ut&&nt.push({range:new Range$2(rt.lineNumber,ut.startColumn,rt.lineNumber,ut.endColumn)})}_addWhitespaceLine(nt,ot,rt){ot.getLineLength(rt.lineNumber)>0&&ot.getLineFirstNonWhitespaceColumn(rt.lineNumber)===0&&ot.getLineLastNonWhitespaceColumn(rt.lineNumber)===0&&nt.push({range:new Range$2(rt.lineNumber,1,rt.lineNumber,ot.getLineMaxColumn(rt.lineNumber))})}}var __decorate$i=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$i=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$b=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class SelectionRanges{constructor(nt,ot){this.index=nt,this.ranges=ot}mov(nt){const ot=this.index+(nt?1:-1);if(ot<0||ot>=this.ranges.length)return this;const rt=new SelectionRanges(ot,this.ranges);return rt.ranges[ot].equalsRange(this.ranges[this.index])?rt.mov(nt):rt}}let SmartSelectController=class $r{static get(nt){return nt.getContribution($r.ID)}constructor(nt,ot){this._editor=nt,this._languageFeaturesService=ot,this._ignoreSelection=!1}dispose(){var nt;(nt=this._selectionListener)===null||nt===void 0||nt.dispose()}run(nt){return __awaiter$b(this,void 0,void 0,function*(){if(!this._editor.hasModel())return;const ot=this._editor.getSelections(),rt=this._editor.getModel();if(this._state||(yield provideSelectionRanges(this._languageFeaturesService.selectionRangeProvider,rt,ot.map(gt=>gt.getPosition()),this._editor.getOption(108),CancellationToken.None).then(gt=>{var pt;if(!(!isNonEmptyArray(gt)||gt.length!==ot.length)&&!(!this._editor.hasModel()||!equals$2(this._editor.getSelections(),ot,(mt,vt)=>mt.equalsSelection(vt)))){for(let mt=0;mt<gt.length;mt++)gt[mt]=gt[mt].filter(vt=>vt.containsPosition(ot[mt].getStartPosition())&&vt.containsPosition(ot[mt].getEndPosition())),gt[mt].unshift(ot[mt]);this._state=gt.map(mt=>new SelectionRanges(0,mt)),(pt=this._selectionListener)===null||pt===void 0||pt.dispose(),this._selectionListener=this._editor.onDidChangeCursorPosition(()=>{var mt;this._ignoreSelection||((mt=this._selectionListener)===null||mt===void 0||mt.dispose(),this._state=void 0)})}})),!this._state)return;this._state=this._state.map(gt=>gt.mov(nt));const ut=this._state.map(gt=>Selection$1.fromPositions(gt.ranges[gt.index].getStartPosition(),gt.ranges[gt.index].getEndPosition()));this._ignoreSelection=!0;try{this._editor.setSelections(ut)}finally{this._ignoreSelection=!1}})}};SmartSelectController.ID="editor.contrib.smartSelectController";SmartSelectController=__decorate$i([__param$i(1,ILanguageFeaturesService)],SmartSelectController);class AbstractSmartSelect extends EditorAction{constructor(nt,ot){super(ot),this._forward=nt}run(nt,ot){return __awaiter$b(this,void 0,void 0,function*(){const rt=SmartSelectController.get(ot);rt&&(yield rt.run(this._forward))})}}class GrowSelectionAction extends AbstractSmartSelect{constructor(){super(!0,{id:"editor.action.smartSelect.expand",label:localize("smartSelect.expand","Expand Selection"),alias:"Expand Selection",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1553,mac:{primary:3345,secondary:[1297]},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"1_basic",title:localize({key:"miSmartSelectGrow",comment:["&& denotes a mnemonic"]},"&&Expand Selection"),order:2}})}}CommandsRegistry.registerCommandAlias("editor.action.smartSelect.grow","editor.action.smartSelect.expand");class ShrinkSelectionAction extends AbstractSmartSelect{constructor(){super(!1,{id:"editor.action.smartSelect.shrink",label:localize("smartSelect.shrink","Shrink Selection"),alias:"Shrink Selection",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1551,mac:{primary:3343,secondary:[1295]},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"1_basic",title:localize({key:"miSmartSelectShrink",comment:["&& denotes a mnemonic"]},"&&Shrink Selection"),order:3}})}}registerEditorContribution(SmartSelectController.ID,SmartSelectController,4);registerEditorAction(GrowSelectionAction);registerEditorAction(ShrinkSelectionAction);function provideSelectionRanges(ct,nt,ot,rt,ut){return __awaiter$b(this,void 0,void 0,function*(){const gt=ct.all(nt).concat(new WordSelectionRangeProvider);gt.length===1&&gt.unshift(new BracketSelectionRangeProvider);const pt=[],mt=[];for(const vt of gt)pt.push(Promise.resolve(vt.provideSelectionRanges(nt,ot,ut)).then(St=>{if(isNonEmptyArray(St)&&St.length===ot.length)for(let yt=0;yt<ot.length;yt++){mt[yt]||(mt[yt]=[]);for(const wt of St[yt])Range$2.isIRange(wt.range)&&Range$2.containsPosition(wt.range,ot[yt])&&mt[yt].push(Range$2.lift(wt.range))}},onUnexpectedExternalError));return yield Promise.all(pt),mt.map(vt=>{if(vt.length===0)return[];vt.sort((Lt,xt)=>Position$1.isBefore(Lt.getStartPosition(),xt.getStartPosition())?1:Position$1.isBefore(xt.getStartPosition(),Lt.getStartPosition())||Position$1.isBefore(Lt.getEndPosition(),xt.getEndPosition())?-1:Position$1.isBefore(xt.getEndPosition(),Lt.getEndPosition())?1:0);const St=[];let yt;for(const Lt of vt)(!yt||Range$2.containsRange(Lt,yt)&&!Range$2.equalsRange(Lt,yt))&&(St.push(Lt),yt=Lt);if(!rt.selectLeadingAndTrailingWhitespace)return St;const wt=[St[0]];for(let Lt=1;Lt<St.length;Lt++){const xt=St[Lt-1],It=St[Lt];if(It.startLineNumber!==xt.startLineNumber||It.endLineNumber!==xt.endLineNumber){const kt=new Range$2(xt.startLineNumber,nt.getLineFirstNonWhitespaceColumn(xt.startLineNumber),xt.endLineNumber,nt.getLineLastNonWhitespaceColumn(xt.endLineNumber));kt.containsRange(xt)&&!kt.equalsRange(xt)&&It.containsRange(kt)&&!It.equalsRange(kt)&&wt.push(kt);const At=new Range$2(xt.startLineNumber,1,xt.endLineNumber,nt.getLineMaxColumn(xt.endLineNumber));At.containsRange(xt)&&!At.equalsRange(kt)&&It.containsRange(At)&&!It.equalsRange(At)&&wt.push(At)}wt.push(It)}return wt})})}CommandsRegistry.registerCommand("_executeSelectionRangeProvider",function(ct,...nt){return __awaiter$b(this,void 0,void 0,function*(){const[ot,rt]=nt;assertType(URI.isUri(ot));const ut=ct.get(ILanguageFeaturesService).selectionRangeProvider,gt=yield ct.get(ITextModelService).createModelReference(ot);try{return provideSelectionRanges(ut,gt.object.textEditorModel,rt,{selectLeadingAndTrailingWhitespace:!0},CancellationToken.None)}finally{gt.dispose()}})});const Categories=Object.freeze({View:{value:localize("view","View"),original:"View"},Help:{value:localize("help","Help"),original:"Help"},Test:{value:localize("test","Test"),original:"Test"},File:{value:localize("file","File"),original:"File"},Preferences:{value:localize("preferences","Preferences"),original:"Preferences"},Developer:{value:localize({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer"),original:"Developer"}}),stickyScroll="";var _a;class StickyScrollWidgetState{constructor(nt,ot){this.lineNumbers=nt,this.lastLineRelativePosition=ot}}const _ttPolicy=(_a=window.trustedTypes)===null||_a===void 0?void 0:_a.createPolicy("stickyScrollViewLayer",{createHTML:ct=>ct});class StickyScrollWidget extends Disposable{constructor(nt){super(),this._editor=nt,this._rootDomNode=document.createElement("div"),this._disposableStore=this._register(new DisposableStore),this._lineNumbers=[],this._lastLineRelativePosition=0,this._hoverOnLine=-1,this._hoverOnColumn=-1,this._layoutInfo=this._editor.getLayoutInfo(),this._rootDomNode=document.createElement("div"),this._rootDomNode.className="sticky-widget",this._rootDomNode.classList.toggle("peek",nt instanceof EmbeddedCodeEditorWidget),this._rootDomNode.style.width=`${this._layoutInfo.width-this._layoutInfo.minimap.minimapCanvasOuterWidth-this._layoutInfo.verticalScrollbarWidth}px`}get hoverOnLine(){return this._hoverOnLine}get hoverOnColumn(){return this._hoverOnColumn}get lineNumbers(){return this._lineNumbers}getCurrentLines(){return this._lineNumbers}setState(nt){clearNode(this._rootDomNode),this._disposableStore.clear(),this._lineNumbers.length=0;const ot=this._editor.getOption(64);nt.lineNumbers.length*ot+nt.lastLineRelativePosition>0?(this._lastLineRelativePosition=nt.lastLineRelativePosition,this._lineNumbers=nt.lineNumbers):(this._lastLineRelativePosition=0,this._lineNumbers=[]),this._renderRootNode()}_renderRootNode(){if(!this._editor._getViewModel())return;for(const[ut,gt]of this._lineNumbers.entries()){const pt=this._renderChildNode(ut,gt);this._rootDomNode.appendChild(pt)}const nt=this._editor.getOption(64),ot=this._lineNumbers.length*nt+this._lastLineRelativePosition;this._rootDomNode.style.display=ot>0?"block":"none",this._rootDomNode.style.height=ot.toString()+"px",this._rootDomNode.setAttribute("role","list"),this._editor.getOption(70).side==="left"&&(this._rootDomNode.style.marginLeft=this._editor.getLayoutInfo().minimap.minimapCanvasOuterWidth+"px")}_renderChildNode(nt,ot){const rt=document.createElement("div"),ut=this._editor._getViewModel(),gt=ut.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(ot,1)).lineNumber,pt=ut.getViewLineRenderingData(gt),mt=this._editor.getLayoutInfo(),vt=mt.width-mt.minimap.minimapCanvasOuterWidth-mt.verticalScrollbarWidth,St=this._editor.getOption(70).side,yt=this._editor.getOption(64),wt=this._editor.getOption(65);let Lt;try{Lt=LineDecoration.filter(pt.inlineDecorations,gt,pt.minColumn,pt.maxColumn)}catch{Lt=[]}const xt=new RenderLineInput(!0,!0,pt.content,pt.continuesWithWrappedLine,pt.isBasicASCII,pt.containsRTL,0,pt.tokens,Lt,pt.tabSize,pt.startVisibleColumn,1,1,1,500,"none",!0,!0,null),It=new StringBuilder(2e3);renderViewLine(xt,It);let kt;_ttPolicy?kt=_ttPolicy.createHTML(It.build()):kt=It.build();const At=document.createElement("span");At.className="sticky-line",At.classList.add(`stickyLine${ot}`),At.style.lineHeight=`${yt}px`,At.innerHTML=kt;const Tt=document.createElement("span");Tt.className="sticky-line",Tt.style.lineHeight=`${yt}px`,St==="left"?Tt.style.width=`${mt.contentLeft-mt.minimap.minimapCanvasOuterWidth}px`:St==="right"&&(Tt.style.width=`${mt.contentLeft}px`);const Rt=document.createElement("span");return wt.renderType===1||wt.renderType===3&&ot%10===0?Rt.innerText=ot.toString():wt.renderType===2&&(Rt.innerText=Math.abs(ot-this._editor.getPosition().lineNumber).toString()),Rt.className="sticky-line-number",Rt.style.lineHeight=`${yt}px`,Rt.style.width=`${mt.lineNumbersWidth}px`,St==="left"?Rt.style.paddingLeft=`${mt.lineNumbersLeft-mt.minimap.minimapCanvasOuterWidth}px`:St==="right"&&(Rt.style.paddingLeft=`${mt.lineNumbersLeft}px`),Tt.appendChild(Rt),this._editor.applyFontInfo(At),this._editor.applyFontInfo(Rt),rt.appendChild(Tt),rt.appendChild(At),rt.className="sticky-line-root",rt.setAttribute("role","listitem"),rt.tabIndex=0,rt.style.lineHeight=`${yt}px`,rt.style.width=`${vt}px`,rt.style.height=`${yt}px`,rt.style.zIndex="0",nt===this._lineNumbers.length-1&&(rt.style.position="relative",rt.style.zIndex="-1",rt.style.top=this._lastLineRelativePosition+"px"),this._disposableStore.add(addDisposableListener(rt,"mouseover",Nt=>{if(this._editor.hasModel()){const Ft=new StandardMouseEvent(Nt).target.innerText;this._hoverOnLine=ot,this._hoverOnColumn=this._editor.getModel().getLineContent(ot).indexOf(Ft)+1||-1}})),rt}getId(){return"editor.contrib.stickyScrollWidget"}getDomNode(){return this._rootDomNode}getPosition(){return{preference:null}}}class StickyRange{constructor(nt,ot){this.startLineNumber=nt,this.endLineNumber=ot}}class StickyElement{constructor(nt,ot,rt){this.range=nt,this.children=ot,this.parent=rt}}class StickyModel{constructor(nt,ot,rt,ut){this.uri=nt,this.version=ot,this.element=rt,this.outlineProviderId=ut}}var __decorate$h=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$h=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$a=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},ModelProvider;(function(ct){ct.OUTLINE_MODEL="outlineModel",ct.FOLDING_PROVIDER_MODEL="foldingProviderModel",ct.INDENTATION_MODEL="indentationModel"})(ModelProvider||(ModelProvider={}));var Status;(function(ct){ct[ct.VALID=0]="VALID",ct[ct.INVALID=1]="INVALID",ct[ct.CANCELED=2]="CANCELED"})(Status||(Status={}));let StickyModelProvider=class{constructor(nt,ot,rt,ut){this._editor=nt,this._languageConfigurationService=ot,this._languageFeaturesService=rt,this._modelProviders=[],this._modelPromise=null,this._updateScheduler=new Delayer(300);const gt=new StickyModelFromCandidateOutlineProvider(rt),pt=new StickyModelFromCandidateSyntaxFoldingProvider(this._editor,rt),mt=new StickyModelFromCandidateIndentationFoldingProvider(this._editor,ot);switch(ut){case ModelProvider.OUTLINE_MODEL:this._modelProviders.push(gt),this._modelProviders.push(pt),this._modelProviders.push(mt);break;case ModelProvider.FOLDING_PROVIDER_MODEL:this._modelProviders.push(pt),this._modelProviders.push(mt);break;case ModelProvider.INDENTATION_MODEL:this._modelProviders.push(mt);break}this._store=new DisposableStore}_cancelModelPromise(){this._modelPromise&&(this._modelPromise.cancel(),this._modelPromise=null)}update(nt,ot,rt){return __awaiter$a(this,void 0,void 0,function*(){return this._store.clear(),this._store.add({dispose:()=>{var ut;this._cancelModelPromise(),(ut=this._updateScheduler)===null||ut===void 0||ut.cancel()}}),this._cancelModelPromise(),yield this._updateScheduler.trigger(()=>__awaiter$a(this,void 0,void 0,function*(){for(const ut of this._modelProviders){const{statusPromise:gt,modelPromise:pt}=ut.computeStickyModel(nt,ot,rt);this._modelPromise=pt;const mt=yield gt;if(this._modelPromise!==pt)return null;switch(mt){case Status.CANCELED:return this._store.clear(),null;case Status.VALID:return ut.stickyModel}}return null}))})}};StickyModelProvider=__decorate$h([__param$h(1,ILanguageConfigurationService),__param$h(2,ILanguageFeaturesService)],StickyModelProvider);class StickyModelCandidateProvider{constructor(){this._stickyModel=null}get stickyModel(){return this._stickyModel}_invalid(){return this._stickyModel=null,Status.INVALID}computeStickyModel(nt,ot,rt){if(!this.isProviderValid(nt))return{statusPromise:this._invalid(),modelPromise:null};const ut=createCancelablePromise(gt=>this.createModelFromProvider(nt,ot,gt));return{statusPromise:ut.then(gt=>this.isModelValid(gt)?rt.isCancellationRequested?Status.CANCELED:(this._stickyModel=this.createStickyModel(nt,ot,rt,gt),Status.VALID):this._invalid()).then(void 0,gt=>(onUnexpectedError(gt),Status.CANCELED)),modelPromise:ut}}isModelValid(nt){return!0}isProviderValid(nt){return!0}}let StickyModelFromCandidateOutlineProvider=class extends StickyModelCandidateProvider{constructor(nt){super(),this._languageFeaturesService=nt}createModelFromProvider(nt,ot,rt){return OutlineModel.create(this._languageFeaturesService.documentSymbolProvider,nt,rt)}createStickyModel(nt,ot,rt,ut){var gt;const{stickyOutlineElement:pt,providerID:mt}=this._stickyModelFromOutlineModel(ut,(gt=this._stickyModel)===null||gt===void 0?void 0:gt.outlineProviderId);return new StickyModel(nt.uri,ot,pt,mt)}isModelValid(nt){return nt&&nt.children.size>0}_stickyModelFromOutlineModel(nt,ot){let rt;if(Iterable.first(nt.children.values())instanceof OutlineGroup){const mt=Iterable.find(nt.children.values(),vt=>vt.id===ot);if(mt)rt=mt.children;else{let vt="",St=-1,yt;for(const[wt,Lt]of nt.children.entries()){const xt=this._findSumOfRangesOfGroup(Lt);xt>St&&(yt=Lt,St=xt,vt=Lt.id)}ot=vt,rt=yt.children}}else rt=nt.children;const ut=[],gt=Array.from(rt.values()).sort((mt,vt)=>{const St=new StickyRange(mt.symbol.range.startLineNumber,mt.symbol.range.endLineNumber),yt=new StickyRange(vt.symbol.range.startLineNumber,vt.symbol.range.endLineNumber);return this._comparator(St,yt)});for(const mt of gt)ut.push(this._stickyModelFromOutlineElement(mt,mt.symbol.selectionRange.startLineNumber));return{stickyOutlineElement:new StickyElement(void 0,ut,void 0),providerID:ot}}_stickyModelFromOutlineElement(nt,ot){const rt=[];for(const gt of nt.children.values())if(gt.symbol.selectionRange.startLineNumber!==gt.symbol.range.endLineNumber)if(gt.symbol.selectionRange.startLineNumber!==ot)rt.push(this._stickyModelFromOutlineElement(gt,gt.symbol.selectionRange.startLineNumber));else for(const pt of gt.children.values())rt.push(this._stickyModelFromOutlineElement(pt,gt.symbol.selectionRange.startLineNumber));rt.sort((gt,pt)=>this._comparator(gt.range,pt.range));const ut=new StickyRange(nt.symbol.selectionRange.startLineNumber,nt.symbol.range.endLineNumber);return new StickyElement(ut,rt,void 0)}_comparator(nt,ot){return nt.startLineNumber!==ot.startLineNumber?nt.startLineNumber-ot.startLineNumber:ot.endLineNumber-nt.endLineNumber}_findSumOfRangesOfGroup(nt){let ot=0;for(const rt of nt.children.values())ot+=this._findSumOfRangesOfGroup(rt);return nt instanceof OutlineElement?ot+nt.symbol.range.endLineNumber-nt.symbol.selectionRange.startLineNumber:ot}};StickyModelFromCandidateOutlineProvider=__decorate$h([__param$h(0,ILanguageFeaturesService)],StickyModelFromCandidateOutlineProvider);class StickyModelFromCandidateFoldingProvider extends StickyModelCandidateProvider{constructor(nt){super(),this._foldingLimitReporter=new RangesLimitReporter(nt)}createStickyModel(nt,ot,rt,ut){const gt=this._fromFoldingRegions(ut);return new StickyModel(nt.uri,ot,gt,void 0)}isModelValid(nt){return nt!==null}_fromFoldingRegions(nt){const ot=nt.length,rt=[],ut=new StickyElement(void 0,[],void 0);for(let gt=0;gt<ot;gt++){const pt=nt.getParentIndex(gt);let mt;pt!==-1?mt=rt[pt]:mt=ut;const vt=new StickyElement(new StickyRange(nt.getStartLineNumber(gt),nt.getEndLineNumber(gt)+1),[],mt);mt.children.push(vt),rt.push(vt)}return ut}}let StickyModelFromCandidateIndentationFoldingProvider=class extends StickyModelFromCandidateFoldingProvider{constructor(nt,ot){super(nt),this._languageConfigurationService=ot}createModelFromProvider(nt,ot,rt){return new IndentRangeProvider(nt,this._languageConfigurationService,this._foldingLimitReporter).compute(rt)}};StickyModelFromCandidateIndentationFoldingProvider=__decorate$h([__param$h(1,ILanguageConfigurationService)],StickyModelFromCandidateIndentationFoldingProvider);let StickyModelFromCandidateSyntaxFoldingProvider=class extends StickyModelFromCandidateFoldingProvider{constructor(nt,ot){super(nt),this._languageFeaturesService=ot}isProviderValid(nt){return FoldingController.getFoldingRangeProviders(this._languageFeaturesService,nt).length>0}createModelFromProvider(nt,ot,rt){const ut=FoldingController.getFoldingRangeProviders(this._languageFeaturesService,nt);return new SyntaxRangeProvider(nt,ut,()=>this.createModelFromProvider(nt,ot,rt),this._foldingLimitReporter,void 0).compute(rt)}};StickyModelFromCandidateSyntaxFoldingProvider=__decorate$h([__param$h(1,ILanguageFeaturesService)],StickyModelFromCandidateSyntaxFoldingProvider);var __decorate$g=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$g=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$9=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class StickyLineCandidate{constructor(nt,ot,rt){this.startLineNumber=nt,this.endLineNumber=ot,this.nestingDepth=rt}}let StickyLineCandidateProvider=class extends Disposable{constructor(nt,ot,rt){super(),this._languageFeaturesService=ot,this._languageConfigurationService=rt,this._onDidChangeStickyScroll=this._store.add(new Emitter$2),this.onDidChangeStickyScroll=this._onDidChangeStickyScroll.event,this._options=null,this._model=null,this._cts=null,this._stickyModelProvider=null,this._editor=nt,this._sessionStore=new DisposableStore,this._updateSoon=this._register(new RunOnceScheduler(()=>this.update(),50)),this._register(this._editor.onDidChangeConfiguration(ut=>{ut.hasChanged(110)&&this.readConfiguration()})),this.readConfiguration()}dispose(){super.dispose(),this._sessionStore.dispose()}readConfiguration(){if(this._options=this._editor.getOption(110),!this._options.enabled){this._sessionStore.clear();return}this._stickyModelProvider=new StickyModelProvider(this._editor,this._languageConfigurationService,this._languageFeaturesService,this._options.defaultModel),this._sessionStore.add(this._editor.onDidChangeModel(()=>this.update())),this._sessionStore.add(this._editor.onDidChangeHiddenAreas(()=>this.update())),this._sessionStore.add(this._editor.onDidChangeModelContent(()=>this._updateSoon.schedule())),this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(()=>this.update())),this.update()}getVersionId(){var nt;return(nt=this._model)===null||nt===void 0?void 0:nt.version}update(){var nt;return __awaiter$9(this,void 0,void 0,function*(){(nt=this._cts)===null||nt===void 0||nt.dispose(!0),this._cts=new CancellationTokenSource$1,yield this.updateStickyModel(this._cts.token),this._onDidChangeStickyScroll.fire()})}updateStickyModel(nt){return __awaiter$9(this,void 0,void 0,function*(){if(!this._editor.hasModel()||!this._stickyModelProvider)return;const ot=this._editor.getModel(),rt=ot.getVersionId(),gt=(this._model?!isEqual(this._model.uri,ot.uri):!1)?setTimeout(()=>{nt.isCancellationRequested||(this._model=new StickyModel(ot.uri,ot.getVersionId(),void 0,void 0),this._onDidChangeStickyScroll.fire())},75):void 0;this._model=yield this._stickyModelProvider.update(ot,rt,nt),clearTimeout(gt)})}updateIndex(nt){return nt===-1?nt=0:nt<0&&(nt=-nt-2),nt}getCandidateStickyLinesIntersectingFromStickyModel(nt,ot,rt,ut,gt){if(ot.children.length===0)return;let pt=gt;const mt=[];for(let yt=0;yt<ot.children.length;yt++){const wt=ot.children[yt];wt.range&&mt.push(wt.range.startLineNumber)}const vt=this.updateIndex(binarySearch(mt,nt.startLineNumber,(yt,wt)=>yt-wt)),St=this.updateIndex(binarySearch(mt,nt.startLineNumber+ut,(yt,wt)=>yt-wt));for(let yt=vt;yt<=St;yt++){const wt=ot.children[yt];if(!wt)return;if(wt.range){const Lt=wt.range.startLineNumber,xt=wt.range.endLineNumber;nt.startLineNumber<=xt+1&&Lt-1<=nt.endLineNumber&&Lt!==pt&&(pt=Lt,rt.push(new StickyLineCandidate(Lt,xt-1,ut+1)),this.getCandidateStickyLinesIntersectingFromStickyModel(nt,wt,rt,ut+1,Lt))}else this.getCandidateStickyLinesIntersectingFromStickyModel(nt,wt,rt,ut,gt)}}getCandidateStickyLinesIntersecting(nt){var ot,rt;if(!(!((ot=this._model)===null||ot===void 0)&&ot.element))return[];let ut=[];this.getCandidateStickyLinesIntersectingFromStickyModel(nt,this._model.element,ut,0,-1);const gt=(rt=this._editor._getViewModel())===null||rt===void 0?void 0:rt.getHiddenAreas();if(gt)for(const pt of gt)ut=ut.filter(mt=>!(mt.startLineNumber>=pt.startLineNumber&&mt.endLineNumber<=pt.endLineNumber+1));return ut}};StickyLineCandidateProvider=__decorate$g([__param$g(1,ILanguageFeaturesService),__param$g(2,ILanguageConfigurationService)],StickyLineCandidateProvider);var __decorate$f=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$f=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$8=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let StickyScrollController=class Fr extends Disposable{constructor(nt,ot,rt,ut,gt,pt,mt){super(),this._editor=nt,this._contextMenuService=ot,this._languageFeaturesService=rt,this._instaService=ut,this._contextKeyService=mt,this._sessionStore=new DisposableStore,this._maxStickyLines=Number.MAX_SAFE_INTEGER,this._candidateDefinitionsLength=-1,this._focusedStickyElementIndex=-1,this._enabled=!1,this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1,this._stickyScrollWidget=new StickyScrollWidget(this._editor),this._stickyLineCandidateProvider=new StickyLineCandidateProvider(this._editor,rt,gt),this._register(this._stickyScrollWidget),this._register(this._stickyLineCandidateProvider),this._widgetState=new StickyScrollWidgetState([],0),this._readConfiguration(),this._register(this._editor.onDidChangeConfiguration(St=>{St.hasChanged(110)&&this._readConfiguration()})),this._register(addDisposableListener(this._stickyScrollWidget.getDomNode(),EventType$1.CONTEXT_MENU,St=>__awaiter$8(this,void 0,void 0,function*(){this._onContextMenu(St)}))),this._stickyScrollFocusedContextKey=EditorContextKeys.stickyScrollFocused.bindTo(this._contextKeyService),this._stickyScrollVisibleContextKey=EditorContextKeys.stickyScrollVisible.bindTo(this._contextKeyService);const vt=this._register(trackFocus(this._stickyScrollWidget.getDomNode()));this._register(vt.onDidBlur(St=>{const yt=this._stickyScrollWidget.getDomNode().clientHeight;this._positionRevealed===!1&&yt===0?(this._focusedStickyElementIndex=-1,this.focus()):this._disposeFocusStickyScrollStore()})),this._register(vt.onDidFocus(St=>{this.focus()})),this._register(this._createClickLinkGesture()),this._register(addDisposableListener(this._stickyScrollWidget.getDomNode(),EventType$1.MOUSE_DOWN,St=>{this._onMouseDown=!0}))}static get(nt){return nt.getContribution(Fr.ID)}_disposeFocusStickyScrollStore(){var nt;this._stickyScrollFocusedContextKey.set(!1),(nt=this._focusDisposableStore)===null||nt===void 0||nt.dispose(),this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1}focus(){if(this._onMouseDown){this._onMouseDown=!1,this._editor.focus();return}if(this._stickyScrollFocusedContextKey.get()===!0)return;this._focused=!0,this._focusDisposableStore=new DisposableStore,this._stickyScrollFocusedContextKey.set(!0);const ot=this._stickyScrollWidget.getDomNode();ot.lastElementChild.focus(),this._stickyElements=ot.children,this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumbers.length-1}focusNext(){this._focusedStickyElementIndex<this._stickyElements.length-1&&this._focusNav(!0)}focusPrevious(){this._focusedStickyElementIndex>0&&this._focusNav(!1)}selectEditor(){this._editor.focus()}_focusNav(nt){this._focusedStickyElementIndex=nt?this._focusedStickyElementIndex+1:this._focusedStickyElementIndex-1,this._stickyElements.item(this._focusedStickyElementIndex).focus()}goToFocused(){const nt=this._stickyScrollWidget.lineNumbers;this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:nt[this._focusedStickyElementIndex],column:1})}_revealPosition(nt){this._positionRevealed=!0,this._editor.revealPosition(nt),this._editor.setSelection(Range$2.fromPositions(nt)),this._editor.focus()}_createClickLinkGesture(){const nt=new DisposableStore,ot=new DisposableStore;nt.add(ot);const rt=new ClickLinkGesture(this._editor,!0);return nt.add(rt),nt.add(rt.onMouseMoveOrRelevantKeyDown(([ut,gt])=>{if(!this._editor.hasModel()||!ut.hasTriggerModifier){ot.clear();return}const pt=ut.target;if(pt.detail===this._stickyScrollWidget.getId()&&pt.element.innerText===pt.element.innerHTML){const mt=pt.element.innerText;if(this._stickyScrollWidget.hoverOnColumn===-1)return;const vt=this._stickyScrollWidget.hoverOnLine,St=this._stickyScrollWidget.hoverOnColumn,yt=new Range$2(vt,St,vt,St+mt.length);if(!yt.equalsRange(this._stickyRangeProjectedOnEditor))this._stickyRangeProjectedOnEditor=yt,ot.clear();else if(pt.element.style.textDecoration==="underline")return;const wt=new CancellationTokenSource$1;ot.add(toDisposable(()=>wt.dispose(!0)));let Lt;getDefinitionsAtPosition(this._languageFeaturesService.definitionProvider,this._editor.getModel(),new Position$1(vt,St+1),wt.token).then(xt=>{if(!wt.token.isCancellationRequested)if(xt.length!==0){this._candidateDefinitionsLength=xt.length;const It=pt.element;Lt!==It?(ot.clear(),Lt=It,Lt.style.textDecoration="underline",ot.add(toDisposable(()=>{Lt.style.textDecoration="none"}))):Lt||(Lt=It,Lt.style.textDecoration="underline",ot.add(toDisposable(()=>{Lt.style.textDecoration="none"})))}else ot.clear()})}else ot.clear()})),nt.add(rt.onCancel(()=>{ot.clear()})),nt.add(rt.onExecute(ut=>__awaiter$8(this,void 0,void 0,function*(){ut.target.detail===this._stickyScrollWidget.getId()&&(ut.hasTriggerModifier?(this._candidateDefinitionsLength>1&&(this._focused&&this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:this._stickyScrollWidget.hoverOnLine,column:1})),this._instaService.invokeFunction(goToDefinitionWithLocation,ut,this._editor,{uri:this._editor.getModel().uri,range:this._stickyRangeProjectedOnEditor})):ut.isRightClick||(this._focused&&this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:this._stickyScrollWidget.hoverOnLine,column:this._stickyScrollWidget.hoverOnColumn})))}))),nt}_onContextMenu(nt){this._contextMenuService.showContextMenu({menuId:MenuId.StickyScrollContext,getAnchor:()=>nt})}_readConfiguration(){const nt=this._editor.getOption(110);if(nt.enabled===!1){this._editor.removeOverlayWidget(this._stickyScrollWidget),this._sessionStore.clear(),this._enabled=!1;return}else nt.enabled&&!this._enabled&&(this._editor.addOverlayWidget(this._stickyScrollWidget),this._sessionStore.add(this._editor.onDidScrollChange(()=>this._renderStickyScroll())),this._sessionStore.add(this._editor.onDidLayoutChange(()=>this._onDidResize())),this._sessionStore.add(this._editor.onDidChangeModelTokens(rt=>this._onTokensChange(rt))),this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(()=>this._renderStickyScroll())),this._enabled=!0);this._editor.getOption(65).renderType===2&&this._sessionStore.add(this._editor.onDidChangeCursorPosition(()=>this._renderStickyScroll()))}_needsUpdate(nt){const ot=this._stickyScrollWidget.getCurrentLines();for(const rt of ot)for(const ut of nt.ranges)if(rt>=ut.fromLineNumber&&rt<=ut.toLineNumber)return!0;return!1}_onTokensChange(nt){this._needsUpdate(nt)&&this._renderStickyScroll()}_onDidResize(){const nt=this._editor.getLayoutInfo(),ot=nt.width-nt.minimap.minimapCanvasOuterWidth-nt.verticalScrollbarWidth;this._stickyScrollWidget.getDomNode().style.width=`${ot}px`;const rt=nt.height/this._editor.getOption(64);this._maxStickyLines=Math.round(rt*.25)}_renderStickyScroll(){if(!this._editor.hasModel())return;const nt=this._editor.getModel(),ot=this._stickyLineCandidateProvider.getVersionId();if(ot===void 0||ot===nt.getVersionId())if(this._widgetState=this.findScrollWidgetState(),this._stickyScrollVisibleContextKey.set(this._widgetState.lineNumbers.length!==0),!this._focused)this._stickyScrollWidget.setState(this._widgetState);else if(this._stickyElements=this._stickyScrollWidget.getDomNode().children,this._focusedStickyElementIndex===-1)this._stickyScrollWidget.setState(this._widgetState),this._focusedStickyElementIndex=this._stickyElements.length-1,this._focusedStickyElementIndex!==-1&&this._stickyElements.item(this._focusedStickyElementIndex).focus();else{const rt=this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];this._stickyScrollWidget.setState(this._widgetState),this._stickyElements.length===0?this._focusedStickyElementIndex=-1:(this._stickyScrollWidget.lineNumbers.includes(rt)||(this._focusedStickyElementIndex=this._stickyElements.length-1),this._stickyElements.item(this._focusedStickyElementIndex).focus())}}findScrollWidgetState(){const nt=this._editor.getOption(64),ot=Math.min(this._maxStickyLines,this._editor.getOption(110).maxLineCount),rt=this._editor.getScrollTop();let ut=0;const gt=[],pt=this._editor.getVisibleRanges();if(pt.length!==0){const mt=new StickyRange(pt[0].startLineNumber,pt[pt.length-1].endLineNumber),vt=this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(mt);for(const St of vt){const yt=St.startLineNumber,wt=St.endLineNumber,Lt=St.nestingDepth;if(wt-yt>0){const xt=(Lt-1)*nt,It=Lt*nt,kt=this._editor.getBottomForLineNumber(yt)-rt,At=this._editor.getTopForLineNumber(wt)-rt,Tt=this._editor.getBottomForLineNumber(wt)-rt;if(xt>At&&xt<=Tt){gt.push(yt),ut=Tt-It;break}else It>kt&&It<=Tt&&gt.push(yt);if(gt.length===ot)break}}}return new StickyScrollWidgetState(gt,ut)}dispose(){super.dispose(),this._sessionStore.dispose()}};StickyScrollController.ID="store.contrib.stickyScrollController";StickyScrollController=__decorate$f([__param$f(1,IContextMenuService),__param$f(2,ILanguageFeaturesService),__param$f(3,IInstantiationService),__param$f(4,ILanguageConfigurationService),__param$f(5,ILanguageFeatureDebounceService),__param$f(6,IContextKeyService)],StickyScrollController);var __awaiter$7=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class ToggleStickyScroll extends Action2{constructor(){super({id:"editor.action.toggleStickyScroll",title:{value:localize("toggleStickyScroll","Toggle Sticky Scroll"),mnemonicTitle:localize({key:"mitoggleStickyScroll",comment:["&& denotes a mnemonic"]},"&&Toggle Sticky Scroll"),original:"Toggle Sticky Scroll"},category:Categories.View,toggled:{condition:ContextKeyExpr.equals("config.editor.stickyScroll.enabled",!0),title:localize("stickyScroll","Sticky Scroll"),mnemonicTitle:localize({key:"miStickyScroll",comment:["&& denotes a mnemonic"]},"&&Sticky Scroll")},menu:[{id:MenuId.CommandPalette},{id:MenuId.MenubarViewMenu,group:"5_editor",order:2},{id:MenuId.StickyScrollContext}]})}run(nt){return __awaiter$7(this,void 0,void 0,function*(){const ot=nt.get(IConfigurationService),rt=!ot.getValue("editor.stickyScroll.enabled");return ot.updateValue("editor.stickyScroll.enabled",rt)})}}const weight=100;class FocusStickyScroll extends EditorAction2{constructor(){super({id:"editor.action.focusStickyScroll",title:{value:localize("focusStickyScroll","Focus Sticky Scroll"),mnemonicTitle:localize({key:"mifocusStickyScroll",comment:["&& denotes a mnemonic"]},"&&Focus Sticky Scroll"),original:"Focus Sticky Scroll"},precondition:ContextKeyExpr.and(ContextKeyExpr.has("config.editor.stickyScroll.enabled"),EditorContextKeys.stickyScrollVisible),menu:[{id:MenuId.CommandPalette}]})}runEditorCommand(nt,ot){var rt;(rt=StickyScrollController.get(ot))===null||rt===void 0||rt.focus()}}class SelectNextStickyScrollLine extends EditorAction2{constructor(){super({id:"editor.action.selectNextStickyScrollLine",title:{value:localize("selectNextStickyScrollLine.title","Select next sticky scroll line"),original:"Select next sticky scroll line"},precondition:EditorContextKeys.stickyScrollFocused.isEqualTo(!0),keybinding:{weight,primary:18}})}runEditorCommand(nt,ot){var rt;(rt=StickyScrollController.get(ot))===null||rt===void 0||rt.focusNext()}}class SelectPreviousStickyScrollLine extends EditorAction2{constructor(){super({id:"editor.action.selectPreviousStickyScrollLine",title:{value:localize("selectPreviousStickyScrollLine.title","Select previous sticky scroll line"),original:"Select previous sticky scroll line"},precondition:EditorContextKeys.stickyScrollFocused.isEqualTo(!0),keybinding:{weight,primary:16}})}runEditorCommand(nt,ot){var rt;(rt=StickyScrollController.get(ot))===null||rt===void 0||rt.focusPrevious()}}class GoToStickyScrollLine extends EditorAction2{constructor(){super({id:"editor.action.goToFocusedStickyScrollLine",title:{value:localize("goToFocusedStickyScrollLine.title","Go to focused sticky scroll line"),original:"Go to focused sticky scroll line"},precondition:EditorContextKeys.stickyScrollFocused.isEqualTo(!0),keybinding:{weight,primary:3}})}runEditorCommand(nt,ot){var rt;(rt=StickyScrollController.get(ot))===null||rt===void 0||rt.goToFocused()}}class SelectEditor extends EditorAction2{constructor(){super({id:"editor.action.selectEditor",title:{value:localize("selectEditor.title","Select Editor"),original:"Select Editor"},precondition:EditorContextKeys.stickyScrollFocused.isEqualTo(!0),keybinding:{weight,primary:9}})}runEditorCommand(nt,ot){var rt;(rt=StickyScrollController.get(ot))===null||rt===void 0||rt.selectEditor()}}registerEditorContribution(StickyScrollController.ID,StickyScrollController,1);registerAction2(ToggleStickyScroll);registerAction2(FocusStickyScroll);registerAction2(SelectPreviousStickyScrollLine);registerAction2(SelectNextStickyScrollLine);registerAction2(GoToStickyScrollLine);registerAction2(SelectEditor);var __decorate$e=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$e=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$6=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};class SuggestInlineCompletion{constructor(nt,ot,rt,ut,gt,pt){this.range=nt,this.insertText=ot,this.filterText=rt,this.additionalTextEdits=ut,this.command=gt,this.completion=pt}}let InlineCompletionResults=class extends RefCountedDisposable{constructor(nt,ot,rt,ut,gt,pt){super(gt.disposable),this.model=nt,this.line=ot,this.word=rt,this.completionModel=ut,this._suggestMemoryService=pt}canBeReused(nt,ot,rt){return this.model===nt&&this.line===ot&&this.word.word.length>0&&this.word.startColumn===rt.startColumn&&this.word.endColumn<rt.endColumn&&this.completionModel.getIncompleteProvider().size===0}get items(){var nt;const ot=[],{items:rt}=this.completionModel,ut=this._suggestMemoryService.select(this.model,{lineNumber:this.line,column:this.word.endColumn+this.completionModel.lineContext.characterCountDelta},rt),gt=Iterable.slice(rt,ut),pt=Iterable.slice(rt,0,ut);let mt=5;for(const vt of Iterable.concat(gt,pt)){if(vt.score===FuzzyScore.Default)continue;const St=new Range$2(vt.editStart.lineNumber,vt.editStart.column,vt.editInsertEnd.lineNumber,vt.editInsertEnd.column+this.completionModel.lineContext.characterCountDelta),yt=vt.completion.insertTextRules&&vt.completion.insertTextRules&4?{snippet:vt.completion.insertText}:vt.completion.insertText;ot.push(new SuggestInlineCompletion(St,yt,(nt=vt.filterTextLow)!==null&&nt!==void 0?nt:vt.labelLow,vt.completion.additionalTextEdits,vt.completion.command,vt)),mt-->=0&&vt.resolve(CancellationToken.None)}return ot}};InlineCompletionResults=__decorate$e([__param$e(5,ISuggestMemoryService)],InlineCompletionResults);let SuggestInlineCompletions=class{constructor(nt,ot,rt,ut){this._getEditorOption=nt,this._languageFeatureService=ot,this._clipboardService=rt,this._suggestMemoryService=ut}provideInlineCompletions(nt,ot,rt,ut){var gt;return __awaiter$6(this,void 0,void 0,function*(){if(rt.selectedSuggestionInfo)return;const pt=this._getEditorOption(85,nt);if(QuickSuggestionsOptions.isAllOff(pt))return;nt.tokenization.tokenizeIfCheap(ot.lineNumber);const mt=nt.tokenization.getLineTokens(ot.lineNumber),vt=mt.getStandardTokenType(mt.findTokenIndexAtOffset(Math.max(ot.column-1-1,0)));if(QuickSuggestionsOptions.valueFor(pt,vt)!=="inline")return;let St=nt.getWordAtPosition(ot),yt;if(St!=null&&St.word||(yt=this._getTriggerCharacterInfo(nt,ot)),!(St!=null&&St.word)&&!yt||(St||(St=nt.getWordUntilPosition(ot)),St.endColumn!==ot.column))return;let wt;const Lt=nt.getValueInRange(new Range$2(ot.lineNumber,1,ot.lineNumber,ot.column));if(!yt&&(!((gt=this._lastResult)===null||gt===void 0)&&gt.canBeReused(nt,ot.lineNumber,St))){const xt=new LineContext$1(Lt,ot.column-this._lastResult.word.endColumn);this._lastResult.completionModel.lineContext=xt,this._lastResult.acquire(),wt=this._lastResult}else{const xt=yield provideSuggestionItems(this._languageFeatureService.completionProvider,nt,ot,new CompletionOptions(void 0,void 0,yt==null?void 0:yt.providers),yt&&{triggerKind:1,triggerCharacter:yt.ch},ut);let It;xt.needsClipboard&&(It=yield this._clipboardService.readText());const kt=new CompletionModel(xt.items,ot.column,new LineContext$1(Lt,0),WordDistance.None,this._getEditorOption(113,nt),this._getEditorOption(107,nt),{boostFullMatch:!1,firstMatchCanBeWeak:!1},It);wt=new InlineCompletionResults(nt,ot.lineNumber,St,kt,xt,this._suggestMemoryService)}return this._lastResult=wt,wt})}handleItemDidShow(nt,ot){ot.completion.resolve(CancellationToken.None)}freeInlineCompletions(nt){nt.release()}_getTriggerCharacterInfo(nt,ot){var rt;const ut=nt.getValueInRange(Range$2.fromPositions({lineNumber:ot.lineNumber,column:ot.column-1},ot)),gt=new Set;for(const pt of this._languageFeatureService.completionProvider.all(nt))!((rt=pt.triggerCharacters)===null||rt===void 0)&&rt.includes(ut)&&gt.add(pt);if(gt.size!==0)return{providers:gt,ch:ut}}};SuggestInlineCompletions=__decorate$e([__param$e(1,ILanguageFeaturesService),__param$e(2,IClipboardService),__param$e(3,ISuggestMemoryService)],SuggestInlineCompletions);let EditorContribution=class vo{constructor(nt,ot,rt,ut){if(++vo._counter===1){const gt=ut.createInstance(SuggestInlineCompletions,(pt,mt)=>{var vt;return((vt=rt.listCodeEditors().find(yt=>yt.getModel()===mt))!==null&&vt!==void 0?vt:nt).getOption(pt)});vo._disposable=ot.inlineCompletionsProvider.register("*",gt)}}dispose(){var nt;--vo._counter===0&&((nt=vo._disposable)===null||nt===void 0||nt.dispose(),vo._disposable=void 0)}};EditorContribution._counter=0;EditorContribution=__decorate$e([__param$e(1,ILanguageFeaturesService),__param$e(2,ICodeEditorService),__param$e(3,IInstantiationService)],EditorContribution);registerEditorContribution("suggest.inlineCompletionsProvider",EditorContribution,0);class ForceRetokenizeAction extends EditorAction{constructor(){super({id:"editor.action.forceRetokenize",label:localize("forceRetokenize","Developer: Force Retokenize"),alias:"Developer: Force Retokenize",precondition:void 0})}run(nt,ot){if(!ot.hasModel())return;const rt=ot.getModel();rt.tokenization.resetTokenization();const ut=new StopWatch(!0);rt.tokenization.forceTokenization(rt.getLineCount()),ut.stop(),console.log(`tokenization took ${ut.elapsed()}`)}}registerEditorAction(ForceRetokenizeAction);class ToggleTabFocusModeAction extends Action2{constructor(){super({id:ToggleTabFocusModeAction.ID,title:{value:localize({key:"toggle.tabMovesFocus",comment:["Turn on/off use of tab key for moving focus around VS Code"]},"Toggle Tab Key Moves Focus"),original:"Toggle Tab Key Moves Focus"},precondition:void 0,keybinding:{primary:2091,mac:{primary:1323},weight:100},f1:!0})}run(nt){const ot=nt.get(IContextKeyService).getContextKeyValue("focusedView")==="terminal"?"terminalFocus":"editorFocus",ut=!TabFocus.getTabFocusMode(ot);TabFocus.setTabFocusMode(ut,ot),alert(ut?localize("toggle.tabMovesFocus.on","Pressing Tab will now move focus to the next focusable element"):localize("toggle.tabMovesFocus.off","Pressing Tab will now insert the tab character"))}}ToggleTabFocusModeAction.ID="editor.action.toggleTabFocusMode";registerAction2(ToggleTabFocusModeAction);const unicodeHighlighter="",bannerController="",link="";var __decorate$d=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$d=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let Link=class extends Disposable{get enabled(){return this._enabled}set enabled(nt){nt?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=nt}constructor(nt,ot,rt={},ut){var gt;super(),this._link=ot,this._enabled=!0,this.el=append$1(nt,$$d("a.monaco-link",{tabIndex:(gt=ot.tabIndex)!==null&&gt!==void 0?gt:0,href:ot.href,title:ot.title},ot.label)),this.el.setAttribute("role","button");const pt=this._register(new DomEmitter(this.el,"click")),mt=this._register(new DomEmitter(this.el,"keypress")),vt=Event.chain(mt.event).map(wt=>new StandardKeyboardEvent(wt)).filter(wt=>wt.keyCode===3).event,St=this._register(new DomEmitter(this.el,EventType.Tap)).event;this._register(Gesture.addTarget(this.el));const yt=Event.any(pt.event,vt,St);this._register(yt(wt=>{this.enabled&&(EventHelper.stop(wt,!0),rt!=null&&rt.opener?rt.opener(this._link.href):ut.open(this._link.href,{allowCommands:!0}))})),this.enabled=!0}};Link=__decorate$d([__param$d(3,IOpenerService)],Link);var __decorate$c=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$c=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const BANNER_ELEMENT_HEIGHT=26;let BannerController=class extends Disposable{constructor(nt,ot){super(),this._editor=nt,this.instantiationService=ot,this.banner=this._register(this.instantiationService.createInstance(Banner))}hide(){this._editor.setBanner(null,0),this.banner.clear()}show(nt){this.banner.show(Object.assign(Object.assign({},nt),{onClose:()=>{var ot;this.hide(),(ot=nt.onClose)===null||ot===void 0||ot.call(nt)}})),this._editor.setBanner(this.banner.element,BANNER_ELEMENT_HEIGHT)}};BannerController=__decorate$c([__param$c(1,IInstantiationService)],BannerController);let Banner=class extends Disposable{constructor(nt){super(),this.instantiationService=nt,this.markdownRenderer=this.instantiationService.createInstance(MarkdownRenderer,{}),this.element=$$d("div.editor-banner"),this.element.tabIndex=0}getAriaLabel(nt){if(nt.ariaLabel)return nt.ariaLabel;if(typeof nt.message=="string")return nt.message}getBannerMessage(nt){if(typeof nt=="string"){const ot=$$d("span");return ot.innerText=nt,ot}return this.markdownRenderer.render(nt).element}clear(){clearNode(this.element)}show(nt){clearNode(this.element);const ot=this.getAriaLabel(nt);ot&&this.element.setAttribute("aria-label",ot);const rt=append$1(this.element,$$d("div.icon-container"));rt.setAttribute("aria-hidden","true"),nt.icon&&rt.appendChild($$d(`div${ThemeIcon.asCSSSelector(nt.icon)}`));const ut=append$1(this.element,$$d("div.message-container"));if(ut.setAttribute("aria-hidden","true"),ut.appendChild(this.getBannerMessage(nt.message)),this.messageActionsContainer=append$1(this.element,$$d("div.message-actions-container")),nt.actions)for(const pt of nt.actions)this._register(this.instantiationService.createInstance(Link,this.messageActionsContainer,Object.assign(Object.assign({},pt),{tabIndex:-1}),{}));const gt=append$1(this.element,$$d("div.action-container"));this.actionBar=this._register(new ActionBar(gt)),this.actionBar.push(this._register(new Action("banner.close","Close Banner",ThemeIcon.asClassName(widgetClose),!0,()=>{typeof nt.onClose=="function"&&nt.onClose()})),{icon:!0,label:!1}),this.actionBar.setFocusable(!1)}};Banner=__decorate$c([__param$c(0,IInstantiationService)],Banner);var __decorate$b=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$b=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$5=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const warningIcon=registerIcon("extensions-warning-message",Codicon.warning,localize("warningIcon","Icon shown with a warning message in the extensions editor."));let UnicodeHighlighter=class extends Disposable{constructor(nt,ot,rt,ut){super(),this._editor=nt,this._editorWorkerService=ot,this._workspaceTrustService=rt,this._highlighter=null,this._bannerClosed=!1,this._updateState=gt=>{if(gt&&gt.hasMore){if(this._bannerClosed)return;const pt=Math.max(gt.ambiguousCharacterCount,gt.nonBasicAsciiCharacterCount,gt.invisibleCharacterCount);let mt;if(gt.nonBasicAsciiCharacterCount>=pt)mt={message:localize("unicodeHighlighting.thisDocumentHasManyNonBasicAsciiUnicodeCharacters","This document contains many non-basic ASCII unicode characters"),command:new DisableHighlightingOfNonBasicAsciiCharactersAction};else if(gt.ambiguousCharacterCount>=pt)mt={message:localize("unicodeHighlighting.thisDocumentHasManyAmbiguousUnicodeCharacters","This document contains many ambiguous unicode characters"),command:new DisableHighlightingOfAmbiguousCharactersAction};else if(gt.invisibleCharacterCount>=pt)mt={message:localize("unicodeHighlighting.thisDocumentHasManyInvisibleUnicodeCharacters","This document contains many invisible unicode characters"),command:new DisableHighlightingOfInvisibleCharactersAction};else throw new Error("Unreachable");this._bannerController.show({id:"unicodeHighlightBanner",message:mt.message,icon:warningIcon,actions:[{label:mt.command.shortLabel,href:`command:${mt.command.id}`}],onClose:()=>{this._bannerClosed=!0}})}else this._bannerController.hide()},this._bannerController=this._register(ut.createInstance(BannerController,nt)),this._register(this._editor.onDidChangeModel(()=>{this._bannerClosed=!1,this._updateHighlighter()})),this._options=nt.getOption(120),this._register(rt.onDidChangeTrust(gt=>{this._updateHighlighter()})),this._register(nt.onDidChangeConfiguration(gt=>{gt.hasChanged(120)&&(this._options=nt.getOption(120),this._updateHighlighter())})),this._updateHighlighter()}dispose(){this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),super.dispose()}_updateHighlighter(){if(this._updateState(null),this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),!this._editor.hasModel())return;const nt=resolveOptions(this._workspaceTrustService.isWorkspaceTrusted(),this._options);if([nt.nonBasicASCII,nt.ambiguousCharacters,nt.invisibleCharacters].every(rt=>rt===!1))return;const ot={nonBasicASCII:nt.nonBasicASCII,ambiguousCharacters:nt.ambiguousCharacters,invisibleCharacters:nt.invisibleCharacters,includeComments:nt.includeComments,includeStrings:nt.includeStrings,allowedCodePoints:Object.keys(nt.allowedCharacters).map(rt=>rt.codePointAt(0)),allowedLocales:Object.keys(nt.allowedLocales).map(rt=>rt==="_os"?new Intl.NumberFormat().resolvedOptions().locale:rt==="_vscode"?language:rt)};this._editorWorkerService.canComputeUnicodeHighlights(this._editor.getModel().uri)?this._highlighter=new DocumentUnicodeHighlighter(this._editor,ot,this._updateState,this._editorWorkerService):this._highlighter=new ViewportUnicodeHighlighter(this._editor,ot,this._updateState)}getDecorationInfo(nt){return this._highlighter?this._highlighter.getDecorationInfo(nt):null}};UnicodeHighlighter.ID="editor.contrib.unicodeHighlighter";UnicodeHighlighter=__decorate$b([__param$b(1,IEditorWorkerService),__param$b(2,IWorkspaceTrustManagementService),__param$b(3,IInstantiationService)],UnicodeHighlighter);function resolveOptions(ct,nt){return{nonBasicASCII:nt.nonBasicASCII===inUntrustedWorkspace?!ct:nt.nonBasicASCII,ambiguousCharacters:nt.ambiguousCharacters,invisibleCharacters:nt.invisibleCharacters,includeComments:nt.includeComments===inUntrustedWorkspace?!ct:nt.includeComments,includeStrings:nt.includeStrings===inUntrustedWorkspace?!ct:nt.includeStrings,allowedCharacters:nt.allowedCharacters,allowedLocales:nt.allowedLocales}}let DocumentUnicodeHighlighter=class extends Disposable{constructor(nt,ot,rt,ut){super(),this._editor=nt,this._options=ot,this._updateState=rt,this._editorWorkerService=ut,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new RunOnceScheduler(()=>this._update(),250)),this._register(this._editor.onDidChangeModelContent(()=>{this._updateSoon.schedule()})),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII()){this._decorations.clear();return}const nt=this._model.getVersionId();this._editorWorkerService.computedUnicodeHighlights(this._model.uri,this._options).then(ot=>{if(this._model.isDisposed()||this._model.getVersionId()!==nt)return;this._updateState(ot);const rt=[];if(!ot.hasMore)for(const ut of ot.ranges)rt.push({range:ut,options:Decorations.instance.getDecorationFromOptions(this._options)});this._decorations.set(rt)})}getDecorationInfo(nt){if(!this._decorations.has(nt))return null;const ot=this._editor.getModel();if(!isModelDecorationVisible(ot,nt))return null;const rt=ot.getValueInRange(nt.range);return{reason:computeReason(rt,this._options),inComment:isModelDecorationInComment(ot,nt),inString:isModelDecorationInString(ot,nt)}}};DocumentUnicodeHighlighter=__decorate$b([__param$b(3,IEditorWorkerService)],DocumentUnicodeHighlighter);class ViewportUnicodeHighlighter extends Disposable{constructor(nt,ot,rt){super(),this._editor=nt,this._options=ot,this._updateState=rt,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new RunOnceScheduler(()=>this._update(),250)),this._register(this._editor.onDidLayoutChange(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidScrollChange(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidChangeHiddenAreas(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidChangeModelContent(()=>{this._updateSoon.schedule()})),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII()){this._decorations.clear();return}const nt=this._editor.getVisibleRanges(),ot=[],rt={ranges:[],ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0,hasMore:!1};for(const ut of nt){const gt=UnicodeTextModelHighlighter.computeUnicodeHighlights(this._model,this._options,ut);for(const pt of gt.ranges)rt.ranges.push(pt);rt.ambiguousCharacterCount+=rt.ambiguousCharacterCount,rt.invisibleCharacterCount+=rt.invisibleCharacterCount,rt.nonBasicAsciiCharacterCount+=rt.nonBasicAsciiCharacterCount,rt.hasMore=rt.hasMore||gt.hasMore}if(!rt.hasMore)for(const ut of rt.ranges)ot.push({range:ut,options:Decorations.instance.getDecorationFromOptions(this._options)});this._updateState(rt),this._decorations.set(ot)}getDecorationInfo(nt){if(!this._decorations.has(nt))return null;const ot=this._editor.getModel(),rt=ot.getValueInRange(nt.range);return isModelDecorationVisible(ot,nt)?{reason:computeReason(rt,this._options),inComment:isModelDecorationInComment(ot,nt),inString:isModelDecorationInString(ot,nt)}:null}}let UnicodeHighlighterHoverParticipant=class{constructor(nt,ot,rt){this._editor=nt,this._languageService=ot,this._openerService=rt,this.hoverOrdinal=5}computeSync(nt,ot){if(!this._editor.hasModel()||nt.type!==1)return[];const rt=this._editor.getModel(),ut=this._editor.getContribution(UnicodeHighlighter.ID);if(!ut)return[];const gt=[];let pt=300;for(const mt of ot){const vt=ut.getDecorationInfo(mt);if(!vt)continue;const yt=rt.getValueInRange(mt.range).codePointAt(0),wt=formatCodePointMarkdown(yt);let Lt;switch(vt.reason.kind){case 0:{isBasicASCII(vt.reason.confusableWith)?Lt=localize("unicodeHighlight.characterIsAmbiguousASCII","The character {0} could be confused with the ASCII character {1}, which is more common in source code.",wt,formatCodePointMarkdown(vt.reason.confusableWith.codePointAt(0))):Lt=localize("unicodeHighlight.characterIsAmbiguous","The character {0} could be confused with the character {1}, which is more common in source code.",wt,formatCodePointMarkdown(vt.reason.confusableWith.codePointAt(0)));break}case 1:Lt=localize("unicodeHighlight.characterIsInvisible","The character {0} is invisible.",wt);break;case 2:Lt=localize("unicodeHighlight.characterIsNonBasicAscii","The character {0} is not a basic ASCII character.",wt);break}const xt={codePoint:yt,reason:vt.reason,inComment:vt.inComment,inString:vt.inString},It=localize("unicodeHighlight.adjustSettings","Adjust settings"),kt=`command:${ShowExcludeOptions.ID}?${encodeURIComponent(JSON.stringify(xt))}`,At=new MarkdownString("",!0).appendMarkdown(Lt).appendText(" ").appendLink(kt,It);gt.push(new MarkdownHover(this,mt.range,[At],!1,pt++))}return gt}renderHoverParts(nt,ot){return renderMarkdownHovers(nt,ot,this._editor,this._languageService,this._openerService)}};UnicodeHighlighterHoverParticipant=__decorate$b([__param$b(1,ILanguageService),__param$b(2,IOpenerService)],UnicodeHighlighterHoverParticipant);function codePointToHex(ct){return`U+${ct.toString(16).padStart(4,"0")}`}function formatCodePointMarkdown(ct){let nt=`\`${codePointToHex(ct)}\``;return InvisibleCharacters.isInvisibleCharacter(ct)||(nt+=` "${`${renderCodePointAsInlineCode(ct)}`}"`),nt}function renderCodePointAsInlineCode(ct){return ct===96?"`` ` ``":"`"+String.fromCodePoint(ct)+"`"}function computeReason(ct,nt){return UnicodeTextModelHighlighter.computeUnicodeHighlightReason(ct,nt)}class Decorations{constructor(){this.map=new Map}getDecorationFromOptions(nt){return this.getDecoration(!nt.includeComments,!nt.includeStrings)}getDecoration(nt,ot){const rt=`${nt}${ot}`;let ut=this.map.get(rt);return ut||(ut=ModelDecorationOptions.createDynamic({description:"unicode-highlight",stickiness:1,className:"unicode-highlight",showIfCollapsed:!0,overviewRuler:null,minimap:null,hideInCommentTokens:nt,hideInStringTokens:ot}),this.map.set(rt,ut)),ut}}Decorations.instance=new Decorations;class DisableHighlightingInCommentsAction extends EditorAction{constructor(){super({id:DisableHighlightingOfAmbiguousCharactersAction.ID,label:localize("action.unicodeHighlight.disableHighlightingInComments","Disable highlighting of characters in comments"),alias:"Disable highlighting of characters in comments",precondition:void 0}),this.shortLabel=localize("unicodeHighlight.disableHighlightingInComments.shortLabel","Disable Highlight In Comments")}run(nt,ot,rt){return __awaiter$5(this,void 0,void 0,function*(){const ut=nt==null?void 0:nt.get(IConfigurationService);ut&&this.runAction(ut)})}runAction(nt){return __awaiter$5(this,void 0,void 0,function*(){yield nt.updateValue(unicodeHighlightConfigKeys.includeComments,!1,2)})}}class DisableHighlightingInStringsAction extends EditorAction{constructor(){super({id:DisableHighlightingOfAmbiguousCharactersAction.ID,label:localize("action.unicodeHighlight.disableHighlightingInStrings","Disable highlighting of characters in strings"),alias:"Disable highlighting of characters in strings",precondition:void 0}),this.shortLabel=localize("unicodeHighlight.disableHighlightingInStrings.shortLabel","Disable Highlight In Strings")}run(nt,ot,rt){return __awaiter$5(this,void 0,void 0,function*(){const ut=nt==null?void 0:nt.get(IConfigurationService);ut&&this.runAction(ut)})}runAction(nt){return __awaiter$5(this,void 0,void 0,function*(){yield nt.updateValue(unicodeHighlightConfigKeys.includeStrings,!1,2)})}}class DisableHighlightingOfAmbiguousCharactersAction extends EditorAction{constructor(){super({id:DisableHighlightingOfAmbiguousCharactersAction.ID,label:localize("action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters","Disable highlighting of ambiguous characters"),alias:"Disable highlighting of ambiguous characters",precondition:void 0}),this.shortLabel=localize("unicodeHighlight.disableHighlightingOfAmbiguousCharacters.shortLabel","Disable Ambiguous Highlight")}run(nt,ot,rt){return __awaiter$5(this,void 0,void 0,function*(){const ut=nt==null?void 0:nt.get(IConfigurationService);ut&&this.runAction(ut)})}runAction(nt){return __awaiter$5(this,void 0,void 0,function*(){yield nt.updateValue(unicodeHighlightConfigKeys.ambiguousCharacters,!1,2)})}}DisableHighlightingOfAmbiguousCharactersAction.ID="editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters";class DisableHighlightingOfInvisibleCharactersAction extends EditorAction{constructor(){super({id:DisableHighlightingOfInvisibleCharactersAction.ID,label:localize("action.unicodeHighlight.disableHighlightingOfInvisibleCharacters","Disable highlighting of invisible characters"),alias:"Disable highlighting of invisible characters",precondition:void 0}),this.shortLabel=localize("unicodeHighlight.disableHighlightingOfInvisibleCharacters.shortLabel","Disable Invisible Highlight")}run(nt,ot,rt){return __awaiter$5(this,void 0,void 0,function*(){const ut=nt==null?void 0:nt.get(IConfigurationService);ut&&this.runAction(ut)})}runAction(nt){return __awaiter$5(this,void 0,void 0,function*(){yield nt.updateValue(unicodeHighlightConfigKeys.invisibleCharacters,!1,2)})}}DisableHighlightingOfInvisibleCharactersAction.ID="editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters";class DisableHighlightingOfNonBasicAsciiCharactersAction extends EditorAction{constructor(){super({id:DisableHighlightingOfNonBasicAsciiCharactersAction.ID,label:localize("action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters","Disable highlighting of non basic ASCII characters"),alias:"Disable highlighting of non basic ASCII characters",precondition:void 0}),this.shortLabel=localize("unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters.shortLabel","Disable Non ASCII Highlight")}run(nt,ot,rt){return __awaiter$5(this,void 0,void 0,function*(){const ut=nt==null?void 0:nt.get(IConfigurationService);ut&&this.runAction(ut)})}runAction(nt){return __awaiter$5(this,void 0,void 0,function*(){yield nt.updateValue(unicodeHighlightConfigKeys.nonBasicASCII,!1,2)})}}DisableHighlightingOfNonBasicAsciiCharactersAction.ID="editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters";class ShowExcludeOptions extends EditorAction{constructor(){super({id:ShowExcludeOptions.ID,label:localize("action.unicodeHighlight.showExcludeOptions","Show Exclude Options"),alias:"Show Exclude Options",precondition:void 0})}run(nt,ot,rt){return __awaiter$5(this,void 0,void 0,function*(){const{codePoint:ut,reason:gt,inString:pt,inComment:mt}=rt,vt=String.fromCodePoint(ut),St=nt.get(IQuickInputService),yt=nt.get(IConfigurationService);function wt(It){return InvisibleCharacters.isInvisibleCharacter(It)?localize("unicodeHighlight.excludeInvisibleCharFromBeingHighlighted","Exclude {0} (invisible character) from being highlighted",codePointToHex(It)):localize("unicodeHighlight.excludeCharFromBeingHighlighted","Exclude {0} from being highlighted",`${codePointToHex(It)} "${vt}"`)}const Lt=[];if(gt.kind===0)for(const It of gt.notAmbiguousInLocales)Lt.push({label:localize("unicodeHighlight.allowCommonCharactersInLanguage",'Allow unicode characters that are more common in the language "{0}".',It),run:()=>__awaiter$5(this,void 0,void 0,function*(){excludeLocaleFromBeingHighlighted(yt,[It])})});if(Lt.push({label:wt(ut),run:()=>excludeCharFromBeingHighlighted(yt,[ut])}),mt){const It=new DisableHighlightingInCommentsAction;Lt.push({label:It.label,run:()=>__awaiter$5(this,void 0,void 0,function*(){return It.runAction(yt)})})}else if(pt){const It=new DisableHighlightingInStringsAction;Lt.push({label:It.label,run:()=>__awaiter$5(this,void 0,void 0,function*(){return It.runAction(yt)})})}if(gt.kind===0){const It=new DisableHighlightingOfAmbiguousCharactersAction;Lt.push({label:It.label,run:()=>__awaiter$5(this,void 0,void 0,function*(){return It.runAction(yt)})})}else if(gt.kind===1){const It=new DisableHighlightingOfInvisibleCharactersAction;Lt.push({label:It.label,run:()=>__awaiter$5(this,void 0,void 0,function*(){return It.runAction(yt)})})}else if(gt.kind===2){const It=new DisableHighlightingOfNonBasicAsciiCharactersAction;Lt.push({label:It.label,run:()=>__awaiter$5(this,void 0,void 0,function*(){return It.runAction(yt)})})}else expectNever(gt);const xt=yield St.pick(Lt,{title:localize("unicodeHighlight.configureUnicodeHighlightOptions","Configure Unicode Highlight Options")});xt&&(yield xt.run())})}}ShowExcludeOptions.ID="editor.action.unicodeHighlight.showExcludeOptions";function excludeCharFromBeingHighlighted(ct,nt){return __awaiter$5(this,void 0,void 0,function*(){const ot=ct.getValue(unicodeHighlightConfigKeys.allowedCharacters);let rt;typeof ot=="object"&&ot?rt=ot:rt={};for(const ut of nt)rt[String.fromCodePoint(ut)]=!0;yield ct.updateValue(unicodeHighlightConfigKeys.allowedCharacters,rt,2)})}function excludeLocaleFromBeingHighlighted(ct,nt){var ot;return __awaiter$5(this,void 0,void 0,function*(){const rt=(ot=ct.inspect(unicodeHighlightConfigKeys.allowedLocales).user)===null||ot===void 0?void 0:ot.value;let ut;typeof rt=="object"&&rt?ut=Object.assign({},rt):ut={};for(const gt of nt)ut[gt]=!0;yield ct.updateValue(unicodeHighlightConfigKeys.allowedLocales,ut,2)})}function expectNever(ct){throw new Error(`Unexpected value: ${ct}`)}registerEditorAction(DisableHighlightingOfAmbiguousCharactersAction);registerEditorAction(DisableHighlightingOfInvisibleCharactersAction);registerEditorAction(DisableHighlightingOfNonBasicAsciiCharactersAction);registerEditorAction(ShowExcludeOptions);registerEditorContribution(UnicodeHighlighter.ID,UnicodeHighlighter,1);HoverParticipantRegistry.register(UnicodeHighlighterHoverParticipant);var __decorate$a=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$a=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$4=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};const ignoreUnusualLineTerminators="ignoreUnusualLineTerminators";function writeIgnoreState(ct,nt,ot){ct.setModelProperty(nt.uri,ignoreUnusualLineTerminators,ot)}function readIgnoreState(ct,nt){return ct.getModelProperty(nt.uri,ignoreUnusualLineTerminators)}let UnusualLineTerminatorsDetector=class extends Disposable{constructor(nt,ot,rt){super(),this._editor=nt,this._dialogService=ot,this._codeEditorService=rt,this._isPresentingDialog=!1,this._config=this._editor.getOption(121),this._register(this._editor.onDidChangeConfiguration(ut=>{ut.hasChanged(121)&&(this._config=this._editor.getOption(121),this._checkForUnusualLineTerminators())})),this._register(this._editor.onDidChangeModel(()=>{this._checkForUnusualLineTerminators()})),this._register(this._editor.onDidChangeModelContent(ut=>{ut.isUndoing||this._checkForUnusualLineTerminators()})),this._checkForUnusualLineTerminators()}_checkForUnusualLineTerminators(){return __awaiter$4(this,void 0,void 0,function*(){if(this._config==="off"||!this._editor.hasModel())return;const nt=this._editor.getModel();if(!nt.mightContainUnusualLineTerminators()||readIgnoreState(this._codeEditorService,nt)===!0||this._editor.getOption(87))return;if(this._config==="auto"){nt.removeUnusualLineTerminators(this._editor.getSelections());return}if(this._isPresentingDialog)return;let rt;try{this._isPresentingDialog=!0,rt=yield this._dialogService.confirm({title:localize("unusualLineTerminators.title","Unusual Line Terminators"),message:localize("unusualLineTerminators.message","Detected unusual line terminators"),detail:localize("unusualLineTerminators.detail","The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\n\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.",basename(nt.uri)),primaryButton:localize({key:"unusualLineTerminators.fix",comment:["&& denotes a mnemonic"]},"&&Remove Unusual Line Terminators"),cancelButton:localize("unusualLineTerminators.ignore","Ignore")})}finally{this._isPresentingDialog=!1}if(!rt.confirmed){writeIgnoreState(this._codeEditorService,nt,!0);return}nt.removeUnusualLineTerminators(this._editor.getSelections())})}};UnusualLineTerminatorsDetector.ID="editor.contrib.unusualLineTerminatorsDetector";UnusualLineTerminatorsDetector=__decorate$a([__param$a(1,IDialogService),__param$a(2,ICodeEditorService)],UnusualLineTerminatorsDetector);registerEditorContribution(UnusualLineTerminatorsDetector.ID,UnusualLineTerminatorsDetector,1);var __decorate$9=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$9=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const ctxHasWordHighlights=new RawContextKey("hasWordHighlights",!1);function getOccurrencesAtPosition(ct,nt,ot,rt){const ut=ct.ordered(nt);return first(ut.map(gt=>()=>Promise.resolve(gt.provideDocumentHighlights(nt,ot,rt)).then(void 0,onUnexpectedExternalError)),isNonEmptyArray)}class OccurenceAtPositionRequest{constructor(nt,ot,rt){this._model=nt,this._selection=ot,this._wordSeparators=rt,this._wordRange=this._getCurrentWordRange(nt,ot),this._result=null}get result(){return this._result||(this._result=createCancelablePromise(nt=>this._compute(this._model,this._selection,this._wordSeparators,nt))),this._result}_getCurrentWordRange(nt,ot){const rt=nt.getWordAtPosition(ot.getPosition());return rt?new Range$2(ot.startLineNumber,rt.startColumn,ot.startLineNumber,rt.endColumn):null}isValid(nt,ot,rt){const ut=ot.startLineNumber,gt=ot.startColumn,pt=ot.endColumn,mt=this._getCurrentWordRange(nt,ot);let vt=!!(this._wordRange&&this._wordRange.equalsRange(mt));for(let St=0,yt=rt.length;!vt&&St<yt;St++){const wt=rt.getRange(St);wt&&wt.startLineNumber===ut&&wt.startColumn<=gt&&wt.endColumn>=pt&&(vt=!0)}return vt}cancel(){this.result.cancel()}}class SemanticOccurenceAtPositionRequest extends OccurenceAtPositionRequest{constructor(nt,ot,rt,ut){super(nt,ot,rt),this._providers=ut}_compute(nt,ot,rt,ut){return getOccurrencesAtPosition(this._providers,nt,ot.getPosition(),ut).then(gt=>gt||[])}}class TextualOccurenceAtPositionRequest extends OccurenceAtPositionRequest{constructor(nt,ot,rt){super(nt,ot,rt),this._selectionIsEmpty=ot.isEmpty()}_compute(nt,ot,rt,ut){return timeout(250,ut).then(()=>{if(!ot.isEmpty())return[];const gt=nt.getWordAtPosition(ot.getPosition());return!gt||gt.word.length>1e3?[]:nt.findMatches(gt.word,!0,!1,!0,rt,!1).map(mt=>({range:mt.range,kind:DocumentHighlightKind$1.Text}))})}isValid(nt,ot,rt){const ut=ot.isEmpty();return this._selectionIsEmpty!==ut?!1:super.isValid(nt,ot,rt)}}function computeOccurencesAtPosition(ct,nt,ot,rt){return ct.has(nt)?new SemanticOccurenceAtPositionRequest(nt,ot,rt,ct):new TextualOccurenceAtPositionRequest(nt,ot,rt)}registerModelAndPositionCommand("_executeDocumentHighlights",(ct,nt,ot)=>{const rt=ct.get(ILanguageFeaturesService);return getOccurrencesAtPosition(rt.documentHighlightProvider,nt,ot,CancellationToken.None)});class WordHighlighter{constructor(nt,ot,rt){this.toUnhook=new DisposableStore,this.workerRequestTokenId=0,this.workerRequestCompleted=!1,this.workerRequestValue=[],this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,this.editor=nt,this.providers=ot,this._hasWordHighlights=ctxHasWordHighlights.bindTo(rt),this._ignorePositionChangeEvent=!1,this.occurrencesHighlight=this.editor.getOption(78),this.model=this.editor.getModel(),this.toUnhook.add(nt.onDidChangeCursorPosition(ut=>{this._ignorePositionChangeEvent||this.occurrencesHighlight&&this._onPositionChanged(ut)})),this.toUnhook.add(nt.onDidChangeModelContent(ut=>{this._stopAll()})),this.toUnhook.add(nt.onDidChangeConfiguration(ut=>{const gt=this.editor.getOption(78);this.occurrencesHighlight!==gt&&(this.occurrencesHighlight=gt,this._stopAll())})),this.decorations=this.editor.createDecorationsCollection(),this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1}hasDecorations(){return this.decorations.length>0}restore(){this.occurrencesHighlight&&this._run()}_getSortedHighlights(){return this.decorations.getRanges().sort(Range$2.compareRangesUsingStarts)}moveNext(){const nt=this._getSortedHighlights(),rt=(nt.findIndex(gt=>gt.containsPosition(this.editor.getPosition()))+1)%nt.length,ut=nt[rt];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(ut.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(ut);const gt=this._getWord();if(gt){const pt=this.editor.getModel().getLineContent(ut.startLineNumber);alert(`${pt}, ${rt+1} of ${nt.length} for '${gt.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}moveBack(){const nt=this._getSortedHighlights(),rt=(nt.findIndex(gt=>gt.containsPosition(this.editor.getPosition()))-1+nt.length)%nt.length,ut=nt[rt];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(ut.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(ut);const gt=this._getWord();if(gt){const pt=this.editor.getModel().getLineContent(ut.startLineNumber);alert(`${pt}, ${rt+1} of ${nt.length} for '${gt.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}_removeDecorations(){this.decorations.length>0&&(this.decorations.clear(),this._hasWordHighlights.set(!1))}_stopAll(){this._removeDecorations(),this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_onPositionChanged(nt){if(!this.occurrencesHighlight){this._stopAll();return}if(nt.reason!==3){this._stopAll();return}this._run()}_getWord(){const nt=this.editor.getSelection(),ot=nt.startLineNumber,rt=nt.startColumn;return this.model.getWordAtPosition({lineNumber:ot,column:rt})}_run(){const nt=this.editor.getSelection();if(nt.startLineNumber!==nt.endLineNumber){this._stopAll();return}const ot=nt.startColumn,rt=nt.endColumn,ut=this._getWord();if(!ut||ut.startColumn>ot||ut.endColumn<rt){this._stopAll();return}const gt=this.workerRequest&&this.workerRequest.isValid(this.model,nt,this.decorations);if(this.lastCursorPositionChangeTime=new Date().getTime(),gt)this.workerRequestCompleted&&this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1,this._beginRenderDecorations());else{this._stopAll();const pt=++this.workerRequestTokenId;this.workerRequestCompleted=!1,this.workerRequest=computeOccurencesAtPosition(this.providers,this.model,this.editor.getSelection(),this.editor.getOption(125)),this.workerRequest.result.then(mt=>{pt===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=mt||[],this._beginRenderDecorations())},onUnexpectedError)}}_beginRenderDecorations(){const nt=new Date().getTime(),ot=this.lastCursorPositionChangeTime+250;nt>=ot?(this.renderDecorationsTimer=-1,this.renderDecorations()):this.renderDecorationsTimer=setTimeout(()=>{this.renderDecorations()},ot-nt)}renderDecorations(){this.renderDecorationsTimer=-1;const nt=[];for(const ot of this.workerRequestValue)ot.range&&nt.push({range:ot.range,options:getHighlightDecorationOptions(ot.kind)});this.decorations.set(nt),this._hasWordHighlights.set(this.hasDecorations())}dispose(){this._stopAll(),this.toUnhook.dispose()}}let WordHighlighterContribution=class Br extends Disposable{static get(nt){return nt.getContribution(Br.ID)}constructor(nt,ot,rt){super(),this.wordHighlighter=null;const ut=()=>{nt.hasModel()&&(this.wordHighlighter=new WordHighlighter(nt,rt.documentHighlightProvider,ot))};this._register(nt.onDidChangeModel(gt=>{this.wordHighlighter&&(this.wordHighlighter.dispose(),this.wordHighlighter=null),ut()})),ut()}saveViewState(){return!!(this.wordHighlighter&&this.wordHighlighter.hasDecorations())}moveNext(){var nt;(nt=this.wordHighlighter)===null||nt===void 0||nt.moveNext()}moveBack(){var nt;(nt=this.wordHighlighter)===null||nt===void 0||nt.moveBack()}restoreViewState(nt){this.wordHighlighter&&nt&&this.wordHighlighter.restore()}dispose(){this.wordHighlighter&&(this.wordHighlighter.dispose(),this.wordHighlighter=null),super.dispose()}};WordHighlighterContribution.ID="editor.contrib.wordHighlighter";WordHighlighterContribution=__decorate$9([__param$9(1,IContextKeyService),__param$9(2,ILanguageFeaturesService)],WordHighlighterContribution);class WordHighlightNavigationAction extends EditorAction{constructor(nt,ot){super(ot),this._isNext=nt}run(nt,ot){const rt=WordHighlighterContribution.get(ot);rt&&(this._isNext?rt.moveNext():rt.moveBack())}}class NextWordHighlightAction extends WordHighlightNavigationAction{constructor(){super(!0,{id:"editor.action.wordHighlight.next",label:localize("wordHighlight.next.label","Go to Next Symbol Highlight"),alias:"Go to Next Symbol Highlight",precondition:ctxHasWordHighlights,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:65,weight:100}})}}class PrevWordHighlightAction extends WordHighlightNavigationAction{constructor(){super(!1,{id:"editor.action.wordHighlight.prev",label:localize("wordHighlight.previous.label","Go to Previous Symbol Highlight"),alias:"Go to Previous Symbol Highlight",precondition:ctxHasWordHighlights,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1089,weight:100}})}}class TriggerWordHighlightAction extends EditorAction{constructor(){super({id:"editor.action.wordHighlight.trigger",label:localize("wordHighlight.trigger.label","Trigger Symbol Highlight"),alias:"Trigger Symbol Highlight",precondition:ctxHasWordHighlights.toNegated(),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:0,weight:100}})}run(nt,ot,rt){const ut=WordHighlighterContribution.get(ot);ut&&ut.restoreViewState(!0)}}registerEditorContribution(WordHighlighterContribution.ID,WordHighlighterContribution,0);registerEditorAction(NextWordHighlightAction);registerEditorAction(PrevWordHighlightAction);registerEditorAction(TriggerWordHighlightAction);class MoveWordCommand extends EditorCommand{constructor(nt){super(nt),this._inSelectionMode=nt.inSelectionMode,this._wordNavigationType=nt.wordNavigationType}runEditorCommand(nt,ot,rt){if(!ot.hasModel())return;const ut=getMapForWordSeparators(ot.getOption(125)),gt=ot.getModel(),mt=ot.getSelections().map(vt=>{const St=new Position$1(vt.positionLineNumber,vt.positionColumn),yt=this._move(ut,gt,St,this._wordNavigationType);return this._moveTo(vt,yt,this._inSelectionMode)});if(gt.pushStackElement(),ot._getViewModel().setCursorStates("moveWordCommand",3,mt.map(vt=>CursorState$1.fromModelSelection(vt))),mt.length===1){const vt=new Position$1(mt[0].positionLineNumber,mt[0].positionColumn);ot.revealPosition(vt,0)}}_moveTo(nt,ot,rt){return rt?new Selection$1(nt.selectionStartLineNumber,nt.selectionStartColumn,ot.lineNumber,ot.column):new Selection$1(ot.lineNumber,ot.column,ot.lineNumber,ot.column)}}class WordLeftCommand extends MoveWordCommand{_move(nt,ot,rt,ut){return WordOperations.moveWordLeft(nt,ot,rt,ut)}}class WordRightCommand extends MoveWordCommand{_move(nt,ot,rt,ut){return WordOperations.moveWordRight(nt,ot,rt,ut)}}class CursorWordStartLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartLeft",precondition:void 0})}}class CursorWordEndLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndLeft",precondition:void 0})}}class CursorWordLeft extends WordLeftCommand{constructor(){var nt;super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordLeft",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,(nt=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))===null||nt===void 0?void 0:nt.negate()),primary:2063,mac:{primary:527},weight:100}})}}class CursorWordStartLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartLeftSelect",precondition:void 0})}}class CursorWordEndLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndLeftSelect",precondition:void 0})}}class CursorWordLeftSelect extends WordLeftCommand{constructor(){var nt;super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordLeftSelect",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,(nt=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))===null||nt===void 0?void 0:nt.negate()),primary:3087,mac:{primary:1551},weight:100}})}}class CursorWordAccessibilityLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityLeft",precondition:void 0})}_move(nt,ot,rt,ut){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),ot,rt,ut)}}class CursorWordAccessibilityLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityLeftSelect",precondition:void 0})}_move(nt,ot,rt,ut){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),ot,rt,ut)}}class CursorWordStartRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartRight",precondition:void 0})}}class CursorWordEndRight extends WordRightCommand{constructor(){var nt;super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndRight",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,(nt=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))===null||nt===void 0?void 0:nt.negate()),primary:2065,mac:{primary:529},weight:100}})}}class CursorWordRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordRight",precondition:void 0})}}class CursorWordStartRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartRightSelect",precondition:void 0})}}class CursorWordEndRightSelect extends WordRightCommand{constructor(){var nt;super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndRightSelect",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,(nt=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))===null||nt===void 0?void 0:nt.negate()),primary:3089,mac:{primary:1553},weight:100}})}}class CursorWordRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordRightSelect",precondition:void 0})}}class CursorWordAccessibilityRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityRight",precondition:void 0})}_move(nt,ot,rt,ut){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),ot,rt,ut)}}class CursorWordAccessibilityRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityRightSelect",precondition:void 0})}_move(nt,ot,rt,ut){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),ot,rt,ut)}}class DeleteWordCommand extends EditorCommand{constructor(nt){super(nt),this._whitespaceHeuristics=nt.whitespaceHeuristics,this._wordNavigationType=nt.wordNavigationType}runEditorCommand(nt,ot,rt){const ut=nt.get(ILanguageConfigurationService);if(!ot.hasModel())return;const gt=getMapForWordSeparators(ot.getOption(125)),pt=ot.getModel(),mt=ot.getSelections(),vt=ot.getOption(5),St=ot.getOption(9),yt=ut.getLanguageConfiguration(pt.getLanguageId()).getAutoClosingPairs(),wt=ot._getViewModel(),Lt=mt.map(xt=>{const It=this._delete({wordSeparators:gt,model:pt,selection:xt,whitespaceHeuristics:this._whitespaceHeuristics,autoClosingDelete:ot.getOption(7),autoClosingBrackets:vt,autoClosingQuotes:St,autoClosingPairs:yt,autoClosedCharacters:wt.getCursorAutoClosedCharacters()},this._wordNavigationType);return new ReplaceCommand(It,"")});ot.pushUndoStop(),ot.executeCommands(this.id,Lt),ot.pushUndoStop()}}class DeleteWordLeftCommand extends DeleteWordCommand{_delete(nt,ot){const rt=WordOperations.deleteWordLeft(nt,ot);return rt||new Range$2(1,1,1,1)}}class DeleteWordRightCommand extends DeleteWordCommand{_delete(nt,ot){const rt=WordOperations.deleteWordRight(nt,ot);if(rt)return rt;const ut=nt.model.getLineCount(),gt=nt.model.getLineMaxColumn(ut);return new Range$2(ut,gt,ut,gt)}}class DeleteWordStartLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartLeft",precondition:EditorContextKeys.writable})}}class DeleteWordEndLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndLeft",precondition:EditorContextKeys.writable})}}class DeleteWordLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordLeft",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2049,mac:{primary:513},weight:100}})}}class DeleteWordStartRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartRight",precondition:EditorContextKeys.writable})}}class DeleteWordEndRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndRight",precondition:EditorContextKeys.writable})}}class DeleteWordRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordRight",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2068,mac:{primary:532},weight:100}})}}class DeleteInsideWord extends EditorAction{constructor(){super({id:"deleteInsideWord",precondition:EditorContextKeys.writable,label:localize("deleteInsideWord","Delete Word"),alias:"Delete Word"})}run(nt,ot,rt){if(!ot.hasModel())return;const ut=getMapForWordSeparators(ot.getOption(125)),gt=ot.getModel(),mt=ot.getSelections().map(vt=>{const St=WordOperations.deleteInsideWord(ut,gt,vt);return new ReplaceCommand(St,"")});ot.pushUndoStop(),ot.executeCommands(this.id,mt),ot.pushUndoStop()}}registerEditorCommand(new CursorWordStartLeft);registerEditorCommand(new CursorWordEndLeft);registerEditorCommand(new CursorWordLeft);registerEditorCommand(new CursorWordStartLeftSelect);registerEditorCommand(new CursorWordEndLeftSelect);registerEditorCommand(new CursorWordLeftSelect);registerEditorCommand(new CursorWordStartRight);registerEditorCommand(new CursorWordEndRight);registerEditorCommand(new CursorWordRight);registerEditorCommand(new CursorWordStartRightSelect);registerEditorCommand(new CursorWordEndRightSelect);registerEditorCommand(new CursorWordRightSelect);registerEditorCommand(new CursorWordAccessibilityLeft);registerEditorCommand(new CursorWordAccessibilityLeftSelect);registerEditorCommand(new CursorWordAccessibilityRight);registerEditorCommand(new CursorWordAccessibilityRightSelect);registerEditorCommand(new DeleteWordStartLeft);registerEditorCommand(new DeleteWordEndLeft);registerEditorCommand(new DeleteWordLeft);registerEditorCommand(new DeleteWordStartRight);registerEditorCommand(new DeleteWordEndRight);registerEditorCommand(new DeleteWordRight);registerEditorAction(DeleteInsideWord);class DeleteWordPartLeft extends DeleteWordCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordPartLeft",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:769},weight:100}})}_delete(nt,ot){const rt=WordPartOperations.deleteWordPartLeft(nt);return rt||new Range$2(1,1,1,1)}}class DeleteWordPartRight extends DeleteWordCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordPartRight",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:788},weight:100}})}_delete(nt,ot){const rt=WordPartOperations.deleteWordPartRight(nt);if(rt)return rt;const ut=nt.model.getLineCount(),gt=nt.model.getLineMaxColumn(ut);return new Range$2(ut,gt,ut,gt)}}class WordPartLeftCommand extends MoveWordCommand{_move(nt,ot,rt,ut){return WordPartOperations.moveWordPartLeft(nt,ot,rt)}}class CursorWordPartLeft extends WordPartLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordPartLeft",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:783},weight:100}})}}CommandsRegistry.registerCommandAlias("cursorWordPartStartLeft","cursorWordPartLeft");class CursorWordPartLeftSelect extends WordPartLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordPartLeftSelect",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:1807},weight:100}})}}CommandsRegistry.registerCommandAlias("cursorWordPartStartLeftSelect","cursorWordPartLeftSelect");class WordPartRightCommand extends MoveWordCommand{_move(nt,ot,rt,ut){return WordPartOperations.moveWordPartRight(nt,ot,rt)}}class CursorWordPartRight extends WordPartRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordPartRight",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:785},weight:100}})}}class CursorWordPartRightSelect extends WordPartRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordPartRightSelect",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:1809},weight:100}})}}registerEditorCommand(new DeleteWordPartLeft);registerEditorCommand(new DeleteWordPartRight);registerEditorCommand(new CursorWordPartLeft);registerEditorCommand(new CursorWordPartLeftSelect);registerEditorCommand(new CursorWordPartRight);registerEditorCommand(new CursorWordPartRightSelect);class ReadOnlyMessageController extends Disposable{constructor(nt){super(),this.editor=nt,this._register(this.editor.onDidAttemptReadOnlyEdit(()=>this._onDidAttemptReadOnlyEdit()))}_onDidAttemptReadOnlyEdit(){const nt=MessageController.get(this.editor);nt&&this.editor.hasModel()&&(this.editor.isSimpleWidget?nt.showMessage(localize("editor.simple.readonly","Cannot edit in read-only input"),this.editor.getPosition()):nt.showMessage(localize("editor.readonly","Cannot edit in read-only editor"),this.editor.getPosition()))}}ReadOnlyMessageController.ID="editor.contrib.readOnlyMessageController";registerEditorContribution(ReadOnlyMessageController.ID,ReadOnlyMessageController,2);const accessibilityHelp="";var __decorate$8=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$8=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};const CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE=new RawContextKey("accessibilityHelpWidgetVisible",!1);let AccessibilityHelpController=class Wr extends Disposable{static get(nt){return nt.getContribution(Wr.ID)}constructor(nt,ot){super(),this._editor=nt,this._widget=this._register(ot.createInstance(AccessibilityHelpWidget,this._editor))}show(){this._widget.show()}hide(){this._widget.hide()}};AccessibilityHelpController.ID="editor.contrib.accessibilityHelpController";AccessibilityHelpController=__decorate$8([__param$8(1,IInstantiationService)],AccessibilityHelpController);function getSelectionLabel(ct,nt){return!ct||ct.length===0?AccessibilityHelpNLS.noSelection:ct.length===1?nt?format(AccessibilityHelpNLS.singleSelectionRange,ct[0].positionLineNumber,ct[0].positionColumn,nt):format(AccessibilityHelpNLS.singleSelection,ct[0].positionLineNumber,ct[0].positionColumn):nt?format(AccessibilityHelpNLS.multiSelectionRange,ct.length,nt):ct.length>0?format(AccessibilityHelpNLS.multiSelection,ct.length):""}let AccessibilityHelpWidget=class $o extends Widget$1{constructor(nt,ot,rt,ut){super(),this._contextKeyService=ot,this._keybindingService=rt,this._openerService=ut,this._editor=nt,this._isVisibleKey=CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE.bindTo(this._contextKeyService),this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setClassName("accessibilityHelpWidget"),this._domNode.setDisplay("none"),this._domNode.setAttribute("role","dialog"),this._domNode.setAttribute("aria-modal","true"),this._domNode.setAttribute("aria-hidden","true");const gt=append$1(this._domNode.domNode,$$d("h1",void 0,AccessibilityHelpNLS.accessibilityHelpTitle));gt.id="help-dialog-heading",this._domNode.setAttribute("aria-labelledby",gt.id),this._contentDomNode=createFastDomNode(document.createElement("div")),this._contentDomNode.setAttribute("role","document"),this._contentDomNode.domNode.id="help-dialog-content",this._domNode.appendChild(this._contentDomNode),this._contentDomNode.setAttribute("aria-describedby",this._contentDomNode.domNode.id),this._isVisible=!1,this._register(this._editor.onDidLayoutChange(()=>{this._isVisible&&this._layout()})),this._register(addStandardDisposableListener(this._contentDomNode.domNode,"keydown",pt=>{if(this._isVisible&&(pt.equals(2083)&&(alert(AccessibilityHelpNLS.emergencyConfOn),this._editor.updateOptions({accessibilitySupport:"on"}),clearNode(this._contentDomNode.domNode),this._buildContent(),this._contentDomNode.domNode.focus(),pt.preventDefault(),pt.stopPropagation()),pt.equals(2086))){alert(AccessibilityHelpNLS.openingDocs);let mt=this._editor.getRawOptions().accessibilityHelpUrl;typeof mt>"u"&&(mt="https://go.microsoft.com/fwlink/?linkid=852450"),this._openerService.open(URI.parse(mt)),pt.preventDefault(),pt.stopPropagation()}})),this.onblur(this._contentDomNode.domNode,()=>{this.hide()}),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return $o.ID}getDomNode(){return this._domNode.domNode}getPosition(){return{preference:null}}show(){this._isVisible||(this._isVisible=!0,this._isVisibleKey.set(!0),this._layout(),this._domNode.setDisplay("block"),this._domNode.setAttribute("aria-hidden","false"),this._contentDomNode.domNode.tabIndex=0,this._buildContent(),this._contentDomNode.domNode.focus())}_descriptionForCommand(nt,ot,rt){const ut=this._keybindingService.lookupKeybinding(nt);return ut?format(ot,ut.getAriaLabel()):format(rt,nt)}_buildContent(){const nt=this._contentDomNode.domNode,ot=this._editor.getOptions(),rt=this._editor.getSelections();let ut=0;if(rt){const St=this._editor.getModel();St&&rt.forEach(yt=>{ut+=St.getValueLengthInRange(yt)})}append$1(nt,$$d("p",void 0,getSelectionLabel(rt,ut)));const gt=append$1(nt,$$d("p"));ot.get(59)?ot.get(87)?gt.textContent=AccessibilityHelpNLS.readonlyDiffEditor:gt.textContent=AccessibilityHelpNLS.editableDiffEditor:ot.get(87)?gt.textContent=AccessibilityHelpNLS.readonlyEditor:gt.textContent=AccessibilityHelpNLS.editableEditor;const pt=append$1(nt,$$d("ul")),mt=isMacintosh?AccessibilityHelpNLS.changeConfigToOnMac:AccessibilityHelpNLS.changeConfigToOnWinLinux;switch(ot.get(2)){case 0:append$1(pt,$$d("li",void 0,mt));break;case 2:append$1(pt,$$d("li",void 0,AccessibilityHelpNLS.auto_on));break;case 1:append$1(pt,$$d("li",void 0,AccessibilityHelpNLS.auto_off,mt));break}ot.get(138)?append$1(pt,$$d("li",void 0,this._descriptionForCommand(ToggleTabFocusModeAction.ID,AccessibilityHelpNLS.tabFocusModeOnMsg,AccessibilityHelpNLS.tabFocusModeOnMsgNoKb))):append$1(pt,$$d("li",void 0,this._descriptionForCommand(ToggleTabFocusModeAction.ID,AccessibilityHelpNLS.tabFocusModeOffMsg,AccessibilityHelpNLS.tabFocusModeOffMsgNoKb)));const vt=isMacintosh?AccessibilityHelpNLS.openDocMac:AccessibilityHelpNLS.openDocWinLinux;append$1(pt,$$d("li",void 0,vt)),append$1(nt,$$d("p",void 0,AccessibilityHelpNLS.outroMsg))}hide(){this._isVisible&&(this._isVisible=!1,this._isVisibleKey.reset(),this._domNode.setDisplay("none"),this._domNode.setAttribute("aria-hidden","true"),this._contentDomNode.domNode.tabIndex=-1,clearNode(this._contentDomNode.domNode),this._editor.focus())}_layout(){const nt=this._editor.getLayoutInfo(),ot=Math.max(5,Math.min($o.WIDTH,nt.width-40)),rt=Math.max(5,Math.min($o.HEIGHT,nt.height-40));this._domNode.setWidth(ot),this._domNode.setHeight(rt);const ut=Math.round((nt.height-rt)/2);this._domNode.setTop(ut);const gt=Math.round((nt.width-ot)/2);this._domNode.setLeft(gt)}};AccessibilityHelpWidget.ID="editor.contrib.accessibilityHelpWidget";AccessibilityHelpWidget.WIDTH=500;AccessibilityHelpWidget.HEIGHT=300;AccessibilityHelpWidget=__decorate$8([__param$8(1,IContextKeyService),__param$8(2,IKeybindingService),__param$8(3,IOpenerService)],AccessibilityHelpWidget);class ShowAccessibilityHelpAction extends EditorAction{constructor(){super({id:"editor.action.showAccessibilityHelp",label:AccessibilityHelpNLS.showAccessibilityHelpAction,alias:"Show Accessibility Help",precondition:void 0,kbOpts:{primary:571,weight:100,linux:{primary:1595,secondary:[571]}}})}run(nt,ot){const rt=AccessibilityHelpController.get(ot);rt==null||rt.show()}}registerEditorContribution(AccessibilityHelpController.ID,AccessibilityHelpController,4);registerEditorAction(ShowAccessibilityHelpAction);const AccessibilityHelpCommand=EditorCommand.bindToContribution(AccessibilityHelpController.get);registerEditorCommand(new AccessibilityHelpCommand({id:"closeAccessibilityHelp",precondition:CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE,handler:ct=>ct.hide(),kbOpts:{weight:100+100,kbExpr:EditorContextKeys.focus,primary:9,secondary:[1033]}}));const iPadShowKeyboard="";class IPadShowKeyboard extends Disposable{constructor(nt){super(),this.editor=nt,this.widget=null,isIOS&&(this._register(nt.onDidChangeConfiguration(()=>this.update())),this.update())}update(){const nt=!this.editor.getOption(87);!this.widget&&nt?this.widget=new ShowKeyboardWidget(this.editor):this.widget&&!nt&&(this.widget.dispose(),this.widget=null)}dispose(){super.dispose(),this.widget&&(this.widget.dispose(),this.widget=null)}}IPadShowKeyboard.ID="editor.contrib.iPadShowKeyboard";class ShowKeyboardWidget extends Disposable{constructor(nt){super(),this.editor=nt,this._domNode=document.createElement("textarea"),this._domNode.className="iPadShowKeyboard",this._register(addDisposableListener(this._domNode,"touchstart",ot=>{this.editor.focus()})),this._register(addDisposableListener(this._domNode,"focus",ot=>{this.editor.focus()})),this.editor.addOverlayWidget(this)}dispose(){this.editor.removeOverlayWidget(this),super.dispose()}getId(){return ShowKeyboardWidget.ID}getDomNode(){return this._domNode}getPosition(){return{preference:1}}}ShowKeyboardWidget.ID="editor.contrib.ShowKeyboardWidget";registerEditorContribution(IPadShowKeyboard.ID,IPadShowKeyboard,3);const inspectTokens="";var __decorate$7=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$7=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let InspectTokensController=class Vr extends Disposable{static get(nt){return nt.getContribution(Vr.ID)}constructor(nt,ot,rt){super(),this._editor=nt,this._languageService=rt,this._widget=null,this._register(this._editor.onDidChangeModel(ut=>this.stop())),this._register(this._editor.onDidChangeModelLanguage(ut=>this.stop())),this._register(TokenizationRegistry.onDidChange(ut=>this.stop())),this._register(this._editor.onKeyUp(ut=>ut.keyCode===9&&this.stop()))}dispose(){this.stop(),super.dispose()}launch(){this._widget||this._editor.hasModel()&&(this._widget=new InspectTokensWidget(this._editor,this._languageService))}stop(){this._widget&&(this._widget.dispose(),this._widget=null)}};InspectTokensController.ID="editor.contrib.inspectTokens";InspectTokensController=__decorate$7([__param$7(1,IStandaloneThemeService),__param$7(2,ILanguageService)],InspectTokensController);class InspectTokens extends EditorAction{constructor(){super({id:"editor.action.inspectTokens",label:InspectTokensNLS.inspectTokensAction,alias:"Developer: Inspect Tokens",precondition:void 0})}run(nt,ot){const rt=InspectTokensController.get(ot);rt==null||rt.launch()}}function renderTokenText(ct){let nt="";for(let ot=0,rt=ct.length;ot<rt;ot++){const ut=ct.charCodeAt(ot);switch(ut){case 9:nt+="";break;case 32:nt+="";break;default:nt+=String.fromCharCode(ut)}}return nt}function getSafeTokenizationSupport(ct,nt){const ot=TokenizationRegistry.get(nt);if(ot)return ot;const rt=ct.encodeLanguageId(nt);return{getInitialState:()=>NullState,tokenize:(ut,gt,pt)=>nullTokenize(nt,pt),tokenizeEncoded:(ut,gt,pt)=>nullTokenizeEncoded(rt,pt)}}class InspectTokensWidget extends Disposable{constructor(nt,ot){super(),this.allowEditorOverflow=!0,this._editor=nt,this._languageService=ot,this._model=this._editor.getModel(),this._domNode=document.createElement("div"),this._domNode.className="tokens-inspect-widget",this._tokenizationSupport=getSafeTokenizationSupport(this._languageService.languageIdCodec,this._model.getLanguageId()),this._compute(this._editor.getPosition()),this._register(this._editor.onDidChangeCursorPosition(rt=>this._compute(this._editor.getPosition()))),this._editor.addContentWidget(this)}dispose(){this._editor.removeContentWidget(this),super.dispose()}getId(){return InspectTokensWidget._ID}_compute(nt){const ot=this._getTokensAtLine(nt.lineNumber);let rt=0;for(let vt=ot.tokens1.length-1;vt>=0;vt--){const St=ot.tokens1[vt];if(nt.column-1>=St.offset){rt=vt;break}}let ut=0;for(let vt=ot.tokens2.length>>>1;vt>=0;vt--)if(nt.column-1>=ot.tokens2[vt<<1]){ut=vt;break}const gt=this._model.getLineContent(nt.lineNumber);let pt="";if(rt<ot.tokens1.length){const vt=ot.tokens1[rt].offset,St=rt+1<ot.tokens1.length?ot.tokens1[rt+1].offset:gt.length;pt=gt.substring(vt,St)}reset(this._domNode,$$d("h2.tm-token",void 0,renderTokenText(pt),$$d("span.tm-token-length",void 0,`${pt.length} ${pt.length===1?"char":"chars"}`))),append$1(this._domNode,$$d("hr.tokens-inspect-separator",{style:"clear:both"}));const mt=(ut<<1)+1<ot.tokens2.length?this._decodeMetadata(ot.tokens2[(ut<<1)+1]):null;append$1(this._domNode,$$d("table.tm-metadata-table",void 0,$$d("tbody",void 0,$$d("tr",void 0,$$d("td.tm-metadata-key",void 0,"language"),$$d("td.tm-metadata-value",void 0,`${mt?mt.languageId:"-?-"}`)),$$d("tr",void 0,$$d("td.tm-metadata-key",void 0,"token type"),$$d("td.tm-metadata-value",void 0,`${mt?this._tokenTypeToString(mt.tokenType):"-?-"}`)),$$d("tr",void 0,$$d("td.tm-metadata-key",void 0,"font style"),$$d("td.tm-metadata-value",void 0,`${mt?this._fontStyleToString(mt.fontStyle):"-?-"}`)),$$d("tr",void 0,$$d("td.tm-metadata-key",void 0,"foreground"),$$d("td.tm-metadata-value",void 0,`${mt?Color.Format.CSS.formatHex(mt.foreground):"-?-"}`)),$$d("tr",void 0,$$d("td.tm-metadata-key",void 0,"background"),$$d("td.tm-metadata-value",void 0,`${mt?Color.Format.CSS.formatHex(mt.background):"-?-"}`))))),append$1(this._domNode,$$d("hr.tokens-inspect-separator")),rt<ot.tokens1.length&&append$1(this._domNode,$$d("span.tm-token-type",void 0,ot.tokens1[rt].type)),this._editor.layoutContentWidget(this)}_decodeMetadata(nt){const ot=TokenizationRegistry.getColorMap(),rt=TokenMetadata.getLanguageId(nt),ut=TokenMetadata.getTokenType(nt),gt=TokenMetadata.getFontStyle(nt),pt=TokenMetadata.getForeground(nt),mt=TokenMetadata.getBackground(nt);return{languageId:this._languageService.languageIdCodec.decodeLanguageId(rt),tokenType:ut,fontStyle:gt,foreground:ot[pt],background:ot[mt]}}_tokenTypeToString(nt){switch(nt){case 0:return"Other";case 1:return"Comment";case 2:return"String";case 3:return"RegEx";default:return"??"}}_fontStyleToString(nt){let ot="";return nt&1&&(ot+="italic "),nt&2&&(ot+="bold "),nt&4&&(ot+="underline "),nt&8&&(ot+="strikethrough "),ot.length===0&&(ot="---"),ot}_getTokensAtLine(nt){const ot=this._getStateBeforeLine(nt),rt=this._tokenizationSupport.tokenize(this._model.getLineContent(nt),!0,ot),ut=this._tokenizationSupport.tokenizeEncoded(this._model.getLineContent(nt),!0,ot);return{startState:ot,tokens1:rt.tokens,tokens2:ut.tokens,endState:rt.endState}}_getStateBeforeLine(nt){let ot=this._tokenizationSupport.getInitialState();for(let rt=1;rt<nt;rt++)ot=this._tokenizationSupport.tokenize(this._model.getLineContent(rt),!0,ot).endState;return ot}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[2,1]}}}InspectTokensWidget._ID="editor.contrib.inspectTokensWidget";registerEditorContribution(InspectTokensController.ID,InspectTokensController,4);registerEditorAction(InspectTokens);var __decorate$6=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$6=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let HelpQuickAccessProvider=class Fo{constructor(nt,ot){this.quickInputService=nt,this.keybindingService=ot,this.registry=Registry.as(Extensions$1.Quickaccess)}provide(nt){const ot=new DisposableStore;return ot.add(nt.onDidAccept(()=>{const[rt]=nt.selectedItems;rt&&this.quickInputService.quickAccess.show(rt.prefix,{preserveValue:!0})})),ot.add(nt.onDidChangeValue(rt=>{const ut=this.registry.getQuickAccessProvider(rt.substr(Fo.PREFIX.length));ut&&ut.prefix&&ut.prefix!==Fo.PREFIX&&this.quickInputService.quickAccess.show(ut.prefix,{preserveValue:!0})})),nt.items=this.getQuickAccessProviders().filter(rt=>rt.prefix!==Fo.PREFIX),ot}getQuickAccessProviders(){return this.registry.getQuickAccessProviders().sort((ot,rt)=>ot.prefix.localeCompare(rt.prefix)).flatMap(ot=>this.createPicks(ot))}createPicks(nt){return nt.helpEntries.map(ot=>{const rt=ot.prefix||nt.prefix,ut=rt||"";return{prefix:rt,label:ut,keybinding:ot.commandId?this.keybindingService.lookupKeybinding(ot.commandId):void 0,ariaLabel:localize("helpPickAriaLabel","{0}, {1}",ut,ot.description),description:ot.description}})}};HelpQuickAccessProvider.PREFIX="?";HelpQuickAccessProvider=__decorate$6([__param$6(0,IQuickInputService),__param$6(1,IKeybindingService)],HelpQuickAccessProvider);Registry.as(Extensions$1.Quickaccess).registerQuickAccessProvider({ctor:HelpQuickAccessProvider,prefix:"",helpEntries:[{description:QuickHelpNLS.helpQuickAccessActionLabel}]});class AbstractEditorNavigationQuickAccessProvider{constructor(nt){this.options=nt,this.rangeHighlightDecorationId=void 0}provide(nt,ot){var rt;const ut=new DisposableStore;nt.canAcceptInBackground=!!(!((rt=this.options)===null||rt===void 0)&&rt.canAcceptInBackground),nt.matchOnLabel=nt.matchOnDescription=nt.matchOnDetail=nt.sortByLabel=!1;const gt=ut.add(new MutableDisposable);return gt.value=this.doProvide(nt,ot),ut.add(this.onDidActiveTextEditorControlChange(()=>{gt.value=void 0,gt.value=this.doProvide(nt,ot)})),ut}doProvide(nt,ot){const rt=new DisposableStore,ut=this.activeTextEditorControl;if(ut&&this.canProvideWithTextEditor(ut)){const gt={editor:ut},pt=getCodeEditor(ut);if(pt){let mt=withNullAsUndefined(ut.saveViewState());rt.add(pt.onDidChangeCursorPosition(()=>{mt=withNullAsUndefined(ut.saveViewState())})),gt.restoreViewState=()=>{mt&&ut===this.activeTextEditorControl&&ut.restoreViewState(mt)},rt.add(once$1(ot.onCancellationRequested)(()=>{var vt;return(vt=gt.restoreViewState)===null||vt===void 0?void 0:vt.call(gt)}))}rt.add(toDisposable(()=>this.clearDecorations(ut))),rt.add(this.provideWithTextEditor(gt,nt,ot))}else rt.add(this.provideWithoutTextEditor(nt,ot));return rt}canProvideWithTextEditor(nt){return!0}gotoLocation({editor:nt},ot){nt.setSelection(ot.range),nt.revealRangeInCenter(ot.range,0),ot.preserveFocus||nt.focus();const rt=nt.getModel();rt&&"getLineContent"in rt&&alert(`${rt.getLineContent(ot.range.startLineNumber)}`)}getModel(nt){var ot;return isDiffEditor(nt)?(ot=nt.getModel())===null||ot===void 0?void 0:ot.modified:nt.getModel()}addDecorations(nt,ot){nt.changeDecorations(rt=>{const ut=[];this.rangeHighlightDecorationId&&(ut.push(this.rangeHighlightDecorationId.overviewRulerDecorationId),ut.push(this.rangeHighlightDecorationId.rangeHighlightId),this.rangeHighlightDecorationId=void 0);const gt=[{range:ot,options:{description:"quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:ot,options:{description:"quick-access-range-highlight-overview",overviewRuler:{color:themeColorFromId(overviewRulerRangeHighlight),position:OverviewRulerLane.Full}}}],[pt,mt]=rt.deltaDecorations(ut,gt);this.rangeHighlightDecorationId={rangeHighlightId:pt,overviewRulerDecorationId:mt}})}clearDecorations(nt){const ot=this.rangeHighlightDecorationId;ot&&(nt.changeDecorations(rt=>{rt.deltaDecorations([ot.overviewRulerDecorationId,ot.rangeHighlightId],[])}),this.rangeHighlightDecorationId=void 0)}}class AbstractGotoLineQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider{constructor(){super({canAcceptInBackground:!0})}provideWithoutTextEditor(nt){const ot=localize("cannotRunGotoLine","Open a text editor first to go to a line.");return nt.items=[{label:ot}],nt.ariaLabel=ot,Disposable.None}provideWithTextEditor(nt,ot,rt){const ut=nt.editor,gt=new DisposableStore;gt.add(ot.onDidAccept(vt=>{const[St]=ot.selectedItems;if(St){if(!this.isValidLineNumber(ut,St.lineNumber))return;this.gotoLocation(nt,{range:this.toRange(St.lineNumber,St.column),keyMods:ot.keyMods,preserveFocus:vt.inBackground}),vt.inBackground||ot.hide()}}));const pt=()=>{const vt=this.parsePosition(ut,ot.value.trim().substr(AbstractGotoLineQuickAccessProvider.PREFIX.length)),St=this.getPickLabel(ut,vt.lineNumber,vt.column);if(ot.items=[{lineNumber:vt.lineNumber,column:vt.column,label:St}],ot.ariaLabel=St,!this.isValidLineNumber(ut,vt.lineNumber)){this.clearDecorations(ut);return}const yt=this.toRange(vt.lineNumber,vt.column);ut.revealRangeInCenter(yt,0),this.addDecorations(ut,yt)};pt(),gt.add(ot.onDidChangeValue(()=>pt()));const mt=getCodeEditor(ut);return mt&&mt.getOptions().get(65).renderType===2&&(mt.updateOptions({lineNumbers:"on"}),gt.add(toDisposable(()=>mt.updateOptions({lineNumbers:"relative"})))),gt}toRange(nt=1,ot=1){return{startLineNumber:nt,startColumn:ot,endLineNumber:nt,endColumn:ot}}parsePosition(nt,ot){const rt=ot.split(/,|:|#/).map(gt=>parseInt(gt,10)).filter(gt=>!isNaN(gt)),ut=this.lineCount(nt)+1;return{lineNumber:rt[0]>0?rt[0]:ut+rt[0],column:rt[1]}}getPickLabel(nt,ot,rt){if(this.isValidLineNumber(nt,ot))return this.isValidColumn(nt,ot,rt)?localize("gotoLineColumnLabel","Go to line {0} and character {1}.",ot,rt):localize("gotoLineLabel","Go to line {0}.",ot);const ut=nt.getPosition()||{lineNumber:1,column:1},gt=this.lineCount(nt);return gt>1?localize("gotoLineLabelEmptyWithLimit","Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.",ut.lineNumber,ut.column,gt):localize("gotoLineLabelEmpty","Current Line: {0}, Character: {1}. Type a line number to navigate to.",ut.lineNumber,ut.column)}isValidLineNumber(nt,ot){return!ot||typeof ot!="number"?!1:ot>0&&ot<=this.lineCount(nt)}isValidColumn(nt,ot,rt){if(!rt||typeof rt!="number")return!1;const ut=this.getModel(nt);if(!ut)return!1;const gt={lineNumber:ot,column:rt};return ut.validatePosition(gt).equals(gt)}lineCount(nt){var ot,rt;return(rt=(ot=this.getModel(nt))===null||ot===void 0?void 0:ot.getLineCount())!==null&&rt!==void 0?rt:0}}AbstractGotoLineQuickAccessProvider.PREFIX=":";var __decorate$5=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$5=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let StandaloneGotoLineQuickAccessProvider=class extends AbstractGotoLineQuickAccessProvider{constructor(nt){super(),this.editorService=nt,this.onDidActiveTextEditorControlChange=Event.None}get activeTextEditorControl(){return withNullAsUndefined(this.editorService.getFocusedCodeEditor())}};StandaloneGotoLineQuickAccessProvider=__decorate$5([__param$5(0,ICodeEditorService)],StandaloneGotoLineQuickAccessProvider);let GotoLineAction$1=class zr extends EditorAction{constructor(){super({id:zr.ID,label:GoToLineNLS.gotoLineActionLabel,alias:"Go to Line/Column...",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:2085,mac:{primary:293},weight:100}})}run(nt){nt.get(IQuickInputService).quickAccess.show(StandaloneGotoLineQuickAccessProvider.PREFIX)}};GotoLineAction$1.ID="editor.action.gotoLine";registerEditorAction(GotoLineAction$1);Registry.as(Extensions$1.Quickaccess).registerQuickAccessProvider({ctor:StandaloneGotoLineQuickAccessProvider,prefix:StandaloneGotoLineQuickAccessProvider.PREFIX,helpEntries:[{description:GoToLineNLS.gotoLineActionLabel,commandId:GotoLineAction$1.ID}]});const NO_SCORE2=[void 0,[]];function scoreFuzzy2(ct,nt,ot=0,rt=0){const ut=nt;return ut.values&&ut.values.length>1?doScoreFuzzy2Multiple(ct,ut.values,ot,rt):doScoreFuzzy2Single(ct,nt,ot,rt)}function doScoreFuzzy2Multiple(ct,nt,ot,rt){let ut=0;const gt=[];for(const pt of nt){const[mt,vt]=doScoreFuzzy2Single(ct,pt,ot,rt);if(typeof mt!="number")return NO_SCORE2;ut+=mt,gt.push(...vt)}return[ut,normalizeMatches(gt)]}function doScoreFuzzy2Single(ct,nt,ot,rt){const ut=fuzzyScore(nt.original,nt.originalLowercase,ot,ct,ct.toLowerCase(),rt,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return ut?[ut[0],createMatches(ut)]:NO_SCORE2}function normalizeMatches(ct){const nt=ct.sort((ut,gt)=>ut.start-gt.start),ot=[];let rt;for(const ut of nt)!rt||!matchOverlaps(rt,ut)?(rt=ut,ot.push(ut)):(rt.start=Math.min(rt.start,ut.start),rt.end=Math.max(rt.end,ut.end));return ot}function matchOverlaps(ct,nt){return!(ct.end<nt.start||nt.end<ct.start)}function queryExpectsExactMatch(ct){return ct.startsWith('"')&&ct.endsWith('"')}const MULTIPLE_QUERY_VALUES_SEPARATOR=" ";function prepareQuery(ct){typeof ct!="string"&&(ct="");const nt=ct.toLowerCase(),{pathNormalized:ot,normalized:rt,normalizedLowercase:ut}=normalizeQuery(ct),gt=ot.indexOf(sep)>=0,pt=queryExpectsExactMatch(ct);let mt;const vt=ct.split(MULTIPLE_QUERY_VALUES_SEPARATOR);if(vt.length>1)for(const St of vt){const yt=queryExpectsExactMatch(St),{pathNormalized:wt,normalized:Lt,normalizedLowercase:xt}=normalizeQuery(St);Lt&&(mt||(mt=[]),mt.push({original:St,originalLowercase:St.toLowerCase(),pathNormalized:wt,normalized:Lt,normalizedLowercase:xt,expectContiguousMatch:yt}))}return{original:ct,originalLowercase:nt,pathNormalized:ot,normalized:rt,normalizedLowercase:ut,values:mt,containsPathSeparator:gt,expectContiguousMatch:pt}}function normalizeQuery(ct){let nt;isWindows?nt=ct.replace(/\//g,sep):nt=ct.replace(/\\/g,sep);const ot=stripWildcards(nt).replace(/\s|"/g,"");return{pathNormalized:nt,normalized:ot,normalizedLowercase:ot.toLowerCase()}}function pieceToQuery(ct){return Array.isArray(ct)?prepareQuery(ct.map(nt=>nt.original).join(MULTIPLE_QUERY_VALUES_SEPARATOR)):prepareQuery(ct.original)}var __decorate$4=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$4=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$3=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let AbstractGotoSymbolQuickAccessProvider=class ir extends AbstractEditorNavigationQuickAccessProvider{constructor(nt,ot,rt=Object.create(null)){super(rt),this._languageFeaturesService=nt,this._outlineModelService=ot,this.options=rt,this.options.canAcceptInBackground=!0}provideWithoutTextEditor(nt){return this.provideLabelPick(nt,localize("cannotRunGotoSymbolWithoutEditor","To go to a symbol, first open a text editor with symbol information.")),Disposable.None}provideWithTextEditor(nt,ot,rt){const ut=nt.editor,gt=this.getModel(ut);return gt?this._languageFeaturesService.documentSymbolProvider.has(gt)?this.doProvideWithEditorSymbols(nt,gt,ot,rt):this.doProvideWithoutEditorSymbols(nt,gt,ot,rt):Disposable.None}doProvideWithoutEditorSymbols(nt,ot,rt,ut){const gt=new DisposableStore;return this.provideLabelPick(rt,localize("cannotRunGotoSymbolWithoutSymbolProvider","The active text editor does not provide symbol information.")),__awaiter$3(this,void 0,void 0,function*(){!(yield this.waitForLanguageSymbolRegistry(ot,gt))||ut.isCancellationRequested||gt.add(this.doProvideWithEditorSymbols(nt,ot,rt,ut))}),gt}provideLabelPick(nt,ot){nt.items=[{label:ot,index:0,kind:14}],nt.ariaLabel=ot}waitForLanguageSymbolRegistry(nt,ot){return __awaiter$3(this,void 0,void 0,function*(){if(this._languageFeaturesService.documentSymbolProvider.has(nt))return!0;const rt=new DeferredPromise,ut=ot.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(()=>{this._languageFeaturesService.documentSymbolProvider.has(nt)&&(ut.dispose(),rt.complete(!0))}));return ot.add(toDisposable(()=>rt.complete(!1))),rt.p})}doProvideWithEditorSymbols(nt,ot,rt,ut){var gt;const pt=nt.editor,mt=new DisposableStore;mt.add(rt.onDidAccept(wt=>{const[Lt]=rt.selectedItems;Lt&&Lt.range&&(this.gotoLocation(nt,{range:Lt.range.selection,keyMods:rt.keyMods,preserveFocus:wt.inBackground}),wt.inBackground||rt.hide())})),mt.add(rt.onDidTriggerItemButton(({item:wt})=>{wt&&wt.range&&(this.gotoLocation(nt,{range:wt.range.selection,keyMods:rt.keyMods,forceSideBySide:!0}),rt.hide())}));const vt=this.getDocumentSymbols(ot,ut);let St;const yt=wt=>__awaiter$3(this,void 0,void 0,function*(){St==null||St.dispose(!0),rt.busy=!1,St=new CancellationTokenSource$1(ut),rt.busy=!0;try{const Lt=prepareQuery(rt.value.substr(ir.PREFIX.length).trim()),xt=yield this.doGetSymbolPicks(vt,Lt,void 0,St.token);if(ut.isCancellationRequested)return;if(xt.length>0){if(rt.items=xt,wt&&Lt.original.length===0){const It=findLast(xt,kt=>!!(kt.type!=="separator"&&kt.range&&Range$2.containsPosition(kt.range.decoration,wt)));It&&(rt.activeItems=[It])}}else Lt.original.length>0?this.provideLabelPick(rt,localize("noMatchingSymbolResults","No matching editor symbols")):this.provideLabelPick(rt,localize("noSymbolResults","No editor symbols"))}finally{ut.isCancellationRequested||(rt.busy=!1)}});return mt.add(rt.onDidChangeValue(()=>yt(void 0))),yt((gt=pt.getSelection())===null||gt===void 0?void 0:gt.getPosition()),mt.add(rt.onDidChangeActive(()=>{const[wt]=rt.activeItems;wt&&wt.range&&(pt.revealRangeInCenter(wt.range.selection,0),this.addDecorations(pt,wt.range.decoration))})),mt}doGetSymbolPicks(nt,ot,rt,ut){var gt,pt;return __awaiter$3(this,void 0,void 0,function*(){const mt=yield nt;if(ut.isCancellationRequested)return[];const vt=ot.original.indexOf(ir.SCOPE_PREFIX)===0,St=vt?1:0;let yt,wt;ot.values&&ot.values.length>1?(yt=pieceToQuery(ot.values[0]),wt=pieceToQuery(ot.values.slice(1))):yt=ot;let Lt;const xt=(pt=(gt=this.options)===null||gt===void 0?void 0:gt.openSideBySideDirection)===null||pt===void 0?void 0:pt.call(gt);xt&&(Lt=[{iconClass:xt==="right"?ThemeIcon.asClassName(Codicon.splitHorizontal):ThemeIcon.asClassName(Codicon.splitVertical),tooltip:xt==="right"?localize("openToSide","Open to the Side"):localize("openToBottom","Open to the Bottom")}]);const It=[];for(let Tt=0;Tt<mt.length;Tt++){const Rt=mt[Tt],Nt=trim(Rt.name),Pt=`$(${SymbolKinds.toIcon(Rt.kind).id}) ${Nt}`,Ft=Pt.length-Nt.length;let Kt=Rt.containerName;rt!=null&&rt.extraContainerLabel&&(Kt?Kt=`${rt.extraContainerLabel}  ${Kt}`:Kt=rt.extraContainerLabel);let Bt,Ut,qt,Yt;if(ot.original.length>St){let Xt=!1;if(yt!==ot&&([Bt,Ut]=scoreFuzzy2(Pt,Object.assign(Object.assign({},ot),{values:void 0}),St,Ft),typeof Bt=="number"&&(Xt=!0)),typeof Bt!="number"&&([Bt,Ut]=scoreFuzzy2(Pt,yt,St,Ft),typeof Bt!="number"))continue;if(!Xt&&wt){if(Kt&&wt.original.length>0&&([qt,Yt]=scoreFuzzy2(Kt,wt)),typeof qt!="number")continue;typeof Bt=="number"&&(Bt+=qt)}}const Zt=Rt.tags&&Rt.tags.indexOf(1)>=0;It.push({index:Tt,kind:Rt.kind,score:Bt,label:Pt,ariaLabel:Nt,description:Kt,highlights:Zt?void 0:{label:Ut,description:Yt},range:{selection:Range$2.collapseToStart(Rt.selectionRange),decoration:Rt.range},strikethrough:Zt,buttons:Lt})}const kt=It.sort((Tt,Rt)=>vt?this.compareByKindAndScore(Tt,Rt):this.compareByScore(Tt,Rt));let At=[];if(vt){let Pt=function(){Rt&&typeof Tt=="number"&&Nt>0&&(Rt.label=format(NLS_SYMBOL_KIND_CACHE[Tt]||FALLBACK_NLS_SYMBOL_KIND,Nt))},Tt,Rt,Nt=0;for(const Ft of kt)Tt!==Ft.kind?(Pt(),Tt=Ft.kind,Nt=1,Rt={type:"separator"},At.push(Rt)):Nt++,At.push(Ft);Pt()}else kt.length>0&&(At=[{label:localize("symbols","symbols ({0})",It.length),type:"separator"},...kt]);return At})}compareByScore(nt,ot){if(typeof nt.score!="number"&&typeof ot.score=="number")return 1;if(typeof nt.score=="number"&&typeof ot.score!="number")return-1;if(typeof nt.score=="number"&&typeof ot.score=="number"){if(nt.score>ot.score)return-1;if(nt.score<ot.score)return 1}return nt.index<ot.index?-1:nt.index>ot.index?1:0}compareByKindAndScore(nt,ot){const rt=NLS_SYMBOL_KIND_CACHE[nt.kind]||FALLBACK_NLS_SYMBOL_KIND,ut=NLS_SYMBOL_KIND_CACHE[ot.kind]||FALLBACK_NLS_SYMBOL_KIND,gt=rt.localeCompare(ut);return gt===0?this.compareByScore(nt,ot):gt}getDocumentSymbols(nt,ot){return __awaiter$3(this,void 0,void 0,function*(){const rt=yield this._outlineModelService.getOrCreate(nt,ot);return ot.isCancellationRequested?[]:rt.asListOfDocumentSymbols()})}};AbstractGotoSymbolQuickAccessProvider.PREFIX="@";AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX=":";AbstractGotoSymbolQuickAccessProvider.PREFIX_BY_CATEGORY=`${AbstractGotoSymbolQuickAccessProvider.PREFIX}${AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX}`;AbstractGotoSymbolQuickAccessProvider=__decorate$4([__param$4(0,ILanguageFeaturesService),__param$4(1,IOutlineModelService)],AbstractGotoSymbolQuickAccessProvider);const FALLBACK_NLS_SYMBOL_KIND=localize("property","properties ({0})"),NLS_SYMBOL_KIND_CACHE={[5]:localize("method","methods ({0})"),[11]:localize("function","functions ({0})"),[8]:localize("_constructor","constructors ({0})"),[12]:localize("variable","variables ({0})"),[4]:localize("class","classes ({0})"),[22]:localize("struct","structs ({0})"),[23]:localize("event","events ({0})"),[24]:localize("operator","operators ({0})"),[10]:localize("interface","interfaces ({0})"),[2]:localize("namespace","namespaces ({0})"),[3]:localize("package","packages ({0})"),[25]:localize("typeParameter","type parameters ({0})"),[1]:localize("modules","modules ({0})"),[6]:localize("property","properties ({0})"),[9]:localize("enum","enumerations ({0})"),[21]:localize("enumMember","enumeration members ({0})"),[14]:localize("string","strings ({0})"),[0]:localize("file","files ({0})"),[17]:localize("array","arrays ({0})"),[15]:localize("number","numbers ({0})"),[16]:localize("boolean","booleans ({0})"),[18]:localize("object","objects ({0})"),[19]:localize("key","keys ({0})"),[7]:localize("field","fields ({0})"),[13]:localize("constant","constants ({0})")};var __decorate$3=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$3=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let StandaloneGotoSymbolQuickAccessProvider=class extends AbstractGotoSymbolQuickAccessProvider{constructor(nt,ot,rt){super(ot,rt),this.editorService=nt,this.onDidActiveTextEditorControlChange=Event.None}get activeTextEditorControl(){return withNullAsUndefined(this.editorService.getFocusedCodeEditor())}};StandaloneGotoSymbolQuickAccessProvider=__decorate$3([__param$3(0,ICodeEditorService),__param$3(1,ILanguageFeaturesService),__param$3(2,IOutlineModelService)],StandaloneGotoSymbolQuickAccessProvider);class GotoSymbolAction extends EditorAction{constructor(){super({id:GotoSymbolAction.ID,label:QuickOutlineNLS.quickOutlineActionLabel,alias:"Go to Symbol...",precondition:EditorContextKeys.hasDocumentSymbolProvider,kbOpts:{kbExpr:EditorContextKeys.focus,primary:3117,weight:100},contextMenuOpts:{group:"navigation",order:3}})}run(nt){nt.get(IQuickInputService).quickAccess.show(AbstractGotoSymbolQuickAccessProvider.PREFIX,{itemActivation:ItemActivation.NONE})}}GotoSymbolAction.ID="editor.action.quickOutline";registerEditorAction(GotoSymbolAction);Registry.as(Extensions$1.Quickaccess).registerQuickAccessProvider({ctor:StandaloneGotoSymbolQuickAccessProvider,prefix:AbstractGotoSymbolQuickAccessProvider.PREFIX,helpEntries:[{description:QuickOutlineNLS.quickOutlineActionLabel,prefix:AbstractGotoSymbolQuickAccessProvider.PREFIX,commandId:GotoSymbolAction.ID},{description:QuickOutlineNLS.quickOutlineByCategoryActionLabel,prefix:AbstractGotoSymbolQuickAccessProvider.PREFIX_BY_CATEGORY}]});function exceptionToErrorMessage(ct,nt){return nt&&(ct.stack||ct.stacktrace)?localize("stackTrace.format","{0}: {1}",detectSystemErrorMessage(ct),stackToString(ct.stack)||stackToString(ct.stacktrace)):detectSystemErrorMessage(ct)}function stackToString(ct){return Array.isArray(ct)?ct.join(`
`):ct}function detectSystemErrorMessage(ct){return typeof ct.code=="string"&&typeof ct.errno=="number"&&typeof ct.syscall=="string"?localize("nodeExceptionMessage","A system error occurred ({0})",ct.message):ct.message||localize("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function toErrorMessage(ct=null,nt=!1){if(!ct)return localize("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(ct)){const ot=coalesce(ct),rt=toErrorMessage(ot[0],nt);return ot.length>1?localize("error.moreErrors","{0} ({1} errors in total)",rt,ot.length):rt}if(isString$1(ct))return ct;if(ct.detail){const ot=ct.detail;if(ot.error)return exceptionToErrorMessage(ot.error,nt);if(ot.exception)return exceptionToErrorMessage(ot.exception,nt)}return ct.stack?exceptionToErrorMessage(ct,nt):ct.message?ct.message:localize("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}var __awaiter$2=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})},TriggerAction;(function(ct){ct[ct.NO_ACTION=0]="NO_ACTION",ct[ct.CLOSE_PICKER=1]="CLOSE_PICKER",ct[ct.REFRESH_PICKER=2]="REFRESH_PICKER",ct[ct.REMOVE_ITEM=3]="REMOVE_ITEM"})(TriggerAction||(TriggerAction={}));function isPicksWithActive(ct){const nt=ct;return Array.isArray(nt.items)}function isFastAndSlowPicks(ct){const nt=ct;return!!nt.picks&&nt.additionalPicks instanceof Promise}class PickerQuickAccessProvider extends Disposable{constructor(nt,ot){super(),this.prefix=nt,this.options=ot}provide(nt,ot,rt){var ut;const gt=new DisposableStore;nt.canAcceptInBackground=!!(!((ut=this.options)===null||ut===void 0)&&ut.canAcceptInBackground),nt.matchOnLabel=nt.matchOnDescription=nt.matchOnDetail=nt.sortByLabel=!1;let pt;const mt=gt.add(new MutableDisposable),vt=()=>__awaiter$2(this,void 0,void 0,function*(){const St=mt.value=new DisposableStore;pt==null||pt.dispose(!0),nt.busy=!1,pt=new CancellationTokenSource$1(ot);const yt=pt.token,wt=nt.value.substr(this.prefix.length).trim(),Lt=this._getPicks(wt,St,yt,rt),xt=(kt,At)=>{var Tt;let Rt,Nt;if(isPicksWithActive(kt)?(Rt=kt.items,Nt=kt.active):Rt=kt,Rt.length===0){if(At)return!1;(wt.length>0||nt.hideInput)&&(!((Tt=this.options)===null||Tt===void 0)&&Tt.noResultsPick)&&(isFunction(this.options.noResultsPick)?Rt=[this.options.noResultsPick(wt)]:Rt=[this.options.noResultsPick])}return nt.items=Rt,Nt&&(nt.activeItems=[Nt]),!0},It=kt=>__awaiter$2(this,void 0,void 0,function*(){let At=!1,Tt=!1;yield Promise.all([(()=>__awaiter$2(this,void 0,void 0,function*(){typeof kt.mergeDelay=="number"&&(yield timeout(kt.mergeDelay),yt.isCancellationRequested)||Tt||(At=xt(kt.picks,!0))}))(),(()=>__awaiter$2(this,void 0,void 0,function*(){nt.busy=!0;try{const Rt=yield kt.additionalPicks;if(yt.isCancellationRequested)return;let Nt,Pt;isPicksWithActive(kt.picks)?(Nt=kt.picks.items,Pt=kt.picks.active):Nt=kt.picks;let Ft,Kt;if(isPicksWithActive(Rt)?(Ft=Rt.items,Kt=Rt.active):Ft=Rt,Ft.length>0||!At){let Bt;if(!Pt&&!Kt){const Ut=nt.activeItems[0];Ut&&Nt.indexOf(Ut)!==-1&&(Bt=Ut)}xt({items:[...Nt,...Ft],active:Pt||Kt||Bt})}}finally{yt.isCancellationRequested||(nt.busy=!1),Tt=!0}}))()])});if(Lt!==null)if(isFastAndSlowPicks(Lt))yield It(Lt);else if(!(Lt instanceof Promise))xt(Lt);else{nt.busy=!0;try{const kt=yield Lt;if(yt.isCancellationRequested)return;isFastAndSlowPicks(kt)?yield It(kt):xt(kt)}finally{yt.isCancellationRequested||(nt.busy=!1)}}});return gt.add(nt.onDidChangeValue(()=>vt())),vt(),gt.add(nt.onDidAccept(St=>{const[yt]=nt.selectedItems;typeof(yt==null?void 0:yt.accept)=="function"&&(St.inBackground||nt.hide(),yt.accept(nt.keyMods,St))})),gt.add(nt.onDidTriggerItemButton(({button:St,item:yt})=>__awaiter$2(this,void 0,void 0,function*(){var wt,Lt;if(typeof yt.trigger=="function"){const xt=(Lt=(wt=yt.buttons)===null||wt===void 0?void 0:wt.indexOf(St))!==null&&Lt!==void 0?Lt:-1;if(xt>=0){const It=yt.trigger(xt,nt.keyMods),kt=typeof It=="number"?It:yield It;if(ot.isCancellationRequested)return;switch(kt){case TriggerAction.NO_ACTION:break;case TriggerAction.CLOSE_PICKER:nt.hide();break;case TriggerAction.REFRESH_PICKER:vt();break;case TriggerAction.REMOVE_ITEM:{const At=nt.items.indexOf(yt);if(At!==-1){const Tt=nt.items.slice(),Rt=Tt.splice(At,1),Nt=nt.activeItems.filter(Ft=>Ft!==Rt[0]),Pt=nt.keepScrollPosition;nt.keepScrollPosition=!0,nt.items=Tt,Nt&&(nt.activeItems=Nt),nt.keepScrollPosition=Pt}break}}}}}))),gt}}var __decorate$2=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$2=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter$1=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let AbstractCommandsQuickAccessProvider=class Bo extends PickerQuickAccessProvider{constructor(nt,ot,rt,ut,gt,pt){super(Bo.PREFIX,nt),this.instantiationService=ot,this.keybindingService=rt,this.commandService=ut,this.telemetryService=gt,this.dialogService=pt,this.commandsHistory=this._register(this.instantiationService.createInstance(CommandsHistory)),this.options=nt}_getPicks(nt,ot,rt,ut){var gt,pt;return __awaiter$1(this,void 0,void 0,function*(){const mt=yield this.getCommandPicks(rt);if(rt.isCancellationRequested)return[];const vt=[];for(const xt of mt){const It=withNullAsUndefined(Bo.WORD_FILTER(nt,xt.label)),kt=xt.commandAlias?withNullAsUndefined(Bo.WORD_FILTER(nt,xt.commandAlias)):void 0;It||kt?(xt.highlights={label:It,detail:this.options.showAlias?kt:void 0},vt.push(xt)):nt===xt.commandId&&vt.push(xt)}const St=new Map;for(const xt of vt){const It=St.get(xt.label);It?(xt.description=xt.commandId,It.description=It.commandId):St.set(xt.label,xt)}vt.sort((xt,It)=>{const kt=this.commandsHistory.peek(xt.commandId),At=this.commandsHistory.peek(It.commandId);if(kt&&At)return kt>At?-1:1;if(kt)return-1;if(At)return 1;if(this.options.suggestedCommandIds){const Tt=this.options.suggestedCommandIds.has(xt.commandId),Rt=this.options.suggestedCommandIds.has(It.commandId);if(Tt&&Rt)return 0;if(Tt)return-1;if(Rt)return 1}return xt.label.localeCompare(It.label)});const yt=[];let wt=!1,Lt=!!this.options.suggestedCommandIds;for(let xt=0;xt<vt.length;xt++){const It=vt[xt];xt===0&&this.commandsHistory.peek(It.commandId)&&(yt.push({type:"separator",label:localize("recentlyUsed","recently used")}),wt=!0),Lt&&!this.commandsHistory.peek(It.commandId)&&(!((gt=this.options.suggestedCommandIds)===null||gt===void 0)&&gt.has(It.commandId))&&(yt.push({type:"separator",label:localize("commonlyUsed","commonly used")}),wt=!0,Lt=!1),wt&&!this.commandsHistory.peek(It.commandId)&&!(!((pt=this.options.suggestedCommandIds)===null||pt===void 0)&&pt.has(It.commandId))&&(yt.push({type:"separator",label:localize("morecCommands","other commands")}),wt=!1),yt.push(this.toCommandPick(It,ut))}return this.hasAdditionalCommandPicks(nt,rt)?{picks:yt,additionalPicks:(()=>__awaiter$1(this,void 0,void 0,function*(){const xt=yield this.getAdditionalCommandPicks(mt,vt,nt,rt);return rt.isCancellationRequested?[]:xt.map(It=>this.toCommandPick(It,ut))}))()}:yt})}toCommandPick(nt,ot){if(nt.type==="separator")return nt;const rt=this.keybindingService.lookupKeybinding(nt.commandId),ut=rt?localize("commandPickAriaLabelWithKeybinding","{0}, {1}",nt.label,rt.getAriaLabel()):nt.label;return Object.assign(Object.assign({},nt),{ariaLabel:ut,detail:this.options.showAlias&&nt.commandAlias!==nt.label?nt.commandAlias:void 0,keybinding:rt,accept:()=>__awaiter$1(this,void 0,void 0,function*(){var gt;this.commandsHistory.push(nt.commandId),this.telemetryService.publicLog2("workbenchActionExecuted",{id:nt.commandId,from:(gt=ot==null?void 0:ot.from)!==null&&gt!==void 0?gt:"quick open"});try{yield this.commandService.executeCommand(nt.commandId)}catch(pt){isCancellationError(pt)||this.dialogService.error(localize("canNotRun","Command '{0}' resulted in an error",nt.label),toErrorMessage(pt))}})})}};AbstractCommandsQuickAccessProvider.PREFIX=">";AbstractCommandsQuickAccessProvider.WORD_FILTER=or(matchesPrefix,matchesWords,matchesContiguousSubString);AbstractCommandsQuickAccessProvider=__decorate$2([__param$2(1,IInstantiationService),__param$2(2,IKeybindingService),__param$2(3,ICommandService),__param$2(4,ITelemetryService),__param$2(5,IDialogService)],AbstractCommandsQuickAccessProvider);let CommandsHistory=class Vn extends Disposable{constructor(nt,ot){super(),this.storageService=nt,this.configurationService=ot,this.configuredCommandsHistoryLength=0,this.updateConfiguration(),this.load(),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(nt=>this.updateConfiguration(nt)))}updateConfiguration(nt){nt&&!nt.affectsConfiguration("workbench.commandPalette.history")||(this.configuredCommandsHistoryLength=Vn.getConfiguredCommandHistoryLength(this.configurationService),Vn.cache&&Vn.cache.limit!==this.configuredCommandsHistoryLength&&(Vn.cache.limit=this.configuredCommandsHistoryLength,Vn.saveState(this.storageService)))}load(){const nt=this.storageService.get(Vn.PREF_KEY_CACHE,0);let ot;if(nt)try{ot=JSON.parse(nt)}catch{}const rt=Vn.cache=new LRUCache(this.configuredCommandsHistoryLength,1);if(ot){let ut;ot.usesLRU?ut=ot.entries:ut=ot.entries.sort((gt,pt)=>gt.value-pt.value),ut.forEach(gt=>rt.set(gt.key,gt.value))}Vn.counter=this.storageService.getNumber(Vn.PREF_KEY_COUNTER,0,Vn.counter)}push(nt){Vn.cache&&(Vn.cache.set(nt,Vn.counter++),Vn.saveState(this.storageService))}peek(nt){var ot;return(ot=Vn.cache)===null||ot===void 0?void 0:ot.peek(nt)}static saveState(nt){if(!Vn.cache)return;const ot={usesLRU:!0,entries:[]};Vn.cache.forEach((rt,ut)=>ot.entries.push({key:ut,value:rt})),nt.store(Vn.PREF_KEY_CACHE,JSON.stringify(ot),0,0),nt.store(Vn.PREF_KEY_COUNTER,Vn.counter,0,0)}static getConfiguredCommandHistoryLength(nt){var ot,rt;const gt=(rt=(ot=nt.getValue().workbench)===null||ot===void 0?void 0:ot.commandPalette)===null||rt===void 0?void 0:rt.history;return typeof gt=="number"?gt:Vn.DEFAULT_COMMANDS_HISTORY_LENGTH}};CommandsHistory.DEFAULT_COMMANDS_HISTORY_LENGTH=50;CommandsHistory.PREF_KEY_CACHE="commandPalette.mru.cache";CommandsHistory.PREF_KEY_COUNTER="commandPalette.mru.counter";CommandsHistory.counter=1;CommandsHistory=__decorate$2([__param$2(0,IStorageService),__param$2(1,IConfigurationService)],CommandsHistory);class AbstractEditorCommandsQuickAccessProvider extends AbstractCommandsQuickAccessProvider{constructor(nt,ot,rt,ut,gt,pt){super(nt,ot,rt,ut,gt,pt)}getCodeEditorCommandPicks(){const nt=this.activeTextEditorControl;if(!nt)return[];const ot=[];for(const rt of nt.getSupportedActions())ot.push({commandId:rt.id,commandAlias:rt.alias,label:stripIcons(rt.label)||rt.id});return ot}}var __decorate$1=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param$1=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}},__awaiter=globalThis&&globalThis.__awaiter||function(ct,nt,ot,rt){function ut(gt){return gt instanceof ot?gt:new ot(function(pt){pt(gt)})}return new(ot||(ot=Promise))(function(gt,pt){function mt(yt){try{St(rt.next(yt))}catch(wt){pt(wt)}}function vt(yt){try{St(rt.throw(yt))}catch(wt){pt(wt)}}function St(yt){yt.done?gt(yt.value):ut(yt.value).then(mt,vt)}St((rt=rt.apply(ct,nt||[])).next())})};let StandaloneCommandsQuickAccessProvider=class extends AbstractEditorCommandsQuickAccessProvider{get activeTextEditorControl(){return withNullAsUndefined(this.codeEditorService.getFocusedCodeEditor())}constructor(nt,ot,rt,ut,gt,pt){super({showAlias:!1},nt,rt,ut,gt,pt),this.codeEditorService=ot}getCommandPicks(){return __awaiter(this,void 0,void 0,function*(){return this.getCodeEditorCommandPicks()})}hasAdditionalCommandPicks(){return!1}getAdditionalCommandPicks(){return __awaiter(this,void 0,void 0,function*(){return[]})}};StandaloneCommandsQuickAccessProvider=__decorate$1([__param$1(0,IInstantiationService),__param$1(1,ICodeEditorService),__param$1(2,IKeybindingService),__param$1(3,ICommandService),__param$1(4,ITelemetryService),__param$1(5,IDialogService)],StandaloneCommandsQuickAccessProvider);class GotoLineAction extends EditorAction{constructor(){super({id:GotoLineAction.ID,label:QuickCommandNLS.quickCommandActionLabel,alias:"Command Palette",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:59,weight:100},contextMenuOpts:{group:"z_commands",order:1}})}run(nt){nt.get(IQuickInputService).quickAccess.show(StandaloneCommandsQuickAccessProvider.PREFIX)}}GotoLineAction.ID="editor.action.quickCommand";registerEditorAction(GotoLineAction);Registry.as(Extensions$1.Quickaccess).registerQuickAccessProvider({ctor:StandaloneCommandsQuickAccessProvider,prefix:StandaloneCommandsQuickAccessProvider.PREFIX,helpEntries:[{description:QuickCommandNLS.quickCommandHelp,commandId:GotoLineAction.ID}]});var __decorate=globalThis&&globalThis.__decorate||function(ct,nt,ot,rt){var ut=arguments.length,gt=ut<3?nt:rt===null?rt=Object.getOwnPropertyDescriptor(nt,ot):rt,pt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gt=Reflect.decorate(ct,nt,ot,rt);else for(var mt=ct.length-1;mt>=0;mt--)(pt=ct[mt])&&(gt=(ut<3?pt(gt):ut>3?pt(nt,ot,gt):pt(nt,ot))||gt);return ut>3&&gt&&Object.defineProperty(nt,ot,gt),gt},__param=globalThis&&globalThis.__param||function(ct,nt){return function(ot,rt){nt(ot,rt,ct)}};let StandaloneReferencesController=class extends ReferencesController{constructor(nt,ot,rt,ut,gt,pt,mt){super(!0,nt,ot,rt,ut,gt,pt,mt)}};StandaloneReferencesController=__decorate([__param(1,IContextKeyService),__param(2,ICodeEditorService),__param(3,INotificationService),__param(4,IInstantiationService),__param(5,IStorageService),__param(6,IConfigurationService)],StandaloneReferencesController);registerEditorContribution(ReferencesController.ID,StandaloneReferencesController,4);class ToggleHighContrast extends EditorAction{constructor(){super({id:"editor.action.toggleHighContrast",label:ToggleHighContrastNLS.toggleHighContrast,alias:"Toggle High Contrast Theme",precondition:void 0}),this._originalThemeName=null}run(nt,ot){const rt=nt.get(IStandaloneThemeService),ut=rt.getColorTheme();isHighContrast(ut.type)?(rt.setTheme(this._originalThemeName||(isDark(ut.type)?VS_DARK_THEME_NAME:VS_LIGHT_THEME_NAME)),this._originalThemeName=null):(rt.setTheme(isDark(ut.type)?HC_BLACK_THEME_NAME:HC_LIGHT_THEME_NAME),this._originalThemeName=ut.themeName)}}registerEditorAction(ToggleHighContrast);class RelativeSelection{constructor(nt,ot,rt){this.start=nt,this.end=ot,this.direction=rt}}const createRelativeSelection=(ct,nt,ot)=>{const rt=ct.getSelection();if(rt!==null){const ut=rt.getStartPosition(),gt=rt.getEndPosition(),pt=createRelativePositionFromTypeIndex(ot,nt.getOffsetAt(ut)),mt=createRelativePositionFromTypeIndex(ot,nt.getOffsetAt(gt));return new RelativeSelection(pt,mt,rt.getDirection())}return null},createMonacoSelectionFromRelativeSelection=(ct,nt,ot,rt)=>{const ut=createAbsolutePositionFromRelativePosition(ot.start,rt),gt=createAbsolutePositionFromRelativePosition(ot.end,rt);if(ut!==null&&gt!==null&&ut.type===nt&&gt.type===nt){const pt=ct.getModel(),mt=pt.getPositionAt(ut.index),vt=pt.getPositionAt(gt.index);return Selection.createWithDirection(mt.lineNumber,mt.column,vt.lineNumber,vt.column,ot.direction)}return null};class MonacoBinding{constructor(nt,ot,rt=new Set,ut=null){this.doc=nt.doc,this.ytext=nt,this.monacoModel=ot,this.editors=rt,this.mux=createMutex(),this._savedSelections=new Map,this._beforeTransaction=()=>{this.mux(()=>{this._savedSelections=new Map,rt.forEach(gt=>{if(gt.getModel()===ot){const pt=createRelativeSelection(gt,ot,nt);pt!==null&&this._savedSelections.set(gt,pt)}})})},this.doc.on("beforeAllTransactions",this._beforeTransaction),this._decorations=new Map,this._rerenderDecorations=()=>{rt.forEach(gt=>{if(ut&&gt.getModel()===ot){const pt=this._decorations.get(gt)||[],mt=[];ut.getStates().forEach((vt,St)=>{if(St!==this.doc.clientID&&vt.selection!=null&&vt.selection.anchor!=null&&vt.selection.head!=null){const yt=createAbsolutePositionFromRelativePosition(vt.selection.anchor,this.doc),wt=createAbsolutePositionFromRelativePosition(vt.selection.head,this.doc);if(yt!==null&&wt!==null&&yt.type===nt&&wt.type===nt){let Lt,xt,It,kt;yt.index<wt.index?(Lt=ot.getPositionAt(yt.index),xt=ot.getPositionAt(wt.index),It="yRemoteSelectionHead yRemoteSelectionHead-"+St,kt=null):(Lt=ot.getPositionAt(wt.index),xt=ot.getPositionAt(yt.index),It=null,kt="yRemoteSelectionHead yRemoteSelectionHead-"+St),mt.push({range:new Range(Lt.lineNumber,Lt.column,xt.lineNumber,xt.column),options:{className:"yRemoteSelection yRemoteSelection-"+St,afterContentClassName:It,beforeContentClassName:kt}})}}}),this._decorations.set(gt,gt.deltaDecorations(pt,mt))}else this._decorations.delete(gt)})},this._ytextObserver=gt=>{this.mux(()=>{let pt=0;gt.delta.forEach(mt=>{if(mt.retain!==void 0)pt+=mt.retain;else if(mt.insert!==void 0){const vt=ot.getPositionAt(pt),St=new Selection(vt.lineNumber,vt.column,vt.lineNumber,vt.column),yt=mt.insert;ot.applyEdits([{range:St,text:yt}]),pt+=yt.length}else if(mt.delete!==void 0){const vt=ot.getPositionAt(pt),St=ot.getPositionAt(pt+mt.delete),yt=new Selection(vt.lineNumber,vt.column,St.lineNumber,St.column);ot.applyEdits([{range:yt,text:""}])}else throw unexpectedCase()}),this._savedSelections.forEach((mt,vt)=>{const St=createMonacoSelectionFromRelativeSelection(vt,nt,mt,this.doc);St!==null&&vt.setSelection(St)})}),this._rerenderDecorations()},nt.observe(this._ytextObserver);{const gt=nt.toString();ot.getValue()!==gt&&ot.setValue(gt)}this._monacoChangeHandler=ot.onDidChangeContent(gt=>{this.mux(()=>{this.doc.transact(()=>{gt.changes.sort((pt,mt)=>mt.rangeOffset-pt.rangeOffset).forEach(pt=>{nt.delete(pt.rangeOffset,pt.rangeLength),nt.insert(pt.rangeOffset,pt.text)})},this)})}),ot.onWillDispose(()=>{this.destroy()}),ut&&(rt.forEach(gt=>{gt.onDidChangeCursorSelection(()=>{if(gt.getModel()===ot){const pt=gt.getSelection();if(pt===null)return;let mt=ot.getOffsetAt(pt.getStartPosition()),vt=ot.getOffsetAt(pt.getEndPosition());if(pt.getDirection()===SelectionDirection.RTL){const St=mt;mt=vt,vt=St}ut.setLocalStateField("selection",{anchor:createRelativePositionFromTypeIndex(nt,mt),head:createRelativePositionFromTypeIndex(nt,vt)})}}),ut.on("change",this._rerenderDecorations)}),this.awareness=ut)}destroy(){this._monacoChangeHandler.dispose(),this.ytext.unobserve(this._ytextObserver),this.doc.off("beforeAllTransactions",this._beforeTransaction),this.awareness&&this.awareness.off("change",this._rerenderDecorations)}}const CodeEditorWindow=({onChange,language,code,theme,onCodeChange})=>{const[value,setValue]=reactExports.useState(code||""),[output,setOutput]=reactExports.useState(""),editorRef=reactExports.useRef(null);function handleEditorDidMount(ct,nt){editorRef.current=ct;const ot=new Doc,rt=new WebrtcProvider("test-room",ot),ut=ot.getText("monaco");new MonacoBinding(ut,editorRef.current.getModel(),new Set([editorRef.current]),rt.awareness),console.log(rt.awareness)}const handleEditorChange=(ct,nt,ot)=>{setValue(ct),console.log("editor things:",ct),console.log(code)},runCode=()=>{try{const originalLog=console.log;let consoleOutput="";console.log=(...ct)=>{consoleOutput+=ct.join(" ")+`
`},eval(value),console.log=originalLog,setOutput(consoleOutput)}catch(ct){setOutput(ct.toString())}};return jsxRuntimeExports.jsxs("div",{className:"myEditor",children:[jsxRuntimeExports.jsx(Fe,{height:"68vh",defaultLanguage:"javascript",onMount:handleEditorDidMount,value,options:{fontSize:18},onChange:handleEditorChange,theme:"vs-dark",defaultValue:"// Write your javascript code here"}),jsxRuntimeExports.jsx("button",{onClick:runCode,style:{marginTop:"7px",border:"1px solid #303234",width:"60px",cursor:"pointer",fontSize:"14px",backgroundColor:"#302034",minHeight:"30px",color:"#ccb782"},children:"Run"}),jsxRuntimeExports.jsx("pre",{style:{marginTop:"16px",padding:"8px",borderRadius:"4px",width:"99%",fontSize:"20px",backgroundColor:"#CCC6AE",minHeight:"150px",color:"#791111"},children:output})]})},PACKET_TYPES=Object.create(null);PACKET_TYPES.open="0";PACKET_TYPES.close="1";PACKET_TYPES.ping="2";PACKET_TYPES.pong="3";PACKET_TYPES.message="4";PACKET_TYPES.upgrade="5";PACKET_TYPES.noop="6";const PACKET_TYPES_REVERSE=Object.create(null);Object.keys(PACKET_TYPES).forEach(ct=>{PACKET_TYPES_REVERSE[PACKET_TYPES[ct]]=ct});const ERROR_PACKET={type:"error",data:"parser error"},withNativeBlob$1=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",withNativeArrayBuffer$2=typeof ArrayBuffer=="function",isView$1=ct=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(ct):ct&&ct.buffer instanceof ArrayBuffer,encodePacket=({type:ct,data:nt},ot,rt)=>withNativeBlob$1&&nt instanceof Blob?ot?rt(nt):encodeBlobAsBase64(nt,rt):withNativeArrayBuffer$2&&(nt instanceof ArrayBuffer||isView$1(nt))?ot?rt(nt):encodeBlobAsBase64(new Blob([nt]),rt):rt(PACKET_TYPES[ct]+(nt||"")),encodeBlobAsBase64=(ct,nt)=>{const ot=new FileReader;return ot.onload=function(){const rt=ot.result.split(",")[1];nt("b"+(rt||""))},ot.readAsDataURL(ct)},chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let ct=0;ct<chars.length;ct++)lookup$1[chars.charCodeAt(ct)]=ct;const decode$1=ct=>{let nt=ct.length*.75,ot=ct.length,rt,ut=0,gt,pt,mt,vt;ct[ct.length-1]==="="&&(nt--,ct[ct.length-2]==="="&&nt--);const St=new ArrayBuffer(nt),yt=new Uint8Array(St);for(rt=0;rt<ot;rt+=4)gt=lookup$1[ct.charCodeAt(rt)],pt=lookup$1[ct.charCodeAt(rt+1)],mt=lookup$1[ct.charCodeAt(rt+2)],vt=lookup$1[ct.charCodeAt(rt+3)],yt[ut++]=gt<<2|pt>>4,yt[ut++]=(pt&15)<<4|mt>>2,yt[ut++]=(mt&3)<<6|vt&63;return St},withNativeArrayBuffer$1=typeof ArrayBuffer=="function",decodePacket=(ct,nt)=>{if(typeof ct!="string")return{type:"message",data:mapBinary(ct,nt)};const ot=ct.charAt(0);return ot==="b"?{type:"message",data:decodeBase64Packet(ct.substring(1),nt)}:PACKET_TYPES_REVERSE[ot]?ct.length>1?{type:PACKET_TYPES_REVERSE[ot],data:ct.substring(1)}:{type:PACKET_TYPES_REVERSE[ot]}:ERROR_PACKET},decodeBase64Packet=(ct,nt)=>{if(withNativeArrayBuffer$1){const ot=decode$1(ct);return mapBinary(ot,nt)}else return{base64:!0,data:ct}},mapBinary=(ct,nt)=>{switch(nt){case"blob":return ct instanceof ArrayBuffer?new Blob([ct]):ct;case"arraybuffer":default:return ct}},SEPARATOR=String.fromCharCode(30),encodePayload=(ct,nt)=>{const ot=ct.length,rt=new Array(ot);let ut=0;ct.forEach((gt,pt)=>{encodePacket(gt,!1,mt=>{rt[pt]=mt,++ut===ot&&nt(rt.join(SEPARATOR))})})},decodePayload=(ct,nt)=>{const ot=ct.split(SEPARATOR),rt=[];for(let ut=0;ut<ot.length;ut++){const gt=decodePacket(ot[ut],nt);if(rt.push(gt),gt.type==="error")break}return rt},protocol$1=4;function Emitter(ct){if(ct)return mixin(ct)}function mixin(ct){for(var nt in Emitter.prototype)ct[nt]=Emitter.prototype[nt];return ct}Emitter.prototype.on=Emitter.prototype.addEventListener=function(ct,nt){return this._callbacks=this._callbacks||{},(this._callbacks["$"+ct]=this._callbacks["$"+ct]||[]).push(nt),this};Emitter.prototype.once=function(ct,nt){function ot(){this.off(ct,ot),nt.apply(this,arguments)}return ot.fn=nt,this.on(ct,ot),this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(ct,nt){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var ot=this._callbacks["$"+ct];if(!ot)return this;if(arguments.length==1)return delete this._callbacks["$"+ct],this;for(var rt,ut=0;ut<ot.length;ut++)if(rt=ot[ut],rt===nt||rt.fn===nt){ot.splice(ut,1);break}return ot.length===0&&delete this._callbacks["$"+ct],this};Emitter.prototype.emit=function(ct){this._callbacks=this._callbacks||{};for(var nt=new Array(arguments.length-1),ot=this._callbacks["$"+ct],rt=1;rt<arguments.length;rt++)nt[rt-1]=arguments[rt];if(ot){ot=ot.slice(0);for(var rt=0,ut=ot.length;rt<ut;++rt)ot[rt].apply(this,nt)}return this};Emitter.prototype.emitReserved=Emitter.prototype.emit;Emitter.prototype.listeners=function(ct){return this._callbacks=this._callbacks||{},this._callbacks["$"+ct]||[]};Emitter.prototype.hasListeners=function(ct){return!!this.listeners(ct).length};const globalThisShim=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function pick(ct,...nt){return nt.reduce((ot,rt)=>(ct.hasOwnProperty(rt)&&(ot[rt]=ct[rt]),ot),{})}const NATIVE_SET_TIMEOUT=globalThisShim.setTimeout,NATIVE_CLEAR_TIMEOUT=globalThisShim.clearTimeout;function installTimerFunctions(ct,nt){nt.useNativeTimers?(ct.setTimeoutFn=NATIVE_SET_TIMEOUT.bind(globalThisShim),ct.clearTimeoutFn=NATIVE_CLEAR_TIMEOUT.bind(globalThisShim)):(ct.setTimeoutFn=globalThisShim.setTimeout.bind(globalThisShim),ct.clearTimeoutFn=globalThisShim.clearTimeout.bind(globalThisShim))}const BASE64_OVERHEAD=1.33;function byteLength(ct){return typeof ct=="string"?utf8Length(ct):Math.ceil((ct.byteLength||ct.size)*BASE64_OVERHEAD)}function utf8Length(ct){let nt=0,ot=0;for(let rt=0,ut=ct.length;rt<ut;rt++)nt=ct.charCodeAt(rt),nt<128?ot+=1:nt<2048?ot+=2:nt<55296||nt>=57344?ot+=3:(rt++,ot+=4);return ot}class TransportError extends Error{constructor(nt,ot,rt){super(nt),this.description=ot,this.context=rt,this.type="TransportError"}}class Transport extends Emitter{constructor(nt){super(),this.writable=!1,installTimerFunctions(this,nt),this.opts=nt,this.query=nt.query,this.socket=nt.socket}onError(nt,ot,rt){return super.emitReserved("error",new TransportError(nt,ot,rt)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(nt){this.readyState==="open"&&this.write(nt)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(nt){const ot=decodePacket(nt,this.socket.binaryType);this.onPacket(ot)}onPacket(nt){super.emitReserved("packet",nt)}onClose(nt){this.readyState="closed",super.emitReserved("close",nt)}pause(nt){}}const alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map={};let seed=0,i=0,prev;function encode$1(ct){let nt="";do nt=alphabet[ct%length]+nt,ct=Math.floor(ct/length);while(ct>0);return nt}function yeast(){const ct=encode$1(+new Date);return ct!==prev?(seed=0,prev=ct):ct+"."+encode$1(seed++)}for(;i<length;i++)map[alphabet[i]]=i;function encode(ct){let nt="";for(let ot in ct)ct.hasOwnProperty(ot)&&(nt.length&&(nt+="&"),nt+=encodeURIComponent(ot)+"="+encodeURIComponent(ct[ot]));return nt}function decode(ct){let nt={},ot=ct.split("&");for(let rt=0,ut=ot.length;rt<ut;rt++){let gt=ot[rt].split("=");nt[decodeURIComponent(gt[0])]=decodeURIComponent(gt[1])}return nt}let value=!1;try{value=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch(ct){}const hasCORS=value;function XHR(ct){const nt=ct.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!nt||hasCORS))return new XMLHttpRequest}catch{}if(!nt)try{return new globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function empty(){}const hasXHR2=function(){return new XHR({xdomain:!1}).responseType!=null}();class Polling extends Transport{constructor(nt){if(super(nt),this.polling=!1,typeof location<"u"){const rt=location.protocol==="https:";let ut=location.port;ut||(ut=rt?"443":"80"),this.xd=typeof location<"u"&&nt.hostname!==location.hostname||ut!==nt.port,this.xs=nt.secure!==rt}const ot=nt&&nt.forceBase64;this.supportsBinary=hasXHR2&&!ot}get name(){return"polling"}doOpen(){this.poll()}pause(nt){this.readyState="pausing";const ot=()=>{this.readyState="paused",nt()};if(this.polling||!this.writable){let rt=0;this.polling&&(rt++,this.once("pollComplete",function(){--rt||ot()})),this.writable||(rt++,this.once("drain",function(){--rt||ot()}))}else ot()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(nt){const ot=rt=>{if(this.readyState==="opening"&&rt.type==="open"&&this.onOpen(),rt.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(rt)};decodePayload(nt,this.socket.binaryType).forEach(ot),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const nt=()=>{this.write([{type:"close"}])};this.readyState==="open"?nt():this.once("open",nt)}write(nt){this.writable=!1,encodePayload(nt,ot=>{this.doWrite(ot,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let nt=this.query||{};const ot=this.opts.secure?"https":"http";let rt="";this.opts.timestampRequests!==!1&&(nt[this.opts.timestampParam]=yeast()),!this.supportsBinary&&!nt.sid&&(nt.b64=1),this.opts.port&&(ot==="https"&&Number(this.opts.port)!==443||ot==="http"&&Number(this.opts.port)!==80)&&(rt=":"+this.opts.port);const ut=encode(nt),gt=this.opts.hostname.indexOf(":")!==-1;return ot+"://"+(gt?"["+this.opts.hostname+"]":this.opts.hostname)+rt+this.opts.path+(ut.length?"?"+ut:"")}request(nt={}){return Object.assign(nt,{xd:this.xd,xs:this.xs},this.opts),new Request(this.uri(),nt)}doWrite(nt,ot){const rt=this.request({method:"POST",data:nt});rt.on("success",ot),rt.on("error",(ut,gt)=>{this.onError("xhr post error",ut,gt)})}doPoll(){const nt=this.request();nt.on("data",this.onData.bind(this)),nt.on("error",(ot,rt)=>{this.onError("xhr poll error",ot,rt)}),this.pollXhr=nt}}class Request extends Emitter{constructor(nt,ot){super(),installTimerFunctions(this,ot),this.opts=ot,this.method=ot.method||"GET",this.uri=nt,this.async=ot.async!==!1,this.data=ot.data!==void 0?ot.data:null,this.create()}create(){const nt=pick(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");nt.xdomain=!!this.opts.xd,nt.xscheme=!!this.opts.xs;const ot=this.xhr=new XHR(nt);try{ot.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){ot.setDisableHeaderCheck&&ot.setDisableHeaderCheck(!0);for(let rt in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(rt)&&ot.setRequestHeader(rt,this.opts.extraHeaders[rt])}}catch{}if(this.method==="POST")try{ot.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{ot.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in ot&&(ot.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(ot.timeout=this.opts.requestTimeout),ot.onreadystatechange=()=>{ot.readyState===4&&(ot.status===200||ot.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof ot.status=="number"?ot.status:0)},0))},ot.send(this.data)}catch(rt){this.setTimeoutFn(()=>{this.onError(rt)},0);return}typeof document<"u"&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)}onError(nt){this.emitReserved("error",nt,this.xhr),this.cleanup(!0)}cleanup(nt){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=empty,nt)try{this.xhr.abort()}catch{}typeof document<"u"&&delete Request.requests[this.index],this.xhr=null}}onLoad(){const nt=this.xhr.responseText;nt!==null&&(this.emitReserved("data",nt),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}Request.requestsCount=0;Request.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",unloadHandler);else if(typeof addEventListener=="function"){const ct="onpagehide"in globalThisShim?"pagehide":"unload";addEventListener(ct,unloadHandler,!1)}}function unloadHandler(){for(let ct in Request.requests)Request.requests.hasOwnProperty(ct)&&Request.requests[ct].abort()}const nextTick=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?nt=>Promise.resolve().then(nt):(nt,ot)=>ot(nt,0))(),WebSocket$1=globalThisShim.WebSocket||globalThisShim.MozWebSocket,usingBrowserWebSocket=!0,defaultBinaryType="arraybuffer",isReactNative=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class WS extends Transport{constructor(nt){super(nt),this.supportsBinary=!nt.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const nt=this.uri(),ot=this.opts.protocols,rt=isReactNative?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(rt.headers=this.opts.extraHeaders);try{this.ws=usingBrowserWebSocket&&!isReactNative?ot?new WebSocket$1(nt,ot):new WebSocket$1(nt):new WebSocket$1(nt,ot,rt)}catch(ut){return this.emitReserved("error",ut)}this.ws.binaryType=this.socket.binaryType||defaultBinaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=nt=>this.onClose({description:"websocket connection closed",context:nt}),this.ws.onmessage=nt=>this.onData(nt.data),this.ws.onerror=nt=>this.onError("websocket error",nt)}write(nt){this.writable=!1;for(let ot=0;ot<nt.length;ot++){const rt=nt[ot],ut=ot===nt.length-1;encodePacket(rt,this.supportsBinary,gt=>{const pt={};try{usingBrowserWebSocket&&this.ws.send(gt)}catch{}ut&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let nt=this.query||{};const ot=this.opts.secure?"wss":"ws";let rt="";this.opts.port&&(ot==="wss"&&Number(this.opts.port)!==443||ot==="ws"&&Number(this.opts.port)!==80)&&(rt=":"+this.opts.port),this.opts.timestampRequests&&(nt[this.opts.timestampParam]=yeast()),this.supportsBinary||(nt.b64=1);const ut=encode(nt),gt=this.opts.hostname.indexOf(":")!==-1;return ot+"://"+(gt?"["+this.opts.hostname+"]":this.opts.hostname)+rt+this.opts.path+(ut.length?"?"+ut:"")}check(){return!!WebSocket$1}}const transports={websocket:WS,polling:Polling},re=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse(ct){const nt=ct,ot=ct.indexOf("["),rt=ct.indexOf("]");ot!=-1&&rt!=-1&&(ct=ct.substring(0,ot)+ct.substring(ot,rt).replace(/:/g,";")+ct.substring(rt,ct.length));let ut=re.exec(ct||""),gt={},pt=14;for(;pt--;)gt[parts[pt]]=ut[pt]||"";return ot!=-1&&rt!=-1&&(gt.source=nt,gt.host=gt.host.substring(1,gt.host.length-1).replace(/;/g,":"),gt.authority=gt.authority.replace("[","").replace("]","").replace(/;/g,":"),gt.ipv6uri=!0),gt.pathNames=pathNames(gt,gt.path),gt.queryKey=queryKey(gt,gt.query),gt}function pathNames(ct,nt){const ot=/\/{2,9}/g,rt=nt.replace(ot,"/").split("/");return(nt.slice(0,1)=="/"||nt.length===0)&&rt.splice(0,1),nt.slice(-1)=="/"&&rt.splice(rt.length-1,1),rt}function queryKey(ct,nt){const ot={};return nt.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(rt,ut,gt){ut&&(ot[ut]=gt)}),ot}let Socket$1=class Co extends Emitter{constructor(nt,ot={}){super(),this.writeBuffer=[],nt&&typeof nt=="object"&&(ot=nt,nt=null),nt?(nt=parse(nt),ot.hostname=nt.host,ot.secure=nt.protocol==="https"||nt.protocol==="wss",ot.port=nt.port,nt.query&&(ot.query=nt.query)):ot.host&&(ot.hostname=parse(ot.host).host),installTimerFunctions(this,ot),this.secure=ot.secure!=null?ot.secure:typeof location<"u"&&location.protocol==="https:",ot.hostname&&!ot.port&&(ot.port=this.secure?"443":"80"),this.hostname=ot.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=ot.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=ot.transports||["polling","websocket"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},ot),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(nt){const ot=Object.assign({},this.opts.query);ot.EIO=protocol$1,ot.transport=nt,this.id&&(ot.sid=this.id);const rt=Object.assign({},this.opts.transportOptions[nt],this.opts,{query:ot,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new transports[nt](rt)}open(){let nt;if(this.opts.rememberUpgrade&&Co.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)nt="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else nt=this.transports[0];this.readyState="opening";try{nt=this.createTransport(nt)}catch{this.transports.shift(),this.open();return}nt.open(),this.setTransport(nt)}setTransport(nt){this.transport&&this.transport.removeAllListeners(),this.transport=nt,nt.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",ot=>this.onClose("transport close",ot))}probe(nt){let ot=this.createTransport(nt),rt=!1;Co.priorWebsocketSuccess=!1;const ut=()=>{rt||(ot.send([{type:"ping",data:"probe"}]),ot.once("packet",wt=>{if(!rt)if(wt.type==="pong"&&wt.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",ot),!ot)return;Co.priorWebsocketSuccess=ot.name==="websocket",this.transport.pause(()=>{rt||this.readyState!=="closed"&&(yt(),this.setTransport(ot),ot.send([{type:"upgrade"}]),this.emitReserved("upgrade",ot),ot=null,this.upgrading=!1,this.flush())})}else{const Lt=new Error("probe error");Lt.transport=ot.name,this.emitReserved("upgradeError",Lt)}}))};function gt(){rt||(rt=!0,yt(),ot.close(),ot=null)}const pt=wt=>{const Lt=new Error("probe error: "+wt);Lt.transport=ot.name,gt(),this.emitReserved("upgradeError",Lt)};function mt(){pt("transport closed")}function vt(){pt("socket closed")}function St(wt){ot&&wt.name!==ot.name&&gt()}const yt=()=>{ot.removeListener("open",ut),ot.removeListener("error",pt),ot.removeListener("close",mt),this.off("close",vt),this.off("upgrading",St)};ot.once("open",ut),ot.once("error",pt),ot.once("close",mt),this.once("close",vt),this.once("upgrading",St),ot.open()}onOpen(){if(this.readyState="open",Co.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let nt=0;const ot=this.upgrades.length;for(;nt<ot;nt++)this.probe(this.upgrades[nt])}}onPacket(nt){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",nt),this.emitReserved("heartbeat"),nt.type){case"open":this.onHandshake(JSON.parse(nt.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const ot=new Error("server error");ot.code=nt.data,this.onError(ot);break;case"message":this.emitReserved("data",nt.data),this.emitReserved("message",nt.data);break}}onHandshake(nt){this.emitReserved("handshake",nt),this.id=nt.sid,this.transport.query.sid=nt.sid,this.upgrades=this.filterUpgrades(nt.upgrades),this.pingInterval=nt.pingInterval,this.pingTimeout=nt.pingTimeout,this.maxPayload=nt.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const nt=this.getWritablePackets();this.transport.send(nt),this.prevBufferLen=nt.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let ot=1;for(let rt=0;rt<this.writeBuffer.length;rt++){const ut=this.writeBuffer[rt].data;if(ut&&(ot+=byteLength(ut)),rt>0&&ot>this.maxPayload)return this.writeBuffer.slice(0,rt);ot+=2}return this.writeBuffer}write(nt,ot,rt){return this.sendPacket("message",nt,ot,rt),this}send(nt,ot,rt){return this.sendPacket("message",nt,ot,rt),this}sendPacket(nt,ot,rt,ut){if(typeof ot=="function"&&(ut=ot,ot=void 0),typeof rt=="function"&&(ut=rt,rt=null),this.readyState==="closing"||this.readyState==="closed")return;rt=rt||{},rt.compress=rt.compress!==!1;const gt={type:nt,data:ot,options:rt};this.emitReserved("packetCreate",gt),this.writeBuffer.push(gt),ut&&this.once("flush",ut),this.flush()}close(){const nt=()=>{this.onClose("forced close"),this.transport.close()},ot=()=>{this.off("upgrade",ot),this.off("upgradeError",ot),nt()},rt=()=>{this.once("upgrade",ot),this.once("upgradeError",ot)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?rt():nt()}):this.upgrading?rt():nt()),this}onError(nt){Co.priorWebsocketSuccess=!1,this.emitReserved("error",nt),this.onClose("transport error",nt)}onClose(nt,ot){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",nt,ot),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(nt){const ot=[];let rt=0;const ut=nt.length;for(;rt<ut;rt++)~this.transports.indexOf(nt[rt])&&ot.push(nt[rt]);return ot}};Socket$1.protocol=protocol$1;function url(ct,nt="",ot){let rt=ct;ot=ot||typeof location<"u"&&location,ct==null&&(ct=ot.protocol+"//"+ot.host),typeof ct=="string"&&(ct.charAt(0)==="/"&&(ct.charAt(1)==="/"?ct=ot.protocol+ct:ct=ot.host+ct),/^(https?|wss?):\/\//.test(ct)||(typeof ot<"u"?ct=ot.protocol+"//"+ct:ct="https://"+ct),rt=parse(ct)),rt.port||(/^(http|ws)$/.test(rt.protocol)?rt.port="80":/^(http|ws)s$/.test(rt.protocol)&&(rt.port="443")),rt.path=rt.path||"/";const gt=rt.host.indexOf(":")!==-1?"["+rt.host+"]":rt.host;return rt.id=rt.protocol+"://"+gt+":"+rt.port+nt,rt.href=rt.protocol+"://"+gt+(ot&&ot.port===rt.port?"":":"+rt.port),rt}const withNativeArrayBuffer=typeof ArrayBuffer=="function",isView=ct=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(ct):ct.buffer instanceof ArrayBuffer,toString=Object.prototype.toString,withNativeBlob=typeof Blob=="function"||typeof Blob<"u"&&toString.call(Blob)==="[object BlobConstructor]",withNativeFile=typeof File=="function"||typeof File<"u"&&toString.call(File)==="[object FileConstructor]";function isBinary(ct){return withNativeArrayBuffer&&(ct instanceof ArrayBuffer||isView(ct))||withNativeBlob&&ct instanceof Blob||withNativeFile&&ct instanceof File}function hasBinary(ct,nt){if(!ct||typeof ct!="object")return!1;if(Array.isArray(ct)){for(let ot=0,rt=ct.length;ot<rt;ot++)if(hasBinary(ct[ot]))return!0;return!1}if(isBinary(ct))return!0;if(ct.toJSON&&typeof ct.toJSON=="function"&&arguments.length===1)return hasBinary(ct.toJSON(),!0);for(const ot in ct)if(Object.prototype.hasOwnProperty.call(ct,ot)&&hasBinary(ct[ot]))return!0;return!1}function deconstructPacket(ct){const nt=[],ot=ct.data,rt=ct;return rt.data=_deconstructPacket(ot,nt),rt.attachments=nt.length,{packet:rt,buffers:nt}}function _deconstructPacket(ct,nt){if(!ct)return ct;if(isBinary(ct)){const ot={_placeholder:!0,num:nt.length};return nt.push(ct),ot}else if(Array.isArray(ct)){const ot=new Array(ct.length);for(let rt=0;rt<ct.length;rt++)ot[rt]=_deconstructPacket(ct[rt],nt);return ot}else if(typeof ct=="object"&&!(ct instanceof Date)){const ot={};for(const rt in ct)Object.prototype.hasOwnProperty.call(ct,rt)&&(ot[rt]=_deconstructPacket(ct[rt],nt));return ot}return ct}function reconstructPacket(ct,nt){return ct.data=_reconstructPacket(ct.data,nt),delete ct.attachments,ct}function _reconstructPacket(ct,nt){if(!ct)return ct;if(ct&&ct._placeholder===!0){if(typeof ct.num=="number"&&ct.num>=0&&ct.num<nt.length)return nt[ct.num];throw new Error("illegal attachments")}else if(Array.isArray(ct))for(let ot=0;ot<ct.length;ot++)ct[ot]=_reconstructPacket(ct[ot],nt);else if(typeof ct=="object")for(const ot in ct)Object.prototype.hasOwnProperty.call(ct,ot)&&(ct[ot]=_reconstructPacket(ct[ot],nt));return ct}const RESERVED_EVENTS$1=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],protocol=5;var PacketType;(function(ct){ct[ct.CONNECT=0]="CONNECT",ct[ct.DISCONNECT=1]="DISCONNECT",ct[ct.EVENT=2]="EVENT",ct[ct.ACK=3]="ACK",ct[ct.CONNECT_ERROR=4]="CONNECT_ERROR",ct[ct.BINARY_EVENT=5]="BINARY_EVENT",ct[ct.BINARY_ACK=6]="BINARY_ACK"})(PacketType||(PacketType={}));class Encoder{constructor(nt){this.replacer=nt}encode(nt){return(nt.type===PacketType.EVENT||nt.type===PacketType.ACK)&&hasBinary(nt)?this.encodeAsBinary({type:nt.type===PacketType.EVENT?PacketType.BINARY_EVENT:PacketType.BINARY_ACK,nsp:nt.nsp,data:nt.data,id:nt.id}):[this.encodeAsString(nt)]}encodeAsString(nt){let ot=""+nt.type;return(nt.type===PacketType.BINARY_EVENT||nt.type===PacketType.BINARY_ACK)&&(ot+=nt.attachments+"-"),nt.nsp&&nt.nsp!=="/"&&(ot+=nt.nsp+","),nt.id!=null&&(ot+=nt.id),nt.data!=null&&(ot+=JSON.stringify(nt.data,this.replacer)),ot}encodeAsBinary(nt){const ot=deconstructPacket(nt),rt=this.encodeAsString(ot.packet),ut=ot.buffers;return ut.unshift(rt),ut}}function isObject(ct){return Object.prototype.toString.call(ct)==="[object Object]"}class Decoder extends Emitter{constructor(nt){super(),this.reviver=nt}add(nt){let ot;if(typeof nt=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");ot=this.decodeString(nt);const rt=ot.type===PacketType.BINARY_EVENT;rt||ot.type===PacketType.BINARY_ACK?(ot.type=rt?PacketType.EVENT:PacketType.ACK,this.reconstructor=new BinaryReconstructor(ot),ot.attachments===0&&super.emitReserved("decoded",ot)):super.emitReserved("decoded",ot)}else if(isBinary(nt)||nt.base64)if(this.reconstructor)ot=this.reconstructor.takeBinaryData(nt),ot&&(this.reconstructor=null,super.emitReserved("decoded",ot));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+nt)}decodeString(nt){let ot=0;const rt={type:Number(nt.charAt(0))};if(PacketType[rt.type]===void 0)throw new Error("unknown packet type "+rt.type);if(rt.type===PacketType.BINARY_EVENT||rt.type===PacketType.BINARY_ACK){const gt=ot+1;for(;nt.charAt(++ot)!=="-"&&ot!=nt.length;);const pt=nt.substring(gt,ot);if(pt!=Number(pt)||nt.charAt(ot)!=="-")throw new Error("Illegal attachments");rt.attachments=Number(pt)}if(nt.charAt(ot+1)==="/"){const gt=ot+1;for(;++ot&&!(nt.charAt(ot)===","||ot===nt.length););rt.nsp=nt.substring(gt,ot)}else rt.nsp="/";const ut=nt.charAt(ot+1);if(ut!==""&&Number(ut)==ut){const gt=ot+1;for(;++ot;){const pt=nt.charAt(ot);if(pt==null||Number(pt)!=pt){--ot;break}if(ot===nt.length)break}rt.id=Number(nt.substring(gt,ot+1))}if(nt.charAt(++ot)){const gt=this.tryParse(nt.substr(ot));if(Decoder.isPayloadValid(rt.type,gt))rt.data=gt;else throw new Error("invalid payload")}return rt}tryParse(nt){try{return JSON.parse(nt,this.reviver)}catch{return!1}}static isPayloadValid(nt,ot){switch(nt){case PacketType.CONNECT:return isObject(ot);case PacketType.DISCONNECT:return ot===void 0;case PacketType.CONNECT_ERROR:return typeof ot=="string"||isObject(ot);case PacketType.EVENT:case PacketType.BINARY_EVENT:return Array.isArray(ot)&&(typeof ot[0]=="number"||typeof ot[0]=="string"&&RESERVED_EVENTS$1.indexOf(ot[0])===-1);case PacketType.ACK:case PacketType.BINARY_ACK:return Array.isArray(ot)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class BinaryReconstructor{constructor(nt){this.packet=nt,this.buffers=[],this.reconPack=nt}takeBinaryData(nt){if(this.buffers.push(nt),this.buffers.length===this.reconPack.attachments){const ot=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),ot}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const parser=Object.freeze(Object.defineProperty({__proto__:null,Decoder,Encoder,get PacketType(){return PacketType},protocol},Symbol.toStringTag,{value:"Module"}));function on(ct,nt,ot){return ct.on(nt,ot),function(){ct.off(nt,ot)}}const RESERVED_EVENTS=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Socket extends Emitter{constructor(nt,ot,rt){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=nt,this.nsp=ot,rt&&rt.auth&&(this.auth=rt.auth),this._opts=Object.assign({},rt),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const nt=this.io;this.subs=[on(nt,"open",this.onopen.bind(this)),on(nt,"packet",this.onpacket.bind(this)),on(nt,"error",this.onerror.bind(this)),on(nt,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...nt){return nt.unshift("message"),this.emit.apply(this,nt),this}emit(nt,...ot){if(RESERVED_EVENTS.hasOwnProperty(nt))throw new Error('"'+nt.toString()+'" is a reserved event name');if(ot.unshift(nt),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(ot),this;const rt={type:PacketType.EVENT,data:ot};if(rt.options={},rt.options.compress=this.flags.compress!==!1,typeof ot[ot.length-1]=="function"){const pt=this.ids++,mt=ot.pop();this._registerAckCallback(pt,mt),rt.id=pt}const ut=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!ut||!this.connected)||(this.connected?(this.notifyOutgoingListeners(rt),this.packet(rt)):this.sendBuffer.push(rt)),this.flags={},this}_registerAckCallback(nt,ot){var rt;const ut=(rt=this.flags.timeout)!==null&&rt!==void 0?rt:this._opts.ackTimeout;if(ut===void 0){this.acks[nt]=ot;return}const gt=this.io.setTimeoutFn(()=>{delete this.acks[nt];for(let pt=0;pt<this.sendBuffer.length;pt++)this.sendBuffer[pt].id===nt&&this.sendBuffer.splice(pt,1);ot.call(this,new Error("operation has timed out"))},ut);this.acks[nt]=(...pt)=>{this.io.clearTimeoutFn(gt),ot.apply(this,[null,...pt])}}emitWithAck(nt,...ot){const rt=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((ut,gt)=>{ot.push((pt,mt)=>rt?pt?gt(pt):ut(mt):ut(pt)),this.emit(nt,...ot)})}_addToQueue(nt){let ot;typeof nt[nt.length-1]=="function"&&(ot=nt.pop());const rt={id:this._queueSeq++,tryCount:0,pending:!1,args:nt,flags:Object.assign({fromQueue:!0},this.flags)};nt.push((ut,...gt)=>rt!==this._queue[0]?void 0:(ut!==null?rt.tryCount>this._opts.retries&&(this._queue.shift(),ot&&ot(ut)):(this._queue.shift(),ot&&ot(null,...gt)),rt.pending=!1,this._drainQueue())),this._queue.push(rt),this._drainQueue()}_drainQueue(nt=!1){if(!this.connected||this._queue.length===0)return;const ot=this._queue[0];ot.pending&&!nt||(ot.pending=!0,ot.tryCount++,this.flags=ot.flags,this.emit.apply(this,ot.args))}packet(nt){nt.nsp=this.nsp,this.io._packet(nt)}onopen(){typeof this.auth=="function"?this.auth(nt=>{this._sendConnectPacket(nt)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(nt){this.packet({type:PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},nt):nt})}onerror(nt){this.connected||this.emitReserved("connect_error",nt)}onclose(nt,ot){this.connected=!1,delete this.id,this.emitReserved("disconnect",nt,ot)}onpacket(nt){if(nt.nsp===this.nsp)switch(nt.type){case PacketType.CONNECT:nt.data&&nt.data.sid?this.onconnect(nt.data.sid,nt.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case PacketType.EVENT:case PacketType.BINARY_EVENT:this.onevent(nt);break;case PacketType.ACK:case PacketType.BINARY_ACK:this.onack(nt);break;case PacketType.DISCONNECT:this.ondisconnect();break;case PacketType.CONNECT_ERROR:this.destroy();const rt=new Error(nt.data.message);rt.data=nt.data.data,this.emitReserved("connect_error",rt);break}}onevent(nt){const ot=nt.data||[];nt.id!=null&&ot.push(this.ack(nt.id)),this.connected?this.emitEvent(ot):this.receiveBuffer.push(Object.freeze(ot))}emitEvent(nt){if(this._anyListeners&&this._anyListeners.length){const ot=this._anyListeners.slice();for(const rt of ot)rt.apply(this,nt)}super.emit.apply(this,nt),this._pid&&nt.length&&typeof nt[nt.length-1]=="string"&&(this._lastOffset=nt[nt.length-1])}ack(nt){const ot=this;let rt=!1;return function(...ut){rt||(rt=!0,ot.packet({type:PacketType.ACK,id:nt,data:ut}))}}onack(nt){const ot=this.acks[nt.id];typeof ot=="function"&&(ot.apply(this,nt.data),delete this.acks[nt.id])}onconnect(nt,ot){this.id=nt,this.recovered=ot&&this._pid===ot,this._pid=ot,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(nt=>this.emitEvent(nt)),this.receiveBuffer=[],this.sendBuffer.forEach(nt=>{this.notifyOutgoingListeners(nt),this.packet(nt)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(nt=>nt()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:PacketType.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(nt){return this.flags.compress=nt,this}get volatile(){return this.flags.volatile=!0,this}timeout(nt){return this.flags.timeout=nt,this}onAny(nt){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(nt),this}prependAny(nt){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(nt),this}offAny(nt){if(!this._anyListeners)return this;if(nt){const ot=this._anyListeners;for(let rt=0;rt<ot.length;rt++)if(nt===ot[rt])return ot.splice(rt,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(nt){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(nt),this}prependAnyOutgoing(nt){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(nt),this}offAnyOutgoing(nt){if(!this._anyOutgoingListeners)return this;if(nt){const ot=this._anyOutgoingListeners;for(let rt=0;rt<ot.length;rt++)if(nt===ot[rt])return ot.splice(rt,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(nt){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const ot=this._anyOutgoingListeners.slice();for(const rt of ot)rt.apply(this,nt.data)}}}function Backoff(ct){ct=ct||{},this.ms=ct.min||100,this.max=ct.max||1e4,this.factor=ct.factor||2,this.jitter=ct.jitter>0&&ct.jitter<=1?ct.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var ct=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var nt=Math.random(),ot=Math.floor(nt*this.jitter*ct);ct=Math.floor(nt*10)&1?ct+ot:ct-ot}return Math.min(ct,this.max)|0};Backoff.prototype.reset=function(){this.attempts=0};Backoff.prototype.setMin=function(ct){this.ms=ct};Backoff.prototype.setMax=function(ct){this.max=ct};Backoff.prototype.setJitter=function(ct){this.jitter=ct};class Manager extends Emitter{constructor(nt,ot){var rt;super(),this.nsps={},this.subs=[],nt&&typeof nt=="object"&&(ot=nt,nt=void 0),ot=ot||{},ot.path=ot.path||"/socket.io",this.opts=ot,installTimerFunctions(this,ot),this.reconnection(ot.reconnection!==!1),this.reconnectionAttempts(ot.reconnectionAttempts||1/0),this.reconnectionDelay(ot.reconnectionDelay||1e3),this.reconnectionDelayMax(ot.reconnectionDelayMax||5e3),this.randomizationFactor((rt=ot.randomizationFactor)!==null&&rt!==void 0?rt:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(ot.timeout==null?2e4:ot.timeout),this._readyState="closed",this.uri=nt;const ut=ot.parser||parser;this.encoder=new ut.Encoder,this.decoder=new ut.Decoder,this._autoConnect=ot.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(nt){return arguments.length?(this._reconnection=!!nt,this):this._reconnection}reconnectionAttempts(nt){return nt===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=nt,this)}reconnectionDelay(nt){var ot;return nt===void 0?this._reconnectionDelay:(this._reconnectionDelay=nt,(ot=this.backoff)===null||ot===void 0||ot.setMin(nt),this)}randomizationFactor(nt){var ot;return nt===void 0?this._randomizationFactor:(this._randomizationFactor=nt,(ot=this.backoff)===null||ot===void 0||ot.setJitter(nt),this)}reconnectionDelayMax(nt){var ot;return nt===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=nt,(ot=this.backoff)===null||ot===void 0||ot.setMax(nt),this)}timeout(nt){return arguments.length?(this._timeout=nt,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(nt){if(~this._readyState.indexOf("open"))return this;this.engine=new Socket$1(this.uri,this.opts);const ot=this.engine,rt=this;this._readyState="opening",this.skipReconnect=!1;const ut=on(ot,"open",function(){rt.onopen(),nt&&nt()}),gt=on(ot,"error",pt=>{rt.cleanup(),rt._readyState="closed",this.emitReserved("error",pt),nt?nt(pt):rt.maybeReconnectOnOpen()});if(this._timeout!==!1){const pt=this._timeout;pt===0&&ut();const mt=this.setTimeoutFn(()=>{ut(),ot.close(),ot.emit("error",new Error("timeout"))},pt);this.opts.autoUnref&&mt.unref(),this.subs.push(function(){clearTimeout(mt)})}return this.subs.push(ut),this.subs.push(gt),this}connect(nt){return this.open(nt)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const nt=this.engine;this.subs.push(on(nt,"ping",this.onping.bind(this)),on(nt,"data",this.ondata.bind(this)),on(nt,"error",this.onerror.bind(this)),on(nt,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(nt){try{this.decoder.add(nt)}catch(ot){this.onclose("parse error",ot)}}ondecoded(nt){nextTick(()=>{this.emitReserved("packet",nt)},this.setTimeoutFn)}onerror(nt){this.emitReserved("error",nt)}socket(nt,ot){let rt=this.nsps[nt];return rt?this._autoConnect&&!rt.active&&rt.connect():(rt=new Socket(this,nt,ot),this.nsps[nt]=rt),rt}_destroy(nt){const ot=Object.keys(this.nsps);for(const rt of ot)if(this.nsps[rt].active)return;this._close()}_packet(nt){const ot=this.encoder.encode(nt);for(let rt=0;rt<ot.length;rt++)this.engine.write(ot[rt],nt.options)}cleanup(){this.subs.forEach(nt=>nt()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(nt,ot){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",nt,ot),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const nt=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const ot=this.backoff.duration();this._reconnecting=!0;const rt=this.setTimeoutFn(()=>{nt.skipReconnect||(this.emitReserved("reconnect_attempt",nt.backoff.attempts),!nt.skipReconnect&&nt.open(ut=>{ut?(nt._reconnecting=!1,nt.reconnect(),this.emitReserved("reconnect_error",ut)):nt.onreconnect()}))},ot);this.opts.autoUnref&&rt.unref(),this.subs.push(function(){clearTimeout(rt)})}}onreconnect(){const nt=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",nt)}}const cache={};function lookup(ct,nt){typeof ct=="object"&&(nt=ct,ct=void 0),nt=nt||{};const ot=url(ct,nt.path||"/socket.io"),rt=ot.source,ut=ot.id,gt=ot.path,pt=cache[ut]&&gt in cache[ut].nsps,mt=nt.forceNew||nt["force new connection"]||nt.multiplex===!1||pt;let vt;return mt?vt=new Manager(rt,nt):(cache[ut]||(cache[ut]=new Manager(rt,nt)),vt=cache[ut]),ot.query&&!nt.query&&(nt.query=ot.queryKey),vt.socket(ot.path,nt)}Object.assign(lookup,{Manager,Socket,io:lookup,connect:lookup});const initSocket=async()=>{const ct={"force new connection":!0,reconnectionAttempt:"Infinity",timeout:1e4,transports:["websocket"]};return new Promise((nt,ot)=>{const rt=setTimeout(()=>{clearTimeout(rt),ot(new Error("WebSocket connection timed out"))},ct.timeout),ut=lookup("http://localhost:5000",ct);ut.on("connect",()=>{clearTimeout(rt),nt(ut)}),ut.on("connect_error",gt=>{clearTimeout(rt),ot(gt)})})},EditorPages=()=>{const ct=reactExports.useRef(null),nt=reactExports.useRef(null),ot=useLocation(),{roomId:rt}=useParams(),ut=useNavigate(),[gt,pt]=reactExports.useState([]);reactExports.useEffect(()=>((async()=>{var wt;ct.current=await initSocket(),ct.current.on("connect_error",Lt=>yt(Lt)),ct.current.on("connect_failed",Lt=>yt(Lt));function yt(Lt){console.log("socket error",Lt),_t.error("Socket connection failed , try again later."),ut("/")}ct.current.emit(ACTIONS.JOIN,{roomId:rt,username:(wt=ot.state)==null?void 0:wt.username}),ct.current.on(ACTIONS.JOINED,({clients:Lt,username:xt,socketId:It})=>{var kt;xt!==((kt=ot.state)==null?void 0:kt.username)&&(_t.success(`${xt} joined the room. `),console.log(`${xt} joined`)),pt(Lt),ct.current.emit(ACTIONS.SYNC_CODE,{value:nt.current,socketId:It}),ct.current.on("disconnected",({socketId:At,username:Tt})=>{_t.success(`${Tt} left the room`),pt(Rt=>Rt.filter(Nt=>Nt.socketId!==At))})})})(),()=>{ct.current.disconnect(),ct.current.off("join"),ct.current.off("joined")}),[]);async function mt(){try{await navigator.clipboard.writeText(rt),_t.success("Room Id is copied to clipboard")}catch(St){_t.error("COuld not copy room Id"),console.error(St)}}function vt(){ut("/")}return ot.state?jsxRuntimeExports.jsxs("div",{className:"mainWrapper",children:[jsxRuntimeExports.jsxs("div",{className:"side",children:[jsxRuntimeExports.jsxs("div",{className:"sideinner",children:[jsxRuntimeExports.jsxs("div",{className:"logoimage",children:[jsxRuntimeExports.jsx("img",{className:"imgs",src:"/Pngtreeglitter golden pattern light effect_6414641.png",alt:""}),jsxRuntimeExports.jsx("h1",{className:"style",children:"!"}),jsxRuntimeExports.jsx("h1",{className:"codeget",children:"Let's Code"})]}),jsxRuntimeExports.jsx("h3",{className:"heat",children:"ScriptSquad"}),jsxRuntimeExports.jsx("div",{className:"clientsList",children:gt.map(St=>jsxRuntimeExports.jsx(Client,{username:St.username},St.socketId))})]}),jsxRuntimeExports.jsxs("div",{className:"someBtns",children:[jsxRuntimeExports.jsx("button",{className:"btn copyBtn",onClick:mt,children:"Copy ROOM ID"}),jsxRuntimeExports.jsx("button",{className:"btn leaveBtn",onClick:vt,children:"Leave"})]})]}),jsxRuntimeExports.jsx("div",{className:"editorWrapper",children:jsxRuntimeExports.jsx("div",{className:"editorContent",children:jsxRuntimeExports.jsx(CodeEditorWindow,{socketRef:ct,roomId:rt})})})]}):jsxRuntimeExports.jsx(Navigate,{to:"/"})};function App(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Ie,{position:"bottom-right",toastOptions:{success:{theme:{primary:"black"}}}})}),jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Home,{})}),jsxRuntimeExports.jsx(Route,{path:"/editor/:roomId",element:jsxRuntimeExports.jsx(EditorPages,{})})]})})]})}const index="";client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(App,{}));export{monaco_editor_core_star as m,typescriptDefaults as t};
